"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[6930],{87009:(e,t,a)=>{a.r(t),a.d(t,{ChatRefundModal:()=>va,GiftInfoModal:()=>Wt,GiftModal:()=>Ut,GiftRecipientPicker:()=>Rt,GiftResalePriceComposerModal:()=>jt,GiftStatusInfoModal:()=>aa,GiftTransferModal:()=>Sa,GiftUpgradeModal:()=>ea,GiftWithdrawModal:()=>la,PaidReactionModal:()=>je,PriceConfirmModal:()=>ya,StarPaymentModal:()=>fe,StarsBalanceModal:()=>ce,StarsGiftModal:()=>C,StarsGiftingPickerModal:()=>B,StarsSubscriptionModal:()=>Be,StarsTransactionInfoModal:()=>Ye});var r=a(84051),i=a(13439),n=a(70636),s=a(60919),o=a(87357),l=a(17142),c=a(4961),d=a(14),u=a(17712),m=a(59030),p=a(21849),f=a(18276),h=a(84685),g=a(64493),A=a(22337),b=a(1526);const S={modalDialog:"MFXAwnxJ",content:"Sl6xVf1R",main:"bTN9Jeph",headerInfo:"c6MiyJgW",logo:"StGLWvzb",logoBackground:"SyTXSfml",description:"kFe3mIZo",section:"BgfHkWd2",header:"zMtAGfXs",starHeaderText:"q3v8orGj",hiddenHeader:"bq3FnXT0",closeButton:"bDsDTkbe",avatar:"jK36xUj4",center:"v1PckUQn",secondaryInfo:"TDWSRfP9"},v=a.p+"GoldStar.fb6812e915ddfe27f504.svg",N=a.p+"stars-bg.dee4c4b73c7d21c2ec73.png";var y=a(20021);const C=(0,r.ph)((0,i.EK)(((e,{modal:t})=>({user:t?.forUserId?(0,s.mBe)(e,t.forUserId):void 0})))((({modal:e,user:t})=>{const{closeStarsGiftModal:a,openInvoice:s,requestConfetti:C}=(0,i.ko)(),I=(0,r.li)(),k=Boolean(e?.isOpen),G=(0,d.A)(e),Y=(0,m.A)(),[w,P]=(0,r.J0)(),[B,M]=(0,r.J0)(!0);(0,r.vJ)((()=>{k||M(!0)}),[k]);const D=(0,u.A)((()=>{const e=I.current;if(e&&k){const{top:t,left:a,width:r,height:i}=e.querySelector(".modal-content").getBoundingClientRect();C({top:t,left:a,width:r,height:i,withStars:!0})}}));(0,r.vJ)((()=>{G?.isCompleted&&D()}),[G,D]);const T=(0,u.A)((e=>{G&&(P(e),s(t?{type:"starsgift",userId:t.id,stars:e.stars,currency:e.currency,amount:e.amount}:{type:"stars",stars:e.stars,currency:e.currency,amount:e.amount}))})),F=(0,u.A)((()=>{a()})),U=(0,r.Kr)((()=>{const e=Y("lng_credits_summary_options_about").split("{link}");return[e[0],(0,y.Y)(h.A,{url:Y("StarsTOSLink"),text:Y("lng_credits_summary_options_about_link")}),e[1]]}),[Y]);return(0,y.Y)(A.A,{className:(0,o.A)(S.modalDialog),contentClassName:S.content,dialogRef:I,isSlim:!0,onClose:F,isOpen:k,children:(0,y.FD)("div",{className:(0,o.A)(S.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;M(t<=150)},children:[(0,y.Y)(g.A,{round:!0,size:"smaller",className:S.closeButton,color:"translucent",onClick:()=>a(),ariaLabel:Y("Close"),children:(0,y.Y)(f.A,{name:"close"})}),(0,y.Y)("div",{className:(0,o.A)(S.header,B&&S.hiddenHeader),children:(0,y.Y)("h2",{className:S.starHeaderText,children:Y(t?"GiftStarsTitle":"Star.List.GetStars")})}),(0,y.Y)("div",{className:S.headerInfo,children:t?(0,y.FD)(y.FK,{children:[(0,y.Y)(p.A,{size:100,peer:t,className:S.avatar}),(0,y.Y)("img",{className:S.logoBackground,src:N,alt:"",draggable:!1})]}):(0,y.FD)(y.FK,{children:[(0,y.Y)("img",{className:S.logo,src:v,alt:"",draggable:!1}),(0,y.Y)("img",{className:S.logoBackground,src:N,alt:"",draggable:!1})]})}),(0,y.Y)("h2",{className:(0,o.A)(S.headerText,S.center),children:G?.isCompleted?t?(0,c.A)(Y("Notification.StarsGift.SentYou",(0,l.Ad)(w.amount,w.currency,Y.code)),["simple_markdown"]):(0,c.A)(Y("StarsAcquiredInfo",w?.stars),["simple_markdown"]):Y(t?"GiftStarsTitle":"Star.List.GetStars")}),(0,y.Y)("p",{className:S.description,children:t?(0,c.A)(Y("ActionGiftStarsSubtitle",(0,n.F9)(Y,t)),["simple_markdown"]):Y("Stars.Purchase.GetStarsInfo")}),(0,y.FD)("div",{className:S.section,children:[(0,y.Y)(b.A,{options:G?.starsGiftOptions,onClick:T}),(0,y.Y)("div",{className:S.secondaryInfo,children:U})]})]})})})));var I=a(31481),k=a(90709),G=a(87894),Y=a(79582),w=a(54960),P=a(34642);const B=(0,r.ph)((0,i.EK)((e=>{const{chats:{listIds:t},currentUserId:a}=e;return{userIds:e.contactList?.userIds,activeListIds:t.active,archivedListIds:t.archived,currentUserId:a}}))((({isOpen:e,currentUserId:t,activeListIds:a,archivedListIds:s,userIds:o})=>{const{closeStarsGiftingPickerModal:l,openStarsGiftModal:c}=(0,i.ko)(),d=(0,m.A)(),[p,f]=(0,r.J0)(""),h=(0,r.Kr)((()=>{const e=(0,i.mS)().users.byId,r=(0,G.Am)([...o||[],...a||[],...s||[]]),l=(0,n.PU)({ids:r,query:p,type:"user"});return(0,Y.A)(l.filter((a=>{const r=e[a];return!(!r||r.isSupport||(0,k.tv)(r)||(0,k.PL)(r)||a===t||a===I.zv8)})))}),[t,p,o,a,s]),g=(0,u.A)((e=>{e?.length&&(c({forUserId:e}),l())}));return(0,y.Y)(P.A,{className:"s3k01dTm",isOpen:e,onClose:l,title:d("GiftStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Continue"),onEnter:l,children:(0,y.Y)(w.A,{className:"cuI2eDIY",itemIds:h,filterValue:p,filterPlaceholder:d("Search"),onFilterChange:f,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,onSelectedIdChange:g})})})));var M=a(37661),D=a(39351),T=a(46222),F=a(24680),U=a(41036),R=a(38777),x=a(86046),O=a(81949),K=a(9267);const L={root:"TtE8LQNJ",minimal:"nkV4JXHc",transition:"nXQS4E59",main:"JuWZY1ds",container:"mnhBs1uK",section:"lYkNd_gb",lastSection:"f749AI4g",sectionTitle:"FF8gm7MP",hint:"Rs8WXoOz",tos:"Vu6blJk9",topUpButton:"dc_DZoVF",tonBalanceContainer:"lorbW9II",tonBalance:"h2Fs3tOv",tonIconBalance:"Ut6GidJP",tonInUsd:"FdcdsB4l",tonIconLogo:"_hCjjyEv",description:"teXilLxe",header:"fnhXotO2",starHeaderText:"iUwego5s",botItem:"AhxcrKWn",hiddenHeader:"DZk6d6hF",closeButton:"piD1PXHW",addStarsButton:"dqnGL2uh",addStarsIcon:"w9Db2eiK",balanceBlock:"Yk0OQBKC",balanceInfo:"p2dW9NOV",smallerText:"rUnPcfmE",balanceBottom:"F5BTkZ9G",modalBalance:"t8tMrx3y",starButton:"oOt4VBD2",paymentContent:"OReEUNTV",paymentImages:"oKorQYTC",paymentPhoto:"HGTrEtUF",avatarStar:"Wu10dXoa",paymentImageBackground:"os8jb_qv",paymentButton:"VzR5cibf",paymentButtonStar:"Uhg7yWxK",transactions:"Qvc0fTTH",subscriptions:"IX5BhCUF",tabs:"KZVEyKOX",disclaimer:"bpVifdwH",amountBadge:"BPM7LKwo",loadMore:"TKmZjMyd",loadMoreIcon:"buepwtN1"},z=(0,r.ph)((({balance:e,className:t,withAddButton:a})=>{const r=(0,D.A)(),{openStarsBalanceModal:n}=(0,i.ko)();return(0,y.Y)("div",{className:(0,o.A)(L.balanceBlock,t),children:(0,y.FD)("div",{className:L.balanceInfo,children:[(0,y.Y)("span",{className:L.smallerText,children:r("StarsBalance")}),(0,y.Y)("div",{className:L.balanceBottom,children:e?.currency===I.ykW?(0,y.FD)(y.FK,{children:[(0,y.Y)(f.A,{name:"toncoin"}),void 0!==e?(0,l.UL)(e.amount,e.currency):"…"]}):(0,y.FD)(y.FK,{children:[(0,y.Y)(K.A,{type:"gold",size:"middle"}),void 0!==e&&e.currency===I.OUy?(0,x.ZF)(r,e):"…",a&&(0,y.Y)(O.A,{className:L.addStarsButton,onClick:()=>n({}),children:(0,y.Y)(f.A,{className:L.addStarsIcon,name:"add"})})]})})]})})}));var E=a(17663),V=a(14242),H=a(63527);const q={root:"ZXnbeQxP",info:"zLaaDX3c",status:"HbF2qTB2",statusPricing:"AveGvpdV",amount:"_CBiOQcv",title:"k9ZIv5Pd",description:"FlRlxMx2",subtitle:"YN2J8dw6",statusPeriod:"MRrP7Oew",statusEnded:"pRHwfr8m",preview:"t6Syyhzd",subscriptionStar:"ftlbevPm"},J=(0,r.ph)((({subscription:e})=>{const{openStarsSubscriptionModal:t}=(0,i.ko)(),{peerId:a,pricing:r,until:o,isCancelled:l,title:d,photo:f}=e,h=(0,m.A)(),g=(0,H.A)(function(e){return t=>(0,s.PVB)(t,e)}(a)),A=(0,u.A)((()=>{t({subscription:e})}));if(!g)return;const b=o<Date.now()/1e3,S=(0,E.A)(1e3*o,h.code,!0,"long");return(0,y.FD)("div",{className:q.root,onClick:A,children:[(0,y.FD)("div",{className:q.preview,children:[(0,y.Y)(p.A,{size:"medium",peer:g}),(0,y.Y)(K.A,{className:q.subscriptionStar,type:"gold",size:"small"})]}),(0,y.FD)("div",{className:q.info,children:[(0,y.Y)("h3",{className:q.title,children:(0,c.A)((0,n.F9)(h,g)||"")}),d&&(0,y.FD)("p",{className:q.subtitle,children:[f&&(0,y.Y)(p.A,{webPhoto:f,size:"micro"}),(0,c.A)(d)]}),(0,y.Y)("p",{className:q.description,children:h(b?"StarsSubscriptionExpired":l?"StarsSubscriptionExpires":"StarsSubscriptionRenews",S)})]}),(0,y.Y)("div",{className:q.status,children:l||b?(0,y.Y)("div",{className:q.statusEnded,children:h(b?"StarsSubscriptionStatusExpired":"StarsSubscriptionStatusCancelled")}):(0,y.FD)(y.FK,{children:[(0,y.FD)("div",{className:q.statusPricing,children:[(0,y.Y)(K.A,{className:q.star,type:"gold",size:"adaptive"}),(0,y.Y)("span",{className:q.amount,children:(0,V.Sm)(r.amount)})]}),(0,y.Y)("div",{className:q.statusPeriod,children:h("StarsParticipantSubscriptionPerMonth")})]})})]})}));var W=a(58968),_=a(66833);function j(e,t,a){if(a.paidMessages)return t("PaidMessageTransaction",{count:a.paidMessages},{withNodes:!0,pluralValue:a.paidMessages});if(a.isGiftResale)return Q(a.amount)?t("StarGiftSaleTransaction"):t("StarGiftPurchaseTransaction");if(a.isPostsSearch)return t("PostsSearchTransaction");if(a.starRefCommision)return e("StarTransactionCommission",(0,V.l9)(a.starRefCommision));if(a.isGiftUpgrade)return e("Gift2TransactionUpgraded");if(a.extendedMedia)return e("StarMediaPurchase");if(a.subscriptionPeriod)return a.title||e("StarSubscriptionPurchase");if(a.isReaction)return e("StarsReactionsSent");if(a.giveawayPostId)return e("StarsGiveawayPrizeReceived");if(a.isMyGift)return e("StarsGiftSent");if(a.isGift)return a.amount.currency===I.ykW?t("TonGiftReceived"):e("StarsGiftReceived");if(a.starGift)return Q(a.amount)?e("Gift2TransactionSent"):e("Gift2ConvertedTitle");const r=a.peer&&(0,x.MA)(a)&&(0,x.Pc)(a)||void 0;return r?r.title||e(r.titleKey):a.title}function Q(e){return e.currency===I.OUy?(t=e).amount?t.amount<0:t.nanos<0:e.amount<0;var t}var X=a(79577),$=a(40558),Z=a(62587),ee=a(27860);const te={root:"jQkp75Gb",preview:"OYGSN3PF",count:"KX1yz2Jy",thumb:"EvinKr5k",noOutline:"KSAAsUDv",itemCount1:"GxDajfX_",itemCount2:"jXuZoxq8",itemCount3:"TPn3XGHJ",blurry:"hWZuxLS8",full:"w56QPFhl",fadeIn:"ds43W8Wq"};function ae({boughtMedia:e,index:t,className:a}){const r=e.video||e.photo,i=(0,k.VO)(r,"pictogram"),n=(0,k.VD)(r),s=(0,Z.A)(i);return(0,y.FD)("div",{className:(0,o.A)(te.thumb,void 0!==t&&`stars-transaction-media-${t}`,a),children:[n&&(0,y.Y)("img",{className:te.blurry,src:n,alt:""}),s&&(0,y.Y)("img",{className:te.full,src:s,alt:""})]})}const re=(0,r.ph)((({media:e,className:t,isTransactionPreview:a,onClick:r})=>{const i=Math.min(e.length,a?2:3),n="mediaType"in e[0];return(0,y.FD)("div",{className:(0,o.A)(te.root,te[`itemCount${i}`],a&&te.preview,t),dir:"rtl",onClick:r,children:[e.slice(0,i).reverse().map(((e,t,r)=>{const i=r.length-t-1;return"mediaType"in e?(0,y.Y)(ee.A,{className:te.thumb,isVisible:!0,width:e.width,height:e.height,thumbDataUri:e.thumbnail?.dataUri}):(0,y.Y)(ae,{className:(0,o.A)(a&&i>0&&te.noOutline),boughtMedia:e,index:i})})),n&&(0,y.FD)("div",{className:te.count,children:[(0,y.Y)(f.A,{name:"stars-lock"}),e.length>1?e.length:""]})]})})),ie={root:"aHAxv_Jg",info:"oyYrn3II",stars:"K5lc75ku",amount:"QLQPuLAr",title:"e0pK8CJ_",description:"xbERdDMQ",date:"l6CwQ0Ev",positive:"P_42_ZWR",negative:"TGjnLJfH",preview:"cnjGihOT",subscriptionStar:"z43YvnDX",uniqueGiftBackground:"eNvzMw2p",giftSticker:"U3dqmnM4"},ne=(0,r.ph)((({transaction:e,className:t})=>{const{openStarsTransactionModal:a}=(0,i.ko)(),{date:l,amount:d,photo:h,peer:g,extendedMedia:A,subscriptionPeriod:b}=e,S=(0,D.A)(),v=(0,m.A)(),N="peer"===g.type?g.id:void 0,C=(0,H.A)(function(e){return t=>e?(0,s.PVB)(t,e):void 0}(N)),k=e.starGift,G="starGiftUnique"===k?.type,Y=k&&(0,_.yQ)(k),w=(0,r.Kr)((()=>{let t,a,r,i=j(v,S,e);if((0,x.MA)(e)){const a=(0,x.Pc)(e);i=a.title||v(a.titleKey),t=v(a.subtitleKey),r=a}else t=C&&(0,n.F9)(v,C),r=C||W.lw;return e.isGiftUpgrade&&"starGiftUnique"===e.starGift?.type&&(t=S("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isGiftResale&&"starGiftUnique"===e.starGift?.type&&(t=S("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isPostsSearch&&(i=j(v,S,e),t=void 0),e.photo&&(r=void 0),e.isRefund&&(a=v("StarsRefunded")),e.hasFailed&&(a=v("StarsFailed")),e.isPending&&(a=v("StarsPending")),{title:i,description:t,avatarPeer:r,status:a}}),[v,S,C,e]),P=(0,r.Kr)((()=>{if(G){const{backdrop:e}=(0,_.uc)(k),t=[e.centerColor,e.edgeColor];return(0,y.FD)(y.FK,{children:[(0,y.Y)($.A,{className:ie.uniqueGiftBackground,backgroundColors:t}),(0,y.Y)(X.A,{className:ie.giftSticker,sticker:Y,size:36,play:!1})]})}return Y?(0,y.Y)(X.A,{className:ie.giftSticker,sticker:Y,size:36,play:!1}):A?(0,y.Y)(re,{media:A,isTransactionPreview:!0}):(0,y.FD)(y.FK,{children:[(0,y.Y)(p.A,{size:"medium",webPhoto:h,peer:w.avatarPeer}),Boolean(b)&&(0,y.Y)(K.A,{className:ie.subscriptionStar,type:"gold",size:"small"})]})}),[G,A,h,w.avatarPeer,b,k,Y]),B=(0,u.A)((()=>{a({transaction:e})})),M=Q(d)?ie.negative:ie.positive;return(0,y.FD)("div",{className:(0,o.A)(ie.root,t),onClick:B,children:[(0,y.Y)("div",{className:ie.preview,children:P}),(0,y.FD)("div",{className:ie.info,children:[(0,y.Y)("h3",{className:ie.title,children:w.title}),w.description&&(0,y.Y)("p",{className:ie.description,children:(0,c.A)(w.description)}),(0,y.FD)("p",{className:ie.date,children:[(0,E.L2)(1e3*l,v.code,!0),w.status&&` — (${w.status})`]})]}),(0,y.FD)("div",{className:ie.stars,children:[(0,y.Y)("span",{className:(0,o.A)(ie.amount,M),children:(0,x.hk)(S,d)}),d.currency===I.OUy&&(0,y.Y)(K.A,{className:ie.star,type:"gold",size:"adaptive"}),d.currency===I.ykW&&(0,y.Y)(f.A,{name:"toncoin",className:M})]})]})})),se=["all","inbound","outbound"],oe=["StarsTransactionsAll","StarsTransactionsIncoming","StarsTransactionsOutgoing"],le="StarsTransactionItem",ce=(0,r.ph)((0,i.EK)(((e,{modal:t})=>({shouldForceHeight:t?.currency===I.ykW?Boolean(e.ton?.history?.all?.transactions.length):Boolean(e.stars?.history?.all?.transactions.length),starsBalanceState:e.stars,tonBalanceState:e.ton,canBuyPremium:!(0,s.n_C)(e),tonUsdRate:e.appConfig?.tonUsdRate||I.kgD,tonTopupUrl:e.appConfig?.tonTopupUrl||I.BJU})))((({modal:e,starsBalanceState:t,tonBalanceState:a,canBuyPremium:d,shouldForceHeight:p,tonUsdRate:S,tonTopupUrl:v})=>{const{closeStarsBalanceModal:N,loadStarsTransactions:C,loadStarsSubscriptions:G,openStarsGiftingPickerModal:Y,openInvoice:w,openUrl:P}=(0,i.ko)(),B=e?.currency||I.OUy,x=B===I.ykW?a:t,{balance:O,history:K}=x||{},{subscriptions:E}=B===I.OUy&&t||{},V=(0,m.A)(),H=(0,D.A)(),[q,W]=(0,r.J0)(!0),[_,j]=(0,r.J0)(0),[Q,X,$]=(0,M.A)(),Z=Boolean(e&&(t||a)),{originStarsPayment:ee,originReaction:te,originGift:ae,topup:re}=e||{},ie=ee||te||ae||re,ce=ee?.form?.invoice?.totalAmount||ee?.subscriptionInfo?.subscriptionPricing?.amount||te?.amount||ae?.gift.stars||re?.balanceNeeded,de=ce?ce-(O?.amount||0):void 0,ue=(0,r.Kr)((()=>{const e=(0,i.mS)();if(te){const t=(0,s.hds)(e,te.chatId);if(!t)return;return V("StarsNeededTextReactions",(0,k.Js)(V,t))}if(ee){const t=ee.form?.botId?(0,s.mBe)(e,ee.form.botId):void 0;if(!t)return;return V("StarsNeededText",(0,k.Yg)(t))}if(ae){const t=(0,s.mBe)(e,ae.peerId);if(!t)return;return V("StarsNeededTextGift",(0,n.F9)(H,t))}return"subs"===re?.purpose?V("StarsNeededTextLink"):re?.purpose===I.D3m?H("StarsNeededTextSendPaidMessages",void 0,{withMarkdown:!0,withNodes:!0}):void 0}),[te,ee,ae,re?.purpose,H,V]),me=Boolean(K?.all?.transactions.length&&!ie),pe=!ie,fe=(0,r.Kr)((()=>{const e=K?.all?.transactions.length||0;return 1==e?"35.5rem":2==e?"39.25rem":3==e?"43rem":"45rem"}),[K?.all?.transactions.length]),he=(0,r.Kr)((()=>oe.map((e=>({title:H(e)})))),[H]);(0,r.vJ)((()=>{Z||(W(!0),j(0),$())}),[Z]),(0,r.vJ)((()=>{ie?X():$()}),[ie]);const ge=(0,r.Kr)((()=>{if(!Z)return;const e=V("lng_credits_summary_options_about").split("{link}");return[e[0],(0,y.Y)(h.A,{url:V("StarsTOSLink"),text:V("lng_credits_summary_options_about_link")}),e[1]]}),[Z,V]),Ae=(0,u.A)((()=>{C({type:se[_],isTon:B===I.ykW})})),be=(0,u.A)((()=>{G()})),Se=(0,u.A)((()=>{Y({})})),ve=(0,u.A)((e=>{w({type:"stars",stars:e.stars,currency:e.currency,amount:e.amount})})),Ne=(0,u.A)((()=>{P({url:v,shouldSkipModal:!0})}));return(0,y.Y)(A.A,{className:(0,o.A)(L.root,!p&&!Q&&L.minimal),isOpen:Z,onClose:N,dialogStyle:`--modal-height: ${fe}`,children:(0,y.FD)("div",{className:(0,o.A)(L.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;W(t<=150)},children:[(0,y.Y)(g.A,{round:!0,size:"smaller",className:L.closeButton,color:"translucent",onClick:()=>N(),ariaLabel:H("Close"),children:(0,y.Y)(f.A,{name:"close"})}),B!==I.ykW&&(0,y.Y)(z,{balance:O,className:L.modalBalance}),(0,y.Y)("div",{className:(0,o.A)(L.header,q&&L.hiddenHeader),children:(0,y.Y)("h2",{className:L.starHeaderText,children:V("TelegramStars")})}),(0,y.Y)("div",{className:L.section,children:B===I.ykW?(()=>{const e=(0,l.UL)(O?.amount||0,I.ykW);return(0,y.FD)(y.FK,{children:[(0,y.Y)(R.A,{model:"speeding-diamond",color:"blue",title:H("CurrencyTon"),description:H("DescriptionAboutTon"),isDisabled:!Z}),(0,y.FD)("div",{className:L.tonBalanceContainer,children:[(0,y.FD)("div",{className:L.tonBalance,children:[(0,y.Y)(f.A,{name:"toncoin",className:L.tonIconBalance}),e]}),Boolean(S)&&(0,y.Y)("span",{className:L.tonInUsd,children:`≈ ${(0,l.Ad)((0,l.C)(O?.amount||0,S,!0),"USD",H.code)}`})]}),(0,y.Y)(g.A,{className:L.topUpButton,onClick:Ne,fluid:!0,children:H("ButtonTopUpViaFragment")})]})})():(0,y.FD)(y.FK,{children:[(0,y.Y)(R.A,{model:"swaying-star",color:"gold",title:de?V("StarsNeededTitle",ce):V("TelegramStars"),description:(0,c.A)(ue||V("TelegramStarsInfo"),["simple_markdown","emoji"]),isDisabled:!Z}),d&&!Q&&(0,y.Y)(g.A,{className:L.starButton,onClick:X,fluid:!0,children:V("Star.List.BuyMoreStars")}),d&&!Q&&pe&&(0,y.Y)(g.A,{isText:!0,noForcedUpperCase:!0,className:L.starButton,fluid:!0,onClick:Se,children:V("TelegramStarsGift")}),Q&&t?.topupOptions&&(0,y.Y)(b.A,{starsNeeded:de,options:t.topupOptions,onClick:ve})]})}),Q&&(0,y.Y)("div",{className:L.tos,children:ge}),B===I.ykW&&(0,y.Y)("div",{className:L.hint,children:H("TonModalHint")}),me&&Boolean(E?.list.length)&&(0,y.FD)("div",{className:L.section,children:[(0,y.Y)("h3",{className:L.sectionTitle,children:V("StarMySubscriptions")}),(0,y.FD)("div",{className:L.subscriptions,children:[E?.list.map((e=>(0,y.Y)(J,{subscription:e},e.id))),E?.nextOffset&&(0,y.FD)(g.A,{isText:!0,disabled:E.isLoading,size:"smaller",noForcedUpperCase:!0,className:L.loadMore,onClick:be,children:[(0,y.Y)(f.A,{name:"down",className:L.loadMoreIcon}),V("StarMySubscriptionsExpand")]})]})]}),me&&(0,y.FD)("div",{className:L.container,children:[(0,y.Y)("div",{className:L.lastSection,children:(0,y.Y)(U.Ay,{name:H.isRtl?"slideOptimizedRtl":"slideOptimized",activeKey:_,renderCount:oe.length,shouldRestoreHeight:!0,className:L.transition,children:(0,y.Y)(T.A,{onLoadMore:Ae,items:K?.[se[_]]?.transactions,scrollContainerClosest:`.${L.main}`,itemSelector:`.${le}`,className:L.transactions,noFastList:!0,noScrollRestoreOnTop:!0,children:K?.[se[_]]?.transactions.map((e=>(0,y.Y)(ne,{transaction:e,className:le},`${e.id}-${e.isRefund}`)))})})}),(0,y.Y)(F.A,{className:L.tabs,tabClassName:L.tab,activeTab:_,tabs:he,onSwitchTab:j})]})]})})})));var de=a(48775),ue=a(29886),me=a(84991),pe=a(10187);const fe=(0,r.ph)((0,i.EK)(((e,{modal:t})=>{const a=t?.form?.botId?(0,s.mBe)(e,t.form.botId):void 0,r="message"===t?.inputInvoice?.type?t.inputInvoice:void 0,i=r?(0,s.O5q)(e,r.chatId,r.messageId):void 0,n=r?(0,s.hds)(e,r.chatId):void 0,o=i?.content.paidMedia;return{bot:a,starsBalanceState:e.stars,paidMediaMessage:o?i:void 0,paidMediaChat:o?n:void 0}}))((({modal:e,bot:t,starsBalanceState:a,paidMediaMessage:n,paidMediaChat:s})=>{const{closeStarsPaymentModal:l,openStarsBalanceModal:d,sendStarPaymentForm:f}=(0,i.ko)(),[b,S,v]=(0,M.A)(),C=Boolean(e?.inputInvoice&&a),I=(0,ue.A)(e),G=e||I,{form:Y,subscriptionInfo:w}=G||{},P=Y?.invoice?.totalAmount||w?.subscriptionPricing?.amount,B=Boolean(Y?.invoice.subscriptionPeriod),T=!w?.subscriptionPricing,F=Y?.photo,U=(0,m.A)(),R=(0,D.A)();(0,r.vJ)((()=>{C||v()}),[C]);const x=(0,r.Kr)((()=>{if(!G?.inputInvoice)return"";const e=(0,k.Yg)(t),a=U("Stars.Intro.PurchasedText.Stars",P);if(n){const e=n.content.paidMedia.extendedMedia,t=e.every((e=>!e.duration)),r=e.every((e=>Boolean(e.duration))),i=U(t?"Stars.Transfer.Photos":r?"Stars.Transfer.Videos":"Media",e.length),o=(0,k.Js)(U,s);return U("Stars.Transfer.UnlockInfo",[i,o,a])}return w?R("StarsSubscribeText",{chat:w.title,amount:P},{withNodes:!0,withMarkdown:!0,pluralValue:P}):B?R("StarsSubscribeBotText",{name:Y.title,amount:P,bot:e},{pluralValue:P}):U("Stars.Transfer.Info",[Y.title,e,a])}),[G?.inputInvoice,t,U,P,n,w,B,Y,s,R]),O=(0,r.Kr)((()=>{if(w)return R("StarsSubscribeInfo",{link:(0,y.Y)(h.A,{url:R("StarsSubscribeInfoLink"),text:R("StarsSubscribeInfoLinkText")})},{withNodes:!0})}),[w,R]),E=(0,r.Kr)((()=>{if(w)return(0,k.nr)(w)}),[w]),H=(0,u.A)((()=>{const t=a?.balance;void 0!==P&&void 0!==t&&(P>t.amount?d({originStarsPayment:e}):(f({}),S()))}));return(0,y.FD)(A.A,{contentClassName:L.paymentContent,isOpen:C,hasAbsoluteCloseButton:!0,isSlim:!0,onClose:l,children:[(0,y.Y)(z,{balance:a?.balance,className:L.modalBalance}),(0,y.FD)("div",{className:L.paymentImages,dir:U.isRtl?"ltr":"rtl",children:[n?(0,y.Y)(re,{media:n.content.paidMedia.extendedMedia}):E?(0,y.FD)(y.FK,{children:[(0,y.Y)(p.A,{className:L.paymentPhoto,peer:E,size:"giant"}),(0,y.Y)(K.A,{type:"gold",size:"adaptive",className:L.avatarStar})]}):(0,y.Y)(me.A,{peer:F?void 0:t,avatarWebPhoto:F,avatarSize:"giant",badgeIcon:"star",badgeText:(0,V.Sm)(P),badgeClassName:L.amountBadge,className:L.paymentPhoto}),(0,y.Y)("img",{className:L.paymentImageBackground,src:N,alt:"",draggable:!1})]}),(0,y.Y)("h2",{className:L.headerText,children:U(E?"StarsSubscribeTitle":"StarsConfirmPurchaseTitle")}),T&&(0,y.Y)(pe.A,{className:L.botItem,peerId:Y?.botId}),(0,y.Y)("div",{className:L.description,children:(0,c.A)(x,["simple_markdown","emoji"])}),(0,y.Y)(g.A,{className:L.paymentButton,size:"smaller",onClick:H,isLoading:b,children:R(B?"StarsSubscribeBotButtonMonth":"StarsPay",{amount:(0,de.U2)(R,P,{asFont:!0})},{withNodes:!0})}),Boolean(O)&&(0,y.Y)("div",{className:(0,o.A)(L.disclaimer,L.smallerText),children:O})]})})));var he=a(89925),ge=a(85982),Ae=a(97040),be=a(70046),Se=a(96454),ve=a(95807),Ne=a(537);const ye=(0,r.ph)((({modelAttribute:e,backdropAttribute:t,patternAttribute:a,title:n,subtitle:s,subtitlePeer:l,className:c,resellPrice:d})=>{const{openChat:u}=(0,i.ko)(),m=(0,D.A)(),[p,h,g]=(0,M.A)(),A=(0,Ne.A)([e,t,a]),b=t?.textColor,S=(0,r.Kr)((()=>{const e=[t.centerColor,t.edgeColor],r=t.patternColor;return(0,y.Y)($.A,{className:"UvhsGZLf",backgroundColors:e,patternColor:r,patternIcon:a.sticker})}),[t,a]);return(0,y.FD)("div",{className:(0,o.A)("irv1C8bo",c),children:[(0,y.FD)(U.Ay,{className:"Tu6_OHoq",slideClassName:(0,o.A)("interactive-gift","iUTKLzTN"),activeKey:A,direction:1,name:"zoomBounceSemiFade",children:[S,(0,y.Y)(X.A,{className:"a1ASgPwu",sticker:e.sticker,size:120,noLoop:!p,onMouseEnter:Se.TF?void 0:h,onMouseLeave:Se.TF?void 0:g})]}),n&&(0,y.Y)("h1",{className:"ECTvfOda",children:n}),Boolean(s)&&(0,y.Y)("div",{className:(0,o.A)("S6JwvHWD",l&&"V7kDVPLm"),style:(0,ve.A)(b&&`color: ${b}`),onClick:()=>{l&&u({id:l.id})},children:s}),d&&(0,y.FD)("p",{className:"zTVWZg63",children:[(0,y.Y)("span",{children:(0,x.hk)(m,d)}),"XTR"===d.currency&&(0,y.Y)(K.A,{type:"gold",size:"middle"}),"TON"===d.currency&&(0,y.Y)(f.A,{name:"toncoin"})]})]})})),Ce="qBOIq6Jn",Ie="sso9uZM6",ke="NuWOY7ED",Ge=[0,-50],Ye=(0,r.ph)((0,i.EK)(((e,{modal:t})=>{const a="peer"===t?.transaction?.peer?.type&&t.transaction.peer.id,r=a?(0,s.PVB)(e,a):void 0,i=e.appConfig?.starsPaidMessageCommissionPermille,n=t?.transaction.amount,o=t?.transaction.isGift?n?.currency===I.OUy?(0,s.WLj)(e,n?.amount):(0,s.OD9)(e,n?.amount):void 0;return{peer:r,canPlayAnimatedEmojis:(0,s.BWX)(e),topSticker:o,paidMessageCommission:i}}))((({modal:e,peer:t,canPlayAnimatedEmojis:a,topSticker:n,paidMessageCommission:s})=>{const{showNotification:l,openMediaViewer:c,closeStarsTransactionModal:d}=(0,i.ko)(),g=(0,D.A)(),A=(0,m.A)(),{transaction:b}=e||{},S=(0,r.li)(),v=(0,u.A)((()=>{const e=b?.extendedMedia;e&&c({origin:he.TQ.StarsTransaction,standaloneMedia:e.flatMap((e=>Object.values(e)))})})),N=(0,u.A)((()=>{S.current?.()})),C=(0,u.A)((e=>{S.current=e})),G=(0,r.Kr)((()=>{if(!b)return;const{giveawayPostId:e,photo:r,amount:i,isGiftUpgrade:c,starGift:d,isGiftResale:u,starRefCommision:m}=b,S=b?.starGift,G="starGiftUnique"===S?.type,Y=b?.starGift?(0,_.yQ)(b.starGift):n,w=G?(0,_.uc)(S):void 0,P=b.peer&&(0,x.MA)(b)&&(0,x.Pc)(b)||void 0,B="peer"===b.peer?.type?b.peer.id:void 0,M=b.peer&&A(function(e){switch(e.type){case"appStore":return"AppStore";case"playMarket":return"PlayMarket";case"fragment":return"Fragment";case"premiumBot":return"StarsTransactionBot";case"ads":return"StarsTransactionAds";case"api":return"Stars.Intro.Transaction.TelegramBotApi.Subtitle";default:return"Stars.Transaction.Unsupported.Title"}}(b.peer)),D=j(A,g,b),T=t&&b.messageId&&!c?(0,k.yt)(t,void 0,b.messageId):void 0,F=t&&e?(0,k.yt)(t,void 0,e):void 0,U=b.extendedMedia,R=U?.length||0,O=U?.every((e=>!e.video)),L=U?.every((e=>!e.photo)),z=A(O?"Stars.Transfer.Photos":L?"Stars.Transfer.Videos":"Media",R),H=b.description||(c&&"starGiftUnique"===d?.type?d.title:void 0)||(U?z:void 0),q=!U&&!Y&&!b.isPostsSearch,J=r?void 0:!(0,x.MA)(b)&&t||P,W=G&&(0,y.Y)("div",{className:(0,o.A)(Ce,"ApoQz22o"),children:(0,y.Y)(ye,{backdropAttribute:w.backdrop,patternAttribute:w.pattern,modelAttribute:w.model,title:S.title,subtitle:g("GiftInfoCollectible",{number:S.number}),resellPrice:b.amount})}),$=Q(i)?"xDyq9cc0":"jvBZSrpd",Z=(0,y.FD)("div",{className:Ce,children:[U&&(0,y.Y)(re,{className:(0,o.A)("C5r59yiV","transaction-media-preview"),media:U,onClick:v}),!U&&Y&&(0,y.Y)(X.A,{sticker:Y,play:a,noLoop:!0},b.id),q&&(0,y.Y)(p.A,{className:"hcrszlpT",peer:J,webPhoto:r,size:"giant",onMouseMove:N}),!Y&&!b.isPostsSearch&&(0,y.Y)(Ae.A,{className:(0,o.A)("nML8IQqX"),color:"gold",onRequestAnimation:C,centerShift:Ge}),Boolean(D)&&(0,y.Y)("h1",{className:"ZZAj3hj7",children:D}),(0,y.Y)("p",{className:ke,children:H}),(0,y.FD)("p",{className:Ie,children:[(0,y.Y)("span",{className:(0,o.A)(Ie,$),children:(0,x.hk)(g,i)}),i.currency===I.OUy&&(0,y.Y)(K.A,{type:"gold",size:"middle"}),"TON"===i.currency&&(0,y.Y)(f.A,{name:"toncoin",className:$}),b.isRefund&&(0,y.Y)("p",{className:"sxWAwxTd",children:g("Refunded")})]}),Boolean(b.paidMessages&&b.starRefCommision&&s)&&(0,y.Y)("p",{className:ke,children:g("PaidMessageTransactionDescription",{percent:(0,V.l9)(s/10)},{withNodes:!0,withMarkdown:!0})})]}),ee=[];let te;b&&m&&!b.paidMessages&&!u&&ee.push([A("StarsTransaction.StarRefReason.Title"),A("StarsTransaction.StarRefReason.Program")]),c&&ee.push([A("StarGiftReason"),A("StarGiftReasonUpgrade")]),u&&ee.push([A("StarGiftReason"),Q(b.amount)?g("StarGiftSaleTransaction"):g("StarGiftPurchaseTransaction")]),te=c?A("Stars.Transaction.GiftFrom"):Q(i)||b.isMyGift?A("Stars.Transaction.To"):!b.starRefCommision||b.paidMessages||u?A(B?"Star.Transaction.From":"Stars.Transaction.Via"):A("StarsTransaction.StarRefReason.Miniapp"),b.isPostsSearch||ee.push([te,B?{chatId:B}:M||""]),b.starRefCommision&&b.paidMessages&&ee.push([g("PaidMessageTransactionTotal"),(0,de.U2)(g,b.amount.amount/((100-b.starRefCommision)/100),{asFont:!1,className:"cU5QlvwL",containerClassName:"Z2YALGgl"})]),T&&ee.push([A("Stars.Transaction.Reaction.Post"),(0,y.Y)(h.A,{url:T,text:T})]),F&&b.amount.currency===I.OUy&&(ee.push([A("BoostReason"),(0,y.Y)(h.A,{url:F,text:A("Giveaway")})]),ee.push([A("Gift"),A("Stars",b.amount,"i")])),b.id&&ee.push([A("Stars.Transaction.Id"),(0,y.FD)(y.FK,{children:[(0,y.Y)("div",{className:"tMF8VIOM",onClick:()=>{(0,ge.eM)(b.id),l({message:A("StarsTransactionIDCopied")})},children:b.id}),(0,y.Y)(f.A,{className:"voCttFzS",name:"copy"})]})]),ee.push([A("Stars.Transaction.Date"),(0,E.L2)(1e3*b.date,A.code,!0)]);const ae=A("lng_credits_box_out_about").split("{link}");return{header:G?W:Z,tableData:ee,footer:(0,y.FD)("span",{className:"KgzPpgS6",children:[ae[0],(0,y.Y)(h.A,{url:A("StarsTOSLink"),text:A("lng_credits_summary_options_about_link")}),ae[1]]})}}),[b,A,g,t,a,n,s,C]),Y=(0,ue.A)(G)||G;return(0,y.Y)(be.A,{isOpen:Boolean(b),className:"IzhfRIWu",hasBackdrop:"starGiftUnique"===b?.starGift?.type,header:Y?.header,tableData:Y?.tableData,footer:Y?.footer,buttonText:A("OK"),onClose:d})}))),we="oBLHWBtJ",Pe=[0,-50],Be=(0,r.ph)((0,i.EK)(((e,{modal:t})=>{const a=t?.subscription.peerId;return{peer:a?(0,s.PVB)(e,a):void 0}}))((({modal:e,peer:t})=>{const{closeStarsSubscriptionModal:a,fulfillStarsSubscription:s,changeStarsSubscription:l,checkChatInvite:c,loadStarStatus:d,openInvoice:f}=(0,i.ko)(),A=(0,m.A)(),b=(0,D.A)(),{subscription:S}=e||{},v=(0,r.li)(),N=(0,u.A)((()=>{v.current?.()})),C=(0,u.A)((e=>{v.current=e})),k=(0,r.Kr)((()=>{if(!S)return"hidden";if(S.canRefulfill)return"refulfill";const e=S.until>Date.now()/1e3;if(e&&!S.isCancelled)return"cancel";if(e&&S.isCancelled)return"renew";const t=S.chatInviteHash||S.invoiceSlug;return!e&&t?"restart":"ok"}),[S]),G=(0,u.A)((()=>{if(S){switch(k){case"refulfill":s({id:S.id});break;case"restart":S.chatInviteHash?c({hash:S.chatInviteHash}):S.invoiceSlug&&f({type:"slug",slug:S.invoiceSlug}),d();break;case"renew":l({id:S.id,isCancelled:!1});break;case"cancel":l({id:S.id,isCancelled:!0})}a()}})),Y=(0,r.Kr)((()=>{if(!S||!t)return;const{pricing:e,until:a,isCancelled:r,canRefulfill:i,photo:s,title:l,hasBotCancelled:c}=S,d=(0,n.mO)(t),u=(0,y.FD)("div",{className:"E3R22yAI",children:[(0,y.FD)("div",{className:"wuTMXDP9",children:[(0,y.Y)(p.A,{peer:s?void 0:t,webPhoto:s,size:"giant",onMouseMove:N}),(0,y.Y)(K.A,{className:"enRetSny",type:"gold",size:"adaptive"})]}),(0,y.Y)(Ae.A,{className:(0,o.A)("zGCayu45"),color:"gold",onRequestAnimation:C,centerShift:Pe}),(0,y.Y)("h1",{className:"qdydQHgc",children:l||A("StarsSubscriptionTitle")}),(0,y.Y)("p",{className:"FI6rEJlK",children:b("StarsPerMonth",{amount:e.amount},{withNodes:!0,specialReplacement:{[I.Cyx]:(0,y.Y)(K.A,{className:"J8HIcN6k",size:"adaptive",type:"gold"})}})})]}),m=[];m.push([A(d?"StarsSubscriptionBot":"StarsSubscriptionChannel"),{chatId:t.id}]),l&&m.push([A("StarsSubscriptionBotProduct"),l]);const f=a<Date.now()/1e3;m.push([A(f?"StarsSubscriptionUntilExpired":r?"StarsSubscriptionUntilExpires":"StarsSubscriptionUntilRenews"),(0,E.L2)(1e3*a,A.code,!0)]);const v=b("StarsTransactionTOS",{link:(0,y.Y)(h.A,{url:b("StarsTransactionTOSLink"),text:b("StarsTransactionTOSLinkText")})},{withNodes:!0});return{header:u,tableData:m,footer:(0,y.FD)("span",{className:"GMWMuWCr",children:[(0,y.Y)("p",{className:we,children:v}),r&&(0,y.Y)("p",{className:"nkwiG25Q",children:A(c?"StarsSubscriptionBotCancelledText":"StarsSubscriptionCancelledText")}),i&&(0,y.Y)("p",{className:we,children:A("StarsSubscriptionRefulfillInfo",(0,E.L2)(1e3*a,A.code,!0))}),!r&&!i&&f&&(0,y.Y)("p",{className:we,children:A("StarsSubscriptionExpiredInfo",(0,E.L2)(1e3*a,A.code,!0))}),!r&&!i&&!f&&(0,y.Y)("p",{className:we,children:A("StarsSubscriptionCancelInfo",(0,E.L2)(1e3*a,A.code,!0))}),"hidden"!==k&&(0,y.Y)(g.A,{size:"smaller",color:"cancel"===k?"danger":"primary",isText:"cancel"===k,onClick:G,children:A("cancel"===k?"StarsSubscriptionCancel":"refulfill"===k?"StarsSubscriptionRefulfill":"restart"===k?"StarsSubscriptionAgain":"renew"===k?"StarsSubscriptionRenew":"OK")})]})}}),[k,b,A,t,S]),w=(0,ue.A)(Y)||Y;return(0,y.Y)(be.A,{isOpen:Boolean(S),className:"eR_RZfGB",header:w?.header,tableData:w?.tableData,footer:w?.footer,onClose:a})})));var Me=a(43874),De=a(34431),Te=a(19806),Fe=a(22699),Ue=a(24433),Re=a(32581),xe=a(66644),Oe=a(15283),Ke=a(93545),Le=a(68292),ze=a(85118);const Ee={root:"CuBAw2yg",slider:"euOOAbZi",sparkles:"_L1YQTIP",progress:"kwK0cNPX",floatingBadgeWrapper:"uvlMoXj0",floatingBadge:"BGSDWAYc",floatingBadgeText:"qqQan8uF",floatingBadgeTriangle:"mIdJOmsB"},Ve=[50,100,500,1e3,2e3,5e3,1e4];function He(e,t){const a=e.findIndex((e=>t<=e)),r=e[a-1]||1,i=e[a]||e[e.length-1];return a+(t-r)/(i-r)}function qe(e,t){const a=Math.floor(t),r=e[a-1]||1,i=r+((e[a]||e[e.length-1])-r)*(t-a);return Math.round(i)}const Je=(0,r.ph)((({maxValue:e,defaultValue:t,className:a,onChange:i})=>{const n=(0,r.li)(),s=(0,r.Kr)((()=>{const t=[];for(let a=0;a<Ve.length;a++)if(Ve[a]<e&&t.push(Ve[a]),Ve[a]>=e){t.push(e);break}return t}),[e]),[l,c]=(0,r.J0)(0);(0,Oe.A)((()=>{c(He(s,t))}));const d=(0,u.A)((()=>{const e=n.current;if(!e)return;const t=e.parentElement;(0,xe.YS)((()=>{const a=t.offsetLeft+e.offsetWidth/2,r=t.offsetLeft+t.offsetWidth-e.offsetWidth/2;(0,xe.RK)((()=>{t.style.setProperty("--_min-x",`${a}px`),t.style.setProperty("--_max-x",`${r}px`)}))}))}));(0,Ke.A)(n,d);const m=(0,u.A)((e=>{const t=Number(e.currentTarget.value);c(t),i(qe(s,t))}));return(0,y.FD)("div",{className:(0,o.A)(Ee.root,a),style:"--progress: "+l/s.length,children:[(0,y.Y)("div",{className:Ee.floatingBadgeWrapper,children:(0,y.FD)("div",{className:Ee.floatingBadge,ref:n,children:[(0,y.FD)("div",{className:Ee.floatingBadgeText,children:[(0,y.Y)(f.A,{name:"star",className:Ee.floatingBadgeIcon}),(0,y.Y)(Le.A,{text:(0,V.Sm)(qe(s,l))})]}),(0,y.FD)("svg",{className:Ee.floatingBadgeTriangle,width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",children:[(0,y.Y)("defs",{children:(0,y.FD)("linearGradient",{id:"StarBadgeTriangle",x1:"0",x2:"1",y1:"0",y2:"0",children:[(0,y.Y)("stop",{offset:"-50%","stop-color":"#FFAA00"}),(0,y.Y)("stop",{offset:"150%","stop-color":"#FFCD3A"})]})}),(0,y.Y)("path",{d:"m 28,4 v 9 c 0.0089,7.283278 -3.302215,5.319646 -6.750951,8.589815 l -5.8284,5.82843 c -0.781,0.78105 -2.0474,0.78104 -2.8284,0 L 6.7638083,21.589815 C 2.8288652,17.959047 0.04527024,20.332086 0,13 V 4 C 0,4 0.00150581,0.97697493 3,1 5.3786658,1.018266 22.594519,0.9142007 25,1 c 2.992326,0.1067311 3,3 3,3 z",fill:"url(#StarBadgeTriangle)"})]})]})}),(0,y.Y)("div",{className:Ee.progress,children:(0,y.Y)(ze.A,{preset:"progress",className:Ee.sparkles})}),(0,y.Y)("input",{className:Ee.slider,type:"range",min:0,max:s.length,defaultValue:He(s,t),step:"any",onChange:m})]})})),We={content:"RdhRpsCn",title:"yzbjj73U",slider:"xePPMXOI",description:"BlpfdOtK",itemInfo:"nS9V516D",itemTitle:"sH5Nukjy",itemSubtitle:"dHlNODTI",itemIcon:"H_iHihXU",sendAsPeerButtonAvatar:"_mjvLELm",sendAsPeerMenuButton:"zxsRaWYV",buttonDownIcon:"zrwUUELS",sendAsPeerMenuBubble:"X1PB6mhQ",sendAsPeerMenu:"Px1MDij9",sendAsPeersMenuContainer:"Al1nfhHJ",headerControlPanel:"vu90kSL_",separator:"uhQLUjmo",checkBox:"Mc3bVeF0",topLabel:"bnou4CpV",top:"QludQDKR",topBadge:"JBF9pTUK",buttonStar:"NJJFuym9",topPeer:"Ty4Ud_Rd",disclaimer:"KRvkHeo1"},_e={avatarIcon:"author-hidden",customPeerAvatarColor:"#9eaab5",isCustomPeer:!0,titleKey:"StarsReactionAnonymous"},je=(0,r.ph)((0,i.EK)(((e,{modal:t})=>{const a=t&&(0,s.hds)(e,t.chatId),r=t&&(0,s.O5q)(e,t.chatId,t.messageId),i=e.stars?.balance,n=e.appConfig?.paidReactionMaxAmount||2500,o=e.settings.paidReactionPrivacy,l=a?.sendPaidReactionsAsPeerIds,c=e.currentUserId;return{chat:a,message:r,starBalance:i,maxAmount:n,defaultPrivacy:o,sendPaidReactionsAsPeerIds:l,currentUserId:c,currentUser:(0,s.mBe)(e,c)}}))((({modal:e,chat:t,message:a,maxAmount:l,starBalance:d,defaultPrivacy:b,sendPaidReactionsAsPeerIds:S,currentUserId:v,currentUser:N})=>{const{closePaidReactionModal:C,addLocalPaidReaction:k,loadSendPaidReactionsAs:G}=(0,i.ko)(),[Y,w]=(0,r.J0)(50),[P,B,T]=(0,M.A)(),[F,U]=(0,r.J0)(!0),[R,x]=(0,r.J0)(v),O=t?.id,K=R?(0,s.PVB)((0,i.mS)(),R):N,L=(0,m.A)(),{isMobile:E}=(0,Me.Ay)(),H=(0,D.A)(),q=(0,u.A)((e=>{U(!e.target.checked)})),J=(0,u.A)((e=>{w(e),B()}));(0,r.vJ)((()=>{O&&!S&&G({chatId:O})}),[O,S]);const W=(0,r.Kr)((()=>{const e=S?.map((e=>e.id)).filter((e=>e!==O));return e?.unshift(v),e}),[S,O,v]),_=W&&W.length>1;(0,r.vJ)((()=>{e||T()}),[e]),(0,r.vJ)((()=>{const e=a?.reactions?.topReactors?.find((e=>e.isMy));if(e)return U(Boolean(e.isAnonymous)),void(e.peerId&&x(e.peerId));U("anonymous"===b?.type||!1),"peer"===b?.type&&W?.includes(b.peerId)?x(b.peerId):x(v)}),[b,a?.reactions?.topReactors,W,v]);const j=(0,u.A)((()=>{e&&(k({chatId:e.chatId,messageId:e.messageId,count:Y,isPrivate:F,peerId:F||R===v?void 0:R,shouldIgnoreDefaultPrivacy:!0}),C())})),Q=(0,u.A)((e=>{U(!1),x(e)})),X=(0,u.A)((e=>{const t=(0,s.PVB)((0,i.mS)(),e),a=R===e&&!F;if(t)return(0,y.FD)(Ue.A,{onClick:()=>Q(e),children:[(0,y.Y)(p.A,{size:"small",peer:t}),(0,y.FD)("div",{className:(0,o.A)(We.itemInfo),children:[(0,y.Y)(De.A,{className:We.itemTitle,peer:t,noFake:!0,noVerified:!0}),(0,y.Y)("span",{className:We.itemSubtitle,children:(0,n.mO)(t)?H("PeerPersonalAccount"):H("PeerChannel")})]}),(0,y.Y)(f.A,{className:We.itemIcon,name:a?"check":"placeholder"})]})})),$=(0,r.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,y.FD)(g.A,{ripple:!E,size:"smaller",color:"translucent",className:(0,o.A)(We.sendAsPeerMenuButton,t?"active":""),onClick:e,ariaLabel:H("AccDescrOpenMenu2"),children:[(0,y.Y)(p.A,{className:We.sendAsPeerButtonAvatar,size:"mini",peer:F?_e:K}),(0,y.Y)(f.A,{name:"down",className:We.buttonDownIcon})]})),[E,H,K,F]),Z=(0,r.Kr)((()=>{if(_)return(0,y.Y)(Fe.A,{className:(0,o.A)(We.sendAsPeerMenu,"with-menu-transitions"),bubbleClassName:We.sendAsPeerMenuBubble,trigger:$,positionX:"right",autoClose:!0,children:W.map((e=>X(e)))})}),[$,W,_]),ee=(0,r.Kr)((()=>{const e=(0,i.mS)(),t=a?.reactions?.topReactors;if(!t)return;const r=[];let n=!1,o=0;if(t.forEach((t=>{const a=t.peerId?(0,s.PVB)(e,t.peerId):void 0;if(!a&&!t.isAnonymous&&!t.isMy)return;if(t.isMy&&(o=t.count),t.isMy&&(t.peerId!==R||t.isAnonymous&&!F))return;const i=R===t.peerId||F&&t.isAnonymous;i&&(n=!0),r.push({amount:t.count,localAmount:i&&P?Y:0,isMy:t.isMy,isAnonymous:t.isAnonymous,user:a})})),!n){const t=(0,s.PVB)(e,R);r.push({amount:o,localAmount:P?Y:0,isMy:!0,user:t})}return r.sort(((e,t)=>t.amount+t.localAmount-(e.amount+e.localAmount))),r.slice(0,3)}),[P,a?.reactions?.topReactors,Y,R,F]),te=t&&(0,n.F9)(L,t);return(0,y.FD)(A.A,{isOpen:Boolean(e),onClose:C,isSlim:!0,hasAbsoluteCloseButton:!0,contentClassName:We.content,isLowStackPriority:!0,children:[(0,y.Y)("div",{className:We.sendAsPeersMenuContainer,children:Z}),(0,y.Y)("div",{className:We.headerControlPanel,children:(0,y.Y)(z,{balance:d,className:We.modalBalance,withAddButton:!0})}),(0,y.Y)(Je,{className:We.slider,defaultValue:50,maxValue:l,onChange:J}),(0,y.Y)("h3",{className:We.title,children:L("StarsReactionTitle")}),(0,y.Y)("div",{className:We.description,children:(0,c.A)(L("StarsReactionText",te),["simple_markdown","emoji"])}),(0,y.Y)(Re.A,{children:ee&&(0,y.Y)("div",{className:We.topLabel,children:L("StarsReactionTopSenders")})}),ee&&(0,y.Y)("div",{className:We.top,children:ee.map((e=>{const t=(0,V.Sm)(e.amount+e.localAmount),a=e.isAnonymous||!e.user||e.isMy&&F?_e:e.user,r="isCustomPeer"in a?L(a.titleKey):a&&(0,n.F9)(L,a);return(0,y.Y)(me.A,{className:We.topPeer,peer:a,badgeText:t,badgeIcon:"star",badgeClassName:We.topBadge,text:r},`${e.user?.id||"anonymous"}-${t}`)}))}),ee&&(0,y.Y)(Re.A,{className:We.separator}),(0,y.Y)(Te.A,{className:(0,o.A)(We.checkBox,"dialog-checkbox"),checked:!F,onChange:q,label:L("StarsReactionShowMeInTopSenders")}),(0,y.Y)(g.A,{size:"smaller",onClick:j,children:H("SendPaidReaction",{amount:Y},{withNodes:!0,specialReplacement:{[I.Cyx]:(0,y.Y)(f.A,{className:We.buttonStar,name:"star"})}})}),(0,y.Y)("p",{className:We.disclaimer,children:H("StarsReactionTerms",{link:(0,y.Y)(h.A,{text:H("StarsReactionLinkText"),url:H("StarsReactionLink")})},{withNodes:!0})})]})})));var Qe=a(37836),Xe=a(5912),$e=a(23174),Ze=a(65632),et=a(20333),tt=a(36143),at=a(96530),rt=a(22720),it=a(63152),nt=a(94079);const st="zZUpGRSI",ot="zAee80Dv",lt="nTPAv1ci",ct=(0,r.ph)((0,i.EK)(((e,{peerId:t})=>{const a=(0,s.SJA)(e),{stars:r}=e,{isBlurred:i,patternColor:n,background:o,backgroundColor:l}=(0,s.Gyz)(e,a)||{},c=(0,s.PVB)(e,t),d=(0,s.WA9)(e,t),u=(0,s.vGo)(e,t),m=e.currentUserId===t,p=!m&&u?.disallowedGifts?.shouldDisallowUniqueStarGifts,f=!m&&u?.disallowedGifts?.shouldDisallowLimitedStarGifts,h=(0,s.nTw)(e);return{starBalance:r?.balance,peer:c,theme:a,isBackgroundBlurred:i,patternColor:n,customBackground:o,backgroundColor:l,captionLimit:e.appConfig?.starGiftMaxMessageLength,currentUserId:e.currentUserId,isPaymentFormLoading:h.isPaymentFormLoading,paidMessagesStars:d,areUniqueStarGiftsDisallowed:p,shouldDisallowLimitedStarGifts:f}}))((function({gift:e,giftByStars:t,peerId:a,peer:s,captionLimit:c,theme:d,isBackgroundBlurred:m,patternColor:p,backgroundColor:f,customBackground:h,currentUserId:A,isPaymentFormLoading:b,starBalance:S,paidMessagesStars:v,areUniqueStarGiftsDisallowed:N,shouldDisallowLimitedStarGifts:C}){const{sendStarGift:I,sendPremiumGiftByStars:k,openInvoice:G,openGiftUpgradeModal:Y,openStarsBalanceModal:w}=(0,i.ko)(),P=(0,D.A)(),[B,M]=(0,r.J0)(""),[T,F]=(0,r.J0)(!1),[U,R]=(0,r.J0)(!1),[x,O]=(0,r.J0)(!1),K=(0,Ze.A)(d,h);(0,r.vJ)((()=>{C&&R(!0)}),[C,U]);const L="id"in e&&"starGift"===e.type,z="months"in e,E=t&&"amount"in t,V=s&&(0,n.mO)(s),H=a===A,q=(0,r.Kr)((()=>{if(z){const a=x&&E?t:e;return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"giftPremium",amount:a.amount,currency:a.currency,months:e.months,message:B?{text:B}:void 0}}}}if(L)return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"starGift",message:B?.length?{text:B}:void 0,isNameHidden:T||void 0,starsToConvert:e.starsToConvert,canUpgrade:U||void 0,alreadyPaidUpgradeStars:U?e.upgradeStars:void 0,gift:e,peerId:a,fromId:A}}}}),[A,e,B,L,T,U,a,x,E,t,z]),J=(0,u.A)((e=>{M(e.target.value)})),W=(0,u.A)((()=>{F(!T)})),_=(0,u.A)((()=>{R(!U)})),j=(0,u.A)((()=>{E&&O(!x)})),Q=(0,u.A)((()=>{L&&Y({giftId:e.id,peerId:a})})),X=(0,u.A)((()=>{w({})})),$=(0,u.A)((()=>{L?I({peerId:a,shouldHideName:T,gift:e,message:B?{text:B}:void 0,shouldUpgrade:U}):x&&E?k({userId:a,months:t.months,amount:t.amount,message:B?{text:B}:void 0}):z&&G({type:"giftcode",userIds:[a],currency:e.currency,amount:e.amount,option:e,message:B?{text:B}:void 0})})),Z=E&&S&&S.amount>t.amount,ee=(0,o.A)("ZORVRSG3","soDpW2YR",h&&"Eny_G3JI",f&&"TkJZPU2u",h&&m&&"M6k91TdM");if((L||z)&&q)return(0,y.FD)("div",{className:(0,o.A)("jKOG0It6","custom-scroll"),children:[(0,y.FD)("div",{className:(0,o.A)("CB1mxsgp","MessageList"),inert:!0,style:(0,ve.A)(`--pattern-color: ${p}`,f&&`--theme-background-color: ${f}`),children:[(0,y.Y)("div",{className:ee,style:K?`--custom-background: ${K}`:void 0}),(0,y.Y)(tt.A,{message:q,threadId:$e.l3,appearanceOrder:0},L?e.id:z?e.months:void 0)]}),function(){const a=c?c-B.length:void 0,r=(0,n.F9)(P,s);return(0,y.FD)("div",{className:"Y68CEIKn",children:[!v&&(0,y.Y)(nt.A,{className:"o5r2IPoA",onChange:J,value:B,label:P("GiftMessagePlaceholder"),maxLength:c,maxLengthIndicator:a&&a<50?a.toString():void 0}),Z&&(0,y.FD)(rt.A,{className:st,narrow:!0,ripple:!0,onClick:j,children:[(0,y.Y)("span",{children:P("GiftPremiumPayWithStars",{stars:(0,de.U2)(P,t.amount,{className:ot})},{withNodes:!0})}),(0,y.Y)(it.A,{checked:x,onChange:j,label:P("GiftPremiumPayWithStarsAcc")})]}),E&&S&&(0,y.Y)("div",{className:lt,children:P("GiftPremiumDescriptionYourBalance",{stars:(0,de.U2)(P,S.amount,{className:ot}),link:(0,y.Y)(at.A,{isPrimary:!0,onClick:X,children:P("GetMoreStarsLinkText")})},{withNodes:!0,withMarkdown:!0})}),L&&Boolean(e.upgradeStars)&&!N&&(0,y.FD)(rt.A,{className:st,narrow:!0,ripple:!0,onClick:_,disabled:C,children:[(0,y.Y)("span",{children:P("GiftMakeUnique",{stars:(0,de.U2)(P,e.upgradeStars,{className:ot})},{withNodes:!0})}),(0,y.Y)(it.A,{checked:U,onChange:_,label:P("GiftMakeUniqueAcc")})]}),L&&Boolean(e.upgradeStars)&&!N&&(0,y.Y)("div",{className:lt,children:V?P("GiftMakeUniqueDescription",{user:r,link:(0,y.Y)(at.A,{isPrimary:!0,onClick:Q,children:P("GiftMakeUniqueLink")})},{withNodes:!0}):P("GiftMakeUniqueDescriptionChannel",{peer:r,link:(0,y.Y)(at.A,{isPrimary:!0,onClick:Q,children:P("GiftMakeUniqueLink")})},{withNodes:!0})}),L&&(0,y.FD)(rt.A,{className:st,narrow:!0,ripple:!0,onClick:W,children:[(0,y.Y)("span",{children:P("GiftHideMyName")}),(0,y.Y)(it.A,{checked:T,onChange:W,label:P("GiftHideMyName")})]}),L&&(0,y.Y)("div",{className:lt,children:H?P("GiftHideNameDescriptionSelf"):V?P("GiftHideNameDescription",{receiver:r}):P("GiftHideNameDescriptionChannel")})]})}(),(0,y.Y)("div",{className:"ATowWJ60"}),function(){const a=x&&E?(0,de.U2)(P,t.amount,{asFont:!0}):L?(0,de.U2)(P,e.stars+(U?e.upgradeStars:0),{asFont:!0}):z?(0,l.vv)(P,e.amount,e.currency):void 0;return(0,y.FD)("div",{className:"jxWZSvet",children:[L&&Boolean(e.availabilityRemains)&&(0,y.Y)(et.A,{isPrimary:!0,progress:e.availabilityRemains/e.availabilityTotal,rightText:P("GiftSoldCount",{count:e.availabilityTotal-e.availabilityRemains}),leftText:P("GiftLeftCount",{count:e.availabilityRemains}),className:"mWzLu0c0"}),(0,y.Y)(g.A,{className:"IDuhjrne",size:"smaller",onClick:$,isLoading:b,children:P("GiftSend",{amount:a},{withNodes:!0})})]})}()]})})));var dt=a(87049);const ut="G1mBmzxs",mt="a8no5WH0",pt="DvJLTVFU",ft=(0,r.ph)((0,i.EK)(((e,{option:t})=>({sticker:(0,s.t0O)(e,t.months),canPlayAnimatedEmojis:(0,s.BWX)(e)})))((function({sticker:e,canPlayAnimatedEmojis:t,baseMonthAmount:a,option:r,optionByStars:i,onClick:n}){const{months:s,amount:o,currency:c}=r,d=(0,D.A)(),m=(0,u.A)((()=>{n(r)})),p=Math.floor(o/s),f=a&&a>p?Math.ceil(100-p/(a/100)):void 0;return(0,y.FD)("div",{className:ut,tabIndex:0,role:"button",onClick:m,children:[(0,y.Y)(X.A,{sticker:e,play:t,noLoop:!0,nonInteractive:!0,size:86}),function(){const e=12===s?d("Years",{count:1},{pluralValue:1}):d("Months",{count:s},{pluralValue:s});return(0,y.Y)("div",{className:"rn9aWFNA",children:e})}(),(0,y.Y)("div",{className:"q4_ydkAx",children:d("PremiumGiftDescription")}),(0,y.Y)(g.A,{className:mt,nonInteractive:!0,size:"tiny",pill:!0,fluid:!0,children:(0,l.Ad)(o,c)}),i&&(0,y.Y)("div",{className:"QB5SI7ta",children:d("GiftPremiumStarsPrice",{stars:(0,de.U2)(d,i.amount,{className:"jgnEfoeM"})},{withNodes:!0,withMarkdown:!0})}),Boolean(f)&&(0,y.Y)(dt.A,{color:"purple",text:d("GiftDiscount",{percent:f})})]})})));var ht=a(82855);const gt=(0,r.ph)((0,i.EK)((e=>({isCurrentUserPremium:(0,s.g29)(e)})))((function({gift:e,observeIntersection:t,onClick:a,isResale:n,isCurrentUserPremium:s}){const{openGiftInfoModal:l,openPremiumModal:c,showNotification:d}=(0,i.ko)(),m=(0,r.li)(),p=(0,r.li)(),f=(0,D.A)(),[h,A]=(0,r.J0)(!1),[b,S,v]=(0,M.A)(),N=(0,_.yQ)(e),C="starGiftUnique"===e.type,k=C?e:void 0,G=C?void 0:e,Y=C?function(t){if(!t)return{amount:0,currency:I.OUy};if("starGiftUnique"===e.type&&e.resaleTonOnly){const e=t.find((e=>e.currency===I.ykW));if(e)return e}return t.find((e=>e.currency===I.OUy))}(k?.resellPrice):{amount:G?.stars||0,currency:I.OUy},w=Y?.currency||I.OUy,P=G?.resellMinStars,B=!C&&n&&P?f.number(P)+"+":Y?.amount||0,T=!C&&Boolean(G?.isLimited),F=!C&&Boolean(G?.isSoldOut),U=Boolean(e?.requirePremium),R=Boolean(G?.limitedPerUser&&!G?.perUserRemains),x=G?.perUserTotal,O=(0,u.A)((()=>{!F||n?R?d({message:f("NotificationGiftsLimit",{count:x},{withMarkdown:!0,withNodes:!0})}):!U||s?a(e,n?"resell":"original"):c({gift:e}):l({gift:e})})),K=(0,r.Kr)((()=>{const{backdrop:t,pattern:a}=(0,_.uc)(e)||{};if(!t||!a)return;const r=[t.centerColor,t.edgeColor],i=t.patternColor;return(0,y.Y)($.A,{className:"Nkotr8Q4",backgroundColors:r,patternColor:i,patternIcon:a.sticker})}),[e]),L=C?e.number:0,z=(0,r.Kr)((()=>{if(C){const{backdrop:t}=(0,_.uc)(e)||{};if(!t)return;return(0,y.Y)(dt.A,{color:[t.centerColor,t.edgeColor],text:f("GiftSavedNumber",{number:L})})}return U?(0,y.Y)(dt.A,{color:"orange",text:f("LimitPremium")}):n?(0,y.Y)(dt.A,{color:"green",text:f("GiftRibbonResale")}):F?(0,y.Y)(dt.A,{color:"red",text:f("GiftSoldOut")}):T?(0,y.Y)(dt.A,{color:"blue",text:f("GiftLimited")}):void 0}),[C,n,e,F,T,f,L,U]);return(0,Xe.mv)(m,t,(e=>{const t=e.isIntersecting;A(t)})),(0,y.FD)("div",{ref:m,className:(0,o.A)("interactive-gift",ut,"f5ArEO1S","starGiftItem",U&&"NBYIITte"),tabIndex:0,role:"button",onClick:O,onMouseEnter:Se.TF?void 0:S,onMouseLeave:Se.TF?void 0:v,children:[K,(0,y.Y)("div",{ref:p,className:"rUSoeQXb",style:"width: 90px; height: 90px",children:N&&(0,y.Y)(ht.A,{observeIntersectionForPlaying:t,observeIntersectionForLoading:t,containerRef:p,sticker:N,size:90,shouldLoop:b,shouldPreloadPreview:!0})}),(0,y.Y)(g.A,{className:mt,nonInteractive:!0,size:"tiny",color:C?"bluredStarsBadge":"stars",withSparkleEffect:h,pill:!0,fluid:!0,children:w===I.ykW?(0,de.Ms)(f,B||0,{shouldConvertFromNanos:!0,className:pt}):(0,de.U2)(f,B||0,{asFont:!0,className:pt})}),z]})})));var At=a(58443),bt=a(96374),St=a(64489);const vt={root:"tJK1W0pJ",transition:"pP8TxefR",content:"o3V1HqbL",resaleScreenRoot:"Vce_TsJO",main:"cVXqeu9P",giftSection:"v4eKefwN",section:"EqfarEYb",resaleStarGiftsContainer:"RSFcSNGL",starGiftsContainer:"OQX3GZl5",premiumGiftsGallery:"n40m3BK2",header:"iqqoyRgW",resaleHeader:"cJRBgg9B",resaleHeaderContentContainer:"OXYQmfGK",headerSlide:"BTWhJUQB",headerText:"lLRmbpIu",hiddenHeader:"XgGzn1cQ",resaleHeaderText:"bp_KPx8I",commonHeaderText:"ybZo03if",resaleHeaderDescription:"XefHUFm1",closeButton:"r_Y5uG1T",balance:"soqAknia",avatars:"N_7tYJKr",avatar:"_3hY4vIep",logoBackground:"ieK4TzSb",center:"Ey5gX40t",description:"ZioU5h_k",starGiftsDescription:"gFgzS8pV",boostIcon:"Qi2YR6Dz",optionBottom:"RTbClMKE",secondaryInfo:"g0R9GSNq",footer:"J3Gju3bv",starGiftsTransition:"kB6IyXqS",notFoundGiftsRoot:"UqnRlJ1n",notFoundGiftsDescription:"g0VbwIG_",notFoundGiftsLink:"j2zPEQr8"},Nt=(0,r.ph)((0,i.EK)((e=>{const{starGifts:t}=e,{resaleGifts:a}=(0,s.nTw)(e),r=a?.giftId?t?.byId[a.giftId]:void 0,i=a.filter,n=a.isAllLoaded,o=a.isLoading,l=a.updateIteration;return{resellGifts:a.gifts,gift:r,filter:i,areGiftsAllLoaded:n,areGiftsLoading:o,updateIteration:l}}))((({resellGifts:e,gift:t,filter:a,areGiftsAllLoaded:n,areGiftsLoading:s,updateIteration:l,onGiftClick:c})=>{const{loadResaleGifts:d,updateResaleGiftsFilter:m}=(0,i.ko)(),p=(0,r.li)(),f=(0,D.A)(),h=(0,r.Kr)((()=>e?.map((e=>e.id))),[e]),g=Boolean(a?.modelAttributes?.length||a?.patternAttributes?.length||a?.backdropAttributes?.length),A=(0,u.A)((()=>{t&&d({giftId:t.id})})),b=Boolean(!e||0===e.length),[S,v]=(0,bt.A)(A,h,!t,I.bcN),{observe:N}=(0,Xe.BL)({rootRef:p,throttleMs:200}),C=(0,u.A)((()=>{m({filter:{...a,modelAttributes:[],backdropAttributes:[],patternAttributes:[]}})}));return(0,y.Y)("div",{ref:p,className:(0,o.A)(vt.resaleScreenRoot,"custom-scroll"),children:(0,y.FD)(U.Ay,{name:"zoomFade",activeKey:l,children:[b&&n&&(0,y.FD)("div",{className:vt.notFoundGiftsRoot,children:[(0,y.Y)(St.A,{size:160,tgsUrl:At.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,y.Y)("div",{className:vt.notFoundGiftsDescription,children:f("ResellGiftsNoFound")}),g&&(0,y.Y)(at.A,{className:vt.notFoundGiftsLink,onClick:C,children:f("ResellGiftsClearFilters")})]}),(0,y.Y)(T.A,{className:(0,o.A)(vt.resaleStarGiftsContainer),items:S,onLoadMore:v,itemSelector:".starGiftItem",noFastList:!0,preloadBackwards:I.bcN,scrollContainerClosest:`.${vt.resaleScreenRoot}`,children:e?.map((e=>(0,y.Y)(gt,{gift:e,observeIntersection:N,isResale:!0,onClick:c},e.id)))})]})})})));var yt=a(10722),Ct=a(71429),It=a(36393),kt=a(76023),Gt=a(87094);const Yt=1.5*kt.$,wt=(0,r.ph)((0,i.EK)((e=>({theme:(0,s.SJA)(e)})))((({className:e,type:t,sticker:a,observeIntersectionForLoading:i,observeIntersectionForPlaying:n,theme:s})=>{const l=(0,r.li)(),c=(0,Gt.A)(l,void 0,"pattern"!==t);return(0,y.Y)("div",{ref:l,className:(0,o.A)("KLFLR9ji",e),style:`width: ${Yt}px; height: ${Yt}px`,children:(0,y.Y)(ht.A,{containerRef:l,sticker:a,size:Yt,shouldPreloadPreview:!0,observeIntersectionForLoading:i,observeIntersectionForPlaying:n,thumbClassName:"fCL5rY2D",customColor:c})})}))),Pt={root:"_VgmQnUg",buttonsContainer:"IDlp6U6g",itemIcon:"yuctLnuR",sticker:"VT562JS0",backdropAttributeMenuItemText:"D50wFfRL",menuItemStickerText:"THcGWXSA",menuItemText:"L6EVE2Ux",backdrop:"A29QNxKb",menuItemIcon:"GL4rVsev",item:"qiYcBOYc",menuContentContainer:"EDsBn29z",menu:"ISaNdBwd",left:"e4Kkh_MR",right:"Kz_nCGC3"},Bt=(0,r.ph)((0,i.EK)((e=>{const{resaleGifts:t}=(0,s.nTw)(e);return{attributes:t.attributes,counters:t.counters,filter:t.filter}}))((({attributes:e,counters:t,filter:a,dialogRef:n})=>{const s=(0,D.A)(),{updateResaleGiftsFilter:l}=(0,i.ko)(),[c,d]=(0,r.J0)(""),[m,p]=(0,r.J0)(""),[h,g]=(0,r.J0)(""),A=(0,r.Kr)((()=>{const a={model:[],pattern:[],backdrop:[]};for(const r of t??[]){const{attribute:t}=r;if(!r.count)continue;const i=e?.find((e=>"backdrop"===e.type&&"backdrop"===t.type?e.backdropId===t.backdropId:("model"===e.type&&"model"===t.type||"pattern"===e.type&&"pattern"===t.type)&&e.sticker.id===t.documentId));"backdrop"===i?.type&&a.backdrop.push(i),"model"===i?.type&&a.model.push(i),"pattern"===i?.type&&a.pattern.push(i)}return a}),[e,t]),b=(0,r.Kr)((()=>{const e=(e,t)=>t.trim()?e.filter((e=>Boolean(e.name?.toLowerCase().includes(t.toLowerCase())))):e;return{model:e(A.model,c),pattern:e(A.pattern,h),backdrop:e(A.backdrop,m)}}),[A,c,m,h]),S=(0,r.li)(),{isContextMenuOpen:v,contextMenuAnchor:N,handleContextMenu:C,handleContextMenuClose:I,handleContextMenuHide:k}=(0,yt.A)(n),G=(0,u.A)((()=>S.current)),Y=(0,r.li)(),{isContextMenuOpen:w,contextMenuAnchor:P,handleContextMenu:B,handleContextMenuClose:M,handleContextMenuHide:T}=(0,yt.A)(n),F=(0,u.A)((()=>Y.current)),U=(0,r.li)(),{isContextMenuOpen:R,contextMenuAnchor:x,handleContextMenu:O,handleContextMenuClose:K,handleContextMenuHide:L}=(0,yt.A)(n),z=(0,u.A)((()=>U.current)),E=(0,r.li)(),{isContextMenuOpen:V,contextMenuAnchor:H,handleContextMenu:q,handleContextMenuClose:J,handleContextMenuHide:W}=(0,yt.A)(n),_=(0,u.A)((()=>E.current)),j=(0,r.Kr)((()=>{const e=a.sortType;return({onTrigger:t,isOpen:a})=>(0,y.FD)("div",{className:Pt.item,onClick:t,children:["byDate"===e&&s("ValueGiftSortByDate"),"byNumber"===e&&s("ValueGiftSortByNumber"),"byPrice"===e&&s("ValueGiftSortByPrice"),(0,y.Y)(f.A,{name:"dropdown-arrows",className:Pt.itemIcon})]})}),[s,a]),Q=(0,r.Kr)((()=>{const e=a?.modelAttributes?.length||0;return({onTrigger:t,isOpen:a})=>(0,y.FD)("div",{className:Pt.item,onClick:t,children:[0===e&&s("GiftAttributeModel"),e>0&&s("GiftAttributeModelPlural",{count:e},{pluralValue:e}),(0,y.Y)(f.A,{name:"dropdown-arrows",className:Pt.itemIcon})]})}),[s,a]),X=(0,r.Kr)((()=>{const e=a?.backdropAttributes?.length||0;return({onTrigger:t,isOpen:a})=>(0,y.FD)("div",{className:Pt.item,onClick:t,children:[0===e&&s("GiftAttributeBackdrop"),e>0&&s("GiftAttributeBackdropPlural",{count:e},{pluralValue:e}),(0,y.Y)(f.A,{name:"dropdown-arrows",className:Pt.itemIcon})]})}),[s,a]),Z=(0,r.Kr)((()=>{const e=a?.patternAttributes?.length||0;return({onTrigger:t,isOpen:a})=>(0,y.FD)("div",{className:Pt.item,onClick:t,children:[0===e&&s("GiftAttributeSymbol"),e>0&&s("GiftAttributeSymbolPlural",{count:e},{pluralValue:e}),(0,y.Y)(f.A,{name:"dropdown-arrows",className:Pt.itemIcon})]})}),[s,a]),ee=(0,u.A)((e=>{l({filter:{...a,sortType:e}})})),te=(0,u.A)((()=>{l({filter:{...a,modelAttributes:[]}})})),ae=(0,u.A)((()=>{l({filter:{...a,patternAttributes:[]}})})),re=(0,u.A)((()=>{l({filter:{...a,backdropAttributes:[]}})})),ie=(0,u.A)((e=>{if(!t)return;const r=a.modelAttributes||[],i=t.find((t=>"model"===t.attribute.type&&t.attribute.documentId===e.sticker.id))?.attribute;if(!i)return;const n=r.some((e=>e.documentId===i.documentId))?r.filter((e=>e.documentId!==i.documentId)):[...r,i];l({filter:{...a,modelAttributes:n}})})),ne=(0,u.A)((e=>{if(!t)return;const r=a.patternAttributes||[],i=t.find((t=>"pattern"===t.attribute.type&&t.attribute.documentId===e.sticker.id))?.attribute;if(!i)return;const n=r.some((e=>e.documentId===i.documentId))?r.filter((e=>e.documentId!==i.documentId)):[...r,i];l({filter:{...a,patternAttributes:n}})})),se=(0,u.A)((e=>{if(!t)return;const r=a.backdropAttributes||[],i=t.find((t=>"backdrop"===t.attribute.type&&t.attribute.backdropId===e.backdropId))?.attribute;if(!i)return;const n=r.some((e=>e.backdropId===i.backdropId))?r.filter((e=>e.backdropId!==i.backdropId)):[...r,i];l({filter:{...a,backdropAttributes:n}})})),oe=(0,r.hb)((()=>{d("")}),[]),le=(0,r.hb)((()=>{p("")}),[]),ce=(0,r.hb)((()=>{g("")}),[]),de=(0,u.A)((e=>{e.stopPropagation(),e.preventDefault()})),ue=(0,r.li)(),{observe:me}=(0,Xe.BL)({rootRef:ue,isDisabled:!P});return(0,y.FD)("div",{className:Pt.root,children:[Boolean(N)&&(0,y.Y)(Ct.A,{isOpen:v,anchor:N,ref:S,className:(0,o.A)(Pt.menu,Pt.left,"with-menu-transitions"),getMenuElement:G,autoClose:!0,onClose:I,onCloseAnimationEnd:k,positionX:"left",children:(0,y.FD)(y.FK,{children:[(0,y.FD)(Ue.A,{icon:"sort-by-price",onClick:()=>{ee("byPrice")},children:[(0,y.Y)("div",{className:Pt.menuItemText,children:s("GiftSortByPrice")}),(0,y.Y)(f.A,{className:Pt.menuItemIcon,name:"byPrice"===a?.sortType?"check":"placeholder"})]}),(0,y.FD)(Ue.A,{icon:"sort-by-date",onClick:()=>{ee("byDate")},children:[(0,y.Y)("div",{className:Pt.menuItemText,children:s("GiftSortByDate")}),(0,y.Y)(f.A,{className:Pt.menuItemIcon,name:"byDate"===a?.sortType?"check":"placeholder"})]}),(0,y.FD)(Ue.A,{icon:"sort-by-number",onClick:()=>{ee("byNumber")},children:[(0,y.Y)("div",{className:Pt.menuItemText,children:s("GiftSortByNumber")}),(0,y.Y)(f.A,{className:Pt.menuItemIcon,name:"byNumber"===a?.sortType?"check":"placeholder"})]})]})}),Boolean(P)&&(0,y.Y)(Ct.A,{isOpen:w,anchor:P,ref:Y,className:(0,o.A)(Pt.menu,Pt.left,"with-menu-transitions"),getMenuElement:F,autoClose:!0,onClose:M,onCloseAnimationEnd:T,children:function(){const e=b.model,t=a.modelAttributes??[],r=0===t.length;return(0,y.FD)("div",{className:Pt.menuContentContainer,ref:ue,children:[(0,y.Y)(It.A,{onClick:de,className:Pt.search,value:c,onChange:d,onReset:oe,placeholder:s("Search")}),(0,y.Y)(Ue.A,{icon:"select",onClick:te,disabled:r,children:s("ContextMenuItemSelectAll")}),e.map((e=>{const a=r||t.some((t=>t.documentId===e.sticker.id));return(0,y.FD)(Ue.A,{onClick:()=>{ie(e)},children:[(0,y.Y)(wt,{className:Pt.sticker,sticker:e.sticker,type:"model",observeIntersectionForLoading:me,observeIntersectionForPlaying:me}),(0,y.Y)("div",{className:Pt.menuItemStickerText,children:e.name}),(0,y.Y)(f.A,{className:Pt.menuItemIcon,name:a?"check":"placeholder"})]},e.name)}))]})}()}),Boolean(x)&&(0,y.Y)(Ct.A,{isOpen:R,anchor:x,ref:U,className:(0,o.A)(Pt.menu,Pt.right,"with-menu-transitions"),getMenuElement:z,autoClose:!0,onClose:K,onCloseAnimationEnd:L,positionX:"right",children:function(){const e=b.backdrop,t=a.backdropAttributes??[],r=0===t.length;return(0,y.FD)("div",{className:Pt.menuContentContainer,children:[(0,y.Y)(It.A,{onClick:de,className:Pt.search,value:m,onChange:p,onReset:le,placeholder:s("Search")}),(0,y.Y)(Ue.A,{icon:"select",onClick:re,disabled:r,children:s("ContextMenuItemSelectAll")}),e.map((e=>{const a=r||t.some((t=>t.backdropId===e.backdropId));return(0,y.FD)(Ue.A,{onClick:()=>{se(e)},children:[(0,y.Y)($.A,{className:Pt.backdrop,backgroundColors:[e.centerColor,e.edgeColor],patternColor:e.patternColor}),(0,y.Y)("div",{className:Pt.backdropAttributeMenuItemText,children:e.name}),(0,y.Y)(f.A,{className:Pt.menuItemIcon,name:a?"check":"placeholder"})]},e.name)}))]})}()}),Boolean(H)&&(0,y.Y)(Ct.A,{isOpen:V,anchor:H,ref:E,className:(0,o.A)(Pt.menu,Pt.right,"with-menu-transitions"),getMenuElement:_,autoClose:!0,onClose:J,onCloseAnimationEnd:W,children:function(){const e=b.pattern,t=a.patternAttributes??[],r=0===t.length;return(0,y.FD)("div",{className:Pt.menuContentContainer,children:[(0,y.Y)(It.A,{onClick:de,className:Pt.search,value:h,onChange:g,onReset:ce,placeholder:s("Search")}),(0,y.Y)(Ue.A,{icon:"select",onClick:ae,disabled:r,children:s("ContextMenuItemSelectAll")}),e.map((e=>{const a=r||t.some((t=>t.documentId===e.sticker.id));return(0,y.FD)(Ue.A,{onClick:()=>{ne(e)},children:[(0,y.Y)(wt,{className:Pt.sticker,sticker:e.sticker,type:"pattern"}),(0,y.Y)("div",{className:Pt.menuItemStickerText,children:e.name}),(0,y.Y)(f.A,{className:Pt.menuItemIcon,name:a?"check":"placeholder"})]},e.name)}))]})}()}),(0,y.FD)("div",{className:Pt.buttonsContainer,children:[(0,y.Y)(j,{onTrigger:C,isOpen:v}),(0,y.Y)(Q,{onTrigger:B,isOpen:w}),(0,y.Y)(X,{onTrigger:O,isOpen:R}),(0,y.Y)(Z,{onTrigger:q,isOpen:V})]})]})})));var Mt=a(36838);const Dt=(0,r.ph)((0,i.EK)((e=>{const{starGifts:t}=e;return{idsByCategory:t?.idsByCategory}}))((({idsByCategory:e,onCategoryChanged:t,areLimitedStarGiftsDisallowed:a})=>{const i=(0,r.li)(),n=(0,D.A)(),s=(0,r.Kr)((()=>e&&Object.keys(e).filter((e=>"all"!==e&&"limited"!==e)).map(Number).sort(((e,t)=>e-t))),[e]),l=e&&e.resale.length>0,[c,d]=(0,r.J0)("all");function u(e){return"all"===e?n("AllGiftsCategory"):"stock"===e?n("StockGiftsCategory"):"limited"===e?n("LimitedGiftsCategory"):"resale"===e?n("GiftCategoryResale"):e}function m(e){return(0,y.FD)("div",{className:(0,o.A)("dO7FKYY4",c===e&&"B2lEJk1v"),onClick:()=>function(e){d(e),t(e)}(e),children:[Number.isInteger(e)&&(0,y.Y)(K.A,{className:"Pb7AU805",type:"gold",size:"middle"}),u(e)]})}return(0,Mt.A)(i,void 0,!0),(0,y.FD)("div",{ref:i,className:(0,o.A)("cUjwvN00","no-scrollbar"),children:[m("all"),!a&&m("limited"),!a&&l&&m("resale"),m("stock"),s?.map(m)]})}))),Tt=[0,-50],Ft=(0,Qe.nF)((e=>e()),200,!0),Ut=(0,r.ph)((0,i.EK)(((e,{modal:t})=>{const{starGifts:a,stars:r,currentUserId:i}=e,n=t?.forPeerId?(0,s.PVB)(e,t.forPeerId):void 0,o=Boolean(i&&t?.forPeerId===i),l=n?(0,s.vGo)(e,n?.id):void 0,{resaleGifts:c}=(0,s.nTw)(e),d=c.count,u=!1!==c.isLoading;return{boostPerSentGift:e.appConfig?.boostsPerSentGift,starGiftsById:a?.byId,starGiftIdsByCategory:a?.idsByCategory,starBalance:r?.balance,peer:n,isSelf:o,disallowedGifts:l?.disallowedGifts,resaleGiftsCount:d,areResaleGiftsLoading:u}}))((({modal:e,starGiftsById:t,starGiftIdsByCategory:a,starBalance:s,peer:l,isSelf:c,disallowedGifts:f,resaleGiftsCount:b,areResaleGiftsLoading:S})=>{const{closeGiftModal:v,openGiftInfoModal:N,resetResaleGifts:C,loadResaleGifts:G}=(0,i.ko)(),Y=(0,r.li)(),w=(0,r.li)(),P=(0,r.li)(),B=(0,r.li)(),M=Boolean(e),T=(0,d.A)(e),F=l&&(0,n.mO)(l)?l:void 0,R=l&&(0,n.vj)(l)?l:void 0,[x,O]=(0,r.J0)(),[K,L]=(0,r.J0)(),[E,V]=(0,r.J0)(!1),[H,q]=(0,r.J0)(!1),[J,W]=(0,r.J0)(!1),[_,j]=(0,r.J0)("all"),Q=(0,r.li)(),X=(0,r.Kr)((()=>{if(!f)return;const{shouldDisallowPremiumGifts:e,...t}=f;return!c&&Object.values(t).every(Boolean)}),[c,f]),$=!c&&f?.shouldDisallowUnlimitedStarGifts,Z=!c&&f?.shouldDisallowLimitedStarGifts,ee=(0,m.A)(),te=(0,D.A)(),ae=T?.gifts,re=(0,r.Kr)((()=>ae?.sort(((e,t)=>e.months-t.months)).filter((e=>1===e.users&&e.currency!==I.OUy))),[ae]),ie=(0,r.Kr)((()=>{const e=new Map;return re?(re.forEach((t=>{const a=ae?.find((e=>e.currency===I.OUy&&e.months===t.months));a&&e.set(t,a)})),e):e}),[ae,re]),ne=(0,r.Kr)((()=>re?.reduce(((e,t)=>e.amount<t.amount?e:t))),[re]),{observe:se}=(0,Xe.BL)({rootRef:B,throttleMs:200,isDisabled:!M}),oe=Boolean(K)&&!x,le=Boolean(x),ce=oe||le||E,de=le?J:H;(0,r.vJ)((()=>{K&&G({giftId:K.id})}),[K]),(0,r.vJ)((()=>{M||(V(!1),O(void 0),L(void 0),j("all"))}),[M]);const ue=(0,u.A)((e=>{if(le)return;const t=e.currentTarget;Ft((()=>{const{scrollTop:e}=t;if(V(e>150),w.current&&P.current){const{top:e}=P.current.getBoundingClientRect(),{top:t}=w.current.getBoundingClientRect();q(e-t<=0)}}))})),me=te("GiftPremiumDescription",{user:(0,k.Yg)(F),link:(0,y.Y)(h.A,{text:te("GiftPremiumDescriptionLinkCaption"),url:te("GiftPremiumDescriptionLink")})},{withNodes:!0}),pe=R?te("StarGiftDescriptionChannel",{peer:(0,n.F9)(te,R)},{withNodes:!0,withMarkdown:!0}):c?te("StarGiftDescriptionSelf",void 0,{withNodes:!0,renderTextFilters:["br"]}):te("StarGiftDescription",{user:(0,k.Yg)(F)},{withNodes:!0,withMarkdown:!0}),fe=(0,u.A)(((e,t)=>{if("resell"===t){if(!("id"in e))return;return oe?void N({gift:e,recipientId:T?.forPeerId}):void L(e)}O(e),W("id"in e)}));const he=(0,u.A)((e=>{j(e)})),ge=(0,u.A)((()=>{O(void 0),L(void 0),C(),v()})),be=(0,u.A)((()=>{if(oe)return L(void 0),void C();le?O(void 0):ge()})),Se=(0,u.A)((()=>{Q.current?.()})),ve=(0,u.A)((e=>{Q.current=e})),Ne=le||oe,ye=(0,o.A)("animated-close-icon",Ne&&"state-back");return(0,y.FD)(A.A,{dialogRef:Y,onClose:ge,isOpen:M,isSlim:!0,contentClassName:vt.content,className:(0,o.A)(vt.modalDialog,vt.root),isLowStackPriority:!0,children:[(0,y.Y)(g.A,{className:vt.closeButton,round:!0,color:"translucent",size:"smaller",onClick:be,ariaLabel:ee(Ne?"Common.Back":"Common.Close"),children:(0,y.Y)("div",{className:ye})}),(0,y.Y)(z,{className:vt.balance,balance:s,withAddButton:!0}),(0,y.Y)("div",{className:(0,o.A)(vt.header,oe&&vt.resaleHeader,!ce&&vt.hiddenHeader),children:(0,y.Y)(U.Ay,{name:"slideVerticalFade",activeKey:ce?oe?1:de?2:3:0,slideClassName:vt.headerSlide,children:function(){if(ce){if(oe){const e=S&&!b;return(0,y.FD)("div",{className:vt.resaleHeaderContentContainer,children:[(0,y.Y)("h2",{className:vt.resaleHeaderText,children:K.title}),e&&(0,y.Y)("div",{className:vt.resaleHeaderDescription,children:te("Loading")}),!e&&void 0!==b&&(0,y.Y)("div",{className:vt.resaleHeaderDescription,children:te("HeaderDescriptionResaleGifts",{count:b},{withNodes:!0,withMarkdown:!0,pluralValue:b})}),(0,y.Y)(Bt,{dialogRef:Y})]})}return(0,y.Y)("h2",{className:vt.commonHeaderText,children:te(de?c?"StarsGiftHeaderSelf":"StarsGiftHeader":"GiftPremiumHeader")})}}()})}),(0,y.FD)(U.Ay,{ref:w,className:vt.transition,name:"pushSlide",activeKey:le?1:oe?2:0,children:[!le&&!oe&&(0,y.FD)("div",{ref:B,className:(0,o.A)(vt.main,"custom-scroll"),onScroll:ue,children:[(0,y.FD)("div",{className:vt.avatars,children:[(0,y.Y)(p.A,{className:vt.avatar,size:100,peer:l,onMouseMove:Se}),(0,y.Y)(Ae.A,{className:vt.logoBackground,color:"gold",centerShift:Tt,onRequestAnimation:ve})]}),!c&&!R&&!f?.shouldDisallowPremiumGifts&&(0,y.FD)(y.FK,{children:[(0,y.Y)("h2",{className:(0,o.A)(vt.headerText,vt.center),children:te("GiftPremiumHeader")}),(0,y.Y)("p",{className:(0,o.A)(vt.description,vt.center),children:me}),(0,y.Y)("div",{className:vt.premiumGiftsGallery,children:re?.map((e=>(0,y.Y)(ft,{option:e,optionByStars:ie.get(e),baseMonthAmount:ne?Math.floor(ne.amount/ne.months):void 0,onClick:fe})))})]}),!X&&(0,y.FD)(y.FK,{children:[(0,y.Y)("h2",{ref:P,className:(0,o.A)(vt.headerText,vt.center),children:te(c?"StarsGiftHeaderSelf":"StarsGiftHeader")}),(0,y.Y)("p",{className:(0,o.A)(vt.description,vt.starGiftsDescription,vt.center),children:pe}),(0,y.Y)(Dt,{areLimitedStarGiftsDisallowed:Z,onCategoryChanged:he}),(0,y.Y)(U.Ay,{name:"zoomFade",activeKey:(Ce=_,"all"===Ce?0:"limited"===Ce?1:"resale"===Ce?2:"stock"===Ce?3:Ce+3),className:vt.starGiftsTransition,children:function(){const e=a?.[_]?.filter((e=>{const a=t?.[e];if(!a)return!1;const{isLimited:r,isSoldOut:i,upgradeStars:n}=a;return $&&!Z?r:Z&&!$?!r&&!i:!$||!Z||Boolean(r&&Boolean(n))}));return(0,y.Y)("div",{className:vt.starGiftsContainer,children:t&&e?.flatMap((e=>{const a=t[e],r="stock"!==_&&Boolean(a.availabilityResale),i="resale"!==_&&r&&!a.isSoldOut,n=[(0,y.Y)(gt,{gift:a,observeIntersection:se,isResale:r&&!i,onClick:fe},e)];return i&&n.push((0,y.Y)(gt,{isResale:!0,gift:a,observeIntersection:se,onClick:fe},`resale_${e}`)),n}))})}()})]})]}),oe&&K&&(0,y.Y)(Nt,{onGiftClick:fe}),le&&T?.forPeerId&&(0,y.Y)(ct,{gift:x,giftByStars:ie.get(x),peerId:T.forPeerId})]})]});var Ce})));const Rt=(0,r.ph)((0,i.EK)((e=>{const{currentUserId:t}=e;return{currentUserId:t,userIds:e.contactList?.userIds}}))((({modal:e,currentUserId:t,userIds:a})=>{const{closeGiftRecipientPicker:o,openGiftModal:l}=(0,i.ko)(),c=(0,m.A)(),d=e,[p,f]=(0,r.J0)(""),h=(0,r.Kr)((()=>{const e=(0,i.mS)(),r=a?a.concat(t):void 0,o=r?(0,n.PU)({ids:r,query:p}):[];return(0,Y.A)((0,G.Am)(o).filter((t=>(0,s.X2D)(e,t))),void 0,[t])}),[t,p,a]),g=(0,u.A)((e=>{l({forUserId:e}),o()}));return(0,y.Y)(P.A,{className:"W3JMs1YE",isOpen:d,onClose:o,title:c("GiftTelegramPremiumOrStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,children:(0,y.Y)(w.A,{className:"wOipz1Y_",itemIds:h,filterValue:p,filterPlaceholder:c("Search"),onSelectedIdChange:g,onFilterChange:f,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,forceShowSelf:!0})})})));var xt=a(79089),Ot=a(80140),Kt=a(18501),Lt=a(25404);const zt={root:"Ef0cKSqQ",giftPreview:"IvuNzslN",backdrop:"dNukis4X",arrow:"oufsMLLF"},Et=4*kt.$,Vt=3*kt.$,Ht=(0,r.ph)((({peer:e,gift:t})=>{const a=(0,r.Kr)((()=>(0,_.uc)(t)),[t]);if(a)return(0,y.FD)("div",{className:zt.root,children:[(0,y.FD)("div",{className:zt.giftPreview,children:[(0,y.Y)($.A,{className:zt.backdrop,backgroundColors:[a.backdrop.centerColor,a.backdrop.edgeColor],patternColor:a.backdrop?.patternColor,patternIcon:a.pattern?.sticker}),(0,y.Y)(X.A,{className:zt.sticker,size:Vt,sticker:a.model?.sticker})]}),(0,y.Y)(f.A,{name:"next",className:zt.arrow}),(0,y.Y)(p.A,{peer:e,size:Et,className:zt.avatar})]})}));var qt=a(94189);const Jt={modal:"nnublcCk",checkBox:"fjE0wGvw",checkBoxDescription:"tepUTe4z",upgradeIcon:"lgyInH5K",header:"p7FTs7_p",title:"pIbzzTir",description:"CCPfr26t",soldOut:"kjWcRp4W",headerSplitButton:"XOMI_4PO",headerButton:"WA0INleU",giftResalePriceContainer:"BN8gf5y6",starAmountIcon:"_5guecUe",giftResalePriceStar:"H_q8o2vY",left:"aOhTHZlf",right:"rJOB1u5Q",footer:"bho0GTYt",footerDescription:"VUylTszM",unknown:"zDauXmpS",giftValue:"w_E4LkUj",uniqueAttribute:"OJQnkf17",uniqueGift:"I6o_pGAm",modalHeader:"ie9tImaj",modalCloseButton:"p38RBGdC",ownerAddress:"DavMRg4Q",copyIcon:"SLX5tX8C"},Wt=(0,r.ph)((0,i.EK)(((e,{modal:t})=>{const a=t?.gift,r=a&&"gift"in a,i=e.currentUserId,o=r&&a.fromId,l=o?(0,s.PVB)(e,o):void 0,c=t?.peerId?(0,s.PVB)(e,t.peerId):void 0,d=c&&(0,n.vj)(c)?c:void 0,u=d&&(0,k.ub)(d,"postMessages"),m=(0,s.mBe)(e,i),p=t?.recipientId&&i!==t.recipientId?(0,s.PVB)(e,t.recipientId):void 0,f=m?.emojiStatus,h=e.collectibleEmojiStatuses?.statuses,g=r?a.gift:a,A="starGiftUnique"===g?.type&&g.releasedByPeerId;return{fromPeer:l,targetPeer:c,releasedByPeer:A?(0,s.PVB)(e,A):void 0,currentUserId:i,starGiftMaxConvertPeriod:e.appConfig?.starGiftMaxConvertPeriod,tonExplorerUrl:e.appConfig?.tonExplorerUrl,hasAdminRights:u,currentUserEmojiStatus:f,collectibleEmojiStatuses:h,currentUser:m,recipientPeer:p}}))((({modal:e,fromPeer:t,targetPeer:a,releasedByPeer:l,currentUserId:c,starGiftMaxConvertPeriod:A,hasAdminRights:b,currentUserEmojiStatus:S,collectibleEmojiStatuses:v,tonExplorerUrl:N,currentUser:C,recipientPeer:k})=>{const{closeGiftInfoModal:G,changeGiftVisibility:Y,convertGiftToStars:w,openChatWithInfo:P,focusMessage:B,openGiftUpgradeModal:T,showNotification:F,buyStarGift:U,closeGiftModal:R}=(0,i.ko)(),[x,K,L]=(0,M.A)(),z=(0,D.A)(),H=(0,m.A)(),[q,J]=(0,r.J0)(!1),[j,Q]=(0,r.J0)(!1),$=Boolean(e),Z=(0,d.A)(e),ee=(0,d.A)(t),te=(0,d.A)(a),ae=te&&(0,n.vj)(te),{gift:re}=Z||{},ie=re&&"gift"in re,ne=ie?re:void 0,se=ne?.fromId===c,oe=ne&&A&&ne.date+A-(0,Ot.Fm)()||0,le=Math.ceil(oe/60/60/24),ce=ie?re.gift:re,ue=ce&&(0,_.yQ)(ce),me=oe>0&&Boolean(ne?.starsToConvert),pe=ce&&"starGiftUnique"===ce.type,fe=pe?ce:void 0,he=(0,r.Kr)((()=>{if(ce&&"starGiftUnique"===ce.type){if(l){const e=`@${(0,xt.Kl)(l)}`||(0,n.F9)(z,l),t=(0,n.mO)(l)?z("ActionFallbackUser"):z("ActionFallbackChannel");return z("GiftInfoCollectibleBy",{number:ce.number,owner:e||t},{withNodes:!0,withMarkdown:!0})}return z("GiftInfoCollectible",{number:ce.number})}}),[ce,l,z]),Ae=Boolean(ne?.upgradeMsgId),Se=!Ae&&ne?.inputGift&&(ae?b:te?.id===c);function ve(e){if(!pe)return;const t=ce.resellPrice;return t?ce?.resaleTonOnly||e?t.find((e=>e.currency===I.ykW)):t.find((e=>e.currency===I.OUy)):void 0}const Ne=ve(),Ce=ve(j),Ie="starGiftUnique"===ce?.type&&ce.ownerId!==c&&Boolean(Ne),ke=(()=>{if(!pe)return;const{ownerName:e,ownerId:t}=ce,a=(0,i.mS)(),r=t?(0,s.PVB)(a,t):void 0;return r?(0,n.F9)(z,r):e})(),Ge=(0,u.A)((()=>{G()})),Ye=(0,u.A)((()=>{const e=se?te:ee;if(!ne?.upgradeMsgId||!e)return;const{upgradeMsgId:t}=ne;B({chatId:e.id,messageId:t}),Ge()})),we=(0,u.A)((()=>{const{inputGift:e,isUnsaved:t}=ne;Y({gift:e,shouldUnsave:!t}),Ge()})),Pe=(0,u.A)((()=>{const{inputGift:e}=ne;w({gift:e}),L(),Ge()})),Be=(0,u.A)((()=>{ne&&T({giftId:ne.gift.id,gift:ne})})),Me=(0,u.A)((()=>{"starGiftUnique"===ce?.type&&ve()&&J(!0)})),De=(0,u.A)((()=>{J(!1)})),Ue=(0,u.A)((()=>{const e=k||C,t=ve(j);e&&t&&"starGiftUnique"===ce?.type&&(De(),R(),U({peerId:e.id,slug:ce.slug,price:t}))})),Re=(0,r.Kr)((()=>ce&&(0,_.uc)(ce)),[ce]),xe=(0,r.Kr)((()=>({onTrigger:e})=>(0,y.Y)("div",{className:(0,o.A)(Jt.headerButton,Jt.left),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":z("AriaMoreButton"),onClick:e,children:(0,y.Y)(f.A,{name:"more",className:Jt.icon})})),[z]),Oe=(0,u.A)((()=>Ie?(0,y.Y)(g.A,{noForcedUpperCase:!0,size:"smaller",onClick:Me,children:z("ButtonBuyGift",{stars:Ne?.currency===I.ykW?(0,de.Ms)(z,Ne.amount,{shouldConvertFromNanos:!0}):(0,de.U2)(z,Ne?.amount,{asFont:!0})},{withNodes:!0})}):Ae?(0,y.Y)(g.A,{size:"smaller",onClick:Ye,children:z("GiftInfoViewUpgraded")}):Se&&ne?.alreadyPaidUpgradeStars&&!ne.upgradeMsgId?(0,y.FD)(g.A,{size:"smaller",isShiny:!0,onClick:Be,children:[z("GiftInfoUpgradeForFree"),(0,y.Y)(f.A,{name:"arrow-down-circle",className:Jt.upgradeIcon})]}):Se&&ne.canUpgrade&&!ne.upgradeMsgId?(0,y.FD)(g.A,{size:"smaller",isShiny:!0,onClick:Be,children:[z("GiftInfoUpgrade"),(0,y.Y)(f.A,{name:"arrow-down-circle",className:Jt.upgradeIcon})]}):(0,y.Y)(g.A,{size:"smaller",onClick:Ge,children:z("OK")}))),Ke=(0,r.Kr)((()=>{if(!ce)return;let e="";return"starGift"===ce.type&&(ce.firstSaleDate&&(e+=`${z("GiftInfoFirstSale")} ${(0,E.L2)(1e3*ce.firstSaleDate,z.code,!0)}`),ce.lastSaleDate&&(e+="\n",e+=`${z("GiftInfoLastSale")} ${(0,E.L2)(1e3*ce.lastSaleDate,z.code,!0)}`)),e}),[ce,z]),Le=(0,r.Kr)((()=>{if(!re||!ce)return;const{fromId:e,isNameHidden:t,starsToConvert:a,isUnsaved:r,isConverted:c,upgradeMsgId:d}=ne||{},u=me&&Boolean(a),m=t&&te,g=(()=>{if(!ne)return z("GiftInfoSoldOutDescription");if(!ae){if(ne.upgradeMsgId)return z("GiftInfoDescriptionUpgraded");if(Se&&ne.canUpgrade&&ne.alreadyPaidUpgradeStars&&!ne.upgradeMsgId)return z("GiftInfoDescriptionUpgrade");if(ne.canUpgrade&&Se)return Se?z("GiftInfoDescriptionFreeUpgrade"):z("GiftInfoPeerDescriptionFreeUpgradeOut",{peer:(0,n.F9)(z,te)});if(Se||se)return c&&u?Se?z("GiftInfoDescriptionConverted",{amount:a},{pluralValue:a,withNodes:!0,withMarkdown:!0}):z("GiftInfoPeerDescriptionOutConverted",{amount:a,peer:(0,n.F9)(z,te)},{pluralValue:a,withNodes:!0,withMarkdown:!0}):ne.canUpgrade&&Se?u?z("GiftInfoDescriptionUpgrade",{amount:a},{pluralValue:a,withNodes:!0,withMarkdown:!0}):z("GiftInfoDescriptionUpgradeRegular"):Se?u?z("GiftInfoDescription",{amount:a},{withNodes:!0,withMarkdown:!0,pluralValue:a}):z("GiftInfoDescriptionRegular"):u?z("GiftInfoPeerDescriptionOut",{amount:a,peer:(0,n.F9)(z,te)},{withNodes:!0,withMarkdown:!0,pluralValue:a}):z("GiftInfoPeerDescriptionOutRegular",{peer:(0,n.F9)(z,te)})}})(),A=(0,y.Y)(Fe.A,{className:"with-menu-transitions",trigger:xe,positionX:"right",children:(0,y.Y)(Lt.A,{peerId:Z.peerId,gift:re,canManage:Se,collectibleEmojiStatuses:v,currentUserEmojiStatus:S})}),b=(0,y.FD)("div",{className:Jt.modalHeader,children:[Ie&&(0,y.Y)("div",{className:Jt.giftResalePriceContainer,children:Ne.currency===I.ykW?(0,de.Ms)(z,Ne.amount,{className:Jt.giftResalePriceStar,shouldConvertFromNanos:!0}):(0,de.U2)(z,Ne.amount,{asFont:!0,className:Jt.giftResalePriceStar})}),(0,y.FD)("div",{className:Jt.headerSplitButton,children:[$&&A,(0,y.Y)("div",{className:(0,o.A)(Jt.headerButton,Jt.right),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":z("Close"),onClick:Ge,children:(0,y.Y)(f.A,{name:"close",className:(0,o.A)(Jt.icon,Jt.moreIcon)})})]})]}),C=pe&&(0,y.Y)("div",{className:(0,o.A)(Jt.header,Jt.uniqueGift),children:(0,y.Y)(ye,{backdropAttribute:Re.backdrop,patternAttribute:Re.pattern,modelAttribute:Re.model,title:ce.title,subtitle:he,subtitlePeer:l})}),k=(0,y.FD)("div",{className:Jt.header,children:[(0,y.Y)(X.A,{className:Jt.giftSticker,sticker:ue,size:120}),(0,y.Y)("h1",{className:Jt.title,children:pe?ce.title:z(ne?Se?"GiftInfoReceived":"GiftInfoTitle":"GiftInfoSoldOutTitle")}),Boolean(g)&&(0,y.Y)("p",{className:(0,o.A)(Jt.description,!ne&&"starGift"===ce?.type&&Jt.soldOut),children:g})]}),Y=[];if("starGift"===ce.type){(e||t)&&Y.push([z("GiftInfoFrom"),e?{chatId:e}:(0,y.FD)(y.FK,{children:[(0,y.Y)(p.A,{size:"small",peer:W.I5}),(0,y.Y)("span",{className:Jt.unknown,children:H(W.I5.titleKey)})]})]),ne?.date&&Y.push([z("GiftInfoDate"),(0,y.Y)("span",{title:Ke,children:(0,E.L2)(1e3*ne.date,z.code,!0)})]),ce.firstSaleDate&&!ne&&Y.push([z("GiftInfoFirstSale"),(0,E.L2)(1e3*ce.firstSaleDate,z.code,!0)]),ce.lastSaleDate&&!ne&&Y.push([z("GiftInfoLastSale"),(0,E.L2)(1e3*ce.lastSaleDate,z.code,!0)]);const r=ce.stars+(ne?.alreadyPaidUpgradeStars||0);Y.push([z("GiftInfoValue"),(0,y.FD)("div",{className:Jt.giftValue,children:[(0,de.U2)(z,r,{className:Jt.starAmountIcon}),Se&&me&&Boolean(a)&&(0,y.Y)(O.A,{onClick:K,children:z("GiftInfoConvert",{amount:a},{pluralValue:a})})]})]),ce.availabilityTotal&&Y.push([z("GiftInfoAvailability"),z("GiftInfoAvailabilityValue",{count:ce.availabilityRemains||0,total:ce.availabilityTotal},{pluralValue:ce.availabilityRemains||0})]),ce.upgradeStars&&!d&&Y.push([z("GiftInfoStatus"),(0,y.Y)("div",{className:Jt.giftValue,children:z("GiftInfoStatusNonUnique")})]),ne?.message&&Y.push([void 0,(0,Kt.fd)(ne.message)])}if(pe){const{ownerName:e,ownerAddress:t,ownerId:a}=ce,r=a?(0,s.PVB)((0,i.mS)(),a):void 0,{model:o,backdrop:l,pattern:c,originalDetails:d}=Re||{};if(t?Y.push([z("GiftInfoOwner"),(0,y.FD)("span",{className:Jt.ownerAddress,onClick:()=>{(0,ge.eM)(t),F({message:{key:"WalletAddressCopied"},icon:"copy"})},children:[t,(0,y.Y)(f.A,{className:Jt.copyIcon,name:"copy"})]})]):(r||e)&&Y.push([z("GiftInfoOwner"),a?{chatId:a,withEmojiStatus:!0}:e||""]),o&&Y.push([z("GiftAttributeModel"),(0,y.FD)("span",{className:Jt.uniqueAttribute,children:[o.name,(0,y.Y)(O.A,{children:(0,V.l9)(o.rarityPercent)})]})]),l&&Y.push([z("GiftAttributeBackdrop"),(0,y.FD)("span",{className:Jt.uniqueAttribute,children:[l.name,(0,y.Y)(O.A,{children:(0,V.l9)(l.rarityPercent)})]})]),c&&Y.push([z("GiftAttributeSymbol"),(0,y.FD)("span",{className:Jt.uniqueAttribute,children:[c.name,(0,y.Y)(O.A,{children:(0,V.l9)(c.rarityPercent)})]})]),Y.push([z("GiftInfoAvailability"),z("GiftInfoIssued",{issued:ce.issuedCount,total:ce.totalCount})]),d){const{date:e,recipientId:t,message:a,senderId:r}=d,o=(0,i.mS)(),l=e=>{P({id:e}),G()},c=(0,s.PVB)(o,t),u=r?(0,s.PVB)(o,r):void 0,m=(0,E.L2)(1e3*e,z.code,!0),p=(0,y.Y)(at.A,{onClick:()=>l(t),isPrimary:!0,children:(0,n.F9)(z,c)});let f;if(u&&r!==t){const e=(0,y.Y)(at.A,{onClick:()=>l(u.id),isPrimary:!0,children:(0,n.F9)(z,u)});f=a?z("GiftInfoPeerOriginalInfoTextSender",{peer:p,sender:e,text:(0,Kt.fd)(a),date:m},{withNodes:!0}):z("GiftInfoPeerOriginalInfoSender",{peer:p,date:m,sender:e},{withNodes:!0})}else f=a?z("GiftInfoPeerOriginalInfoText",{peer:p,text:(0,Kt.fd)(a),date:m},{withNodes:!0}):z("GiftInfoPeerOriginalInfo",{peer:p,date:m},{withNodes:!0});Y.push([void 0,(0,y.Y)("span",{children:f})])}}const w=N&&pe&&ce.giftAddress&&`${N}${ce.giftAddress}`,B=(0,y.FD)("div",{className:Jt.footer,children:[(Se||w||Ie)&&(0,y.FD)("div",{className:Jt.footerDescription,children:[w&&(0,y.Y)("div",{children:z("GiftInfoTonText",{link:(0,y.Y)(h.A,{url:w,shouldSkipModal:!0,text:z("GiftInfoTonLinkText")})},{withNodes:!0})}),Se&&(0,y.Y)("div",{children:z(`GiftInfo${ae?"Channel":""}${r?"Hidden":"Saved"}`,{link:(0,y.Y)(at.A,{isPrimary:!0,onClick:we,children:z("GiftInfoSaved"+(r?"Show":"Hide"))})},{withNodes:!0})}),!Ie&&m&&(0,y.Y)("div",{children:z("GiftInfoSenderHidden")}),Ie&&ke&&(0,y.Y)("div",{children:z("GiftInfoBuyGift",{user:ke},{withNodes:!0})})]}),Oe()]});return{modalHeader:pe?b:void 0,header:pe?C:k,tableData:Y,footer:B}}),[re,ne,te,ue,z,Se,me,se,H,N,ce,Re,Oe,ae,xe,pe,Z,v,S,Ke,Ie,ke,$,Ne,he,l]);return(0,y.FD)(y.FK,{children:[(0,y.Y)(be.A,{isOpen:$,modalHeader:Le?.modalHeader,header:Le?.header,hasBackdrop:pe,tableData:Le?.tableData,footer:Le?.footer,className:Jt.modal,onClose:Ge,withBalanceBar:Boolean(Ie),currencyInBalanceBar:Ce?.currency,isLowStackPriority:!0}),fe&&C&&Boolean(Ce)&&(0,y.FD)(qt.A,{isOpen:q,noDefaultTitle:!0,onClose:De,confirmLabel:z("ButtonBuyGift",{stars:Ce?.currency===I.ykW?(0,de.Ms)(z,Ce.amount,{shouldConvertFromNanos:!0}):(0,de.U2)(z,Ce.amount,{asFont:!0})},{withNodes:!0}),confirmHandler:Ue,children:[(0,y.Y)(Ht,{peer:k||C,gift:fe}),!k&&(0,y.Y)("p",{children:z("GiftBuyConfirmDescription",{gift:z("GiftUnique",{title:fe.title,number:fe.number}),stars:Ce?.currency===I.ykW?(0,de.QH)(z,Ce.amount,!0):(0,de.Kk)(z,Ce.amount)},{withNodes:!0,withMarkdown:!0})}),k&&(0,y.Y)("p",{children:z("GiftBuyForPeerConfirmDescription",{gift:z("GiftUnique",{title:fe.title,number:fe.number}),stars:Ce?.currency===I.ykW?(0,de.QH)(z,Ce.amount,!0):(0,de.Kk)(z,Ce.amount),peer:(0,n.F9)(z,k)},{withNodes:!0,withMarkdown:!0})}),!fe.resaleTonOnly&&(0,y.FD)(y.FK,{children:[(0,y.Y)(Te.A,{className:Jt.checkBox,label:z("LabelPayInTON"),checked:j,onCheck:Q}),(0,y.Y)("div",{className:Jt.checkBoxDescription,children:z("DescriptionPayInTON")})]})]}),ne&&(0,y.FD)(qt.A,{isOpen:x,onClose:L,confirmHandler:Pe,title:z("GiftInfoConvertTitle"),children:[(0,y.Y)("div",{children:z("GiftInfoPeerConvertDescription",{amount:(0,de.Kk)(z,ne.starsToConvert),peer:(0,n.F9)(z,ee)},{withNodes:!0,withMarkdown:!0})}),me&&(0,y.Y)("div",{children:z("GiftInfoConvertDescriptionPeriod",{count:le},{withNodes:!0,withMarkdown:!0,pluralValue:le})}),(0,y.Y)("div",{children:z("GiftInfoConvertDescription2")})]})]})})));var _t=a(40664);const jt=(0,r.ph)((0,i.EK)((e=>{const t=e.appConfig?.starsStargiftResaleCommissionPermille,a=t?t/1e3:void 0,r=e.appConfig?.starsStargiftResaleAmountMin||0,i=e.appConfig?.starsStargiftResaleAmountMax,n=e.appConfig?.starsUsdWithdrawRateX1000,s=n?n/1e3:1,o=e.appConfig?.tonStargiftResaleCommissionPermille,c=o?o/1e3:0,d=(0,l.wD)(e.appConfig?.tonStargiftResaleAmountMin||0),u=e.appConfig?.tonStargiftResaleAmountMax,m=u&&(0,l.wD)(u),p=e.appConfig?.tonUsdRate;return{starsStargiftResaleCommissionPermille:a,starsStargiftResaleAmountMin:r,starsStargiftResaleAmountMax:i,starsUsdWithdrawRate:s,tonStargiftResaleCommissionPermille:c,tonStargiftResaleAmountMin:d,tonStargiftResaleAmountMax:m,tonUsdRate:p}}))((({modal:e,starsStargiftResaleCommissionPermille:t,starsStargiftResaleAmountMin:a,starsStargiftResaleAmountMax:n,starsUsdWithdrawRate:s,tonStargiftResaleCommissionPermille:o,tonStargiftResaleAmountMin:c,tonStargiftResaleAmountMax:m,tonUsdRate:p})=>{const{closeGiftResalePriceComposerModal:f,closeGiftInfoModal:h,updateStarGiftPrice:b,showNotification:S}=(0,i.ko)(),v=Boolean(e),[N,C]=(0,r.J0)(void 0),[I,k]=(0,r.J0)(!1),G=(0,d.A)(e),{gift:Y}=G||{},w=Y&&"gift"in Y?Y:void 0,P=Boolean(N),B=(0,D.A)(),M=(0,u.A)((e=>{const t=e.target.value,a=parseFloat(t),r=I?m:n,i=""===t||Number.isNaN(a)?void 0:r?Math.min(a,r):a;C(i)})),T=(0,u.A)((()=>{f()})),F=(0,u.A)((()=>{w&&"starGiftUnique"===w.gift.type&&w.inputGift&&N&&(f(),h(),b({gift:w.inputGift,price:{currency:I?"TON":"XTR",amount:I?(0,l.tT)(N):N,nanos:0}}),S({icon:"sell-outline",message:{key:"NotificationGiftIsSale",variables:{gift:B("GiftUnique",{title:w.gift.title,number:w.gift.number})}}}))})),U=I?o:t,R=I?c:a,x=P&&N>=R;return(0,y.FD)(A.A,{isOpen:v,title:B(I?"PriceInTON":"PriceInStars"),hasCloseButton:!0,isSlim:!0,onClose:T,children:[(0,y.Y)("div",{className:"ElDo1Bru",children:(0,y.Y)(_t.A,{label:B(I?"EnterPriceInTon":"EnterPriceInStars"),onChange:M,value:N?.toString(),inputMode:"numeric",tabIndex:0,teactExperimentControlled:!I})}),(0,y.FD)("div",{className:"SGFmA4kL",children:[(0,y.FD)("span",{children:[!x&&Boolean(U)&&B("DescriptionComposerGiftMinimumPrice",{stars:I?(0,de.QH)(B,R):(0,de.Kk)(B,R)},{withMarkdown:!0,withNodes:!0}),x&&(()=>{const e=U?Number((N*U).toFixed()):N;return B("DescriptionComposerGiftResalePrice",{stars:I?(0,de.QH)(B,e):(0,de.Kk)(B,e)},{withMarkdown:!0,withNodes:!0})})()]}),x&&Boolean(I?p:s)&&(0,y.Y)("span",{className:"r9R0VR_w",children:`≈ ${(0,l.Ad)(I?(0,l.C)(N,p):N*s,"USD",B.code)}`})]}),(0,y.Y)(Te.A,{className:"yt_nODdj",label:B("OnlyAcceptTON"),checked:I,onCheck:k}),(0,y.Y)("div",{className:"pWjQiY4m",children:B("OnlyAcceptTONDescription")}),(0,y.FD)(g.A,{noForcedUpperCase:!0,disabled:!x,size:"smaller",onClick:F,children:[x&&B("ButtonSellGift",{stars:I?(0,de.Ms)(B,N):(0,de.U2)(B,N,{asFont:!0})},{withNodes:!0}),!x&&B("Sell")]})]})})));var Qt=a(58554),Xt=a(32625),$t=a(5463);const Zt="_Dt6RSQV",ea=(0,r.ph)((0,i.EK)(((e,{modal:t})=>{const a=t?.recipientId;return{recipient:a?(0,s.PVB)(e,a):void 0}}))((({modal:e,recipient:t})=>{const{closeGiftUpgradeModal:a,upgradeGift:s}=(0,i.ko)(),o=Boolean(e),l=(0,d.A)(e),c=(0,d.A)(t),[m,p]=(0,r.J0)(!1),[f,h]=(0,r.J0)(),A=(0,D.A)(),b=(0,u.A)((()=>a())),S=(0,u.A)((()=>{const e=l?.gift;e?.inputGift&&(s({gift:e.inputGift,shouldKeepOriginalDetails:m,upgradeStars:e.alreadyPaidUpgradeStars?void 0:e.gift.upgradeStars}),b())})),v=(0,u.A)((()=>{l?.sampleAttributes&&h(function(e,t){const a=e.filter((e=>"model"===e.type&&e.name!==t?.model.name)),r=e.filter((e=>"pattern"===e.type&&e.name!==t?.pattern.name)),i=e.filter((e=>"backdrop"===e.type&&e.name!==t?.backdrop.name));return{model:a[Math.floor(Math.random()*a.length)],pattern:r[Math.floor(Math.random()*r.length)],backdrop:i[Math.floor(Math.random()*i.length)]}}(l.sampleAttributes,f))}));(0,Xt.A)(v,o?3e3:void 0,!0),(0,r.vJ)((()=>{o&&l?.sampleAttributes&&v()}),[o,l?.sampleAttributes]),(0,r.vJ)((()=>{const e=l?.sampleAttributes;e&&[...e.filter((e=>"pattern"===e.type)).map((e=>e.sticker)),...e.filter((e=>"model"===e.type)).map((e=>e.sticker))].map((e=>(0,k.Mw)(e,"full"))).forEach((e=>{(0,Qt.hd)(e,$e.qZ.BlobUrl)}))}),[l?.sampleAttributes]);const N=(0,r.Kr)((()=>{if(!f||!o)return;const e=l?.gift,t=[["diamond",A("GiftUpgradeUniqueTitle"),A("GiftUpgradeUniqueDescription")],["trade",A("GiftUpgradeTransferableTitle"),A("GiftUpgradeTransferableDescription")],["auction",A("GiftUpgradeTradeableTitle"),A("GiftUpgradeTradeableDescription")]],a=c?A("GiftPeerUpgradeText",{peer:(0,n.F9)(A,c)}):A("GiftUpgradeTextOwn");return{listItemData:t,header:(0,y.Y)(ye,{modelAttribute:f.model,backdropAttribute:f.backdrop,patternAttribute:f.pattern,title:A("GiftUpgradeTitle"),subtitle:a}),footer:(0,y.FD)("div",{className:"EWaVCxY4",children:[!e&&(0,y.Y)(g.A,{className:Zt,size:"smaller",onClick:b,children:A("OK")}),e&&(0,y.FD)(y.FK,{children:[(0,y.Y)(Te.A,{label:A("GiftUpgradeKeepDetails"),onCheck:p,checked:m}),(0,y.Y)(g.A,{className:Zt,size:"smaller",isShiny:!0,onClick:S,children:e.alreadyPaidUpgradeStars?A("GeneralConfirm"):A("GiftUpgradeButton",{amount:(0,de.U2)(A,e.gift.upgradeStars,{asFont:!0})},{withNodes:!0})})]})]})}}),[f,o,A,c,l?.gift,m]);return(0,y.Y)($t.A,{isOpen:o,header:N?.header,footer:N?.footer,listItemData:N?.listItemData,hasBackdrop:!0,onClose:b})})));var ta=a(47483);const aa=(0,r.ph)((0,i.EK)((e=>({currentUser:(0,s.mBe)(e,e.currentUserId),isCurrentUserPremium:(0,s.g29)(e)})))((({modal:e,currentUser:t,isCurrentUserPremium:a})=>{const{closeGiftStatusInfoModal:n,setEmojiStatus:s}=(0,i.ko)(),l=(0,D.A)(),c=Boolean(e),m=(0,d.A)(e),{emojiStatus:h}=m||{},A=h?.textColor,b=(0,ta.A)(h?.patternDocumentId),S=(0,u.A)((()=>{n()})),v=(0,u.A)((()=>{h&&s({emojiStatus:h}),n()})),N=(0,r.Kr)((()=>{if(!h||!c)return;const e=[h.centerColor,h.edgeColor],t=h.patternColor;return(0,y.Y)($.A,{className:"_1RfhkfB",backgroundColors:e,patternColor:t,patternIcon:b.customEmoji})}),[h,c,b]),C=(0,r.Kr)((()=>({...t,emojiStatus:h})),[t,h]),I=(0,r.Kr)((()=>(0,y.FD)("div",{className:"qL0cHbwS",children:[(0,y.FD)("div",{className:(0,o.A)("t18QCmAb"),style:(0,ve.A)(A&&`color: ${A}`),children:[N,(0,y.Y)(p.A,{peer:C,size:"jumbo",className:"JK2zOWA7"}),(0,y.Y)(De.A,{peer:C,className:"lxxbgNCl",withEmojiStatus:!0,noFake:!0,noVerified:!0,statusSparklesColor:A}),(0,y.Y)("p",{className:"MLMdxkUg",style:(0,ve.A)(A&&`color: ${A}`),children:l("Online")})]}),(0,y.FD)("div",{className:"q8w7tnmR",children:[(0,y.Y)("div",{className:"wxg_5ou_",children:l("UniqueStatusWearTitle",{gift:C?.emojiStatus?.title})}),(0,y.Y)("div",{className:"KSCLIMZm",children:l("UniqueStatusBenefitsDescription")})]})]})),[A,N,C,l]),k=[["radial-badge",l("UniqueStatusBadgeBenefitTitle"),l("UniqueStatusBadgeDescription")],["unique-profile",l("UniqueStatusProfileDesignBenefitTitle"),l("UniqueStatusProfileDesignDescription")],["proof-of-ownership",l("UniqueStatusProofOfOwnershipBenefitTitle"),l("UniqueStatusProofOfOwnershipDescription")]],G=(0,r.Kr)((()=>{if(c)return(0,y.Y)("div",{className:"VDrvalBo",children:(0,y.FD)(g.A,{size:"smaller",onClick:v,children:[l("UniqueStatusWearButton"),!a&&(0,y.Y)(f.A,{name:"lock-badge",className:"jiPObOWv"})]})})}),[l,a,c]);return(0,y.Y)($t.A,{isOpen:c,header:I,listItemData:k,footer:G,hasBackdrop:!0,onClose:S})})));var ra=a(21309),ia=a(15535);const na={header:"LQgz8Nlx",giftPreview:"hgs0ts_O",backdrop:"OnBhMaBw",description:"HBxB4QPY",arrow:"kXTOUpfb",noPassword:"BnqLhoKr"},sa={isCustomPeer:!0,avatarIcon:"fragment",title:"",customPeerAvatarColor:"#000000"},oa=4.5*kt.$,la=(0,r.ph)((0,i.EK)((e=>{const{settings:{byKey:{hasPassword:t}},twoFaSettings:{hint:a}}=e;return{hasPassword:t,passwordHint:a}}))((({modal:e,hasPassword:t,passwordHint:a})=>{const{closeGiftWithdrawModal:n,clearGiftWithdrawError:s,closeGiftInfoModal:o,processStarGiftWithdrawal:l,openSettingsScreen:c}=(0,i.ko)(),m=Boolean(e),[h,b]=(0,r.J0)(!1),S=(0,D.A)(),v=(0,d.A)(e),N=v?.gift?.gift,C=N&&(0,_.uc)(N),I=v?.gift?.canExportAt?Math.max(v.gift.canExportAt-(0,Ot.Fm)(),0):void 0,k=(0,u.A)((()=>{n()})),G=(0,u.A)((e=>{l({gift:v.gift.inputGift,password:e})})),Y=(0,u.A)((()=>{c({screen:he.VS.TwoFaDisabled}),n(),o()}));return(0,y.FD)(A.A,{isOpen:m,title:S("GiftWithdrawTitle"),hasCloseButton:!0,isSlim:!0,onClose:k,children:[C&&(0,y.FD)(y.FK,{children:[(0,y.FD)("div",{className:na.header,children:[(0,y.FD)("div",{className:na.giftPreview,children:[(0,y.Y)($.A,{className:na.backdrop,backgroundColors:[C.backdrop.centerColor,C.backdrop.edgeColor],patternColor:C.backdrop?.patternColor,patternIcon:C.pattern?.sticker}),(0,y.Y)(X.A,{className:na.sticker,size:oa,sticker:C.model?.sticker})]}),(0,y.Y)(f.A,{name:"next",className:na.arrow}),(0,y.Y)(p.A,{peer:sa,size:"giant",className:na.avatar})]}),(0,y.Y)("p",{className:na.description,children:S("GiftWithdrawDescription",{gift:`${N.title} #${N.number}`},{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]})})]}),Boolean(I)&&(0,y.Y)("p",{className:na.exportHint,children:S("GiftWithdrawWait",{days:(0,ra._k)(I)},{pluralValue:(0,ra._k)(I)})}),!t&&(0,y.FD)(y.FK,{children:[(0,y.Y)("span",{className:na.noPassword,children:S("ErrorPasswordMissing")}),(0,y.Y)(g.A,{className:"mt-2",size:"smaller",onClick:Y,children:S("SetUp2FA")})]}),t&&!I&&(0,y.Y)(ia.A,{shouldShowSubmit:!0,placeholder:S("CheckPasswordPlaceholder"),error:v?.errorKey&&S.withRegular(v?.errorKey),description:S("CheckPasswordDescription"),clearError:s,isLoading:v?.isLoading,hint:a,isPasswordVisible:h,shouldResetValue:m,onChangePasswordVisibility:b,submitLabel:S("GiftWithdrawSubmit"),onSubmit:G})]})})));var ca=a(79824),da=a(74984),ua=a(4875),ma=a(56863),pa=a(30857),fa=a(84080),ha=a(56133),ga=a(35297);function Aa(){}async function ba(e){const t=await(0,ua.px)("searchChats",{query:e});if(t)return[...t.accountResultIds,...t.globalResultIds]}const Sa=(0,r.ph)((0,i.EK)((e=>{const{contactList:t,currentUserId:a}=e;return{contactIds:t?.userIds,currentUserId:a}}))((({modal:e,contactIds:t,currentUserId:a})=>{const{closeGiftTransferModal:o,openGiftWithdrawModal:l,transferGift:c}=(0,i.ko)(),m=Boolean(e),p=(0,D.A)(),[f,h]=(0,r.J0)(""),g=(0,d.A)(e),A=g?.gift?.gift,b=A&&(0,_.uc)(A),[S,v]=(0,r.J0)(),N=(0,d.A)(S),C=(0,r.Kr)((()=>{const e=(0,i.mS)();return N?(0,s.PVB)(e,N):void 0}),[N]),k=(0,da.Rh)(I.DSF),B=(0,r.Kr)((()=>(0,G.Am)([...t||[],...k||[]])),[t,k]),{result:M,currentResultsQuery:T}=function({query:e,queryFn:t=ba,defaultValue:a,debounceTimeout:i=300,isDisabled:n}){const s=function(e,t,a){const[i,n]=(0,r.J0)(),{isFrozen:s,updateWhenUnfrozen:o}=function(){const e=(0,r.li)(!1),t=(0,r.hb)((()=>{e.current=!0}),[]),a=(0,pa.A)(),i=(0,r.hb)((()=>{e.current&&(e.current=!1,a())}),[a]);return(0,fa.Ay)(Aa,i),{isFrozen:(0,r.OV)(),updateWhenUnfrozen:t}}(),l=(0,ha.A)(t,!0);return(0,ga.A)((()=>{s?o():l((()=>{n(e())}))}),[...a,s]),i}((()=>e),i,[e]),[o,l]=(0,r.J0)(""),c=e?s:e,d=(0,u.A)(t);return{...(0,ma.A)((async()=>{if(!c||n)return l(""),Promise.resolve(a);const e=await d(c);return l(c),e}),[c,a,d,n],a),currentResultsQuery:o}}({query:f,defaultValue:B}),F=T!==f,U=(0,r.Kr)((()=>T?ca.p:[{type:"withdraw",isCustomPeer:!0,avatarIcon:"toncoin",peerColorId:5,title:p("GiftTransferTON")}]),[p,T]),R=(0,u.A)((e=>{"withdraw"===e&&(l({gift:g.gift}),o())})),x=(0,r.Kr)((()=>{if(F)return ca.p;const e=(0,i.mS)();return(0,Y.A)((M||[]).filter((t=>t!==a&&(0,s.X2D)(e,t))),!1)}),[F,M,a]),O=(0,u.A)((()=>{v(void 0)}));(0,r.vJ)((()=>{m||v(void 0)}),[m]);const K=(0,u.A)((()=>{g?.gift.inputGift&&(c({gift:g.gift.inputGift,recipientId:N,transferStars:g.gift.transferStars}),O(),o())}));return(0,y.FD)(P.A,{isOpen:m,onClose:o,title:p("GiftTransferTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,ignoreFreeze:!0,children:[(0,y.Y)(w.A,{itemIds:x,categories:U,onSelectedCategoryChange:R,withDefaultPadding:!0,withPeerUsernames:!0,isSearchable:!0,noScrollRestore:!0,isLoading:F,filterValue:f,filterPlaceholder:p("Search"),onFilterChange:h,onSelectedIdChange:v}),b&&(0,y.FD)(qt.A,{isOpen:Boolean(S),noDefaultTitle:!0,onClose:O,confirmLabel:g?.gift.transferStars?p("GiftTransferConfirmButton",{amount:(0,de.U2)(p,g.gift.transferStars,{asFont:!0})},{withNodes:!0}):p("GiftTransferConfirmButtonFree"),confirmHandler:K,children:[C&&(0,y.Y)(Ht,{peer:C,gift:A}),(0,y.Y)("p",{children:g?.gift.transferStars?p("GiftTransferConfirmDescription",{gift:p("GiftUnique",{title:A.title,number:A.number}),amount:(0,de.Kk)(p,g.gift.transferStars),peer:(0,n.F9)(p,C)},{withNodes:!0,withMarkdown:!0}):p("GiftTransferConfirmDescriptionFree",{gift:p("GiftUnique",{title:A.title,number:A.number}),peer:(0,n.F9)(p,C)},{withNodes:!0,withMarkdown:!0})})]})]})}))),va=(0,r.ph)((0,i.EK)(((e,{modal:t})=>({user:t?.userId?(0,s.mBe)(e,t.userId):void 0})))((({modal:e,user:t})=>{const{closeChatRefundModal:a,toggleNoPaidMessagesException:s}=(0,i.ko)(),[o,l]=(0,r.J0)(!1),c=(0,d.A)(e),m=(0,d.A)(t),{starsToRefund:p,userId:f}=c||{},h=(0,D.A)(),g=Boolean(e),A=(0,u.A)((()=>{a(),f&&s({userId:f,shouldRefundCharged:o})}));return(0,y.FD)(qt.A,{isOpen:g,onClose:a,title:h("RemoveFeeTitle"),confirmLabel:h("ConfirmRemoveMessageFee"),confirmHandler:A,children:[h("ConfirmDialogMessageRemoveFee",{peer:m&&(0,n.F9)(h,m)},{withMarkdown:!0,withNodes:!0}),Boolean(p)&&(0,y.Y)(Te.A,{className:"dialog-checkbox",label:h("ConfirmDialogRemoveFeeRefundStars",{amount:(0,de.Kk)(h,p)},{withMarkdown:!0,withNodes:!0}),checked:o,onCheck:l})]})})));var Na=a(14487);const ya=(0,r.ph)((0,i.EK)((e=>{const t=e.stars?.balance,a=e.ton?.balance?.amount;return{starBalance:t,tonBalance:a}}))((({modal:e,starBalance:t,tonBalance:a})=>{const n=(0,i.ko)(),s=(0,D.A)(),o=(0,r.hb)((()=>{if(!e?.directInfo)return void n.closePriceConfirmModal();const{currency:r,newAmount:i}=e,s="TON"===r,o=s?a:t?.amount;if(void 0!==o){if(o<i)return n.openStarsBalanceModal({currency:s?"TON":"XTR",tabId:(0,Na.g0)()}),void n.closePriceConfirmModal();n.sendStarPaymentForm({directInfo:e.directInfo,tabId:(0,Na.g0)()}),n.closePriceConfirmModal()}else n.closePriceConfirmModal()}),[e,t,a,n]),c=(0,r.hb)((()=>{n.closePriceConfirmModal()}),[n]);if(!e)return;const{originalAmount:d,newAmount:u,currency:m}=e;let p,f;return"TON"===m?(p=(0,de.QH)(s,(0,l.wD)(d)),f=(0,de.QH)(s,(0,l.wD)(u))):(p=(0,de.Kk)(s,d),f=(0,de.Kk)(s,u)),(0,y.Y)(qt.A,{isOpen:Boolean(e),onClose:c,title:s("PriceChanged"),confirmHandler:o,confirmLabel:s("PayNewPrice"),children:(0,y.Y)("p",{children:s("PriceChangedText",{originalAmount:p,newAmount:f},{withMarkdown:!0,withNodes:!0})})})})))}}]);
//# sourceMappingURL=6930.8629e335773715d0ff70.js.map