{"version":3,"file":"9464.7c2124992aa84c79a951.js","mappings":"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","sources":["webpack://telegram-t/./node_modules/@june-so/analytics-next/dist/pkg/lib/is-plan-event-enabled.js","webpack://telegram-t/./node_modules/@june-so/analytics-next/dist/pkg/plugins/ajs-destination/loader.js","webpack://telegram-t/./node_modules/@june-so/analytics-next/dist/pkg/plugins/ajs-destination/utils.js","webpack://telegram-t/./node_modules/@june-so/analytics-next/dist/pkg/plugins/ajs-destination/index.js","webpack://telegram-t/./node_modules/@segment/analytics-core/dist/esm/validation/helpers.js"],"sourcesContent":["/**\n * Determines whether a track event is allowed to be sent based on the\n * user's tracking plan.\n * If the user does not have a tracking plan or the event is allowed based\n * on the tracking plan configuration, returns true.\n */\nexport function isPlanEventEnabled(plan, planEvent) {\n    var _a, _b;\n    // Always prioritize the event's `enabled` status\n    if (typeof (planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) === 'boolean') {\n        return planEvent.enabled;\n    }\n    // Assume absence of a tracking plan means events are enabled\n    return (_b = (_a = plan === null || plan === void 0 ? void 0 : plan.__default) === null || _a === void 0 ? void 0 : _a.enabled) !== null && _b !== void 0 ? _b : true;\n}\n//# sourceMappingURL=is-plan-event-enabled.js.map","import { __awaiter, __generator, __spreadArray } from \"tslib\";\nimport { getNextIntegrationsURL } from '../../lib/parse-cdn';\nimport { loadScript, unloadScript } from '../../lib/load-script';\nfunction normalizeName(name) {\n    return name.toLowerCase().replace('.', '').replace(/\\s+/g, '-');\n}\nfunction obfuscatePathName(pathName, obfuscate) {\n    if (obfuscate === void 0) { obfuscate = false; }\n    return obfuscate ? btoa(pathName).replace(/=/g, '') : undefined;\n}\nexport function resolveIntegrationNameFromSource(integrationSource) {\n    return ('Integration' in integrationSource\n        ? integrationSource.Integration\n        : integrationSource).prototype.name;\n}\nfunction recordLoadMetrics(fullPath, ctx, name) {\n    var _a, _b;\n    try {\n        var metric = ((_b = (_a = window === null || window === void 0 ? void 0 : window.performance) === null || _a === void 0 ? void 0 : _a.getEntriesByName(fullPath, 'resource')) !== null && _b !== void 0 ? _b : [])[0];\n        // we assume everything that took under 100ms is cached\n        metric &&\n            ctx.stats.gauge('legacy_destination_time', Math.round(metric.duration), __spreadArray([\n                name\n            ], (metric.duration < 100 ? ['cached'] : []), true));\n    }\n    catch (_) {\n        // not available\n    }\n}\nexport function buildIntegration(integrationSource, integrationSettings, analyticsInstance) {\n    var integrationCtr;\n    // GA and Appcues use a different interface to instantiating integrations\n    if ('Integration' in integrationSource) {\n        var analyticsStub = {\n            user: function () { return analyticsInstance.user(); },\n            addIntegration: function () { },\n        };\n        integrationSource(analyticsStub);\n        integrationCtr = integrationSource.Integration;\n    }\n    else {\n        integrationCtr = integrationSource;\n    }\n    var integration = new integrationCtr(integrationSettings);\n    integration.analytics = analyticsInstance;\n    return integration;\n}\nexport function loadIntegration(ctx, name, version, obfuscate) {\n    return __awaiter(this, void 0, void 0, function () {\n        var pathName, obfuscatedPathName, path, fullPath, err_1, deps;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    pathName = normalizeName(name);\n                    obfuscatedPathName = obfuscatePathName(pathName, obfuscate);\n                    path = getNextIntegrationsURL();\n                    fullPath = \"\".concat(path, \"/integrations/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \"/\").concat(version, \"/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \".dynamic.js.gz\");\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, loadScript(fullPath)];\n                case 2:\n                    _a.sent();\n                    recordLoadMetrics(fullPath, ctx, name);\n                    return [3 /*break*/, 4];\n                case 3:\n                    err_1 = _a.sent();\n                    ctx.stats.gauge('legacy_destination_time', -1, [\"plugin:\".concat(name), \"failed\"]);\n                    throw err_1;\n                case 4:\n                    deps = window[\"\".concat(pathName, \"Deps\")];\n                    return [4 /*yield*/, Promise.all(deps.map(function (dep) { return loadScript(path + dep + '.gz'); }))\n                        // @ts-ignore\n                    ];\n                case 5:\n                    _a.sent();\n                    // @ts-ignore\n                    window[\"\".concat(pathName, \"Loader\")]();\n                    return [2 /*return*/, window[\n                        // @ts-ignore\n                        \"\".concat(pathName, \"Integration\")]];\n            }\n        });\n    });\n}\nexport function unloadIntegration(name, version, obfuscate) {\n    return __awaiter(this, void 0, void 0, function () {\n        var path, pathName, obfuscatedPathName, fullPath;\n        return __generator(this, function (_a) {\n            path = getNextIntegrationsURL();\n            pathName = normalizeName(name);\n            obfuscatedPathName = obfuscatePathName(name, obfuscate);\n            fullPath = \"\".concat(path, \"/integrations/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \"/\").concat(version, \"/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \".dynamic.js.gz\");\n            return [2 /*return*/, unloadScript(fullPath)];\n        });\n    });\n}\nexport function resolveVersion(settings) {\n    var _a, _b, _c, _d;\n    return ((_d = (_b = (_a = settings === null || settings === void 0 ? void 0 : settings.versionSettings) === null || _a === void 0 ? void 0 : _a.override) !== null && _b !== void 0 ? _b : (_c = settings === null || settings === void 0 ? void 0 : settings.versionSettings) === null || _c === void 0 ? void 0 : _c.version) !== null && _d !== void 0 ? _d : 'latest');\n}\n//# sourceMappingURL=loader.js.map","export var isInstallableIntegration = function (name, integrationSettings) {\n    var _a;\n    var type = integrationSettings.type, bundlingStatus = integrationSettings.bundlingStatus, versionSettings = integrationSettings.versionSettings;\n    // We use `!== 'unbundled'` (versus `=== 'bundled'`) to be inclusive of\n    // destinations without a defined value for `bundlingStatus`\n    var deviceMode = bundlingStatus !== 'unbundled' &&\n        (type === 'browser' || ((_a = versionSettings === null || versionSettings === void 0 ? void 0 : versionSettings.componentTypes) === null || _a === void 0 ? void 0 : _a.includes('browser')));\n    // checking for iterable is a quick fix we need in place to prevent\n    // errors showing Iterable as a failed destiantion. Ideally, we should\n    // fix the Iterable metadata instead, but that's a longer process.\n    return !name.startsWith('Segment') && name !== 'Iterable' && deviceMode;\n};\nexport var isDisabledIntegration = function (integrationName, globalIntegrations) {\n    var allDisableAndNotDefined = globalIntegrations.All === false &&\n        globalIntegrations[integrationName] === undefined;\n    return (globalIntegrations[integrationName] === false || allDisableAndNotDefined);\n};\n//# sourceMappingURL=utils.js.map","import { __assign, __awaiter, __generator, __spreadArray } from \"tslib\";\nimport { Alias, Group, Identify, Page, Track } from '@segment/facade';\nimport { isOffline, isOnline } from '../../core/connection';\nimport { Context, ContextCancelation } from '../../core/context';\nimport { isServer } from '../../core/environment';\nimport { attempt } from '@segment/analytics-core';\nimport { isPlanEventEnabled } from '../../lib/is-plan-event-enabled';\nimport { mergedOptions } from '../../lib/merged-options';\nimport { pWhile } from '../../lib/p-while';\nimport { PriorityQueue } from '../../lib/priority-queue';\nimport { PersistedPriorityQueue } from '../../lib/priority-queue/persisted';\nimport { applyDestinationMiddleware, } from '../middleware';\nimport { buildIntegration, loadIntegration, resolveIntegrationNameFromSource, resolveVersion, unloadIntegration, } from './loader';\nimport { isPlainObject } from '@segment/analytics-core';\nimport { isDisabledIntegration as shouldSkipIntegration, isInstallableIntegration, } from './utils';\nfunction flushQueue(xt, queue) {\n    return __awaiter(this, void 0, void 0, function () {\n        var failedQueue;\n        var _this = this;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    failedQueue = [];\n                    if (isOffline()) {\n                        return [2 /*return*/, queue];\n                    }\n                    return [4 /*yield*/, pWhile(function () { return queue.length > 0 && isOnline(); }, function () { return __awaiter(_this, void 0, void 0, function () {\n                            var ctx, result, success;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        ctx = queue.pop();\n                                        if (!ctx) {\n                                            return [2 /*return*/];\n                                        }\n                                        return [4 /*yield*/, attempt(ctx, xt)];\n                                    case 1:\n                                        result = _a.sent();\n                                        success = result instanceof Context;\n                                        if (!success) {\n                                            failedQueue.push(ctx);\n                                        }\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); })\n                        // re-add failed tasks\n                    ];\n                case 1:\n                    _a.sent();\n                    // re-add failed tasks\n                    failedQueue.map(function (failed) { return queue.pushWithBackoff(failed); });\n                    return [2 /*return*/, queue];\n            }\n        });\n    });\n}\nvar LegacyDestination = /** @class */ (function () {\n    function LegacyDestination(name, version, settings, options, integrationSource) {\n        if (settings === void 0) { settings = {}; }\n        this.options = {};\n        this.type = 'destination';\n        this.middleware = [];\n        this._ready = false;\n        this._initialized = false;\n        this.flushing = false;\n        this.name = name;\n        this.version = version;\n        this.settings = __assign({}, settings);\n        this.disableAutoISOConversion = options.disableAutoISOConversion || false;\n        this.integrationSource = integrationSource;\n        // AJS-Renderer sets an extraneous `type` setting that clobbers\n        // existing type defaults. We need to remove it if it's present\n        if (this.settings['type'] && this.settings['type'] === 'browser') {\n            delete this.settings['type'];\n        }\n        this.options = options;\n        this.buffer = options.disableClientPersistence\n            ? new PriorityQueue(4, [])\n            : new PersistedPriorityQueue(4, \"dest-\".concat(name));\n        this.scheduleFlush();\n    }\n    LegacyDestination.prototype.isLoaded = function () {\n        return this._ready;\n    };\n    LegacyDestination.prototype.ready = function () {\n        var _a;\n        return (_a = this.onReady) !== null && _a !== void 0 ? _a : Promise.resolve();\n    };\n    LegacyDestination.prototype.load = function (ctx, analyticsInstance) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var integrationSource, _b;\n            var _this = this;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this._ready || this.onReady !== undefined) {\n                            return [2 /*return*/];\n                        }\n                        if (!((_a = this.integrationSource) !== null && _a !== void 0)) return [3 /*break*/, 1];\n                        _b = _a;\n                        return [3 /*break*/, 3];\n                    case 1: return [4 /*yield*/, loadIntegration(ctx, this.name, this.version, this.options.obfuscate)];\n                    case 2:\n                        _b = (_c.sent());\n                        _c.label = 3;\n                    case 3:\n                        integrationSource = _b;\n                        this.integration = buildIntegration(integrationSource, this.settings, analyticsInstance);\n                        this.onReady = new Promise(function (resolve) {\n                            var onReadyFn = function () {\n                                _this._ready = true;\n                                resolve(true);\n                            };\n                            _this.integration.once('ready', onReadyFn);\n                        });\n                        this.onInitialize = new Promise(function (resolve) {\n                            var onInit = function () {\n                                _this._initialized = true;\n                                resolve(true);\n                            };\n                            _this.integration.on('initialize', onInit);\n                        });\n                        try {\n                            ctx.stats.increment('analytics_js.integration.invoke', 1, [\n                                \"method:initialize\",\n                                \"integration_name:\".concat(this.name),\n                            ]);\n                            this.integration.initialize();\n                        }\n                        catch (error) {\n                            ctx.stats.increment('analytics_js.integration.invoke.error', 1, [\n                                \"method:initialize\",\n                                \"integration_name:\".concat(this.name),\n                            ]);\n                            throw error;\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    LegacyDestination.prototype.unload = function (_ctx, _analyticsInstance) {\n        return unloadIntegration(this.name, this.version, this.options.obfuscate);\n    };\n    LegacyDestination.prototype.addMiddleware = function () {\n        var _a;\n        var fn = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            fn[_i] = arguments[_i];\n        }\n        this.middleware = (_a = this.middleware).concat.apply(_a, fn);\n    };\n    LegacyDestination.prototype.shouldBuffer = function (ctx) {\n        return (\n        // page events can't be buffered because of destinations that automatically add page views\n        ctx.event.type !== 'page' &&\n            (isOffline() || this._ready === false || this._initialized === false));\n    };\n    LegacyDestination.prototype.send = function (ctx, clz, eventType) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var plan, ev, planEvent, afterMiddleware, event, err_1;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this.shouldBuffer(ctx)) {\n                            this.buffer.push(ctx);\n                            this.scheduleFlush();\n                            return [2 /*return*/, ctx];\n                        }\n                        plan = (_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.plan) === null || _b === void 0 ? void 0 : _b.track;\n                        ev = ctx.event.event;\n                        if (plan && ev && this.name !== 'june.so') {\n                            planEvent = plan[ev];\n                            if (!isPlanEventEnabled(plan, planEvent)) {\n                                ctx.updateEvent('integrations', __assign(__assign({}, ctx.event.integrations), { All: false, 'june.so': true }));\n                                ctx.cancel(new ContextCancelation({\n                                    retry: false,\n                                    reason: \"Event \".concat(ev, \" disabled for integration \").concat(this.name, \" in tracking plan\"),\n                                    type: 'Dropped by plan',\n                                }));\n                                return [2 /*return*/, ctx];\n                            }\n                            else {\n                                ctx.updateEvent('integrations', __assign(__assign({}, ctx.event.integrations), planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations));\n                            }\n                            if ((planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) && (planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations[this.name]) === false) {\n                                ctx.cancel(new ContextCancelation({\n                                    retry: false,\n                                    reason: \"Event \".concat(ev, \" disabled for integration \").concat(this.name, \" in tracking plan\"),\n                                    type: 'Dropped by plan',\n                                }));\n                                return [2 /*return*/, ctx];\n                            }\n                        }\n                        return [4 /*yield*/, applyDestinationMiddleware(this.name, ctx.event, this.middleware)];\n                    case 1:\n                        afterMiddleware = _c.sent();\n                        if (afterMiddleware === null) {\n                            return [2 /*return*/, ctx];\n                        }\n                        event = new clz(afterMiddleware, {\n                            traverse: !this.disableAutoISOConversion,\n                        });\n                        ctx.stats.increment('analytics_js.integration.invoke', 1, [\n                            \"method:\".concat(eventType),\n                            \"integration_name:\".concat(this.name),\n                        ]);\n                        _c.label = 2;\n                    case 2:\n                        _c.trys.push([2, 5, , 6]);\n                        if (!this.integration) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.integration.invoke.call(this.integration, eventType, event)];\n                    case 3:\n                        _c.sent();\n                        _c.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _c.sent();\n                        ctx.stats.increment('analytics_js.integration.invoke.error', 1, [\n                            \"method:\".concat(eventType),\n                            \"integration_name:\".concat(this.name),\n                        ]);\n                        throw err_1;\n                    case 6: return [2 /*return*/, ctx];\n                }\n            });\n        });\n    };\n    LegacyDestination.prototype.track = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Track, 'track')];\n            });\n        });\n    };\n    LegacyDestination.prototype.page = function (ctx) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_b) {\n                if (((_a = this.integration) === null || _a === void 0 ? void 0 : _a._assumesPageview) && !this._initialized) {\n                    this.integration.initialize();\n                }\n                return [2 /*return*/, this.onInitialize.then(function () {\n                        return _this.send(ctx, Page, 'page');\n                    })];\n            });\n        });\n    };\n    LegacyDestination.prototype.identify = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Identify, 'identify')];\n            });\n        });\n    };\n    LegacyDestination.prototype.alias = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Alias, 'alias')];\n            });\n        });\n    };\n    LegacyDestination.prototype.group = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Group, 'group')];\n            });\n        });\n    };\n    LegacyDestination.prototype.scheduleFlush = function () {\n        var _this = this;\n        if (this.flushing) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-misused-promises\n        setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.flushing = true;\n                        _a = this;\n                        return [4 /*yield*/, flushQueue(this, this.buffer)];\n                    case 1:\n                        _a.buffer = _b.sent();\n                        this.flushing = false;\n                        if (this.buffer.todo > 0) {\n                            this.scheduleFlush();\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        }); }, Math.random() * 5000);\n    };\n    return LegacyDestination;\n}());\nexport { LegacyDestination };\nexport function ajsDestinations(settings, globalIntegrations, options, routingMiddleware, legacyIntegrationSources) {\n    var _a, _b;\n    if (globalIntegrations === void 0) { globalIntegrations = {}; }\n    if (options === void 0) { options = {}; }\n    if (isServer()) {\n        return [];\n    }\n    if (settings.plan) {\n        options = options !== null && options !== void 0 ? options : {};\n        options.plan = settings.plan;\n    }\n    var routingRules = (_b = (_a = settings.middlewareSettings) === null || _a === void 0 ? void 0 : _a.routingRules) !== null && _b !== void 0 ? _b : [];\n    var remoteIntegrationsConfig = settings.integrations;\n    var localIntegrationsConfig = options.integrations;\n    // merged remote CDN settings with user provided options\n    var integrationOptions = mergedOptions(settings, options !== null && options !== void 0 ? options : {});\n    var adhocIntegrationSources = legacyIntegrationSources === null || legacyIntegrationSources === void 0 ? void 0 : legacyIntegrationSources.reduce(function (acc, integrationSource) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[resolveIntegrationNameFromSource(integrationSource)] = integrationSource, _a)));\n    }, {});\n    var installableIntegrations = new Set(__spreadArray(__spreadArray([], Object.keys(remoteIntegrationsConfig).filter(function (name) {\n        return isInstallableIntegration(name, remoteIntegrationsConfig[name]);\n    }), true), Object.keys(adhocIntegrationSources || {}).filter(function (name) {\n        return isPlainObject(remoteIntegrationsConfig[name]) ||\n            isPlainObject(localIntegrationsConfig === null || localIntegrationsConfig === void 0 ? void 0 : localIntegrationsConfig[name]);\n    }), true));\n    return Array.from(installableIntegrations)\n        .filter(function (name) { return !shouldSkipIntegration(name, globalIntegrations); })\n        .map(function (name) {\n        var integrationSettings = remoteIntegrationsConfig[name];\n        var version = resolveVersion(integrationSettings);\n        var destination = new LegacyDestination(name, version, integrationOptions[name], options, adhocIntegrationSources === null || adhocIntegrationSources === void 0 ? void 0 : adhocIntegrationSources[name]);\n        var routing = routingRules.filter(function (rule) { return rule.destinationName === name; });\n        if (routing.length > 0 && routingMiddleware) {\n            destination.addMiddleware(routingMiddleware);\n        }\n        return destination;\n    });\n}\n//# sourceMappingURL=index.js.map","export function isString(obj) {\n    return typeof obj === 'string';\n}\nexport function isNumber(obj) {\n    return typeof obj === 'number';\n}\nexport function isFunction(obj) {\n    return typeof obj === 'function';\n}\nexport function isPlainObject(obj) {\n    return (Object.prototype.toString.call(obj).slice(8, -1).toLowerCase() === 'object');\n}\nexport function hasUser(event) {\n    var _a, _b, _c;\n    var id = (_c = (_b = (_a = event.userId) !== null && _a !== void 0 ? _a : event.anonymousId) !== null && _b !== void 0 ? _b : event.groupId) !== null && _c !== void 0 ? _c : event.previousId;\n    return isString(id);\n}\n//# sourceMappingURL=helpers.js.map"],"names":["isPlanEventEnabled","plan","planEvent","_a","_b","enabled","__default","normalizeName","name","toLowerCase","replace","obfuscatePathName","pathName","obfuscate","btoa","undefined","loadIntegration","ctx","version","__awaiter","this","obfuscatedPathName","path","fullPath","err_1","deps","__generator","label","concat","trys","push","sent","metric","window","performance","getEntriesByName","stats","gauge","Math","round","duration","__spreadArray","_","recordLoadMetrics","Promise","all","map","dep","isInstallableIntegration","integrationSettings","type","bundlingStatus","versionSettings","deviceMode","componentTypes","includes","startsWith","isDisabledIntegration","integrationName","globalIntegrations","allDisableAndNotDefined","All","flushQueue","xt","queue","failedQueue","_this","length","pop","a","failed","pushWithBackoff","LegacyDestination","settings","options","integrationSource","middleware","_ready","_initialized","flushing","__assign","disableAutoISOConversion","buffer","disableClientPersistence","scheduleFlush","prototype","isLoaded","ready","onReady","resolve","load","analyticsInstance","_c","integration","integrationCtr","user","addIntegration","Integration","analytics","buildIntegration","once","onInitialize","on","increment","initialize","error","unload","_ctx","_analyticsInstance","unloadIntegration","addMiddleware","fn","_i","arguments","apply","shouldBuffer","event","send","clz","eventType","ev","afterMiddleware","track","updateEvent","integrations","cancel","retry","reason","applyDestinationMiddleware","traverse","invoke","call","Track","page","_assumesPageview","then","Page","identify","Identify","alias","Alias","group","Group","setTimeout","todo","random","ajsDestinations","routingMiddleware","legacyIntegrationSources","routingRules","middlewareSettings","remoteIntegrationsConfig","localIntegrationsConfig","integrationOptions","adhocIntegrationSources","reduce","acc","resolveIntegrationNameFromSource","installableIntegrations","Set","Object","keys","filter","Array","from","_d","override","resolveVersion","destination","rule","destinationName","isPlainObject","obj","toString","slice"],"sourceRoot":""}