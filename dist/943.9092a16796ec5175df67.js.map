{"version":3,"file":"943.9092a16796ec5175df67.js","mappings":"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GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,EAAG,GAAI,IAAK,GAAI,IAAK,IAAK,GAAI,GAAI,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,GAE5qCC,EAAY,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GA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","sources":["webpack://telegram-t/./src/components/common/AnimatedCounter.module.scss?3640","webpack://telegram-t/./src/components/common/AnimatedCounter.tsx","webpack://telegram-t/./src/components/common/AnimatedIconFromSticker.tsx","webpack://telegram-t/./src/components/common/AnimatedIconWithPreview.module.scss?eca8","webpack://telegram-t/./src/components/common/AnimatedIconWithPreview.tsx","webpack://telegram-t/./src/components/common/helpers/waveform.ts","webpack://telegram-t/./src/util/waveform.ts","webpack://telegram-t/./src/components/common/Audio.tsx","webpack://telegram-t/./src/components/common/ChatExtra.tsx","webpack://telegram-t/./src/components/common/DeleteChatModal.tsx","webpack://telegram-t/./src/components/common/Document.tsx","webpack://telegram-t/./src/components/common/DotAnimation.tsx","webpack://telegram-t/./src/components/common/FakeIcon.tsx","webpack://telegram-t/./src/components/common/File.tsx","webpack://telegram-t/./src/components/common/VerifiedIcon.tsx","webpack://telegram-t/./src/components/common/FullNameTitle.module.scss?6448","webpack://telegram-t/./src/components/common/FullNameTitle.tsx","webpack://telegram-t/./src/components/common/GroupChatInfo.tsx","webpack://telegram-t/./src/components/common/LastMessageMeta.tsx","webpack://telegram-t/./src/components/common/Media.tsx","webpack://telegram-t/./src/components/common/MessageOutgoingStatus.tsx","webpack://telegram-t/./src/components/common/NothingFound.tsx","webpack://telegram-t/./src/components/common/PasswordForm.tsx","webpack://telegram-t/./src/components/common/Picker.tsx","webpack://telegram-t/./src/components/common/PickerSelectedItem.tsx","webpack://telegram-t/./src/components/common/PremiumIcon.tsx","webpack://telegram-t/./src/components/common/PrivateChatInfo.tsx","webpack://telegram-t/./src/components/common/ProfilePhoto.tsx","webpack://telegram-t/./src/components/common/ProfileInfo.tsx","webpack://telegram-t/./src/components/common/hooks/usePhotosPreload.ts","webpack://telegram-t/./src/components/common/ReactionStaticEmoji.tsx","webpack://telegram-t/./src/components/common/ReportModal.tsx","webpack://telegram-t/./src/components/common/StickerButton.tsx","webpack://telegram-t/./src/components/common/TypingStatus.tsx","webpack://telegram-t/./src/components/common/WebLink.tsx","webpack://telegram-t/./src/components/common/helpers/renderMessageText.ts","webpack://telegram-t/./src/components/left/ChatFolderModal.async.tsx","webpack://telegram-t/./src/components/left/main/hooks/useChatAnimationType.ts","webpack://telegram-t/./src/components/left/main/Badge.tsx","webpack://telegram-t/./src/components/left/main/ChatCallStatus.tsx","webpack://telegram-t/./src/components/left/main/Chat.tsx","webpack://telegram-t/./src/components/left/main/EmptyFolder.tsx","webpack://telegram-t/./src/components/left/main/ChatList.tsx","webpack://telegram-t/./src/components/left/search/helpers/getSenderName.ts","webpack://telegram-t/./src/components/middle/composer/CustomEmojiTooltip.async.tsx","webpack://telegram-t/./src/components/middle/composer/CustomSendMenu.async.tsx","webpack://telegram-t/./src/components/middle/composer/DropTarget.tsx","webpack://telegram-t/./src/components/middle/composer/DropArea.tsx","webpack://telegram-t/./src/components/middle/composer/EmojiTooltip.async.tsx","webpack://telegram-t/./src/util/AbsoluteVideo.ts","webpack://telegram-t/./src/components/middle/composer/hooks/useInputCustomEmojis.ts","webpack://telegram-t/./src/components/middle/composer/MessageInput.tsx","webpack://telegram-t/./src/components/middle/composer/TextFormatter.tsx","webpack://telegram-t/./src/util/getKeyFromEvent.ts","webpack://telegram-t/./src/components/middle/composer/helpers/getFilesFromDataTransferItems.ts","webpack://telegram-t/./src/components/middle/composer/helpers/prepareForRegExp.ts","webpack://telegram-t/./src/components/middle/composer/helpers/selection.ts","webpack://telegram-t/./src/components/middle/composer/hooks/useCustomEmojiTooltip.ts","webpack://telegram-t/./src/util/memoized.ts","webpack://telegram-t/./src/components/middle/composer/hooks/useEmojiTooltip.ts","webpack://telegram-t/./src/components/middle/composer/hooks/useMentionTooltip.ts","webpack://telegram-t/./src/components/right/hooks/useAsyncRendering.ts","webpack://telegram-t/./src/components/ui/CheckboxGroup.tsx","webpack://telegram-t/./src/components/ui/ConfirmDialog.tsx","webpack://telegram-t/./src/components/ui/FloatingActionButton.tsx","webpack://telegram-t/./src/components/ui/ListItem.tsx","webpack://telegram-t/./src/components/ui/MenuSeparator.module.scss?43c3","webpack://telegram-t/./src/components/ui/MenuSeparator.tsx","webpack://telegram-t/./src/components/ui/Notification.tsx","webpack://telegram-t/./src/components/ui/ProgressSpinner.tsx","webpack://telegram-t/./src/components/ui/Radio.tsx","webpack://telegram-t/./src/components/ui/RadioGroup.tsx","webpack://telegram-t/./src/components/ui/RangeSlider.tsx","webpack://telegram-t/./src/components/ui/SearchInput.tsx","webpack://telegram-t/./src/components/ui/ShowTransition.tsx","webpack://telegram-t/./src/components/ui/Skeleton.tsx","webpack://telegram-t/./src/components/ui/Switcher.tsx","webpack://telegram-t/./src/components/ui/Tab.tsx","webpack://telegram-t/./src/components/ui/TabList.tsx","webpack://telegram-t/./src/hooks/reducers/useFoldersReducer.ts","webpack://telegram-t/./src/hooks/useAudioPlayer.ts","webpack://telegram-t/./src/hooks/useCacheBuster.ts","webpack://telegram-t/./src/hooks/useCanvasBlur.ts","webpack://telegram-t/./src/hooks/useChatContextActions.ts","webpack://telegram-t/./src/hooks/useContextMenuHandlers.ts","webpack://telegram-t/./src/hooks/useContextMenuPosition.ts","webpack://telegram-t/./src/hooks/useEnsureMessage.ts","webpack://telegram-t/./src/hooks/useFolderManager.ts","webpack://telegram-t/./src/hooks/useHorizontalScroll.ts","webpack://telegram-t/./src/hooks/useHotkeys.ts","webpack://telegram-t/./src/util/parseHotkey.ts","webpack://telegram-t/./src/hooks/useInputFocusOnOpen.ts","webpack://telegram-t/./src/hooks/useLayoutEffectWithPrevDeps.ts","webpack://telegram-t/./src/hooks/useUniqueId.ts","webpack://telegram-t/./src/hooks/useMediaWithLoadProgress.ts","webpack://telegram-t/./src/hooks/useMouseInside.ts","webpack://telegram-t/./src/hooks/useOnSelectionChange.ts","webpack://telegram-t/./src/hooks/usePrevDuringAnimation.ts","webpack://telegram-t/./src/hooks/useReducer.ts","webpack://telegram-t/./src/hooks/useRunDebounced.ts","webpack://telegram-t/./src/components/common/CalendarModal.async.tsx","webpack://telegram-t/./src/hooks/useSchedule.tsx","webpack://telegram-t/./src/hooks/useSendMessageAction.ts","webpack://telegram-t/./src/hooks/useStateRef.ts","webpack://telegram-t/./src/hooks/useTimeout.ts","webpack://telegram-t/./src/lib/fastBlur.js","webpack://telegram-t/./src/util/WorkerConnector.ts","webpack://telegram-t/./src/lib/rlottie/RLottie.ts","webpack://telegram-t/./src/util/audioPlayer.ts","webpack://telegram-t/./src/util/captureEvents.ts","webpack://telegram-t/./src/util/lethargy.ts","webpack://telegram-t/./src/util/colors.ts","webpack://telegram-t/./src/util/cycleRestrict.ts","webpack://telegram-t/./src/util/fastSmoothScroll.ts","webpack://telegram-t/./src/util/fastSmoothScrollHorizontal.ts","webpack://telegram-t/./src/util/focusEditableElement.ts","webpack://telegram-t/./src/util/getMessageIdsForSelectedText.ts","webpack://telegram-t/./src/util/isElementInViewport.ts","webpack://telegram-t/./src/util/mediaSession.ts","webpack://telegram-t/./src/util/parseEmojiOnlyString.ts","webpack://telegram-t/./src/util/parseMessageInput.ts","webpack://telegram-t/./src/util/selection.ts","webpack://telegram-t/./src/util/stopEvent.ts","webpack://telegram-t/./src/util/systemFilesDialog.ts"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"root\":\"Tx2CpCmpZZrHnCMUksg2\",\"character-container\":\"LTqDt1MFKRDBjNZxKii4\",\"characterContainer\":\"LTqDt1MFKRDBjNZxKii4\",\"character\":\"o1u1ctUWtWa2FWlC_BuT\",\"character-old\":\"tzggk5evL9EPqVAtvWEu\",\"characterOld\":\"tzggk5evL9EPqVAtvWEu\",\"character-disappear\":\"cQVeR4w2ND9Xwfl0bNJc\",\"characterDisappear\":\"cQVeR4w2ND9Xwfl0bNJc\",\"character-new\":\"q6poDASGW35qQiXsD99c\",\"characterNew\":\"q6poDASGW35qQiXsD99c\",\"character-appear\":\"lsHAt1tY7_VcodncBZKh\",\"characterAppear\":\"lsHAt1tY7_VcodncBZKh\"};","import type { FC } from '../../lib/teact/teact';\nimport React, { useMemo, useRef } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport { ANIMATION_LEVEL_MAX } from '../../config';\nimport usePrevious from '../../hooks/usePrevious';\nimport useForceUpdate from '../../hooks/useForceUpdate';\nimport useTimeout from '../../hooks/useTimeout';\n\nimport styles from './AnimatedCounter.module.scss';\n\ntype OwnProps = {\n  text: string;\n};\n\nconst ANIMATION_TIME = 150;\n\nconst AnimatedCounter: FC<OwnProps> = ({\n  text,\n}) => {\n  const prevText = usePrevious(text);\n  const forceUpdate = useForceUpdate();\n\n  const isAnimatingRef = useRef(false);\n\n  const shouldAnimate = getGlobal().settings.byKey.animationLevel === ANIMATION_LEVEL_MAX;\n\n  const textElement = useMemo(() => {\n    if (!shouldAnimate) return text;\n\n    const elements = [];\n    for (let i = 0; i < text.length; i++) {\n      if (prevText && text[i] !== prevText[i]) {\n        elements.push(\n          <div className={styles.characterContainer}>\n            <div className={styles.character}>{text[i]}</div>\n            <div className={styles.characterOld}>{prevText[i]}</div>\n            <div className={styles.characterNew}>{text[i]}</div>\n          </div>,\n        );\n      } else {\n        elements.push(<span>{text[i]}</span>);\n      }\n    }\n\n    isAnimatingRef.current = true;\n\n    return elements;\n  }, [prevText, shouldAnimate, text]);\n\n  useTimeout(() => {\n    isAnimatingRef.current = false;\n    forceUpdate();\n  }, shouldAnimate && isAnimatingRef.current ? ANIMATION_TIME : undefined);\n\n  return (\n    <span className={styles.root}>\n      {textElement}\n    </span>\n  );\n};\n\nexport default AnimatedCounter;\n","import React, { memo } from '../../lib/teact/teact';\n\nimport type { OwnProps as AnimatedIconProps } from './AnimatedIcon';\nimport type { ApiSticker } from '../../api/types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport { getStickerPreviewHash } from '../../global/helpers';\n\nimport useMedia from '../../hooks/useMedia';\n\nimport AnimatedIconWithPreview from './AnimatedIconWithPreview';\n\ntype OwnProps =\n  Partial<AnimatedIconProps>\n  & { sticker?: ApiSticker; noLoad?: boolean; forcePreview?: boolean; lastSyncTime?: number };\n\nfunction AnimatedIconFromSticker(props: OwnProps) {\n  const {\n    sticker, noLoad, forcePreview, lastSyncTime, ...otherProps\n  } = props;\n\n  const thumbDataUri = sticker?.thumbnail?.dataUri;\n  const localMediaHash = sticker && `sticker${sticker.id}`;\n  const previewBlobUrl = useMedia(\n    sticker ? getStickerPreviewHash(sticker.id) : undefined,\n    noLoad && !forcePreview,\n    ApiMediaFormat.BlobUrl,\n    lastSyncTime,\n  );\n  const tgsUrl = useMedia(localMediaHash, noLoad, undefined, lastSyncTime);\n\n  return (\n    <AnimatedIconWithPreview\n      tgsUrl={tgsUrl}\n      previewUrl={previewBlobUrl}\n      noPreviewTransition\n      thumbDataUri={thumbDataUri}\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...otherProps}\n    />\n  );\n}\n\nexport default memo(AnimatedIconFromSticker);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"oGmd77AsTbJeJk8CV6gl\",\"preview\":\"gp5OwinzPeHwkesmaEIR\"};","import React, { memo, useCallback } from '../../lib/teact/teact';\n\nimport type { OwnProps as AnimatedIconProps } from './AnimatedIcon';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useMediaTransition from '../../hooks/useMediaTransition';\nimport AnimatedIcon from './AnimatedIcon';\nimport styles from './AnimatedIconWithPreview.module.scss';\nimport useFlag from '../../hooks/useFlag';\nimport buildStyle from '../../util/buildStyle';\n\ntype OwnProps =\n  Partial<AnimatedIconProps>\n  & { previewUrl?: string; thumbDataUri?: string; noPreviewTransition?: boolean };\n\nconst loadedPreviewUrls = new Set();\n\nfunction AnimatedIconWithPreview(props: OwnProps) {\n  const {\n    previewUrl, thumbDataUri, noPreviewTransition, className, ...otherProps\n  } = props;\n\n  const [isPreviewLoaded, markPreviewLoaded] = useFlag(loadedPreviewUrls.has(previewUrl));\n  const previewClassNames = useMediaTransition(noPreviewTransition || isPreviewLoaded);\n  const [isAnimationReady, markAnimationReady] = useFlag(false);\n\n  const handlePreviewLoad = useCallback(() => {\n    markPreviewLoaded();\n    loadedPreviewUrls.add(previewUrl);\n  }, [markPreviewLoaded, previewUrl]);\n\n  const { size } = props;\n\n  return (\n    <div\n      className={buildClassName(className, styles.root)}\n      style={buildStyle(size !== undefined && `width: ${size}px; height: ${size}px;`)}\n    >\n      {!isAnimationReady && thumbDataUri && (\n        // eslint-disable-next-line jsx-a11y/alt-text\n        <img src={thumbDataUri} className={buildClassName(styles.preview)} />\n      )}\n      {!isAnimationReady && previewUrl && (\n        // eslint-disable-next-line jsx-a11y/alt-text\n        <img\n          src={previewUrl}\n          className={buildClassName(styles.preview, previewClassNames)}\n          onLoad={handlePreviewLoad}\n        />\n      )}\n      {/* eslint-disable-next-line react/jsx-props-no-spreading */}\n      <AnimatedIcon {...otherProps} onLoad={markAnimationReady} noTransition />\n    </div>\n  );\n}\n\nexport default memo(AnimatedIconWithPreview);\n","type IWaveformProps = {\n  peak: number;\n  fillStyle: string;\n  progressFillStyle: string;\n};\n\nexport const MAX_EMPTY_WAVEFORM_POINTS = 30;\nconst SPIKE_WIDTH = 2;\nconst SPIKE_STEP = 4;\nconst SPIKE_RADIUS = 1;\nconst HEIGHT = 23;\n\nexport function renderWaveform(\n  canvas: HTMLCanvasElement,\n  spikes: number[],\n  progress: number,\n  {\n    peak, fillStyle, progressFillStyle,\n  }: IWaveformProps,\n) {\n  const width = spikes.length * SPIKE_STEP;\n  const height = HEIGHT;\n\n  canvas.width = width * 2;\n  canvas.height = height * 2;\n  canvas.style.width = `${width}px`;\n  canvas.style.height = `${height}px`;\n\n  const ctx = canvas.getContext('2d')!;\n  ctx.scale(2, 2);\n\n  spikes.forEach((item, i) => {\n    ctx.globalAlpha = (i / spikes.length >= progress) ? 0.5 : 1;\n    ctx.fillStyle = progress > i / spikes.length ? progressFillStyle : fillStyle;\n    const spikeHeight = Math.max(2, HEIGHT * (item / Math.max(1, peak)));\n    roundedRectangle(ctx, i * SPIKE_STEP, (height + spikeHeight) / 2, SPIKE_WIDTH, spikeHeight, SPIKE_RADIUS);\n    ctx.fill();\n  });\n}\n\nfunction roundedRectangle(\n  ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number, radius: number,\n) {\n  if (width < 2 * radius) {\n    radius = width / 2;\n  }\n  if (height < 2 * radius) {\n    radius = height / 2;\n  }\n\n  ctx.beginPath();\n  ctx.moveTo(x + radius, y);\n  ctx.arcTo(x + width, y, x + width, y - height, radius);\n  ctx.arcTo(x + width, y - height, x, y - height, radius);\n  ctx.arcTo(x, y - height, x, y, radius);\n  ctx.arcTo(x, y, x + width, y, radius);\n  ctx.closePath();\n}\n","/* eslint-disable no-bitwise */\n\n// eslint-disable-next-line max-len\n// Ref: https://github.com/telegramdesktop/tdesktop/blob/0743e71ab6b928d2ee5bae1aed991849b1e2b291/Telegram/SourceFiles/data/data_document.cpp#L1018\nexport function decodeWaveform(encoded5bit: Uint8Array) {\n  const bitsCount = encoded5bit.length * 8;\n  const valuesCount = Math.floor(bitsCount / 5);\n  if (!valuesCount) {\n    return [];\n  }\n\n  // Read each 5 bit of encoded5bit as 0-31 unsigned char.\n  // We count the index of the byte in which the desired 5-bit sequence starts.\n  // And then we read a uint16 starting from that byte to guarantee to get all of those 5 bits.\n  //\n  // BUT! if it is the last byte we have, we're not allowed to read a uint16 starting with it.\n  // Because it will be an overflow (we'll access one byte after the available memory).\n  // We see, that only the last 5 bits could start in the last available byte and be problematic.\n  // So we read in a general way all the entries in a general way except the last one.\n  const result = Array(valuesCount);\n  const bitsData = encoded5bit;\n  for (let i = 0, l = valuesCount - 1; i !== l; ++i) {\n    const byteIndex = Math.floor((i * 5) / 8);\n    const bitShift = Math.floor((i * 5) % 8);\n    const value = bitsData[byteIndex] + (bitsData[byteIndex + 1] << 8);\n    result[i] = ((value >> bitShift) & 0x1F);\n  }\n  const lastByteIndex = Math.floor(((valuesCount - 1) * 5) / 8);\n  const lastBitShift = Math.floor(((valuesCount - 1) * 5) % 8);\n  const lastValue = bitsData[lastByteIndex] + (bitsData[lastByteIndex + 1] << 8);\n  result[valuesCount - 1] = (lastValue >> lastBitShift) & 0x1F;\n\n  return result;\n}\n\nexport function interpolateArray(data: number[], fitCount: number) {\n  let peak = 0;\n  const newData = new Array(fitCount);\n  const springFactor = data.length / fitCount;\n  const leftFiller = data[0];\n  const rightFiller = data[data.length - 1];\n  for (let i = 0; i < fitCount; i++) {\n    const idx = Math.floor(i * springFactor);\n    const val = ((data[idx - 1] ?? leftFiller) + (data[idx] ?? leftFiller) + (data[idx + 1] ?? rightFiller)) / 3;\n    newData[i] = val;\n    if (peak < val) {\n      peak = val;\n    }\n  }\n  return { data: newData, peak };\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState,\n} from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type { ApiAudio, ApiMessage, ApiVoice } from '../../api/types';\nimport { ApiMediaFormat } from '../../api/types';\nimport type { ISettings } from '../../types';\nimport { AudioOrigin } from '../../types';\n\nimport { IS_SINGLE_COLUMN_LAYOUT } from '../../util/environment';\nimport { formatMediaDateTime, formatMediaDuration, formatPastTimeShort } from '../../util/dateFormat';\nimport {\n  getMediaDuration,\n  getMediaTransferState,\n  getMessageMediaFormat,\n  getMessageMediaHash,\n  isMessageLocal,\n  isOwnMessage,\n} from '../../global/helpers';\nimport { MAX_EMPTY_WAVEFORM_POINTS, renderWaveform } from './helpers/waveform';\nimport buildClassName from '../../util/buildClassName';\nimport renderText from './helpers/renderText';\nimport { getFileSizeString } from './helpers/documentInfo';\nimport { decodeWaveform, interpolateArray } from '../../util/waveform';\nimport useMediaWithLoadProgress from '../../hooks/useMediaWithLoadProgress';\nimport useShowTransition from '../../hooks/useShowTransition';\nimport type { BufferedRange } from '../../hooks/useBuffering';\nimport useBuffering from '../../hooks/useBuffering';\nimport useAudioPlayer from '../../hooks/useAudioPlayer';\nimport type { LangFn } from '../../hooks/useLang';\nimport useLang from '../../hooks/useLang';\nimport { captureEvents } from '../../util/captureEvents';\nimport useMedia from '../../hooks/useMedia';\nimport { makeTrackId } from '../../util/audioPlayer';\nimport { getTranslation } from '../../util/langProvider';\n\nimport Button from '../ui/Button';\nimport ProgressSpinner from '../ui/ProgressSpinner';\nimport Link from '../ui/Link';\n\nimport './Audio.scss';\n\ntype OwnProps = {\n  theme: ISettings['theme'];\n  message: ApiMessage;\n  senderTitle?: string;\n  uploadProgress?: number;\n  origin: AudioOrigin;\n  date?: number;\n  lastSyncTime?: number;\n  noAvatars?: boolean;\n  className?: string;\n  isSelectable?: boolean;\n  isSelected?: boolean;\n  isDownloading: boolean;\n  isTranscribing?: boolean;\n  isTranscribed?: boolean;\n  canDownload?: boolean;\n  canTranscribe?: boolean;\n  isTranscriptionHidden?: boolean;\n  isTranscriptionError?: boolean;\n  onHideTranscription?: (isHidden: boolean) => void;\n  onPlay: (messageId: number, chatId: string) => void;\n  onReadMedia?: () => void;\n  onCancelUpload?: () => void;\n  onDateClick?: (messageId: number, chatId: string) => void;\n};\n\nexport const TINY_SCREEN_WIDTH_MQL = window.matchMedia('(max-width: 375px)');\nexport const WITH_AVATAR_TINY_SCREEN_WIDTH_MQL = window.matchMedia('(max-width: 410px)');\nconst AVG_VOICE_DURATION = 10;\n// This is needed for browsers requiring user interaction before playing.\nconst PRELOAD = true;\n// eslint-disable-next-line max-len\nconst TRANSCRIBE_SVG = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 24\" class=\"loading-svg\"><rect class=\"loading-rect\" fill=\"transparent\" width=\"32\" height=\"24\" stroke-width=\"3\" stroke-linejoin=\"round\" rx=\"6\" ry=\"6\" stroke=\"var(--accent-color)\" stroke-dashoffset=\"1\" stroke-dasharray=\"32,68\"></rect></svg>';\n\nconst Audio: FC<OwnProps> = ({\n  theme,\n  message,\n  senderTitle,\n  uploadProgress,\n  origin,\n  date,\n  lastSyncTime,\n  noAvatars,\n  className,\n  isSelectable,\n  isSelected,\n  isDownloading,\n  isTranscribing,\n  isTranscriptionHidden,\n  isTranscribed,\n  isTranscriptionError,\n  canDownload,\n  canTranscribe,\n  onHideTranscription,\n  onPlay,\n  onReadMedia,\n  onCancelUpload,\n  onDateClick,\n}) => {\n  const { cancelMessageMediaDownload, downloadMessageMedia, transcribeAudio } = getActions();\n\n  const { content: { audio, voice, video }, isMediaUnread } = message;\n  const isVoice = Boolean(voice || video);\n  const isSeeking = useRef<boolean>(false);\n  // eslint-disable-next-line no-null/no-null\n  const seekerRef = useRef<HTMLDivElement>(null);\n  const lang = useLang();\n  const { isRtl } = lang;\n\n  const [isActivated, setIsActivated] = useState(false);\n  const shouldLoad = (isActivated || PRELOAD) && lastSyncTime;\n  const coverHash = getMessageMediaHash(message, 'pictogram');\n  const coverBlobUrl = useMedia(coverHash, false, ApiMediaFormat.BlobUrl);\n\n  const mediaData = useMedia(\n    getMessageMediaHash(message, 'inline'),\n    !shouldLoad,\n    getMessageMediaFormat(message, 'inline'),\n  );\n\n  const { loadProgress: downloadProgress } = useMediaWithLoadProgress(\n    getMessageMediaHash(message, 'download'),\n    !isDownloading,\n    getMessageMediaFormat(message, 'download'),\n  );\n\n  const handleForcePlay = useCallback(() => {\n    setIsActivated(true);\n    onPlay(message.id, message.chatId);\n  }, [message, onPlay]);\n\n  const handleTrackChange = useCallback(() => {\n    setIsActivated(false);\n  }, []);\n\n  const {\n    isBuffered, bufferedRanges, bufferingHandlers, checkBuffering,\n  } = useBuffering();\n\n  const {\n    isPlaying, playProgress, playPause, setCurrentTime, duration,\n  } = useAudioPlayer(\n    makeTrackId(message),\n    getMediaDuration(message)!,\n    isVoice ? 'voice' : 'audio',\n    mediaData,\n    bufferingHandlers,\n    undefined,\n    checkBuffering,\n    isActivated,\n    handleForcePlay,\n    handleTrackChange,\n    isMessageLocal(message),\n  );\n\n  const isOwn = isOwnMessage(message);\n  const waveformCanvasRef = useWaveformCanvas(\n    theme, voice, (isMediaUnread && !isOwn) ? 1 : playProgress, isOwn, !noAvatars,\n  );\n\n  const withSeekline = isPlaying || (playProgress > 0 && playProgress < 1);\n\n  useEffect(() => {\n    setIsActivated(isPlaying);\n  }, [isPlaying]);\n\n  const isLoadingForPlaying = isActivated && !isBuffered;\n\n  const {\n    isUploading, isTransferring, transferProgress,\n  } = getMediaTransferState(\n    message,\n    uploadProgress || downloadProgress,\n    isLoadingForPlaying || isDownloading,\n  );\n\n  const {\n    shouldRender: shouldRenderSpinner,\n    transitionClassNames: spinnerClassNames,\n  } = useShowTransition(isTransferring);\n\n  const shouldRenderCross = shouldRenderSpinner && (isLoadingForPlaying || isUploading);\n\n  const handleButtonClick = useCallback(() => {\n    if (isUploading) {\n      onCancelUpload?.();\n      return;\n    }\n\n    if (!isPlaying) {\n      onPlay(message.id, message.chatId);\n    }\n\n    getActions().setAudioPlayerOrigin({ origin });\n    setIsActivated(!isActivated);\n    playPause();\n  }, [isUploading, isPlaying, isActivated, playPause, onCancelUpload, onPlay, message.id, message.chatId, origin]);\n\n  useEffect(() => {\n    if (onReadMedia && isMediaUnread && (isPlaying || isDownloading)) {\n      onReadMedia();\n    }\n  }, [isPlaying, isMediaUnread, onReadMedia, isDownloading]);\n\n  const handleDownloadClick = useCallback(() => {\n    if (isDownloading) {\n      cancelMessageMediaDownload({ message });\n    } else {\n      downloadMessageMedia({ message });\n    }\n  }, [cancelMessageMediaDownload, downloadMessageMedia, isDownloading, message]);\n\n  const handleSeek = useCallback((e: MouseEvent | TouchEvent) => {\n    if (isSeeking.current && seekerRef.current) {\n      const { width, left } = seekerRef.current.getBoundingClientRect();\n      const clientX = e instanceof MouseEvent ? e.clientX : e.targetTouches[0].clientX;\n      e.stopPropagation(); // Prevent Slide-to-Reply activation\n      // Prevent track skipping while seeking near end\n      setCurrentTime(Math.max(Math.min(duration * ((clientX - left) / width), duration - 0.1), 0.001));\n    }\n  }, [duration, setCurrentTime]);\n\n  const handleStartSeek = useCallback((e: MouseEvent | TouchEvent) => {\n    if (e instanceof MouseEvent && e.button === 2) return;\n    isSeeking.current = true;\n    handleSeek(e);\n  }, [handleSeek]);\n\n  const handleStopSeek = useCallback(() => {\n    isSeeking.current = false;\n  }, []);\n\n  const handleDateClick = useCallback(() => {\n    onDateClick!(message.id, message.chatId);\n  }, [onDateClick, message.id, message.chatId]);\n\n  const handleTranscribe = useCallback(() => {\n    transcribeAudio({ chatId: message.chatId, messageId: message.id });\n  }, [message.chatId, message.id, transcribeAudio]);\n\n  useEffect(() => {\n    if (!seekerRef.current || !withSeekline) return undefined;\n    return captureEvents(seekerRef.current, {\n      onCapture: handleStartSeek,\n      onRelease: handleStopSeek,\n      onClick: handleStopSeek,\n      onDrag: handleSeek,\n    });\n  }, [withSeekline, handleStartSeek, handleSeek, handleStopSeek]);\n\n  const transcribeSvgMemo = useMemo(() => (\n    <div dangerouslySetInnerHTML={{ __html: TRANSCRIBE_SVG }} />\n  ), []);\n\n  function renderFirstLine() {\n    if (isVoice) {\n      return senderTitle || 'Voice';\n    }\n\n    const { title, fileName } = audio!;\n\n    return title || fileName;\n  }\n\n  function renderSecondLine() {\n    if (isVoice) {\n      return (\n        <div className=\"meta\" dir={isRtl ? 'rtl' : undefined}>\n          {formatMediaDuration((voice || video)!.duration)}\n        </div>\n      );\n    }\n\n    const { performer } = audio!;\n\n    return (\n      <div className=\"meta\" dir={isRtl ? 'rtl' : undefined}>\n        {formatMediaDuration(duration)}\n        <span className=\"bullet\">&bull;</span>\n        {performer && <span className=\"performer\" title={performer}>{renderText(performer)}</span>}\n        {performer && senderTitle && <span className=\"bullet\">&bull;</span>}\n        {senderTitle && <span title={senderTitle}>{renderText(senderTitle)}</span>}\n      </div>\n    );\n  }\n\n  const fullClassName = buildClassName(\n    'Audio',\n    className,\n    isOwn && origin === AudioOrigin.Inline && 'own',\n    (origin === AudioOrigin.Search || origin === AudioOrigin.SharedMedia) && 'bigger',\n    isSelected && 'audio-is-selected',\n  );\n\n  const buttonClassNames = ['toggle-play'];\n  if (shouldRenderCross) {\n    buttonClassNames.push('loading');\n  } else {\n    buttonClassNames.push(isPlaying ? 'pause' : 'play');\n  }\n\n  const contentClassName = buildClassName('content', withSeekline && 'with-seekline');\n\n  function renderWithTitle() {\n    return (\n      <div className={contentClassName}>\n        <div className=\"content-row\">\n          <p className=\"title\" dir=\"auto\" title={renderFirstLine()}>{renderText(renderFirstLine())}</p>\n\n          <div className=\"message-date\">\n            {date && (\n              <Link\n                className=\"date\"\n                onClick={handleDateClick}\n              >\n                {formatPastTimeShort(lang, date * 1000)}\n              </Link>\n            )}\n          </div>\n        </div>\n\n        {withSeekline && (\n          <div className=\"meta search-result\" dir={isRtl ? 'rtl' : undefined}>\n            <span className=\"duration with-seekline\" dir=\"auto\">\n              {playProgress < 1 && `${formatMediaDuration(duration * playProgress, duration)}`}\n            </span>\n            {renderSeekline(playProgress, bufferedRanges, seekerRef)}\n          </div>\n        )}\n        {!withSeekline && renderSecondLine()}\n      </div>\n    );\n  }\n\n  return (\n    <div className={fullClassName} dir={lang.isRtl ? 'rtl' : 'ltr'}>\n      {isSelectable && (\n        <div className=\"message-select-control\">\n          {isSelected && <i className=\"icon-select\" />}\n        </div>\n      )}\n      <Button\n        round\n        ripple={!IS_SINGLE_COLUMN_LAYOUT}\n        size=\"smaller\"\n        color={coverBlobUrl ? 'translucent-white' : 'primary'}\n        className={buttonClassNames.join(' ')}\n        ariaLabel={isPlaying ? 'Pause audio' : 'Play audio'}\n        onClick={handleButtonClick}\n        isRtl={lang.isRtl}\n        backgroundImage={coverBlobUrl}\n      >\n        <i className=\"icon-play\" />\n        <i className=\"icon-pause\" />\n      </Button>\n      {shouldRenderSpinner && (\n        <div className={buildClassName('media-loading', spinnerClassNames, shouldRenderCross && 'interactive')}>\n          <ProgressSpinner\n            progress={transferProgress}\n            transparent\n            size=\"m\"\n            onClick={shouldRenderCross ? handleButtonClick : undefined}\n            noCross={!shouldRenderCross}\n          />\n        </div>\n      )}\n      {audio && canDownload && !isUploading && (\n        <Button\n          round\n          size=\"tiny\"\n          className=\"download-button\"\n          ariaLabel={isDownloading ? 'Cancel download' : 'Download'}\n          onClick={handleDownloadClick}\n        >\n          <i className={isDownloading ? 'icon-close' : 'icon-arrow-down'} />\n        </Button>\n      )}\n      {origin === AudioOrigin.Search && renderWithTitle()}\n      {origin !== AudioOrigin.Search && audio && renderAudio(\n        lang,\n        audio,\n        duration,\n        isPlaying,\n        playProgress,\n        bufferedRanges,\n        seekerRef,\n        (isDownloading || isUploading),\n        date,\n        transferProgress,\n        onDateClick ? handleDateClick : undefined,\n      )}\n      {origin === AudioOrigin.SharedMedia && (voice || video) && renderWithTitle()}\n      {origin === AudioOrigin.Inline && voice && (\n        renderVoice(\n          voice,\n          seekerRef,\n          waveformCanvasRef,\n          playProgress,\n          isMediaUnread,\n          isTranscribing,\n          isTranscriptionHidden,\n          isTranscribed,\n          isTranscriptionError,\n          transcribeSvgMemo,\n          canTranscribe ? handleTranscribe : undefined,\n          onHideTranscription,\n        )\n      )}\n    </div>\n  );\n};\n\nfunction getSeeklineSpikeAmounts(withAvatar?: boolean) {\n  return {\n    MIN_SPIKES: IS_SINGLE_COLUMN_LAYOUT ? (TINY_SCREEN_WIDTH_MQL.matches ? 16 : 20) : 25,\n    MAX_SPIKES: IS_SINGLE_COLUMN_LAYOUT\n      ? (TINY_SCREEN_WIDTH_MQL.matches\n        ? 35\n        : (withAvatar && WITH_AVATAR_TINY_SCREEN_WIDTH_MQL.matches ? 40 : 45))\n      : 75,\n  };\n}\n\nfunction renderAudio(\n  lang: LangFn,\n  audio: ApiAudio,\n  duration: number,\n  isPlaying: boolean,\n  playProgress: number,\n  bufferedRanges: BufferedRange[],\n  seekerRef: React.Ref<HTMLElement>,\n  showProgress?: boolean,\n  date?: number,\n  progress?: number,\n  handleDateClick?: NoneToVoidFunction,\n) {\n  const {\n    title, performer, fileName,\n  } = audio;\n  const showSeekline = isPlaying || (playProgress > 0 && playProgress < 1);\n  const { isRtl } = getTranslation;\n\n  return (\n    <div className=\"content\">\n      <p className=\"title\" dir=\"auto\" title={title}>{renderText(title || fileName)}</p>\n      {showSeekline && (\n        <div className=\"meta\" dir={isRtl ? 'rtl' : undefined}>\n          <span className=\"duration with-seekline\" dir=\"auto\">\n            {formatMediaDuration(duration * playProgress, duration)}\n          </span>\n          {renderSeekline(playProgress, bufferedRanges, seekerRef)}\n        </div>\n      )}\n      {!showSeekline && showProgress && (\n        <div className=\"meta\" dir={isRtl ? 'rtl' : undefined}>\n          {progress ? `${getFileSizeString(audio!.size * progress)} / ` : undefined}{getFileSizeString(audio!.size)}\n        </div>\n      )}\n      {!showSeekline && !showProgress && (\n        <div className=\"meta\" dir={isRtl ? 'rtl' : undefined}>\n          <span className=\"duration\" dir=\"auto\">{formatMediaDuration(duration)}</span>\n          {performer && (\n            <>\n              <span className=\"bullet\">&bull;</span>\n              <span className=\"performer\" dir=\"auto\" title={performer}>{renderText(performer)}</span>\n            </>\n          )}\n          {date && (\n            <>\n              <span className=\"bullet\">&bull;</span>\n              <Link className=\"date\" onClick={handleDateClick}>\n                {formatMediaDateTime(lang, date * 1000, true)}\n              </Link>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction renderVoice(\n  voice: ApiVoice,\n  seekerRef: React.Ref<HTMLDivElement>,\n  waveformCanvasRef: React.Ref<HTMLCanvasElement>,\n  playProgress: number,\n  isMediaUnread?: boolean,\n  isTranscribing?: boolean,\n  isTranscriptionHidden?: boolean,\n  isTranscribed?: boolean,\n  isTranscriptionError?: boolean,\n  svgMemo?: React.ReactNode,\n  onClickTranscribe?: VoidFunction,\n  onHideTranscription?: (isHidden: boolean) => void,\n) {\n  return (\n    <div className=\"content\">\n      <div className=\"waveform-wrapper\">\n        <div\n          className=\"waveform\"\n          draggable={false}\n          ref={seekerRef}\n        >\n          <canvas ref={waveformCanvasRef} />\n        </div>\n        {onClickTranscribe && (\n          // eslint-disable-next-line react/jsx-no-bind\n          <Button onClick={() => {\n            if ((isTranscribed || isTranscriptionError) && onHideTranscription) {\n              onHideTranscription(!isTranscriptionHidden);\n            } else if (!isTranscribing) {\n              onClickTranscribe();\n            }\n          }}\n          >\n            <i className={buildClassName(\n              'transcribe-icon',\n              (isTranscribed || isTranscriptionError) ? 'icon-down' : 'icon-transcribe',\n              (isTranscribed || isTranscriptionError) && !isTranscriptionHidden && 'transcribe-shown',\n            )}\n            />\n            {isTranscribing && svgMemo}\n          </Button>\n        )}\n      </div>\n      <p className={buildClassName('voice-duration', isMediaUnread && 'unread')} dir=\"auto\">\n        {playProgress === 0 ? formatMediaDuration(voice.duration) : formatMediaDuration(voice.duration * playProgress)}\n      </p>\n    </div>\n  );\n}\n\nfunction useWaveformCanvas(\n  theme: ISettings['theme'],\n  voice?: ApiVoice,\n  playProgress = 0,\n  isOwn = false,\n  withAvatar = false,\n) {\n  // eslint-disable-next-line no-null/no-null\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const { data: spikes, peak } = useMemo(() => {\n    if (!voice) {\n      return undefined;\n    }\n\n    const { waveform, duration } = voice;\n    if (!waveform) {\n      return {\n        data: new Array(Math.min(duration, MAX_EMPTY_WAVEFORM_POINTS)).fill(0),\n        peak: 0,\n      };\n    }\n\n    const { MIN_SPIKES, MAX_SPIKES } = getSeeklineSpikeAmounts(withAvatar);\n    const durationFactor = Math.min(duration / AVG_VOICE_DURATION, 1);\n    const spikesCount = Math.round(MIN_SPIKES + (MAX_SPIKES - MIN_SPIKES) * durationFactor);\n    const decodedWaveform = decodeWaveform(new Uint8Array(waveform));\n\n    return interpolateArray(decodedWaveform, spikesCount);\n  }, [voice, withAvatar]) || {};\n\n  useLayoutEffect(() => {\n    const canvas = canvasRef.current;\n\n    if (!canvas || !spikes || peak === undefined) {\n      return;\n    }\n\n    const fillColor = theme === 'dark' ? '#494A78' : '#ADD3F7';\n    const fillOwnColor = theme === 'dark' ? '#B7ABED' : '#AEDFA4';\n    const progressFillColor = theme === 'dark' ? '#8774E1' : '#3390EC';\n    const progressFillOwnColor = theme === 'dark' ? '#FFFFFF' : '#4FAE4E';\n\n    renderWaveform(canvas, spikes, playProgress, {\n      peak,\n      fillStyle: isOwn ? fillOwnColor : fillColor,\n      progressFillStyle: isOwn ? progressFillOwnColor : progressFillColor,\n    });\n  }, [isOwn, peak, playProgress, spikes, theme]);\n\n  return canvasRef;\n}\n\nfunction renderSeekline(\n  playProgress: number,\n  bufferedRanges: BufferedRange[],\n  seekerRef: React.Ref<HTMLElement>,\n) {\n  return (\n    <div\n      className=\"seekline no-selection\"\n      ref={seekerRef as React.Ref<HTMLDivElement>}\n    >\n      {bufferedRanges.map(({ start, end }) => (\n        <div\n          className=\"seekline-buffered-progress\"\n          style={`left: ${start * 100}%; right: ${100 - end * 100}%`}\n        />\n      ))}\n      <span className=\"seekline-play-progress\">\n        <i\n          style={`transform: translateX(${playProgress * 100}%)`}\n        />\n      </span>\n      <span className=\"seekline-thumb\">\n        <i\n          style={`transform: translateX(${playProgress * 100}%)`}\n        />\n      </span>\n    </div>\n  );\n}\n\nexport default memo(Audio);\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useState,\n} from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { GlobalState } from '../../global/types';\nimport type { ApiChat, ApiCountryCode, ApiUser } from '../../api/types';\n\nimport {\n  selectChat, selectNotifyExceptions, selectNotifySettings, selectUser,\n} from '../../global/selectors';\nimport {\n  getChatDescription, getChatLink, getHasAdminRight, isChatChannel, isUserId, isUserRightBanned, selectIsChatMuted,\n} from '../../global/helpers';\nimport renderText from './helpers/renderText';\nimport { copyTextToClipboard } from '../../util/clipboard';\nimport { formatPhoneNumberWithCode } from '../../util/phoneNumber';\nimport { debounce } from '../../util/schedulers';\nimport useLang from '../../hooks/useLang';\n\nimport ListItem from '../ui/ListItem';\nimport Switcher from '../ui/Switcher';\n\ntype OwnProps = {\n  chatOrUserId: string;\n  forceShowSelf?: boolean;\n};\n\ntype StateProps =\n  {\n    user?: ApiUser;\n    chat?: ApiChat;\n    canInviteUsers?: boolean;\n    isMuted?: boolean;\n    phoneCodeList: ApiCountryCode[];\n  }\n  & Pick<GlobalState, 'lastSyncTime'>;\n\nconst runDebounced = debounce((cb) => cb(), 500, false);\n\nconst ChatExtra: FC<OwnProps & StateProps> = ({\n  lastSyncTime,\n  user,\n  chat,\n  forceShowSelf,\n  canInviteUsers,\n  isMuted,\n  phoneCodeList,\n}) => {\n  const {\n    loadFullUser,\n    showNotification,\n    updateChatMutedState,\n  } = getActions();\n\n  const {\n    id: userId,\n    fullInfo,\n    username,\n    phoneNumber,\n    isSelf,\n  } = user || {};\n  const { id: chatId } = chat || {};\n  const lang = useLang();\n\n  const [areNotificationsEnabled, setAreNotificationsEnabled] = useState(!isMuted);\n  useEffect(() => {\n    if (lastSyncTime && userId) {\n      loadFullUser({ userId });\n    }\n  }, [loadFullUser, userId, lastSyncTime]);\n\n  const handleNotificationChange = useCallback(() => {\n    setAreNotificationsEnabled((current) => {\n      const newAreNotificationsEnabled = !current;\n\n      runDebounced(() => {\n        updateChatMutedState({ chatId, isMuted: !newAreNotificationsEnabled });\n      });\n\n      return newAreNotificationsEnabled;\n    });\n  }, [chatId, updateChatMutedState]);\n\n  if (!chat || chat.isRestricted || (isSelf && !forceShowSelf)) {\n    return undefined;\n  }\n\n  function copy(text: string, entity: string) {\n    copyTextToClipboard(text);\n    showNotification({ message: `${entity} was copied` });\n  }\n\n  const formattedNumber = phoneNumber && formatPhoneNumberWithCode(phoneCodeList, phoneNumber);\n  const link = getChatLink(chat);\n  const description = (fullInfo?.bio) || getChatDescription(chat);\n\n  return (\n    <div className=\"ChatExtra\">\n      {formattedNumber && Boolean(formattedNumber.length) && (\n        // eslint-disable-next-line react/jsx-no-bind\n        <ListItem icon=\"phone\" multiline narrow ripple onClick={() => copy(formattedNumber, lang('Phone'))}>\n          <span className=\"title\" dir=\"auto\">{formattedNumber}</span>\n          <span className=\"subtitle\">{lang('Phone')}</span>\n        </ListItem>\n      )}\n      {username && (\n        <ListItem\n          icon=\"mention\"\n          multiline\n          narrow\n          ripple\n          // eslint-disable-next-line react/jsx-no-bind\n          onClick={() => copy(`@${username}`, lang('Username'))}\n        >\n          <span className=\"title\" dir=\"auto\">{renderText(username)}</span>\n          <span className=\"subtitle\">{lang('Username')}</span>\n        </ListItem>\n      )}\n      {description && Boolean(description.length) && (\n        <ListItem\n          icon=\"info\"\n          multiline\n          narrow\n          isStatic\n        >\n          <span className=\"title word-break\" dir=\"auto\">\n            {renderText(description, ['br', 'links', 'emoji'])}\n          </span>\n          <span className=\"subtitle\">{lang(userId ? 'UserBio' : 'Info')}</span>\n        </ListItem>\n      )}\n      {(canInviteUsers || !username) && link && (\n        <ListItem\n          icon={chat.username ? 'mention' : 'link'}\n          multiline\n          narrow\n          ripple\n          // eslint-disable-next-line react/jsx-no-bind\n          onClick={() => copy(link, lang('SetUrlPlaceholder'))}\n        >\n          <div className=\"title\">{link}</div>\n          <span className=\"subtitle\">{lang('SetUrlPlaceholder')}</span>\n        </ListItem>\n      )}\n      {!forceShowSelf && (\n        <ListItem icon=\"unmute\" ripple onClick={handleNotificationChange}>\n          <span>{lang('Notifications')}</span>\n          <Switcher\n            id=\"group-notifications\"\n            label={userId ? 'Toggle User Notifications' : 'Toggle Chat Notifications'}\n            checked={areNotificationsEnabled}\n            inactive\n          />\n        </ListItem>\n      )}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { chatOrUserId }): StateProps => {\n    const { lastSyncTime, countryList: { phoneCodes: phoneCodeList } } = global;\n\n    const chat = chatOrUserId ? selectChat(global, chatOrUserId) : undefined;\n    const user = isUserId(chatOrUserId) ? selectUser(global, chatOrUserId) : undefined;\n    const isMuted = chat && selectIsChatMuted(chat, selectNotifySettings(global), selectNotifyExceptions(global));\n\n    const canInviteUsers = chat && !user && (\n      (!isChatChannel(chat) && !isUserRightBanned(chat, 'inviteUsers'))\n      || getHasAdminRight(chat, 'inviteUsers')\n    );\n\n    return {\n      lastSyncTime, phoneCodeList, chat, user, canInviteUsers, isMuted,\n    };\n  },\n)(ChatExtra));\n","import type { FC } from '../../lib/teact/teact';\nimport React, { useCallback, memo } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiChat } from '../../api/types';\nimport type { AnimationLevel } from '../../types';\n\nimport { selectIsChatWithSelf, selectUser } from '../../global/selectors';\nimport {\n  isUserId,\n  isUserBot,\n  getUserFirstOrLastName,\n  getPrivateChatUserId,\n  isChatBasicGroup,\n  isChatSuperGroup,\n  isChatChannel,\n  getChatTitle,\n} from '../../global/helpers';\nimport useLang from '../../hooks/useLang';\nimport renderText from './helpers/renderText';\n\nimport Avatar from './Avatar';\nimport Modal from '../ui/Modal';\nimport Button from '../ui/Button';\n\nimport './DeleteChatModal.scss';\n\nexport type OwnProps = {\n  isOpen: boolean;\n  chat: ApiChat;\n  onClose: () => void;\n  onCloseAnimationEnd?: () => void;\n};\n\ntype StateProps = {\n  isChannel: boolean;\n  isChatWithSelf?: boolean;\n  isBot?: boolean;\n  isPrivateChat: boolean;\n  isBasicGroup: boolean;\n  isSuperGroup: boolean;\n  currentUserId: string | undefined;\n  canDeleteForAll?: boolean;\n  contactName?: string;\n  animationLevel: AnimationLevel;\n};\n\nconst DeleteChatModal: FC<OwnProps & StateProps> = ({\n  isOpen,\n  chat,\n  isChannel,\n  isPrivateChat,\n  isChatWithSelf,\n  isBot,\n  isBasicGroup,\n  isSuperGroup,\n  currentUserId,\n  canDeleteForAll,\n  contactName,\n  animationLevel,\n  onClose,\n  onCloseAnimationEnd,\n}) => {\n  const {\n    leaveChannel,\n    deleteHistory,\n    deleteChannel,\n    deleteChatUser,\n    blockContact,\n  } = getActions();\n\n  const lang = useLang();\n  const chatTitle = getChatTitle(lang, chat);\n\n  const handleDeleteForAll = useCallback(() => {\n    deleteHistory({ chatId: chat.id, shouldDeleteForAll: true });\n\n    onClose();\n  }, [deleteHistory, chat.id, onClose]);\n\n  const handleDeleteAndStop = useCallback(() => {\n    deleteHistory({ chatId: chat.id, shouldDeleteForAll: true });\n    blockContact({ contactId: chat.id, accessHash: chat.accessHash });\n\n    onClose();\n  }, [deleteHistory, chat.id, chat.accessHash, blockContact, onClose]);\n\n  const handleDeleteChat = useCallback(() => {\n    if (isPrivateChat) {\n      deleteHistory({ chatId: chat.id, shouldDeleteForAll: false });\n    } else if (isBasicGroup) {\n      deleteChatUser({ chatId: chat.id, userId: currentUserId });\n      deleteHistory({ chatId: chat.id, shouldDeleteForAll: false });\n    } else if ((isChannel || isSuperGroup) && !chat.isCreator) {\n      leaveChannel({ chatId: chat.id });\n    } else if ((isChannel || isSuperGroup) && chat.isCreator) {\n      deleteChannel({ chatId: chat.id });\n    }\n    onClose();\n  }, [\n    isPrivateChat,\n    isBasicGroup,\n    isChannel,\n    isSuperGroup,\n    currentUserId,\n    chat.isCreator,\n    chat.id,\n    onClose,\n    deleteHistory,\n    deleteChatUser,\n    leaveChannel,\n    deleteChannel,\n  ]);\n\n  const handleLeaveChat = useCallback(() => {\n    if (isChannel || isSuperGroup) {\n      leaveChannel({ chatId: chat.id });\n      onClose();\n    } else {\n      handleDeleteChat();\n    }\n  }, [chat.id, handleDeleteChat, isChannel, isSuperGroup, leaveChannel, onClose]);\n\n  function renderHeader() {\n    return (\n      <div className=\"modal-header\" dir={lang.isRtl ? 'rtl' : undefined}>\n        <Avatar\n          size=\"tiny\"\n          chat={chat}\n          isSavedMessages={isChatWithSelf}\n          animationLevel={animationLevel}\n          withVideo\n        />\n        <h3 className=\"modal-title\">{lang(renderTitle())}</h3>\n      </div>\n    );\n  }\n\n  function renderTitle() {\n    if (isChannel && !chat.isCreator) {\n      return 'LeaveChannel';\n    }\n\n    if (isChannel && chat.isCreator) {\n      return 'ChannelDelete';\n    }\n\n    if (isBasicGroup || isSuperGroup) {\n      return 'Group.LeaveGroup';\n    }\n\n    return 'DeleteChatUser';\n  }\n\n  function renderContent() {\n    if (isChannel && chat.isCreator) {\n      return (\n        <p>\n          {renderText(lang('ChatList.DeleteAndLeaveGroupConfirmation', chatTitle), ['simple_markdown', 'emoji'])}\n        </p>\n      );\n    }\n\n    if ((isChannel && !chat.isCreator) || isBasicGroup || isSuperGroup) {\n      return <p>{renderText(lang('ChannelLeaveAlertWithName', chatTitle), ['simple_markdown', 'emoji'])}</p>;\n    }\n\n    return <p>{renderText(lang('ChatList.DeleteChatConfirmation', contactName), ['simple_markdown', 'emoji'])}</p>;\n  }\n\n  function renderActionText() {\n    if (isChannel && !chat.isCreator) {\n      return 'LeaveChannel';\n    }\n    if (isChannel && chat.isCreator) {\n      return 'Chat.Input.Delete';\n    }\n\n    if (isBasicGroup || isSuperGroup) {\n      return 'Group.LeaveGroup';\n    }\n\n    return canDeleteForAll ? 'ChatList.DeleteForCurrentUser' : 'Delete';\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      className=\"DeleteChatModal\"\n      header={renderHeader()}\n      onClose={onClose}\n      onCloseAnimationEnd={onCloseAnimationEnd}\n    >\n      {renderContent()}\n      {isBot && (\n        <Button color=\"danger\" className=\"confirm-dialog-button\" isText onClick={handleDeleteAndStop}>\n          {lang('DeleteAndStop')}\n        </Button>\n      )}\n      {canDeleteForAll && (\n        <Button color=\"danger\" className=\"confirm-dialog-button\" isText onClick={handleDeleteForAll}>\n          {contactName ? renderText(lang('ChatList.DeleteForEveryone', contactName)) : lang('DeleteForAll')}\n        </Button>\n      )}\n      {!isPrivateChat && chat.isCreator && (\n        <Button color=\"danger\" className=\"confirm-dialog-button\" isText onClick={handleDeleteChat}>\n          {lang('DeleteForAll')}\n        </Button>\n      )}\n      <Button\n        color=\"danger\"\n        className=\"confirm-dialog-button\"\n        isText\n        onClick={isPrivateChat ? handleDeleteChat : handleLeaveChat}\n      >\n        {lang(renderActionText())}\n      </Button>\n      <Button className=\"confirm-dialog-button\" isText onClick={onClose}>{lang('Cancel')}</Button>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { chat }): StateProps => {\n    const isPrivateChat = isUserId(chat.id);\n    const isChatWithSelf = selectIsChatWithSelf(global, chat.id);\n    const user = isPrivateChat && selectUser(global, getPrivateChatUserId(chat)!);\n    const isBot = user && isUserBot(user) && !chat.isSupport;\n    const canDeleteForAll = (isPrivateChat && !isChatWithSelf && !isBot);\n    const contactName = isPrivateChat\n      ? getUserFirstOrLastName(selectUser(global, getPrivateChatUserId(chat)!))\n      : undefined;\n\n    return {\n      isPrivateChat,\n      isChatWithSelf,\n      isBot,\n      isChannel: isChatChannel(chat),\n      isBasicGroup: isChatBasicGroup(chat),\n      isSuperGroup: isChatSuperGroup(chat),\n      currentUserId: global.currentUserId,\n      canDeleteForAll,\n      contactName,\n      animationLevel: global.settings.byKey.animationLevel,\n    };\n  },\n)(DeleteChatModal));\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  useCallback, memo, useRef, useEffect, useState,\n} from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type { ApiMessage } from '../../api/types';\n\nimport {\n  SUPPORTED_IMAGE_CONTENT_TYPES,\n  SUPPORTED_VIDEO_CONTENT_TYPES,\n} from '../../config';\nimport { getDocumentExtension, getDocumentHasPreview } from './helpers/documentInfo';\nimport {\n  getMediaTransferState,\n  getMessageMediaFormat,\n  getMessageMediaHash,\n  getMessageMediaThumbDataUri,\n  isMessageDocumentVideo,\n} from '../../global/helpers';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport { useIsIntersecting } from '../../hooks/useIntersectionObserver';\nimport useMediaWithLoadProgress from '../../hooks/useMediaWithLoadProgress';\nimport useMedia from '../../hooks/useMedia';\nimport useFlag from '../../hooks/useFlag';\n\nimport File from './File';\n\ntype OwnProps = {\n  message: ApiMessage;\n  observeIntersection?: ObserveFn;\n  smaller?: boolean;\n  isSelected?: boolean;\n  isSelectable?: boolean;\n  canAutoLoad?: boolean;\n  uploadProgress?: number;\n  withDate?: boolean;\n  datetime?: number;\n  className?: string;\n  sender?: string;\n  autoLoadFileMaxSizeMb?: number;\n  isDownloading: boolean;\n  onCancelUpload?: () => void;\n  onMediaClick?: () => void;\n  onDateClick?: (messageId: number, chatId: string) => void;\n};\n\nconst BYTES_PER_MB = 1024 * 1024;\n\nconst Document: FC<OwnProps> = ({\n  message,\n  observeIntersection,\n  smaller,\n  canAutoLoad,\n  autoLoadFileMaxSizeMb,\n  uploadProgress,\n  withDate,\n  datetime,\n  className,\n  sender,\n  isSelected,\n  isSelectable,\n  onCancelUpload,\n  onMediaClick,\n  onDateClick,\n  isDownloading,\n}) => {\n  const dispatch = getActions();\n\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLDivElement>(null);\n\n  const document = message.content.document!;\n  const { fileName, size, timestamp } = document;\n  const extension = getDocumentExtension(document) || '';\n\n  const isIntersecting = useIsIntersecting(ref, observeIntersection);\n  const [wasIntersected, markIntersected] = useFlag();\n  useEffect(() => {\n    if (isIntersecting) {\n      markIntersected();\n    }\n  }, [isIntersecting, markIntersected]);\n\n  // Auto-loading does not use global download manager because requires additional click to save files locally\n  const [isLoadAllowed, setIsLoadAllowed] = useState(\n    canAutoLoad && (!autoLoadFileMaxSizeMb || size <= autoLoadFileMaxSizeMb * BYTES_PER_MB),\n  );\n\n  const shouldDownload = Boolean(isDownloading || (isLoadAllowed && wasIntersected));\n\n  const documentHash = getMessageMediaHash(message, 'download');\n  const { loadProgress: downloadProgress, mediaData } = useMediaWithLoadProgress(\n    documentHash, !shouldDownload, getMessageMediaFormat(message, 'download'), undefined, undefined, true,\n  );\n  const isLoaded = Boolean(mediaData);\n\n  const {\n    isUploading, isTransferring, transferProgress,\n  } = getMediaTransferState(message, uploadProgress || downloadProgress, shouldDownload && !isLoaded);\n\n  const hasPreview = getDocumentHasPreview(document);\n  const thumbDataUri = hasPreview ? getMessageMediaThumbDataUri(message) : undefined;\n  const localBlobUrl = hasPreview ? document.previewBlobUrl : undefined;\n  const previewData = useMedia(getMessageMediaHash(message, 'pictogram'), !isIntersecting);\n\n  const withMediaViewer = onMediaClick && Boolean(document.mediaType) && (\n    SUPPORTED_VIDEO_CONTENT_TYPES.has(document.mimeType) || SUPPORTED_IMAGE_CONTENT_TYPES.has(document.mimeType)\n  );\n\n  const handleClick = useCallback(() => {\n    if (isUploading) {\n      if (onCancelUpload) {\n        onCancelUpload();\n      }\n      return;\n    }\n\n    if (isDownloading) {\n      dispatch.cancelMessageMediaDownload({ message });\n      return;\n    }\n\n    if (isTransferring) {\n      setIsLoadAllowed(false);\n      return;\n    }\n\n    if (withMediaViewer) {\n      onMediaClick!();\n    } else {\n      dispatch.downloadMessageMedia({ message });\n    }\n  }, [\n    isUploading, isDownloading, isTransferring, withMediaViewer, onCancelUpload, dispatch, message, onMediaClick,\n  ]);\n\n  const handleDateClick = useCallback(() => {\n    onDateClick!(message.id, message.chatId);\n  }, [onDateClick, message.id, message.chatId]);\n\n  return (\n    <File\n      ref={ref}\n      name={fileName}\n      extension={extension}\n      size={size}\n      timestamp={withDate ? datetime || timestamp : undefined}\n      thumbnailDataUri={thumbDataUri}\n      previewData={localBlobUrl || previewData}\n      smaller={smaller}\n      isTransferring={isTransferring}\n      isUploading={isUploading}\n      transferProgress={transferProgress}\n      className={className}\n      sender={sender}\n      isSelectable={isSelectable}\n      isSelected={isSelected}\n      actionIcon={withMediaViewer ? (isMessageDocumentVideo(message) ? 'icon-play' : 'icon-eye') : 'icon-download'}\n      onClick={handleClick}\n      onDateClick={onDateClick ? handleDateClick : undefined}\n    />\n  );\n};\n\nexport default memo(Document);\n","import React from '../../lib/teact/teact';\n\nimport type { FC } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport renderText from './helpers/renderText';\n\nimport useLang from '../../hooks/useLang';\n\nimport './DotAnimation.scss';\n\ntype OwnProps = {\n  content: string;\n  className?: string;\n};\n\nconst DotAnimation: FC<OwnProps> = ({ content, className }) => {\n  const lang = useLang();\n  return (\n    <span className={buildClassName('DotAnimation', className)} dir={lang.isRtl ? 'rtl' : 'auto'}>\n      {renderText(content)}\n      <span className=\"ellipsis\" />\n    </span>\n  );\n};\n\nexport default DotAnimation;\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\n\nimport type { ApiFakeType } from '../../api/types';\n\nimport useLang from '../../hooks/useLang';\n\nimport './FakeIcon.scss';\n\ntype OwnProps = {\n  fakeType: ApiFakeType;\n};\n\nconst FakeIcon: FC<OwnProps> = ({\n  fakeType,\n}) => {\n  const lang = useLang();\n\n  return (\n    <span className=\"FakeIcon\">\n      {lang(fakeType === 'fake' ? 'FakeMessage' : 'ScamMessage')}\n    </span>\n  );\n};\n\nexport default memo(FakeIcon);\n","import type { RefObject } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { memo, useRef, useState } from '../../lib/teact/teact';\n\nimport { IS_CANVAS_FILTER_SUPPORTED, IS_SINGLE_COLUMN_LAYOUT } from '../../util/environment';\nimport useShowTransition from '../../hooks/useShowTransition';\nimport useMediaTransition from '../../hooks/useMediaTransition';\nimport buildClassName from '../../util/buildClassName';\nimport { formatMediaDateTime, formatPastTimeShort } from '../../util/dateFormat';\nimport { getColorFromExtension, getFileSizeString } from './helpers/documentInfo';\nimport { getDocumentThumbnailDimensions } from './helpers/mediaDimensions';\nimport renderText from './helpers/renderText';\nimport useLang from '../../hooks/useLang';\nimport useCanvasBlur from '../../hooks/useCanvasBlur';\n\nimport ProgressSpinner from '../ui/ProgressSpinner';\nimport Link from '../ui/Link';\n\nimport './File.scss';\n\ntype OwnProps = {\n  ref?: RefObject<HTMLDivElement>;\n  name: string;\n  extension?: string;\n  size: number;\n  timestamp?: number;\n  sender?: string;\n  thumbnailDataUri?: string;\n  previewData?: string;\n  className?: string;\n  smaller?: boolean;\n  isTransferring?: boolean;\n  isUploading?: boolean;\n  isSelectable?: boolean;\n  isSelected?: boolean;\n  transferProgress?: number;\n  actionIcon?: string;\n  onClick?: () => void;\n  onDateClick?: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n};\n\nconst File: FC<OwnProps> = ({\n  ref,\n  name,\n  size,\n  extension = '',\n  timestamp,\n  sender,\n  thumbnailDataUri,\n  previewData,\n  className,\n  smaller,\n  isTransferring,\n  isUploading,\n  isSelectable,\n  isSelected,\n  transferProgress,\n  actionIcon,\n  onClick,\n  onDateClick,\n}) => {\n  const lang = useLang();\n  // eslint-disable-next-line no-null/no-null\n  let elementRef = useRef<HTMLDivElement>(null);\n  if (ref) {\n    elementRef = ref;\n  }\n\n  const [withThumb] = useState(!previewData);\n  const noThumb = Boolean(previewData);\n  const thumbRef = useCanvasBlur(thumbnailDataUri, noThumb, IS_SINGLE_COLUMN_LAYOUT && !IS_CANVAS_FILTER_SUPPORTED);\n  const thumbClassNames = useMediaTransition(!noThumb);\n\n  const {\n    shouldRender: shouldSpinnerRender,\n    transitionClassNames: spinnerClassNames,\n  } = useShowTransition(isTransferring, undefined, true);\n\n  const color = getColorFromExtension(extension);\n  const sizeString = getFileSizeString(size);\n\n  const { width, height } = getDocumentThumbnailDimensions(smaller);\n\n  const fullClassName = buildClassName(\n    'File',\n    className,\n    smaller && 'smaller',\n    onClick && !isUploading && 'interactive',\n    isSelected && 'file-is-selected',\n  );\n\n  return (\n    <div ref={elementRef} className={fullClassName} dir={lang.isRtl ? 'rtl' : undefined}>\n      {isSelectable && (\n        <div className=\"message-select-control\">\n          {isSelected && <i className=\"icon-select\" />}\n        </div>\n      )}\n      <div className=\"file-icon-container\" onClick={isUploading ? undefined : onClick}>\n        {thumbnailDataUri || previewData ? (\n          <div className=\"file-preview media-inner\">\n            <img\n              src={previewData}\n              className=\"full-media\"\n              width={width}\n              height={height}\n              alt=\"\"\n            />\n            {withThumb && (\n              <canvas\n                ref={thumbRef}\n                className={buildClassName('thumbnail', thumbClassNames)}\n              />\n            )}\n          </div>\n        ) : (\n          <div className={`file-icon ${color}`}>\n            {extension.length <= 4 && (\n              <span className=\"file-ext\" dir=\"auto\">{extension}</span>\n            )}\n          </div>\n        )}\n        {shouldSpinnerRender && (\n          <div className={buildClassName('file-progress', color, spinnerClassNames)}>\n            <ProgressSpinner\n              progress={transferProgress}\n              size={smaller ? 's' : 'm'}\n              onClick={isUploading ? onClick : undefined}\n            />\n          </div>\n        )}\n        {onClick && (\n          <i\n            className={buildClassName(\n              'action-icon',\n              actionIcon || 'icon-download',\n              shouldSpinnerRender && 'hidden',\n            )}\n          />\n        )}\n      </div>\n      <div className=\"file-info\">\n        <div className=\"file-title\" dir=\"auto\">{renderText(name)}</div>\n        <div className=\"file-subtitle\" dir=\"auto\">\n          <span>\n            {isTransferring && transferProgress ? `${Math.round(transferProgress * 100)}%` : sizeString}\n          </span>\n          {sender && <span className=\"file-sender\">{renderText(sender)}</span>}\n          {!sender && timestamp && (\n            <>\n              <span className=\"bullet\" />\n              <Link onClick={onDateClick}>{formatMediaDateTime(lang, timestamp * 1000, true)}</Link>\n            </>\n          )}\n        </div>\n      </div>\n      {sender && timestamp && (\n        <Link onClick={onDateClick}>{formatPastTimeShort(lang, timestamp * 1000)}</Link>\n      )}\n    </div>\n  );\n};\n\nexport default memo(File);\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport './VerifiedIcon.scss';\n\n// eslint-disable-next-line max-len\nconst VERIFIED_ICON = { __html: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M12.3 2.9c.1.1.2.1.3.2.7.6 1.3 1.1 2 1.7.3.2.6.4.9.4.9.1 1.7.2 2.6.2.5 0 .6.1.7.7.1.9.1 1.8.2 2.6 0 .4.2.7.4 1 .6.7 1.1 1.3 1.7 2 .3.4.3.5 0 .8-.5.6-1.1 1.3-1.6 1.9-.3.3-.5.7-.5 1.2-.1.8-.2 1.7-.2 2.5 0 .4-.2.5-.6.6-.8 0-1.6.1-2.5.2-.5 0-1 .2-1.4.5-.6.5-1.3 1.1-1.9 1.6-.3.3-.5.3-.8 0-.7-.6-1.4-1.2-2-1.8-.3-.2-.6-.4-.9-.4-.9-.1-1.8-.2-2.7-.2-.4 0-.5-.2-.6-.5 0-.9-.1-1.7-.2-2.6 0-.4-.2-.8-.4-1.1-.6-.6-1.1-1.3-1.6-2-.4-.4-.3-.5 0-1 .6-.6 1.1-1.3 1.7-1.9.3-.3.4-.6.4-1 0-.8.1-1.6.2-2.5 0-.5.1-.6.6-.6.9-.1 1.7-.1 2.6-.2.4 0 .7-.2 1-.4.7-.6 1.4-1.2 2.1-1.7.1-.2.3-.3.5-.2z\" style=\"fill: var(--color-fill)\"/><path class=\"lol\" d=\"M16.4 10.1l-.2.2-5.4 5.4c-.1.1-.2.2-.4 0l-2.6-2.6c-.2-.2-.1-.3 0-.4.2-.2.5-.6.7-.6.3 0 .5.4.7.6l1.1 1.1c.2.2.3.2.5 0l4.3-4.3c.2-.2.4-.3.6 0 .1.2.3.3.4.5.2 0 .3.1.3.1z\" style=\"fill: var(--color-checkmark)\"/></svg>' };\n\nconst VerifiedIcon: FC = () => {\n  return (\n    // eslint-disable-next-line react/no-danger\n    <span className=\"VerifiedIcon\" dangerouslySetInnerHTML={VERIFIED_ICON} />\n  );\n};\n\nexport default VerifiedIcon;\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"ysHMmXALnn0fgFRc7Bn7\"};","import React, { memo } from '../../lib/teact/teact';\n\nimport type { ApiChat, ApiUser } from '../../api/types';\nimport type { FC } from '../../lib/teact/teact';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\n\nimport { EMOJI_STATUS_LOOP_LIMIT } from '../../config';\nimport renderText from './helpers/renderText';\nimport { getChatTitle, getUserFullName, isUserId } from '../../global/helpers';\nimport buildClassName from '../../util/buildClassName';\n\nimport useLang from '../../hooks/useLang';\n\nimport VerifiedIcon from './VerifiedIcon';\nimport FakeIcon from './FakeIcon';\nimport CustomEmoji from './CustomEmoji';\nimport PremiumIcon from './PremiumIcon';\n\nimport styles from './FullNameTitle.module.scss';\n\ntype OwnProps = {\n  peer: ApiChat | ApiUser;\n  className?: string;\n  noVerified?: boolean;\n  noFake?: boolean;\n  withEmojiStatus?: boolean;\n  emojiStatusSize?: number;\n  isSavedMessages?: boolean;\n  noLoopLimit?: boolean;\n  onEmojiStatusClick?: NoneToVoidFunction;\n  observeIntersection?: ObserveFn;\n};\n\nconst FullNameTitle: FC<OwnProps> = ({\n  className,\n  peer,\n  noVerified,\n  noFake,\n  withEmojiStatus,\n  emojiStatusSize,\n  isSavedMessages,\n  noLoopLimit,\n  onEmojiStatusClick,\n  observeIntersection,\n}) => {\n  const lang = useLang();\n  const isUser = isUserId(peer.id);\n  const title = isUser ? getUserFullName(peer as ApiUser) : getChatTitle(lang, peer as ApiChat);\n  const emojiStatus = isUser && (peer as ApiUser).emojiStatus;\n  const isPremium = isUser && (peer as ApiUser).isPremium;\n\n  if (isSavedMessages) {\n    return (\n      <div className={buildClassName('title', styles.root, className)}>\n        <h3>{lang('SavedMessages')}</h3>\n      </div>\n    );\n  }\n\n  return (\n    <div className={buildClassName('title', styles.root, className)}>\n      <h3 dir=\"auto\" className=\"fullName\">{renderText(title)}</h3>\n      {!noVerified && peer.isVerified && <VerifiedIcon />}\n      {!noFake && peer.fakeType && <FakeIcon fakeType={peer.fakeType} />}\n      {withEmojiStatus && emojiStatus && (\n        <CustomEmoji\n          documentId={emojiStatus.documentId}\n          size={emojiStatusSize}\n          loopLimit={!noLoopLimit ? EMOJI_STATUS_LOOP_LIMIT : undefined}\n          observeIntersectionForLoading={observeIntersection}\n          onClick={onEmojiStatusClick}\n        />\n      )}\n      {withEmojiStatus && !emojiStatus && isPremium && <PremiumIcon />}\n    </div>\n  );\n};\n\nexport default memo(FullNameTitle);\n","import type { MouseEvent as ReactMouseEvent } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { useEffect, useCallback, memo } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiChat, ApiTypingStatus } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\nimport type { AnimationLevel } from '../../types';\nimport { MediaViewerOrigin } from '../../types';\n\nimport {\n  getChatTypeString,\n  isChatSuperGroup,\n} from '../../global/helpers';\nimport { selectChat, selectChatMessages, selectChatOnlineCount } from '../../global/selectors';\nimport type { LangFn } from '../../hooks/useLang';\nimport useLang from '../../hooks/useLang';\n\nimport Avatar from './Avatar';\nimport TypingStatus from './TypingStatus';\nimport DotAnimation from './DotAnimation';\nimport FullNameTitle from './FullNameTitle';\n\ntype OwnProps = {\n  chatId: string;\n  typingStatus?: ApiTypingStatus;\n  avatarSize?: 'small' | 'medium' | 'large' | 'jumbo';\n  status?: string;\n  withDots?: boolean;\n  withMediaViewer?: boolean;\n  withUsername?: boolean;\n  withFullInfo?: boolean;\n  withUpdatingStatus?: boolean;\n  withChatType?: boolean;\n  withVideoAvatar?: boolean;\n  noRtl?: boolean;\n};\n\ntype StateProps =\n  {\n    chat?: ApiChat;\n    onlineCount?: number;\n    areMessagesLoaded: boolean;\n    animationLevel: AnimationLevel;\n  }\n  & Pick<GlobalState, 'lastSyncTime'>;\n\nconst GroupChatInfo: FC<OwnProps & StateProps> = ({\n  typingStatus,\n  avatarSize = 'medium',\n  status,\n  withDots,\n  withMediaViewer,\n  withUsername,\n  withFullInfo,\n  withUpdatingStatus,\n  withChatType,\n  withVideoAvatar,\n  noRtl,\n  chat,\n  onlineCount,\n  areMessagesLoaded,\n  animationLevel,\n  lastSyncTime,\n}) => {\n  const {\n    loadFullChat,\n    openMediaViewer,\n    loadProfilePhotos,\n  } = getActions();\n\n  const isSuperGroup = chat && isChatSuperGroup(chat);\n  const { id: chatId, isMin, isRestricted } = chat || {};\n\n  useEffect(() => {\n    if (chatId && !isMin && lastSyncTime) {\n      if (withFullInfo) loadFullChat({ chatId });\n      if (withMediaViewer) loadProfilePhotos({ profileId: chatId });\n    }\n  }, [chatId, isMin, lastSyncTime, withFullInfo, loadFullChat, loadProfilePhotos, isSuperGroup, withMediaViewer]);\n\n  const handleAvatarViewerOpen = useCallback((e: ReactMouseEvent<HTMLDivElement, MouseEvent>, hasMedia: boolean) => {\n    if (chat && hasMedia) {\n      e.stopPropagation();\n      openMediaViewer({\n        avatarOwnerId: chat.id,\n        mediaId: 0,\n        origin: avatarSize === 'jumbo' ? MediaViewerOrigin.ProfileAvatar : MediaViewerOrigin.MiddleHeaderAvatar,\n      });\n    }\n  }, [chat, avatarSize, openMediaViewer]);\n\n  const lang = useLang();\n\n  if (!chat) {\n    return undefined;\n  }\n\n  function renderStatusOrTyping() {\n    if (status) {\n      return withDots ? (\n        <DotAnimation className=\"status\" content={status} />\n      ) : (\n        <span className=\"status\" dir=\"auto\">{status}</span>\n      );\n    }\n\n    if (withUpdatingStatus && !areMessagesLoaded && !isRestricted) {\n      return (\n        <DotAnimation className=\"status\" content={lang('Updating')} />\n      );\n    }\n\n    if (!chat) {\n      return undefined;\n    }\n\n    if (typingStatus) {\n      return <TypingStatus typingStatus={typingStatus} />;\n    }\n\n    if (withChatType) {\n      return (\n        <span className=\"status\" dir=\"auto\">{lang(getChatTypeString(chat))}</span>\n      );\n    }\n\n    const handle = withUsername ? chat.username : undefined;\n    const groupStatus = getGroupStatus(lang, chat);\n    const onlineStatus = onlineCount ? `, ${lang('OnlineCount', onlineCount, 'i')}` : undefined;\n\n    return (\n      <span className=\"status\">\n        {handle && <span className=\"handle\">{handle}</span>}\n        <span className=\"group-status\">{groupStatus}</span>\n        {onlineStatus && <span className=\"online-status\">{onlineStatus}</span>}\n      </span>\n    );\n  }\n\n  return (\n    <div className=\"ChatInfo\" dir={!noRtl && lang.isRtl ? 'rtl' : undefined}>\n      <Avatar\n        key={chat.id}\n        size={avatarSize}\n        chat={chat}\n        onClick={withMediaViewer ? handleAvatarViewerOpen : undefined}\n        withVideo={withVideoAvatar}\n        animationLevel={animationLevel}\n      />\n      <div className=\"info\">\n        <FullNameTitle peer={chat} />\n        {renderStatusOrTyping()}\n      </div>\n    </div>\n  );\n};\n\nfunction getGroupStatus(lang: LangFn, chat: ApiChat) {\n  const chatTypeString = lang(getChatTypeString(chat));\n  const { membersCount } = chat;\n\n  if (chat.isRestricted) {\n    return chatTypeString === 'Channel' ? 'channel is inaccessible' : 'group is inaccessible';\n  }\n\n  if (!membersCount) {\n    return chatTypeString;\n  }\n\n  return chatTypeString === 'Channel'\n    ? lang('Subscribers', membersCount, 'i')\n    : lang('Members', membersCount, 'i');\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { chatId }): StateProps => {\n    const { lastSyncTime } = global;\n    const chat = selectChat(global, chatId);\n    const onlineCount = chat ? selectChatOnlineCount(global, chat) : undefined;\n    const areMessagesLoaded = Boolean(selectChatMessages(global, chatId));\n\n    return {\n      lastSyncTime,\n      chat,\n      onlineCount,\n      areMessagesLoaded,\n      animationLevel: global.settings.byKey.animationLevel,\n    };\n  },\n)(GroupChatInfo));\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\n\nimport type { ApiMessage, ApiMessageOutgoingStatus } from '../../api/types';\n\nimport { formatPastTimeShort } from '../../util/dateFormat';\nimport useLang from '../../hooks/useLang';\n\nimport MessageOutgoingStatus from './MessageOutgoingStatus';\n\nimport './LastMessageMeta.scss';\n\ntype OwnProps = {\n  message: ApiMessage;\n  outgoingStatus?: ApiMessageOutgoingStatus;\n};\n\nconst LastMessageMeta: FC<OwnProps> = ({ message, outgoingStatus }) => {\n  const lang = useLang();\n  return (\n    <div className=\"LastMessageMeta\">\n      {outgoingStatus && (\n        <MessageOutgoingStatus status={outgoingStatus} />\n      )}\n      <span className=\"time\">{formatPastTimeShort(lang, message.date * 1000)}</span>\n    </div>\n  );\n};\n\nexport default memo(LastMessageMeta);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useCallback, useRef } from '../../lib/teact/teact';\n\nimport type { ApiMessage } from '../../api/types';\n\nimport { formatMediaDuration } from '../../util/dateFormat';\nimport stopEvent from '../../util/stopEvent';\nimport {\n  getMessageHtmlId,\n  getMessageMediaHash,\n  getMessageMediaThumbDataUri,\n  getMessageVideo,\n} from '../../global/helpers';\nimport buildClassName from '../../util/buildClassName';\nimport useMedia from '../../hooks/useMedia';\nimport useMediaTransition from '../../hooks/useMediaTransition';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport { useIsIntersecting } from '../../hooks/useIntersectionObserver';\n\nimport './Media.scss';\n\ntype OwnProps = {\n  message: ApiMessage;\n  idPrefix?: string;\n  isProtected?: boolean;\n  observeIntersection?: ObserveFn;\n  onClick?: (messageId: number, chatId: string) => void;\n};\n\nconst Media: FC<OwnProps> = ({\n  message,\n  idPrefix = 'shared-media',\n  isProtected,\n  observeIntersection,\n  onClick,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLDivElement>(null);\n\n  const isIntersecting = useIsIntersecting(ref, observeIntersection);\n  const thumbDataUri = getMessageMediaThumbDataUri(message);\n  const mediaBlobUrl = useMedia(getMessageMediaHash(message, 'pictogram'), !isIntersecting);\n  const transitionClassNames = useMediaTransition(mediaBlobUrl);\n\n  const video = getMessageVideo(message);\n\n  const handleClick = useCallback(() => {\n    onClick!(message.id, message.chatId);\n  }, [message.id, message.chatId, onClick]);\n\n  return (\n    <div\n      ref={ref}\n      id={`${idPrefix}${getMessageHtmlId(message.id)}`}\n      className=\"Media scroll-item\"\n      onClick={onClick ? handleClick : undefined}\n    >\n      <img\n        src={thumbDataUri}\n        alt=\"\"\n        draggable={!isProtected}\n        decoding=\"async\"\n        onContextMenu={isProtected ? stopEvent : undefined}\n      />\n      <img\n        src={mediaBlobUrl}\n        className={buildClassName('full-media', transitionClassNames)}\n        alt=\"\"\n        draggable={!isProtected}\n        decoding=\"async\"\n        onContextMenu={isProtected ? stopEvent : undefined}\n      />\n      {video && <span className=\"video-duration\">{video.isGif ? 'GIF' : formatMediaDuration(video.duration)}</span>}\n      {isProtected && <span className=\"protector\" />}\n    </div>\n  );\n};\n\nexport default memo(Media);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\n\nimport type { ApiMessageOutgoingStatus } from '../../api/types';\n\nimport Transition from '../ui/Transition';\n\nimport './MessageOutgoingStatus.scss';\n\ntype OwnProps = {\n  status: ApiMessageOutgoingStatus;\n};\n\nenum Keys {\n  failed, pending, succeeded, read,\n}\n\nconst MessageOutgoingStatus: FC<OwnProps> = ({ status }) => {\n  return (\n    <div className=\"MessageOutgoingStatus\">\n      <Transition name=\"reveal\" activeKey={Keys[status]}>\n        <i className={`icon-message-${status}`} />\n      </Transition>\n    </div>\n  );\n};\n\nexport default memo(MessageOutgoingStatus);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport useShowTransition from '../../hooks/useShowTransition';\nimport renderText from './helpers/renderText';\nimport useLang from '../../hooks/useLang';\n\nimport './NothingFound.scss';\n\ninterface OwnProps {\n  text?: string;\n  description?: string;\n}\n\nconst DEFAULT_TEXT = 'Nothing found.';\n\nconst NothingFound: FC<OwnProps> = ({ text = DEFAULT_TEXT, description }) => {\n  const lang = useLang();\n  const { transitionClassNames } = useShowTransition(true);\n\n  return (\n    <div className={buildClassName('NothingFound', transitionClassNames, description && 'with-description')}>\n      {text}\n      {description && <p className=\"description\">{renderText(lang(description), ['br'])}</p>}\n    </div>\n  );\n};\n\nexport default memo(NothingFound);\n","import type { ChangeEvent } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, {\n  memo, useEffect, useRef, useState,\n} from '../../lib/teact/teact';\n\nimport { MIN_PASSWORD_LENGTH } from '../../config';\nimport { IS_TOUCH_ENV, IS_SINGLE_COLUMN_LAYOUT } from '../../util/environment';\nimport buildClassName from '../../util/buildClassName';\nimport stopEvent from '../../util/stopEvent';\nimport useLang from '../../hooks/useLang';\nimport useTimeout from '../../hooks/useTimeout';\n\nimport Button from '../ui/Button';\n\ntype OwnProps = {\n  submitLabel?: string;\n  error?: string;\n  hint?: string;\n  placeholder?: string;\n  description?: string;\n  isLoading?: boolean;\n  shouldDisablePasswordManager?: boolean;\n  shouldShowSubmit?: boolean;\n  shouldResetValue?: boolean;\n  isPasswordVisible?: boolean;\n  clearError: NoneToVoidFunction;\n  noRipple?: boolean;\n  onChangePasswordVisibility: (state: boolean) => void;\n  onInputChange?: (password: string) => void;\n  onSubmit?: (password: string) => void;\n};\n\nconst FOCUS_DELAY_TIMEOUT_MS = IS_SINGLE_COLUMN_LAYOUT ? 550 : 400;\n\nconst PasswordForm: FC<OwnProps> = ({\n  isLoading = false,\n  isPasswordVisible,\n  error,\n  hint,\n  placeholder = 'Password',\n  submitLabel = 'Next',\n  description,\n  shouldShowSubmit,\n  shouldResetValue,\n  shouldDisablePasswordManager = false,\n  noRipple = false,\n  clearError,\n  onChangePasswordVisibility,\n  onInputChange,\n  onSubmit,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const inputRef = useRef<HTMLInputElement>(null);\n  const lang = useLang();\n\n  const [password, setPassword] = useState('');\n  const [canSubmit, setCanSubmit] = useState(false);\n\n  useEffect(() => {\n    if (shouldResetValue) {\n      setPassword('');\n    }\n  }, [shouldResetValue]);\n\n  useTimeout(() => {\n    if (!IS_TOUCH_ENV) {\n      inputRef.current!.focus();\n    }\n  }, FOCUS_DELAY_TIMEOUT_MS);\n\n  useEffect(() => {\n    if (error) {\n      requestAnimationFrame(() => {\n        inputRef.current!.focus();\n        inputRef.current!.select();\n      });\n    }\n  }, [error]);\n\n  function onPasswordChange(e: ChangeEvent<HTMLInputElement>) {\n    if (error) {\n      clearError();\n    }\n\n    const { target } = e;\n    setPassword(target.value);\n    setCanSubmit(target.value.length >= MIN_PASSWORD_LENGTH);\n    if (onInputChange) {\n      onInputChange(target.value);\n    }\n  }\n\n  function togglePasswordVisibility() {\n    onChangePasswordVisibility(!isPasswordVisible);\n  }\n\n  function handleSubmit(event: React.FormEvent<HTMLFormElement>) {\n    event.preventDefault();\n\n    if (isLoading) {\n      return;\n    }\n\n    if (canSubmit) {\n      onSubmit!(password);\n    }\n  }\n\n  function renderFakeInput() {\n    return (\n      <input\n        type=\"password\"\n        id=\"prevent_autofill\"\n        autoComplete=\"off\"\n        className=\"visually-hidden\"\n        tabIndex={-2}\n      />\n    );\n  }\n\n  return (\n    <form action=\"\" onSubmit={onSubmit ? handleSubmit : stopEvent} autoComplete=\"off\">\n      <div\n        className={buildClassName('input-group password-input', password && 'touched', error && 'error')}\n        dir={lang.isRtl ? 'rtl' : undefined}\n      >\n        {shouldDisablePasswordManager && renderFakeInput()}\n        <input\n          ref={inputRef}\n          className=\"form-control\"\n          type={isPasswordVisible ? 'text' : 'password'}\n          id=\"sign-in-password\"\n          value={password || ''}\n          autoComplete={shouldDisablePasswordManager ? 'one-time-code' : 'current-password'}\n          onChange={onPasswordChange}\n          maxLength={256}\n          dir=\"auto\"\n        />\n        <label>{error || hint || placeholder}</label>\n        <div\n          className=\"toggle-password\"\n          onClick={togglePasswordVisibility}\n          role=\"button\"\n          tabIndex={0}\n          title=\"Toggle password visibility\"\n        >\n          <i className={isPasswordVisible ? 'icon-eye' : 'icon-eye-closed'} />\n        </div>\n      </div>\n      {description && <p className=\"description\">{description}</p>}\n      {onSubmit && (canSubmit || shouldShowSubmit) && (\n        <Button type=\"submit\" ripple={!noRipple} isLoading={isLoading} disabled={!canSubmit}>\n          {submitLabel}\n        </Button>\n      )}\n    </form>\n  );\n};\n\nexport default memo(PasswordForm);\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  useCallback, useRef, useEffect, memo,\n} from '../../lib/teact/teact';\n\nimport { isUserId } from '../../global/helpers';\n\nimport InfiniteScroll from '../ui/InfiniteScroll';\nimport Checkbox from '../ui/Checkbox';\nimport InputText from '../ui/InputText';\nimport ListItem from '../ui/ListItem';\nimport PrivateChatInfo from './PrivateChatInfo';\nimport GroupChatInfo from './GroupChatInfo';\nimport PickerSelectedItem from './PickerSelectedItem';\nimport useInfiniteScroll from '../../hooks/useInfiniteScroll';\nimport useLang from '../../hooks/useLang';\n\nimport Loading from '../ui/Loading';\n\nimport './Picker.scss';\n\ntype OwnProps = {\n  itemIds: string[];\n  selectedIds: string[];\n  filterValue?: string;\n  filterPlaceholder?: string;\n  notFoundText?: string;\n  searchInputId?: string;\n  isLoading?: boolean;\n  noScrollRestore?: boolean;\n  onSelectedIdsChange: (ids: string[]) => void;\n  onFilterChange: (value: string) => void;\n  onLoadMore?: () => void;\n};\n\n// Focus slows down animation, also it breaks transition layout in Chrome\nconst FOCUS_DELAY_MS = 500;\n\nconst MAX_FULL_ITEMS = 10;\nconst ALWAYS_FULL_ITEMS_COUNT = 5;\n\nconst Picker: FC<OwnProps> = ({\n  itemIds,\n  selectedIds,\n  filterValue,\n  filterPlaceholder,\n  notFoundText,\n  searchInputId,\n  isLoading,\n  noScrollRestore,\n  onSelectedIdsChange,\n  onFilterChange,\n  onLoadMore,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const inputRef = useRef<HTMLInputElement>(null);\n  const shouldMinimize = selectedIds.length > MAX_FULL_ITEMS;\n\n  useEffect(() => {\n    setTimeout(() => {\n      requestAnimationFrame(() => {\n        inputRef.current!.focus();\n      });\n    }, FOCUS_DELAY_MS);\n  }, []);\n\n  const handleItemClick = useCallback((id: string) => {\n    const newSelectedIds = [...selectedIds];\n    if (newSelectedIds.includes(id)) {\n      newSelectedIds.splice(newSelectedIds.indexOf(id), 1);\n    } else {\n      newSelectedIds.push(id);\n    }\n    onSelectedIdsChange(newSelectedIds);\n    onFilterChange('');\n  }, [selectedIds, onSelectedIdsChange, onFilterChange]);\n\n  const handleFilterChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const { value } = e.currentTarget;\n    onFilterChange(value);\n  }, [onFilterChange]);\n\n  const [viewportIds, getMore] = useInfiniteScroll(onLoadMore, itemIds, Boolean(filterValue));\n\n  const lang = useLang();\n\n  return (\n    <div className=\"Picker\">\n      <div className=\"picker-header custom-scroll\" dir={lang.isRtl ? 'rtl' : undefined}>\n        {selectedIds.map((id, i) => (\n          <PickerSelectedItem\n            chatOrUserId={id}\n            isMinimized={shouldMinimize && i < selectedIds.length - ALWAYS_FULL_ITEMS_COUNT}\n            canClose\n            onClick={handleItemClick}\n            clickArg={id}\n          />\n        ))}\n        <InputText\n          id={searchInputId}\n          ref={inputRef}\n          value={filterValue}\n          onChange={handleFilterChange}\n          placeholder={filterPlaceholder || lang('SelectChat')}\n        />\n      </div>\n\n      {viewportIds?.length ? (\n        <InfiniteScroll\n          className=\"picker-list custom-scroll\"\n          items={viewportIds}\n          onLoadMore={getMore}\n          noScrollRestore={noScrollRestore}\n        >\n          {viewportIds.map((id) => (\n            <ListItem\n              key={id}\n              className=\"chat-item-clickable picker-list-item\"\n              // eslint-disable-next-line react/jsx-no-bind\n              onClick={() => handleItemClick(id)}\n              ripple\n            >\n              <Checkbox label=\"\" checked={selectedIds.includes(id)} />\n              {isUserId(id) ? (\n                <PrivateChatInfo userId={id} />\n              ) : (\n                <GroupChatInfo chatId={id} />\n              )}\n            </ListItem>\n          ))}\n        </InfiniteScroll>\n      ) : !isLoading && viewportIds && !viewportIds.length ? (\n        <p className=\"no-results\">{notFoundText || 'Sorry, nothing found.'}</p>\n      ) : (\n        <Loading />\n      )}\n    </div>\n  );\n};\n\nexport default memo(Picker);\n","import type { FC, TeactNode } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type { ApiChat, ApiUser } from '../../api/types';\n\nimport { selectChat, selectUser } from '../../global/selectors';\nimport { getChatTitle, getUserFirstOrLastName, isUserId } from '../../global/helpers';\nimport renderText from './helpers/renderText';\nimport buildClassName from '../../util/buildClassName';\nimport useLang from '../../hooks/useLang';\n\nimport Avatar from './Avatar';\n\nimport './PickerSelectedItem.scss';\n\ntype OwnProps = {\n  chatOrUserId?: string;\n  icon?: string;\n  title?: string;\n  isMinimized?: boolean;\n  canClose?: boolean;\n  onClick: (arg: any) => void;\n  clickArg: any;\n  className?: string;\n};\n\ntype StateProps = {\n  chat?: ApiChat;\n  user?: ApiUser;\n};\n\nconst PickerSelectedItem: FC<OwnProps & StateProps> = ({\n  icon,\n  title,\n  isMinimized,\n  canClose,\n  onClick,\n  clickArg,\n  chat,\n  user,\n  className,\n}) => {\n  const lang = useLang();\n\n  let iconElement: TeactNode | undefined;\n  let titleText: any;\n\n  if (icon && title) {\n    iconElement = (\n      <div className=\"item-icon\">\n        <i className={`icon-${icon}`} />\n      </div>\n    );\n\n    titleText = title;\n  } else if (chat || user) {\n    iconElement = (\n      <Avatar\n        chat={chat}\n        user={user}\n        size=\"small\"\n        isSavedMessages={user?.isSelf}\n      />\n    );\n\n    const name = !chat || (user && !user.isSelf)\n      ? getUserFirstOrLastName(user)\n      : getChatTitle(lang, chat, user);\n\n    titleText = name ? renderText(name) : undefined;\n  }\n\n  const fullClassName = buildClassName(\n    'PickerSelectedItem',\n    className,\n    isMinimized && 'minimized',\n    canClose && 'closeable',\n  );\n\n  return (\n    <div\n      className={fullClassName}\n      onClick={() => onClick(clickArg)}\n      title={isMinimized ? titleText : undefined}\n      dir={lang.isRtl ? 'rtl' : undefined}\n    >\n      {iconElement}\n      {!isMinimized && (\n        <div className=\"item-name\" dir=\"auto\">\n          {titleText}\n        </div>\n      )}\n      {canClose && (\n        <div className=\"item-remove\">\n          <i className=\"icon-close\" />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { chatOrUserId }): StateProps => {\n    if (!chatOrUserId) {\n      return {};\n    }\n\n    const chat = chatOrUserId ? selectChat(global, chatOrUserId) : undefined;\n    const user = isUserId(chatOrUserId) ? selectUser(global, chatOrUserId) : undefined;\n\n    return {\n      chat,\n      user,\n    };\n  },\n)(PickerSelectedItem));\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useMemo } from '../../lib/teact/teact';\n\nimport generateIdFor from '../../util/generateIdFor';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport './PremiumIcon.scss';\n\n// eslint-disable-next-line max-len\nconst PREMIUM_ICON = { __html: '<svg width=\"14\" height=\"15\" viewBox=\"0 0 14 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z\" fill=\"var(--color-fill)\"/></svg>' };\nconst store: Record<string, boolean> = {};\n\ntype OwnProps = {\n  withGradient?: boolean;\n  big?: boolean;\n  className?: string;\n  onClick?: VoidFunction;\n};\n\nconst PremiumIcon: FC<OwnProps> = ({\n  withGradient,\n  big,\n  className,\n  onClick,\n}) => {\n  const html = useMemo(() => {\n    return withGradient ? getPremiumIconGradient() : PREMIUM_ICON;\n  }, [withGradient]);\n\n  return (\n    <i\n      onClick={onClick}\n      className={buildClassName(\n        'PremiumIcon', className, withGradient && 'gradient', onClick && 'clickable', big && 'big',\n      )}\n      dangerouslySetInnerHTML={html}\n      title=\"Premium\"\n    />\n  );\n};\n\nfunction getPremiumIconGradient() {\n  const id = generateIdFor(store);\n  return {\n    // eslint-disable-next-line max-len\n    __html: `<svg width=\"14\" height=\"15\" viewBox=\"0 0 14 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><defs><linearGradient id=\"${id}\" x1=\"3\" y1=\"63.5001\" x2=\"84.1475\" y2=\"-1.32262\" gradientUnits=\"userSpaceOnUse\"><stop stop-color=\"#6B93FF\"/><stop offset=\"0.439058\" stop-color=\"#976FFF\"/><stop offset=\"1\" stop-color=\"#E46ACE\"/></linearGradient></defs><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z\" fill=\"url(#${id})\"/></svg>`,\n  };\n}\n\nexport default memo(PremiumIcon);\n","import React, { useEffect, useCallback, memo } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { FC } from '../../lib/teact/teact';\nimport type {\n  ApiUser, ApiTypingStatus, ApiUserStatus, ApiChatMember,\n} from '../../api/types';\nimport type { GlobalState } from '../../global/types';\nimport type { AnimationLevel } from '../../types';\nimport { MediaViewerOrigin } from '../../types';\n\nimport { selectChatMessages, selectUser, selectUserStatus } from '../../global/selectors';\nimport { getUserStatus, isUserOnline } from '../../global/helpers';\nimport buildClassName from '../../util/buildClassName';\nimport renderText from './helpers/renderText';\n\nimport useLang from '../../hooks/useLang';\n\nimport Avatar from './Avatar';\nimport TypingStatus from './TypingStatus';\nimport DotAnimation from './DotAnimation';\nimport FullNameTitle from './FullNameTitle';\n\ntype OwnProps = {\n  userId: string;\n  typingStatus?: ApiTypingStatus;\n  avatarSize?: 'tiny' | 'small' | 'medium' | 'large' | 'jumbo';\n  forceShowSelf?: boolean;\n  status?: string;\n  withDots?: boolean;\n  withMediaViewer?: boolean;\n  withUsername?: boolean;\n  withFullInfo?: boolean;\n  withUpdatingStatus?: boolean;\n  withVideoAvatar?: boolean;\n  emojiStatusSize?: number;\n  noStatusOrTyping?: boolean;\n  noRtl?: boolean;\n  adminMember?: ApiChatMember;\n};\n\ntype StateProps =\n  {\n    user?: ApiUser;\n    userStatus?: ApiUserStatus;\n    isSavedMessages?: boolean;\n    animationLevel: AnimationLevel;\n    areMessagesLoaded: boolean;\n    serverTimeOffset: number;\n  }\n  & Pick<GlobalState, 'lastSyncTime'>;\n\nconst PrivateChatInfo: FC<OwnProps & StateProps> = ({\n  typingStatus,\n  avatarSize = 'medium',\n  status,\n  withDots,\n  withMediaViewer,\n  withUsername,\n  withFullInfo,\n  withUpdatingStatus,\n  withVideoAvatar,\n  emojiStatusSize,\n  noStatusOrTyping,\n  noRtl,\n  user,\n  userStatus,\n  isSavedMessages,\n  areMessagesLoaded,\n  animationLevel,\n  lastSyncTime,\n  serverTimeOffset,\n  adminMember,\n}) => {\n  const {\n    loadFullUser,\n    openMediaViewer,\n    loadProfilePhotos,\n  } = getActions();\n\n  const { id: userId } = user || {};\n\n  useEffect(() => {\n    if (userId && lastSyncTime) {\n      if (withFullInfo) loadFullUser({ userId });\n      if (withMediaViewer) loadProfilePhotos({ profileId: userId });\n    }\n  }, [userId, loadFullUser, loadProfilePhotos, lastSyncTime, withFullInfo, withMediaViewer]);\n\n  const handleAvatarViewerOpen = useCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent>, hasMedia: boolean) => {\n    if (user && hasMedia) {\n      e.stopPropagation();\n      openMediaViewer({\n        avatarOwnerId: user.id,\n        mediaId: 0,\n        origin: avatarSize === 'jumbo' ? MediaViewerOrigin.ProfileAvatar : MediaViewerOrigin.MiddleHeaderAvatar,\n      });\n    }\n  }, [user, avatarSize, openMediaViewer]);\n\n  const lang = useLang();\n\n  if (!user) {\n    return undefined;\n  }\n\n  function renderStatusOrTyping() {\n    if (status) {\n      return withDots ? (\n        <DotAnimation className=\"status\" content={status} />\n      ) : (\n        <span className=\"status\" dir=\"auto\">{renderText(status)}</span>\n      );\n    }\n\n    if (withUpdatingStatus && !areMessagesLoaded) {\n      return (\n        <DotAnimation className=\"status\" content={lang('Updating')} />\n      );\n    }\n\n    if (!user) {\n      return undefined;\n    }\n\n    if (typingStatus) {\n      return <TypingStatus typingStatus={typingStatus} />;\n    }\n\n    return (\n      <span className={buildClassName('status', isUserOnline(user, userStatus) && 'online')}>\n        {withUsername && user.username && <span className=\"handle\">{user.username}</span>}\n        <span className=\"user-status\" dir=\"auto\">{getUserStatus(lang, user, userStatus, serverTimeOffset)}</span>\n      </span>\n    );\n  }\n\n  const customTitle = adminMember\n    ? adminMember.customTitle || lang(adminMember.isOwner ? 'GroupInfo.LabelOwner' : 'GroupInfo.LabelAdmin')\n    : undefined;\n\n  function renderNameTitle() {\n    if (customTitle) {\n      return (\n        <div className=\"info-name-title\">\n          <FullNameTitle\n            peer={user!}\n            withEmojiStatus\n            emojiStatusSize={emojiStatusSize}\n            isSavedMessages={isSavedMessages}\n          />\n          {customTitle && <span className=\"custom-title\">{customTitle}</span>}\n        </div>\n      );\n    }\n\n    return (\n      <FullNameTitle\n        peer={user!}\n        withEmojiStatus\n        emojiStatusSize={emojiStatusSize}\n        isSavedMessages={isSavedMessages}\n      />\n    );\n  }\n\n  return (\n    <div className=\"ChatInfo\" dir={!noRtl && lang.isRtl ? 'rtl' : undefined}>\n      <Avatar\n        key={user.id}\n        size={avatarSize}\n        user={user}\n        isSavedMessages={isSavedMessages}\n        onClick={withMediaViewer ? handleAvatarViewerOpen : undefined}\n        withVideo={withVideoAvatar}\n        animationLevel={animationLevel}\n      />\n      <div className=\"info\">\n        {renderNameTitle()}\n        {(status || (!isSavedMessages && !noStatusOrTyping)) && renderStatusOrTyping()}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { userId, forceShowSelf }): StateProps => {\n    const { lastSyncTime, serverTimeOffset } = global;\n    const user = selectUser(global, userId);\n    const userStatus = selectUserStatus(global, userId);\n    const isSavedMessages = !forceShowSelf && user && user.isSelf;\n    const areMessagesLoaded = Boolean(selectChatMessages(global, userId));\n\n    return {\n      lastSyncTime,\n      user,\n      userStatus,\n      isSavedMessages,\n      areMessagesLoaded,\n      serverTimeOffset,\n      animationLevel: global.settings.byKey.animationLevel,\n    };\n  },\n)(PrivateChatInfo));\n","import React, { memo, useEffect, useRef } from '../../lib/teact/teact';\n\nimport type { FC, TeactNode } from '../../lib/teact/teact';\nimport type { ApiChat, ApiPhoto, ApiUser } from '../../api/types';\n\nimport { IS_CANVAS_FILTER_SUPPORTED, IS_SINGLE_COLUMN_LAYOUT } from '../../util/environment';\nimport {\n  getChatAvatarHash,\n  getChatTitle,\n  getUserColorKey,\n  getUserFullName,\n  isUserId,\n  isChatWithRepliesBot,\n  isDeletedUser, getVideoAvatarMediaHash,\n} from '../../global/helpers';\nimport renderText from './helpers/renderText';\nimport buildClassName from '../../util/buildClassName';\nimport { getFirstLetters } from '../../util/textFormat';\nimport useMedia from '../../hooks/useMedia';\nimport useLang from '../../hooks/useLang';\nimport useFlag from '../../hooks/useFlag';\nimport useMediaTransition from '../../hooks/useMediaTransition';\nimport useCanvasBlur from '../../hooks/useCanvasBlur';\n\nimport Spinner from '../ui/Spinner';\nimport OptimizedVideo from '../ui/OptimizedVideo';\n\nimport './ProfilePhoto.scss';\n\ntype OwnProps = {\n  chat?: ApiChat;\n  user?: ApiUser;\n  isSavedMessages?: boolean;\n  photo?: ApiPhoto;\n  lastSyncTime?: number;\n  canPlayVideo: boolean;\n  onClick: NoneToVoidFunction;\n};\n\nconst ProfilePhoto: FC<OwnProps> = ({\n  chat,\n  user,\n  photo,\n  isSavedMessages,\n  canPlayVideo,\n  lastSyncTime,\n  onClick,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const videoRef = useRef<HTMLVideoElement>(null);\n\n  const lang = useLang();\n\n  const isDeleted = user && isDeletedUser(user);\n  const isRepliesChat = chat && isChatWithRepliesBot(chat.id);\n  const userOrChat = user || chat;\n  const currentPhoto = photo || userOrChat?.fullInfo?.profilePhoto;\n  const canHaveMedia = userOrChat && !isSavedMessages && !isDeleted && !isRepliesChat;\n  const { isVideo } = currentPhoto || {};\n\n  const avatarHash = canHaveMedia && getChatAvatarHash(userOrChat, 'normal', 'photo');\n  const avatarBlobUrl = useMedia(avatarHash, undefined, undefined, lastSyncTime);\n\n  const photoHash = canHaveMedia && currentPhoto && !isVideo && `photo${currentPhoto.id}?size=c`;\n  const photoBlobUrl = useMedia(photoHash, undefined, undefined, lastSyncTime);\n\n  const videoHash = canHaveMedia && currentPhoto && isVideo && getVideoAvatarMediaHash(currentPhoto);\n  const videoBlobUrl = useMedia(videoHash, undefined, undefined, lastSyncTime);\n\n  const fullMediaData = videoBlobUrl || photoBlobUrl;\n  const [isVideoReady, markVideoReady] = useFlag();\n  const isFullMediaReady = Boolean(fullMediaData && (!isVideo || isVideoReady));\n  const transitionClassNames = useMediaTransition(isFullMediaReady);\n  const isBlurredThumb = canHaveMedia && !isFullMediaReady && !avatarBlobUrl && currentPhoto?.thumbnail?.dataUri;\n  const blurredThumbCanvasRef = useCanvasBlur(\n    currentPhoto?.thumbnail?.dataUri, !isBlurredThumb, IS_SINGLE_COLUMN_LAYOUT && !IS_CANVAS_FILTER_SUPPORTED,\n  );\n  const hasMedia = currentPhoto || avatarBlobUrl || isBlurredThumb;\n\n  useEffect(() => {\n    if (videoRef.current && !canPlayVideo) {\n      videoRef.current.currentTime = 0;\n    }\n  }, [canPlayVideo]);\n\n  let content: TeactNode | undefined;\n\n  if (isSavedMessages) {\n    content = <i className=\"icon-avatar-saved-messages\" />;\n  } else if (isDeleted) {\n    content = <i className=\"icon-avatar-deleted-account\" />;\n  } else if (isRepliesChat) {\n    content = <i className=\"icon-reply-filled\" />;\n  } else if (hasMedia) {\n    content = (\n      <>\n        {isBlurredThumb ? (\n          <canvas ref={blurredThumbCanvasRef} className=\"thumb\" />\n        ) : (\n          <img src={avatarBlobUrl} className=\"thumb\" alt=\"\" />\n        )}\n        {currentPhoto && (\n          isVideo ? (\n            <OptimizedVideo\n              canPlay={canPlayVideo}\n              ref={videoRef}\n              src={fullMediaData}\n              className={buildClassName('avatar-media', transitionClassNames)}\n              muted\n              disablePictureInPicture\n              loop\n              playsInline\n              onReady={markVideoReady}\n            />\n          ) : (\n            <img\n              src={fullMediaData}\n              className={buildClassName('avatar-media', transitionClassNames)}\n              alt=\"\"\n            />\n          )\n        )}\n      </>\n    );\n  } else if (user) {\n    const userFullName = getUserFullName(user);\n    content = userFullName ? getFirstLetters(userFullName, 2) : undefined;\n  } else if (chat) {\n    const title = getChatTitle(lang, chat);\n    content = title && getFirstLetters(title, isUserId(chat.id) ? 2 : 1);\n  } else {\n    content = (\n      <div className=\"spinner-wrapper\">\n        <Spinner color=\"white\" />\n      </div>\n    );\n  }\n\n  const fullClassName = buildClassName(\n    'ProfilePhoto',\n    `color-bg-${getUserColorKey(user || chat)}`,\n    isSavedMessages && 'saved-messages',\n    isDeleted && 'deleted-account',\n    isRepliesChat && 'replies-bot-account',\n    (!isSavedMessages && !hasMedia) && 'no-photo',\n  );\n\n  return (\n    <div className={fullClassName} onClick={hasMedia ? onClick : undefined}>\n      {typeof content === 'string' ? renderText(content, ['hq_emoji']) : content}\n    </div>\n  );\n};\n\nexport default memo(ProfilePhoto);\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  useEffect, useCallback, memo, useState,\n} from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiUser, ApiChat, ApiUserStatus } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\nimport type { AnimationLevel } from '../../types';\nimport { MediaViewerOrigin } from '../../types';\n\nimport { IS_TOUCH_ENV } from '../../util/environment';\nimport { MEMO_EMPTY_ARRAY } from '../../util/memo';\nimport { selectChat, selectUser, selectUserStatus } from '../../global/selectors';\nimport {\n  getUserStatus, isChatChannel, isUserOnline,\n} from '../../global/helpers';\nimport { captureEvents, SwipeDirection } from '../../util/captureEvents';\nimport buildClassName from '../../util/buildClassName';\n\nimport usePhotosPreload from './hooks/usePhotosPreload';\nimport useLang from '../../hooks/useLang';\nimport usePrevious from '../../hooks/usePrevious';\n\nimport FullNameTitle from './FullNameTitle';\nimport ProfilePhoto from './ProfilePhoto';\nimport Transition from '../ui/Transition';\n\nimport './ProfileInfo.scss';\n\ntype OwnProps = {\n  userId: string;\n  forceShowSelf?: boolean;\n  canPlayVideo: boolean;\n};\n\ntype StateProps =\n  {\n    user?: ApiUser;\n    userStatus?: ApiUserStatus;\n    chat?: ApiChat;\n    isSavedMessages?: boolean;\n    animationLevel: AnimationLevel;\n    serverTimeOffset: number;\n    mediaId?: number;\n    avatarOwnerId?: string;\n  }\n  & Pick<GlobalState, 'connectionState'>;\n\nconst EMOJI_STATUS_SIZE = 24;\n\nconst ProfileInfo: FC<OwnProps & StateProps> = ({\n  forceShowSelf,\n  canPlayVideo,\n  user,\n  userStatus,\n  chat,\n  isSavedMessages,\n  connectionState,\n  animationLevel,\n  serverTimeOffset,\n  mediaId,\n  avatarOwnerId,\n}) => {\n  const {\n    loadFullUser,\n    openMediaViewer,\n    openPremiumModal,\n  } = getActions();\n\n  const lang = useLang();\n\n  const { id: userId } = user || {};\n  const { id: chatId } = chat || {};\n  const photos = user?.photos || chat?.photos || MEMO_EMPTY_ARRAY;\n  const prevMediaId = usePrevious(mediaId);\n  const prevAvatarOwnerId = usePrevious(avatarOwnerId);\n  const [hasSlideAnimation, setHasSlideAnimation] = useState(true);\n  const slideAnimation = hasSlideAnimation\n    ? animationLevel >= 1 ? (lang.isRtl ? 'slide-optimized-rtl' : 'slide-optimized') : 'none'\n    : 'none';\n\n  const [currentPhotoIndex, setCurrentPhotoIndex] = useState(0);\n  const isFirst = isSavedMessages || photos.length <= 1 || currentPhotoIndex === 0;\n  const isLast = isSavedMessages || photos.length <= 1 || currentPhotoIndex === photos.length - 1;\n\n  // Set the current avatar photo to the last selected photo in Media Viewer after it is closed\n  useEffect(() => {\n    if (prevAvatarOwnerId && prevMediaId !== undefined && mediaId === undefined) {\n      setHasSlideAnimation(false);\n      setCurrentPhotoIndex(prevMediaId);\n    }\n  }, [mediaId, prevMediaId, prevAvatarOwnerId]);\n\n  // Deleting the last profile photo may result in an error\n  useEffect(() => {\n    if (currentPhotoIndex > photos.length) {\n      setCurrentPhotoIndex(Math.max(0, photos.length - 1));\n    }\n  }, [currentPhotoIndex, photos.length]);\n\n  useEffect(() => {\n    if (connectionState === 'connectionStateReady' && userId && !forceShowSelf) {\n      loadFullUser({ userId });\n    }\n  }, [userId, loadFullUser, connectionState, forceShowSelf]);\n\n  usePhotosPreload(user || chat, photos, currentPhotoIndex);\n\n  const handleProfilePhotoClick = useCallback(() => {\n    openMediaViewer({\n      avatarOwnerId: userId || chatId,\n      mediaId: currentPhotoIndex,\n      origin: forceShowSelf ? MediaViewerOrigin.SettingsAvatar : MediaViewerOrigin.ProfileAvatar,\n    });\n  }, [openMediaViewer, userId, chatId, currentPhotoIndex, forceShowSelf]);\n\n  const handleClickPremium = useCallback(() => {\n    if (!user) return;\n\n    openPremiumModal({ fromUserId: user.id });\n  }, [openPremiumModal, user]);\n\n  const selectPreviousMedia = useCallback(() => {\n    if (isFirst) {\n      return;\n    }\n    setHasSlideAnimation(true);\n    setCurrentPhotoIndex(currentPhotoIndex - 1);\n  }, [currentPhotoIndex, isFirst]);\n\n  const selectNextMedia = useCallback(() => {\n    if (isLast) {\n      return;\n    }\n    setHasSlideAnimation(true);\n    setCurrentPhotoIndex(currentPhotoIndex + 1);\n  }, [currentPhotoIndex, isLast]);\n\n  // Swipe gestures\n  useEffect(() => {\n    const element = document.querySelector<HTMLDivElement>('.photo-wrapper');\n    if (!element) {\n      return undefined;\n    }\n\n    return captureEvents(element, {\n      selectorToPreventScroll: '.Profile, .settings-content',\n      onSwipe: IS_TOUCH_ENV ? (e, direction) => {\n        if (direction === SwipeDirection.Right) {\n          selectPreviousMedia();\n          return true;\n        } else if (direction === SwipeDirection.Left) {\n          selectNextMedia();\n          return true;\n        }\n\n        return false;\n      } : undefined,\n    });\n  }, [selectNextMedia, selectPreviousMedia]);\n\n  if (!user && !chat) {\n    return undefined;\n  }\n\n  function renderPhotoTabs() {\n    if (isSavedMessages || !photos || photos.length <= 1) {\n      return undefined;\n    }\n\n    return (\n      <div className=\"photo-dashes\">\n        {photos.map((_, i) => (\n          <span className={`photo-dash ${i === currentPhotoIndex ? 'current' : ''}`} />\n        ))}\n      </div>\n    );\n  }\n\n  function renderPhoto(isActive?: boolean) {\n    const photo = !isSavedMessages && photos.length > 0\n      ? photos[currentPhotoIndex]\n      : undefined;\n    return (\n      <ProfilePhoto\n        key={currentPhotoIndex}\n        user={user}\n        chat={chat}\n        photo={photo}\n        isSavedMessages={isSavedMessages}\n        canPlayVideo={Boolean(isActive && canPlayVideo)}\n        onClick={handleProfilePhotoClick}\n      />\n    );\n  }\n\n  function renderStatus() {\n    if (user) {\n      return (\n        <div className={buildClassName('status', isUserOnline(user, userStatus) && 'online')}>\n          <span className=\"user-status\" dir=\"auto\">{getUserStatus(lang, user, userStatus, serverTimeOffset)}</span>\n        </div>\n      );\n    }\n\n    return (\n      <span className=\"status\" dir=\"auto\">{\n        isChatChannel(chat!)\n          ? lang('Subscribers', chat!.membersCount ?? 0, 'i')\n          : lang('Members', chat!.membersCount ?? 0, 'i')\n      }\n      </span>\n    );\n  }\n\n  return (\n    <div className={buildClassName('ProfileInfo', forceShowSelf && 'self')} dir={lang.isRtl ? 'rtl' : undefined}>\n      <div className=\"photo-wrapper\">\n        {renderPhotoTabs()}\n        <Transition activeKey={currentPhotoIndex} name={slideAnimation} className=\"profile-slide-container\">\n          {renderPhoto}\n        </Transition>\n\n        {!isFirst && (\n          <button\n            type=\"button\"\n            className=\"navigation prev\"\n            aria-label={lang('AccDescrPrevious')}\n            onClick={selectPreviousMedia}\n          />\n        )}\n        {!isLast && (\n          <button\n            type=\"button\"\n            className=\"navigation next\"\n            aria-label={lang('Next')}\n            onClick={selectNextMedia}\n          />\n        )}\n      </div>\n\n      <div className=\"info\" dir={lang.isRtl ? 'rtl' : 'auto'}>\n        {(user || chat) && (\n          <FullNameTitle\n            peer={(user || chat)!}\n            withEmojiStatus\n            emojiStatusSize={EMOJI_STATUS_SIZE}\n            isSavedMessages={isSavedMessages}\n            onEmojiStatusClick={handleClickPremium}\n            noLoopLimit\n          />\n        )}\n        {!isSavedMessages && renderStatus()}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { userId, forceShowSelf }): StateProps => {\n    const { connectionState, serverTimeOffset } = global;\n    const user = selectUser(global, userId);\n    const userStatus = selectUserStatus(global, userId);\n    const chat = selectChat(global, userId);\n    const isSavedMessages = !forceShowSelf && user && user.isSelf;\n    const { animationLevel } = global.settings.byKey;\n    const { mediaId, avatarOwnerId } = global.mediaViewer;\n\n    return {\n      connectionState,\n      user,\n      userStatus,\n      chat,\n      isSavedMessages,\n      animationLevel,\n      serverTimeOffset,\n      mediaId,\n      avatarOwnerId,\n    };\n  },\n)(ProfileInfo));\n","import type { ApiChat, ApiPhoto, ApiUser } from '../../../api/types';\nimport { ApiMediaFormat } from '../../../api/types';\nimport { useEffect } from '../../../lib/teact/teact';\nimport * as mediaLoader from '../../../util/mediaLoader';\n\nconst PHOTOS_TO_PRELOAD = 4;\n\nexport default function usePhotosPreload(\n  profile: ApiUser | ApiChat | undefined,\n  photos: ApiPhoto[],\n  currentIndex: number,\n) {\n  useEffect(() => {\n    photos.slice(currentIndex, currentIndex + PHOTOS_TO_PRELOAD).forEach((photo) => {\n      const mediaData = mediaLoader.getFromMemory(`photo${photo.id}?size=c`);\n      if (!mediaData) {\n        mediaLoader.fetch(`photo${photo.id}?size=c`, ApiMediaFormat.BlobUrl);\n      }\n    });\n  }, [currentIndex, photos]);\n}\n","import type { RefObject } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport { ApiMediaFormat } from '../../api/types';\n\nimport useMedia from '../../hooks/useMedia';\nimport buildClassName from '../../util/buildClassName';\n\nimport './ReactionStaticEmoji.scss';\n\ntype OwnProps = {\n  reaction: string;\n  ref?: RefObject<HTMLImageElement>;\n  className?: string;\n};\n\nconst ReactionStaticEmoji: FC<OwnProps> = ({\n  reaction,\n  ref,\n  className,\n}) => {\n  const staticIconId = getGlobal().availableReactions?.find((l) => l.reaction === reaction)?.staticIcon?.id;\n  const mediaData = useMedia(`document${staticIconId}`, !staticIconId, ApiMediaFormat.BlobUrl);\n\n  return (\n    <img\n      className={buildClassName('ReactionStaticEmoji', className)}\n      ref={ref}\n      src={mediaData}\n      alt=\"\"\n    />\n  );\n};\n\nexport default memo(ReactionStaticEmoji);\n","import type { ChangeEvent } from 'react';\n\nimport type { FC } from '../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useMemo, useState,\n} from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type { ApiPhoto, ApiReportReason } from '../../api/types';\n\nimport useLang from '../../hooks/useLang';\n\nimport Modal from '../ui/Modal';\nimport Button from '../ui/Button';\nimport RadioGroup from '../ui/RadioGroup';\nimport InputText from '../ui/InputText';\n\nexport type OwnProps = {\n  isOpen: boolean;\n  subject?: 'peer' | 'messages' | 'media';\n  chatId?: string;\n  photo?: ApiPhoto;\n  messageIds?: number[];\n  onClose: () => void;\n  onCloseAnimationEnd?: () => void;\n};\n\nconst ReportModal: FC<OwnProps> = ({\n  isOpen,\n  subject = 'messages',\n  chatId,\n  photo,\n  messageIds,\n  onClose,\n  onCloseAnimationEnd,\n}) => {\n  const {\n    reportMessages,\n    reportPeer,\n    reportProfilePhoto,\n    exitMessageSelectMode,\n  } = getActions();\n\n  const [selectedReason, setSelectedReason] = useState<ApiReportReason>('spam');\n  const [description, setDescription] = useState('');\n\n  const handleReport = useCallback(() => {\n    switch (subject) {\n      case 'messages':\n        reportMessages({ messageIds, reason: selectedReason, description });\n        exitMessageSelectMode();\n        break;\n      case 'peer':\n        reportPeer({ chatId, reason: selectedReason, description });\n        break;\n      case 'media':\n        reportProfilePhoto({\n          chatId, photo, reason: selectedReason, description,\n        });\n        break;\n    }\n    onClose();\n  }, [\n    description,\n    exitMessageSelectMode,\n    messageIds,\n    photo,\n    onClose,\n    reportMessages,\n    selectedReason,\n    chatId,\n    reportProfilePhoto,\n    reportPeer,\n    subject,\n  ]);\n\n  const handleSelectReason = useCallback((value: string) => {\n    setSelectedReason(value as ApiReportReason);\n  }, []);\n\n  const handleDescriptionChange = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setDescription(e.target.value);\n  }, []);\n\n  const lang = useLang();\n\n  const REPORT_OPTIONS: { value: ApiReportReason; label: string }[] = useMemo(() => [\n    { value: 'spam', label: lang('lng_report_reason_spam') },\n    { value: 'violence', label: lang('lng_report_reason_violence') },\n    { value: 'pornography', label: lang('lng_report_reason_pornography') },\n    { value: 'childAbuse', label: lang('lng_report_reason_child_abuse') },\n    { value: 'copyright', label: lang('ReportPeer.ReasonCopyright') },\n    { value: 'illegalDrugs', label: 'Illegal Drugs' },\n    { value: 'personalDetails', label: 'Personal Details' },\n    { value: 'other', label: lang('lng_report_reason_other') },\n  ], [lang]);\n\n  if (\n    (subject === 'messages' && !messageIds)\n    || (subject === 'peer' && !chatId)\n    || (subject === 'media' && (!chatId || !photo))\n  ) {\n    return undefined;\n  }\n\n  const title = subject === 'messages'\n    ? lang('lng_report_message_title')\n    : lang('ReportPeer.Report');\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      onEnter={isOpen ? handleReport : undefined}\n      onCloseAnimationEnd={onCloseAnimationEnd}\n      className=\"report\"\n      title={title}\n    >\n      <RadioGroup\n        name=\"report-message\"\n        options={REPORT_OPTIONS}\n        onChange={handleSelectReason}\n        selected={selectedReason}\n      />\n      <InputText\n        label={lang('lng_report_reason_description')}\n        value={description}\n        onChange={handleDescriptionChange}\n      />\n      <Button color=\"danger\" className=\"confirm-dialog-button\" isText onClick={handleReport}>\n        {lang('lng_report_button')}\n      </Button>\n      <Button className=\"confirm-dialog-button\" isText onClick={onClose}>{lang('Cancel')}</Button>\n    </Modal>\n  );\n};\n\nexport default memo(ReportModal);\n","import type { MouseEvent as ReactMouseEvent, ReactNode } from 'react';\nimport React, {\n  memo, useCallback, useEffect, useMemo, useRef,\n} from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type { ApiBotInlineMediaResult, ApiSticker } from '../../api/types';\n\nimport buildClassName from '../../util/buildClassName';\nimport { preventMessageInputBlurWithBubbling } from '../middle/helpers/preventMessageInputBlur';\nimport { IS_TOUCH_ENV } from '../../util/environment';\n\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport { useIsIntersecting } from '../../hooks/useIntersectionObserver';\nimport useLang from '../../hooks/useLang';\nimport useContextMenuHandlers from '../../hooks/useContextMenuHandlers';\nimport useContextMenuPosition from '../../hooks/useContextMenuPosition';\n\nimport StickerView from './StickerView';\nimport Button from '../ui/Button';\nimport Menu from '../ui/Menu';\nimport MenuItem from '../ui/MenuItem';\n\nimport './StickerButton.scss';\n\ntype OwnProps<T> = {\n  sticker: ApiSticker;\n  size: number;\n  noAnimate?: boolean;\n  title?: string;\n  className?: string;\n  noContextMenu?: boolean;\n  isSavedMessages?: boolean;\n  canViewSet?: boolean;\n  isCurrentUserPremium?: boolean;\n  sharedCanvasRef?: React.RefObject<HTMLCanvasElement>;\n  observeIntersection: ObserveFn;\n  onClick?: (arg: OwnProps<T>['clickArg'], isSilent?: boolean, shouldSchedule?: boolean) => void;\n  clickArg: T;\n  onFaveClick?: (sticker: ApiSticker) => void;\n  onUnfaveClick?: (sticker: ApiSticker) => void;\n  onRemoveRecentClick?: (sticker: ApiSticker) => void;\n};\n\nconst StickerButton = <T extends number | ApiSticker | ApiBotInlineMediaResult | undefined = undefined>({\n  sticker,\n  size,\n  noAnimate,\n  title,\n  className,\n  noContextMenu,\n  isSavedMessages,\n  canViewSet,\n  observeIntersection,\n  isCurrentUserPremium,\n  sharedCanvasRef,\n  onClick,\n  clickArg,\n  onFaveClick,\n  onUnfaveClick,\n  onRemoveRecentClick,\n}: OwnProps<T>) => {\n  const { openStickerSet, openPremiumModal } = getActions();\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLDivElement>(null);\n  const lang = useLang();\n\n  const {\n    id, isCustomEmoji, hasEffect: isPremium, stickerSetInfo,\n  } = sticker;\n  const isLocked = !isCurrentUserPremium && isPremium;\n\n  const isIntersecting = useIsIntersecting(ref, observeIntersection);\n  const shouldLoad = isIntersecting;\n  const shouldPlay = isIntersecting && !noAnimate;\n\n  const {\n    isContextMenuOpen, contextMenuPosition,\n    handleBeforeContextMenu, handleContextMenu,\n    handleContextMenuClose, handleContextMenuHide,\n  } = useContextMenuHandlers(ref);\n\n  const getTriggerElement = useCallback(() => ref.current, []);\n\n  const getRootElement = useCallback(\n    () => ref.current!.closest('.custom-scroll, .no-scrollbar'),\n    [],\n  );\n\n  const getMenuElement = useCallback(\n    () => ref.current!.querySelector('.sticker-context-menu .bubble'),\n    [],\n  );\n\n  const {\n    positionX, positionY, transformOriginX, transformOriginY, style: menuStyle,\n  } = useContextMenuPosition(\n    contextMenuPosition,\n    getTriggerElement,\n    getRootElement,\n    getMenuElement,\n  );\n\n  useEffect(() => {\n    if (!isIntersecting) handleContextMenuClose();\n  }, [handleContextMenuClose, isIntersecting]);\n\n  const handleClick = () => {\n    if (isContextMenuOpen) return;\n    if (isLocked) {\n      openPremiumModal({ initialSection: 'premium_stickers' });\n      return;\n    }\n    onClick?.(clickArg);\n  };\n\n  const handleMouseDown = (e: React.MouseEvent<HTMLElement>) => {\n    preventMessageInputBlurWithBubbling(e);\n    handleBeforeContextMenu(e);\n  };\n\n  const handleRemoveClick = useCallback((e: ReactMouseEvent<HTMLButtonElement, MouseEvent>) => {\n    e.stopPropagation();\n    e.preventDefault();\n\n    onRemoveRecentClick!(sticker);\n  }, [onRemoveRecentClick, sticker]);\n\n  const handleContextRemoveRecent = useCallback(() => {\n    onRemoveRecentClick!(sticker);\n  }, [onRemoveRecentClick, sticker]);\n\n  const handleContextUnfave = useCallback(() => {\n    onUnfaveClick!(sticker);\n  }, [onUnfaveClick, sticker]);\n\n  const handleContextFave = useCallback(() => {\n    onFaveClick!(sticker);\n  }, [onFaveClick, sticker]);\n\n  const handleSendQuiet = useCallback(() => {\n    onClick?.(clickArg, true);\n  }, [clickArg, onClick]);\n\n  const handleSendScheduled = useCallback(() => {\n    onClick?.(clickArg, undefined, true);\n  }, [clickArg, onClick]);\n\n  const handleOpenSet = useCallback(() => {\n    openStickerSet({ stickerSetInfo });\n  }, [openStickerSet, stickerSetInfo]);\n\n  const shouldShowCloseButton = !IS_TOUCH_ENV && onRemoveRecentClick;\n\n  const fullClassName = buildClassName(\n    'StickerButton',\n    onClick && 'interactive',\n    isCustomEmoji && 'custom-emoji',\n    `sticker-button-${id}`,\n    className,\n  );\n\n  const contextMenuItems = useMemo(() => {\n    if (noContextMenu || isCustomEmoji) return [];\n\n    const items: ReactNode[] = [];\n\n    if (onUnfaveClick) {\n      items.push(\n        <MenuItem icon=\"favorite\" onClick={handleContextUnfave}>\n          {lang('Stickers.RemoveFromFavorites')}\n        </MenuItem>,\n      );\n    }\n\n    if (onFaveClick) {\n      items.push(\n        <MenuItem icon=\"favorite\" onClick={handleContextFave}>\n          {lang('Stickers.AddToFavorites')}\n        </MenuItem>,\n      );\n    }\n\n    if (!isLocked && onClick) {\n      if (!isSavedMessages) {\n        items.push(<MenuItem onClick={handleSendQuiet} icon=\"muted\">{lang('SendWithoutSound')}</MenuItem>);\n      }\n      items.push(\n        <MenuItem onClick={handleSendScheduled} icon=\"calendar\">\n          {lang(isSavedMessages ? 'SetReminder' : 'ScheduleMessage')}\n        </MenuItem>,\n      );\n    }\n\n    if (canViewSet) {\n      items.push(\n        <MenuItem onClick={handleOpenSet} icon=\"stickers\">\n          {lang('ViewPackPreview')}\n        </MenuItem>,\n      );\n    }\n    if (onRemoveRecentClick) {\n      items.push(\n        <MenuItem icon=\"delete\" onClick={handleContextRemoveRecent}>\n          {lang('DeleteFromRecent')}\n        </MenuItem>,\n      );\n    }\n    return items;\n  }, [\n    canViewSet, handleContextFave, handleContextRemoveRecent, handleContextUnfave, handleOpenSet, handleSendQuiet,\n    handleSendScheduled, isLocked, isSavedMessages, lang, onFaveClick, onRemoveRecentClick, onUnfaveClick, onClick,\n    noContextMenu, isCustomEmoji,\n  ]);\n\n  return (\n    <div\n      ref={ref}\n      className={fullClassName}\n      title={title || (sticker?.emoji)}\n      data-sticker-id={id}\n      onMouseDown={handleMouseDown}\n      onClick={handleClick}\n      onContextMenu={handleContextMenu}\n    >\n      <StickerView\n        containerRef={ref}\n        sticker={sticker}\n        isSmall\n        size={size}\n        shouldLoop\n        shouldPreloadPreview\n        noLoad={!shouldLoad}\n        noPlay={!shouldPlay}\n        withSharedAnimation\n        sharedCanvasRef={sharedCanvasRef}\n      />\n      {isLocked && (\n        <div\n          className=\"sticker-locked\"\n        >\n          <i className=\"icon-lock-badge\" />\n        </div>\n      )}\n      {isPremium && !isLocked && (\n        <div className=\"sticker-premium\">\n          <i className=\"icon-premium\" />\n        </div>\n      )}\n      {shouldShowCloseButton && (\n        <Button\n          className=\"sticker-remove-button\"\n          color=\"dark\"\n          round\n          onClick={handleRemoveClick}\n        >\n          <i className=\"icon-close\" />\n        </Button>\n      )}\n      {Boolean(contextMenuItems.length) && contextMenuPosition !== undefined && (\n        <Menu\n          isOpen={isContextMenuOpen}\n          transformOriginX={transformOriginX}\n          transformOriginY={transformOriginY}\n          positionX={positionX}\n          positionY={positionY}\n          style={menuStyle}\n          className=\"sticker-context-menu\"\n          autoClose\n          onClose={handleContextMenuClose}\n          onCloseAnimationEnd={handleContextMenuHide}\n        >\n          {contextMenuItems}\n        </Menu>\n      )}\n    </div>\n  );\n};\n\nexport default memo(StickerButton);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type { ApiUser, ApiTypingStatus } from '../../api/types';\n\nimport { selectUser } from '../../global/selectors';\nimport { getUserFirstOrLastName } from '../../global/helpers';\nimport renderText from './helpers/renderText';\nimport useLang from '../../hooks/useLang';\n\nimport DotAnimation from './DotAnimation';\n\nimport './TypingStatus.scss';\n\ntype OwnProps = {\n  typingStatus: ApiTypingStatus;\n};\n\ntype StateProps = {\n  typingUser?: ApiUser;\n};\n\nconst TypingStatus: FC<OwnProps & StateProps> = ({ typingStatus, typingUser }) => {\n  const lang = useLang();\n  const typingUserName = typingUser && !typingUser.isSelf && getUserFirstOrLastName(typingUser);\n  const content = lang(typingStatus.action)\n    // Fix for translation \"{user} is typing\"\n    .replace('{user}', '')\n    .replace('{emoji}', typingStatus.emoji).trim();\n\n  return (\n    <p className=\"typing-status\" dir={lang.isRtl ? 'rtl' : 'auto'}>\n      {typingUserName && (\n        <span className=\"sender-name\" dir=\"auto\">{renderText(typingUserName)}</span>\n      )}\n      <DotAnimation content={content} />\n    </p>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { typingStatus }): StateProps => {\n    if (!typingStatus.userId) {\n      return {};\n    }\n\n    const typingUser = selectUser(global, typingStatus.userId);\n\n    return { typingUser };\n  },\n)(TypingStatus));\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useCallback } from '../../lib/teact/teact';\n\nimport type { ApiMessage, ApiWebPage } from '../../api/types';\nimport type { TextPart } from '../../types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\n\nimport {\n  getFirstLinkInMessage, getMessageText,\n  getMessageWebPage,\n} from '../../global/helpers';\nimport buildClassName from '../../util/buildClassName';\nimport trimText from '../../util/trimText';\nimport renderText from './helpers/renderText';\nimport { formatPastTimeShort } from '../../util/dateFormat';\nimport useLang from '../../hooks/useLang';\nimport { renderMessageSummary } from './helpers/renderMessageText';\n\nimport Media from './Media';\nimport Link from '../ui/Link';\nimport SafeLink from './SafeLink';\n\nimport './WebLink.scss';\n\nconst MAX_TEXT_LENGTH = 170; // symbols\n\ntype OwnProps = {\n  message: ApiMessage;\n  senderTitle?: string;\n  isProtected?: boolean;\n  observeIntersection?: ObserveFn;\n  onMessageClick: (messageId: number, chatId: string) => void;\n};\n\ntype ApiWebPageWithFormatted =\n  ApiWebPage\n  & { formattedDescription?: TextPart[] };\n\nconst WebLink: FC<OwnProps> = ({\n  message, senderTitle, isProtected, observeIntersection, onMessageClick,\n}) => {\n  const lang = useLang();\n\n  let linkData: ApiWebPageWithFormatted | undefined = getMessageWebPage(message);\n\n  if (!linkData) {\n    const link = getFirstLinkInMessage(message);\n    if (link) {\n      const { url, domain } = link;\n\n      linkData = {\n        siteName: domain.replace(/^www./, ''),\n        url: url.includes('://') ? url : url.includes('@') ? `mailto:${url}` : `http://${url}`,\n        formattedDescription: getMessageText(message) !== url\n          ? renderMessageSummary(lang, message, undefined, undefined, MAX_TEXT_LENGTH)\n          : undefined,\n      } as ApiWebPageWithFormatted;\n    }\n  }\n\n  const handleMessageClick = useCallback(() => {\n    onMessageClick(message.id, message.chatId);\n  }, [onMessageClick, message.id, message.chatId]);\n\n  if (!linkData) {\n    return undefined;\n  }\n\n  const {\n    siteName,\n    url,\n    displayUrl,\n    title,\n    description,\n    formattedDescription,\n    photo,\n    video,\n  } = linkData;\n\n  const truncatedDescription = !senderTitle && description && trimText(description, MAX_TEXT_LENGTH);\n\n  const className = buildClassName(\n    'WebLink scroll-item',\n    (!photo && !video) && 'without-media',\n  );\n\n  return (\n    <div\n      className={className}\n      data-initial={(siteName || displayUrl)[0]}\n      dir={lang.isRtl ? 'rtl' : undefined}\n    >\n      {photo && (\n        <Media message={message} isProtected={isProtected} observeIntersection={observeIntersection} />\n      )}\n      <div className=\"content\">\n        <Link isRtl={lang.isRtl} className=\"site-title\" onClick={handleMessageClick}>\n          {renderText(title || siteName || displayUrl)}\n        </Link>\n        {(truncatedDescription || formattedDescription) && (\n          <Link isRtl={lang.isRtl} className=\"site-description\" onClick={handleMessageClick}>\n            {formattedDescription || (truncatedDescription && renderText(truncatedDescription))}\n          </Link>\n        )}\n        <SafeLink\n          url={url}\n          className=\"site-name\"\n          text=\"\"\n          isRtl={lang.isRtl}\n        >\n          {url.replace('mailto:', '') || displayUrl}\n        </SafeLink>\n        {senderTitle && <div className=\"sender-name\">{renderText(senderTitle)}</div>}\n      </div>\n      {senderTitle && (\n        <div className=\"message-date\">\n          <Link\n            className=\"date\"\n            onClick={handleMessageClick}\n            isRtl={lang.isRtl}\n          >\n            {formatPastTimeShort(lang, message.date * 1000)}\n          </Link>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default memo(WebLink);\n","import type { ApiMessage } from '../../../api/types';\nimport { ApiMessageEntityTypes } from '../../../api/types';\nimport type { TextPart } from '../../../types';\nimport type { LangFn } from '../../../hooks/useLang';\n\nimport {\n  getMessageSummaryDescription,\n  getMessageSummaryEmoji,\n  getMessageSummaryText,\n  getMessageText,\n  TRUNCATED_SUMMARY_LENGTH,\n} from '../../../global/helpers';\nimport renderText from './renderText';\nimport { renderTextWithEntities } from './renderTextWithEntities';\nimport trimText from '../../../util/trimText';\n\nexport function renderMessageText(\n  message: ApiMessage,\n  highlight?: string,\n  emojiSize?: number,\n  isSimple?: boolean,\n  truncateLength?: number,\n  isProtected?: boolean,\n  shouldRenderAsHtml?: boolean,\n) {\n  const { text, entities } = message.content.text || {};\n\n  if (!text) {\n    const contentNotSupportedText = getMessageText(message);\n    return contentNotSupportedText ? [trimText(contentNotSupportedText, truncateLength)] : undefined;\n  }\n\n  return renderTextWithEntities(\n    trimText(text, truncateLength),\n    entities,\n    highlight,\n    emojiSize,\n    shouldRenderAsHtml,\n    message.id,\n    isSimple,\n    isProtected,\n  );\n}\n\n// TODO Use Message Summary component instead\nexport function renderMessageSummary(\n  lang: LangFn,\n  message: ApiMessage,\n  noEmoji = false,\n  highlight?: string,\n  truncateLength = TRUNCATED_SUMMARY_LENGTH,\n): TextPart[] {\n  const { entities } = message.content.text || {};\n\n  const hasSpoilers = entities?.some((e) => e.type === ApiMessageEntityTypes.Spoiler);\n  const hasCustomEmoji = entities?.some((e) => e.type === ApiMessageEntityTypes.CustomEmoji);\n  if (!hasSpoilers && !hasCustomEmoji) {\n    const text = trimText(getMessageSummaryText(lang, message, noEmoji), truncateLength);\n\n    if (highlight) {\n      return renderText(text, ['emoji', 'highlight'], { highlight });\n    } else {\n      return renderText(text);\n    }\n  }\n\n  const emoji = !noEmoji && getMessageSummaryEmoji(message);\n  const emojiWithSpace = emoji ? `${emoji} ` : '';\n\n  const text = renderMessageText(message, highlight, undefined, true, truncateLength);\n  const description = getMessageSummaryDescription(lang, message, text);\n\n  return [\n    ...renderText(emojiWithSpace),\n    ...(Array.isArray(description) ? description : [description]),\n  ].filter(Boolean);\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\nimport { Bundles } from '../../util/moduleLoader';\nimport type { OwnProps } from './ChatFolderModal';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nconst ChatFolderModalAsync: FC<OwnProps> = (props) => {\n  const { isOpen } = props;\n  const ChatFolderModal = useModuleLoader(Bundles.Extra, 'ChatFolderModal', !isOpen);\n\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return ChatFolderModal ? <ChatFolderModal {...props} /> : undefined;\n};\n\nexport default memo(ChatFolderModalAsync);\n","import { useMemo } from '../../../../lib/teact/teact';\n\nexport enum ChatAnimationTypes {\n  Move,\n  Opacity,\n  None,\n}\n\nexport function useChatAnimationType(orderDiffById: Record<string, number>) {\n  return useMemo(() => {\n    const orderDiffs = Object.values(orderDiffById);\n    const numberOfUp = orderDiffs.filter((diff) => diff < 0).length;\n    const numberOfDown = orderDiffs.filter((diff) => diff > 0).length;\n\n    return (chatId: string): ChatAnimationTypes => {\n      const orderDiff = orderDiffById[chatId];\n      if (orderDiff === 0) {\n        return ChatAnimationTypes.None;\n      }\n\n      if (\n        orderDiff === Infinity\n        || orderDiff === -Infinity\n        || (numberOfUp <= numberOfDown && orderDiff < 0)\n        || (numberOfDown < numberOfUp && orderDiff > 0)\n      ) {\n        return ChatAnimationTypes.Opacity;\n      }\n\n      return ChatAnimationTypes.Move;\n    };\n  }, [orderDiffById]);\n}\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\n\nimport type { ApiChat } from '../../../api/types';\n\nimport { formatIntegerCompact } from '../../../util/textFormat';\nimport buildClassName from '../../../util/buildClassName';\n\nimport ShowTransition from '../../ui/ShowTransition';\nimport AnimatedCounter from '../../common/AnimatedCounter';\n\nimport './Badge.scss';\n\ntype OwnProps = {\n  chat: ApiChat;\n  isPinned?: boolean;\n  isMuted?: boolean;\n};\n\nconst Badge: FC<OwnProps> = ({ chat, isPinned, isMuted }) => {\n  const isShown = Boolean(\n    chat.unreadCount || chat.unreadMentionsCount || chat.hasUnreadMark || isPinned || chat.unreadReactionsCount,\n  );\n  const isUnread = Boolean(chat.unreadCount || chat.hasUnreadMark);\n  const className = buildClassName(\n    'Badge',\n    isMuted && 'muted',\n    !isUnread && isPinned && 'pinned',\n    isUnread && 'unread',\n  );\n\n  function renderContent() {\n    const unreadReactionsElement = chat.unreadReactionsCount && (\n      <div className={buildClassName('Badge reaction', isMuted && 'muted')}>\n        <i className=\"icon-heart\" />\n      </div>\n    );\n\n    const unreadMentionsElement = chat.unreadMentionsCount && (\n      <div className=\"Badge mention\">\n        <i className=\"icon-mention\" />\n      </div>\n    );\n\n    const unreadCountElement = (chat.hasUnreadMark || chat.unreadCount) ? (\n      <div className={className}>\n        {!chat.hasUnreadMark && <AnimatedCounter text={formatIntegerCompact(chat.unreadCount!)} />}\n      </div>\n    ) : undefined;\n\n    const pinnedElement = isPinned && !unreadCountElement && !unreadMentionsElement && !unreadReactionsElement && (\n      <div className={className}>\n        <i className=\"icon-pinned-chat\" />\n      </div>\n    );\n\n    const elements = [unreadReactionsElement, unreadMentionsElement, unreadCountElement, pinnedElement].filter(Boolean);\n\n    if (elements.length === 0) return undefined;\n\n    if (elements.length === 1) return elements[0];\n\n    return (\n      <div className=\"Badge-wrapper\">\n        {elements}\n      </div>\n    );\n  }\n\n  return (\n    <ShowTransition isCustom className=\"Badge-transition\" isOpen={isShown}>\n      {renderContent()}\n    </ShowTransition>\n  );\n};\n\nexport default memo(Badge);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\nimport buildClassName from '../../../util/buildClassName';\n\nimport { IS_SINGLE_COLUMN_LAYOUT } from '../../../util/environment';\n\nimport './ChatCallStatus.scss';\n\ntype OwnProps = {\n  isSelected?: boolean;\n  isActive?: boolean;\n};\n\nconst ChatCallStatus: FC<OwnProps> = ({\n  isSelected,\n  isActive,\n}) => {\n  return (\n    <div className={buildClassName(\n      'ChatCallStatus',\n      isActive && 'active',\n      isSelected && !IS_SINGLE_COLUMN_LAYOUT && 'selected',\n    )}\n    >\n      <div className=\"indicator\">\n        <div />\n        <div />\n        <div />\n      </div>\n    </div>\n  );\n};\n\nexport default memo(ChatCallStatus);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useLayoutEffect, useMemo, useRef,\n} from '../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../global';\n\nimport type { LangFn } from '../../../hooks/useLang';\nimport type { ObserveFn } from '../../../hooks/useIntersectionObserver';\nimport type {\n  ApiChat, ApiUser, ApiMessage, ApiMessageOutgoingStatus, ApiFormattedText, ApiUserStatus,\n} from '../../../api/types';\nimport type { AnimationLevel } from '../../../types';\nimport { MAIN_THREAD_ID } from '../../../api/types';\n\nimport { ANIMATION_END_DELAY } from '../../../config';\nimport { IS_SINGLE_COLUMN_LAYOUT } from '../../../util/environment';\nimport {\n  isUserId,\n  isActionMessage,\n  getPrivateChatUserId,\n  getMessageAction,\n  getMessageSenderName,\n  isChatChannel,\n  getMessageMediaHash,\n  getMessageMediaThumbDataUri,\n  getMessageVideo,\n  getMessageSticker,\n  selectIsChatMuted,\n  getMessageRoundVideo,\n} from '../../../global/helpers';\nimport {\n  selectChat, selectUser, selectChatMessage, selectOutgoingStatus, selectDraft, selectCurrentMessageList,\n  selectNotifySettings, selectNotifyExceptions, selectUserStatus, selectIsDefaultEmojiStatusPack,\n} from '../../../global/selectors';\nimport { renderActionMessageText } from '../../common/helpers/renderActionMessageText';\nimport renderText from '../../common/helpers/renderText';\nimport { renderTextWithEntities } from '../../common/helpers/renderTextWithEntities';\nimport { fastRaf } from '../../../util/schedulers';\nimport buildClassName from '../../../util/buildClassName';\n\nimport useEnsureMessage from '../../../hooks/useEnsureMessage';\nimport useChatContextActions from '../../../hooks/useChatContextActions';\nimport useFlag from '../../../hooks/useFlag';\nimport useMedia from '../../../hooks/useMedia';\nimport { ChatAnimationTypes } from './hooks';\nimport useLang from '../../../hooks/useLang';\n\nimport Avatar from '../../common/Avatar';\nimport TypingStatus from '../../common/TypingStatus';\nimport LastMessageMeta from '../../common/LastMessageMeta';\nimport DeleteChatModal from '../../common/DeleteChatModal';\nimport ListItem from '../../ui/ListItem';\nimport Badge from './Badge';\nimport ChatFolderModal from '../ChatFolderModal.async';\nimport ChatCallStatus from './ChatCallStatus';\nimport ReportModal from '../../common/ReportModal';\nimport FullNameTitle from '../../common/FullNameTitle';\nimport MessageSummary from '../../common/MessageSummary';\n\nimport './Chat.scss';\n\ntype OwnProps = {\n  style?: string;\n  chatId: string;\n  folderId?: number;\n  orderDiff: number;\n  animationType: ChatAnimationTypes;\n  isPinned?: boolean;\n  observeIntersection?: ObserveFn;\n  onDragEnter?: (chatId: string) => void;\n};\n\ntype StateProps = {\n  chat?: ApiChat;\n  isMuted?: boolean;\n  user?: ApiUser;\n  userStatus?: ApiUserStatus;\n  isEmojiStatusColored?: boolean;\n  actionTargetUserIds?: string[];\n  actionTargetMessage?: ApiMessage;\n  actionTargetChatId?: string;\n  lastMessageSender?: ApiUser;\n  lastMessageOutgoingStatus?: ApiMessageOutgoingStatus;\n  draft?: ApiFormattedText;\n  animationLevel?: AnimationLevel;\n  isSelected?: boolean;\n  canScrollDown?: boolean;\n  canChangeFolder?: boolean;\n  lastSyncTime?: number;\n};\n\nconst ANIMATION_DURATION = 200;\n\nconst Chat: FC<OwnProps & StateProps> = ({\n  style,\n  chatId,\n  folderId,\n  orderDiff,\n  animationType,\n  isPinned,\n  observeIntersection,\n  chat,\n  isMuted,\n  user,\n  userStatus,\n  isEmojiStatusColored,\n  actionTargetUserIds,\n  lastMessageSender,\n  lastMessageOutgoingStatus,\n  actionTargetMessage,\n  actionTargetChatId,\n  draft,\n  animationLevel,\n  isSelected,\n  canScrollDown,\n  canChangeFolder,\n  lastSyncTime,\n  onDragEnter,\n}) => {\n  const {\n    openChat,\n    focusLastMessage,\n  } = getActions();\n\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLDivElement>(null);\n\n  const [isDeleteModalOpen, openDeleteModal, closeDeleteModal] = useFlag();\n  const [isChatFolderModalOpen, openChatFolderModal, closeChatFolderModal] = useFlag();\n  const [isReportModalOpen, openReportModal, closeReportModal] = useFlag();\n  const [shouldRenderDeleteModal, markRenderDeleteModal, unmarkRenderDeleteModal] = useFlag();\n  const [shouldRenderChatFolderModal, markRenderChatFolderModal, unmarkRenderChatFolderModal] = useFlag();\n  const [shouldRenderReportModal, markRenderReportModal, unmarkRenderReportModal] = useFlag();\n\n  const { lastMessage, typingStatus } = chat || {};\n  const isAction = lastMessage && isActionMessage(lastMessage);\n\n  useEnsureMessage(chatId, isAction ? lastMessage.replyToMessageId : undefined, actionTargetMessage);\n\n  const mediaThumbnail = lastMessage && !getMessageSticker(lastMessage)\n    ? getMessageMediaThumbDataUri(lastMessage)\n    : undefined;\n  const mediaBlobUrl = useMedia(lastMessage ? getMessageMediaHash(lastMessage, 'micro') : undefined);\n  const isRoundVideo = Boolean(lastMessage && getMessageRoundVideo(lastMessage));\n\n  const actionTargetUsers = useMemo(() => {\n    if (!actionTargetUserIds) {\n      return undefined;\n    }\n\n    // No need for expensive global updates on users, so we avoid them\n    const usersById = getGlobal().users.byId;\n    return actionTargetUserIds.map((userId) => usersById[userId]).filter(Boolean);\n  }, [actionTargetUserIds]);\n\n  // Sets animation excess values when `orderDiff` changes and then resets excess values to animate.\n  useLayoutEffect(() => {\n    const element = ref.current;\n\n    if (animationLevel === 0 || !element) {\n      return;\n    }\n\n    // TODO Refactor animation: create `useListAnimation` that owns `orderDiff` and `animationType`\n    if (animationType === ChatAnimationTypes.Opacity) {\n      element.style.opacity = '0';\n\n      fastRaf(() => {\n        element.classList.add('animate-opacity');\n        element.style.opacity = '1';\n      });\n    } else if (animationType === ChatAnimationTypes.Move) {\n      element.style.transform = `translate3d(0, ${-orderDiff * 100}%, 0)`;\n\n      fastRaf(() => {\n        element.classList.add('animate-transform');\n        element.style.transform = '';\n      });\n    } else {\n      return;\n    }\n\n    setTimeout(() => {\n      fastRaf(() => {\n        element.classList.remove('animate-opacity', 'animate-transform');\n        element.style.opacity = '';\n        element.style.transform = '';\n      });\n    }, ANIMATION_DURATION + ANIMATION_END_DELAY);\n  }, [animationLevel, orderDiff, animationType]);\n\n  const handleClick = useCallback(() => {\n    openChat({ id: chatId, shouldReplaceHistory: true }, { forceOnHeavyAnimation: true });\n\n    if (isSelected && canScrollDown) {\n      focusLastMessage();\n    }\n  }, [\n    isSelected,\n    canScrollDown,\n    openChat,\n    chatId,\n    focusLastMessage,\n  ]);\n\n  const handleDragEnter = useCallback((e) => {\n    e.preventDefault();\n    onDragEnter?.(chatId);\n  }, [chatId, onDragEnter]);\n\n  const handleDelete = useCallback(() => {\n    markRenderDeleteModal();\n    openDeleteModal();\n  }, [markRenderDeleteModal, openDeleteModal]);\n\n  const handleChatFolderChange = useCallback(() => {\n    markRenderChatFolderModal();\n    openChatFolderModal();\n  }, [markRenderChatFolderModal, openChatFolderModal]);\n\n  const handleReport = useCallback(() => {\n    markRenderReportModal();\n    openReportModal();\n  }, [markRenderReportModal, openReportModal]);\n\n  const contextActions = useChatContextActions({\n    chat,\n    user,\n    handleDelete,\n    handleChatFolderChange,\n    handleReport,\n    folderId,\n    isPinned,\n    isMuted,\n    canChangeFolder,\n  });\n\n  const lang = useLang();\n\n  if (!chat) {\n    return undefined;\n  }\n\n  function renderLastMessageOrTyping() {\n    if (typingStatus && lastMessage && typingStatus.timestamp > lastMessage.date * 1000) {\n      return <TypingStatus typingStatus={typingStatus} />;\n    }\n\n    if (draft?.text.length) {\n      return (\n        <p className=\"last-message\" dir={lang.isRtl ? 'auto' : 'ltr'}>\n          <span className=\"draft\">{lang('Draft')}</span>\n          {renderTextWithEntities(draft.text, draft.entities, undefined, undefined, undefined, undefined, true)}\n        </p>\n      );\n    }\n\n    if (!lastMessage) {\n      return undefined;\n    }\n\n    if (isAction) {\n      const isChat = chat && (isChatChannel(chat) || lastMessage.senderId === lastMessage.chatId);\n\n      return (\n        <p className=\"last-message shared-canvas-container\" dir={lang.isRtl ? 'auto' : 'ltr'}>\n          {renderActionMessageText(\n            lang,\n            lastMessage,\n            !isChat ? lastMessageSender : undefined,\n            isChat ? chat : undefined,\n            actionTargetUsers,\n            actionTargetMessage,\n            actionTargetChatId,\n            { isEmbedded: true },\n          )}\n        </p>\n      );\n    }\n\n    const senderName = getMessageSenderName(lang, chatId, lastMessageSender);\n\n    return (\n      <p className=\"last-message shared-canvas-container\" dir={lang.isRtl ? 'auto' : 'ltr'}>\n        {senderName && (\n          <>\n            <span className=\"sender-name\">{renderText(senderName)}</span>\n            <span className=\"colon\">:</span>\n          </>\n        )}\n        {renderSummary(lang, lastMessage, observeIntersection, mediaBlobUrl || mediaThumbnail, isRoundVideo)}\n      </p>\n    );\n  }\n\n  const className = buildClassName(\n    'Chat chat-item-clickable',\n    isUserId(chatId) ? 'private' : 'group',\n    isSelected && 'selected',\n  );\n\n  return (\n    <ListItem\n      ref={ref}\n      className={className}\n      style={style}\n      ripple={!IS_SINGLE_COLUMN_LAYOUT}\n      contextActions={contextActions}\n      onClick={handleClick}\n      onDragEnter={handleDragEnter}\n    >\n      <div className=\"status\">\n        <Avatar\n          chat={chat}\n          user={user}\n          userStatus={userStatus}\n          isSavedMessages={user?.isSelf}\n          lastSyncTime={lastSyncTime}\n          animationLevel={animationLevel}\n          withVideo\n          observeIntersection={observeIntersection}\n        />\n        {chat.isCallActive && chat.isCallNotEmpty && (\n          <ChatCallStatus isSelected={isSelected} isActive={animationLevel !== 0} />\n        )}\n      </div>\n      <div className=\"info\">\n        <div className=\"info-row\">\n          <FullNameTitle\n            peer={user || chat}\n            withEmojiStatus\n            isSavedMessages={chatId === user?.id && user?.isSelf}\n            observeIntersection={observeIntersection}\n            key={!IS_SINGLE_COLUMN_LAYOUT && isEmojiStatusColored ? `${isSelected}` : undefined}\n          />\n          {isMuted && <i className=\"icon-muted\" />}\n          <div className=\"separator\" />\n          {chat.lastMessage && (\n            <LastMessageMeta\n              message={chat.lastMessage}\n              outgoingStatus={lastMessageOutgoingStatus}\n            />\n          )}\n        </div>\n        <div className=\"subtitle\">\n          {renderLastMessageOrTyping()}\n          <Badge chat={chat} isPinned={isPinned} isMuted={isMuted} />\n        </div>\n      </div>\n      {shouldRenderDeleteModal && (\n        <DeleteChatModal\n          isOpen={isDeleteModalOpen}\n          onClose={closeDeleteModal}\n          onCloseAnimationEnd={unmarkRenderDeleteModal}\n          chat={chat}\n        />\n      )}\n      {shouldRenderChatFolderModal && (\n        <ChatFolderModal\n          isOpen={isChatFolderModalOpen}\n          onClose={closeChatFolderModal}\n          onCloseAnimationEnd={unmarkRenderChatFolderModal}\n          chatId={chatId}\n        />\n      )}\n      {shouldRenderReportModal && (\n        <ReportModal\n          isOpen={isReportModalOpen}\n          onClose={closeReportModal}\n          onCloseAnimationEnd={unmarkRenderReportModal}\n          chatId={chatId}\n          subject=\"peer\"\n        />\n      )}\n    </ListItem>\n  );\n};\n\nfunction renderSummary(\n  lang: LangFn, message: ApiMessage, observeIntersection?: ObserveFn, blobUrl?: string, isRoundVideo?: boolean,\n) {\n  const messageSummary = (\n    <MessageSummary\n      lang={lang}\n      message={message}\n      noEmoji={Boolean(blobUrl)}\n      observeIntersectionForLoading={observeIntersection}\n    />\n  );\n\n  if (!blobUrl) {\n    return messageSummary;\n  }\n\n  return (\n    <span className=\"media-preview\">\n      <img src={blobUrl} alt=\"\" className={buildClassName('media-preview--image', isRoundVideo && 'round')} />\n      {getMessageVideo(message) && <i className=\"icon-play\" />}\n      {messageSummary}\n    </span>\n  );\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { chatId }): StateProps => {\n    const chat = selectChat(global, chatId);\n    if (!chat) {\n      return {};\n    }\n\n    const { senderId, replyToMessageId, isOutgoing } = chat.lastMessage || {};\n    const lastMessageSender = senderId ? selectUser(global, senderId) : undefined;\n    const lastMessageAction = chat.lastMessage ? getMessageAction(chat.lastMessage) : undefined;\n    const actionTargetMessage = lastMessageAction && replyToMessageId\n      ? selectChatMessage(global, chat.id, replyToMessageId)\n      : undefined;\n    const { targetUserIds: actionTargetUserIds, targetChatId: actionTargetChatId } = lastMessageAction || {};\n    const privateChatUserId = getPrivateChatUserId(chat);\n    const {\n      chatId: currentChatId,\n      threadId: currentThreadId,\n      type: messageListType,\n    } = selectCurrentMessageList(global) || {};\n    const isSelected = chatId === currentChatId && currentThreadId === MAIN_THREAD_ID;\n\n    const user = privateChatUserId ? selectUser(global, privateChatUserId) : undefined;\n    const userStatus = privateChatUserId ? selectUserStatus(global, privateChatUserId) : undefined;\n    const statusEmoji = user?.emojiStatus && global.customEmojis.byId[user.emojiStatus.documentId];\n    const isEmojiStatusColored = statusEmoji && selectIsDefaultEmojiStatusPack(global, statusEmoji.stickerSetInfo);\n\n    return {\n      chat,\n      isMuted: selectIsChatMuted(chat, selectNotifySettings(global), selectNotifyExceptions(global)),\n      lastMessageSender,\n      actionTargetUserIds,\n      actionTargetChatId,\n      actionTargetMessage,\n      draft: selectDraft(global, chatId, MAIN_THREAD_ID),\n      animationLevel: global.settings.byKey.animationLevel,\n      isSelected,\n      canScrollDown: isSelected && messageListType === 'thread',\n      canChangeFolder: (global.chatFolders.orderedIds?.length || 0) > 1,\n      lastSyncTime: global.lastSyncTime,\n      ...(isOutgoing && chat.lastMessage && {\n        lastMessageOutgoingStatus: selectOutgoingStatus(global, chat.lastMessage),\n      }),\n      user,\n      userStatus,\n      isEmojiStatusColored,\n    };\n  },\n)(Chat));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo, useCallback } from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type { ApiChatFolder, ApiSticker } from '../../../api/types';\nimport { SettingsScreens } from '../../../types';\nimport type { FolderEditDispatch } from '../../../hooks/reducers/useFoldersReducer';\n\nimport { IS_SINGLE_COLUMN_LAYOUT } from '../../../util/environment';\nimport { selectAnimatedEmoji, selectChatFolder } from '../../../global/selectors';\nimport useLang from '../../../hooks/useLang';\n\nimport Button from '../../ui/Button';\nimport AnimatedIconFromSticker from '../../common/AnimatedIconFromSticker';\n\nimport './EmptyFolder.scss';\n\ntype OwnProps = {\n  folderId?: number;\n  folderType: 'all' | 'archived' | 'folder';\n  foldersDispatch?: FolderEditDispatch;\n  onScreenSelect?: (screen: SettingsScreens) => void;\n};\n\ntype StateProps = {\n  chatFolder?: ApiChatFolder;\n  animatedEmoji?: ApiSticker;\n};\n\nconst ICON_SIZE = 128;\n\nconst EmptyFolder: FC<OwnProps & StateProps> = ({\n  chatFolder, animatedEmoji, foldersDispatch, onScreenSelect,\n}) => {\n  const lang = useLang();\n\n  const handleEditFolder = useCallback(() => {\n    foldersDispatch!({ type: 'editFolder', payload: chatFolder });\n    onScreenSelect!(SettingsScreens.FoldersEditFolderFromChatList);\n  }, [chatFolder, foldersDispatch, onScreenSelect]);\n\n  return (\n    <div className=\"EmptyFolder\">\n      <div className=\"sticker\">\n        {animatedEmoji && <AnimatedIconFromSticker sticker={animatedEmoji} size={ICON_SIZE} />}\n      </div>\n      <h3 className=\"title\" dir=\"auto\">{lang('FilterNoChatsToDisplay')}</h3>\n      <p className=\"description\" dir=\"auto\">\n        {lang(chatFolder ? 'ChatList.EmptyChatListFilterText' : 'Chat.EmptyChat')}\n      </p>\n      {chatFolder && foldersDispatch && onScreenSelect && (\n        <Button\n          ripple={!IS_SINGLE_COLUMN_LAYOUT}\n          fluid\n          pill\n          onClick={handleEditFolder}\n          size=\"smaller\"\n          isRtl={lang.isRtl}\n        >\n          <i className=\"icon-settings\" />\n          {lang('ChatList.EmptyChatListEditFilter')}\n        </Button>\n      )}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global, { folderId, folderType }): StateProps => {\n  const chatFolder = folderId && folderType === 'folder' ? selectChatFolder(global, folderId) : undefined;\n\n  return {\n    chatFolder,\n    animatedEmoji: selectAnimatedEmoji(global, ''),\n  };\n})(EmptyFolder));\n","import React, {\n  memo, useMemo, useEffect, useRef, useCallback,\n} from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport type { FC } from '../../../lib/teact/teact';\nimport type { SettingsScreens } from '../../../types';\nimport type { FolderEditDispatch } from '../../../hooks/reducers/useFoldersReducer';\n\nimport {\n  ALL_FOLDER_ID,\n  ARCHIVED_FOLDER_ID,\n  CHAT_HEIGHT_PX,\n  CHAT_LIST_SLICE,\n} from '../../../config';\nimport { IS_MAC_OS, IS_PWA } from '../../../util/environment';\nimport { mapValues } from '../../../util/iteratees';\nimport { getPinnedChatsCount, getOrderKey } from '../../../util/folderManager';\n\nimport usePrevious from '../../../hooks/usePrevious';\nimport useInfiniteScroll from '../../../hooks/useInfiniteScroll';\nimport { useFolderManagerForOrderedIds } from '../../../hooks/useFolderManager';\nimport { useChatAnimationType } from './hooks';\nimport { useIntersectionObserver } from '../../../hooks/useIntersectionObserver';\nimport { useHotkeys } from '../../../hooks/useHotkeys';\nimport useDebouncedCallback from '../../../hooks/useDebouncedCallback';\n\nimport InfiniteScroll from '../../ui/InfiniteScroll';\nimport Loading from '../../ui/Loading';\nimport Chat from './Chat';\nimport EmptyFolder from './EmptyFolder';\n\ntype OwnProps = {\n  folderType: 'all' | 'archived' | 'folder';\n  folderId?: number;\n  isActive: boolean;\n  lastSyncTime?: number;\n  foldersDispatch?: FolderEditDispatch;\n  onScreenSelect?: (screen: SettingsScreens) => void;\n};\n\nconst INTERSECTION_THROTTLE = 200;\nconst DRAG_ENTER_DEBOUNCE = 500;\n\nconst ChatList: FC<OwnProps> = ({\n  folderType,\n  folderId,\n  isActive,\n  foldersDispatch,\n  onScreenSelect,\n}) => {\n  const { openChat, openNextChat } = getActions();\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n  const shouldIgnoreDragRef = useRef(false);\n\n  const resolvedFolderId = (\n    folderType === 'all' ? ALL_FOLDER_ID : folderType === 'archived' ? ARCHIVED_FOLDER_ID : folderId!\n  );\n\n  const orderedIds = useFolderManagerForOrderedIds(resolvedFolderId);\n\n  const orderById = useMemo(() => {\n    if (!orderedIds) {\n      return undefined;\n    }\n\n    return orderedIds.reduce((acc, id, i) => {\n      acc[id] = i;\n      return acc;\n    }, {} as Record<string, number>);\n  }, [orderedIds]);\n\n  const prevOrderById = usePrevious(orderById);\n\n  const orderDiffById = useMemo(() => {\n    if (!orderById || !prevOrderById) {\n      return {};\n    }\n\n    return mapValues(orderById, (order, id) => {\n      return prevOrderById[id] !== undefined ? order - prevOrderById[id] : -Infinity;\n    });\n  }, [orderById, prevOrderById]);\n\n  const [viewportIds, getMore] = useInfiniteScroll(undefined, orderedIds, undefined, CHAT_LIST_SLICE);\n\n  // Support <Alt>+<Up/Down> to navigate between chats\n  useHotkeys(isActive && orderedIds?.length ? {\n    'Alt+ArrowUp': (e: KeyboardEvent) => {\n      e.preventDefault();\n      openNextChat({ targetIndexDelta: -1, orderedIds });\n    },\n    'Alt+ArrowDown': (e: KeyboardEvent) => {\n      e.preventDefault();\n      openNextChat({ targetIndexDelta: 1, orderedIds });\n    },\n  } : undefined);\n\n  // Support <Cmd>+<Digit> to navigate between chats\n  useEffect(() => {\n    if (!isActive || !orderedIds || !IS_PWA) {\n      return undefined;\n    }\n\n    function handleKeyDown(e: KeyboardEvent) {\n      if (((IS_MAC_OS && e.metaKey) || (!IS_MAC_OS && e.ctrlKey)) && e.code.startsWith('Digit')) {\n        const [, digit] = e.code.match(/Digit(\\d)/) || [];\n        if (!digit) return;\n\n        const position = Number(digit) - 1;\n        if (position > orderedIds!.length - 1 || position < 0) return;\n\n        openChat({ id: orderedIds![position], shouldReplaceHistory: true });\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isActive, openChat, openNextChat, orderedIds]);\n\n  const getAnimationType = useChatAnimationType(orderDiffById);\n\n  const { observe } = useIntersectionObserver({\n    rootRef: containerRef,\n    throttleMs: INTERSECTION_THROTTLE,\n  });\n\n  const handleDragEnter = useDebouncedCallback((chatId: string) => {\n    if (shouldIgnoreDragRef.current) {\n      shouldIgnoreDragRef.current = false;\n      return;\n    }\n    openChat({ id: chatId, shouldReplaceHistory: true });\n  }, [], DRAG_ENTER_DEBOUNCE, true);\n\n  const handleDragLeave = useCallback((e: React.DragEvent<HTMLDivElement>) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    if (x < rect.width || y < rect.y) return;\n    shouldIgnoreDragRef.current = true;\n  }, []);\n\n  function renderChats() {\n    const viewportOffset = orderedIds!.indexOf(viewportIds![0]);\n    const pinnedCount = getPinnedChatsCount(resolvedFolderId) || 0;\n\n    return viewportIds!.map((id, i) => {\n      const isPinned = viewportOffset + i < pinnedCount;\n\n      return (\n        <Chat\n          key={id}\n          teactOrderKey={isPinned ? i : getOrderKey(id)}\n          chatId={id}\n          isPinned={isPinned}\n          folderId={folderId}\n          animationType={getAnimationType(id)}\n          orderDiff={orderDiffById[id]}\n          style={`top: ${(viewportOffset + i) * CHAT_HEIGHT_PX}px;`}\n          observeIntersection={observe}\n          onDragEnter={handleDragEnter}\n        />\n      );\n    });\n  }\n\n  return (\n    <InfiniteScroll\n      className=\"chat-list custom-scroll\"\n      ref={containerRef}\n      items={viewportIds}\n      preloadBackwards={CHAT_LIST_SLICE}\n      withAbsolutePositioning\n      maxHeight={(orderedIds?.length || 0) * CHAT_HEIGHT_PX}\n      onLoadMore={getMore}\n      onDragLeave={handleDragLeave}\n    >\n      {viewportIds?.length ? (\n        renderChats()\n      ) : viewportIds && !viewportIds.length ? (\n        (\n          <EmptyFolder\n            folderId={folderId}\n            folderType={folderType}\n            foldersDispatch={foldersDispatch}\n            onScreenSelect={onScreenSelect}\n          />\n        )\n      ) : (\n        <Loading key=\"loading\" />\n      )}\n    </InfiniteScroll>\n  );\n};\n\nexport default memo(ChatList);\n","import type { ApiChat, ApiMessage, ApiUser } from '../../../../api/types';\nimport {\n  getChatTitle,\n  getSenderTitle,\n  isUserId,\n  isChatGroup,\n} from '../../../../global/helpers';\nimport type { LangFn } from '../../../../hooks/useLang';\n\nexport function getSenderName(\n  lang: LangFn, message: ApiMessage, chatsById: Record<string, ApiChat>, usersById: Record<string, ApiUser>,\n) {\n  const { senderId } = message;\n  if (!senderId) {\n    return undefined;\n  }\n\n  const sender = isUserId(senderId) ? usersById[senderId] : chatsById[senderId];\n\n  let senderName = getSenderTitle(lang, sender);\n\n  const chat = chatsById[message.chatId];\n  if (chat) {\n    if (isUserId(senderId) && (sender as ApiUser).isSelf) {\n      senderName = `${lang('FromYou')}  ${getChatTitle(lang, chat)}`;\n    } else if (isChatGroup(chat)) {\n      senderName += `  ${getChatTitle(lang, chat)}`;\n    }\n  }\n\n  return senderName;\n}\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\nimport type { OwnProps } from './CustomEmojiTooltip';\nimport { Bundles } from '../../../util/moduleLoader';\n\nimport useModuleLoader from '../../../hooks/useModuleLoader';\n\nconst CustomEmojiTooltipAsync: FC<OwnProps> = (props) => {\n  const { isOpen } = props;\n  const CustomEmojiTooltip = useModuleLoader(Bundles.Extra, 'CustomEmojiTooltip', !isOpen);\n\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return CustomEmojiTooltip ? <CustomEmojiTooltip {...props} /> : undefined;\n};\n\nexport default memo(CustomEmojiTooltipAsync);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\nimport type { OwnProps } from './CustomSendMenu';\nimport { Bundles } from '../../../util/moduleLoader';\n\nimport useModuleLoader from '../../../hooks/useModuleLoader';\n\nconst CustomSendMenuAsync: FC<OwnProps> = (props) => {\n  const { isOpen } = props;\n  const CustomSend = useModuleLoader(Bundles.Extra, 'CustomSendMenu', !isOpen);\n\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return CustomSend ? <CustomSend {...props} /> : undefined;\n};\n\nexport default memo(CustomSendMenuAsync);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\n\nimport useFlag from '../../../hooks/useFlag';\nimport buildClassName from '../../../util/buildClassName';\n\nimport './DropTarget.scss';\n\nexport type OwnProps = {\n  isQuick?: boolean;\n  onFileSelect: (e: React.DragEvent<HTMLDivElement>) => void;\n};\n\nconst DropTarget: FC<OwnProps> = ({ isQuick, onFileSelect }) => {\n  const [isHovered, markHovered, unmarkHovered] = useFlag();\n\n  const handleDragLeave = (e: React.DragEvent<HTMLDivElement>) => {\n    const { relatedTarget: toTarget } = e;\n\n    if (toTarget) {\n      e.stopPropagation();\n    }\n\n    unmarkHovered();\n  };\n\n  const className = buildClassName(\n    'DropTarget',\n    isHovered && 'hovered',\n  );\n\n  return (\n    <div\n      className={className}\n      onDrop={onFileSelect}\n      onDragEnter={markHovered}\n      onDragLeave={handleDragLeave}\n      data-dropzone\n    >\n      <div className=\"target-content\">\n        <div className={`icon icon-${isQuick ? 'photo' : 'document'}`} />\n        <div className=\"title\">Drop files here to send them</div>\n        <div className=\"description\">{isQuick ? 'in a quick way' : 'without compression'}</div>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(DropTarget);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useRef,\n} from '../../../lib/teact/teact';\n\nimport useShowTransition from '../../../hooks/useShowTransition';\nimport buildClassName from '../../../util/buildClassName';\nimport getFilesFromDataTransferItems from './helpers/getFilesFromDataTransferItems';\n\nimport captureEscKeyListener from '../../../util/captureEscKeyListener';\nimport usePrevious from '../../../hooks/usePrevious';\n\nimport Portal from '../../ui/Portal';\nimport DropTarget from './DropTarget';\n\nimport './DropArea.scss';\n\nexport type OwnProps = {\n  isOpen: boolean;\n  withQuick?: boolean;\n  onHide: NoneToVoidFunction;\n  onFileSelect: (files: File[], isQuick: boolean) => void;\n};\n\nexport enum DropAreaState {\n  None = 'none',\n  Document = 'document',\n  QuickFile = 'quick_file',\n}\n\nconst DROP_LEAVE_TIMEOUT_MS = 150;\n\nconst DropArea: FC<OwnProps> = ({\n  isOpen, withQuick, onHide, onFileSelect,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const hideTimeoutRef = useRef<number>(null);\n  const prevWithQuick = usePrevious(withQuick);\n  const { shouldRender, transitionClassNames } = useShowTransition(isOpen);\n\n  useEffect(() => (isOpen ? captureEscKeyListener(onHide) : undefined), [isOpen, onHide]);\n\n  const handleFilesDrop = useCallback(async (e: React.DragEvent<HTMLDivElement>) => {\n    const { dataTransfer: dt } = e;\n    let files: File[] = [];\n\n    if (dt.files && dt.files.length > 0 && (!dt.items || !dt.items.length)) {\n      files = files.concat(Array.from(dt.files));\n    } else if (dt.items && dt.items.length > 0) {\n      const folderFiles = await getFilesFromDataTransferItems(dt.items);\n      if (folderFiles.length) {\n        files = files.concat(folderFiles);\n      }\n    }\n\n    onHide();\n    onFileSelect(files, false);\n  }, [onFileSelect, onHide]);\n\n  const handleQuickFilesDrop = useCallback((e: React.DragEvent<HTMLDivElement>) => {\n    const { dataTransfer: dt } = e;\n\n    if (dt.files && dt.files.length > 0) {\n      onHide();\n      onFileSelect(Array.from(dt.files), true);\n    }\n  }, [onFileSelect, onHide]);\n\n  const handleDragLeave = useCallback((e: React.DragEvent<HTMLDivElement>) => {\n    e.stopPropagation();\n\n    const { target: fromTarget, relatedTarget: toTarget } = e;\n\n    // Esc button pressed during drag event\n    if ((fromTarget as HTMLDivElement).matches('.DropTarget, .DropArea') && !toTarget) {\n      hideTimeoutRef.current = window.setTimeout(() => {\n        onHide();\n      }, DROP_LEAVE_TIMEOUT_MS);\n    }\n  }, [onHide]);\n\n  const handleDragOver = () => {\n    if (hideTimeoutRef.current) {\n      window.clearTimeout(hideTimeoutRef.current);\n    }\n  };\n\n  if (!shouldRender) {\n    return undefined;\n  }\n\n  const className = buildClassName(\n    'DropArea',\n    transitionClassNames,\n  );\n\n  return (\n    <Portal containerId=\"#middle-column-portals\">\n      <div\n        className={className}\n        onDragLeave={handleDragLeave}\n        onDragOver={handleDragOver}\n        onDrop={onHide}\n        onClick={onHide}\n      >\n        <DropTarget onFileSelect={handleFilesDrop} />\n        {(withQuick || prevWithQuick) && <DropTarget onFileSelect={handleQuickFilesDrop} isQuick />}\n      </div>\n    </Portal>\n  );\n};\n\nexport default memo(DropArea);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\nimport type { OwnProps } from './EmojiTooltip';\nimport { Bundles } from '../../../util/moduleLoader';\n\nimport useModuleLoader from '../../../hooks/useModuleLoader';\n\nconst EmojiTooltipAsync: FC<OwnProps> = (props) => {\n  const { isOpen } = props;\n  const EmojiTooltip = useModuleLoader(Bundles.Extra, 'EmojiTooltip', !isOpen);\n\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return EmojiTooltip ? <EmojiTooltip {...props} /> : undefined;\n};\n\nexport default memo(EmojiTooltipAsync);\n","import safePlay from './safePlay';\n\ntype AbsoluteVideoOptions = {\n  position: { x: number; y: number };\n  noLoop?: boolean;\n  size: number;\n};\n\nexport default class AbsoluteVideo {\n  private video?: HTMLVideoElement;\n\n  private isPlaying = false;\n\n  constructor(\n    videoUrl: string,\n    private container: HTMLElement,\n    private options: AbsoluteVideoOptions,\n  ) {\n    this.video = document.createElement('video');\n    this.video.src = videoUrl;\n    this.video.disablePictureInPicture = true;\n    this.video.muted = true;\n    this.video.style.position = 'absolute';\n    this.video.load();\n\n    if (!this.options.noLoop) {\n      this.video.loop = true;\n    }\n\n    this.container.appendChild(this.video);\n    this.recalculatePositionAndSize();\n  }\n\n  public play() {\n    if (this.isPlaying || !this.video) return;\n    this.recalculatePositionAndSize();\n    if (this.video.paused) {\n      safePlay(this.video);\n    }\n    this.isPlaying = true;\n  }\n\n  public pause() {\n    if (!this.isPlaying || !this.video) return;\n    if (!this.video.paused) {\n      this.video.pause();\n    }\n    this.isPlaying = false;\n  }\n\n  public destroy() {\n    this.pause();\n    this.video?.remove();\n    this.video = undefined;\n  }\n\n  public updatePosition(position: AbsoluteVideoOptions['position']) {\n    this.options.position = position;\n    this.recalculatePositionAndSize();\n  }\n\n  private recalculatePositionAndSize() {\n    if (!this.video) return;\n    const { size, position: { x, y } } = this.options;\n    const { width, height } = this.container.getBoundingClientRect();\n    this.video.style.left = `${Math.round(x * width)}px`;\n    this.video.style.top = `${Math.round(y * height)}px`;\n    this.video.style.width = `${size}px`;\n    this.video.style.height = `${size}px`;\n  }\n}\n","import {\n  useCallback, useEffect, useRef,\n} from '../../../../lib/teact/teact';\nimport RLottie from '../../../../lib/rlottie/RLottie';\n\nimport type { ApiSticker } from '../../../../api/types';\n\nimport { getGlobal } from '../../../../global';\nimport { selectIsAlwaysHighPriorityEmoji } from '../../../../global/selectors';\nimport generateIdFor from '../../../../util/generateIdFor';\nimport {\n  addCustomEmojiInputRenderCallback,\n  getCustomEmojiMediaDataForInput,\n  removeCustomEmojiInputRenderCallback,\n} from '../../../../util/customEmojiManager';\nimport { round } from '../../../../util/math';\nimport { fastRaf } from '../../../../util/schedulers';\nimport AbsoluteVideo from '../../../../util/AbsoluteVideo';\n\nimport { useResizeObserver } from '../../../../hooks/useResizeObserver';\nimport useBackgroundMode from '../../../../hooks/useBackgroundMode';\n\nconst ID_STORE = {};\nconst SIZE = 20;\n\ntype Player = {\n  play: () => void;\n  pause: () => void;\n  destroy: () => void;\n  updatePosition: (x: number, y: number) => void;\n};\n\nexport default function useInputCustomEmojis(\n  html: string,\n  inputRef: React.RefObject<HTMLDivElement>,\n  sharedCanvasRef: React.RefObject<HTMLCanvasElement>,\n  sharedCanvasHqRef: React.RefObject<HTMLCanvasElement>,\n  absoluteContainerRef: React.RefObject<HTMLElement>,\n) {\n  const mapRef = useRef<Map<string, Player>>(new Map());\n\n  const removeContainers = useCallback((ids: string[]) => {\n    ids.forEach((id) => {\n      const player = mapRef.current.get(id);\n      if (player) {\n        player.destroy();\n        mapRef.current.delete(id);\n      }\n    });\n  }, []);\n\n  const synchronizeElements = useCallback(() => {\n    if (!inputRef.current || !sharedCanvasRef.current || !sharedCanvasHqRef.current) return;\n    const global = getGlobal();\n    const removedContainers = new Set(mapRef.current.keys());\n    const customEmojies = Array.from(inputRef.current.querySelectorAll<HTMLElement>('.custom-emoji'));\n\n    customEmojies.forEach((element) => {\n      const id = element.dataset.uniqueId!;\n      const documentId = element.dataset.documentId!;\n      if (!id) {\n        return;\n      }\n      removedContainers.delete(id);\n\n      const mediaUrl = getCustomEmojiMediaDataForInput(documentId);\n      if (!mediaUrl) {\n        return;\n      }\n\n      const canvasBounds = sharedCanvasRef.current!.getBoundingClientRect();\n      const elementBounds = element.getBoundingClientRect();\n      const x = round((elementBounds.left - canvasBounds.left) / canvasBounds.width, 4);\n      const y = round((elementBounds.top - canvasBounds.top) / canvasBounds.height, 4);\n\n      if (mapRef.current.has(id)) {\n        const player = mapRef.current.get(id)!;\n        player.updatePosition(x, y);\n        return;\n      }\n\n      const customEmoji = global.customEmojis.byId[documentId];\n      if (!customEmoji) {\n        return;\n      }\n      const isHq = customEmoji?.stickerSetInfo && selectIsAlwaysHighPriorityEmoji(global, customEmoji.stickerSetInfo);\n\n      const animation = createPlayer({\n        customEmoji,\n        sharedCanvasRef,\n        sharedCanvasHqRef,\n        absoluteContainerRef,\n        uniqueId: id,\n        mediaUrl,\n        isHq,\n        position: { x, y },\n      });\n      animation.play();\n\n      mapRef.current.set(id, animation);\n    });\n\n    removeContainers(Array.from(removedContainers));\n  }, [absoluteContainerRef, inputRef, removeContainers, sharedCanvasHqRef, sharedCanvasRef]);\n\n  useEffect(() => {\n    addCustomEmojiInputRenderCallback(synchronizeElements);\n\n    return () => {\n      removeCustomEmojiInputRenderCallback(synchronizeElements);\n    };\n  }, [synchronizeElements]);\n\n  useEffect(() => {\n    if (!html || !inputRef.current || !sharedCanvasRef.current) {\n      removeContainers(Array.from(mapRef.current.keys()));\n      return;\n    }\n\n    synchronizeElements();\n  }, [html, inputRef, removeContainers, sharedCanvasRef, synchronizeElements]);\n\n  useResizeObserver(sharedCanvasRef, synchronizeElements, true);\n\n  const freezeAnimation = useCallback(() => {\n    mapRef.current.forEach((player) => {\n      player.pause();\n    });\n  }, []);\n\n  const unfreezeAnimation = useCallback(() => {\n    mapRef.current.forEach((player) => {\n      player.play();\n    });\n  }, []);\n\n  const unfreezeAnimationOnRaf = useCallback(() => {\n    fastRaf(unfreezeAnimation);\n  }, [unfreezeAnimation]);\n\n  // Pausing frame may not happen in background,\n  // so we need to make sure it happens right after focusing,\n  // then we can play again.\n  useBackgroundMode(freezeAnimation, unfreezeAnimationOnRaf);\n}\n\nfunction createPlayer({\n  customEmoji,\n  sharedCanvasRef,\n  sharedCanvasHqRef,\n  absoluteContainerRef,\n  uniqueId,\n  mediaUrl,\n  position,\n  isHq,\n} : {\n  customEmoji: ApiSticker;\n  sharedCanvasRef: React.RefObject<HTMLCanvasElement>;\n  sharedCanvasHqRef: React.RefObject<HTMLCanvasElement>;\n  absoluteContainerRef: React.RefObject<HTMLElement>;\n  uniqueId: string;\n  mediaUrl: string;\n  position: { x: number; y: number };\n  isHq?: boolean;\n}): Player {\n  if (customEmoji.isLottie) {\n    const lottie = RLottie.init(\n      uniqueId,\n      isHq ? sharedCanvasHqRef.current! : sharedCanvasRef.current!,\n      undefined,\n      generateIdFor(ID_STORE, true),\n      mediaUrl,\n      {\n        size: SIZE,\n        coords: position,\n        isLowPriority: !isHq,\n      },\n    );\n    return {\n      play: () => lottie.play(),\n      pause: () => lottie.pause(),\n      destroy: () => lottie.removeContainer(uniqueId),\n      updatePosition: (x: number, y: number) => lottie.setSharedCanvasCoords(uniqueId, { x, y }),\n    };\n  }\n\n  if (customEmoji.isVideo) {\n    const absoluteVideo = new AbsoluteVideo(mediaUrl, absoluteContainerRef.current!, { size: SIZE, position });\n    return {\n      play: () => absoluteVideo.play(),\n      pause: () => absoluteVideo.pause(),\n      destroy: () => absoluteVideo.destroy(),\n      updatePosition: (x: number, y: number) => absoluteVideo.updatePosition({ x, y }),\n    };\n  }\n\n  throw new Error('Unsupported custom emoji type');\n}\n","import type { ChangeEvent } from 'react';\nimport type { FC } from '../../../lib/teact/teact';\nimport React, {\n  useEffect, useRef, memo, useState, useCallback,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { IAnchorPosition, ISettings } from '../../../types';\n\nimport { EDITABLE_INPUT_ID } from '../../../config';\nimport { selectIsInSelectMode, selectReplyingToId } from '../../../global/selectors';\nimport { debounce } from '../../../util/schedulers';\nimport focusEditableElement from '../../../util/focusEditableElement';\nimport buildClassName from '../../../util/buildClassName';\nimport {\n  IS_ANDROID, IS_EMOJI_SUPPORTED, IS_IOS, IS_SINGLE_COLUMN_LAYOUT, IS_TOUCH_ENV,\n} from '../../../util/environment';\nimport captureKeyboardListeners from '../../../util/captureKeyboardListeners';\nimport { getIsDirectTextInputDisabled } from '../../../util/directInputManager';\nimport parseEmojiOnlyString from '../../../util/parseEmojiOnlyString';\nimport { isSelectionInsideInput } from './helpers/selection';\nimport renderText from '../../common/helpers/renderText';\n\nimport useLayoutEffectWithPrevDeps from '../../../hooks/useLayoutEffectWithPrevDeps';\nimport useFlag from '../../../hooks/useFlag';\nimport { isHeavyAnimating } from '../../../hooks/useHeavyAnimationCheck';\nimport useLang from '../../../hooks/useLang';\nimport useInputCustomEmojis from './hooks/useInputCustomEmojis';\n\nimport TextFormatter from './TextFormatter';\n\nconst CONTEXT_MENU_CLOSE_DELAY_MS = 100;\n// Focus slows down animation, also it breaks transition layout in Chrome\nconst FOCUS_DELAY_MS = 350;\nconst TRANSITION_DURATION_FACTOR = 50;\n\nconst SCROLLER_CLASS = 'input-scroller';\n\ntype OwnProps = {\n  id: string;\n  chatId: string;\n  threadId: number;\n  isAttachmentModalInput?: boolean;\n  editableInputId?: string;\n  html: string;\n  placeholder: string;\n  forcedPlaceholder?: string;\n  noFocusInterception?: boolean;\n  canAutoFocus: boolean;\n  shouldSuppressFocus?: boolean;\n  shouldSuppressTextFormatter?: boolean;\n  onUpdate: (html: string) => void;\n  onSuppressedFocus?: () => void;\n  onSend: () => void;\n  captionLimit?: number;\n};\n\ntype StateProps = {\n  replyingToId?: number;\n  isSelectModeActive?: boolean;\n  messageSendKeyCombo?: ISettings['messageSendKeyCombo'];\n};\n\nconst MAX_INPUT_HEIGHT = IS_SINGLE_COLUMN_LAYOUT ? 256 : 416;\nconst MAX_ATTACHMENT_MODAL_INPUT_HEIGHT = 240;\nconst TAB_INDEX_PRIORITY_TIMEOUT = 2000;\n// Heuristics allowing the user to make a triple click\nconst SELECTION_RECALCULATE_DELAY_MS = 260;\nconst TEXT_FORMATTER_SAFE_AREA_PX = 90;\n// For some reason Safari inserts `<br>` after user removes text from input\nconst SAFARI_BR = '<br>';\nconst IGNORE_KEYS = [\n  'Esc', 'Escape', 'Enter', 'PageUp', 'PageDown', 'Meta', 'Alt', 'Ctrl', 'ArrowDown', 'ArrowUp', 'Control', 'Shift',\n];\n\nfunction clearSelection() {\n  const selection = window.getSelection();\n  if (!selection) {\n    return;\n  }\n\n  if (selection.removeAllRanges) {\n    selection.removeAllRanges();\n  } else if (selection.empty) {\n    selection.empty();\n  }\n}\n\nconst MessageInput: FC<OwnProps & StateProps> = ({\n  id,\n  chatId,\n  captionLimit,\n  isAttachmentModalInput,\n  editableInputId,\n  html,\n  placeholder,\n  forcedPlaceholder,\n  canAutoFocus,\n  noFocusInterception,\n  shouldSuppressFocus,\n  shouldSuppressTextFormatter,\n  replyingToId,\n  isSelectModeActive,\n  messageSendKeyCombo,\n  onUpdate,\n  onSuppressedFocus,\n  onSend,\n}) => {\n  const {\n    editLastMessage,\n    replyToNextMessage,\n  } = getActions();\n\n  // eslint-disable-next-line no-null/no-null\n  const inputRef = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const selectionTimeoutRef = useRef<number>(null);\n  // eslint-disable-next-line no-null/no-null\n  const cloneRef = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const scrollerCloneRef = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const sharedCanvasRef = useRef<HTMLCanvasElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const sharedCanvasHqRef = useRef<HTMLCanvasElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const absoluteContainerRef = useRef<HTMLDivElement>(null);\n\n  const lang = useLang();\n  const isContextMenuOpenRef = useRef(false);\n  const [isTextFormatterOpen, openTextFormatter, closeTextFormatter] = useFlag();\n  const [textFormatterAnchorPosition, setTextFormatterAnchorPosition] = useState<IAnchorPosition>();\n  const [selectedRange, setSelectedRange] = useState<Range>();\n  const [isTextFormatterDisabled, setIsTextFormatterDisabled] = useState<boolean>(false);\n\n  useInputCustomEmojis(html, inputRef, sharedCanvasRef, sharedCanvasHqRef, absoluteContainerRef);\n\n  const updateInputHeight = useCallback((willSend = false) => {\n    const scroller = inputRef.current!.closest<HTMLDivElement>(`.${SCROLLER_CLASS}`)!;\n    const clone = scrollerCloneRef.current!;\n    const currentHeight = Number(scroller.style.height.replace('px', ''));\n    const maxHeight = isAttachmentModalInput ? MAX_ATTACHMENT_MODAL_INPUT_HEIGHT : MAX_INPUT_HEIGHT;\n    const newHeight = Math.min(clone.scrollHeight, maxHeight);\n    if (newHeight === currentHeight) {\n      return;\n    }\n\n    const transitionDuration = Math.round(\n      TRANSITION_DURATION_FACTOR * Math.log(Math.abs(newHeight - currentHeight)),\n    );\n\n    const exec = () => {\n      scroller.style.height = `${newHeight}px`;\n      scroller.style.transitionDuration = `${transitionDuration}ms`;\n      scroller.classList.toggle('overflown', clone.scrollHeight > maxHeight);\n    };\n\n    if (willSend) {\n      // Sync with sending animation\n      requestAnimationFrame(exec);\n    } else {\n      exec();\n    }\n  }, [isAttachmentModalInput]);\n\n  useEffect(() => {\n    if (!isAttachmentModalInput) return;\n    updateInputHeight(false);\n  }, [isAttachmentModalInput, updateInputHeight]);\n\n  useLayoutEffectWithPrevDeps(([prevHtml]) => {\n    if (html !== inputRef.current!.innerHTML) {\n      inputRef.current!.innerHTML = html;\n    }\n\n    if (html !== cloneRef.current!.innerHTML) {\n      cloneRef.current!.innerHTML = html;\n    }\n\n    if (prevHtml !== undefined && prevHtml !== html) {\n      updateInputHeight(!html.length);\n    }\n  }, [html]);\n\n  const chatIdRef = useRef(chatId);\n  chatIdRef.current = chatId;\n  const focusInput = useCallback(() => {\n    if (!inputRef.current) {\n      return;\n    }\n\n    if (isHeavyAnimating()) {\n      setTimeout(focusInput, FOCUS_DELAY_MS);\n      return;\n    }\n\n    focusEditableElement(inputRef.current!);\n  }, []);\n\n  const handleCloseTextFormatter = useCallback(() => {\n    closeTextFormatter();\n    clearSelection();\n  }, [closeTextFormatter]);\n\n  function checkSelection() {\n    // Disable the formatter on iOS devices for now.\n    if (IS_IOS) {\n      return false;\n    }\n\n    const selection = window.getSelection();\n    if (!selection || !selection.rangeCount || isContextMenuOpenRef.current) {\n      closeTextFormatter();\n      if (IS_ANDROID) {\n        setIsTextFormatterDisabled(false);\n      }\n      return false;\n    }\n\n    const selectionRange = selection.getRangeAt(0);\n    const selectedText = selectionRange.toString().trim();\n    if (\n      shouldSuppressTextFormatter\n      || !isSelectionInsideInput(selectionRange, editableInputId || EDITABLE_INPUT_ID)\n      || !selectedText\n      || parseEmojiOnlyString(selectedText)\n      || !selectionRange.START_TO_END\n    ) {\n      closeTextFormatter();\n      return false;\n    }\n\n    return true;\n  }\n\n  function processSelection() {\n    if (!checkSelection()) {\n      return;\n    }\n\n    if (isTextFormatterDisabled) {\n      return;\n    }\n\n    const selectionRange = window.getSelection()!.getRangeAt(0);\n    const selectionRect = selectionRange.getBoundingClientRect();\n    const inputRect = inputRef.current!.getBoundingClientRect();\n\n    let x = (selectionRect.left + selectionRect.width / 2) - inputRect.left;\n\n    if (x < TEXT_FORMATTER_SAFE_AREA_PX) {\n      x = TEXT_FORMATTER_SAFE_AREA_PX;\n    } else if (x > inputRect.width - TEXT_FORMATTER_SAFE_AREA_PX) {\n      x = inputRect.width - TEXT_FORMATTER_SAFE_AREA_PX;\n    }\n\n    setTextFormatterAnchorPosition({\n      x,\n      y: selectionRect.top - inputRect.top,\n    });\n\n    setSelectedRange(selectionRange);\n    openTextFormatter();\n  }\n\n  function processSelectionWithTimeout() {\n    if (selectionTimeoutRef.current) {\n      window.clearTimeout(selectionTimeoutRef.current);\n    }\n    // Small delay to allow browser properly recalculate selection\n    selectionTimeoutRef.current = window.setTimeout(processSelection, SELECTION_RECALCULATE_DELAY_MS);\n  }\n\n  function handleMouseDown(e: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    if (e.button !== 2) {\n      e.target.addEventListener('mouseup', processSelectionWithTimeout, { once: true });\n      return;\n    }\n\n    if (isContextMenuOpenRef.current) {\n      return;\n    }\n\n    isContextMenuOpenRef.current = true;\n\n    function handleCloseContextMenu(e2: KeyboardEvent | MouseEvent) {\n      if (e2 instanceof KeyboardEvent && e2.key !== 'Esc' && e2.key !== 'Escape') {\n        return;\n      }\n\n      setTimeout(() => {\n        isContextMenuOpenRef.current = false;\n      }, CONTEXT_MENU_CLOSE_DELAY_MS);\n\n      window.removeEventListener('keydown', handleCloseContextMenu);\n      window.removeEventListener('mousedown', handleCloseContextMenu);\n    }\n\n    document.addEventListener('mousedown', handleCloseContextMenu);\n    document.addEventListener('keydown', handleCloseContextMenu);\n  }\n\n  function handleKeyDown(e: React.KeyboardEvent<HTMLDivElement>) {\n    // https://levelup.gitconnected.com/javascript-events-handlers-keyboard-and-load-events-1b3e46a6b0c3#1960\n    const { isComposing } = e;\n\n    if (!isComposing && !html.length && (e.metaKey || e.ctrlKey)) {\n      const targetIndexDelta = e.key === 'ArrowDown' ? 1 : e.key === 'ArrowUp' ? -1 : undefined;\n      if (targetIndexDelta) {\n        e.preventDefault();\n\n        replyToNextMessage({ targetIndexDelta });\n        return;\n      }\n    }\n\n    if (!isComposing && e.key === 'Enter' && !e.shiftKey) {\n      if (\n        !(IS_IOS || IS_ANDROID)\n        && (\n          (messageSendKeyCombo === 'enter' && !e.shiftKey)\n          || (messageSendKeyCombo === 'ctrl-enter' && (e.ctrlKey || e.metaKey))\n        )\n      ) {\n        e.preventDefault();\n\n        closeTextFormatter();\n        onSend();\n      }\n    } else if (!isComposing && e.key === 'ArrowUp' && !html.length && !e.metaKey && !e.ctrlKey && !e.altKey) {\n      e.preventDefault();\n      editLastMessage();\n    } else {\n      e.target.addEventListener('keyup', processSelectionWithTimeout, { once: true });\n    }\n  }\n\n  function handleChange(e: ChangeEvent<HTMLDivElement>) {\n    const { innerHTML, textContent } = e.currentTarget;\n\n    onUpdate(innerHTML === SAFARI_BR ? '' : innerHTML);\n\n    // Reset focus on the input to remove any active styling when input is cleared\n    if (\n      !IS_TOUCH_ENV\n      && (!textContent || !textContent.length)\n      // When emojis are not supported, innerHTML contains an emoji img tag that doesn't exist in the textContext\n      && !(!IS_EMOJI_SUPPORTED && innerHTML.includes('emoji-small'))\n      && !(innerHTML.includes('custom-emoji'))\n    ) {\n      const selection = window.getSelection()!;\n      if (selection) {\n        inputRef.current!.blur();\n        selection.removeAllRanges();\n        focusEditableElement(inputRef.current!, true);\n      }\n    }\n  }\n\n  function handleAndroidContextMenu(e: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    if (!checkSelection()) {\n      return;\n    }\n\n    setIsTextFormatterDisabled(!isTextFormatterDisabled);\n\n    if (!isTextFormatterDisabled) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      processSelection();\n    } else {\n      closeTextFormatter();\n    }\n  }\n\n  useEffect(() => {\n    if (IS_TOUCH_ENV) {\n      return;\n    }\n\n    if (canAutoFocus) {\n      focusInput();\n    }\n  }, [chatId, focusInput, replyingToId, canAutoFocus]);\n\n  useEffect(() => {\n    if (\n      !chatId\n      || editableInputId !== EDITABLE_INPUT_ID\n      || noFocusInterception\n      || (IS_TOUCH_ENV && IS_SINGLE_COLUMN_LAYOUT)\n      || isSelectModeActive\n    ) {\n      return undefined;\n    }\n\n    const handleDocumentKeyDown = (e: KeyboardEvent) => {\n      if (getIsDirectTextInputDisabled()) {\n        return;\n      }\n\n      const { key } = e;\n      const target = e.target as HTMLElement | undefined;\n\n      if (!target || IGNORE_KEYS.includes(key)) {\n        return;\n      }\n\n      const input = inputRef.current!;\n      const isSelectionCollapsed = document.getSelection()?.isCollapsed;\n\n      if (\n        ((key.startsWith('Arrow') || (e.shiftKey && key === 'Shift')) && !isSelectionCollapsed)\n        || (e.code === 'KeyC' && (e.ctrlKey || e.metaKey) && target.tagName !== 'INPUT')\n      ) {\n        return;\n      }\n\n      if (\n        input\n        && target !== input\n        && target.tagName !== 'INPUT'\n        && target.tagName !== 'TEXTAREA'\n        && !target.isContentEditable\n      ) {\n        focusEditableElement(input, true, true);\n\n        const newEvent = new KeyboardEvent(e.type, e as any);\n        input.dispatchEvent(newEvent);\n      }\n    };\n\n    document.addEventListener('keydown', handleDocumentKeyDown, true);\n\n    return () => {\n      document.removeEventListener('keydown', handleDocumentKeyDown, true);\n    };\n  }, [chatId, editableInputId, isSelectModeActive, noFocusInterception]);\n\n  useEffect(() => {\n    const captureFirstTab = debounce((e: KeyboardEvent) => {\n      if (e.key === 'Tab' && !getIsDirectTextInputDisabled()) {\n        e.preventDefault();\n        requestAnimationFrame(focusInput);\n      }\n    }, TAB_INDEX_PRIORITY_TIMEOUT, true, false);\n\n    return captureKeyboardListeners({ onTab: captureFirstTab });\n  }, [focusInput]);\n\n  useEffect(() => {\n    const input = inputRef.current!;\n\n    function suppressFocus() {\n      input.blur();\n    }\n\n    if (shouldSuppressFocus) {\n      input.addEventListener('focus', suppressFocus);\n    }\n\n    return () => {\n      input.removeEventListener('focus', suppressFocus);\n    };\n  }, [shouldSuppressFocus]);\n\n  const className = buildClassName(\n    'form-control',\n    html.length > 0 && 'touched',\n    shouldSuppressFocus && 'focus-disabled',\n  );\n\n  return (\n    <div id={id} onClick={shouldSuppressFocus ? onSuppressedFocus : undefined} dir={lang.isRtl ? 'rtl' : undefined}>\n      <div className={buildClassName('custom-scroll', SCROLLER_CLASS)}>\n        <div className=\"input-scroller-content\">\n          <div\n            ref={inputRef}\n            id={editableInputId || EDITABLE_INPUT_ID}\n            className={className}\n            contentEditable\n            role=\"textbox\"\n            dir=\"auto\"\n            tabIndex={0}\n            onClick={focusInput}\n            onChange={handleChange}\n            onKeyDown={handleKeyDown}\n            onMouseDown={handleMouseDown}\n            onContextMenu={IS_ANDROID ? handleAndroidContextMenu : undefined}\n            onTouchCancel={IS_ANDROID ? processSelectionWithTimeout : undefined}\n            aria-label={placeholder}\n          />\n          {!forcedPlaceholder && <span className=\"placeholder-text\" dir=\"auto\">{placeholder}</span>}\n          <canvas ref={sharedCanvasRef} className=\"shared-canvas\" />\n          <canvas ref={sharedCanvasHqRef} className=\"shared-canvas\" />\n          <div ref={absoluteContainerRef} className=\"absolute-video-container\" />\n        </div>\n      </div>\n      <div ref={scrollerCloneRef} className={buildClassName('custom-scroll', SCROLLER_CLASS, 'clone')}>\n        <div className=\"input-scroller-content\">\n          <div ref={cloneRef} className={buildClassName(className, 'clone')} dir=\"auto\" />\n        </div>\n      </div>\n      {captionLimit && (\n        <div className=\"max-length-indicator\" dir=\"auto\">\n          {captionLimit}\n        </div>\n      )}\n      <TextFormatter\n        isOpen={isTextFormatterOpen}\n        anchorPosition={textFormatterAnchorPosition}\n        selectedRange={selectedRange}\n        setSelectedRange={setSelectedRange}\n        onClose={handleCloseTextFormatter}\n      />\n      {forcedPlaceholder && <span className=\"forced-placeholder\">{renderText(forcedPlaceholder!)}</span>}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { chatId, threadId }: OwnProps): StateProps => {\n    const { messageSendKeyCombo } = global.settings.byKey;\n\n    return {\n      messageSendKeyCombo,\n      replyingToId: chatId && threadId ? selectReplyingToId(global, chatId, threadId) : undefined,\n      isSelectModeActive: selectIsInSelectMode(global),\n    };\n  },\n)(MessageInput));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useRef, useState,\n} from '../../../lib/teact/teact';\n\nimport type { IAnchorPosition } from '../../../types';\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport { EDITABLE_INPUT_ID } from '../../../config';\nimport buildClassName from '../../../util/buildClassName';\nimport { ensureProtocol } from '../../../util/ensureProtocol';\nimport captureEscKeyListener from '../../../util/captureEscKeyListener';\nimport getKeyFromEvent from '../../../util/getKeyFromEvent';\nimport { INPUT_CUSTOM_EMOJI_SELECTOR } from './helpers/customEmoji';\n\nimport useShowTransition from '../../../hooks/useShowTransition';\nimport useVirtualBackdrop from '../../../hooks/useVirtualBackdrop';\nimport useFlag from '../../../hooks/useFlag';\nimport useLang from '../../../hooks/useLang';\n\nimport Button from '../../ui/Button';\n\nimport './TextFormatter.scss';\n\nexport type OwnProps = {\n  isOpen: boolean;\n  anchorPosition?: IAnchorPosition;\n  selectedRange?: Range;\n  setSelectedRange: (range: Range) => void;\n  onClose: () => void;\n};\n\ninterface ISelectedTextFormats {\n  bold?: boolean;\n  italic?: boolean;\n  underline?: boolean;\n  strikethrough?: boolean;\n  monospace?: boolean;\n  spoiler?: boolean;\n}\n\nconst TEXT_FORMAT_BY_TAG_NAME: Record<string, keyof ISelectedTextFormats> = {\n  B: 'bold',\n  STRONG: 'bold',\n  I: 'italic',\n  EM: 'italic',\n  U: 'underline',\n  DEL: 'strikethrough',\n  CODE: 'monospace',\n  SPAN: 'spoiler',\n};\nconst fragmentEl = document.createElement('div');\n\nconst TextFormatter: FC<OwnProps> = ({\n  isOpen,\n  anchorPosition,\n  selectedRange,\n  setSelectedRange,\n  onClose,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const linkUrlInputRef = useRef<HTMLInputElement>(null);\n  const { shouldRender, transitionClassNames } = useShowTransition(isOpen);\n  const [isLinkControlOpen, openLinkControl, closeLinkControl] = useFlag();\n  const [linkUrl, setLinkUrl] = useState('');\n  const [isEditingLink, setIsEditingLink] = useState(false);\n  const [inputClassName, setInputClassName] = useState<string | undefined>();\n  const [selectedTextFormats, setSelectedTextFormats] = useState<ISelectedTextFormats>({});\n\n  useEffect(() => (isOpen ? captureEscKeyListener(onClose) : undefined), [isOpen, onClose]);\n  useVirtualBackdrop(\n    isOpen,\n    containerRef,\n    onClose,\n  );\n\n  useEffect(() => {\n    if (isLinkControlOpen) {\n      linkUrlInputRef.current!.focus();\n    } else {\n      setLinkUrl('');\n      setIsEditingLink(false);\n    }\n  }, [isLinkControlOpen]);\n\n  useEffect(() => {\n    if (!shouldRender) {\n      closeLinkControl();\n      setSelectedTextFormats({});\n      setInputClassName(undefined);\n    }\n  }, [closeLinkControl, shouldRender]);\n\n  useEffect(() => {\n    if (!isOpen || !selectedRange) {\n      return;\n    }\n\n    const selectedFormats: ISelectedTextFormats = {};\n    let { parentElement } = selectedRange.commonAncestorContainer;\n    while (parentElement && parentElement.id !== EDITABLE_INPUT_ID) {\n      const textFormat = TEXT_FORMAT_BY_TAG_NAME[parentElement.tagName];\n      if (textFormat) {\n        selectedFormats[textFormat] = true;\n      }\n\n      parentElement = parentElement.parentElement;\n    }\n\n    setSelectedTextFormats(selectedFormats);\n  }, [isOpen, selectedRange, openLinkControl]);\n\n  const restoreSelection = useCallback(() => {\n    if (!selectedRange) {\n      return;\n    }\n\n    const selection = window.getSelection();\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(selectedRange);\n    }\n  }, [selectedRange]);\n\n  const updateSelectedRange = useCallback(() => {\n    const selection = window.getSelection();\n    if (selection) {\n      setSelectedRange(selection.getRangeAt(0));\n    }\n  }, [setSelectedRange]);\n\n  const getSelectedText = useCallback((shouldDropCustomEmoji?: boolean) => {\n    if (!selectedRange) {\n      return undefined;\n    }\n    fragmentEl.replaceChildren(selectedRange.cloneContents());\n    if (shouldDropCustomEmoji) {\n      fragmentEl.querySelectorAll(INPUT_CUSTOM_EMOJI_SELECTOR).forEach((el) => {\n        el.replaceWith(el.getAttribute('alt')!);\n      });\n    }\n    return fragmentEl.innerHTML;\n  }, [selectedRange]);\n\n  const getSelectedElement = useCallback(() => {\n    if (!selectedRange) {\n      return undefined;\n    }\n\n    return selectedRange.commonAncestorContainer.parentElement;\n  }, [selectedRange]);\n\n  function updateInputStyles() {\n    const input = linkUrlInputRef.current;\n    if (!input) {\n      return;\n    }\n\n    const { offsetWidth, scrollWidth, scrollLeft } = input;\n    if (scrollWidth <= offsetWidth) {\n      setInputClassName(undefined);\n      return;\n    }\n\n    let className = '';\n    if (scrollLeft < scrollWidth - offsetWidth) {\n      className = 'mask-right';\n    }\n    if (scrollLeft > 0) {\n      className += ' mask-left';\n    }\n\n    setInputClassName(className);\n  }\n\n  function handleLinkUrlChange(e: React.ChangeEvent<HTMLInputElement>) {\n    setLinkUrl(e.target.value);\n    updateInputStyles();\n  }\n\n  function getFormatButtonClassName(key: keyof ISelectedTextFormats) {\n    if (selectedTextFormats[key]) {\n      return 'active';\n    }\n\n    if (key === 'monospace' || key === 'strikethrough') {\n      if (Object.keys(selectedTextFormats).some(\n        (fKey) => fKey !== key && Boolean(selectedTextFormats[fKey as keyof ISelectedTextFormats]),\n      )) {\n        return 'disabled';\n      }\n    } else if (selectedTextFormats.monospace || selectedTextFormats.strikethrough) {\n      return 'disabled';\n    }\n\n    return undefined;\n  }\n\n  const handleSpoilerText = useCallback(() => {\n    if (selectedTextFormats.spoiler) {\n      const element = getSelectedElement();\n      if (\n        !selectedRange\n        || !element\n        || element.dataset.entityType !== ApiMessageEntityTypes.Spoiler\n        || !element.textContent\n      ) {\n        return;\n      }\n\n      element.replaceWith(element.textContent);\n      setSelectedTextFormats((selectedFormats) => ({\n        ...selectedFormats,\n        spoiler: false,\n      }));\n\n      return;\n    }\n\n    const text = getSelectedText();\n    document.execCommand(\n      'insertHTML', false, `<span class=\"spoiler\" data-entity-type=\"${ApiMessageEntityTypes.Spoiler}\">${text}</span>`,\n    );\n    onClose();\n  }, [getSelectedElement, getSelectedText, onClose, selectedRange, selectedTextFormats.spoiler]);\n\n  const handleBoldText = useCallback(() => {\n    setSelectedTextFormats((selectedFormats) => {\n      // Somehow re-applying 'bold' command to already bold text doesn't work\n      document.execCommand(selectedFormats.bold ? 'removeFormat' : 'bold');\n      Object.keys(selectedFormats).forEach((key) => {\n        if ((key === 'italic' || key === 'underline') && Boolean(selectedFormats[key])) {\n          document.execCommand(key);\n        }\n      });\n\n      updateSelectedRange();\n      return {\n        ...selectedFormats,\n        bold: !selectedFormats.bold,\n      };\n    });\n  }, [updateSelectedRange]);\n\n  const handleItalicText = useCallback(() => {\n    document.execCommand('italic');\n    updateSelectedRange();\n    setSelectedTextFormats((selectedFormats) => ({\n      ...selectedFormats,\n      italic: !selectedFormats.italic,\n    }));\n  }, [updateSelectedRange]);\n\n  const handleUnderlineText = useCallback(() => {\n    document.execCommand('underline');\n    updateSelectedRange();\n    setSelectedTextFormats((selectedFormats) => ({\n      ...selectedFormats,\n      underline: !selectedFormats.underline,\n    }));\n  }, [updateSelectedRange]);\n\n  const handleStrikethroughText = useCallback(() => {\n    if (selectedTextFormats.strikethrough) {\n      const element = getSelectedElement();\n      if (\n        !selectedRange\n        || !element\n        || element.tagName !== 'DEL'\n        || !element.textContent\n      ) {\n        return;\n      }\n\n      element.replaceWith(element.textContent);\n      setSelectedTextFormats((selectedFormats) => ({\n        ...selectedFormats,\n        strikethrough: false,\n      }));\n\n      return;\n    }\n\n    const text = getSelectedText();\n    document.execCommand('insertHTML', false, `<del>${text}</del>`);\n    onClose();\n  }, [\n    getSelectedElement, getSelectedText, onClose, selectedRange, selectedTextFormats.strikethrough,\n  ]);\n\n  const handleMonospaceText = useCallback(() => {\n    if (selectedTextFormats.monospace) {\n      const element = getSelectedElement();\n      if (\n        !selectedRange\n        || !element\n        || element.tagName !== 'CODE'\n        || !element.textContent\n      ) {\n        return;\n      }\n\n      element.replaceWith(element.textContent);\n      setSelectedTextFormats((selectedFormats) => ({\n        ...selectedFormats,\n        monospace: false,\n      }));\n\n      return;\n    }\n\n    const text = getSelectedText(true);\n    document.execCommand('insertHTML', false, `<code class=\"text-entity-code\" dir=\"auto\">${text}</code>`);\n    onClose();\n  }, [\n    getSelectedElement, getSelectedText, onClose, selectedRange, selectedTextFormats.monospace,\n  ]);\n\n  const handleLinkUrlConfirm = useCallback(() => {\n    const formattedLinkUrl = (ensureProtocol(linkUrl) || '').split('%').map(encodeURI).join('%');\n\n    if (isEditingLink) {\n      const element = getSelectedElement();\n      if (!element || element.tagName !== 'A') {\n        return;\n      }\n\n      (element as HTMLAnchorElement).href = formattedLinkUrl;\n\n      onClose();\n\n      return;\n    }\n\n    const text = getSelectedText(true);\n    restoreSelection();\n    document.execCommand(\n      'insertHTML',\n      false,\n      `<a href=${formattedLinkUrl} class=\"text-entity-link\" dir=\"auto\">${text}</a>`,\n    );\n    onClose();\n  }, [getSelectedElement, getSelectedText, isEditingLink, linkUrl, onClose, restoreSelection]);\n\n  const handleKeyDown = useCallback((e: KeyboardEvent) => {\n    const HANDLERS_BY_KEY: Record<string, AnyToVoidFunction> = {\n      k: openLinkControl,\n      b: handleBoldText,\n      u: handleUnderlineText,\n      i: handleItalicText,\n      m: handleMonospaceText,\n      s: handleStrikethroughText,\n      p: handleSpoilerText,\n    };\n\n    const handler = HANDLERS_BY_KEY[getKeyFromEvent(e)];\n\n    if (\n      e.altKey\n      || !(e.ctrlKey || e.metaKey)\n      || !handler\n    ) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n    handler();\n  }, [\n    openLinkControl, handleBoldText, handleUnderlineText, handleItalicText, handleMonospaceText,\n    handleStrikethroughText, handleSpoilerText,\n  ]);\n\n  useEffect(() => {\n    if (isOpen) {\n      document.addEventListener('keydown', handleKeyDown);\n    }\n\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, handleKeyDown]);\n\n  const lang = useLang();\n\n  function handleContainerKeyDown(e: React.KeyboardEvent<HTMLDivElement>) {\n    if (e.key === 'Enter' && isLinkControlOpen) {\n      handleLinkUrlConfirm();\n      e.preventDefault();\n    }\n  }\n\n  if (!shouldRender) {\n    return undefined;\n  }\n\n  const className = buildClassName(\n    'TextFormatter',\n    transitionClassNames,\n    isLinkControlOpen && 'link-control-shown',\n  );\n\n  const linkUrlConfirmClassName = buildClassName(\n    'TextFormatter-link-url-confirm',\n    Boolean(linkUrl.length) && 'shown',\n  );\n\n  const style = anchorPosition\n    ? `left: ${anchorPosition.x}px; top: ${anchorPosition.y}px;--text-formatter-left: ${anchorPosition.x}px;`\n    : '';\n\n  return (\n    <div\n      ref={containerRef}\n      className={className}\n      style={style}\n      onKeyDown={handleContainerKeyDown}\n    >\n      <div className=\"TextFormatter-buttons\">\n        <Button\n          color=\"translucent\"\n          ariaLabel=\"Spoiler text\"\n          className={getFormatButtonClassName('spoiler')}\n          onClick={handleSpoilerText}\n        >\n          <i className=\"icon-eye-closed\" />\n        </Button>\n        <div className=\"TextFormatter-divider\" />\n        <Button\n          color=\"translucent\"\n          ariaLabel=\"Bold text\"\n          className={getFormatButtonClassName('bold')}\n          onClick={handleBoldText}\n        >\n          <i className=\"icon-bold\" />\n        </Button>\n        <Button\n          color=\"translucent\"\n          ariaLabel=\"Italic text\"\n          className={getFormatButtonClassName('italic')}\n          onClick={handleItalicText}\n        >\n          <i className=\"icon-italic\" />\n        </Button>\n        <Button\n          color=\"translucent\"\n          ariaLabel=\"Underlined text\"\n          className={getFormatButtonClassName('underline')}\n          onClick={handleUnderlineText}\n        >\n          <i className=\"icon-underlined\" />\n        </Button>\n        <Button\n          color=\"translucent\"\n          ariaLabel=\"Strikethrough text\"\n          className={getFormatButtonClassName('strikethrough')}\n          onClick={handleStrikethroughText}\n        >\n          <i className=\"icon-strikethrough\" />\n        </Button>\n        <Button\n          color=\"translucent\"\n          ariaLabel=\"Monospace text\"\n          className={getFormatButtonClassName('monospace')}\n          onClick={handleMonospaceText}\n        >\n          <i className=\"icon-monospace\" />\n        </Button>\n        <div className=\"TextFormatter-divider\" />\n        <Button color=\"translucent\" ariaLabel={lang('TextFormat.AddLinkTitle')} onClick={openLinkControl}>\n          <i className=\"icon-link\" />\n        </Button>\n      </div>\n\n      <div className=\"TextFormatter-link-control\">\n        <div className=\"TextFormatter-buttons\">\n          <Button color=\"translucent\" ariaLabel={lang('Cancel')} onClick={closeLinkControl}>\n            <i className=\"icon-arrow-left\" />\n          </Button>\n          <div className=\"TextFormatter-divider\" />\n\n          <div\n            className={buildClassName('TextFormatter-link-url-input-wrapper', inputClassName)}\n          >\n            <input\n              ref={linkUrlInputRef}\n              className=\"TextFormatter-link-url-input\"\n              type=\"text\"\n              value={linkUrl}\n              placeholder=\"Enter URL...\"\n              autoComplete=\"off\"\n              inputMode=\"url\"\n              dir=\"auto\"\n              onChange={handleLinkUrlChange}\n              onScroll={updateInputStyles}\n            />\n          </div>\n\n          <div className={linkUrlConfirmClassName}>\n            <div className=\"TextFormatter-divider\" />\n            <Button\n              color=\"translucent\"\n              ariaLabel={lang('Save')}\n              className=\"color-primary\"\n              onClick={handleLinkUrlConfirm}\n            >\n              <i className=\"icon-check\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(TextFormatter);\n","export default function getKeyFromEvent(e: KeyboardEvent) {\n  const key = e.key || e.code;\n\n  return key.startsWith('Key') ? key.slice(3).toLowerCase() : key;\n}\n","export default async function getFilesFromDataTransferItems(dataTransferItems: DataTransferItemList) {\n  const files: File[] = [];\n\n  function traverseFileTreePromise(entry: FileSystemEntry | File, item: DataTransferItem) {\n    return new Promise((resolve) => {\n      if (entry instanceof File) {\n        files.push(entry);\n        resolve(entry);\n      } else if (entry.isFile) {\n        const itemFile = item.getAsFile();\n        (entry as FileSystemFileEntry).file((file) => {\n          files.push(file);\n          resolve(file);\n        }, () => {\n          // iOS Safari throws an error \"NotFoundError: Path does not exist\" for files from the clipboard\n          // https://stackoverflow.com/a/50059309\n          if (itemFile) {\n            files.push(itemFile);\n          }\n          resolve(itemFile);\n        });\n      } else if (entry.isDirectory) {\n        const dirReader = (entry as FileSystemDirectoryEntry).createReader();\n        dirReader.readEntries((entries) => {\n          const entriesPromises = [];\n          for (let i = 0; i < entries.length; i++) {\n            entriesPromises.push(traverseFileTreePromise(entries[i], item));\n          }\n          resolve(Promise.all(entriesPromises));\n        });\n      }\n    });\n  }\n\n  const entriesPromises = [];\n  for (let i = 0; i < dataTransferItems.length; i++) {\n    const item = dataTransferItems[i];\n    if (item.kind === 'file') {\n      const entry = item.webkitGetAsEntry() || item.getAsFile();\n      if (entry) {\n        entriesPromises.push(traverseFileTreePromise(entry, item));\n      }\n    }\n  }\n\n  await Promise.all(entriesPromises);\n\n  return files.map(fixMovMime);\n}\n\n// .mov MIME type not reported sometimes https://developer.mozilla.org/en-US/docs/Web/API/File/type#sect1\nfunction fixMovMime(file: File) {\n  const ext = file.name.split('.').pop()!;\n  if (!file.type && ext.toLowerCase() === 'mov') {\n    return new File([file], file.name, { type: 'video/quicktime' });\n  }\n  return file;\n}\n","const RE_BR = /(<br>|<br\\s?\\/>)/g;\nconst RE_SPACE = /(&nbsp;|\\u00A0)/g;\nconst RE_CLEAN_HTML = /(<div>|<\\/div>)/gi;\nconst RE_EXTRA_NEW_LINE = /\\n$/i;\n\nexport function prepareForRegExp(html: string) {\n  return html\n    .replace(RE_SPACE, ' ')\n    .replace(RE_BR, '\\n')\n    .replace(RE_CLEAN_HTML, '')\n    .replace(RE_EXTRA_NEW_LINE, '');\n}\n","const MAX_NESTING_PARENTS = 5;\n\nexport function isSelectionInsideInput(selectionRange: Range, inputId: string) {\n  const { commonAncestorContainer } = selectionRange;\n  let parentNode: HTMLElement | null = commonAncestorContainer as HTMLElement;\n  let iterations = 1;\n  while (parentNode && parentNode.id !== inputId && iterations < MAX_NESTING_PARENTS) {\n    parentNode = parentNode.parentElement;\n    iterations++;\n  }\n\n  return Boolean(parentNode && parentNode.id === inputId);\n}\n","import { useCallback, useEffect, useState } from '../../../../lib/teact/teact';\nimport { getActions } from '../../../../global';\n\nimport type { ApiSticker } from '../../../../api/types';\n\nimport { EMOJI_IMG_REGEX } from '../../../../config';\nimport { IS_EMOJI_SUPPORTED } from '../../../../util/environment';\nimport { getHtmlBeforeSelection } from '../../../../util/selection';\nimport focusEditableElement from '../../../../util/focusEditableElement';\nimport twemojiRegex from '../../../../lib/twemojiRegex';\nimport { buildCustomEmojiHtml } from '../helpers/customEmoji';\n\nimport useOnSelectionChange from '../../../../hooks/useOnSelectionChange';\nimport useCacheBuster from '../../../../hooks/useCacheBuster';\n\nconst RE_ENDS_ON_EMOJI = new RegExp(`(${twemojiRegex.source})$`, 'g');\nconst ENDS_ON_EMOJI_IMG_REGEX = new RegExp(`${EMOJI_IMG_REGEX.source}$`, 'g');\n\nexport default function useCustomEmojiTooltip(\n  isAllowed: boolean,\n  inputSelector: string,\n  html: string,\n  onUpdateHtml: (html: string) => void,\n  stickers?: ApiSticker[],\n  isDisabled = false,\n) {\n  const { loadCustomEmojiForEmoji, clearCustomEmojiForEmoji } = getActions();\n\n  const [htmlBeforeSelection, setHtmlBeforeSelection] = useState('');\n\n  const [cacheBuster, updateCacheBuster] = useCacheBuster();\n\n  const handleSelectionChange = useCallback((range: Range) => {\n    if (range.collapsed) {\n      updateCacheBuster(); // Update tooltip on cursor move\n    }\n  }, [updateCacheBuster]);\n\n  useOnSelectionChange(document.querySelector<HTMLDivElement>(inputSelector), handleSelectionChange);\n\n  useEffect(() => {\n    if (!html) {\n      setHtmlBeforeSelection('');\n      return;\n    }\n    setHtmlBeforeSelection(getHtmlBeforeSelection(document.querySelector<HTMLDivElement>(inputSelector)!));\n  }, [html, inputSelector, cacheBuster]);\n\n  const lastEmojiText = htmlBeforeSelection.match(IS_EMOJI_SUPPORTED ? RE_ENDS_ON_EMOJI : ENDS_ON_EMOJI_IMG_REGEX)?.[0];\n  const hasStickers = Boolean(stickers?.length && lastEmojiText);\n\n  useEffect(() => {\n    if (isDisabled) return;\n\n    if (isAllowed && lastEmojiText) {\n      loadCustomEmojiForEmoji({\n        emoji: IS_EMOJI_SUPPORTED ? lastEmojiText : lastEmojiText.match(/.+alt=\"(.+)\"/)?.[1]!,\n      });\n    } else if (hasStickers || !lastEmojiText) {\n      clearCustomEmojiForEmoji();\n    }\n    // We omit `hasStickers` here to prevent re-fetching after manually closing tooltip (via <Esc>).\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [lastEmojiText, clearCustomEmojiForEmoji, loadCustomEmojiForEmoji, isAllowed, isDisabled]);\n\n  const insertCustomEmoji = useCallback((emoji: ApiSticker) => {\n    if (!lastEmojiText) return;\n    const containerEl = document.querySelector<HTMLDivElement>(inputSelector)!;\n    const regexText = IS_EMOJI_SUPPORTED ? lastEmojiText\n      // Escape regexp special chars\n      : lastEmojiText.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n    const regex = new RegExp(`(${regexText})\\\\1*$`, '');\n    const matched = htmlBeforeSelection.match(regex)![0];\n    const count = matched.length / lastEmojiText.length;\n\n    const newHtml = htmlBeforeSelection.replace(regex, buildCustomEmojiHtml(emoji).repeat(count));\n    const htmlAfterSelection = containerEl.innerHTML.substring(htmlBeforeSelection.length);\n    onUpdateHtml(`${newHtml}${htmlAfterSelection}`);\n\n    requestAnimationFrame(() => {\n      focusEditableElement(containerEl, true, true);\n    });\n  }, [htmlBeforeSelection, inputSelector, lastEmojiText, onUpdateHtml]);\n\n  return {\n    isCustomEmojiTooltipOpen: hasStickers,\n    closeCustomEmojiTooltip: clearCustomEmojiForEmoji,\n    insertCustomEmoji,\n  };\n}\n","import { areSortedArraysEqual } from './iteratees';\n\nconst cache = new WeakMap<AnyFunction, {\n  lastArgs: any[];\n  lastResult: any;\n}>();\n\nexport default function memoized<T extends AnyFunction>(fn: T) {\n  return (...args: Parameters<T>): ReturnType<T> => {\n    const cached = cache.get(fn);\n    if (cached && areSortedArraysEqual(cached.lastArgs, args)) {\n      return cached.lastResult;\n    }\n\n    const result = fn(...args);\n    cache.set(fn, { lastArgs: args, lastResult: result });\n    return result;\n  };\n}\n","import {\n  useCallback, useEffect, useState,\n} from '../../../../lib/teact/teact';\nimport { getGlobal } from '../../../../global';\n\nimport type { ApiSticker } from '../../../../api/types';\nimport type { EmojiData, EmojiModule, EmojiRawData } from '../../../../util/emoji';\n\nimport { EDITABLE_INPUT_CSS_SELECTOR, EDITABLE_INPUT_ID } from '../../../../config';\nimport {\n  buildCollectionByKey, mapValues, pickTruthy, unique, uniqueByField,\n} from '../../../../util/iteratees';\nimport { MEMO_EMPTY_ARRAY } from '../../../../util/memo';\nimport { prepareForRegExp } from '../helpers/prepareForRegExp';\nimport { uncompressEmoji } from '../../../../util/emoji';\nimport focusEditableElement from '../../../../util/focusEditableElement';\nimport memoized from '../../../../util/memoized';\nimport renderText from '../../../common/helpers/renderText';\nimport { selectCustomEmojiForEmojis } from '../../../../global/selectors';\nimport { buildCustomEmojiHtml } from '../helpers/customEmoji';\n\nimport useFlag from '../../../../hooks/useFlag';\nimport useDebouncedCallback from '../../../../hooks/useDebouncedCallback';\n\ninterface Library {\n  keywords: string[];\n  byKeyword: Record<string, Emoji[]>;\n  names: string[];\n  byName: Record<string, Emoji[]>;\n}\n\nlet emojiDataPromise: Promise<EmojiModule>;\nlet emojiRawData: EmojiRawData;\nlet emojiData: EmojiData;\n\nlet RE_EMOJI_SEARCH: RegExp;\nconst EMOJIS_LIMIT = 36;\nconst FILTER_MIN_LENGTH = 2;\n\nconst DEBOUNCE = 300;\n\nconst prepareRecentEmojisMemo = memoized(prepareRecentEmojis);\nconst prepareLibraryMemo = memoized(prepareLibrary);\nconst searchInLibraryMemo = memoized(searchInLibrary);\n\ntry {\n  RE_EMOJI_SEARCH = /(^|\\s):[-+_:\\p{L}\\p{N}]*$/gui;\n} catch (e) {\n  // Support for older versions of firefox\n  RE_EMOJI_SEARCH = /(^|\\s):[-+_:\\d\\w-]*$/gi;\n}\n\nexport default function useEmojiTooltip(\n  isAllowed: boolean,\n  htmlRef: { current: string },\n  recentEmojiIds: string[],\n  inputId = EDITABLE_INPUT_ID,\n  onUpdateHtml: (html: string) => void,\n  baseEmojiKeywords?: Record<string, string[]>,\n  emojiKeywords?: Record<string, string[]>,\n  isDisabled = false,\n) {\n  const [isOpen, markIsOpen, unmarkIsOpen] = useFlag();\n  const [byId, setById] = useState<Record<string, Emoji> | undefined>();\n  const [shouldForceInsertEmoji, setShouldForceInsertEmoji] = useState(false);\n  const [filteredEmojis, setFilteredEmojisInner] = useState<Emoji[]>(MEMO_EMPTY_ARRAY);\n  const [filteredCustomEmojis, setFilteredCustomEmojis] = useState<ApiSticker[]>(MEMO_EMPTY_ARRAY);\n\n  const setFilteredEmojis = useDebouncedCallback((emojis: Emoji[]) => {\n    setFilteredEmojisInner(emojis);\n  }, [], DEBOUNCE);\n\n  // Initialize data on first render.\n  useEffect(() => {\n    if (isDisabled) return;\n    const exec = () => {\n      setById(emojiData.emojis);\n    };\n\n    if (emojiData) {\n      exec();\n    } else {\n      ensureEmojiData()\n        .then(exec);\n    }\n  }, [isDisabled]);\n\n  const html = htmlRef.current;\n  useEffect(() => {\n    if (isDisabled) return;\n    const customEmojis = uniqueByField(\n      selectCustomEmojiForEmojis(getGlobal(), filteredEmojis.map((emoji) => emoji.native)),\n      'id',\n    );\n    setFilteredCustomEmojis(customEmojis);\n  }, [filteredEmojis, isDisabled]);\n\n  useEffect(() => {\n    if (!isAllowed || !html || !byId || isDisabled) {\n      unmarkIsOpen();\n      return;\n    }\n\n    const code = html.includes(':') && getEmojiCode(html);\n    if (!code) {\n      setFilteredEmojis(MEMO_EMPTY_ARRAY);\n      unmarkIsOpen();\n      return;\n    }\n\n    const forceSend = code.length > 2 && code.endsWith(':');\n    const filter = code.substr(1, forceSend ? code.length - 2 : undefined);\n    let matched: Emoji[] = MEMO_EMPTY_ARRAY;\n\n    setShouldForceInsertEmoji(forceSend);\n\n    if (!filter) {\n      matched = prepareRecentEmojisMemo(byId, recentEmojiIds, EMOJIS_LIMIT);\n    } else if (filter.length >= FILTER_MIN_LENGTH) {\n      const library = prepareLibraryMemo(byId, baseEmojiKeywords, emojiKeywords);\n      matched = searchInLibraryMemo(library, filter, EMOJIS_LIMIT);\n    }\n\n    if (matched.length) {\n      if (!forceSend) {\n        markIsOpen();\n      }\n      setFilteredEmojis(matched);\n    } else {\n      unmarkIsOpen();\n    }\n  }, [\n    byId, html, isAllowed, markIsOpen, recentEmojiIds, unmarkIsOpen, setShouldForceInsertEmoji,\n    isDisabled, baseEmojiKeywords, emojiKeywords, setFilteredEmojis,\n  ]);\n\n  const insertEmoji = useCallback((textEmoji: string, isForce?: boolean) => {\n    const currentHtml = htmlRef.current;\n    const atIndex = currentHtml.lastIndexOf(':', isForce ? currentHtml.lastIndexOf(':') - 1 : undefined);\n    if (atIndex !== -1) {\n      onUpdateHtml(`${currentHtml.substr(0, atIndex)}${renderText(textEmoji, ['emoji_html'])}`);\n      let messageInput: HTMLDivElement;\n      if (inputId === EDITABLE_INPUT_ID) {\n        messageInput = document.querySelector<HTMLDivElement>(EDITABLE_INPUT_CSS_SELECTOR)!;\n      } else {\n        messageInput = document.getElementById(inputId) as HTMLDivElement;\n      }\n      requestAnimationFrame(() => {\n        focusEditableElement(messageInput, true, true);\n      });\n    }\n\n    unmarkIsOpen();\n  }, [htmlRef, inputId, onUpdateHtml, unmarkIsOpen]);\n\n  const insertCustomEmoji = useCallback((emoji: ApiSticker, isForce?: boolean) => {\n    const currentHtml = htmlRef.current;\n    const atIndex = currentHtml.lastIndexOf(':', isForce ? currentHtml.lastIndexOf(':') - 1 : undefined);\n    if (atIndex !== -1) {\n      onUpdateHtml(`${currentHtml.substr(0, atIndex)}${buildCustomEmojiHtml(emoji)}`);\n      let messageInput: HTMLDivElement;\n      if (inputId === EDITABLE_INPUT_ID) {\n        messageInput = document.querySelector<HTMLDivElement>(EDITABLE_INPUT_CSS_SELECTOR)!;\n      } else {\n        messageInput = document.getElementById(inputId) as HTMLDivElement;\n      }\n      requestAnimationFrame(() => {\n        focusEditableElement(messageInput, true, true);\n      });\n    }\n\n    unmarkIsOpen();\n  }, [htmlRef, inputId, onUpdateHtml, unmarkIsOpen]);\n\n  useEffect(() => {\n    if (isOpen && shouldForceInsertEmoji && filteredEmojis.length) {\n      insertEmoji(filteredEmojis[0].native, true);\n    }\n  }, [filteredEmojis, insertEmoji, isOpen, shouldForceInsertEmoji]);\n\n  return {\n    isEmojiTooltipOpen: isOpen,\n    closeEmojiTooltip: unmarkIsOpen,\n    filteredEmojis,\n    filteredCustomEmojis,\n    insertEmoji,\n    insertCustomEmoji,\n  };\n}\n\nfunction getEmojiCode(html: string) {\n  const emojis = prepareForRegExp(html).match(RE_EMOJI_SEARCH);\n\n  return emojis ? emojis[0].trim() : undefined;\n}\n\nasync function ensureEmojiData() {\n  if (!emojiDataPromise) {\n    emojiDataPromise = import('emoji-data-ios/emoji-data.json') as unknown as Promise<EmojiModule>;\n    emojiRawData = (await emojiDataPromise).default;\n\n    emojiData = uncompressEmoji(emojiRawData);\n  }\n\n  return emojiDataPromise;\n}\n\nfunction prepareRecentEmojis(byId: Record<string, Emoji>, recentEmojiIds: string[], limit: number) {\n  if (!byId || !recentEmojiIds.length) {\n    return MEMO_EMPTY_ARRAY;\n  }\n\n  return Object.values(pickTruthy(byId, recentEmojiIds)).slice(0, limit);\n}\n\nfunction prepareLibrary(\n  byId: Record<string, Emoji>,\n  baseEmojiKeywords?: Record<string, string[]>,\n  emojiKeywords?: Record<string, string[]>,\n): Library {\n  const emojis = Object.values(byId);\n\n  const byNative = buildCollectionByKey<Emoji>(emojis, 'native');\n  const baseEmojisByKeyword = baseEmojiKeywords\n    ? mapValues(baseEmojiKeywords, (natives) => {\n      return Object.values(pickTruthy(byNative, natives));\n    })\n    : {};\n  const emojisByKeyword = emojiKeywords\n    ? mapValues(emojiKeywords, (natives) => {\n      return Object.values(pickTruthy(byNative, natives));\n    })\n    : {};\n\n  const byKeyword = { ...baseEmojisByKeyword, ...emojisByKeyword };\n  const keywords = ([] as string[]).concat(Object.keys(baseEmojisByKeyword), Object.keys(emojisByKeyword));\n\n  const byName = emojis.reduce((result, emoji) => {\n    emoji.names.forEach((name) => {\n      if (!result[name]) {\n        result[name] = [];\n      }\n\n      result[name].push(emoji);\n    });\n\n    return result;\n  }, {} as Record<string, Emoji[]>);\n\n  const names = Object.keys(byName);\n\n  return {\n    byKeyword,\n    keywords,\n    byName,\n    names,\n  };\n}\n\nfunction searchInLibrary(library: Library, filter: string, limit: number) {\n  const {\n    byKeyword, keywords, byName, names,\n  } = library;\n\n  let matched: Emoji[] = MEMO_EMPTY_ARRAY;\n\n  const matchedKeywords = keywords.filter((keyword) => keyword.startsWith(filter)).sort();\n  matched = matched.concat(Object.values(pickTruthy(byKeyword!, matchedKeywords)).flat());\n\n  // Also search by names, which is useful for non-English languages\n  const matchedNames = names.filter((name) => name.startsWith(filter));\n  matched = matched.concat(Object.values(pickTruthy(byName, matchedNames)).flat());\n\n  matched = unique(matched);\n\n  return matched.slice(0, limit);\n}\n","import {\n  useCallback, useEffect, useState,\n} from '../../../../lib/teact/teact';\nimport { getGlobal } from '../../../../global';\n\nimport type { ApiChatMember, ApiUser } from '../../../../api/types';\nimport { ApiMessageEntityTypes } from '../../../../api/types';\n\nimport { filterUsersByName, getUserFirstOrLastName } from '../../../../global/helpers';\nimport { prepareForRegExp } from '../helpers/prepareForRegExp';\nimport focusEditableElement from '../../../../util/focusEditableElement';\nimport { pickTruthy, unique } from '../../../../util/iteratees';\nimport { throttle } from '../../../../util/schedulers';\nimport { getHtmlBeforeSelection } from '../../../../util/selection';\n\nimport useFlag from '../../../../hooks/useFlag';\nimport useCacheBuster from '../../../../hooks/useCacheBuster';\nimport useOnSelectionChange from '../../../../hooks/useOnSelectionChange';\n\nconst runThrottled = throttle((cb) => cb(), 500, true);\nlet RE_USERNAME_SEARCH: RegExp;\n\ntry {\n  RE_USERNAME_SEARCH = /(^|\\s)@[-_\\p{L}\\p{M}\\p{N}]*$/gui;\n} catch (e) {\n  // Support for older versions of firefox\n  RE_USERNAME_SEARCH = /(^|\\s)@[-_\\d\\w-]*$/gi;\n}\n\nexport default function useMentionTooltip(\n  canSuggestMembers: boolean | undefined,\n  inputSelector: string,\n  onUpdateHtml: (html: string) => void,\n  groupChatMembers?: ApiChatMember[],\n  topInlineBotIds?: string[],\n  currentUserId?: string,\n) {\n  const [isOpen, markIsOpen, unmarkIsOpen] = useFlag();\n  const [htmlBeforeSelection, setHtmlBeforeSelection] = useState('');\n  const [usersToMention, setUsersToMention] = useState<ApiUser[] | undefined>();\n\n  const updateFilteredUsers = useCallback((filter, withInlineBots: boolean) => {\n    // No need for expensive global updates on users, so we avoid them\n    const usersById = getGlobal().users.byId;\n\n    if (!(groupChatMembers || topInlineBotIds) || !usersById) {\n      setUsersToMention(undefined);\n\n      return;\n    }\n\n    runThrottled(() => {\n      const memberIds = groupChatMembers?.reduce((acc: string[], member) => {\n        if (member.userId !== currentUserId) {\n          acc.push(member.userId);\n        }\n\n        return acc;\n      }, []);\n\n      const filteredIds = filterUsersByName(unique([\n        ...((withInlineBots && topInlineBotIds) || []),\n        ...(memberIds || []),\n      ]), usersById, filter);\n\n      setUsersToMention(Object.values(pickTruthy(usersById, filteredIds)));\n    });\n  }, [currentUserId, groupChatMembers, topInlineBotIds]);\n\n  const [cacheBuster, updateCacheBuster] = useCacheBuster();\n\n  const handleSelectionChange = useCallback((range: Range) => {\n    if (range.collapsed) {\n      updateCacheBuster(); // Update tooltip on cursor move\n    }\n  }, [updateCacheBuster]);\n\n  useOnSelectionChange(document.querySelector<HTMLDivElement>(inputSelector), handleSelectionChange);\n\n  useEffect(() => {\n    setHtmlBeforeSelection(getHtmlBeforeSelection(document.querySelector<HTMLDivElement>(inputSelector)!));\n  }, [inputSelector, cacheBuster]);\n\n  useEffect(() => {\n    if (!canSuggestMembers || !htmlBeforeSelection.length) {\n      unmarkIsOpen();\n      return;\n    }\n\n    const usernameFilter = htmlBeforeSelection.includes('@') && getUsernameFilter(htmlBeforeSelection);\n\n    if (usernameFilter) {\n      const filter = usernameFilter ? usernameFilter.substr(1) : '';\n      updateFilteredUsers(filter, canSuggestInlineBots(htmlBeforeSelection));\n    } else {\n      unmarkIsOpen();\n    }\n  }, [canSuggestMembers, updateFilteredUsers, markIsOpen, unmarkIsOpen, htmlBeforeSelection]);\n\n  useEffect(() => {\n    if (usersToMention?.length) {\n      markIsOpen();\n    } else {\n      unmarkIsOpen();\n    }\n  }, [markIsOpen, unmarkIsOpen, usersToMention]);\n\n  const insertMention = useCallback((user: ApiUser, forceFocus = false) => {\n    if (!user.username && !getUserFirstOrLastName(user)) {\n      return;\n    }\n\n    const insertedHtml = user.username\n      ? `@${user.username}`\n      : `<a\n          class=\"text-entity-link\"\n          data-entity-type=\"${ApiMessageEntityTypes.MentionName}\"\n          data-user-id=\"${user.id}\"\n          contenteditable=\"false\"\n          dir=\"auto\"\n        >${getUserFirstOrLastName(user)}</a>`;\n\n    const containerEl = document.querySelector<HTMLDivElement>(inputSelector)!;\n\n    const atIndex = htmlBeforeSelection.lastIndexOf('@');\n    if (atIndex !== -1) {\n      const newHtml = `${htmlBeforeSelection.substr(0, atIndex)}${insertedHtml}&nbsp;`;\n      const htmlAfterSelection = containerEl.innerHTML.substring(htmlBeforeSelection.length);\n      onUpdateHtml(`${newHtml}${htmlAfterSelection}`);\n\n      requestAnimationFrame(() => {\n        focusEditableElement(containerEl, forceFocus);\n      });\n    }\n\n    unmarkIsOpen();\n  }, [htmlBeforeSelection, inputSelector, onUpdateHtml, unmarkIsOpen]);\n\n  return {\n    isMentionTooltipOpen: isOpen,\n    closeMentionTooltip: unmarkIsOpen,\n    insertMention,\n    mentionFilteredUsers: usersToMention,\n  };\n}\n\nfunction getUsernameFilter(html: string) {\n  const username = prepareForRegExp(html).match(RE_USERNAME_SEARCH);\n\n  return username ? username[0].trim() : undefined;\n}\n\nfunction canSuggestInlineBots(html: string) {\n  return html.startsWith('@');\n}\n","import { useEffect, useRef } from '../../../lib/teact/teact';\n\nimport useOnChange from '../../../hooks/useOnChange';\nimport useForceUpdate from '../../../hooks/useForceUpdate';\n\nexport default function useAsyncRendering<T extends any[]>(dependencies: T, delay?: number) {\n  const isDisabled = delay === undefined;\n  const shouldRenderRef = useRef(isDisabled);\n  const timeoutRef = useRef<number>();\n  const forceUpdate = useForceUpdate();\n\n  useOnChange(() => {\n    if (isDisabled) {\n      return;\n    }\n\n    shouldRenderRef.current = false;\n\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n      timeoutRef.current = undefined;\n    }\n  }, dependencies);\n\n  useEffect(() => {\n    if (isDisabled || shouldRenderRef.current) {\n      return;\n    }\n\n    const exec = () => {\n      shouldRenderRef.current = true;\n      forceUpdate();\n    };\n\n    if (delay! > 0) {\n      timeoutRef.current = window.setTimeout(exec, delay);\n    } else {\n      exec();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n\n  return shouldRenderRef.current;\n}\n","import type { ChangeEvent } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { useCallback, memo, useState } from '../../lib/teact/teact';\n\nimport Checkbox from './Checkbox';\n\ntype IRadioOption = {\n  label: string;\n  subLabel?: string;\n  value: string;\n};\n\ntype OwnProps = {\n  id?: string;\n  options: IRadioOption[];\n  selected?: string[];\n  disabled?: boolean;\n  round?: boolean;\n  loadingOptions?: string[];\n  onChange: (value: string[]) => void;\n};\n\nconst CheckboxGroup: FC<OwnProps> = ({\n  id,\n  options,\n  selected = [],\n  disabled,\n  round,\n  loadingOptions,\n  onChange,\n}) => {\n  const [values, setValues] = useState<string[]>(selected || []);\n\n  const handleChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\n    const { value, checked } = event.currentTarget;\n    let newValues: string[];\n    if (checked) {\n      newValues = [...values, value];\n    } else {\n      newValues = values.filter((v) => v !== value);\n    }\n\n    setValues(newValues);\n    onChange(newValues);\n  }, [onChange, values]);\n\n  return (\n    <div id={id} className=\"radio-group\">\n      {options.map((option) => (\n        <Checkbox\n          label={option.label}\n          subLabel={option.subLabel}\n          value={option.value}\n          checked={selected.indexOf(option.value) !== -1}\n          disabled={disabled}\n          round={round}\n          isLoading={loadingOptions ? loadingOptions.indexOf(option.value) !== -1 : undefined}\n          onChange={handleChange}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default memo(CheckboxGroup);\n","import type { FC, TeactNode } from '../../lib/teact/teact';\nimport React, { memo, useCallback, useRef } from '../../lib/teact/teact';\n\nimport type { TextPart } from '../../types';\n\nimport useLang from '../../hooks/useLang';\nimport useKeyboardListNavigation from '../../hooks/useKeyboardListNavigation';\n\nimport Modal from './Modal';\nimport Button from './Button';\n\ntype OwnProps = {\n  isOpen: boolean;\n  onClose: () => void;\n  onCloseAnimationEnd?: () => void;\n  title?: string;\n  header?: TeactNode;\n  textParts?: TextPart[];\n  text?: string;\n  confirmLabel?: string;\n  confirmHandler: () => void;\n  confirmIsDestructive?: boolean;\n  isButtonsInOneRow?: boolean;\n  children?: React.ReactNode;\n};\n\nconst ConfirmDialog: FC<OwnProps> = ({\n  isOpen,\n  onClose,\n  onCloseAnimationEnd,\n  title,\n  header,\n  text,\n  textParts,\n  confirmLabel = 'Confirm',\n  confirmHandler,\n  confirmIsDestructive,\n  isButtonsInOneRow,\n  children,\n}) => {\n  const lang = useLang();\n\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const handleSelectWithEnter = useCallback((index: number) => {\n    if (index === -1) confirmHandler();\n  }, [confirmHandler]);\n\n  const handleKeyDown = useKeyboardListNavigation(containerRef, isOpen, handleSelectWithEnter, '.Button');\n\n  return (\n    <Modal\n      className=\"confirm\"\n      title={title || lang('Telegram')}\n      header={header}\n      isOpen={isOpen}\n      onClose={onClose}\n      onCloseAnimationEnd={onCloseAnimationEnd}\n    >\n      {text && text.split('\\\\n').map((textPart) => (\n        <p>{textPart}</p>\n      ))}\n      {textParts || children}\n      <div className={isButtonsInOneRow ? 'dialog-buttons mt-2' : ''} ref={containerRef} onKeyDown={handleKeyDown}>\n        <Button\n          className=\"confirm-dialog-button\"\n          isText\n          onClick={confirmHandler}\n          color={confirmIsDestructive ? 'danger' : 'primary'}\n        >\n          {confirmLabel}\n        </Button>\n        <Button className=\"confirm-dialog-button\" isText onClick={onClose}>{lang('Cancel')}</Button>\n      </div>\n    </Modal>\n  );\n};\n\nexport default memo(ConfirmDialog);\n","import React from '../../lib/teact/teact';\n\nimport type { FC } from '../../lib/teact/teact';\nimport type { OwnProps as ButtonProps } from './Button';\n\nimport buildClassName from '../../util/buildClassName';\nimport useLang from '../../hooks/useLang';\n\nimport Button from './Button';\n\nimport './FloatingActionButton.scss';\n\ntype OwnProps = {\n  isShown: boolean;\n  className?: string;\n  color?: ButtonProps['color'];\n  ariaLabel?: ButtonProps['ariaLabel'];\n  disabled?: boolean;\n  onClick: () => void;\n  children: React.ReactNode;\n};\n\nconst FloatingActionButton: FC<OwnProps> = ({\n  isShown,\n  className,\n  color = 'primary',\n  ariaLabel,\n  disabled,\n  onClick,\n  children,\n}) => {\n  const lang = useLang();\n\n  const buttonClassName = buildClassName(\n    'FloatingActionButton',\n    isShown && 'revealed',\n    className,\n  );\n\n  return (\n    <Button\n      className={buttonClassName}\n      color={color}\n      round\n      disabled={disabled}\n      onClick={isShown && !disabled ? onClick : undefined}\n      ariaLabel={ariaLabel}\n      tabIndex={-1}\n      isRtl={lang.isRtl}\n    >\n      {children}\n    </Button>\n  );\n};\n\nexport default FloatingActionButton;\n","import type { RefObject } from 'react';\nimport type { FC, TeactNode } from '../../lib/teact/teact';\nimport React, { useRef, useCallback } from '../../lib/teact/teact';\n\nimport { IS_TOUCH_ENV } from '../../util/environment';\nimport { fastRaf } from '../../util/schedulers';\nimport buildClassName from '../../util/buildClassName';\nimport useContextMenuHandlers from '../../hooks/useContextMenuHandlers';\nimport useContextMenuPosition from '../../hooks/useContextMenuPosition';\nimport useFlag from '../../hooks/useFlag';\nimport useLang from '../../hooks/useLang';\n\nimport RippleEffect from './RippleEffect';\nimport Menu from './Menu';\nimport MenuItem from './MenuItem';\nimport Button from './Button';\n\nimport './ListItem.scss';\n\ninterface MenuItemContextAction {\n  title: string;\n  icon: string;\n  destructive?: boolean;\n  handler?: () => void;\n}\n\ninterface OwnProps {\n  ref?: RefObject<HTMLDivElement>;\n  buttonRef?: RefObject<HTMLDivElement>;\n  icon?: string;\n  leftElement?: TeactNode;\n  secondaryIcon?: string;\n  rightElement?: TeactNode;\n  buttonClassName?: string;\n  className?: string;\n  style?: string;\n  children: React.ReactNode;\n  disabled?: boolean;\n  allowDisabledClick?: boolean;\n  ripple?: boolean;\n  narrow?: boolean;\n  inactive?: boolean;\n  focus?: boolean;\n  destructive?: boolean;\n  multiline?: boolean;\n  isStatic?: boolean;\n  contextActions?: MenuItemContextAction[];\n  onMouseDown?: (e: React.MouseEvent<HTMLDivElement>) => void;\n  onClick?: (e: React.MouseEvent<HTMLDivElement>) => void;\n  onSecondaryIconClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;\n  onDragEnter?: (e: React.DragEvent<HTMLDivElement>) => void;\n}\n\nconst ListItem: FC<OwnProps> = ({\n  ref,\n  buttonRef,\n  icon,\n  leftElement,\n  buttonClassName,\n  secondaryIcon,\n  rightElement,\n  className,\n  style,\n  children,\n  disabled,\n  allowDisabledClick,\n  ripple,\n  narrow,\n  inactive,\n  focus,\n  destructive,\n  multiline,\n  isStatic,\n  contextActions,\n  onMouseDown,\n  onClick,\n  onSecondaryIconClick,\n  onDragEnter,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  let containerRef = useRef<HTMLDivElement>(null);\n  if (ref) {\n    containerRef = ref;\n  }\n  const [isTouched, markIsTouched, unmarkIsTouched] = useFlag();\n\n  const {\n    isContextMenuOpen, contextMenuPosition,\n    handleBeforeContextMenu, handleContextMenu,\n    handleContextMenuClose, handleContextMenuHide,\n  } = useContextMenuHandlers(containerRef, !contextActions);\n\n  const getTriggerElement = useCallback(() => containerRef.current, []);\n\n  const getRootElement = useCallback(\n    () => containerRef.current!.closest('.custom-scroll'),\n    [],\n  );\n\n  const getMenuElement = useCallback(\n    () => containerRef.current!.querySelector('.ListItem-context-menu .bubble'),\n    [],\n  );\n\n  const {\n    positionX, positionY, transformOriginX, transformOriginY, style: menuStyle,\n  } = useContextMenuPosition(\n    contextMenuPosition,\n    getTriggerElement,\n    getRootElement,\n    getMenuElement,\n  );\n\n  const handleClick = useCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if ((disabled && !allowDisabledClick) || !onClick) {\n      return;\n    }\n    onClick(e);\n\n    if (IS_TOUCH_ENV && !ripple) {\n      markIsTouched();\n      fastRaf(unmarkIsTouched);\n    }\n  }, [allowDisabledClick, disabled, markIsTouched, onClick, ripple, unmarkIsTouched]);\n\n  const handleSecondaryIconClick = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n    if ((disabled && !allowDisabledClick) || e.button !== 0 || (!onSecondaryIconClick && !contextActions)) return;\n    e.stopPropagation();\n    if (onSecondaryIconClick) {\n      onSecondaryIconClick(e);\n    } else {\n      handleContextMenu(e);\n    }\n  };\n\n  const handleMouseDown = useCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (inactive || IS_TOUCH_ENV) {\n      return;\n    }\n    if (contextActions && (e.button === 2 || !onClick)) {\n      handleBeforeContextMenu(e);\n    }\n    if (e.button === 0) {\n      if (!onClick) {\n        handleContextMenu(e);\n      } else {\n        handleClick(e);\n      }\n    }\n  }, [inactive, contextActions, onClick, handleBeforeContextMenu, handleContextMenu, handleClick]);\n\n  const lang = useLang();\n\n  const fullClassName = buildClassName(\n    'ListItem',\n    className,\n    !isStatic && 'no-selection',\n    ripple && 'has-ripple',\n    narrow && 'narrow',\n    disabled && 'disabled',\n    allowDisabledClick && 'click-allowed',\n    inactive && 'inactive',\n    contextMenuPosition && 'has-menu-open',\n    focus && 'focus',\n    destructive && 'destructive',\n    multiline && 'multiline',\n    isStatic && 'is-static',\n  );\n\n  return (\n    <div\n      ref={containerRef}\n      className={fullClassName}\n      dir={lang.isRtl ? 'rtl' : undefined}\n      style={style}\n      onMouseDown={onMouseDown}\n      onDragEnter={onDragEnter}\n    >\n      <div\n        className={buildClassName('ListItem-button', isTouched && 'active', buttonClassName)}\n        role={!isStatic ? 'button' : undefined}\n        ref={buttonRef}\n        tabIndex={!isStatic ? 0 : undefined}\n        onClick={(!inactive && IS_TOUCH_ENV) ? handleClick : undefined}\n        onMouseDown={handleMouseDown}\n        onContextMenu={(!inactive && contextActions) ? handleContextMenu : undefined}\n      >\n        {leftElement}\n        {icon && (\n          <i className={`icon-${icon}`} />\n        )}\n        {multiline && (<div className=\"multiline-item\">{children}</div>)}\n        {!multiline && children}\n        {!disabled && !inactive && ripple && (\n          <RippleEffect />\n        )}\n        {secondaryIcon && (\n          <Button\n            className=\"secondary-icon\"\n            round\n            color=\"translucent\"\n            size=\"smaller\"\n            onClick={IS_TOUCH_ENV ? handleSecondaryIconClick : undefined}\n            onMouseDown={!IS_TOUCH_ENV ? handleSecondaryIconClick : undefined}\n          >\n            <i className={`icon-${secondaryIcon}`} />\n          </Button>\n        )}\n        {rightElement}\n      </div>\n      {contextActions && contextMenuPosition !== undefined && (\n        <Menu\n          isOpen={isContextMenuOpen}\n          transformOriginX={transformOriginX}\n          transformOriginY={transformOriginY}\n          positionX={positionX}\n          positionY={positionY}\n          style={menuStyle}\n          className=\"ListItem-context-menu\"\n          autoClose\n          onClose={handleContextMenuClose}\n          onCloseAnimationEnd={handleContextMenuHide}\n        >\n          {contextActions.map((action) => (\n            <MenuItem\n              key={action.title}\n              icon={action.icon}\n              destructive={action.destructive}\n              disabled={!action.handler}\n              onClick={action.handler}\n            >\n              {action.title}\n            </MenuItem>\n          ))}\n        </Menu>\n      )}\n    </div>\n  );\n};\n\nexport default ListItem;\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"GC8g9Q16IaK76g6rcU78\"};","import React from '../../lib/teact/teact';\n\nimport type { FC } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport styles from './MenuSeparator.module.scss';\n\ntype OwnProps = {\n  className?: string;\n};\n\nconst MenuSeparator: FC<OwnProps> = ({ className }) => {\n  return (\n    <div className={buildClassName(styles.root, className)} />\n  );\n};\n\nexport default MenuSeparator;\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from '../../lib/teact/teact';\n\nimport type { TextPart } from '../../types';\n\nimport { ANIMATION_END_DELAY } from '../../config';\nimport useShowTransition from '../../hooks/useShowTransition';\nimport buildClassName from '../../util/buildClassName';\nimport captureEscKeyListener from '../../util/captureEscKeyListener';\n\nimport Portal from './Portal';\nimport Button from './Button';\n\nimport './Notification.scss';\n\ntype OwnProps = {\n  title?: TextPart[];\n  containerId?: string;\n  message: TextPart[];\n  duration?: number;\n  onDismiss: () => void;\n  action?: VoidFunction;\n  actionText?: string;\n  className?: string;\n};\n\nconst DEFAULT_DURATION = 3000;\nconst ANIMATION_DURATION = 150;\n\nconst Notification: FC<OwnProps> = ({\n  title, className,\n  message, duration = DEFAULT_DURATION, containerId, onDismiss,\n  action, actionText,\n}) => {\n  const [isOpen, setIsOpen] = useState(true);\n  // eslint-disable-next-line no-null/no-null\n  const timerRef = useRef<number | undefined>(null);\n  const { transitionClassNames } = useShowTransition(isOpen);\n\n  const closeAndDismiss = useCallback(() => {\n    setIsOpen(false);\n    setTimeout(onDismiss, ANIMATION_DURATION + ANIMATION_END_DELAY);\n  }, [onDismiss]);\n\n  function handleClick() {\n    action?.();\n    closeAndDismiss();\n  }\n\n  useEffect(() => (isOpen ? captureEscKeyListener(closeAndDismiss) : undefined), [isOpen, closeAndDismiss]);\n\n  useEffect(() => {\n    timerRef.current = window.setTimeout(closeAndDismiss, duration);\n\n    return () => {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n        timerRef.current = undefined;\n      }\n    };\n  }, [duration, closeAndDismiss]);\n\n  const handleMouseEnter = useCallback(() => {\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n      timerRef.current = undefined;\n    }\n  }, []);\n\n  const handleMouseLeave = useCallback(() => {\n    timerRef.current = window.setTimeout(closeAndDismiss, duration);\n  }, [duration, closeAndDismiss]);\n\n  return (\n    <Portal className=\"Notification-container\" containerId={containerId}>\n      <div\n        className={buildClassName('Notification', transitionClassNames, className)}\n        onClick={handleClick}\n        onMouseEnter={handleMouseEnter}\n        onMouseLeave={handleMouseLeave}\n      >\n        <div className=\"content\">\n          {title && <div className=\"notification-title\">{title}</div>}\n          {message}\n        </div>\n        {action && actionText && (\n          <Button\n            color=\"translucent-white\"\n            onClick={action}\n            className=\"Notification-button\"\n          >\n            {actionText}\n          </Button>\n        )}\n      </div>\n    </Portal>\n  );\n};\n\nexport default Notification;\n","import type { FC } from '../../lib/teact/teact';\nimport React, { useEffect, useRef, memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport './ProgressSpinner.scss';\n\nconst RADIUSES = {\n  s: 22, m: 25, l: 28, xl: 20,\n};\nconst STROKE_WIDTH = 2;\nconst MIN_PROGRESS = 0.05;\nconst MAX_PROGRESS = 1;\n\nconst ProgressSpinner: FC<{\n  progress?: number;\n  size?: 's' | 'm' | 'l' | 'xl';\n  square?: boolean;\n  transparent?: boolean;\n  noCross?: boolean;\n  onClick?: (e: React.MouseEvent<HTMLElement, MouseEvent>) => void;\n}> = ({\n  progress = 0,\n  size = 'l',\n  square,\n  transparent,\n  noCross,\n  onClick,\n}) => {\n  const radius = RADIUSES[size];\n  const circleRadius = radius - STROKE_WIDTH * 2;\n  const borderRadius = radius - 1;\n  const circumference = circleRadius * 2 * Math.PI;\n  // eslint-disable-next-line no-null/no-null\n  const container = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (!container.current) {\n      return;\n    }\n\n    const svg = container.current.firstElementChild;\n    const strokeDashOffset = circumference - Math.min(Math.max(MIN_PROGRESS, progress), MAX_PROGRESS) * circumference;\n\n    if (!svg) {\n      container.current.innerHTML = `<svg\n        viewBox=\"0 0 ${borderRadius * 2} ${borderRadius * 2}\"\n        height=\"${borderRadius * 2}\"\n        width=\"${borderRadius * 2}\"\n      >\n        <circle\n          stroke=\"white\"\n          fill=\"transparent\"\n          stroke-width=${STROKE_WIDTH}\n          stroke-dasharray=\"${circumference} ${circumference}\"}\n          stroke-dashoffset=\"${strokeDashOffset}\"\n          stroke-linecap=\"round\"\n          r=${circleRadius}\n          cx=${borderRadius}\n          cy=${borderRadius}\n        />\n      </svg>`;\n    } else {\n      (svg.firstElementChild as SVGElement).setAttribute('stroke-dashoffset', strokeDashOffset.toString());\n    }\n  }, [container, circumference, borderRadius, circleRadius, progress]);\n\n  const className = buildClassName(\n    `ProgressSpinner size-${size}`,\n    transparent && 'transparent',\n    square && 'square',\n    noCross && 'no-cross',\n  );\n\n  return (\n    <div\n      ref={container}\n      className={className}\n      onClick={onClick}\n    />\n  );\n};\n\nexport default memo(ProgressSpinner);\n","import type { ChangeEvent } from 'react';\nimport type { FC, TeactNode } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport useLang from '../../hooks/useLang';\n\nimport Spinner from './Spinner';\n\nimport './Radio.scss';\n\ntype OwnProps = {\n  id?: string;\n  name: string;\n  label: TeactNode;\n  subLabel?: string;\n  value: string;\n  checked: boolean;\n  disabled?: boolean;\n  hidden?: boolean;\n  isLoading?: boolean;\n  onChange: (e: ChangeEvent<HTMLInputElement>) => void;\n};\n\nconst Radio: FC<OwnProps> = ({\n  id,\n  label,\n  subLabel,\n  value,\n  name,\n  checked,\n  disabled,\n  hidden,\n  isLoading,\n  onChange,\n}) => {\n  const lang = useLang();\n  const className = buildClassName(\n    'Radio',\n    disabled && 'disabled',\n    hidden && 'hidden-widget',\n    isLoading && 'loading',\n  );\n\n  return (\n    <label className={className} dir={lang.isRtl ? 'rtl' : undefined}>\n      <input\n        type=\"radio\"\n        name={name}\n        value={value}\n        id={id}\n        checked={checked}\n        onChange={onChange}\n        disabled={disabled || hidden}\n      />\n      <div className=\"Radio-main\">\n        <span className=\"label\" dir={lang.isRtl ? 'auto' : undefined}>{label}</span>\n        {subLabel && <span className=\"subLabel\" dir={lang.isRtl ? 'auto' : undefined}>{subLabel}</span>}\n      </div>\n      {isLoading && <Spinner />}\n    </label>\n  );\n};\n\nexport default memo(Radio);\n","import type { ChangeEvent } from 'react';\nimport type { FC, TeactNode } from '../../lib/teact/teact';\nimport React, { useCallback, memo } from '../../lib/teact/teact';\n\nimport Radio from './Radio';\n\nexport type IRadioOption = {\n  label: TeactNode;\n  subLabel?: string;\n  value: string;\n  hidden?: boolean;\n};\n\ntype OwnProps = {\n  id?: string;\n  name: string;\n  options: IRadioOption[];\n  selected?: string;\n  disabled?: boolean;\n  loadingOption?: string;\n  onChange: (value: string, event: ChangeEvent<HTMLInputElement>) => void;\n};\n\nconst RadioGroup: FC<OwnProps> = ({\n  id,\n  name,\n  options,\n  selected,\n  disabled,\n  loadingOption,\n  onChange,\n}) => {\n  const handleChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.currentTarget;\n    onChange(value, event);\n  }, [onChange]);\n\n  return (\n    <div id={id} className=\"radio-group\">\n      {options.map((option) => (\n        <Radio\n          name={name}\n          label={option.label}\n          subLabel={option.subLabel}\n          value={option.value}\n          checked={option.value === selected}\n          hidden={option.hidden}\n          disabled={disabled}\n          isLoading={loadingOption ? loadingOption === option.value : undefined}\n          onChange={handleChange}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default memo(RadioGroup);\n","import type { ChangeEvent } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { useCallback, useMemo, memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport useLang from '../../hooks/useLang';\n\nimport './RangeSlider.scss';\n\ntype OwnProps = {\n  options?: string[];\n  min?: number;\n  max?: number;\n  step?: number;\n  label?: string;\n  value: number;\n  disabled?: boolean;\n  bold?: boolean;\n  className?: string;\n  renderValue?: (value: number) => string;\n  onChange: (value: number) => void;\n};\n\nconst RangeSlider: FC<OwnProps> = ({\n  options,\n  min = 0,\n  max = options ? options.length - 1 : 100,\n  step = 1,\n  label,\n  value,\n  disabled,\n  bold,\n  className,\n  renderValue,\n  onChange,\n}) => {\n  const lang = useLang();\n  const handleChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\n    onChange(Number(event.currentTarget.value));\n  }, [onChange]);\n\n  const mainClassName = buildClassName(\n    className,\n    'RangeSlider',\n    disabled && 'disabled',\n    bold && 'bold',\n  );\n\n  const trackWidth = useMemo(() => {\n    if (options) {\n      return (value / (options.length - 1)) * 100;\n    } else {\n      const possibleValuesLength = (max - min) / step;\n      return ((value - min) / possibleValuesLength) * 100;\n    }\n  }, [options, value, max, min, step]);\n\n  return (\n    <div className={mainClassName}>\n      {label && (\n        <div className=\"slider-top-row\" dir={lang.isRtl ? 'rtl' : undefined}>\n          <span className=\"label\" dir=\"auto\">{label}</span>\n          {!options && (\n            <span className=\"value\" dir=\"auto\">{renderValue ? renderValue(value) : value}</span>\n          )}\n        </div>\n      )}\n      <div className=\"slider-main\">\n        <div\n          className=\"slider-fill-track\"\n          style={`width: ${trackWidth}%`}\n        />\n        <input\n          min={min}\n          max={max}\n          value={value}\n          step={step}\n          type=\"range\"\n          className=\"RangeSlider__input\"\n          onChange={handleChange}\n        />\n        {options && (\n          <div className=\"slider-options\">\n            {options.map((option, index) => (\n              <div\n                className={buildClassName('slider-option no-selection', index === value && 'active')}\n                onClick={() => onChange(index)}\n              >\n                {option}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(RangeSlider);\n","import type { RefObject } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, {\n  useRef, useEffect, memo, useCallback,\n} from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport useFlag from '../../hooks/useFlag';\nimport useLang from '../../hooks/useLang';\nimport useInputFocusOnOpen from '../../hooks/useInputFocusOnOpen';\n\nimport Loading from './Loading';\nimport Button from './Button';\nimport ShowTransition from './ShowTransition';\n\nimport './SearchInput.scss';\n\ntype OwnProps = {\n  ref?: RefObject<HTMLInputElement>;\n  children?: React.ReactNode;\n  parentContainerClassName?: string;\n  className?: string;\n  inputId?: string;\n  value?: string;\n  focused?: boolean;\n  isLoading?: boolean;\n  spinnerColor?: 'yellow';\n  spinnerBackgroundColor?: 'light';\n  placeholder?: string;\n  disabled?: boolean;\n  autoComplete?: string;\n  canClose?: boolean;\n  autoFocusSearch?: boolean;\n  onChange: (value: string) => void;\n  onReset?: NoneToVoidFunction;\n  onFocus?: NoneToVoidFunction;\n  onBlur?: NoneToVoidFunction;\n  onSpinnerClick?: NoneToVoidFunction;\n};\n\nconst SearchInput: FC<OwnProps> = ({\n  ref,\n  children,\n  parentContainerClassName,\n  value,\n  inputId,\n  className,\n  focused,\n  isLoading,\n  spinnerColor,\n  spinnerBackgroundColor,\n  placeholder,\n  disabled,\n  autoComplete,\n  canClose,\n  autoFocusSearch,\n  onChange,\n  onReset,\n  onFocus,\n  onBlur,\n  onSpinnerClick,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  let inputRef = useRef<HTMLInputElement>(null);\n  if (ref) {\n    inputRef = ref;\n  }\n\n  const [isInputFocused, markInputFocused, unmarkInputFocused] = useFlag(focused);\n\n  useInputFocusOnOpen(inputRef, autoFocusSearch, unmarkInputFocused);\n\n  useEffect(() => {\n    if (!inputRef.current) {\n      return;\n    }\n\n    if (focused) {\n      inputRef.current.focus();\n    } else {\n      inputRef.current.blur();\n    }\n  }, [focused, placeholder]); // Trick for setting focus when selecting a contact to search for\n\n  const lang = useLang();\n\n  function handleChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const { currentTarget } = event;\n    onChange(currentTarget.value);\n  }\n\n  function handleFocus() {\n    markInputFocused();\n    if (onFocus) {\n      onFocus();\n    }\n  }\n\n  function handleBlur() {\n    unmarkInputFocused();\n    if (onBlur) {\n      onBlur();\n    }\n  }\n\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\n    if (e.key === 'ArrowDown' || e.key === 'Enter') {\n      const element = document.querySelector(`.${parentContainerClassName} .ListItem-button`) as HTMLElement;\n      if (element) {\n        element.focus();\n      }\n    }\n  }, [parentContainerClassName]);\n\n  return (\n    <div\n      className={buildClassName('SearchInput', className, isInputFocused && 'has-focus')}\n      dir={lang.isRtl ? 'rtl' : undefined}\n    >\n      {children}\n      <input\n        ref={inputRef}\n        id={inputId}\n        type=\"text\"\n        dir=\"auto\"\n        placeholder={placeholder || lang('Search')}\n        className=\"form-control\"\n        value={value}\n        disabled={disabled}\n        autoComplete={autoComplete}\n        onChange={handleChange}\n        onFocus={handleFocus}\n        onBlur={handleBlur}\n        onKeyDown={handleKeyDown}\n      />\n      <i className=\"icon-search\" />\n      <ShowTransition isOpen={Boolean(isLoading)} className=\"slow\">\n        <Loading color={spinnerColor} backgroundColor={spinnerBackgroundColor} onClick={onSpinnerClick} />\n      </ShowTransition>\n      {!isLoading && (value || canClose) && onReset && (\n        <Button\n          round\n          size=\"tiny\"\n          color=\"translucent\"\n          onClick={onReset}\n        >\n          <span className=\"icon-close\" />\n        </Button>\n      )}\n    </div>\n  );\n};\n\nexport default memo(SearchInput);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { useRef } from '../../lib/teact/teact';\n\nimport useShowTransition from '../../hooks/useShowTransition';\nimport usePrevious from '../../hooks/usePrevious';\nimport buildClassName from '../../util/buildClassName';\n\ntype OwnProps = {\n  isOpen: boolean;\n  isCustom?: boolean;\n  isHidden?: boolean;\n  id?: string;\n  className?: string;\n  onClick?: (e: React.MouseEvent<HTMLElement, MouseEvent>) => void;\n  noCloseTransition?: boolean;\n  children: React.ReactNode;\n};\n\nconst ShowTransition: FC<OwnProps> = ({\n  isOpen,\n  isHidden,\n  isCustom,\n  id,\n  className,\n  onClick,\n  children,\n  noCloseTransition,\n}) => {\n  const {\n    shouldRender,\n    transitionClassNames,\n  } = useShowTransition(\n    isOpen && !isHidden, undefined, undefined, isCustom ? false : undefined, noCloseTransition,\n  );\n  const prevIsOpen = usePrevious(isOpen);\n  const prevChildren = usePrevious(children);\n  const fromChildrenRef = useRef<React.ReactNode>();\n\n  if (prevIsOpen && !isOpen) {\n    fromChildrenRef.current = prevChildren;\n  }\n\n  return (\n    (shouldRender || isHidden) && (\n      <div id={id} className={buildClassName(className, transitionClassNames)} onClick={onClick}>\n        {isOpen ? children : fromChildrenRef.current!}\n      </div>\n    )\n  );\n};\n\nexport default ShowTransition;\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\n\nimport './Skeleton.scss';\n\ntype OwnProps = {\n  variant?: 'rectangular' | 'rounded-rect' | 'round';\n  animation?: 'wave' | 'pulse';\n  width?: number;\n  height?: number;\n  forceAspectRatio?: boolean;\n  inline?: boolean;\n  className?: string;\n};\n\nconst Skeleton: FC<OwnProps> = ({\n  variant = 'rectangular',\n  animation = 'wave',\n  width,\n  height,\n  forceAspectRatio,\n  inline,\n  className,\n}) => {\n  const classNames = buildClassName('Skeleton', variant, animation, className, inline && 'inline');\n  const aspectRatio = (width && height) ? `aspect-ratio: ${width}/${height}` : undefined;\n  const style = forceAspectRatio ? aspectRatio\n    : buildStyle(Boolean(width) && `width: ${width}px`, Boolean(height) && `height: ${height}px`);\n  return (\n    <div className={classNames} style={style}>{inline && '\\u00A0'}</div>\n  );\n};\n\nexport default Skeleton;\n","import type { ChangeEvent } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { memo, useCallback } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport './Switcher.scss';\n\ntype OwnProps = {\n  id?: string;\n  name?: string;\n  value?: string;\n  label: string;\n  checked?: boolean;\n  disabled?: boolean;\n  inactive?: boolean;\n  noAnimation?: boolean;\n  onChange?: (e: ChangeEvent<HTMLInputElement>) => void;\n  onCheck?: (isChecked: boolean) => void;\n};\n\nconst Switcher: FC<OwnProps> = ({\n  id,\n  name,\n  value,\n  label,\n  checked = false,\n  disabled,\n  inactive,\n  noAnimation,\n  onChange,\n  onCheck,\n}) => {\n  const handleChange = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    if (onChange) {\n      onChange(e);\n    }\n\n    if (onCheck) {\n      onCheck(e.currentTarget.checked);\n    }\n  }, [onChange, onCheck]);\n\n  const className = buildClassName(\n    'Switcher',\n    disabled && 'disabled',\n    inactive && 'inactive',\n    noAnimation && 'no-animation',\n  );\n\n  return (\n    <label className={className} title={label}>\n      <input\n        type=\"checkbox\"\n        id={id}\n        name={name}\n        value={value}\n        checked={checked}\n        disabled={disabled}\n        onChange={handleChange}\n      />\n      <span className=\"widget\" />\n    </label>\n  );\n};\n\nexport default memo(Switcher);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { useRef, memo, useEffect } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport forceReflow from '../../util/forceReflow';\nimport renderText from '../common/helpers/renderText';\n\nimport './Tab.scss';\n\ntype OwnProps = {\n  className?: string;\n  title: string;\n  isActive?: boolean;\n  isBlocked?: boolean;\n  badgeCount?: number;\n  isBadgeActive?: boolean;\n  previousActiveTab?: number;\n  onClick: (arg: number) => void;\n  clickArg: number;\n};\n\nconst classNames = {\n  active: 'Tab--active',\n  badgeActive: 'Tab__badge--active',\n};\n\nconst Tab: FC<OwnProps> = ({\n  className,\n  title,\n  isActive,\n  isBlocked,\n  badgeCount,\n  isBadgeActive,\n  previousActiveTab,\n  onClick,\n  clickArg,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const tabRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    // Set initial active state\n    if (isActive && previousActiveTab === undefined && tabRef.current) {\n      tabRef.current.classList.add(classNames.active);\n    }\n\n    if (!isActive || previousActiveTab === undefined) {\n      return;\n    }\n\n    const tabEl = tabRef.current!;\n    const prevTabEl = tabEl.parentElement!.children[previousActiveTab];\n    if (!prevTabEl) {\n      return;\n    }\n\n    const platformEl = tabEl.querySelector<HTMLElement>('.platform')!;\n    const prevPlatformEl = prevTabEl.querySelector<HTMLElement>('.platform')!;\n\n    // We move and resize the platform, so it repeats the position and size of the previous one\n    const shiftLeft = prevPlatformEl.parentElement!.offsetLeft - platformEl.parentElement!.offsetLeft;\n    const scaleFactor = prevPlatformEl.clientWidth / platformEl.clientWidth;\n\n    prevPlatformEl.classList.remove('animate');\n    platformEl.classList.remove('animate');\n    platformEl.style.transform = `translate3d(${shiftLeft}px, 0, 0) scale3d(${scaleFactor}, 1, 1)`;\n    forceReflow(platformEl);\n    platformEl.classList.add('animate');\n    platformEl.style.transform = 'none';\n\n    prevTabEl.classList.remove(classNames.active);\n    tabEl.classList.add(classNames.active);\n  }, [isActive, previousActiveTab]);\n\n  return (\n    <div\n      className={buildClassName('Tab', className)}\n      onClick={() => onClick(clickArg)}\n      ref={tabRef}\n    >\n      <span>\n        {renderText(title)}\n        {Boolean(badgeCount) && (\n          <span className={buildClassName('badge', isBadgeActive && classNames.badgeActive)}>{badgeCount}</span>\n        )}\n        {isBlocked && <i className=\"icon-lock-badge blocked\" />}\n        <i className=\"platform\" />\n      </span>\n    </div>\n  );\n};\n\nexport default memo(Tab);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useRef, useEffect } from '../../lib/teact/teact';\n\nimport { ALL_FOLDER_ID } from '../../config';\nimport { IS_ANDROID, IS_IOS } from '../../util/environment';\nimport fastSmoothScrollHorizontal from '../../util/fastSmoothScrollHorizontal';\n\nimport usePrevious from '../../hooks/usePrevious';\nimport useHorizontalScroll from '../../hooks/useHorizontalScroll';\nimport useLang from '../../hooks/useLang';\n\nimport Tab from './Tab';\n\nimport './TabList.scss';\n\nexport type TabWithProperties = {\n  id?: number;\n  title: string;\n  badgeCount?: number;\n  isBlocked?: boolean;\n  isBadgeActive?: boolean;\n};\n\ntype OwnProps = {\n  tabs: readonly TabWithProperties[];\n  areFolders?: boolean;\n  activeTab: number;\n  big?: boolean;\n  onSwitchTab: (index: number) => void;\n};\n\nconst TAB_SCROLL_THRESHOLD_PX = 16;\n// Should match duration from `--slide-transition` CSS variable\nconst SCROLL_DURATION = IS_IOS ? 450 : IS_ANDROID ? 400 : 300;\n\nconst TabList: FC<OwnProps> = ({\n  tabs, areFolders, activeTab, big, onSwitchTab,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n  const previousActiveTab = usePrevious(activeTab);\n\n  useHorizontalScroll(containerRef.current, undefined, true);\n\n  // Scroll container to place active tab in the center\n  useEffect(() => {\n    const container = containerRef.current!;\n    const { scrollWidth, offsetWidth, scrollLeft } = container;\n    if (scrollWidth <= offsetWidth) {\n      return;\n    }\n\n    const activeTabElement = container.childNodes[activeTab] as HTMLElement | null;\n    if (!activeTabElement) {\n      return;\n    }\n\n    const { offsetLeft: activeTabOffsetLeft, offsetWidth: activeTabOffsetWidth } = activeTabElement;\n    const newLeft = activeTabOffsetLeft - (offsetWidth / 2) + (activeTabOffsetWidth / 2);\n\n    // Prevent scrolling by only a couple of pixels, which doesn't look smooth\n    if (Math.abs(newLeft - scrollLeft) < TAB_SCROLL_THRESHOLD_PX) {\n      return;\n    }\n\n    fastSmoothScrollHorizontal(container, newLeft, SCROLL_DURATION);\n  }, [activeTab]);\n\n  const lang = useLang();\n\n  return (\n    <div\n      className={`TabList no-selection no-scrollbar ${big ? 'big' : ''}`}\n      ref={containerRef}\n      dir={lang.isRtl ? 'rtl' : undefined}\n    >\n      {tabs.map((tab, i) => (\n        <Tab\n          key={tab.id ?? tab.title}\n          // TODO Remove dependency on usage context\n          title={(!areFolders || tab.id === ALL_FOLDER_ID) ? lang(tab.title) : tab.title}\n          isActive={i === activeTab}\n          isBlocked={tab.isBlocked}\n          badgeCount={tab.badgeCount}\n          isBadgeActive={tab.isBadgeActive}\n          previousActiveTab={previousActiveTab}\n          onClick={onSwitchTab}\n          clickArg={i}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default memo(TabList);\n","import type { StateReducer, Dispatch } from '../useReducer';\nimport useReducer from '../useReducer';\nimport type { ApiChatFolder } from '../../api/types';\nimport { pick, omit } from '../../util/iteratees';\n\nexport type FolderChatType = {\n  icon: string;\n  title: string;\n  key: keyof Pick<ApiChatFolder, (\n    'contacts' | 'nonContacts' | 'groups' | 'channels' | 'bots' |\n    'excludeMuted' | 'excludeArchived' | 'excludeRead'\n  )>;\n};\n\nexport const INCLUDED_CHAT_TYPES: FolderChatType[] = [\n  { icon: 'user', title: 'FilterContacts', key: 'contacts' },\n  { icon: 'non-contacts', title: 'FilterNonContacts', key: 'nonContacts' },\n  { icon: 'group', title: 'FilterGroups', key: 'groups' },\n  { icon: 'channel', title: 'FilterChannels', key: 'channels' },\n  { icon: 'bots', title: 'FilterBots', key: 'bots' },\n];\n\nexport const EXCLUDED_CHAT_TYPES: FolderChatType[] = [\n  { icon: 'mute', title: 'FilterMuted', key: 'excludeMuted' },\n  { icon: 'archive', title: 'FilterArchived', key: 'excludeArchived' },\n  { icon: 'readchats', title: 'FilterRead', key: 'excludeRead' },\n];\n\nconst INCLUDE_FILTER_FIELDS: Array<keyof FolderIncludeFilters> = [\n  'includedChatIds', 'bots', 'channels', 'groups', 'contacts', 'nonContacts',\n];\nconst EXCLUDE_FILTER_FIELDS: Array<keyof FolderExcludeFilters> = [\n  'excludedChatIds', 'excludeArchived', 'excludeMuted', 'excludeRead',\n];\n\nexport function selectChatFilters(state: FoldersState, mode: 'included' | 'excluded', selectTemp?: boolean) {\n  let selectedChatIds: string[] = [];\n  let selectedChatTypes: FolderChatType['key'][] = [];\n\n  if (mode === 'included') {\n    const {\n      includedChatIds,\n      ...includeFilters\n    } = selectTemp\n      ? state.includeFilters || {}\n      : pick(\n        state.folder,\n        INCLUDE_FILTER_FIELDS,\n      );\n\n    selectedChatIds = includedChatIds || [];\n    selectedChatTypes = (Object.keys(includeFilters) as Array<keyof typeof includeFilters>)\n      .filter((key) => Boolean(includeFilters[key]));\n  } else {\n    const {\n      excludedChatIds,\n      ...excludeFilters\n    } = selectTemp\n      ? state.excludeFilters || {}\n      : pick(\n        state.folder,\n        EXCLUDE_FILTER_FIELDS,\n      );\n\n    selectedChatIds = excludedChatIds || [];\n    selectedChatTypes = (Object.keys(excludeFilters) as Array<keyof typeof excludeFilters>)\n      .filter((key) => Boolean(excludeFilters[key]));\n  }\n\n  return {\n    selectedChatIds,\n    selectedChatTypes,\n  };\n}\n\nfunction getSuggestedFolderName(includeFilters?: FolderIncludeFilters) {\n  if (includeFilters) {\n    const {\n      includedChatIds,\n      ...filters\n    } = includeFilters;\n\n    if (\n      Object.values(filters).filter(Boolean).length > 1\n      || (includedChatIds?.length)\n    ) {\n      return '';\n    }\n\n    if (filters.bots) {\n      return 'Bots';\n    } else if (filters.groups) {\n      return 'Groups';\n    } else if (filters.channels) {\n      return 'Channels';\n    } else if (filters.contacts) {\n      return 'Contacts';\n    } else if (filters.nonContacts) {\n      return 'Non-Contacts';\n    }\n  }\n\n  return '';\n}\n\ntype FolderIncludeFilters = Pick<ApiChatFolder, (\n  'includedChatIds' | 'bots' | 'channels' | 'groups' | 'contacts' | 'nonContacts'\n)>;\ntype FolderExcludeFilters = Pick<ApiChatFolder, 'excludedChatIds' | 'excludeArchived' | 'excludeMuted' | 'excludeRead'>;\n\nexport type FoldersState = {\n  mode: 'create' | 'edit';\n  isLoading?: boolean;\n  isTouched?: boolean;\n  error?: string;\n  folderId?: number;\n  chatFilter: string;\n  folder: Omit<ApiChatFolder, 'id' | 'description' | 'emoticon'>;\n  includeFilters?: FolderIncludeFilters;\n  excludeFilters?: FolderExcludeFilters;\n};\nexport type FoldersActions = (\n  'setTitle' | 'saveFilters' | 'editFolder' | 'reset' | 'setChatFilter' | 'setIsLoading' | 'setError' |\n  'editIncludeFilters' | 'editExcludeFilters' | 'setIncludeFilters' | 'setExcludeFilters'\n);\nexport type FolderEditDispatch = Dispatch<FoldersActions>;\n\nconst INITIAL_STATE: FoldersState = {\n  mode: 'create',\n  chatFilter: '',\n  folder: {\n    title: '',\n    includedChatIds: [],\n    excludedChatIds: [],\n  },\n};\n\nconst foldersReducer: StateReducer<FoldersState, FoldersActions> = (\n  state,\n  action,\n) => {\n  switch (action.type) {\n    case 'setTitle':\n      return {\n        ...state,\n        folder: {\n          ...state.folder,\n          title: action.payload,\n        },\n        isTouched: true,\n      };\n    case 'editIncludeFilters':\n      return {\n        ...state,\n        includeFilters: pick(\n          state.folder,\n          INCLUDE_FILTER_FIELDS,\n        ),\n      };\n    case 'editExcludeFilters':\n      return {\n        ...state,\n        excludeFilters: pick(\n          state.folder,\n          EXCLUDE_FILTER_FIELDS,\n        ),\n      };\n    case 'setIncludeFilters':\n      return {\n        ...state,\n        includeFilters: action.payload,\n        chatFilter: '',\n      };\n    case 'setExcludeFilters':\n      return {\n        ...state,\n        excludeFilters: action.payload,\n        chatFilter: '',\n      };\n    case 'saveFilters':\n      if (state.includeFilters) {\n        return {\n          ...state,\n          folder: {\n            ...omit(state.folder, INCLUDE_FILTER_FIELDS),\n            title: state.folder.title ? state.folder.title : getSuggestedFolderName(state.includeFilters),\n            ...state.includeFilters,\n          },\n          includeFilters: undefined,\n          chatFilter: '',\n          isTouched: true,\n        };\n      } else if (state.excludeFilters) {\n        return {\n          ...state,\n          folder: {\n            ...omit(state.folder, EXCLUDE_FILTER_FIELDS),\n            ...state.excludeFilters,\n          },\n          excludeFilters: undefined,\n          chatFilter: '',\n          isTouched: true,\n        };\n      } else {\n        return state;\n      }\n    case 'editFolder': {\n      const { id: folderId, description, ...folder } = action.payload;\n\n      return {\n        mode: 'edit',\n        folderId,\n        folder,\n        chatFilter: '',\n      };\n    }\n    case 'setChatFilter': {\n      return {\n        ...state,\n        chatFilter: action.payload,\n      };\n    }\n    case 'setIsLoading': {\n      return {\n        ...state,\n        isLoading: action.payload,\n      };\n    }\n    case 'setError': {\n      return {\n        ...state,\n        error: action.payload,\n      };\n    }\n    case 'reset':\n      return INITIAL_STATE;\n    default:\n      return state;\n  }\n};\n\nconst useFoldersReducer = () => {\n  return useReducer(foldersReducer, INITIAL_STATE);\n};\n\nexport default useFoldersReducer;\n","import {\n  useCallback, useEffect, useRef, useState,\n} from '../lib/teact/teact';\nimport { getActions, getGlobal } from '../global';\n\nimport { PLAYBACK_RATE_FOR_AUDIO_MIN_DURATION } from '../config';\nimport type { Track, TrackId } from '../util/audioPlayer';\nimport { register } from '../util/audioPlayer';\nimport { isSafariPatchInProgress } from '../util/patchSafariProgressiveAudio';\nimport type { MediaSessionHandlers } from '../util/mediaSession';\nimport {\n  registerMediaSession, setPlaybackState, setPositionState, updateMetadata,\n} from '../util/mediaSession';\n\nimport useEffectWithPrevDeps from './useEffectWithPrevDeps';\nimport useOnChange from './useOnChange';\n\ntype Handler = (e: Event) => void;\n\nconst DEFAULT_SKIP_TIME = 10;\n\nconst useAudioPlayer = (\n  trackId: TrackId,\n  originalDuration: number, // Sometimes incorrect for voice messages\n  trackType: Track['type'],\n  src?: string,\n  handlers?: Record<string, Handler>,\n  metadata?: MediaMetadata,\n  onInit?: (element: HTMLAudioElement) => void,\n  shouldPlay = false,\n  onForcePlay?: NoneToVoidFunction,\n  onTrackChange?: NoneToVoidFunction,\n  noPlaylist = false,\n  noProgressUpdates = false,\n) => {\n  // eslint-disable-next-line no-null/no-null\n  const controllerRef = useRef<ReturnType<typeof register>>(null);\n\n  const [isPlaying, setIsPlaying] = useState(false);\n  let isPlayingSync = isPlaying;\n\n  const [playProgress, setPlayProgress] = useState<number>(0);\n\n  const handleTrackChange = useCallback(() => {\n    setIsPlaying(false);\n    if (onTrackChange) onTrackChange();\n  }, [onTrackChange]);\n\n  useOnChange(() => {\n    controllerRef.current = register(trackId, trackType, (eventName, e) => {\n      switch (eventName) {\n        case 'onPlay': {\n          const {\n            setVolume, setPlaybackRate, toggleMuted, proxy,\n          } = controllerRef.current!;\n          setIsPlaying(true);\n\n          registerMediaSession(metadata, makeMediaHandlers(controllerRef));\n          setPlaybackState('playing');\n          setVolume(getGlobal().audioPlayer.volume);\n          toggleMuted(Boolean(getGlobal().audioPlayer.isMuted));\n          const duration = proxy.duration && Number.isFinite(proxy.duration) ? proxy.duration : originalDuration;\n          if (trackType === 'voice' || duration > PLAYBACK_RATE_FOR_AUDIO_MIN_DURATION) {\n            setPlaybackRate(getGlobal().audioPlayer.playbackRate);\n          }\n\n          setPositionState({\n            duration: proxy.duration || 0,\n            playbackRate: proxy.playbackRate,\n            position: proxy.currentTime,\n          });\n          break;\n        }\n        case 'onRateChange': {\n          const { proxy } = controllerRef.current!;\n          setPositionState({\n            duration: proxy.duration || 0,\n            playbackRate: proxy.playbackRate,\n            position: proxy.currentTime,\n          });\n          break;\n        }\n        case 'onPause':\n          setIsPlaying(false);\n          setPlaybackState('paused');\n          break;\n        case 'onTimeUpdate': {\n          const { proxy } = controllerRef.current!;\n          const duration = proxy.duration && Number.isFinite(proxy.duration) ? proxy.duration : originalDuration;\n          if (!noProgressUpdates) setPlayProgress(proxy.currentTime / duration);\n          break;\n        }\n        case 'onEnded': {\n          setPlaybackState('paused');\n          break;\n        }\n      }\n\n      handlers?.[eventName]?.(e);\n    }, onForcePlay, handleTrackChange);\n\n    const { proxy } = controllerRef.current!;\n\n    if (!isPlaying && !proxy.paused) {\n      setIsPlaying(true);\n      isPlayingSync = true;\n    }\n\n    if (onInit) {\n      onInit(proxy);\n    }\n  }, [trackId]);\n\n  useEffect(() => {\n    if (isPlaying && metadata) updateMetadata(metadata);\n  }, [metadata, isPlaying]);\n\n  const {\n    play,\n    pause,\n    setCurrentTime,\n    proxy,\n    destroy,\n    setVolume,\n    stop,\n    isFirst,\n    isLast,\n    requestNextTrack,\n    requestPreviousTrack,\n    setPlaybackRate,\n    toggleMuted,\n  } = controllerRef.current!;\n  const duration = proxy.duration && Number.isFinite(proxy.duration) ? proxy.duration : originalDuration;\n\n  // RAF progress\n  useEffect(() => {\n    if (duration && !isSafariPatchInProgress(proxy) && !noProgressUpdates) {\n      setPlayProgress(proxy.currentTime / duration);\n    }\n  }, [duration, playProgress, proxy, noProgressUpdates]);\n\n  // Cleanup\n  useEffect(() => () => {\n    destroy(noPlaylist);\n  }, [destroy, noPlaylist]);\n\n  // Autoplay once `src` is present\n  useEffectWithPrevDeps(([prevShouldPlay, prevSrc]) => {\n    if (prevShouldPlay === shouldPlay && src === prevSrc) {\n      return;\n    }\n\n    // When paused by another player\n    if (proxy.src && proxy.paused) {\n      return;\n    }\n\n    if (shouldPlay && src && !isPlaying) {\n      play(src);\n    }\n  }, [shouldPlay, src, isPlaying, play, proxy.src, proxy.paused]);\n\n  const playIfPresent = useCallback(() => {\n    if (src) {\n      play(src);\n    }\n  }, [src, play]);\n\n  const playPause = useCallback(() => {\n    if (isPlaying) {\n      pause();\n    } else {\n      playIfPresent();\n    }\n  }, [pause, playIfPresent, isPlaying]);\n\n  const setTime = useCallback((time: number) => {\n    setCurrentTime(time);\n    if (duration) {\n      setPlayProgress(proxy.currentTime / duration);\n    }\n  }, [duration, proxy, setCurrentTime]);\n\n  return {\n    isPlaying: isPlayingSync,\n    playProgress,\n    playPause,\n    pause,\n    play: playIfPresent,\n    stop,\n    setCurrentTime: setTime,\n    setVolume,\n    audioProxy: proxy,\n    duration,\n    requestNextTrack,\n    requestPreviousTrack,\n    isFirst,\n    isLast,\n    setPlaybackRate,\n    toggleMuted,\n  };\n};\n\nfunction makeMediaHandlers(controllerRef: React.RefObject<ReturnType<typeof register>>) {\n  let mediaHandlers: MediaSessionHandlers = {};\n  if (controllerRef && controllerRef.current) {\n    const {\n      play, pause, setCurrentTime, proxy, requestNextTrack, requestPreviousTrack, isFirst, isLast,\n    } = controllerRef.current;\n    mediaHandlers = {\n      play: () => {\n        play(proxy.src);\n      },\n      pause: () => {\n        pause();\n      },\n      stop: () => {\n        pause();\n        setCurrentTime(0);\n        getActions().closeAudioPlayer();\n      },\n      seekbackward: (event) => {\n        const skipTime = event.seekOffset || DEFAULT_SKIP_TIME;\n        setCurrentTime(Math.max(proxy.currentTime - skipTime, 0));\n      },\n      seekforward: (event) => {\n        const skipTime = event.seekOffset || DEFAULT_SKIP_TIME;\n        setCurrentTime(Math.min(proxy.currentTime + skipTime, proxy.duration));\n      },\n      seekTo: (event) => {\n        if (event.seekTime) {\n          setCurrentTime(event.seekTime);\n        }\n      },\n    };\n\n    if (!isLast()) {\n      mediaHandlers.nexttrack = () => {\n        requestNextTrack();\n      };\n    }\n    if (!isFirst()) {\n      mediaHandlers.previoustrack = () => {\n        requestPreviousTrack();\n      };\n    }\n  }\n  return mediaHandlers;\n}\n\nexport default useAudioPlayer;\n","import { useCallback, useState } from '../lib/teact/teact';\n\nconst useCacheBuster = () => {\n  const [cacheBuster, setCacheBuster] = useState<boolean>(false);\n\n  const updateCacheBuster = useCallback(() => {\n    setCacheBuster((current) => !current);\n  }, []);\n\n  return [cacheBuster, updateCacheBuster] as const;\n};\n\nexport default useCacheBuster;\n","import { useEffect, useRef } from '../lib/teact/teact';\n\nimport { IS_CANVAS_FILTER_SUPPORTED } from '../util/environment';\nimport fastBlur from '../lib/fastBlur';\n\nconst RADIUS = 2;\nconst ITERATIONS = 2;\n\nexport default function useCanvasBlur(\n  dataUri?: string,\n  isDisabled = false,\n  withRaf?: boolean,\n  radius = RADIUS,\n  preferredWidth?: number,\n  preferredHeight?: number,\n) {\n  // eslint-disable-next-line no-null/no-null\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const isStarted = useRef();\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n\n    if (!dataUri || !canvas || isDisabled || isStarted.current) {\n      return;\n    }\n\n    isStarted.current = true;\n\n    const img = new Image();\n\n    const processBlur = () => {\n      canvas.width = preferredWidth || img.width;\n      canvas.height = preferredHeight || img.height;\n\n      const ctx = canvas.getContext('2d', { alpha: false })!;\n\n      if (IS_CANVAS_FILTER_SUPPORTED) {\n        ctx.filter = `blur(${radius}px)`;\n      }\n\n      ctx.drawImage(img, -radius * 2, -radius * 2, canvas.width + radius * 4, canvas.height + radius * 4);\n\n      if (!IS_CANVAS_FILTER_SUPPORTED) {\n        fastBlur(ctx, 0, 0, canvas.width, canvas.height, radius, ITERATIONS);\n      }\n    };\n\n    img.onload = () => {\n      if (withRaf) {\n        requestAnimationFrame(processBlur);\n      } else {\n        processBlur();\n      }\n    };\n\n    img.src = dataUri;\n  }, [dataUri, isDisabled, preferredHeight, preferredWidth, radius, withRaf]);\n\n  return canvasRef;\n}\n","import { useMemo } from '../lib/teact/teact';\nimport { getActions } from '../global';\n\nimport type { ApiChat, ApiUser } from '../api/types';\n\nimport { SERVICE_NOTIFICATIONS_USER_ID } from '../config';\nimport {\n  isChatArchived, getCanDeleteChat, isUserId, isChatChannel, isChatGroup,\n} from '../global/helpers';\nimport { compact } from '../util/iteratees';\nimport useLang from './useLang';\n\nconst useChatContextActions = ({\n  chat,\n  user,\n  folderId,\n  isPinned,\n  isMuted,\n  canChangeFolder,\n  handleDelete,\n  handleChatFolderChange,\n  handleReport,\n}: {\n  chat: ApiChat | undefined;\n  user: ApiUser | undefined;\n  folderId?: number;\n  isPinned?: boolean;\n  isMuted?: boolean;\n  canChangeFolder?: boolean;\n  handleDelete: () => void;\n  handleChatFolderChange: () => void;\n  handleReport?: () => void;\n}, isInSearch = false) => {\n  const lang = useLang();\n\n  const { isSelf } = user || {};\n  const isServiceNotifications = user?.id === SERVICE_NOTIFICATIONS_USER_ID;\n\n  return useMemo(() => {\n    if (!chat) {\n      return undefined;\n    }\n\n    const {\n      toggleChatPinned,\n      updateChatMutedState,\n      toggleChatArchived,\n      toggleChatUnread,\n    } = getActions();\n\n    const actionAddToFolder = canChangeFolder ? {\n      title: lang('ChatList.Filter.AddToFolder'),\n      icon: 'folder',\n      handler: handleChatFolderChange,\n    } : undefined;\n\n    const actionPin = isPinned\n      ? {\n        title: lang('UnpinFromTop'),\n        icon: 'unpin',\n        handler: () => toggleChatPinned({ id: chat.id, folderId }),\n      }\n      : { title: lang('PinToTop'), icon: 'pin', handler: () => toggleChatPinned({ id: chat.id, folderId }) };\n\n    if (isInSearch) {\n      return compact([actionPin, actionAddToFolder]);\n    }\n\n    const actionUnreadMark = chat.unreadCount || chat.hasUnreadMark\n      ? { title: lang('MarkAsRead'), icon: 'readchats', handler: () => toggleChatUnread({ id: chat.id }) }\n      : { title: lang('MarkAsUnread'), icon: 'unread', handler: () => toggleChatUnread({ id: chat.id }) };\n\n    const actionMute = isMuted\n      ? {\n        title: lang('ChatList.Unmute'),\n        icon: 'unmute',\n        handler: () => updateChatMutedState({ chatId: chat.id, isMuted: false }),\n      }\n      : {\n        title: lang('ChatList.Mute'),\n        icon: 'mute',\n        handler: () => updateChatMutedState({ chatId: chat.id, isMuted: true }),\n      };\n\n    const actionArchive = isChatArchived(chat)\n      ? { title: lang('Unarchive'), icon: 'unarchive', handler: () => toggleChatArchived({ id: chat.id }) }\n      : { title: lang('Archive'), icon: 'archive', handler: () => toggleChatArchived({ id: chat.id }) };\n\n    const canReport = handleReport && (isChatChannel(chat) || isChatGroup(chat) || (user && !user.isSelf));\n    const actionReport = canReport\n      ? { title: lang('ReportPeer.Report'), icon: 'flag', handler: handleReport }\n      : undefined;\n\n    const actionDelete = {\n      title: isUserId(chat.id)\n        ? lang('Delete')\n        : lang(getCanDeleteChat(chat)\n          ? 'DeleteChat'\n          : (isChatChannel(chat) ? 'LeaveChannel' : 'Group.LeaveGroup')),\n      icon: 'delete',\n      destructive: true,\n      handler: handleDelete,\n    };\n\n    const isInFolder = folderId !== undefined;\n\n    return compact([\n      actionAddToFolder,\n      actionUnreadMark,\n      actionPin,\n      !isSelf && actionMute,\n      !isSelf && !isServiceNotifications && !isInFolder && actionArchive,\n      actionReport,\n      actionDelete,\n    ]);\n  }, [\n    chat, user, canChangeFolder, lang, handleChatFolderChange, isPinned, isInSearch, isMuted,\n    handleDelete, handleReport, folderId, isSelf, isServiceNotifications,\n  ]);\n};\n\nexport default useChatContextActions;\n","import type { RefObject } from 'react';\nimport { useState, useEffect, useCallback } from '../lib/teact/teact';\n\nimport type { IAnchorPosition } from '../types';\nimport {\n  IS_TOUCH_ENV, IS_PWA, IS_IOS,\n} from '../util/environment';\n\nconst LONG_TAP_DURATION_MS = 200;\n\nfunction stopEvent(e: Event) {\n  e.stopImmediatePropagation();\n  e.preventDefault();\n  e.stopPropagation();\n}\n\nconst useContextMenuHandlers = (\n  elementRef: RefObject<HTMLElement>,\n  isMenuDisabled?: boolean,\n  shouldDisableOnLink?: boolean,\n  shouldDisableOnLongTap?: boolean,\n) => {\n  const [isContextMenuOpen, setIsContextMenuOpen] = useState(false);\n  const [contextMenuPosition, setContextMenuPosition] = useState<IAnchorPosition | undefined>(undefined);\n\n  const handleBeforeContextMenu = useCallback((e: React.MouseEvent) => {\n    if (!isMenuDisabled && e.button === 2) {\n      (e.target as HTMLElement).classList.add('no-selection');\n    }\n  }, [isMenuDisabled]);\n\n  const handleContextMenu = useCallback((e: React.MouseEvent) => {\n    (e.target as HTMLElement).classList.remove('no-selection');\n\n    if (isMenuDisabled || (shouldDisableOnLink && (e.target as HTMLElement).matches('a[href]'))) {\n      return;\n    }\n    e.preventDefault();\n\n    if (contextMenuPosition) {\n      return;\n    }\n\n    setIsContextMenuOpen(true);\n    setContextMenuPosition({ x: e.clientX, y: e.clientY });\n  }, [isMenuDisabled, shouldDisableOnLink, contextMenuPosition]);\n\n  const handleContextMenuClose = useCallback(() => {\n    setIsContextMenuOpen(false);\n  }, []);\n\n  const handleContextMenuHide = useCallback(() => {\n    setContextMenuPosition(undefined);\n  }, []);\n\n  // Support context menu on touch devices\n  useEffect(() => {\n    if (isMenuDisabled || !IS_TOUCH_ENV || shouldDisableOnLongTap) {\n      return undefined;\n    }\n\n    const element = elementRef.current;\n    if (!element) {\n      return undefined;\n    }\n\n    let timer: number | undefined;\n\n    const clearLongPressTimer = () => {\n      if (timer) {\n        clearTimeout(timer);\n        timer = undefined;\n      }\n    };\n\n    const emulateContextMenuEvent = (originalEvent: TouchEvent) => {\n      clearLongPressTimer();\n\n      const { clientX, clientY, target } = originalEvent.touches[0];\n\n      if (contextMenuPosition || (shouldDisableOnLink && (target as HTMLElement).matches('a[href]'))) {\n        return;\n      }\n\n      // Temporarily intercept and clear the next click\n      element.addEventListener('touchend', function cancelClickOnce(e) {\n        element.removeEventListener('touchend', cancelClickOnce, true);\n        stopEvent(e);\n      }, true);\n\n      // On iOS15, in PWA mode, the context menu immediately closes after opening\n      if (IS_PWA && IS_IOS) {\n        element.addEventListener('mousedown', function cancelClickOnce(e) {\n          element.removeEventListener('mousedown', cancelClickOnce, true);\n          stopEvent(e);\n        }, true);\n      }\n\n      setIsContextMenuOpen(true);\n      setContextMenuPosition({ x: clientX, y: clientY });\n    };\n\n    const startLongPressTimer = (e: TouchEvent) => {\n      if (isMenuDisabled) {\n        return;\n      }\n      clearLongPressTimer();\n\n      timer = window.setTimeout(() => emulateContextMenuEvent(e), LONG_TAP_DURATION_MS);\n    };\n\n    // @perf Consider event delegation\n    element.addEventListener('touchstart', startLongPressTimer, { passive: true });\n    element.addEventListener('touchcancel', clearLongPressTimer, true);\n    element.addEventListener('touchend', clearLongPressTimer, true);\n    element.addEventListener('touchmove', clearLongPressTimer, { passive: true });\n\n    return () => {\n      clearLongPressTimer();\n      element.removeEventListener('touchstart', startLongPressTimer);\n      element.removeEventListener('touchcancel', clearLongPressTimer, true);\n      element.removeEventListener('touchend', clearLongPressTimer, true);\n      element.removeEventListener('touchmove', clearLongPressTimer);\n    };\n  }, [contextMenuPosition, isMenuDisabled, shouldDisableOnLongTap, elementRef, shouldDisableOnLink]);\n\n  return {\n    isContextMenuOpen,\n    contextMenuPosition,\n    handleBeforeContextMenu,\n    handleContextMenu,\n    handleContextMenuClose,\n    handleContextMenuHide,\n  };\n};\n\nexport default useContextMenuHandlers;\n","import { useState, useEffect } from '../lib/teact/teact';\nimport type { IAnchorPosition } from '../types';\n\ninterface Layout {\n  extraPaddingX?: number;\n  extraTopPadding?: number;\n  marginSides?: number;\n  extraMarginTop?: number;\n}\n\nconst MENU_POSITION_VISUAL_COMFORT_SPACE_PX = 16;\nconst MENU_POSITION_BOTTOM_MARGIN = 12;\nconst EMPTY_RECT = {\n  width: 0, left: 0, height: 0, top: 0,\n};\n\nexport default function useContextMenuPosition(\n  anchor: IAnchorPosition | undefined,\n  getTriggerElement: () => HTMLElement | null,\n  getRootElement: () => HTMLElement | null,\n  getMenuElement: () => HTMLElement | null,\n  getLayout?: () => Layout,\n) {\n  const [positionX, setPositionX] = useState<'right' | 'left'>('right');\n  const [positionY, setPositionY] = useState<'top' | 'bottom'>('bottom');\n  const [transformOriginX, setTransformOriginX] = useState<number>();\n  const [transformOriginY, setTransformOriginY] = useState<number>();\n  const [withScroll, setWithScroll] = useState(false);\n  const [style, setStyle] = useState('');\n  const [menuStyle, setMenuStyle] = useState('opacity: 0;');\n\n  useEffect(() => {\n    const triggerEl = getTriggerElement();\n    if (!anchor || !triggerEl) {\n      return;\n    }\n\n    let { x, y } = anchor;\n    const anchorX = x;\n    const anchorY = y;\n\n    const menuEl = getMenuElement();\n    const rootEl = getRootElement();\n\n    const {\n      extraPaddingX = 0,\n      extraTopPadding = 0,\n      marginSides = 0,\n      extraMarginTop = 0,\n    } = getLayout?.() || {};\n\n    const marginTop = menuEl ? parseInt(getComputedStyle(menuEl).marginTop, 10) + extraMarginTop : undefined;\n\n    const menuRect = menuEl ? {\n      width: menuEl.offsetWidth,\n      height: menuEl.offsetHeight + marginTop!,\n    } : EMPTY_RECT;\n\n    const rootRect = rootEl ? rootEl.getBoundingClientRect() : EMPTY_RECT;\n\n    let horizontalPosition: 'left' | 'right';\n    let verticalPosition: 'top' | 'bottom';\n    if (x + menuRect.width + extraPaddingX < rootRect.width + rootRect.left) {\n      x += 3;\n      horizontalPosition = 'left';\n    } else if (x - menuRect.width > 0) {\n      horizontalPosition = 'right';\n      x -= 3;\n    } else {\n      horizontalPosition = 'left';\n      x = 16;\n    }\n    setPositionX(horizontalPosition);\n\n    if (marginSides\n      && horizontalPosition === 'right' && (x + extraPaddingX + marginSides >= rootRect.width + rootRect.left)) {\n      x -= marginSides;\n    }\n\n    if (marginSides && horizontalPosition === 'left') {\n      if (x + extraPaddingX + marginSides + menuRect.width >= rootRect.width + rootRect.left) {\n        x -= marginSides;\n      } else if (x - marginSides <= 0) {\n        x += marginSides;\n      }\n    }\n\n    if (y + menuRect.height < rootRect.height + rootRect.top) {\n      verticalPosition = 'top';\n    } else {\n      verticalPosition = 'bottom';\n\n      if (y - menuRect.height < rootRect.top + extraTopPadding) {\n        y = rootRect.top + rootRect.height;\n      }\n    }\n    setPositionY(verticalPosition);\n\n    const triggerRect = triggerEl.getBoundingClientRect();\n    const left = horizontalPosition === 'left'\n      ? Math.min(x - triggerRect.left, rootRect.width - menuRect.width - MENU_POSITION_VISUAL_COMFORT_SPACE_PX)\n      : (x - triggerRect.left);\n    const top = y - triggerRect.top;\n\n    const menuMaxHeight = rootRect.height - MENU_POSITION_BOTTOM_MARGIN - (marginTop || 0);\n\n    setWithScroll(menuMaxHeight < menuRect.height);\n    setMenuStyle(`max-height: ${menuMaxHeight}px;`);\n    setStyle(`left: ${left}px; top: ${top}px`);\n    const offsetX = (anchorX - triggerRect.left) - left;\n    const offsetY = (anchorY - triggerRect.top) - top - (marginTop || 0);\n    setTransformOriginX(horizontalPosition === 'left' ? offsetX : menuRect.width + offsetX);\n    setTransformOriginY(verticalPosition === 'bottom' ? menuRect.height + offsetY : offsetY);\n  }, [\n    anchor, getMenuElement, getRootElement, getTriggerElement, getLayout,\n  ]);\n\n  return {\n    positionX,\n    positionY,\n    transformOriginX,\n    transformOriginY,\n    style,\n    menuStyle,\n    withScroll,\n  };\n}\n","import { useEffect, useMemo } from '../lib/teact/teact';\nimport { getActions } from '../global';\n\nimport type { ApiMessage } from '../api/types';\n\nimport { throttle } from '../util/schedulers';\n\nconst useEnsureMessage = (\n  chatId: string,\n  messageId?: number,\n  message?: ApiMessage,\n  replyOriginForId?: number,\n) => {\n  const { loadMessage } = getActions();\n  const loadMessageThrottled = useMemo(() => {\n    const throttled = throttle(loadMessage, 500, true);\n    return () => {\n      throttled({ chatId, messageId, replyOriginForId });\n    };\n  }, [loadMessage, chatId, messageId, replyOriginForId]);\n\n  useEffect(() => {\n    if (messageId && !message) {\n      loadMessageThrottled();\n    }\n  });\n};\n\nexport default useEnsureMessage;\n","import { useEffect } from '../lib/teact/teact';\n\nimport {\n  getOrderedIds,\n  getUnreadCounters,\n  getChatsCount,\n  addOrderedIdsCallback,\n  addUnreadCountersCallback,\n  addChatsCountCallback,\n} from '../util/folderManager';\nimport useForceUpdate from './useForceUpdate';\n\nexport function useFolderManagerForOrderedIds(folderId: number) {\n  const forceUpdate = useForceUpdate();\n\n  useEffect(() => addOrderedIdsCallback(folderId, forceUpdate), [folderId, forceUpdate]);\n\n  return getOrderedIds(folderId);\n}\n\nexport function useFolderManagerForUnreadCounters() {\n  const forceUpdate = useForceUpdate();\n\n  useEffect(() => addUnreadCountersCallback(forceUpdate), [forceUpdate]);\n\n  return getUnreadCounters();\n}\n\nexport function useFolderManagerForChatsCount() {\n  const forceUpdate = useForceUpdate();\n\n  useEffect(() => addChatsCountCallback(forceUpdate), [forceUpdate]);\n\n  return getChatsCount();\n}\n","import { useEffect } from '../lib/teact/teact';\n\nconst useHorizontalScroll = (container: HTMLElement | null, isDisabled?: boolean, shouldPreventDefault = false) => {\n  useEffect(() => {\n    if (!container || isDisabled) {\n      return undefined;\n    }\n\n    function handleScroll(e: WheelEvent) {\n      // Ignore horizontal scroll and let it work natively (e.g. on touchpad)\n      if (!e.deltaX) {\n        container!.scrollLeft += e.deltaY / 4;\n        if (shouldPreventDefault) e.preventDefault();\n      }\n    }\n\n    container.addEventListener('wheel', handleScroll, { passive: !shouldPreventDefault });\n\n    return () => {\n      container.removeEventListener('wheel', handleScroll);\n    };\n  }, [container, isDisabled, shouldPreventDefault]);\n};\n\nexport default useHorizontalScroll;\n","import { useEffect } from '../lib/teact/teact';\nimport { getHotkeyMatcher } from '../util/parseHotkey';\nimport { createCallbackManager } from '../util/callbacks';\n\nconst IGNORE_TAGS = new Set(['INPUT', 'TEXTAREA', 'SELECT']);\n\nconst handlers = createCallbackManager();\ndocument.documentElement.addEventListener('keydown', handlers.runCallbacks);\n\nexport function useHotkeys(hotkeys?: Record<string, (e: KeyboardEvent) => void>) {\n  useEffect(() => {\n    if (!hotkeys) {\n      return undefined;\n    }\n\n    const entries = Object.entries(hotkeys);\n\n    function handleKeyDown(e: KeyboardEvent) {\n      if (!shouldFireEvent(e)) {\n        return;\n      }\n\n      entries.forEach(([hotkey, handler]) => {\n        if (getHotkeyMatcher(hotkey)(e)) {\n          handler(e);\n        }\n      });\n    }\n\n    return handlers.addCallback(handleKeyDown);\n  }, [hotkeys]);\n}\n\nfunction shouldFireEvent(e: KeyboardEvent) {\n  if (e.target instanceof HTMLElement) {\n    return !IGNORE_TAGS.has(e.target.tagName);\n  }\n\n  return true;\n}\n","// Original source from Mantine\n// https://github.com/mantinedev/mantine/blob/master/src/mantine-hooks/src/use-hotkeys/parse-hotkey.ts\n\nexport type KeyboardModifiers = {\n  alt: boolean;\n  ctrl: boolean;\n  meta: boolean;\n  mod: boolean;\n  shift: boolean;\n};\n\nexport type Hotkey = KeyboardModifiers & {\n  key?: string;\n};\n\ntype CheckHotkeyMatch = (event: KeyboardEvent) => boolean;\n\nexport function parseHotkey(hotkey: string): Hotkey {\n  const keys = hotkey\n    .toLowerCase()\n    .split('+')\n    .map((part) => part.trim());\n\n  const modifiers: KeyboardModifiers = {\n    alt: keys.includes('alt'),\n    ctrl: keys.includes('ctrl'),\n    meta: keys.includes('meta'),\n    mod: keys.includes('mod'),\n    shift: keys.includes('shift'),\n  };\n\n  const reservedKeys = ['alt', 'ctrl', 'meta', 'shift', 'mod'];\n\n  const freeKey = keys.find((key) => !reservedKeys.includes(key));\n\n  return {\n    ...modifiers,\n    key: freeKey,\n  };\n}\n\nfunction isExactHotkey(hotkey: Hotkey, event: KeyboardEvent): boolean {\n  const {\n    alt, ctrl, meta, mod, shift, key,\n  } = hotkey;\n  const {\n    altKey, ctrlKey, metaKey, shiftKey, key: pressedKey,\n  } = event;\n\n  if (alt !== altKey) {\n    return false;\n  }\n\n  if (mod) {\n    if (!ctrlKey && !metaKey) {\n      return false;\n    }\n  } else {\n    if (ctrl !== ctrlKey) {\n      return false;\n    }\n    if (meta !== metaKey) {\n      return false;\n    }\n  }\n  if (shift !== shiftKey) {\n    return false;\n  }\n\n  return Boolean(key\n    && (pressedKey.toLowerCase() === key.toLowerCase()\n      || event.code.replace('Key', '').toLowerCase() === key.toLowerCase()));\n}\n\nexport function getHotkeyMatcher(hotkey: string): CheckHotkeyMatch {\n  return (event) => isExactHotkey(parseHotkey(hotkey), event);\n}\n","import type { RefObject } from 'react';\nimport { useEffect } from '../lib/teact/teact';\nimport { IS_SINGLE_COLUMN_LAYOUT } from '../util/environment';\n\n// Focus slows down animation, also it breaks transition layout in Chrome\nconst FOCUS_DELAY_MS = 500;\nconst MODAL_HIDE_DELAY_MS = 300;\n\nexport default function useInputFocusOnOpen(\n  inputRef: RefObject<HTMLInputElement | HTMLTextAreaElement>,\n  isOpen?: boolean,\n  onClose?: NoneToVoidFunction,\n) {\n  useEffect(() => {\n    if (isOpen) {\n      if (!IS_SINGLE_COLUMN_LAYOUT) {\n        setTimeout(() => {\n          requestAnimationFrame(() => {\n            if (inputRef.current) {\n              inputRef.current.focus();\n            }\n          });\n        }, FOCUS_DELAY_MS);\n      }\n    } else {\n      if (inputRef.current) {\n        inputRef.current.blur();\n      }\n\n      if (onClose) {\n        setTimeout(onClose, MODAL_HIDE_DELAY_MS);\n      }\n    }\n  }, [inputRef, isOpen, onClose]);\n}\n","import { useLayoutEffect } from '../lib/teact/teact';\nimport usePrevious from './usePrevious';\n\nconst useLayoutEffectWithPrevDeps = <T extends readonly any[]>(\n  cb: (args: T | readonly []) => void, dependencies: T, debugKey?: string,\n) => {\n  const prevDeps = usePrevious<T>(dependencies);\n  return useLayoutEffect(() => {\n    return cb(prevDeps || []);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies, debugKey);\n};\n\nexport default useLayoutEffectWithPrevDeps;\n","import { useRef } from '../lib/teact/teact';\nimport generateIdFor from '../util/generateIdFor';\n\nconst store: Record<string, boolean> = {};\n\nconst useUniqueId = () => {\n  const idRef = useRef<string>();\n\n  if (!idRef.current) {\n    idRef.current = generateIdFor(store);\n    store[idRef.current] = true;\n  }\n\n  return idRef.current;\n};\n\nexport default useUniqueId;\n","import {\n  useEffect, useMemo, useRef, useState,\n} from '../lib/teact/teact';\n\nimport { IS_PROGRESSIVE_SUPPORTED } from '../util/environment';\nimport { ApiMediaFormat } from '../api/types';\nimport { throttle } from '../util/schedulers';\nimport * as mediaLoader from '../util/mediaLoader';\nimport useForceUpdate from './useForceUpdate';\nimport useUniqueId from './useUniqueId';\n\nconst STREAMING_PROGRESS = 0.75;\nconst STREAMING_TIMEOUT = 1500;\nconst PROGRESS_THROTTLE = 500;\n\nexport default function useMediaWithLoadProgress(\n  mediaHash: string | undefined,\n  noLoad = false,\n  mediaFormat = ApiMediaFormat.BlobUrl,\n  cacheBuster?: number,\n  delay?: number | false,\n  isHtmlAllowed = false,\n) {\n  const mediaData = mediaHash ? mediaLoader.getFromMemory(mediaHash) : undefined;\n  const isStreaming = mediaFormat === ApiMediaFormat.Stream || (\n    IS_PROGRESSIVE_SUPPORTED && mediaFormat === ApiMediaFormat.Progressive\n  );\n  const forceUpdate = useForceUpdate();\n  const id = useUniqueId();\n  const [loadProgress, setLoadProgress] = useState(mediaData && !isStreaming ? 1 : 0);\n  const startedAtRef = useRef<number>();\n\n  const handleProgress = useMemo(() => {\n    return throttle((progress: number) => {\n      if (startedAtRef.current && (!delay || (Date.now() - startedAtRef.current > delay))) {\n        setLoadProgress(progress);\n      }\n    }, PROGRESS_THROTTLE, true);\n  }, [delay]);\n\n  useEffect(() => {\n    if (!noLoad && mediaHash) {\n      if (!mediaData) {\n        setLoadProgress(0);\n\n        if (startedAtRef.current) {\n          mediaLoader.cancelProgress(handleProgress);\n        }\n\n        startedAtRef.current = Date.now();\n\n        mediaLoader.fetch(mediaHash, mediaFormat, isHtmlAllowed, handleProgress, id).then(() => {\n          const spentTime = Date.now() - startedAtRef.current!;\n          startedAtRef.current = undefined;\n\n          if (!delay || spentTime >= delay) {\n            forceUpdate();\n          } else {\n            setTimeout(forceUpdate, delay - spentTime);\n          }\n        });\n      } else if (isStreaming) {\n        setTimeout(() => {\n          setLoadProgress(STREAMING_PROGRESS);\n        }, STREAMING_TIMEOUT);\n      }\n    }\n  }, [\n    noLoad, mediaHash, mediaData, mediaFormat, cacheBuster, forceUpdate, isStreaming, delay, handleProgress,\n    isHtmlAllowed, id,\n  ]);\n\n  useEffect(() => {\n    if (noLoad && startedAtRef.current) {\n      mediaLoader.cancelProgress(handleProgress);\n      setLoadProgress(0);\n      startedAtRef.current = undefined;\n    }\n  }, [handleProgress, noLoad]);\n\n  useEffect(() => {\n    return () => {\n      if (mediaHash) {\n        mediaLoader.removeCallback(mediaHash, id);\n      }\n    };\n  }, [id, mediaHash]);\n\n  return { mediaData, loadProgress };\n}\n","import { useCallback, useEffect, useRef } from '../lib/teact/teact';\n\nimport { IS_TOUCH_ENV } from '../util/environment';\n\nconst MENU_CLOSE_TIMEOUT = 250;\nlet closeTimeout: number | undefined;\n\nexport default function useMouseInside(\n  isOpen: boolean, onClose: NoneToVoidFunction, menuCloseTimeout = MENU_CLOSE_TIMEOUT, isDisabled = false,\n) {\n  const isMouseInside = useRef(false);\n\n  const markMouseInside = useCallback(() => {\n    isMouseInside.current = true;\n  }, []);\n\n  useEffect(() => {\n    if (closeTimeout) {\n      clearTimeout(closeTimeout);\n      closeTimeout = undefined;\n    }\n\n    if (isOpen && !IS_TOUCH_ENV && !isDisabled) {\n      closeTimeout = window.setTimeout(() => {\n        if (!isMouseInside.current) {\n          onClose();\n        }\n      }, menuCloseTimeout * 2);\n    }\n  }, [isDisabled, isOpen, menuCloseTimeout, onClose]);\n\n  const handleMouseEnter = useCallback(() => {\n    isMouseInside.current = true;\n  }, []);\n\n  const handleMouseLeave = useCallback(() => {\n    isMouseInside.current = false;\n\n    if (closeTimeout) {\n      clearTimeout(closeTimeout);\n      closeTimeout = undefined;\n    }\n\n    closeTimeout = window.setTimeout(() => {\n      if (!isMouseInside.current) {\n        onClose();\n      }\n    }, menuCloseTimeout);\n  }, [menuCloseTimeout, onClose]);\n\n  return [handleMouseEnter, handleMouseLeave, markMouseInside];\n}\n","import { useEffect } from '../lib/teact/teact';\n\nexport default function useOnSelectionChange(container: HTMLElement | null, callback: (range: Range) => void) {\n  useEffect(() => {\n    if (!container) return undefined;\n\n    const onSelectionChange = () => {\n      const selection = window.getSelection();\n      if (!selection) return;\n\n      for (let i = 0; i < selection.rangeCount; i++) {\n        const range = selection.getRangeAt(i);\n        const ancestor = range.commonAncestorContainer;\n        if (container.contains(ancestor)) {\n          callback(range);\n        }\n      }\n    };\n\n    document.addEventListener('selectionchange', onSelectionChange);\n    return () => document.removeEventListener('selectionchange', onSelectionChange);\n  }, [callback, container]);\n}\n","import { useRef } from '../lib/teact/teact';\n\nimport usePrevious from './usePrevious';\nimport useForceUpdate from './useForceUpdate';\nimport useOnChange from './useOnChange';\n\nexport default function usePrevDuringAnimation(current: any, duration?: number) {\n  const prev = usePrevious(current, true);\n  const timeoutRef = useRef<number>();\n  const forceUpdate = useForceUpdate();\n  // eslint-disable-next-line no-null/no-null\n  const isCurrentPresent = current !== undefined && current !== null;\n  // eslint-disable-next-line no-null/no-null\n  const isPrevPresent = prev !== undefined && prev !== null;\n\n  if (isCurrentPresent && timeoutRef.current) {\n    clearTimeout(timeoutRef.current);\n    timeoutRef.current = undefined;\n  }\n\n  useOnChange(() => {\n    // When `current` becomes empty\n    if (duration && !isCurrentPresent && isPrevPresent && !timeoutRef.current) {\n      timeoutRef.current = window.setTimeout(() => {\n        timeoutRef.current = undefined;\n        forceUpdate();\n      }, duration);\n    }\n  }, [current]);\n\n  return !timeoutRef.current || !duration || isCurrentPresent ? current : prev;\n}\n","import { useCallback, useRef } from '../lib/teact/teact';\n\nimport useForceUpdate from './useForceUpdate';\n\nexport type ReducerAction<Actions> = { type: Actions; payload?: any };\nexport type StateReducer<State, Actions> = (state: State, action: ReducerAction<Actions>) => State;\nexport type Dispatch<Actions> = (action: ReducerAction<Actions>) => void;\n\nexport default function useReducer<State, Actions>(\n  reducer: StateReducer<State, Actions>,\n  initialState: State,\n) {\n  const forceUpdate = useForceUpdate();\n  const reducerRef = useRef(reducer);\n  const state = useRef(initialState);\n\n  const dispatch = useCallback((action: ReducerAction<Actions>) => {\n    state.current = reducerRef.current(state.current, action);\n    forceUpdate();\n  }, [forceUpdate]);\n\n  return [\n    state.current,\n    dispatch,\n  ] as [State, Dispatch<Actions>];\n}\n","import useDebouncedCallback from './useDebouncedCallback';\n\nexport default function useRunDebounced(ms: number, noFirst?: boolean, noLast?: boolean) {\n  return useDebouncedCallback((cb: NoneToVoidFunction) => {\n    cb();\n  }, [], ms, noFirst, noLast);\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\nimport type { OwnProps } from './CalendarModal';\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nconst CalendarModalAsync: FC<OwnProps> = (props) => {\n  const { isOpen } = props;\n  const CalendarModal = useModuleLoader(Bundles.Extra, 'CalendarModal', !isOpen);\n\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return CalendarModal ? <CalendarModal {...props} /> : undefined;\n};\n\nexport default memo(CalendarModalAsync);\n","import React, { useCallback, useState } from '../lib/teact/teact';\nimport { getGlobal } from '../lib/teact/teactn';\n\nimport { SCHEDULED_WHEN_ONLINE } from '../config';\nimport { getDayStartAt } from '../util/dateFormat';\nimport useLang from './useLang';\n\nimport CalendarModal from '../components/common/CalendarModal.async';\n\ntype OnScheduledCallback = (scheduledAt: number) => void;\n\nconst useSchedule = (\n  canScheduleUntilOnline?: boolean,\n  onCancel?: () => void,\n  openAt?: number,\n) => {\n  const lang = useLang();\n  const [onScheduled, setOnScheduled] = useState<OnScheduledCallback | undefined>();\n\n  const handleMessageSchedule = useCallback((date: Date, isWhenOnline = false) => {\n    const { serverTimeOffset } = getGlobal();\n    // Scheduled time can not be less than 10 seconds in future\n    const scheduledAt = Math.round(Math.max(date.getTime(), Date.now() + 60 * 1000) / 1000)\n      + (isWhenOnline ? 0 : serverTimeOffset);\n    onScheduled?.(scheduledAt);\n    setOnScheduled(undefined);\n  }, [onScheduled]);\n\n  const handleMessageScheduleUntilOnline = useCallback(() => {\n    handleMessageSchedule(new Date(SCHEDULED_WHEN_ONLINE * 1000), true);\n  }, [handleMessageSchedule]);\n\n  const handleCloseCalendar = useCallback(() => {\n    setOnScheduled(undefined);\n    onCancel?.();\n  }, [onCancel]);\n\n  const requestCalendar = useCallback((whenScheduled: OnScheduledCallback) => {\n    setOnScheduled(() => whenScheduled);\n  }, []);\n\n  const scheduledDefaultDate = openAt ? new Date(openAt * 1000) : new Date();\n  scheduledDefaultDate.setSeconds(0);\n  scheduledDefaultDate.setMilliseconds(0);\n\n  const scheduledMaxDate = new Date();\n  scheduledMaxDate.setFullYear(scheduledMaxDate.getFullYear() + 1);\n\n  const calendar = (\n    <CalendarModal\n      isOpen={Boolean(onScheduled)}\n      withTimePicker\n      selectedAt={scheduledDefaultDate.getTime()}\n      maxAt={getDayStartAt(scheduledMaxDate)}\n      isFutureMode\n      secondButtonLabel={canScheduleUntilOnline ? lang('Schedule.SendWhenOnline') : undefined}\n      onClose={handleCloseCalendar}\n      onSubmit={handleMessageSchedule}\n      onSecondButtonClick={canScheduleUntilOnline ? handleMessageScheduleUntilOnline : undefined}\n    />\n  );\n\n  return [requestCalendar, calendar] as const;\n};\n\nexport default useSchedule;\n","import { useMemo } from '../lib/teact/teact';\nimport { getActions } from '../global';\n\nimport type { ApiSendMessageAction } from '../api/types';\n\nimport { SEND_MESSAGE_ACTION_INTERVAL } from '../config';\nimport { throttle } from '../util/schedulers';\n\nconst useSendMessageAction = (chatId?: string, threadId?: number) => {\n  return useMemo(() => {\n    return throttle((action: ApiSendMessageAction) => {\n      getActions().sendMessageAction({ chatId, threadId, action });\n    }, SEND_MESSAGE_ACTION_INTERVAL);\n  }, [chatId, threadId]);\n};\n\nexport default useSendMessageAction;\n","import { useRef } from '../lib/teact/teact';\n\nimport useOnChange from './useOnChange';\n\n// Allows to use state value as \"silent\" dependency in hooks (not causing updates).\n// Useful for state values that update frequently (such as controlled input value).\nexport function useStateRef<T>(value: T) {\n  const ref = useRef<T>(value);\n\n  useOnChange(() => {\n    ref.current = value;\n  }, [value]);\n\n  return ref;\n}\n","import { useEffect, useLayoutEffect, useRef } from '../lib/teact/teact';\n\nfunction useTimeout(callback: () => void, delay?: number) {\n  const savedCallback = useRef(callback);\n\n  useLayoutEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    if (typeof delay !== 'number') {\n      return undefined;\n    }\n    const id = setTimeout(() => savedCallback.current(), delay);\n    return () => clearTimeout(id);\n  }, [delay]);\n}\n\nexport default useTimeout;\n","/* eslint-disable no-nested-ternary */\n/* eslint-disable no-bitwise */\n/* eslint-disable no-multi-assign */\n/* eslint-disable no-cond-assign */\n/* eslint-disable no-param-reassign */\n/* eslint-disable prefer-const */\n/* eslint-disable eqeqeq */\n/* eslint-disable @typescript-eslint/naming-convention */\n\n/*\nSuperfast Blur - a fast Box Blur For Canvas\n\nVersion:     0.5\nAuthor:        Mario Klingemann\nContact:     mario@quasimondo.com\nWebsite:    http://www.quasimondo.com/BoxBlurForCanvas\nTwitter:    @quasimondo\n\nIn case you find this class useful - especially in commercial projects -\nI am not totally unhappy for a small donation to my PayPal account\nmario@quasimondo.de\n\nOr support me on flattr:\nhttps://flattr.com/thing/140066/Superfast-Blur-a-pretty-fast-Box-Blur-Effect-for-CanvasJavascript\n\nCopyright (c) 2011 Mario Klingemann\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n*/\n\n// eslint-disable-next-line max-len\nconst mul_table = [1, 57, 41, 21, 203, 34, 97, 73, 227, 91, 149, 62, 105, 45, 39, 137, 241, 107, 3, 173, 39, 71, 65, 238, 219, 101, 187, 87, 81, 151, 141, 133, 249, 117, 221, 209, 197, 187, 177, 169, 5, 153, 73, 139, 133, 127, 243, 233, 223, 107, 103, 99, 191, 23, 177, 171, 165, 159, 77, 149, 9, 139, 135, 131, 253, 245, 119, 231, 224, 109, 211, 103, 25, 195, 189, 23, 45, 175, 171, 83, 81, 79, 155, 151, 147, 9, 141, 137, 67, 131, 129, 251, 123, 30, 235, 115, 113, 221, 217, 53, 13, 51, 50, 49, 193, 189, 185, 91, 179, 175, 43, 169, 83, 163, 5, 79, 155, 19, 75, 147, 145, 143, 35, 69, 17, 67, 33, 65, 255, 251, 247, 243, 239, 59, 29, 229, 113, 111, 219, 27, 213, 105, 207, 51, 201, 199, 49, 193, 191, 47, 93, 183, 181, 179, 11, 87, 43, 85, 167, 165, 163, 161, 159, 157, 155, 77, 19, 75, 37, 73, 145, 143, 141, 35, 138, 137, 135, 67, 33, 131, 129, 255, 63, 250, 247, 61, 121, 239, 237, 117, 29, 229, 227, 225, 111, 55, 109, 216, 213, 211, 209, 207, 205, 203, 201, 199, 197, 195, 193, 48, 190, 47, 93, 185, 183, 181, 179, 178, 176, 175, 173, 171, 85, 21, 167, 165, 41, 163, 161, 5, 79, 157, 78, 154, 153, 19, 75, 149, 74, 147, 73, 144, 143, 71, 141, 140, 139, 137, 17, 135, 134, 133, 66, 131, 65, 129, 1];\n// eslint-disable-next-line max-len\nconst shg_table = [0, 9, 10, 10, 14, 12, 14, 14, 16, 15, 16, 15, 16, 15, 15, 17, 18, 17, 12, 18, 16, 17, 17, 19, 19, 18, 19, 18, 18, 19, 19, 19, 20, 19, 20, 20, 20, 20, 20, 20, 15, 20, 19, 20, 20, 20, 21, 21, 21, 20, 20, 20, 21, 18, 21, 21, 21, 21, 20, 21, 17, 21, 21, 21, 22, 22, 21, 22, 22, 21, 22, 21, 19, 22, 22, 19, 20, 22, 22, 21, 21, 21, 22, 22, 22, 18, 22, 22, 21, 22, 22, 23, 22, 20, 23, 22, 22, 23, 23, 21, 19, 21, 21, 21, 23, 23, 23, 22, 23, 23, 21, 23, 22, 23, 18, 22, 23, 20, 22, 23, 23, 23, 21, 22, 20, 22, 21, 22, 24, 24, 24, 24, 24, 22, 21, 24, 23, 23, 24, 21, 24, 23, 24, 22, 24, 24, 22, 24, 24, 22, 23, 24, 24, 24, 20, 23, 22, 23, 24, 24, 24, 24, 24, 24, 24, 23, 21, 23, 22, 23, 24, 24, 24, 22, 24, 24, 24, 23, 22, 24, 24, 25, 23, 25, 25, 23, 24, 25, 25, 24, 22, 25, 25, 25, 24, 23, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 23, 25, 23, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 22, 25, 25, 23, 25, 25, 20, 24, 25, 24, 25, 25, 22, 24, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 25, 22, 25, 25, 25, 24, 25, 24, 25, 18];\n\nexport default function boxBlurCanvasRGB(context, top_x, top_y, width, height, radius, iterations) {\n  if (Number.isNaN(radius) || radius < 1) return;\n\n  radius |= 0;\n\n  if (Number.isNaN(iterations)) iterations = 1;\n  iterations |= 0;\n  if (iterations > 3) iterations = 3;\n  if (iterations < 1) iterations = 1;\n\n  const imageData = context.getImageData(top_x, top_y, width, height);\n\n  const pixels = imageData.data;\n\n  let rsum;\n  let gsum;\n  let bsum;\n  let x;\n  let y;\n  let i;\n  let p;\n  let p1;\n  let p2;\n  let yp;\n  let yi;\n  let yw;\n  let wm = width - 1;\n  let hm = height - 1;\n  let rad1 = radius + 1;\n\n  let r = [];\n  let g = [];\n  let b = [];\n\n  let mul_sum = mul_table[radius];\n  let shg_sum = shg_table[radius];\n\n  let vmin = [];\n  let vmax = [];\n\n  while (iterations-- > 0) {\n    yw = yi = 0;\n\n    for (y = 0; y < height; y++) {\n      rsum = pixels[yw] * rad1;\n      gsum = pixels[yw + 1] * rad1;\n      bsum = pixels[yw + 2] * rad1;\n\n      for (i = 1; i <= radius; i++) {\n        p = yw + (((i > wm ? wm : i)) << 2);\n        rsum += pixels[p++];\n        gsum += pixels[p++];\n        bsum += pixels[p++];\n      }\n\n      for (x = 0; x < width; x++) {\n        r[yi] = rsum;\n        g[yi] = gsum;\n        b[yi] = bsum;\n\n        if (y == 0) {\n          vmin[x] = ((p = x + rad1) < wm ? p : wm) << 2;\n          vmax[x] = ((p = x - radius) > 0 ? p << 2 : 0);\n        }\n\n        p1 = yw + vmin[x];\n        p2 = yw + vmax[x];\n\n        rsum += pixels[p1++] - pixels[p2++];\n        gsum += pixels[p1++] - pixels[p2++];\n        bsum += pixels[p1++] - pixels[p2++];\n\n        yi++;\n      }\n      yw += (width << 2);\n    }\n\n    for (x = 0; x < width; x++) {\n      yp = x;\n      rsum = r[yp] * rad1;\n      gsum = g[yp] * rad1;\n      bsum = b[yp] * rad1;\n\n      for (i = 1; i <= radius; i++) {\n        yp += (i > hm ? 0 : width);\n        rsum += r[yp];\n        gsum += g[yp];\n        bsum += b[yp];\n      }\n\n      yi = x << 2;\n      for (y = 0; y < height; y++) {\n        pixels[yi] = (rsum * mul_sum) >>> shg_sum;\n        pixels[yi + 1] = (gsum * mul_sum) >>> shg_sum;\n        pixels[yi + 2] = (bsum * mul_sum) >>> shg_sum;\n\n        if (x == 0) {\n          vmin[y] = ((p = y + rad1) < hm ? p : hm) * width;\n          vmax[y] = ((p = y - radius) > 0 ? p * width : 0);\n        }\n\n        p1 = x + vmin[y];\n        p2 = x + vmax[y];\n\n        rsum += r[p1] - r[p2];\n        gsum += g[p1] - g[p2];\n        bsum += b[p1] - b[p2];\n\n        yi += width << 2;\n      }\n    }\n  }\n\n  context.putImageData(imageData, top_x, top_y);\n}\n","import generateIdFor from './generateIdFor';\n\nexport interface CancellableCallback {\n  (\n    ...args: any[]\n  ): void;\n\n  isCanceled?: boolean;\n  acceptsBuffer?: boolean;\n}\n\ntype CallMethodData = {\n  type: 'callMethod';\n  messageId?: string;\n  name: string;\n  args: any;\n  withCallback?: boolean;\n};\n\ntype OriginMessageData = CallMethodData | {\n  type: 'cancelProgress';\n  messageId: string;\n};\n\nexport interface OriginMessageEvent {\n  data: OriginMessageData;\n}\n\nexport type WorkerMessageData = {\n  type: 'methodResponse';\n  messageId: string;\n  response?: any;\n  error?: { message: string };\n} | {\n  type: 'methodCallback';\n  messageId: string;\n  callbackArgs: any[];\n} | {\n  type: 'unhandledError';\n  error?: { message: string };\n};\n\nexport interface WorkerMessageEvent {\n  data: WorkerMessageData;\n}\n\ninterface RequestStates {\n  messageId: string;\n  resolve: Function;\n  reject: Function;\n  callback: AnyToVoidFunction;\n}\n\n// TODO Replace `any` with proper generics\nexport default class WorkerConnector {\n  private requestStates = new Map<string, RequestStates>();\n\n  private requestStatesByCallback = new Map<AnyToVoidFunction, RequestStates>();\n\n  constructor(private worker: Worker) {\n    this.subscribe();\n  }\n\n  request(messageData: { name: string; args: any }) {\n    const { worker, requestStates, requestStatesByCallback } = this;\n\n    const messageId = generateIdFor(requestStates);\n    const payload: CallMethodData = {\n      type: 'callMethod',\n      messageId,\n      ...messageData,\n    };\n\n    const requestState = { messageId } as RequestStates;\n\n    // Re-wrap type because of `postMessage`\n    const promise: Promise<any> = new Promise((resolve, reject) => {\n      Object.assign(requestState, { resolve, reject });\n    });\n\n    if (typeof payload.args[payload.args.length - 1] === 'function') {\n      payload.withCallback = true;\n\n      const callback = payload.args.pop() as AnyToVoidFunction;\n      requestState.callback = callback;\n      requestStatesByCallback.set(callback, requestState);\n    }\n\n    requestStates.set(messageId, requestState);\n    promise\n      .catch(() => undefined)\n      .finally(() => {\n        requestStates.delete(messageId);\n\n        if (requestState.callback) {\n          requestStatesByCallback.delete(requestState.callback);\n        }\n      });\n\n    worker.postMessage(payload);\n\n    return promise;\n  }\n\n  cancelCallback(progressCallback: CancellableCallback) {\n    progressCallback.isCanceled = true;\n\n    const { messageId } = this.requestStatesByCallback.get(progressCallback) || {};\n    if (!messageId) {\n      return;\n    }\n\n    this.worker.postMessage({\n      type: 'cancelProgress',\n      messageId,\n    });\n  }\n\n  private subscribe() {\n    const { worker, requestStates } = this;\n\n    worker.addEventListener('message', ({ data }: WorkerMessageEvent) => {\n      if (data.type === 'methodResponse') {\n        const requestState = requestStates.get(data.messageId);\n        if (requestState) {\n          if (data.error) {\n            requestState.reject(data.error);\n          } else {\n            requestState.resolve(data.response);\n          }\n        }\n      } else if (data.type === 'methodCallback') {\n        const requestState = requestStates.get(data.messageId);\n        requestState?.callback?.(...data.callbackArgs);\n      } else if (data.type === 'unhandledError') {\n        throw new Error(data.error?.message);\n      }\n    });\n  }\n}\n","import {\n  DPR,\n  IS_SINGLE_COLUMN_LAYOUT,\n  IS_SAFARI,\n  IS_ANDROID,\n} from '../../util/environment';\nimport WorkerConnector from '../../util/WorkerConnector';\nimport { animate } from '../../util/animation';\nimport cycleRestrict from '../../util/cycleRestrict';\nimport { fastRaf } from '../../util/schedulers';\n\ninterface Params {\n  noLoop?: boolean;\n  size?: number;\n  quality?: number;\n  isLowPriority?: boolean;\n  coords?: { x: number; y: number };\n}\n\nconst WAITING = Symbol('WAITING');\ntype Frame =\n  undefined\n  | typeof WAITING\n  | ImageBitmap;\n\nconst MAX_WORKERS = 4;\nconst HIGH_PRIORITY_QUALITY = IS_SINGLE_COLUMN_LAYOUT ? 0.75 : 1;\nconst LOW_PRIORITY_QUALITY = IS_ANDROID ? 0.5 : 0.75;\nconst LOW_PRIORITY_QUALITY_SIZE_THRESHOLD = 24;\nconst HIGH_PRIORITY_CACHE_MODULO = IS_SAFARI ? 2 : 4;\nconst LOW_PRIORITY_CACHE_MODULO = 0;\n\nconst instancesById = new Map<string, RLottie>();\n\nconst workers = new Array(MAX_WORKERS).fill(undefined).map(\n  () => new WorkerConnector(new Worker(new URL('./rlottie.worker.ts', import.meta.url))),\n);\nlet lastWorkerIndex = -1;\n\nclass RLottie {\n  // Config\n\n  private containers = new Map<string, {\n    canvas: HTMLCanvasElement;\n    ctx: CanvasRenderingContext2D;\n    isLoaded?: boolean;\n    isPaused?: boolean;\n    isSharedCanvas?: boolean;\n    coords?: Params['coords'];\n    onLoad?: NoneToVoidFunction;\n  }>();\n\n  private imgSize!: number;\n\n  private imageData!: ImageData;\n\n  private msPerFrame = 1000 / 60;\n\n  private reduceFactor = 1;\n\n  private cacheModulo!: number;\n\n  private workerIndex!: number;\n\n  private frames: Frame[] = [];\n\n  private framesCount?: number;\n\n  // State\n\n  private isAnimating = false;\n\n  private isWaiting = true;\n\n  private isEnded = false;\n\n  private isDestroyed = false;\n\n  private isRendererInited = false;\n\n  private approxFrameIndex = 0;\n\n  private prevFrameIndex = -1;\n\n  private stopFrameIndex? = 0;\n\n  private speed = 1;\n\n  private direction: 1 | -1 = 1;\n\n  private lastRenderAt?: number;\n\n  static init(...args: ConstructorParameters<typeof RLottie>) {\n    const [container, canvas, onLoad, id, , params] = args;\n    let instance = instancesById.get(id);\n\n    if (!instance) {\n      // eslint-disable-next-line prefer-rest-params\n      instance = new RLottie(...args);\n      instancesById.set(id, instance);\n    } else {\n      instance.addContainer(container, canvas, onLoad, params?.coords);\n    }\n\n    return instance;\n  }\n\n  constructor(\n    containerId: string,\n    container: HTMLDivElement | HTMLCanvasElement,\n    onLoad: NoneToVoidFunction | undefined,\n    private id: string,\n    private tgsUrl: string,\n    private params: Params = {},\n    private customColor?: [number, number, number],\n    private onEnded?: (isDestroyed?: boolean) => void,\n    private onLoop?: () => void,\n  ) {\n    this.addContainer(containerId, container, onLoad, params.coords);\n    this.initConfig();\n    this.initRenderer();\n  }\n\n  public removeContainer(containerId: string) {\n    const {\n      canvas, ctx, isSharedCanvas, coords,\n    } = this.containers.get(containerId)!;\n\n    if (isSharedCanvas) {\n      ctx.clearRect(coords!.x, coords!.y, this.imgSize, this.imgSize);\n    } else {\n      canvas.remove();\n    }\n\n    this.containers.delete(containerId);\n\n    if (!this.containers.size) {\n      this.destroy();\n    }\n  }\n\n  isPlaying() {\n    return this.isAnimating || this.isWaiting;\n  }\n\n  play(forceRestart = false, containerId?: string) {\n    if (containerId) {\n      this.containers.get(containerId)!.isPaused = false;\n    }\n\n    if (this.isEnded && forceRestart) {\n      this.approxFrameIndex = Math.floor(0);\n    }\n\n    this.stopFrameIndex = undefined;\n    this.direction = 1;\n    this.doPlay();\n  }\n\n  pause(containerId?: string) {\n    if (containerId) {\n      this.containers.get(containerId)!.isPaused = true;\n\n      const areAllContainersPaused = Array.from(this.containers.values()).every(({ isPaused }) => isPaused);\n      if (!areAllContainersPaused) {\n        return;\n      }\n    }\n\n    if (this.isWaiting) {\n      this.stopFrameIndex = this.approxFrameIndex;\n    } else {\n      this.isAnimating = false;\n    }\n\n    if (!this.params.isLowPriority) {\n      this.frames = this.frames.map((frame, i) => {\n        if (i === this.prevFrameIndex) {\n          return frame;\n        } else {\n          if (frame && frame !== WAITING) {\n            frame.close();\n          }\n\n          return undefined;\n        }\n      });\n    }\n  }\n\n  playSegment([startFrameIndex, stopFrameIndex]: [number, number]) {\n    this.approxFrameIndex = Math.floor(startFrameIndex / this.reduceFactor);\n    this.stopFrameIndex = Math.floor(stopFrameIndex / this.reduceFactor);\n    this.direction = startFrameIndex < stopFrameIndex ? 1 : -1;\n    this.doPlay();\n  }\n\n  setSpeed(speed: number) {\n    this.speed = speed;\n  }\n\n  setNoLoop(noLoop?: boolean) {\n    this.params.noLoop = noLoop;\n  }\n\n  setSharedCanvasCoords(containerId: string, newCoords: Params['coords']) {\n    const containerInfo = this.containers.get(containerId)!;\n    const {\n      canvas, ctx,\n    } = containerInfo;\n\n    if (!canvas.dataset.isJustCleaned || canvas.dataset.isJustCleaned === 'false') {\n      const sizeFactor = this.calcSizeFactor();\n      ensureCanvasSize(canvas, sizeFactor);\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      canvas.dataset.isJustCleaned = 'true';\n      fastRaf(() => {\n        canvas.dataset.isJustCleaned = 'false';\n      });\n    }\n\n    containerInfo.coords = {\n      x: Math.round((newCoords?.x || 0) * canvas.width),\n      y: Math.round((newCoords?.y || 0) * canvas.height),\n    };\n\n    const frame = this.getFrame(this.prevFrameIndex) || this.getFrame(Math.round(this.approxFrameIndex));\n\n    if (frame && frame !== WAITING) {\n      ctx.drawImage(frame, containerInfo.coords.x, containerInfo.coords.y);\n    }\n  }\n\n  private addContainer(\n    containerId: string,\n    container: HTMLDivElement | HTMLCanvasElement,\n    onLoad?: NoneToVoidFunction,\n    coords?: Params['coords'],\n  ) {\n    const sizeFactor = this.calcSizeFactor();\n\n    let imgSize: number;\n\n    if (container instanceof HTMLDivElement) {\n      if (!(container.parentNode instanceof HTMLElement)) {\n        throw new Error('[RLottie] Container is not mounted');\n      }\n\n      let { size } = this.params;\n\n      if (!size) {\n        size = (\n          container.offsetWidth\n          || parseInt(container.style.width, 10)\n          || container.parentNode.offsetWidth\n        );\n\n        if (!size) {\n          throw new Error('[RLottie] Failed to detect width from container');\n        }\n      }\n\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d')!;\n\n      canvas.style.width = `${size}px`;\n      canvas.style.height = `${size}px`;\n\n      imgSize = Math.round(size * sizeFactor);\n\n      canvas.width = imgSize;\n      canvas.height = imgSize;\n\n      container.appendChild(canvas);\n\n      this.containers.set(containerId, {\n        canvas, ctx, onLoad,\n      });\n    } else {\n      if (!container.offsetParent) {\n        throw new Error('[RLottie] Shared canvas is not mounted');\n      }\n\n      const canvas = container;\n      const ctx = canvas.getContext('2d')!;\n\n      ensureCanvasSize(canvas, sizeFactor);\n\n      imgSize = Math.round(this.params.size! * sizeFactor);\n\n      this.containers.set(containerId, {\n        canvas,\n        ctx,\n        isSharedCanvas: true,\n        coords: {\n          x: Math.round((coords?.x || 0) * canvas.width),\n          y: Math.round((coords?.y || 0) * canvas.height),\n        },\n        onLoad,\n      });\n    }\n\n    if (!this.imgSize) {\n      this.imgSize = imgSize;\n      this.imageData = new ImageData(imgSize, imgSize);\n    }\n\n    if (this.isRendererInited) {\n      this.doPlay();\n    }\n  }\n\n  private calcSizeFactor() {\n    const {\n      isLowPriority,\n      size,\n      // Reduced quality only looks acceptable on big enough images\n      quality = isLowPriority && (!size || size > LOW_PRIORITY_QUALITY_SIZE_THRESHOLD)\n        ? LOW_PRIORITY_QUALITY\n        : HIGH_PRIORITY_QUALITY,\n    } = this.params;\n\n    // Reduced quality only looks acceptable on high DPR screens\n    return Math.max(DPR * quality, 1);\n  }\n\n  private destroy() {\n    this.isDestroyed = true;\n    this.pause();\n    this.clearCache();\n    this.destroyRenderer();\n\n    instancesById.delete(this.id);\n  }\n\n  private clearCache() {\n    this.frames.forEach((frame) => {\n      if (frame && frame !== WAITING) {\n        frame.close();\n      }\n    });\n\n    // Help GC\n    this.imageData = undefined as any;\n    this.frames = [];\n  }\n\n  private initConfig() {\n    const { isLowPriority } = this.params;\n\n    this.cacheModulo = isLowPriority ? LOW_PRIORITY_CACHE_MODULO : HIGH_PRIORITY_CACHE_MODULO;\n  }\n\n  setColor(newColor: [number, number, number] | undefined) {\n    this.customColor = newColor;\n  }\n\n  private initRenderer() {\n    this.workerIndex = cycleRestrict(MAX_WORKERS, ++lastWorkerIndex);\n\n    workers[this.workerIndex].request({\n      name: 'init',\n      args: [\n        this.id,\n        this.tgsUrl,\n        this.imgSize,\n        this.params.isLowPriority,\n        this.customColor,\n        this.onRendererInit.bind(this),\n      ],\n    });\n  }\n\n  private destroyRenderer() {\n    workers[this.workerIndex].request({\n      name: 'destroy',\n      args: [this.id],\n    });\n  }\n\n  private onRendererInit(reduceFactor: number, msPerFrame: number, framesCount: number) {\n    this.isRendererInited = true;\n    this.reduceFactor = reduceFactor;\n    this.msPerFrame = msPerFrame;\n    this.framesCount = framesCount;\n\n    if (this.isWaiting) {\n      this.doPlay();\n    }\n  }\n\n  changeData(tgsUrl: string) {\n    this.pause();\n    this.tgsUrl = tgsUrl;\n    this.initConfig();\n\n    workers[this.workerIndex].request({\n      name: 'changeData',\n      args: [\n        this.id,\n        this.tgsUrl,\n        this.params.isLowPriority,\n        this.onChangeData.bind(this),\n      ],\n    });\n  }\n\n  private onChangeData(reduceFactor: number, msPerFrame: number, framesCount: number) {\n    this.reduceFactor = reduceFactor;\n    this.msPerFrame = msPerFrame;\n    this.framesCount = framesCount;\n    this.isWaiting = false;\n    this.isAnimating = false;\n\n    this.doPlay();\n  }\n\n  private doPlay() {\n    if (!this.framesCount) {\n      return;\n    }\n\n    if (this.isDestroyed) {\n      return;\n    }\n\n    if (this.isAnimating) {\n      return;\n    }\n\n    if (!this.isWaiting) {\n      this.lastRenderAt = undefined;\n    }\n\n    this.isEnded = false;\n    this.isAnimating = true;\n    this.isWaiting = false;\n\n    animate(() => {\n      if (this.isDestroyed) {\n        return false;\n      }\n\n      // Paused from outside\n      if (!this.isAnimating) {\n        const areAllLoaded = Array.from(this.containers.values()).every(({ isLoaded }) => isLoaded);\n        if (areAllLoaded) {\n          return false;\n        }\n      }\n\n      const frameIndex = Math.round(this.approxFrameIndex);\n      const frame = this.getFrame(frameIndex);\n      if (!frame || frame === WAITING) {\n        if (!frame) {\n          this.requestFrame(frameIndex);\n        }\n\n        this.isAnimating = false;\n        this.isWaiting = true;\n        return false;\n      }\n\n      if (this.cacheModulo && frameIndex % this.cacheModulo === 0) {\n        this.cleanupPrevFrame(frameIndex);\n      }\n\n      if (frameIndex !== this.prevFrameIndex) {\n        this.containers.forEach((containerData) => {\n          const {\n            ctx, isLoaded, isPaused, coords: { x, y } = {}, onLoad,\n          } = containerData;\n\n          if (!isLoaded || !isPaused) {\n            ctx.clearRect(x || 0, y || 0, this.imgSize, this.imgSize);\n            ctx.drawImage(frame, x || 0, y || 0);\n          }\n\n          if (!isLoaded) {\n            containerData.isLoaded = true;\n            onLoad?.();\n          }\n        });\n\n        this.prevFrameIndex = frameIndex;\n      }\n\n      const now = Date.now();\n      const currentSpeed = this.lastRenderAt ? this.msPerFrame / (now - this.lastRenderAt) : 1;\n      const delta = Math.min(1, (this.direction * this.speed) / currentSpeed);\n      const expectedNextFrameIndex = Math.round(this.approxFrameIndex + delta);\n\n      this.lastRenderAt = now;\n\n      // Forward animation finished\n      if (delta > 0 && (frameIndex === this.framesCount! - 1 || expectedNextFrameIndex > this.framesCount! - 1)) {\n        if (this.params.noLoop) {\n          this.isAnimating = false;\n          this.isEnded = true;\n          this.onEnded?.();\n          return false;\n        }\n        this.onLoop?.();\n\n        this.approxFrameIndex = 0;\n\n        // Backward animation finished\n      } else if (delta < 0 && (frameIndex === 0 || expectedNextFrameIndex < 0)) {\n        if (this.params.noLoop) {\n          this.isAnimating = false;\n          this.isEnded = true;\n          this.onEnded?.();\n          return false;\n        }\n        this.onLoop?.();\n\n        this.approxFrameIndex = this.framesCount! - 1;\n\n        // Stop frame reached\n      } else if (\n        this.stopFrameIndex !== undefined\n        && (frameIndex === this.stopFrameIndex\n          || (\n            (delta > 0 && expectedNextFrameIndex > this.stopFrameIndex)\n            || (delta < 0 && expectedNextFrameIndex < this.stopFrameIndex)\n          ))\n      ) {\n        this.stopFrameIndex = undefined;\n        this.isAnimating = false;\n        return false;\n\n        // Preparing next frame\n      } else {\n        this.approxFrameIndex += delta;\n      }\n\n      const nextFrameIndex = Math.round(this.approxFrameIndex);\n\n      if (!this.getFrame(nextFrameIndex)) {\n        this.requestFrame(nextFrameIndex);\n        this.isWaiting = true;\n        this.isAnimating = false;\n        return false;\n      }\n\n      return true;\n    });\n  }\n\n  private getFrame(frameIndex: number) {\n    return this.frames[frameIndex];\n  }\n\n  private requestFrame(frameIndex: number) {\n    this.frames[frameIndex] = WAITING;\n\n    workers[this.workerIndex].request({\n      name: 'renderFrames',\n      args: [this.id, frameIndex, this.onFrameLoad.bind(this)],\n    });\n  }\n\n  private cleanupPrevFrame(frameIndex: number) {\n    if (this.framesCount! < 3) {\n      return;\n    }\n\n    const prevFrameIndex = cycleRestrict(this.framesCount!, frameIndex - 1);\n    this.frames[prevFrameIndex] = undefined;\n  }\n\n  private onFrameLoad(frameIndex: number, imageBitmap: ImageBitmap) {\n    if (this.frames[frameIndex] !== WAITING) {\n      return;\n    }\n\n    this.frames[frameIndex] = imageBitmap;\n\n    if (this.isWaiting) {\n      this.doPlay();\n    }\n  }\n}\n\nfunction ensureCanvasSize(canvas: HTMLCanvasElement, sizeFactor: number) {\n  const expectedWidth = Math.round(canvas.offsetWidth * sizeFactor);\n  const expectedHeight = Math.round(canvas.offsetHeight * sizeFactor);\n  if (canvas.width !== expectedWidth || canvas.height !== expectedHeight) {\n    canvas.width = expectedWidth;\n    canvas.height = expectedHeight;\n  }\n}\n\nexport default RLottie;\n","import { getActions, getGlobal } from '../global';\n\nimport { AudioOrigin, GlobalSearchContent } from '../types';\nimport type { ApiMessage } from '../api/types';\n\nimport { IS_SAFARI } from './environment';\nimport safePlay from './safePlay';\nimport { patchSafariProgressiveAudio, isSafariPatchInProgress } from './patchSafariProgressiveAudio';\nimport type { MessageKey } from '../global/helpers';\nimport { getMessageKey, parseMessageKey } from '../global/helpers';\nimport { fastRaf } from './schedulers';\nimport { selectCurrentMessageList } from '../global/selectors';\n\ntype Handler = (eventName: string, e: Event) => void;\nexport type TrackId = `${MessageKey}-${number}`;\n\nexport interface Track {\n  audio: HTMLAudioElement;\n  proxy: HTMLAudioElement;\n  type: 'voice' | 'audio';\n  handlers: Handler[];\n  onForcePlay?: NoneToVoidFunction;\n  onTrackChange?: NoneToVoidFunction;\n}\n\nconst tracks = new Map<TrackId, Track>();\nlet voiceQueue: TrackId[] = [];\nlet musicQueue: TrackId[] = [];\n\nlet currentTrackId: TrackId | undefined;\n\nfunction createAudio(\n  trackId: TrackId,\n  type: Track['type'],\n  onForcePlay?: NoneToVoidFunction,\n  onTrackChange?: NoneToVoidFunction,\n): Track {\n  const audio = new Audio();\n\n  function handleEvent(eventName: string) {\n    return (e: Event) => {\n      if (!tracks.has(trackId)) {\n        return;\n      }\n\n      if (isSafariPatchInProgress(audio)) {\n        return;\n      }\n\n      tracks.get(trackId)!.handlers.forEach((handler) => {\n        handler(eventName, e);\n      });\n    };\n  }\n\n  audio.addEventListener('timeupdate', handleEvent('onTimeUpdate'));\n  audio.addEventListener('play', handleEvent('onPlay'));\n  audio.addEventListener('pause', handleEvent('onPause'));\n  audio.addEventListener('loadstart', handleEvent('onLoadStart'));\n  audio.addEventListener('loadeddata', handleEvent('onLoadedData'));\n  audio.addEventListener('playing', handleEvent('onPlaying'));\n  audio.addEventListener('ended', () => {\n    if (!tracks.has(trackId)) {\n      return;\n    }\n\n    if (isSafariPatchInProgress(audio)) {\n      return;\n    }\n\n    playNext(trackId);\n  });\n\n  return {\n    audio,\n    type,\n    proxy: new Proxy(audio, {\n      get: (target, key: keyof HTMLAudioElement) => target[key],\n    }),\n    handlers: [],\n    onForcePlay,\n    onTrackChange,\n  };\n}\n\nfunction playNext(trackId: TrackId, isReverseOrder?: boolean) {\n  const currentTrack = currentTrackId && tracks.get(currentTrackId);\n  if (currentTrack) {\n    currentTrack.audio.pause();\n    currentTrack.audio.currentTime = 0;\n    if (currentTrack.onTrackChange) currentTrack.onTrackChange();\n  }\n\n  const origin = getGlobal().audioPlayer.origin || AudioOrigin.Inline;\n\n  const nextTrackId = findNextInQueue(trackId, origin, isReverseOrder);\n  if (!nextTrackId) {\n    return;\n  }\n\n  if (!tracks.has(nextTrackId)) {\n    // A bit hacky way to continue playlist when switching chat\n    getActions().openAudioPlayer(parseMessageKey(splitTrackId(nextTrackId).messageKey));\n\n    return;\n  }\n\n  const nextTrack = tracks.get(nextTrackId)!;\n\n  if (nextTrack.onForcePlay) {\n    nextTrack.onForcePlay();\n  }\n\n  currentTrackId = nextTrackId;\n\n  if (nextTrack.audio.src) {\n    safePlay(nextTrack.audio);\n  }\n}\n\nexport function stopCurrentAudio() {\n  const currentTrack = currentTrackId && tracks.get(currentTrackId);\n  if (currentTrack) {\n    currentTrack.audio.pause();\n  }\n}\n\nexport function register(\n  trackId: TrackId,\n  trackType: Track['type'],\n  handler: Handler,\n  onForcePlay?: NoneToVoidFunction,\n  onTrackChange?: NoneToVoidFunction,\n) {\n  if (!tracks.has(trackId)) {\n    const track = createAudio(trackId, trackType, onForcePlay, onTrackChange);\n    tracks.set(trackId, track);\n    addTrackToQueue(track, trackId);\n  }\n  const { audio, proxy, handlers } = tracks.get(trackId)!;\n\n  handlers.push(handler);\n\n  return {\n    play(src: string) {\n      if (!audio.paused) return;\n      const currentTrack = currentTrackId && tracks.get(currentTrackId);\n      if (currentTrack && currentTrackId !== trackId) {\n        currentTrack.audio.pause();\n        currentTrack.audio.currentTime = 0;\n        if (isSafariPatchInProgress(currentTrack.audio)) {\n          currentTrack.audio.dataset.preventPlayAfterPatch = 'true';\n        }\n        if (currentTrack.onTrackChange) currentTrack.onTrackChange();\n      }\n\n      currentTrackId = trackId;\n\n      if (!audio.src) {\n        audio.src = src;\n        audio.preload = 'auto';\n\n        if (src.includes('/progressive/') && IS_SAFARI) {\n          delete audio.dataset.preventPlayAfterPatch;\n          patchSafariProgressiveAudio(audio);\n        }\n      }\n\n      safePlay(audio);\n      cleanUpQueue(trackType, trackId);\n    },\n\n    pause() {\n      if (currentTrackId === trackId) {\n        audio.pause();\n      }\n    },\n\n    stop() {\n      if (currentTrackId === trackId) {\n        // Hack, reset src to remove default media session notification\n        const prevSrc = audio.src;\n        audio.pause();\n        // onPause not called otherwise, but required to sync UI\n        fastRaf(() => {\n          audio.src = '';\n          audio.src = prevSrc;\n        });\n      }\n    },\n\n    setCurrentTime(time: number) {\n      if (currentTrackId === trackId) {\n        if (audio.fastSeek) {\n          audio.fastSeek(time);\n        } else {\n          audio.currentTime = time;\n        }\n      }\n    },\n\n    setVolume(volume: number) {\n      if (currentTrackId === trackId) {\n        audio.volume = volume;\n        audio.muted = false;\n      }\n    },\n\n    setPlaybackRate(rate: number) {\n      if (currentTrackId === trackId) {\n        audio.playbackRate = rate;\n      }\n    },\n\n    toggleMuted(muted?: boolean) {\n      if (muted === undefined) {\n        audio.muted = !audio.muted;\n      } else {\n        audio.muted = muted;\n      }\n    },\n\n    proxy,\n\n    requestNextTrack() {\n      playNext(trackId);\n    },\n\n    isLast() {\n      return !findNextInQueue(trackId, getGlobal().audioPlayer.origin);\n    },\n\n    isFirst() {\n      return !findNextInQueue(trackId, getGlobal().audioPlayer.origin, true);\n    },\n\n    requestPreviousTrack() {\n      playNext(trackId, true);\n    },\n\n    destroy(shouldRemoveFromQueue = false) {\n      const track = tracks.get(trackId);\n      if (!track) {\n        return;\n      }\n\n      track.handlers = track.handlers.filter((h) => h !== handler);\n\n      if (!track.handlers.length) {\n        track.audio.pause();\n        tracks.delete(trackId);\n\n        if (shouldRemoveFromQueue) {\n          removeFromQueue(track, trackId);\n        }\n\n        if (trackId === currentTrackId) {\n          currentTrackId = undefined;\n        }\n      }\n    },\n  };\n}\n\nfunction getTrackQueue(track: Track) {\n  switch (track.type) {\n    case 'audio': return musicQueue;\n    case 'voice': return voiceQueue;\n    default: return undefined;\n  }\n}\n\nfunction addTrackToQueue(track: Track, trackId: TrackId) {\n  if (track.type === 'audio' && !musicQueue.includes(trackId)) {\n    musicQueue.push(trackId);\n    musicQueue.sort(trackIdComparator);\n  }\n\n  if (track.type === 'voice' && !voiceQueue.includes(trackId)) {\n    voiceQueue.push(trackId);\n    voiceQueue.sort(trackIdComparator);\n  }\n}\n\nfunction removeFromQueue(track: Track, trackId: TrackId) {\n  const trackIdFilter = (el: TrackId) => el !== trackId;\n  if (track.type === 'audio') {\n    musicQueue = musicQueue.filter(trackIdFilter);\n  }\n\n  if (track.type === 'voice') {\n    voiceQueue = voiceQueue.filter(trackIdFilter);\n  }\n}\n\nfunction cleanUpQueue(type: Track['type'], trackId: TrackId) {\n  if (getGlobal().globalSearch.currentContent === GlobalSearchContent.Music) return;\n  const { chatId } = parseMessageKey(splitTrackId(trackId).messageKey);\n  const openedChatId = selectCurrentMessageList(getGlobal())?.chatId;\n  const queueFilter = (id: string) => (\n    id.startsWith(`msg${chatId}`) || (openedChatId && id.startsWith(`msg${openedChatId}`))\n  );\n\n  if (type === 'audio') {\n    musicQueue = musicQueue.filter(queueFilter);\n  }\n\n  if (type === 'voice') {\n    voiceQueue = voiceQueue.filter(queueFilter);\n  }\n}\n\nfunction findNextInQueue(currentId: TrackId, origin = AudioOrigin.Inline, isReverseOrder?: boolean) {\n  const track = tracks.get(currentId)!;\n  const queue = getTrackQueue(track);\n  if (!queue) return undefined;\n\n  if (origin === AudioOrigin.Search) {\n    const index = queue.indexOf(currentId);\n    if (index < 0) return undefined;\n    const direction = isReverseOrder ? -1 : 1;\n    return queue[index + direction];\n  }\n\n  const { chatId } = parseMessageKey(splitTrackId(currentId).messageKey);\n  const chatAudio = queue.filter((id) => id.startsWith(`msg${chatId}`));\n  const index = chatAudio.indexOf(currentId);\n  if (index < 0) return undefined;\n  let direction = origin === AudioOrigin.Inline ? -1 : 1;\n  if (isReverseOrder) direction *= -1;\n  return chatAudio[index + direction];\n}\n\nexport function makeTrackId(message: ApiMessage): TrackId {\n  return `${getMessageKey(message)}-${message.date}`;\n}\n\nfunction splitTrackId(trackId: TrackId) {\n  const messageKey = trackId.match(/^msg(-?\\d+)-(\\d+)/)![0] as MessageKey;\n  const date = Number(trackId.split('-').pop());\n  return {\n    messageKey,\n    date,\n  };\n}\n\n// Descending order by date\nfunction trackIdComparator(one?: TrackId, two?: TrackId) {\n  if (!one || !two) return 0;\n  const { date: dateOne, messageKey: keyOne } = splitTrackId(one);\n  const { date: dateTwo, messageKey: keyTwo } = splitTrackId(two);\n  const diff = dateTwo - dateOne;\n  return diff === 0 ? keyTwo.localeCompare(keyOne) : diff;\n}\n","import { IS_IOS } from './environment';\nimport { Lethargy } from './lethargy';\nimport { clamp, round } from './math';\nimport { debounce } from './schedulers';\n\nexport enum SwipeDirection {\n  Up,\n  Down,\n  Left,\n  Right,\n}\n\ninterface CaptureOptions {\n  onCapture?: (e: MouseEvent | TouchEvent | WheelEvent) => void;\n  onRelease?: (e: MouseEvent | TouchEvent | WheelEvent) => void;\n  onDrag?: (\n    e: MouseEvent | TouchEvent | WheelEvent,\n    captureEvent: MouseEvent | TouchEvent | WheelEvent,\n    params: {\n      dragOffsetX: number;\n      dragOffsetY: number;\n    },\n    cancelDrag?: (x: boolean, y: boolean) => void,\n  ) => void;\n  onSwipe?: (e: Event, direction: SwipeDirection) => boolean;\n  onZoom?: (e: TouchEvent | WheelEvent, params: {\n    // Absolute zoom level\n    zoom?: number;\n    // Relative zoom factor\n    zoomFactor?: number;\n\n    // center coordinate of the initial pinch\n    initialCenterX: number;\n    initialCenterY: number;\n\n    // offset of the pinch center (current from initial)\n    dragOffsetX: number;\n    dragOffsetY: number;\n\n    // center coordinate of the current pinch\n    currentCenterX: number;\n    currentCenterY: number;\n  }) => void;\n  onClick?: (e: MouseEvent | TouchEvent) => void;\n  onDoubleClick?: (e: MouseEvent | RealTouchEvent | WheelEvent, params: { centerX: number; centerY: number }) => void;\n  excludedClosestSelector?: string;\n  selectorToPreventScroll?: string;\n  withNativeDrag?: boolean;\n  maxZoom?: number;\n  minZoom?: number;\n  doubleTapZoom?: number;\n  initialZoom?: number;\n  isNotPassive?: boolean;\n  withCursor?: boolean;\n}\n\n// https://stackoverflow.com/questions/11287877/how-can-i-get-e-offsetx-on-mobile-ipad\n// Android does not have this value, and iOS has it but as read-only\nexport interface RealTouchEvent extends TouchEvent {\n  pageX?: number;\n  pageY?: number;\n}\n\ntype TSwipeAxis =\n  'x'\n  | 'y'\n  | undefined;\n\nexport const IOS_SCREEN_EDGE_THRESHOLD = 20;\nconst MOVED_THRESHOLD = 15;\nconst SWIPE_THRESHOLD = 50;\nconst RELEASE_WHEEL_ZOOM_DELAY = 150;\nconst RELEASE_WHEEL_DRAG_DELAY = 150;\n\nfunction getDistance(a: Touch, b?: Touch) {\n  if (!b) return 0;\n  return Math.hypot((b.pageX - a.pageX), (b.pageY - a.pageY));\n}\n\nfunction getTouchCenter(a: Touch, b: Touch) {\n  return {\n    x: (a.pageX + b.pageX) / 2,\n    y: (a.pageY + b.pageY) / 2,\n  };\n}\n\nlet lastClickTime = 0;\nconst lethargy = new Lethargy({\n  stability: 5,\n  sensitivity: 25,\n  tolerance: 0.6,\n  delay: 150,\n});\n\nexport function captureEvents(element: HTMLElement, options: CaptureOptions) {\n  let captureEvent: MouseEvent | RealTouchEvent | WheelEvent | undefined;\n  let hasMoved = false;\n  let hasSwiped = false;\n  let isZooming = false;\n  let initialDistance = 0;\n  let wheelZoom = options.initialZoom ?? 1;\n  let initialDragOffset = {\n    x: 0,\n    y: 0,\n  };\n  let isDragCanceled = {\n    x: false,\n    y: false,\n  };\n  let initialTouchCenter = {\n    x: window.innerWidth / 2,\n    y: window.innerHeight / 2,\n  };\n  let initialSwipeAxis: TSwipeAxis | undefined;\n  const minZoom = options.minZoom ?? 1;\n  const maxZoom = options.maxZoom ?? 4;\n\n  function onCapture(e: MouseEvent | RealTouchEvent) {\n    if (options.excludedClosestSelector && (\n      (e.target as HTMLElement).matches(options.excludedClosestSelector)\n      || (e.target as HTMLElement).closest(options.excludedClosestSelector)\n    )) {\n      return;\n    }\n\n    captureEvent = e;\n\n    if (e.type === 'mousedown') {\n      if (!options.withNativeDrag && options.onDrag) {\n        e.preventDefault();\n      }\n\n      document.addEventListener('mousemove', onMove);\n      document.addEventListener('mouseup', onRelease);\n    } else if (e.type === 'touchstart') {\n      // We need to always listen on `touchstart` target:\n      // https://stackoverflow.com/questions/33298828/touch-move-event-dont-fire-after-touch-start-target-is-removed\n      const target = e.target as HTMLElement;\n      target.addEventListener('touchmove', onMove, { passive: true });\n      target.addEventListener('touchend', onRelease);\n      target.addEventListener('touchcancel', onRelease);\n\n      if ('touches' in e) {\n        if (e.pageX === undefined) {\n          e.pageX = e.touches[0].pageX;\n        }\n\n        if (e.pageY === undefined) {\n          e.pageY = e.touches[0].pageY;\n        }\n\n        if (e.touches.length === 2) {\n          initialDistance = getDistance(e.touches[0], e.touches[1]);\n          initialTouchCenter = getTouchCenter(e.touches[0], e.touches[1]);\n        }\n      }\n    }\n\n    if (options.withCursor) {\n      document.body.classList.add('cursor-grabbing');\n    }\n\n    if (options.onCapture) {\n      options.onCapture(e);\n    }\n  }\n\n  function onRelease(e?: MouseEvent | TouchEvent) {\n    if (captureEvent) {\n      if (options.withCursor) {\n        document.body.classList.remove('cursor-grabbing');\n      }\n\n      document.removeEventListener('mouseup', onRelease);\n      document.removeEventListener('mousemove', onMove);\n      (captureEvent.target as HTMLElement).removeEventListener('touchcancel', onRelease);\n      (captureEvent.target as HTMLElement).removeEventListener('touchend', onRelease);\n      (captureEvent.target as HTMLElement).removeEventListener('touchmove', onMove);\n\n      if (IS_IOS && options.selectorToPreventScroll) {\n        Array.from(document.querySelectorAll<HTMLElement>(options.selectorToPreventScroll))\n          .forEach((scrollable) => {\n            scrollable.style.overflow = '';\n          });\n      }\n\n      if (e) {\n        if (hasMoved) {\n          if (options.onRelease) {\n            options.onRelease(e);\n          }\n        } else if (e.type === 'mouseup') {\n          if (options.onDoubleClick && Date.now() - lastClickTime < 300) {\n            options.onDoubleClick(e, {\n              centerX: captureEvent!.pageX!,\n              centerY: captureEvent!.pageY!,\n            });\n          } else if (options.onClick && (!('button' in e) || e.button === 0)) {\n            options.onClick(e);\n          }\n          lastClickTime = Date.now();\n        }\n      }\n    }\n\n    hasMoved = false;\n    hasSwiped = false;\n    isZooming = false;\n    initialDistance = 0;\n    wheelZoom = clamp(wheelZoom, minZoom, maxZoom);\n    initialSwipeAxis = undefined;\n    initialDragOffset = {\n      x: 0,\n      y: 0,\n    };\n    isDragCanceled = {\n      x: false,\n      y: false,\n    };\n    initialTouchCenter = {\n      x: window.innerWidth / 2,\n      y: window.innerHeight / 2,\n    };\n    captureEvent = undefined;\n  }\n\n  function onMove(e: MouseEvent | RealTouchEvent) {\n    if (captureEvent) {\n      if (e.type === 'touchmove' && ('touches' in e)) {\n        if (e.pageX === undefined) {\n          e.pageX = e.touches[0].pageX;\n        }\n\n        if (e.pageY === undefined) {\n          e.pageY = e.touches[0].pageY;\n        }\n\n        if (options.onZoom && initialDistance > 0 && e.touches.length === 2) {\n          const endDistance = getDistance(e.touches[0], e.touches[1]);\n          const touchCenter = getTouchCenter(e.touches[0], e.touches[1]);\n          const dragOffsetX = touchCenter.x - initialTouchCenter.x;\n          const dragOffsetY = touchCenter.y - initialTouchCenter.y;\n          const zoomFactor = endDistance / initialDistance;\n          options.onZoom(e, {\n            zoomFactor,\n            initialCenterX: initialTouchCenter.x,\n            initialCenterY: initialTouchCenter.y,\n            dragOffsetX,\n            dragOffsetY,\n            currentCenterX: touchCenter.x,\n            currentCenterY: touchCenter.y,\n          });\n          if (zoomFactor !== 1) hasMoved = true;\n        }\n      }\n\n      const dragOffsetX = e.pageX! - captureEvent.pageX!;\n      const dragOffsetY = e.pageY! - captureEvent.pageY!;\n\n      if (Math.abs(dragOffsetX) >= MOVED_THRESHOLD || Math.abs(dragOffsetY) >= MOVED_THRESHOLD) {\n        hasMoved = true;\n      }\n\n      let shouldPreventScroll = false;\n\n      if (options.onDrag) {\n        options.onDrag(e, captureEvent, {\n          dragOffsetX,\n          dragOffsetY,\n        });\n        shouldPreventScroll = true;\n      }\n\n      if (options.onSwipe && !hasSwiped) {\n        hasSwiped = onSwipe(e, dragOffsetX, dragOffsetY);\n        shouldPreventScroll = hasSwiped;\n      }\n\n      if (IS_IOS && shouldPreventScroll && options.selectorToPreventScroll) {\n        Array.from(document.querySelectorAll<HTMLElement>(options.selectorToPreventScroll))\n          .forEach((scrollable) => {\n            scrollable.style.overflow = 'hidden';\n          });\n      }\n    }\n  }\n\n  function onSwipe(e: MouseEvent | RealTouchEvent, dragOffsetX: number, dragOffsetY: number) {\n    // Avoid conflicts with swipe-to-back gestures\n    if (IS_IOS) {\n      const x = (e as RealTouchEvent).touches[0].pageX;\n      if (x <= IOS_SCREEN_EDGE_THRESHOLD || x >= window.innerWidth - IOS_SCREEN_EDGE_THRESHOLD) {\n        return false;\n      }\n    }\n\n    const xAbs = Math.abs(dragOffsetX);\n    const yAbs = Math.abs(dragOffsetY);\n\n    if (dragOffsetX && dragOffsetY) {\n      const ratio = Math.max(xAbs, yAbs) / Math.min(xAbs, yAbs);\n      // Diagonal swipe\n      if (ratio < 2) {\n        return false;\n      }\n    }\n\n    let axis: TSwipeAxis | undefined;\n    if (xAbs >= SWIPE_THRESHOLD) {\n      axis = 'x';\n    } else if (yAbs >= SWIPE_THRESHOLD) {\n      axis = 'y';\n    }\n\n    if (!axis) {\n      return false;\n    }\n\n    if (!initialSwipeAxis) {\n      initialSwipeAxis = axis;\n    } else if (initialSwipeAxis !== axis) {\n      // Prevent horizontal swipe after vertical to prioritize scroll\n      return false;\n    }\n\n    return processSwipe(e, axis, dragOffsetX, dragOffsetY, options.onSwipe!);\n  }\n\n  const releaseWheelDrag = debounce(onRelease, RELEASE_WHEEL_DRAG_DELAY, false);\n  const releaseWheelZoom = debounce(onRelease, RELEASE_WHEEL_ZOOM_DELAY, false);\n\n  function onWheelCapture(e: WheelEvent) {\n    if (hasMoved) return;\n    onCapture(e);\n    hasMoved = true;\n    initialTouchCenter = { x: e.x, y: e.y };\n  }\n\n  function onWheelZoom(e: WheelEvent) {\n    if (!options.onZoom) return;\n    onWheelCapture(e);\n    const dragOffsetX = e.x - initialTouchCenter.x;\n    const dragOffsetY = e.y - initialTouchCenter.y;\n    const delta = clamp(e.deltaY, -25, 25);\n    wheelZoom -= delta * 0.01;\n    wheelZoom = clamp(wheelZoom, minZoom * 0.5, maxZoom * 3);\n    options.onZoom(e, {\n      zoom: round(wheelZoom, 2),\n      initialCenterX: initialTouchCenter.x,\n      initialCenterY: initialTouchCenter.y,\n      dragOffsetX,\n      dragOffsetY,\n      currentCenterX: e.x,\n      currentCenterY: e.y,\n    });\n    releaseWheelZoom(e);\n  }\n\n  function onWheelDrag(e: WheelEvent) {\n    if (!options.onDrag) return;\n    onWheelCapture(e);\n    // Ignore wheel inertia if drag is canceled in this direction\n    if (!isDragCanceled.x || Math.sign(initialDragOffset.x) === Math.sign(e.deltaX)) {\n      initialDragOffset.x -= e.deltaX;\n    }\n    if (!isDragCanceled.y || Math.sign(initialDragOffset.y) === Math.sign(e.deltaY)) {\n      initialDragOffset.y -= e.deltaY;\n    }\n    const { x, y } = initialDragOffset;\n    options.onDrag(e, captureEvent!, {\n      dragOffsetX: x,\n      dragOffsetY: y,\n    }, (dx, dy) => {\n      isDragCanceled = { x: dx, y: dy };\n    });\n    releaseWheelDrag(e);\n  }\n\n  function onWheel(e: WheelEvent) {\n    if (!options.onZoom && !options.onDrag) return;\n    if (options.excludedClosestSelector && (\n      (e.target as HTMLElement).matches(options.excludedClosestSelector)\n      || (e.target as HTMLElement).closest(options.excludedClosestSelector)\n    )) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    const { doubleTapZoom = 3 } = options;\n    if (options.onDoubleClick && Object.is(e.deltaX, -0) && Object.is(e.deltaY, -0) && e.ctrlKey) {\n      onWheelCapture(e);\n      wheelZoom = wheelZoom > 1 ? 1 : doubleTapZoom;\n      options.onDoubleClick(e, { centerX: e.pageX, centerY: e.pageY });\n      hasMoved = false;\n      return;\n    }\n    const metaKeyPressed = e.metaKey || e.ctrlKey || e.shiftKey;\n    if (metaKeyPressed) {\n      onWheelZoom(e);\n    }\n    if (!metaKeyPressed && !isZooming) {\n      // Check if this event produced by user scroll and not by inertia\n      const isUserEvent = lethargy.check(e);\n      if (wheelZoom !== 1) {\n        onWheelDrag(e);\n      } else if (isUserEvent) {\n        onWheelDrag(e);\n      }\n    }\n  }\n\n  element.addEventListener('wheel', onWheel);\n  element.addEventListener('mousedown', onCapture);\n  element.addEventListener('touchstart', onCapture, { passive: !options.isNotPassive });\n\n  return () => {\n    onRelease();\n    element.removeEventListener('wheel', onWheel);\n    element.removeEventListener('touchstart', onCapture);\n    element.removeEventListener('mousedown', onCapture);\n  };\n}\n\nfunction processSwipe(\n  e: Event,\n  currentSwipeAxis: TSwipeAxis,\n  dragOffsetX: number,\n  dragOffsetY: number,\n  onSwipe: (e: Event, direction: SwipeDirection) => boolean,\n) {\n  if (currentSwipeAxis === 'x') {\n    if (dragOffsetX < 0) {\n      return onSwipe(e, SwipeDirection.Left);\n    } else {\n      return onSwipe(e, SwipeDirection.Right);\n    }\n  } else if (currentSwipeAxis === 'y') {\n    if (dragOffsetY < 0) {\n      return onSwipe(e, SwipeDirection.Up);\n    } else {\n      return onSwipe(e, SwipeDirection.Down);\n    }\n  }\n\n  return false;\n}\n","/**\n * Lethargy help distinguish between scroll events initiated by the user, and those by inertial scrolling.\n * Lethargy does not have external dependencies.\n *\n * @param stability - Specifies the length of the rolling average.\n * In effect, the larger the value, the smoother the curve will be.\n * This attempts to prevent anomalies from firing 'real' events. Valid values are all positive integers,\n * but in most cases, you would need to stay between 5 and around 30.\n *\n * @param sensitivity - Specifies the minimum value for wheelDelta for it to register as a valid scroll event.\n * Because the tail of the curve have low wheelDelta values,\n * this will stop them from registering as valid scroll events.\n * The unofficial standard wheelDelta is 120, so valid values are positive integers below 120.\n *\n * @param tolerance - Prevent small fluctuations from affecting results.\n * Valid values are decimals from 0, but should ideally be between 0.05 and 0.3.\n *\n * Based on https://github.com/d4nyll/lethargy\n */\n\nexport type LethargyConfig = {\n  stability?: number;\n  sensitivity?: number;\n  tolerance?: number;\n  delay?: number;\n};\n\nexport class Lethargy {\n  stability: number;\n\n  sensitivity: number;\n\n  tolerance: number;\n\n  delay: number;\n\n  lastUpDeltas: Array<number>;\n\n  lastDownDeltas: Array<number>;\n\n  deltasTimestamp: Array<number>;\n\n  constructor({\n    stability = 8,\n    sensitivity = 100,\n    tolerance = 1.1,\n    delay = 150,\n  }: LethargyConfig = {}) {\n    this.stability = stability;\n    this.sensitivity = sensitivity;\n    this.tolerance = tolerance;\n    this.delay = delay;\n    this.lastUpDeltas = new Array(this.stability * 2).fill(0);\n    this.lastDownDeltas = new Array(this.stability * 2).fill(0);\n    this.deltasTimestamp = new Array(this.stability * 2).fill(0);\n  }\n\n  check(e: any) {\n    let lastDelta;\n    e = e.originalEvent || e;\n    if (e.wheelDelta !== undefined) {\n      lastDelta = e.wheelDelta;\n    } else if (e.deltaY !== undefined) {\n      lastDelta = e.deltaY * -40;\n    } else if (e.detail !== undefined || e.detail === 0) {\n      lastDelta = e.detail * -40;\n    }\n    this.deltasTimestamp.push(Date.now());\n    this.deltasTimestamp.shift();\n    if (lastDelta > 0) {\n      this.lastUpDeltas.push(lastDelta);\n      this.lastUpDeltas.shift();\n      return this.isInertia(1);\n    } else {\n      this.lastDownDeltas.push(lastDelta);\n      this.lastDownDeltas.shift();\n      return this.isInertia(-1);\n    }\n  }\n\n  isInertia(direction: number) {\n    const lastDeltas = direction === -1 ? this.lastDownDeltas : this.lastUpDeltas;\n    if (lastDeltas[0] === undefined) return direction;\n    if (\n      this.deltasTimestamp[this.stability * 2 - 2] + this.delay > Date.now()\n      && lastDeltas[0] === lastDeltas[this.stability * 2 - 1]\n    ) {\n      return false;\n    }\n    const lastDeltasOld = lastDeltas.slice(0, this.stability);\n    const lastDeltasNew = lastDeltas.slice(this.stability, this.stability * 2);\n    const oldSum = lastDeltasOld.reduce((t, s) => t + s);\n    const newSum = lastDeltasNew.reduce((t, s) => t + s);\n    const oldAverage = oldSum / lastDeltasOld.length;\n    const newAverage = newSum / lastDeltasNew.length;\n    return Math.abs(oldAverage) < Math.abs(newAverage * this.tolerance)\n      && this.sensitivity < Math.abs(newAverage);\n  }\n}\n","/* eslint-disable eqeqeq */\n/* eslint-disable prefer-template */\n/* eslint-disable prefer-const */\n/* eslint-disable prefer-destructuring */\n/* eslint-disable one-var */\n/* eslint-disable one-var-declaration-per-line */\n\nimport { preloadImage } from './files';\n\n/**\n * HEX > RGB\n * input: 'xxxxxx' (ex. 'ed15fa') case-insensitive\n * output: [r, g, b] ([0-255, 0-255, 0-255])\n */\nexport function hex2rgb(param: string): [number, number, number] {\n  return [\n    parseInt(param.substring(0, 2), 16),\n    parseInt(param.substring(2, 4), 16),\n    parseInt(param.substring(4, 6), 16),\n  ];\n}\n\n/**\n * RGB > HEX\n * input: [r, g, b] ([0-255, 0-255, 0-255])\n * output: 'xxxxxx' (ex. 'ff0000')\n */\nexport function rgb2hex(param: [number, number, number]) {\n  const p0 = param[0].toString(16);\n  const p1 = param[1].toString(16);\n  const p2 = param[2].toString(16);\n  return (p0.length == 1 ? '0' + p0 : p0) + (p1.length == 1 ? '0' + p1 : p1) + (p2.length == 1 ? '0' + p2 : p2);\n}\n\n/**\n * Converts an RGB color value to HSV. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSV_color_space.\n * Assumes r, g, and b are contained in the set [0, 255] and\n * returns h, s, and v in the set [0, 1].\n *\n * @param   Number  r       The red color value\n * @param   Number  g       The green color value\n * @param   Number  b       The blue color value\n * @return  Array           The HSV representation\n */\nexport function rgb2hsb([r, g, b]: [number, number, number]): [number, number, number] {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  let max = Math.max(r, g, b), min = Math.min(r, g, b);\n  let h!: number, s: number, v: number = max;\n\n  let d = max - min;\n  s = max == 0 ? 0 : d / max;\n\n  if (max == min) {\n    h = 0; // achromatic\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n\n    h /= 6;\n  }\n\n  return [h, s, v];\n}\n\n/**\n * Converts an HSV color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSV_color_space.\n * Assumes h, s, and v are contained in the set [0, 1] and\n * returns r, g, and b in the set [0, 255].\n *\n * @param   Number  h       The hue\n * @param   Number  s       The saturation\n * @param   Number  v       The value\n * @return  Array           The RGB representation\n */\nexport function hsb2rgb([h, s, v]: [number, number, number]): [number, number, number] {\n  let r!: number, g!: number, b!: number;\n\n  let i = Math.floor(h * 6);\n  let f = h * 6 - i;\n  let p = v * (1 - s);\n  let q = v * (1 - f * s);\n  let t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0:\n      r = v;\n      g = t;\n      b = p;\n      break;\n    case 1:\n      r = q;\n      g = v;\n      b = p;\n      break;\n    case 2:\n      r = p;\n      g = v;\n      b = t;\n      break;\n    case 3:\n      r = p;\n      g = q;\n      b = v;\n      break;\n    case 4:\n      r = t;\n      g = p;\n      b = v;\n      break;\n    case 5:\n      r = v;\n      g = p;\n      b = q;\n      break;\n  }\n\n  return [\n    Math.round(r * 255),\n    Math.round(g * 255),\n    Math.round(b * 255),\n  ];\n}\n\nexport async function getAverageColor(url: string): Promise<[number, number, number]> {\n  // Only visit every 5 pixels\n  const blockSize = 5;\n  const defaultRGB: [number, number, number] = [0, 0, 0];\n  let data;\n  let width;\n  let height;\n  let i = -4;\n  let length;\n  let rgb: [number, number, number] = [0, 0, 0];\n  let count = 0;\n\n  const canvas = document.createElement('canvas');\n  const context = canvas.getContext && canvas.getContext('2d');\n  if (!context) {\n    return defaultRGB;\n  }\n\n  const image = await preloadImage(url);\n  height = image.naturalHeight || image.offsetHeight || image.height;\n  width = image.naturalWidth || image.offsetWidth || image.width;\n  canvas.height = height;\n  canvas.width = width;\n\n  context.drawImage(image, 0, 0);\n\n  try {\n    data = context.getImageData(0, 0, width, height);\n  } catch (e) {\n    return defaultRGB;\n  }\n\n  length = data.data.length;\n\n  // eslint-disable-next-line no-cond-assign\n  while ((i += blockSize * 4) < length) {\n    if (data.data[i + 3] === 0) continue; // Ignore fully transparent pixels\n    ++count;\n    rgb[0] += data.data[i];\n    rgb[1] += data.data[i + 1];\n    rgb[2] += data.data[i + 2];\n  }\n\n  rgb[0] = Math.floor(rgb[0] / count);\n  rgb[1] = Math.floor(rgb[1] / count);\n  rgb[2] = Math.floor(rgb[2] / count);\n\n  return rgb;\n}\n\nexport function getColorLuma(rgbColor: [number, number, number]) {\n  const [r, g, b] = rgbColor;\n  const luma = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n  return luma;\n}\n\n// eslint-disable-next-line max-len\n// Function was adapted from https://github.com/telegramdesktop/tdesktop/blob/35ff621b5b52f7e3553fb0f990ea13ade7101b8e/Telegram/SourceFiles/data/data_wall_paper.cpp#L518\nexport function getPatternColor(rgbColor: [number, number, number]) {\n  let [hue, saturation, value] = rgb2hsb(rgbColor);\n\n  saturation = Math.min(1, saturation + 0.05 + 0.1 * (1 - saturation));\n  value = value > 0.5\n    ? Math.max(0, value * 0.65)\n    : Math.max(0, Math.min(1, 1 - value * 0.65));\n\n  return `hsla(${hue * 360}, ${saturation * 100}%, ${value * 100}%, .4)`;\n}\n","export default function cycleRestrict(length: number, index: number) {\n  return index - Math.floor(index / length) * length;\n}\n","import { getGlobal } from '../global';\n\nimport { FocusDirection } from '../types';\n\nimport {\n  ANIMATION_LEVEL_MIN,\n  FAST_SMOOTH_MAX_DISTANCE, FAST_SMOOTH_MAX_DURATION, FAST_SMOOTH_MIN_DURATION,\n  FAST_SMOOTH_SHORT_TRANSITION_MAX_DISTANCE,\n} from '../config';\nimport { IS_ANDROID } from './environment';\nimport { dispatchHeavyAnimationEvent } from '../hooks/useHeavyAnimationCheck';\nimport { animateSingle } from './animation';\nimport { fastRaf } from './schedulers';\n\nlet isAnimating = false;\n\nexport default function fastSmoothScroll(\n  container: HTMLElement,\n  element: HTMLElement,\n  position: ScrollLogicalPosition | 'centerOrTop',\n  margin = 0,\n  maxDistance = FAST_SMOOTH_MAX_DISTANCE,\n  forceDirection?: FocusDirection,\n  forceDuration?: number,\n  forceNormalContainerHeight?: boolean,\n) {\n  const scrollFrom = calculateScrollFrom(container, element, maxDistance, forceDirection);\n\n  if (forceDirection === FocusDirection.Static) {\n    scrollWithJs(container, element, scrollFrom, position, margin, 0);\n    return;\n  }\n\n  if (getGlobal().settings.byKey.animationLevel === ANIMATION_LEVEL_MIN) {\n    forceDuration = 0;\n  }\n\n  scrollWithJs(container, element, scrollFrom, position, margin, forceDuration, forceNormalContainerHeight);\n}\n\nexport function isAnimatingScroll() {\n  return isAnimating;\n}\n\nfunction calculateScrollFrom(\n  container: HTMLElement,\n  element: HTMLElement,\n  maxDistance = FAST_SMOOTH_MAX_DISTANCE,\n  forceDirection?: FocusDirection,\n) {\n  const { offsetTop: elementTop } = element;\n  const { scrollTop } = container;\n\n  if (forceDirection === undefined) {\n    const offset = elementTop - container.scrollTop;\n\n    if (offset < -maxDistance) {\n      return scrollTop + (offset + maxDistance);\n    } else if (offset > maxDistance) {\n      return scrollTop + (offset - maxDistance);\n    }\n  } else if (forceDirection === FocusDirection.Up) {\n    return elementTop + maxDistance;\n  } else if (forceDirection === FocusDirection.Down) {\n    return Math.max(0, elementTop - maxDistance);\n  }\n\n  return scrollTop;\n}\n\nfunction scrollWithJs(\n  container: HTMLElement,\n  element: HTMLElement,\n  scrollFrom: number,\n  position: ScrollLogicalPosition | 'centerOrTop',\n  margin = 0,\n  forceDuration?: number,\n  forceNormalContainerHeight?: boolean,\n) {\n  const { offsetTop: elementTop, offsetHeight: elementHeight } = element;\n  const { scrollTop: currentScrollTop, offsetHeight: containerHeight, scrollHeight } = container;\n  const targetContainerHeight = forceNormalContainerHeight && container.dataset.normalHeight\n    ? Number(container.dataset.normalHeight)\n    : containerHeight;\n\n  if (currentScrollTop !== scrollFrom) {\n    container.scrollTop = scrollFrom;\n  }\n\n  let path!: number;\n\n  switch (position) {\n    case 'start':\n      path = (elementTop - margin) - scrollFrom + (IS_ANDROID ? 1 : 0);\n      break;\n    case 'end':\n      path = (elementTop + elementHeight + margin) - (scrollFrom + targetContainerHeight);\n      break;\n    // 'nearest' is not supported yet\n    case 'nearest':\n    case 'center':\n    case 'centerOrTop':\n      path = elementHeight < targetContainerHeight\n        ? (elementTop + elementHeight / 2) - (scrollFrom + targetContainerHeight / 2)\n        : (elementTop - margin) - scrollFrom;\n      break;\n  }\n\n  if (path < 0) {\n    const remainingPath = -scrollFrom;\n    path = Math.max(path, remainingPath);\n  } else if (path > 0) {\n    const remainingPath = scrollHeight - (scrollFrom + targetContainerHeight);\n    path = Math.min(path, remainingPath);\n  }\n\n  if (path === 0) {\n    return;\n  }\n\n  const target = scrollFrom + path;\n\n  if (forceDuration === 0) {\n    container.scrollTop = target;\n    return;\n  }\n\n  isAnimating = true;\n\n  const absPath = Math.abs(path);\n  const transition = absPath < FAST_SMOOTH_SHORT_TRANSITION_MAX_DISTANCE ? shortTransition : longTransition;\n  const duration = forceDuration || (\n    FAST_SMOOTH_MIN_DURATION\n    + (absPath / FAST_SMOOTH_MAX_DISTANCE) * (FAST_SMOOTH_MAX_DURATION - FAST_SMOOTH_MIN_DURATION)\n  );\n  const startAt = Date.now();\n  const onHeavyAnimationStop = dispatchHeavyAnimationEvent();\n\n  fastRaf(() => {\n    animateSingle(() => {\n      const t = Math.min((Date.now() - startAt) / duration, 1);\n      const currentPath = path * (1 - transition(t));\n\n      container.scrollTop = Math.round(target - currentPath);\n\n      isAnimating = t < 1;\n\n      if (!isAnimating) {\n        onHeavyAnimationStop();\n      }\n\n      return isAnimating;\n    });\n  });\n}\n\nfunction longTransition(t: number) {\n  return 1 - ((1 - t) ** 5);\n}\n\nfunction shortTransition(t: number) {\n  return 1 - ((1 - t) ** 3.5);\n}\n","import { getGlobal } from '../global';\n\nimport { ANIMATION_LEVEL_MIN } from '../config';\nimport { animate } from './animation';\n\nconst DEFAULT_DURATION = 300;\n\nconst stopById: Map<string, VoidFunction> = new Map();\n\nexport default function fastSmoothScrollHorizontal(container: HTMLElement, left: number, duration = DEFAULT_DURATION) {\n  if (getGlobal().settings.byKey.animationLevel === ANIMATION_LEVEL_MIN) {\n    duration = 0;\n  }\n\n  return scrollWithJs(container, left, duration);\n}\n\nfunction scrollWithJs(container: HTMLElement, left: number, duration: number) {\n  const isRtl = container.getAttribute('dir') === 'rtl';\n  const {\n    scrollLeft, offsetWidth: containerWidth, scrollWidth, dataset: { scrollId },\n  } = container;\n\n  let path = left - scrollLeft;\n\n  if (path < 0) {\n    const remainingPath = -scrollLeft * (isRtl ? -1 : 1);\n    path = Math.max(path, remainingPath);\n  } else if (path > 0) {\n    const remainingPath = scrollWidth - (scrollLeft + containerWidth);\n    path = Math.min(path, remainingPath);\n  }\n\n  if (path === 0) {\n    return Promise.resolve();\n  }\n\n  if (scrollId && stopById.has(scrollId)) {\n    stopById.get(scrollId)!();\n  }\n\n  const target = scrollLeft + path;\n\n  if (duration === 0) {\n    container.scrollLeft = target;\n    return Promise.resolve();\n  }\n\n  let isStopped = false;\n  const id = Math.random().toString();\n  container.dataset.scrollId = id;\n  stopById.set(id, () => {\n    isStopped = true;\n  });\n\n  container.style.scrollSnapType = 'none';\n\n  let resolve: VoidFunction;\n  const promise = new Promise<void>((r) => {\n    resolve = r;\n  });\n  const startAt = Date.now();\n\n  animate(() => {\n    if (isStopped) return false;\n\n    const t = Math.min((Date.now() - startAt) / duration, 1);\n\n    const currentPath = path * (1 - transition(t));\n    container.scrollLeft = Math.round(target - currentPath);\n\n    if (t >= 1) {\n      container.style.scrollSnapType = '';\n      container.dataset.scrollId = undefined;\n      stopById.delete(id);\n      resolve();\n    }\n    return t < 1;\n  });\n\n  return promise;\n}\n\nfunction transition(t: number) {\n  return 1 - ((1 - t) ** 3.5);\n}\n","import { IS_TOUCH_ENV } from './environment';\n\nexport default function focusEditableElement(element: HTMLElement, force?: boolean, forcePlaceCaretAtEnd?: boolean) {\n  if (!force && element === document.activeElement) {\n    return;\n  }\n\n  const selection = window.getSelection()!;\n  const range = document.createRange();\n  const lastChild = element.lastChild || element;\n\n  if (!IS_TOUCH_ENV && !forcePlaceCaretAtEnd && (!lastChild || !lastChild.nodeValue)) {\n    element.focus();\n    return;\n  }\n\n  range.selectNodeContents(forcePlaceCaretAtEnd ? element : lastChild);\n  // `false` means collapse to the end rather than the start\n  range.collapse(false);\n  selection.removeAllRanges();\n  selection.addRange(range);\n}\n","import { MESSAGE_CONTENT_CLASS_NAME } from '../config';\n\nconst ELEMENT_NODE = 1;\n\nexport default function getMessageIdsForSelectedText() {\n  const selection = window.getSelection();\n  let selectedFragments = selection?.rangeCount ? selection.getRangeAt(0).cloneContents() : undefined;\n\n  const shouldIncludeLastMessage = selection?.focusNode && selection.focusOffset > 0\n    && hasParentWithClassName(selection.focusNode, MESSAGE_CONTENT_CLASS_NAME);\n  if (!selectedFragments || selectedFragments.childElementCount === 0) {\n    return undefined;\n  }\n\n  const messageIds = Array.from(selectedFragments.children)\n    .reduce((result, node) => {\n      if (node.nodeType === ELEMENT_NODE && node.classList.contains('message-date-group')) {\n        return Array.from(node.querySelectorAll('.Message'))\n          .reduce((acc, messageEl) => acc.concat(Number((messageEl as HTMLElement).dataset.messageId)), result);\n      } else if (node.nodeType === ELEMENT_NODE && node.classList.contains('Message')) {\n        return result.concat(Number((node as HTMLElement).dataset.messageId));\n      }\n\n      return result;\n    }, [] as number[]);\n\n  // Cleanup a document fragment because it is playing media content in the background\n  while (selectedFragments.firstChild) {\n    selectedFragments.removeChild(selectedFragments.firstChild);\n  }\n  selectedFragments = undefined;\n\n  if (!shouldIncludeLastMessage) {\n    messageIds.pop();\n  }\n\n  return messageIds;\n}\n\nfunction hasParentWithClassName(element: Node, className: string): boolean {\n  if (element.nodeType === ELEMENT_NODE && (element as HTMLElement).classList.contains(className)) {\n    return true;\n  }\n\n  return element.parentNode ? hasParentWithClassName(element.parentNode, className) : false;\n}\n","import windowSize from './windowSize';\n\nexport function isElementInViewport(el: HTMLElement) {\n  if (el.style.display === 'none') {\n    return false;\n  }\n\n  const rect = el.getBoundingClientRect();\n  const { height: windowHeight } = windowSize.get();\n\n  return (rect.top <= windowHeight) && ((rect.top + rect.height) >= 0);\n}\n","export type MediaSessionHandlers = {\n  play?: () => void;\n  pause?: () => void;\n  stop?: () => void;\n\n  previoustrack?: () => void;\n  nexttrack?: () => void;\n\n  togglemicrophone?: () => void;\n  togglecamera?: () => void;\n  hangup?: () => void;\n\n  seekbackward?: (details: MediaSessionActionDetails) => void;\n  seekforward?: (details: MediaSessionActionDetails) => void;\n  seekTo?: ((details: MediaSessionActionDetails) => void);\n};\n\ninterface MediaMetadataParameters {\n  title?: string;\n  artist?: string;\n  album?: string;\n  artwork?: MediaImage[];\n}\n\nconst DEFAULT_HANDLERS = {\n  play: undefined,\n  pause: undefined,\n  seekbackward: undefined,\n  seekforward: undefined,\n  previoustrack: undefined,\n  nexttrack: undefined,\n  stop: undefined,\n  seekTo: undefined,\n};\n\nexport function registerMediaSession(metadata?: MediaMetadata, handlers?: MediaSessionHandlers) {\n  const { mediaSession } = window.navigator;\n  if (mediaSession) {\n    if (metadata) updateMetadata(metadata);\n    if (handlers) setMediaSessionHandlers(handlers);\n  } else {\n    // eslint-disable-next-line no-console\n    console.warn('MediaSession API not supported in this browser');\n  }\n}\n\nexport function updateMetadata(metadata?: MediaMetadata) {\n  const { mediaSession } = window.navigator;\n  if (mediaSession) {\n    // eslint-disable-next-line no-null/no-null\n    mediaSession.metadata = metadata ?? null;\n  }\n}\n\nexport function setMediaSessionHandlers(handlers: MediaSessionHandlers) {\n  const { mediaSession } = window.navigator;\n  if (mediaSession) {\n    Object.entries({ ...DEFAULT_HANDLERS, ...handlers }).forEach(([key, handler]) => {\n      try {\n        // @ts-ignore API not standardized yet\n        mediaSession.setActionHandler(key, handler);\n      } catch (err) {\n        // Handler not supported, ignoring\n      }\n    });\n  }\n}\n\nexport function clearMediaSession() {\n  const { mediaSession } = window.navigator;\n  if (mediaSession) {\n    // eslint-disable-next-line no-null/no-null\n    mediaSession.metadata = null;\n    setMediaSessionHandlers(DEFAULT_HANDLERS);\n    if (mediaSession.playbackState) mediaSession.playbackState = 'none';\n    mediaSession.setPositionState?.();\n  }\n}\n\nexport function setPlaybackState(state: 'none' | 'paused' | 'playing' = 'none') {\n  const { mediaSession } = window.navigator;\n  if (mediaSession && mediaSession.playbackState) {\n    mediaSession.playbackState = state;\n  }\n}\n\nexport function setPositionState(state?: MediaPositionState) {\n  if (!state || state.position === undefined || state.duration === undefined) return;\n  state.position = Math.min(state.position, state.duration);\n\n  const { mediaSession } = window.navigator;\n  mediaSession?.setPositionState?.(state);\n}\n\nexport function buildMediaMetadata({\n  title, artist, album, artwork,\n}: MediaMetadataParameters) {\n  if ('MediaMetadata' in window) {\n    return new window.MediaMetadata({\n      title,\n      artist,\n      album,\n      artwork,\n    });\n  }\n  return undefined;\n}\n","import twemojiRegex from '../lib/twemojiRegex';\n\nconst DETECT_UP_TO = 100;\nconst MAX_LENGTH = DETECT_UP_TO * 8; // Maximum 8 per one emoji.\nconst RE_EMOJI_ONLY = new RegExp(`^(?:${twemojiRegex.source})+$`, '');\n\nconst parseEmojiOnlyString = (text: string): number | false => {\n  const lines = text.split('\\n');\n  const textWithoutNewlines = lines.join('');\n  if (textWithoutNewlines.length > MAX_LENGTH) {\n    return false;\n  }\n\n  const isEmojiOnly = Boolean(textWithoutNewlines.match(RE_EMOJI_ONLY));\n  if (!isEmojiOnly) {\n    return false;\n  }\n  const countPerLine = lines.map((line) => {\n    let emojiCount = 0;\n    while (twemojiRegex.exec(line)) {\n      emojiCount++;\n\n      if (emojiCount > DETECT_UP_TO) {\n        twemojiRegex.lastIndex = 0;\n        return -1;\n      }\n    }\n\n    return emojiCount;\n  });\n\n  let max = lines.length;\n  for (let i = 0; i < countPerLine.length; i++) {\n    if (countPerLine[i] === -1) {\n      return false;\n    }\n    if (countPerLine[i] > max) {\n      max = countPerLine[i];\n    }\n  }\n\n  return max;\n};\n\nexport default parseEmojiOnlyString;\n","import type { ApiMessageEntity, ApiFormattedText } from '../api/types';\nimport { ApiMessageEntityTypes } from '../api/types';\nimport { RE_LINK_TEMPLATE } from '../config';\n\nexport const ENTITY_CLASS_BY_NODE_NAME: Record<string, ApiMessageEntityTypes> = {\n  B: ApiMessageEntityTypes.Bold,\n  STRONG: ApiMessageEntityTypes.Bold,\n  I: ApiMessageEntityTypes.Italic,\n  EM: ApiMessageEntityTypes.Italic,\n  U: ApiMessageEntityTypes.Underline,\n  S: ApiMessageEntityTypes.Strike,\n  STRIKE: ApiMessageEntityTypes.Strike,\n  DEL: ApiMessageEntityTypes.Strike,\n  CODE: ApiMessageEntityTypes.Code,\n  PRE: ApiMessageEntityTypes.Pre,\n  BLOCKQUOTE: ApiMessageEntityTypes.Blockquote,\n};\n\nconst MAX_TAG_DEEPNESS = 3;\n\nexport default function parseMessageInput(\n  html: string, withMarkdownLinks = false, skipMarkdown = false,\n): ApiFormattedText {\n  const fragment = document.createElement('div');\n  fragment.innerHTML = skipMarkdown ? html\n    : withMarkdownLinks ? parseMarkdown(parseMarkdownLinks(html)) : parseMarkdown(html);\n  fixImageContent(fragment);\n  const text = fragment.innerText.trim().replace(/\\u200b+/g, '');\n  const trimShift = fragment.innerText.indexOf(text[0]);\n  let textIndex = -trimShift;\n  let recursionDeepness = 0;\n  const entities: ApiMessageEntity[] = [];\n\n  function addEntity(node: ChildNode) {\n    if (node.nodeType === Node.COMMENT_NODE) return;\n    const { index, entity } = getEntityDataFromNode(node, text, textIndex);\n\n    if (entity) {\n      textIndex = index;\n      entities.push(entity);\n    } else if (node.textContent) {\n      // Skip newlines on the beginning\n      if (index === 0 && node.textContent.trim() === '') {\n        return;\n      }\n      textIndex += node.textContent.length;\n    }\n\n    if (node.hasChildNodes() && recursionDeepness <= MAX_TAG_DEEPNESS) {\n      recursionDeepness += 1;\n      Array.from(node.childNodes).forEach(addEntity);\n    }\n  }\n\n  Array.from(fragment.childNodes).forEach((node) => {\n    recursionDeepness = 1;\n    addEntity(node);\n  });\n\n  return {\n    text,\n    entities: entities.length ? entities : undefined,\n  };\n}\n\nfunction fixImageContent(fragment: HTMLDivElement) {\n  fragment.querySelectorAll('img').forEach((node) => {\n    if (node.dataset.documentId) { // Custom Emoji\n      node.textContent = (node as HTMLImageElement).alt || '';\n    } else { // Regular emoji with image fallback\n      node.replaceWith(node.alt || '');\n    }\n  });\n}\n\nfunction parseMarkdown(html: string) {\n  let parsedHtml = html.slice(0);\n\n  // Strip redundant nbsp's\n  parsedHtml = parsedHtml.replace(/&nbsp;/g, ' ');\n\n  // Replace <div><br></div> with newline (new line in Safari)\n  parsedHtml = parsedHtml.replace(/<div><br([^>]*)?><\\/div>/g, '\\n');\n  // Replace <br> with newline\n  parsedHtml = parsedHtml.replace(/<br([^>]*)?>/g, '\\n');\n\n  // Strip redundant <div> tags\n  parsedHtml = parsedHtml.replace(/<\\/div>(\\s*)<div>/g, '\\n');\n  parsedHtml = parsedHtml.replace(/<div>/g, '\\n');\n  parsedHtml = parsedHtml.replace(/<\\/div>/g, '');\n\n  // Pre\n  parsedHtml = parsedHtml.replace(/^`{3}(.*?)[\\n\\r](.*?[\\n\\r]?)`{3}/gms, '<pre data-language=\"$1\">$2</pre>');\n  parsedHtml = parsedHtml.replace(/^`{3}[\\n\\r]?(.*?)[\\n\\r]?`{3}/gms, '<pre>$1</pre>');\n  parsedHtml = parsedHtml.replace(/[`]{3}([^`]+)[`]{3}/g, '<pre>$1</pre>');\n\n  // Code\n  parsedHtml = parsedHtml.replace(\n    /(?!<(code|pre)[^<]*|<\\/)[`]{1}([^`\\n]+)[`]{1}(?![^<]*<\\/(code|pre)>)/g,\n    '<code>$2</code>',\n  );\n\n  // Custom Emoji markdown tag\n  parsedHtml = parsedHtml.replace(\n    /(^|\\s)(?!<(?:code|pre)[^<]*|<\\/)\\[([^\\]\\n]+)\\]\\(customEmoji:(\\d+)\\)(?![^<]*<\\/(?:code|pre)>)(\\s|$)/g,\n    '$1<img alt=\"$2\" data-document-id=\"$3\">$4',\n  );\n\n  // Other simple markdown\n  parsedHtml = parsedHtml.replace(\n    /(^|\\s)(?!<(code|pre)[^<]*|<\\/)[*]{2}([^*\\n]+)[*]{2}(?![^<]*<\\/(code|pre)>)(\\s|$)/g,\n    '$1<b>$3</b>$5',\n  );\n  parsedHtml = parsedHtml.replace(\n    /(^|\\s)(?!<(code|pre)[^<]*|<\\/)[_]{2}([^_\\n]+)[_]{2}(?![^<]*<\\/(code|pre)>)(\\s|$)/g,\n    '$1<i>$3</i>$5',\n  );\n  parsedHtml = parsedHtml.replace(\n    /(^|\\s)(?!<(code|pre)[^<]*|<\\/)[~]{2}([^~\\n]+)[~]{2}(?![^<]*<\\/(code|pre)>)(\\s|$)/g,\n    '$1<s>$3</s>$5',\n  );\n  parsedHtml = parsedHtml.replace(\n    /(^|\\s)(?!<(code|pre)[^<]*|<\\/)[|]{2}([^|\\n]+)[|]{2}(?![^<]*<\\/(code|pre)>)(\\s|$)/g,\n    `$1<span data-entity-type=\"${ApiMessageEntityTypes.Spoiler}\">$3</span>$5`,\n  );\n\n  return parsedHtml;\n}\n\nfunction parseMarkdownLinks(html: string) {\n  return html.replace(new RegExp(`\\\\[([^\\\\]]+?)]\\\\((${RE_LINK_TEMPLATE}+?)\\\\)`, 'g'), (_, text, link) => {\n    const url = link.includes('://') ? link : link.includes('@') ? `mailto:${link}` : `http://${link}`;\n    return `<a href=\"${url}\">${text}</a>`;\n  });\n}\n\nfunction getEntityDataFromNode(\n  node: ChildNode,\n  rawText: string,\n  textIndex: number,\n): { index: number; entity?: ApiMessageEntity } {\n  const type = getEntityTypeFromNode(node);\n\n  if (!type || !node.textContent) {\n    return {\n      index: textIndex,\n      entity: undefined,\n    };\n  }\n\n  const rawIndex = rawText.indexOf(node.textContent, textIndex);\n  // In some cases, last text entity ends with a newline (which gets trimmed from `rawText`).\n  // In this case, `rawIndex` would return `-1`, so we use `textIndex` instead.\n  const index = rawIndex >= 0 ? rawIndex : textIndex;\n  const offset = rawText.substring(0, index).length;\n  const { length } = rawText.substring(index, index + node.textContent.length);\n\n  if (type === ApiMessageEntityTypes.TextUrl) {\n    return {\n      index,\n      entity: {\n        type,\n        offset,\n        length,\n        url: (node as HTMLAnchorElement).href,\n      },\n    };\n  }\n  if (type === ApiMessageEntityTypes.MentionName) {\n    return {\n      index,\n      entity: {\n        type,\n        offset,\n        length,\n        userId: (node as HTMLAnchorElement).dataset.userId!,\n      },\n    };\n  }\n\n  if (type === ApiMessageEntityTypes.Pre) {\n    return {\n      index,\n      entity: {\n        type,\n        offset,\n        length,\n        language: (node as HTMLPreElement).dataset.language,\n      },\n    };\n  }\n\n  if (type === ApiMessageEntityTypes.CustomEmoji) {\n    return {\n      index,\n      entity: {\n        type,\n        offset,\n        length,\n        documentId: (node as HTMLImageElement).dataset.documentId!,\n      },\n    };\n  }\n\n  return {\n    index,\n    entity: {\n      type,\n      offset,\n      length,\n    },\n  };\n}\n\nfunction getEntityTypeFromNode(node: ChildNode): ApiMessageEntityTypes | undefined {\n  if (node instanceof HTMLElement && node.dataset.entityType) {\n    return node.dataset.entityType as ApiMessageEntityTypes;\n  }\n\n  if (ENTITY_CLASS_BY_NODE_NAME[node.nodeName]) {\n    return ENTITY_CLASS_BY_NODE_NAME[node.nodeName];\n  }\n\n  if (node.nodeName === 'A') {\n    const anchor = node as HTMLAnchorElement;\n    if (anchor.dataset.entityType === ApiMessageEntityTypes.MentionName) {\n      return ApiMessageEntityTypes.MentionName;\n    }\n    if (anchor.dataset.entityType === ApiMessageEntityTypes.Url) {\n      return ApiMessageEntityTypes.Url;\n    }\n    if (anchor.href.startsWith('mailto:')) {\n      return ApiMessageEntityTypes.Email;\n    }\n    if (anchor.href.startsWith('tel:')) {\n      return ApiMessageEntityTypes.Phone;\n    }\n    if (anchor.href !== anchor.textContent) {\n      return ApiMessageEntityTypes.TextUrl;\n    }\n\n    return ApiMessageEntityTypes.Url;\n  }\n\n  if (node.nodeName === 'SPAN') {\n    return (node as HTMLElement).dataset.entityType as any;\n  }\n\n  if (node.nodeName === 'IMG') {\n    if ((node as HTMLImageElement).dataset.documentId) {\n      return ApiMessageEntityTypes.CustomEmoji;\n    }\n  }\n\n  return undefined;\n}\n","const fragmentEl = document.createElement('div');\n\nexport function insertHtmlInSelection(html: string) {\n  const selection = window.getSelection();\n\n  if (selection?.getRangeAt && selection.rangeCount) {\n    const range = selection.getRangeAt(0);\n    range.deleteContents();\n\n    const fragment = range.createContextualFragment(html);\n    const lastInsertedNode = fragment.lastChild;\n    range.insertNode(fragment);\n    if (lastInsertedNode) {\n      range.setStartAfter(lastInsertedNode);\n      range.setEndAfter(lastInsertedNode);\n    } else {\n      range.collapse(false);\n    }\n    selection.removeAllRanges();\n    selection.addRange(range);\n  }\n}\n\nexport function getHtmlBeforeSelection(container?: HTMLElement, useCommonAncestor?: boolean) {\n  if (!container) {\n    return '';\n  }\n\n  const sel = window.getSelection();\n  if (!sel || !sel.rangeCount) {\n    return container.innerHTML;\n  }\n\n  const range = sel.getRangeAt(0).cloneRange();\n  if (!range.intersectsNode(container)) {\n    return container.innerHTML;\n  }\n\n  if (!useCommonAncestor && !container.contains(range.commonAncestorContainer)) {\n    return '';\n  }\n\n  range.collapse(true);\n  range.setStart(container, 0);\n  replaceChildren(fragmentEl, range.cloneContents());\n\n  return fragmentEl.innerHTML;\n}\n\nfunction replaceChildren(el: HTMLElement, nodes?: DocumentFragment) {\n  if (el.replaceChildren === undefined) {\n    while (el.lastChild) {\n      el.removeChild(el.lastChild);\n    }\n    if (nodes !== undefined) {\n      el.append(nodes);\n    }\n  } else {\n    el.replaceChildren(nodes || '');\n  }\n}\n","import type React from '../lib/teact/teact';\n\nconst stopEvent = (e: React.UIEvent | Event | React.FormEvent) => {\n  e.stopPropagation();\n  e.preventDefault();\n};\n\nexport default stopEvent;\n","let fileSelector: HTMLInputElement;\n\nexport function openSystemFilesDialog(accept = '*', callback: (e: Event) => void, noMultiple = false) {\n  if (!fileSelector) {\n    fileSelector = document.createElement('input');\n    fileSelector.setAttribute('type', 'file');\n  }\n\n  fileSelector.setAttribute('accept', accept);\n\n  if (noMultiple) {\n    fileSelector.removeAttribute('multiple');\n  } else {\n    fileSelector.setAttribute('multiple', 'multiple');\n  }\n\n  // eslint-disable-next-line no-null/no-null\n  fileSelector.onchange = null;\n  fileSelector.value = '';\n  fileSelector.onchange = callback;\n\n  fileSelector.click();\n}\n"],"names":["text","prevText","usePrevious","forceUpdate","useForceUpdate","isAnimatingRef","useRef","shouldAnimate","getGlobal","settings","byKey","animationLevel","ANIMATION_LEVEL_MAX","textElement","useMemo","elements","i","length","push","className","current","useTimeout","undefined","memo","props","sticker","noLoad","forcePreview","lastSyncTime","otherProps","thumbDataUri","thumbnail","dataUri","localMediaHash","id","previewBlobUrl","useMedia","getStickerPreviewHash","ApiMediaFormat","tgsUrl","previewUrl","noPreviewTransition","loadedPreviewUrls","Set","isPreviewLoaded","markPreviewLoaded","useFlag","has","previewClassNames","useMediaTransition","isAnimationReady","markAnimationReady","handlePreviewLoad","useCallback","add","size","buildClassName","style","buildStyle","src","styles","onLoad","AnimatedIcon","noTransition","renderWaveform","canvas","spikes","progress","peak","fillStyle","progressFillStyle","width","height","ctx","getContext","scale","forEach","item","globalAlpha","spikeHeight","Math","max","x","y","radius","beginPath","moveTo","arcTo","closePath","roundedRectangle","fill","decodeWaveform","encoded5bit","bitsCount","valuesCount","floor","result","Array","bitsData","l","byteIndex","bitShift","value","lastByteIndex","lastBitShift","lastValue","interpolateArray","data","fitCount","newData","springFactor","leftFiller","rightFiller","idx","val","TINY_SCREEN_WIDTH_MQL","window","matchMedia","WITH_AVATAR_TINY_SCREEN_WIDTH_MQL","getSeeklineSpikeAmounts","withAvatar","MIN_SPIKES","IS_SINGLE_COLUMN_LAYOUT","matches","MAX_SPIKES","renderSeekline","playProgress","bufferedRanges","seekerRef","ref","map","start","end","theme","message","senderTitle","uploadProgress","origin","date","noAvatars","isSelectable","isSelected","isDownloading","isTranscribing","isTranscriptionHidden","isTranscribed","isTranscriptionError","canDownload","canTranscribe","onHideTranscription","onPlay","onReadMedia","onCancelUpload","onDateClick","cancelMessageMediaDownload","downloadMessageMedia","transcribeAudio","getActions","content","audio","voice","video","isMediaUnread","isVoice","Boolean","isSeeking","lang","useLang","isRtl","isActivated","setIsActivated","useState","shouldLoad","coverHash","getMessageMediaHash","coverBlobUrl","mediaData","getMessageMediaFormat","loadProgress","downloadProgress","useMediaWithLoadProgress","handleForcePlay","chatId","handleTrackChange","isBuffered","bufferingHandlers","checkBuffering","useBuffering","isPlaying","playPause","setCurrentTime","duration","useAudioPlayer","makeTrackId","getMediaDuration","isMessageLocal","isOwn","isOwnMessage","waveformCanvasRef","canvasRef","waveform","min","durationFactor","spikesCount","round","Uint8Array","useLayoutEffect","useWaveformCanvas","withSeekline","useEffect","isLoadingForPlaying","isUploading","isTransferring","transferProgress","getMediaTransferState","shouldRender","shouldRenderSpinner","transitionClassNames","spinnerClassNames","useShowTransition","shouldRenderCross","handleButtonClick","setAudioPlayerOrigin","handleDownloadClick","handleSeek","e","left","getBoundingClientRect","clientX","MouseEvent","targetTouches","stopPropagation","handleStartSeek","button","handleStopSeek","handleDateClick","handleTranscribe","messageId","captureEvents","onCapture","onRelease","onClick","onDrag","transcribeSvgMemo","dangerouslySetInnerHTML","__html","renderFirstLine","title","fileName","fullClassName","AudioOrigin","buttonClassNames","contentClassName","renderWithTitle","dir","renderText","Link","formatPastTimeShort","formatMediaDuration","performer","renderSecondLine","Button","ripple","color","join","ariaLabel","backgroundImage","ProgressSpinner","transparent","noCross","showProgress","showSeekline","getTranslation","getFileSizeString","formatMediaDateTime","renderAudio","svgMemo","onClickTranscribe","draggable","renderVoice","runDebounced","debounce","cb","withGlobal","global","chatOrUserId","countryList","phoneCodes","phoneCodeList","chat","selectChat","user","isUserId","selectUser","isMuted","selectIsChatMuted","selectNotifySettings","selectNotifyExceptions","canInviteUsers","isChatChannel","isUserRightBanned","getHasAdminRight","forceShowSelf","loadFullUser","showNotification","updateChatMutedState","userId","fullInfo","username","phoneNumber","isSelf","areNotificationsEnabled","setAreNotificationsEnabled","handleNotificationChange","newAreNotificationsEnabled","isRestricted","copy","entity","copyTextToClipboard","formattedNumber","formatPhoneNumberWithCode","link","getChatLink","description","bio","getChatDescription","icon","multiline","narrow","isStatic","label","checked","inactive","isPrivateChat","isChatWithSelf","selectIsChatWithSelf","getPrivateChatUserId","isBot","isUserBot","isSupport","canDeleteForAll","contactName","getUserFirstOrLastName","isChannel","isBasicGroup","isChatBasicGroup","isSuperGroup","isChatSuperGroup","currentUserId","isOpen","onClose","onCloseAnimationEnd","leaveChannel","deleteHistory","deleteChannel","deleteChatUser","blockContact","chatTitle","getChatTitle","handleDeleteForAll","shouldDeleteForAll","handleDeleteAndStop","contactId","accessHash","handleDeleteChat","isCreator","handleLeaveChat","header","isSavedMessages","withVideo","isText","observeIntersection","smaller","canAutoLoad","autoLoadFileMaxSizeMb","withDate","datetime","sender","onMediaClick","dispatch","document","timestamp","extension","getDocumentExtension","isIntersecting","useIsIntersecting","wasIntersected","markIntersected","isLoadAllowed","setIsLoadAllowed","shouldDownload","documentHash","isLoaded","hasPreview","getDocumentHasPreview","getMessageMediaThumbDataUri","localBlobUrl","previewData","withMediaViewer","mediaType","SUPPORTED_VIDEO_CONTENT_TYPES","mimeType","SUPPORTED_IMAGE_CONTENT_TYPES","handleClick","name","thumbnailDataUri","actionIcon","isMessageDocumentVideo","fakeType","elementRef","withThumb","noThumb","thumbRef","useCanvasBlur","IS_CANVAS_FILTER_SUPPORTED","thumbClassNames","shouldSpinnerRender","getColorFromExtension","sizeString","getDocumentThumbnailDimensions","alt","VERIFIED_ICON","peer","noVerified","noFake","withEmojiStatus","emojiStatusSize","noLoopLimit","onEmojiStatusClick","isUser","getUserFullName","emojiStatus","isPremium","isVerified","FakeIcon","CustomEmoji","documentId","loopLimit","EMOJI_STATUS_LOOP_LIMIT","observeIntersectionForLoading","PremiumIcon","onlineCount","selectChatOnlineCount","areMessagesLoaded","selectChatMessages","typingStatus","avatarSize","status","withDots","withUsername","withFullInfo","withUpdatingStatus","withChatType","withVideoAvatar","noRtl","loadFullChat","openMediaViewer","loadProfilePhotos","isMin","profileId","handleAvatarViewerOpen","hasMedia","avatarOwnerId","mediaId","MediaViewerOrigin","key","getChatTypeString","handle","groupStatus","chatTypeString","membersCount","getGroupStatus","onlineStatus","renderStatusOrTyping","outgoingStatus","idPrefix","isProtected","mediaBlobUrl","getMessageVideo","getMessageHtmlId","decoding","onContextMenu","stopEvent","isGif","Keys","activeKey","DEFAULT_TEXT","FOCUS_DELAY_TIMEOUT_MS","isLoading","isPasswordVisible","error","hint","placeholder","submitLabel","shouldShowSubmit","shouldResetValue","shouldDisablePasswordManager","noRipple","clearError","onChangePasswordVisibility","onInputChange","onSubmit","inputRef","password","setPassword","canSubmit","setCanSubmit","IS_TOUCH_ENV","focus","requestAnimationFrame","select","action","event","preventDefault","autoComplete","type","tabIndex","onChange","target","MIN_PASSWORD_LENGTH","maxLength","role","disabled","itemIds","selectedIds","filterValue","filterPlaceholder","notFoundText","searchInputId","noScrollRestore","onSelectedIdsChange","onFilterChange","onLoadMore","shouldMinimize","setTimeout","handleItemClick","newSelectedIds","includes","splice","indexOf","handleFilterChange","currentTarget","viewportIds","getMore","useInfiniteScroll","isMinimized","canClose","clickArg","items","iconElement","titleText","PREMIUM_ICON","store","withGradient","big","html","generateIdFor","getPremiumIconGradient","serverTimeOffset","userStatus","selectUserStatus","noStatusOrTyping","adminMember","customTitle","isOwner","isUserOnline","getUserStatus","photo","canPlayVideo","videoRef","isDeleted","isDeletedUser","isRepliesChat","isChatWithRepliesBot","userOrChat","currentPhoto","profilePhoto","canHaveMedia","isVideo","avatarHash","getChatAvatarHash","avatarBlobUrl","photoHash","photoBlobUrl","videoHash","getVideoAvatarMediaHash","fullMediaData","isVideoReady","markVideoReady","isFullMediaReady","isBlurredThumb","blurredThumbCanvasRef","currentTime","OptimizedVideo","canPlay","muted","disablePictureInPicture","loop","playsInline","onReady","userFullName","getFirstLetters","Spinner","getUserColorKey","connectionState","mediaViewer","openPremiumModal","photos","MEMO_EMPTY_ARRAY","prevMediaId","prevAvatarOwnerId","hasSlideAnimation","setHasSlideAnimation","slideAnimation","currentPhotoIndex","setCurrentPhotoIndex","isFirst","isLast","profile","currentIndex","slice","mediaLoader","usePhotosPreload","handleProfilePhotoClick","handleClickPremium","fromUserId","selectPreviousMedia","selectNextMedia","element","querySelector","selectorToPreventScroll","onSwipe","direction","SwipeDirection","_","renderPhotoTabs","Transition","renderPhoto","FullNameTitle","isActive","reaction","staticIconId","availableReactions","find","staticIcon","subject","messageIds","reportMessages","reportPeer","reportProfilePhoto","exitMessageSelectMode","selectedReason","setSelectedReason","setDescription","handleReport","reason","handleSelectReason","handleDescriptionChange","REPORT_OPTIONS","onEnter","options","selected","noAnimate","noContextMenu","canViewSet","isCurrentUserPremium","sharedCanvasRef","onFaveClick","onUnfaveClick","onRemoveRecentClick","openStickerSet","isCustomEmoji","hasEffect","stickerSetInfo","isLocked","shouldPlay","isContextMenuOpen","contextMenuPosition","handleBeforeContextMenu","handleContextMenu","handleContextMenuClose","handleContextMenuHide","useContextMenuHandlers","getTriggerElement","getRootElement","closest","getMenuElement","positionX","positionY","transformOriginX","transformOriginY","menuStyle","useContextMenuPosition","handleRemoveClick","handleContextRemoveRecent","handleContextUnfave","handleContextFave","handleSendQuiet","handleSendScheduled","handleOpenSet","shouldShowCloseButton","contextMenuItems","emoji","onMouseDown","preventMessageInputBlurWithBubbling","initialSection","containerRef","isSmall","shouldLoop","shouldPreloadPreview","noPlay","withSharedAnimation","autoClose","typingUser","typingUserName","replace","trim","onMessageClick","linkData","getMessageWebPage","getFirstLinkInMessage","url","domain","siteName","formattedDescription","getMessageText","renderMessageSummary","handleMessageClick","displayUrl","truncatedDescription","trimText","renderMessageText","highlight","emojiSize","isSimple","truncateLength","shouldRenderAsHtml","entities","contentNotSupportedText","renderTextWithEntities","noEmoji","TRUNCATED_SUMMARY_LENGTH","hasSpoilers","some","ApiMessageEntityTypes","hasCustomEmoji","getMessageSummaryText","getMessageSummaryEmoji","emojiWithSpace","getMessageSummaryDescription","isArray","filter","ChatFolderModal","useModuleLoader","Bundles","ChatAnimationTypes","isPinned","isShown","unreadCount","unreadMentionsCount","hasUnreadMark","unreadReactionsCount","isUnread","ShowTransition","isCustom","unreadReactionsElement","unreadMentionsElement","unreadCountElement","AnimatedCounter","formatIntegerCompact","renderContent","senderId","replyToMessageId","isOutgoing","lastMessage","lastMessageSender","lastMessageAction","getMessageAction","actionTargetMessage","selectChatMessage","targetUserIds","actionTargetUserIds","targetChatId","actionTargetChatId","privateChatUserId","currentChatId","threadId","currentThreadId","messageListType","selectCurrentMessageList","MAIN_THREAD_ID","statusEmoji","customEmojis","byId","isEmojiStatusColored","selectIsDefaultEmojiStatusPack","draft","selectDraft","canScrollDown","canChangeFolder","chatFolders","orderedIds","lastMessageOutgoingStatus","selectOutgoingStatus","folderId","orderDiff","animationType","onDragEnter","openChat","focusLastMessage","isDeleteModalOpen","openDeleteModal","closeDeleteModal","isChatFolderModalOpen","openChatFolderModal","closeChatFolderModal","isReportModalOpen","openReportModal","closeReportModal","shouldRenderDeleteModal","markRenderDeleteModal","unmarkRenderDeleteModal","shouldRenderChatFolderModal","markRenderChatFolderModal","unmarkRenderChatFolderModal","shouldRenderReportModal","markRenderReportModal","unmarkRenderReportModal","isAction","isActionMessage","useEnsureMessage","mediaThumbnail","getMessageSticker","isRoundVideo","getMessageRoundVideo","actionTargetUsers","usersById","users","Opacity","opacity","fastRaf","classList","Move","transform","remove","ANIMATION_END_DELAY","shouldReplaceHistory","forceOnHeavyAnimation","handleDragEnter","handleDelete","handleChatFolderChange","contextActions","useChatContextActions","ListItem","Avatar","isCallActive","isCallNotEmpty","LastMessageMeta","TypingStatus","isChat","renderActionMessageText","isEmbedded","senderName","getMessageSenderName","blobUrl","messageSummary","MessageSummary","renderSummary","renderLastMessageOrTyping","DeleteChatModal","ReportModal","folderType","chatFolder","selectChatFolder","animatedEmoji","selectAnimatedEmoji","foldersDispatch","onScreenSelect","handleEditFolder","payload","SettingsScreens","AnimatedIconFromSticker","fluid","pill","openNextChat","shouldIgnoreDragRef","resolvedFolderId","ALL_FOLDER_ID","ARCHIVED_FOLDER_ID","useFolderManagerForOrderedIds","orderById","reduce","acc","prevOrderById","orderDiffById","mapValues","order","CHAT_LIST_SLICE","useHotkeys","targetIndexDelta","IS_PWA","addEventListener","handleKeyDown","removeEventListener","IS_MAC_OS","metaKey","ctrlKey","code","startsWith","digit","match","position","Number","getAnimationType","orderDiffs","Object","values","numberOfUp","diff","numberOfDown","None","Infinity","useChatAnimationType","observe","useIntersectionObserver","rootRef","throttleMs","useDebouncedCallback","handleDragLeave","rect","clientY","top","InfiniteScroll","preloadBackwards","withAbsolutePositioning","maxHeight","CHAT_HEIGHT_PX","onDragLeave","viewportOffset","pinnedCount","getPinnedChatsCount","teactOrderKey","getOrderKey","renderChats","Loading","getSenderName","chatsById","getSenderTitle","isChatGroup","CustomEmojiTooltip","CustomSend","isQuick","onFileSelect","isHovered","markHovered","unmarkHovered","onDrop","relatedTarget","toTarget","DropAreaState","withQuick","onHide","hideTimeoutRef","prevWithQuick","captureEscKeyListener","handleFilesDrop","async","dataTransfer","dt","files","folderFiles","getFilesFromDataTransferItems","concat","from","handleQuickFilesDrop","fromTarget","Portal","containerId","onDragOver","clearTimeout","EmojiTooltip","AbsoluteVideo","constructor","videoUrl","container","this","createElement","load","noLoop","appendChild","recalculatePositionAndSize","play","paused","safePlay","pause","destroy","updatePosition","ID_STORE","SCROLLER_CLASS","MAX_INPUT_HEIGHT","IGNORE_KEYS","messageSendKeyCombo","replyingToId","selectReplyingToId","isSelectModeActive","selectIsInSelectMode","captionLimit","isAttachmentModalInput","editableInputId","forcedPlaceholder","canAutoFocus","noFocusInterception","shouldSuppressFocus","shouldSuppressTextFormatter","onUpdate","onSuppressedFocus","onSend","editLastMessage","replyToNextMessage","selectionTimeoutRef","cloneRef","scrollerCloneRef","sharedCanvasHqRef","absoluteContainerRef","isContextMenuOpenRef","isTextFormatterOpen","openTextFormatter","closeTextFormatter","textFormatterAnchorPosition","setTextFormatterAnchorPosition","selectedRange","setSelectedRange","isTextFormatterDisabled","setIsTextFormatterDisabled","mapRef","Map","removeContainers","ids","player","get","delete","synchronizeElements","removedContainers","keys","querySelectorAll","dataset","uniqueId","mediaUrl","getCustomEmojiMediaDataForInput","canvasBounds","elementBounds","customEmoji","isHq","selectIsAlwaysHighPriorityEmoji","animation","isLottie","lottie","RLottie","coords","isLowPriority","removeContainer","setSharedCanvasCoords","absoluteVideo","Error","createPlayer","set","addCustomEmojiInputRenderCallback","removeCustomEmojiInputRenderCallback","useResizeObserver","freezeAnimation","unfreezeAnimation","unfreezeAnimationOnRaf","useBackgroundMode","useInputCustomEmojis","updateInputHeight","willSend","scroller","clone","currentHeight","newHeight","scrollHeight","transitionDuration","log","abs","exec","toggle","useLayoutEffectWithPrevDeps","prevHtml","innerHTML","focusInput","isHeavyAnimating","focusEditableElement","handleCloseTextFormatter","selection","getSelection","removeAllRanges","empty","clearSelection","checkSelection","IS_IOS","rangeCount","IS_ANDROID","selectionRange","getRangeAt","selectedText","toString","isSelectionInsideInput","EDITABLE_INPUT_ID","parseEmojiOnlyString","START_TO_END","processSelection","selectionRect","inputRect","processSelectionWithTimeout","handleDocumentKeyDown","getIsDirectTextInputDisabled","input","isSelectionCollapsed","isCollapsed","shiftKey","tagName","isContentEditable","newEvent","KeyboardEvent","dispatchEvent","captureFirstTab","captureKeyboardListeners","onTab","suppressFocus","blur","contentEditable","textContent","IS_EMOJI_SUPPORTED","onKeyDown","isComposing","altKey","once","handleCloseContextMenu","e2","onTouchCancel","TextFormatter","anchorPosition","TEXT_FORMAT_BY_TAG_NAME","B","STRONG","I","EM","U","DEL","CODE","SPAN","fragmentEl","linkUrlInputRef","isLinkControlOpen","openLinkControl","closeLinkControl","linkUrl","setLinkUrl","isEditingLink","setIsEditingLink","inputClassName","setInputClassName","selectedTextFormats","setSelectedTextFormats","useVirtualBackdrop","selectedFormats","parentElement","commonAncestorContainer","textFormat","restoreSelection","addRange","updateSelectedRange","getSelectedText","shouldDropCustomEmoji","replaceChildren","cloneContents","INPUT_CUSTOM_EMOJI_SELECTOR","el","replaceWith","getAttribute","getSelectedElement","updateInputStyles","offsetWidth","scrollWidth","scrollLeft","getFormatButtonClassName","fKey","monospace","strikethrough","handleSpoilerText","spoiler","entityType","execCommand","handleBoldText","bold","handleItalicText","italic","handleUnderlineText","underline","handleStrikethroughText","handleMonospaceText","handleLinkUrlConfirm","formattedLinkUrl","ensureProtocol","split","encodeURI","href","handler","k","b","u","m","s","p","toLowerCase","getKeyFromEvent","linkUrlConfirmClassName","inputMode","onScroll","dataTransferItems","traverseFileTreePromise","entry","Promise","resolve","File","isFile","itemFile","getAsFile","file","isDirectory","createReader","readEntries","entries","entriesPromises","all","kind","webkitGetAsEntry","fixMovMime","ext","pop","RE_BR","RE_SPACE","RE_CLEAN_HTML","RE_EXTRA_NEW_LINE","prepareForRegExp","inputId","parentNode","iterations","RE_ENDS_ON_EMOJI","RegExp","twemojiRegex","ENDS_ON_EMOJI_IMG_REGEX","EMOJI_IMG_REGEX","useCustomEmojiTooltip","isAllowed","inputSelector","onUpdateHtml","stickers","isDisabled","loadCustomEmojiForEmoji","clearCustomEmojiForEmoji","htmlBeforeSelection","setHtmlBeforeSelection","cacheBuster","updateCacheBuster","useCacheBuster","handleSelectionChange","range","collapsed","useOnSelectionChange","getHtmlBeforeSelection","lastEmojiText","hasStickers","insertCustomEmoji","containerEl","regexText","regex","count","newHtml","buildCustomEmojiHtml","repeat","htmlAfterSelection","substring","isCustomEmojiTooltipOpen","closeCustomEmojiTooltip","cache","WeakMap","memoized","fn","cached","args","areSortedArraysEqual","lastArgs","lastResult","emojiDataPromise","emojiRawData","emojiData","RE_EMOJI_SEARCH","prepareRecentEmojisMemo","recentEmojiIds","limit","pickTruthy","prepareLibraryMemo","baseEmojiKeywords","emojiKeywords","emojis","byNative","buildCollectionByKey","baseEmojisByKeyword","natives","emojisByKeyword","byKeyword","keywords","byName","names","searchInLibraryMemo","library","matched","matchedKeywords","keyword","sort","flat","matchedNames","unique","useEmojiTooltip","htmlRef","markIsOpen","unmarkIsOpen","setById","shouldForceInsertEmoji","setShouldForceInsertEmoji","filteredEmojis","setFilteredEmojisInner","filteredCustomEmojis","setFilteredCustomEmojis","setFilteredEmojis","ensureEmojiData","then","uniqueByField","selectCustomEmojiForEmojis","native","getEmojiCode","forceSend","endsWith","substr","insertEmoji","textEmoji","isForce","currentHtml","atIndex","lastIndexOf","messageInput","EDITABLE_INPUT_CSS_SELECTOR","getElementById","isEmojiTooltipOpen","closeEmojiTooltip","default","uncompressEmoji","runThrottled","throttle","RE_USERNAME_SEARCH","useMentionTooltip","canSuggestMembers","groupChatMembers","topInlineBotIds","usersToMention","setUsersToMention","updateFilteredUsers","withInlineBots","memberIds","member","filteredIds","filterUsersByName","usernameFilter","getUsernameFilter","insertMention","forceFocus","insertedHtml","isMentionTooltipOpen","closeMentionTooltip","mentionFilteredUsers","useAsyncRendering","dependencies","delay","shouldRenderRef","timeoutRef","useOnChange","loadingOptions","setValues","handleChange","newValues","v","option","subLabel","textParts","confirmLabel","confirmHandler","confirmIsDestructive","isButtonsInOneRow","children","handleSelectWithEnter","index","useKeyboardListNavigation","textPart","buttonClassName","buttonRef","leftElement","secondaryIcon","rightElement","allowDisabledClick","destructive","onSecondaryIconClick","isTouched","markIsTouched","unmarkIsTouched","handleSecondaryIconClick","handleMouseDown","DEFAULT_DURATION","onDismiss","actionText","setIsOpen","timerRef","closeAndDismiss","handleMouseEnter","handleMouseLeave","onMouseEnter","onMouseLeave","RADIUSES","xl","square","circleRadius","STROKE_WIDTH","borderRadius","circumference","PI","svg","firstElementChild","strokeDashOffset","setAttribute","hidden","loadingOption","step","renderValue","mainClassName","trackWidth","parentContainerClassName","focused","spinnerColor","spinnerBackgroundColor","autoFocusSearch","onReset","onFocus","onBlur","onSpinnerClick","isInputFocused","markInputFocused","unmarkInputFocused","useInputFocusOnOpen","backgroundColor","isHidden","noCloseTransition","prevIsOpen","prevChildren","fromChildrenRef","variant","forceAspectRatio","inline","classNames","noAnimation","onCheck","isBlocked","badgeCount","isBadgeActive","previousActiveTab","tabRef","tabEl","prevTabEl","platformEl","prevPlatformEl","shiftLeft","offsetLeft","scaleFactor","clientWidth","forceReflow","SCROLL_DURATION","tabs","areFolders","activeTab","onSwitchTab","useHorizontalScroll","activeTabElement","childNodes","activeTabOffsetLeft","activeTabOffsetWidth","newLeft","fastSmoothScrollHorizontal","tab","INCLUDED_CHAT_TYPES","EXCLUDED_CHAT_TYPES","INCLUDE_FILTER_FIELDS","EXCLUDE_FILTER_FIELDS","selectChatFilters","state","mode","selectTemp","selectedChatIds","selectedChatTypes","includedChatIds","includeFilters","pick","folder","excludedChatIds","excludeFilters","getSuggestedFolderName","filters","bots","groups","channels","contacts","nonContacts","INITIAL_STATE","chatFilter","foldersReducer","omit","useReducer","makeMediaHandlers","controllerRef","mediaHandlers","proxy","requestNextTrack","requestPreviousTrack","stop","closeAudioPlayer","seekbackward","skipTime","seekOffset","seekforward","seekTo","seekTime","nexttrack","previoustrack","trackId","originalDuration","trackType","handlers","metadata","onInit","onForcePlay","onTrackChange","noPlaylist","noProgressUpdates","setIsPlaying","isPlayingSync","setPlayProgress","register","eventName","setVolume","setPlaybackRate","toggleMuted","registerMediaSession","setPlaybackState","audioPlayer","volume","isFinite","PLAYBACK_RATE_FOR_AUDIO_MIN_DURATION","playbackRate","setPositionState","updateMetadata","isSafariPatchInProgress","useEffectWithPrevDeps","prevShouldPlay","prevSrc","playIfPresent","setTime","time","audioProxy","setCacheBuster","withRaf","preferredWidth","preferredHeight","isStarted","img","Image","processBlur","alpha","drawImage","fastBlur","onload","isInSearch","isServiceNotifications","SERVICE_NOTIFICATIONS_USER_ID","toggleChatPinned","toggleChatArchived","toggleChatUnread","actionAddToFolder","actionPin","compact","actionUnreadMark","actionMute","actionArchive","isChatArchived","actionReport","actionDelete","getCanDeleteChat","isInFolder","stopImmediatePropagation","isMenuDisabled","shouldDisableOnLink","shouldDisableOnLongTap","setIsContextMenuOpen","setContextMenuPosition","timer","clearLongPressTimer","startLongPressTimer","originalEvent","touches","cancelClickOnce","emulateContextMenuEvent","passive","EMPTY_RECT","anchor","getLayout","setPositionX","setPositionY","setTransformOriginX","setTransformOriginY","withScroll","setWithScroll","setStyle","setMenuStyle","triggerEl","anchorX","anchorY","menuEl","rootEl","extraPaddingX","extraTopPadding","marginSides","extraMarginTop","marginTop","parseInt","getComputedStyle","menuRect","offsetHeight","rootRect","horizontalPosition","verticalPosition","triggerRect","menuMaxHeight","offsetX","offsetY","replyOriginForId","loadMessage","loadMessageThrottled","throttled","addOrderedIdsCallback","getOrderedIds","useFolderManagerForUnreadCounters","addUnreadCountersCallback","getUnreadCounters","useFolderManagerForChatsCount","addChatsCountCallback","getChatsCount","shouldPreventDefault","handleScroll","deltaX","deltaY","IGNORE_TAGS","createCallbackManager","hotkeys","addCallback","HTMLElement","shouldFireEvent","hotkey","ctrl","meta","mod","shift","pressedKey","isExactHotkey","part","modifiers","reservedKeys","parseHotkey","getHotkeyMatcher","documentElement","runCallbacks","debugKey","prevDeps","idRef","mediaHash","mediaFormat","isHtmlAllowed","isStreaming","IS_PROGRESSIVE_SUPPORTED","useUniqueId","setLoadProgress","startedAtRef","handleProgress","Date","now","spentTime","closeTimeout","useMouseInside","menuCloseTimeout","isMouseInside","markMouseInside","callback","onSelectionChange","ancestor","contains","usePrevDuringAnimation","prev","isCurrentPresent","isPrevPresent","reducer","initialState","reducerRef","useRunDebounced","ms","noFirst","noLast","CalendarModal","canScheduleUntilOnline","onCancel","openAt","onScheduled","setOnScheduled","handleMessageSchedule","isWhenOnline","scheduledAt","getTime","handleMessageScheduleUntilOnline","SCHEDULED_WHEN_ONLINE","handleCloseCalendar","requestCalendar","whenScheduled","scheduledDefaultDate","setSeconds","setMilliseconds","scheduledMaxDate","setFullYear","getFullYear","withTimePicker","selectedAt","maxAt","getDayStartAt","isFutureMode","secondButtonLabel","onSecondButtonClick","sendMessageAction","SEND_MESSAGE_ACTION_INTERVAL","useStateRef","savedCallback","mul_table","shg_table","boxBlurCanvasRGB","context","top_x","top_y","isNaN","imageData","getImageData","pixels","rsum","gsum","bsum","p1","p2","yp","yi","yw","wm","hm","rad1","r","g","mul_sum","shg_sum","vmin","vmax","putImageData","WorkerConnector","worker","subscribe","request","messageData","requestStates","requestStatesByCallback","requestState","promise","reject","assign","withCallback","catch","finally","postMessage","cancelCallback","progressCallback","isCanceled","response","callbackArgs","WAITING","Symbol","HIGH_PRIORITY_QUALITY","LOW_PRIORITY_QUALITY","LOW_PRIORITY_QUALITY_SIZE_THRESHOLD","HIGH_PRIORITY_CACHE_MODULO","IS_SAFARI","instancesById","workers","Worker","URL","lastWorkerIndex","static","params","instance","addContainer","customColor","onEnded","onLoop","initConfig","initRenderer","isSharedCanvas","containers","clearRect","imgSize","isAnimating","isWaiting","forceRestart","isPaused","isEnded","approxFrameIndex","stopFrameIndex","doPlay","every","frames","frame","prevFrameIndex","close","playSegment","startFrameIndex","reduceFactor","setSpeed","speed","setNoLoop","newCoords","containerInfo","isJustCleaned","sizeFactor","calcSizeFactor","ensureCanvasSize","getFrame","HTMLDivElement","offsetParent","ImageData","isRendererInited","quality","DPR","isDestroyed","clearCache","destroyRenderer","cacheModulo","setColor","newColor","workerIndex","cycleRestrict","onRendererInit","bind","msPerFrame","framesCount","changeData","onChangeData","lastRenderAt","animate","frameIndex","requestFrame","cleanupPrevFrame","containerData","currentSpeed","delta","expectedNextFrameIndex","nextFrameIndex","onFrameLoad","imageBitmap","expectedWidth","expectedHeight","tracks","currentTrackId","voiceQueue","musicQueue","playNext","isReverseOrder","currentTrack","nextTrackId","findNextInQueue","openAudioPlayer","parseMessageKey","splitTrackId","messageKey","nextTrack","stopCurrentAudio","track","Audio","handleEvent","Proxy","createAudio","trackIdComparator","addTrackToQueue","preventPlayAfterPatch","preload","patchSafariProgressiveAudio","globalSearch","currentContent","GlobalSearchContent","openedChatId","queueFilter","cleanUpQueue","fastSeek","rate","shouldRemoveFromQueue","h","trackIdFilter","removeFromQueue","getTrackQueue","currentId","queue","chatAudio","getMessageKey","one","two","dateOne","keyOne","dateTwo","keyTwo","localeCompare","IOS_SCREEN_EDGE_THRESHOLD","getDistance","a","hypot","pageX","pageY","getTouchCenter","lastClickTime","lethargy","stability","sensitivity","tolerance","lastUpDeltas","lastDownDeltas","deltasTimestamp","check","lastDelta","wheelDelta","detail","isInertia","lastDeltas","lastDeltasOld","lastDeltasNew","oldSum","t","newSum","oldAverage","newAverage","captureEvent","initialSwipeAxis","hasMoved","hasSwiped","isZooming","initialDistance","wheelZoom","initialZoom","initialDragOffset","isDragCanceled","initialTouchCenter","innerWidth","innerHeight","minZoom","maxZoom","excludedClosestSelector","withNativeDrag","onMove","withCursor","body","scrollable","overflow","onDoubleClick","centerX","centerY","clamp","onZoom","endDistance","touchCenter","dragOffsetX","dragOffsetY","zoomFactor","initialCenterX","initialCenterY","currentCenterX","currentCenterY","shouldPreventScroll","xAbs","yAbs","axis","currentSwipeAxis","Left","Right","Up","Down","processSwipe","releaseWheelDrag","releaseWheelZoom","onWheelCapture","onWheel","doubleTapZoom","is","metaKeyPressed","zoom","onWheelZoom","isUserEvent","sign","dx","dy","onWheelDrag","isNotPassive","hex2rgb","param","rgb2hex","p0","rgb2hsb","d","hsb2rgb","f","q","getAverageColor","defaultRGB","rgb","image","preloadImage","naturalHeight","naturalWidth","blockSize","getColorLuma","rgbColor","getPatternColor","hue","saturation","fastSmoothScroll","margin","maxDistance","FAST_SMOOTH_MAX_DISTANCE","forceDirection","forceDuration","forceNormalContainerHeight","scrollFrom","calculateScrollFrom","FocusDirection","ANIMATION_LEVEL_MIN","scrollWithJs","isAnimatingScroll","offsetTop","elementTop","scrollTop","offset","elementHeight","currentScrollTop","containerHeight","targetContainerHeight","normalHeight","path","remainingPath","absPath","transition","FAST_SMOOTH_SHORT_TRANSITION_MAX_DISTANCE","shortTransition","longTransition","FAST_SMOOTH_MIN_DURATION","FAST_SMOOTH_MAX_DURATION","startAt","onHeavyAnimationStop","dispatchHeavyAnimationEvent","animateSingle","currentPath","stopById","containerWidth","scrollId","isStopped","random","scrollSnapType","force","forcePlaceCaretAtEnd","activeElement","createRange","lastChild","nodeValue","selectNodeContents","collapse","getMessageIdsForSelectedText","selectedFragments","shouldIncludeLastMessage","focusNode","focusOffset","hasParentWithClassName","MESSAGE_CONTENT_CLASS_NAME","childElementCount","node","nodeType","messageEl","firstChild","removeChild","isElementInViewport","display","windowHeight","windowSize","DEFAULT_HANDLERS","mediaSession","navigator","setMediaSessionHandlers","console","warn","setActionHandler","err","clearMediaSession","playbackState","buildMediaMetadata","artist","album","artwork","MediaMetadata","RE_EMOJI_ONLY","lines","textWithoutNewlines","DETECT_UP_TO","countPerLine","line","emojiCount","ENTITY_CLASS_BY_NODE_NAME","S","STRIKE","PRE","BLOCKQUOTE","parseMessageInput","withMarkdownLinks","skipMarkdown","fragment","parseMarkdown","parseMarkdownLinks","fixImageContent","innerText","trimShift","textIndex","recursionDeepness","addEntity","Node","COMMENT_NODE","getEntityDataFromNode","hasChildNodes","parsedHtml","RE_LINK_TEMPLATE","rawText","nodeName","getEntityTypeFromNode","rawIndex","language","insertHtmlInSelection","deleteContents","createContextualFragment","lastInsertedNode","insertNode","setStartAfter","setEndAfter","useCommonAncestor","sel","cloneRange","intersectsNode","setStart","nodes","append","fileSelector","openSystemFilesDialog","accept","noMultiple","removeAttribute","onchange","click"],"sourceRoot":""}