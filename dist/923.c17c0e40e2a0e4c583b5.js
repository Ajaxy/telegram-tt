"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[923],{2923:(e,t,s)=>{s.r(t),s.d(t,{Main:()=>eo});var a=s(5116),n=s(3716),o=s(4050),r=(s(7895),s(1752)),i=s(8085),c=s(735),d=s(2858);function l(e){const{chatId:t,threadId:s}=(0,i.Bt)(e)||{};return t&&s?(e=(0,r.qr)(e,t,s,!1),e=(0,r.Pb)(e,t,s,void 0)):e}(0,a.Q6)("openLocalTextSearch",(e=>{const{chatId:t,threadId:s}=(0,i.Bt)(e)||{};if(t&&s)return(0,r.qr)(e,t,s,!0)})),(0,a.Q6)("closeLocalTextSearch",l),(0,a.Q6)("setLocalTextSearchQuery",((e,t,s)=>{const{chatId:a,threadId:n}=(0,i.Bt)(e)||{};if(!a||!n)return;const{query:o}=s,l=(0,d.uw)(a,n),{query:u}=e.localTextSearch.byChatThreadKey[l]||{};return o!==u&&(e=(0,r.Pb)(e,a,n,c.D)),(0,r.qr)(e,a,n,!0,o)})),(0,a.Q6)("setLocalMediaSearchType",((e,t,s)=>{const{chatId:a}=(0,i.Bt)(e)||{};if(!a)return;const{mediaType:n}=s;return(0,r.z5)(e,a,n)})),(0,a.Q6)("openChat",((e,t,s)=>{const{id:n,threadId:o=-1,type:c="thread",shouldReplaceHistory:d=!1}=s,u=(0,i.Bt)(e);return u&&u.chatId===n&&u.threadId===o&&u.type===c||(e=(0,r.pf)(e,n,o,"replyStack",[]),e=l(e=(0,r.i9)(e)),e={...e,messages:{...e.messages,contentToBeScheduled:void 0},...n!==e.forwardMessages.toChatId&&{forwardMessages:{}}},(0,a.R3)(e)),(0,r.Wy)(e,n,o,c,d)})),(0,a.Q6)("openPreviousChat",(e=>(0,r.Wy)(e,void 0))),(0,a.Q6)("openChatWithInfo",((e,t,s)=>{(0,a.R3)({...e,isChatInfoShown:!0}),t.openChat(s)})),(0,a.Q6)("resetChatCreation",(e=>({...e,chatCreation:void 0}))),(0,a.Q6)("setNewChatMembersDialogState",((e,t,s)=>({...e,newChatMembersProgress:s}))),(0,a.Q6)("openNextChat",((e,t,s)=>{const{targetIndexDelta:a,orderedIds:n}=s,{chatId:o}=(0,i.Bt)(e)||{};if(!o)return void t.openChat({id:n[0]});const r=n.indexOf(o);if(-1===r)return;const c=n[r+a];t.openChat({id:c,shouldReplaceHistory:!0})}));var u=s(6137),h=s(1713),m=s(7361),g=s(782);const p=n.ck+n.fK;let f;(0,a.Q6)("setScrollOffset",((e,t,s)=>{const{chatId:a,threadId:n,scrollOffset:o}=s;return(0,r.pf)(e,a,n,"scrollOffset",o)})),(0,a.Q6)("setReplyingToId",((e,t,s)=>{const{messageId:a}=s,n=(0,i.Bt)(e);if(!n)return;const{chatId:o,threadId:c}=n;return(0,r.pf)(e,o,c,"replyingToId",a)})),(0,a.Q6)("setEditingId",((e,t,s)=>{const{messageId:a}=s,n=(0,i.Bt)(e);if(!n)return;const{chatId:o,threadId:c,type:d}=n,l="scheduled"===d?"editingScheduledId":"editingId";return(0,r.pf)(e,o,c,l,a)})),(0,a.Q6)("editLastMessage",(e=>{const{chatId:t,threadId:s}=(0,i.Bt)(e)||{};if(!t||!s)return;const a=(0,i.Zw)(e,t),n=(0,i.Cb)(e,t,s);if(!a||!n)return;const o=(0,g.dF)(n,(t=>Boolean(a[t]&&(0,i._k)(e,a[t],s).canEdit)));return o?(0,r.pf)(e,t,s,"editingId",o):void 0})),(0,a.Q6)("replyToNextMessage",((e,t,s)=>{const{targetIndexDelta:a}=s,{chatId:n,threadId:o}=(0,i.Bt)(e)||{};if(!n||!o)return;const r=(0,i.Zw)(e,n),c=(0,i.Cb)(e,n,o);if(!r||!c)return;const d=(0,i.Yy)(e,n,o);let l;if((0,i.b9)(e,n,o)&&d){const e=Object.keys(r),t=e.indexOf(d.toString())+a;l=t<=e.length+1&&t>=0?Number(e[t]):void 0}else if(o===u._f){const t=(0,i.Z1)(e,n);l=t&&t.lastMessage?t.lastMessage.id:void 0}else{const t=(0,i.tZ)(e,n,o);l=t?t.lastMessageId:void 0}t.setReplyingToId({messageId:l}),t.focusMessage({chatId:n,threadId:o,messageId:l})})),(0,a.Q6)("openMediaViewer",((e,t,s)=>{const{chatId:a,threadId:n,messageId:o,avatarOwnerId:r,profilePhotoIndex:i,origin:c}=s;return{...e,mediaViewer:{chatId:a,threadId:n,messageId:o,avatarOwnerId:r,profilePhotoIndex:i,origin:c},forwardMessages:{}}})),(0,a.Q6)("closeMediaViewer",(e=>({...e,mediaViewer:{}}))),(0,a.Q6)("openAudioPlayer",((e,t,s)=>{const{chatId:a,threadId:n,messageId:o}=s;return{...e,audioPlayer:{chatId:a,threadId:n,messageId:o}}})),(0,a.Q6)("closeAudioPlayer",(e=>({...e,audioPlayer:{}}))),(0,a.Q6)("openPollResults",((e,t,s)=>{const{chatId:n,messageId:o}=s;(0,i.Jf)(e)?n===e.pollResults.chatId&&o===e.pollResults.messageId||(0,a.R3)({...e,pollResults:{chatId:n,messageId:o,voters:{}}}):window.setTimeout((()=>{const e=(0,a.Rd)();(0,a.R3)({...e,pollResults:{chatId:n,messageId:o,voters:{}}})}),450)})),(0,a.Q6)("closePollResults",(e=>{(0,a.R3)({...e,pollResults:{}})})),(0,a.Q6)("focusLastMessage",((e,t)=>{const s=(0,i.Bt)(e);if(!s)return;const{chatId:a,threadId:n}=s;let o;if(n===u._f){const t=(0,i.Z1)(e,a);o=t&&t.lastMessage?t.lastMessage.id:void 0}else{const t=(0,i.tZ)(e,a,n);o=t?t.lastMessageId:void 0}o&&t.focusMessage({chatId:a,threadId:n,messageId:o,noHighlight:!0})})),(0,a.Q6)("focusNextReply",((e,t)=>{const s=(0,i.Bt)(e);if(!s)return;const{chatId:n,threadId:o}=s,c=(0,i.p9)(e,n,o);if(c&&0!==c.length){const s=c.pop();e=(0,r.pf)(e,n,o,"replyStack",[...c]),(0,a.R3)(e),t.focusMessage({chatId:n,threadId:o,messageId:s})}else t.focusLastMessage()})),(0,a.Q6)("focusMessage",((e,t,s)=>{const{chatId:n,threadId:o=u._f,messageListType:c="thread",noHighlight:d,groupedId:l,groupedChatId:m,replyMessageId:g,isResizingContainer:I}=s;let{messageId:v}=s;if(void 0!==l){const t=(0,i.y8)(e,m,l);t&&t.length&&([v]=t)}const y=(0,i.Bt)(e),Z=!y||n!==y.chatId||o!==y.threadId||c!==y.type;if(f&&(clearTimeout(f),f=void 0),f=window.setTimeout((()=>{let e=(0,a.Rd)();e=(0,r.cq)(e),e=(0,r.wV)(e),(0,a.R3)(e)}),d?p:1500),e=(0,r.cq)(e,n,v,d,I),e=(0,r.wV)(e,void 0),g){const t=(0,i.p9)(e,n,o)||[];e=(0,r.pf)(e,n,o,"replyStack",[...t,g])}Z&&(e=(0,r.wV)(e,h.fo.Static));const P=(0,i.Cb)(e,n,o);if(P&&P.includes(v))return(0,a.R3)(e),void t.openChat({id:n,threadId:o});if(Z&&(e=(0,r.pf)(e,n,o,"viewportIds",void 0)),e=(0,r.pf)(e,n,o,"outlyingIds",void 0),P&&!Z){const t=v>P[0]?h.fo.Down:h.fo.Up;e=(0,r.wV)(e,t)}(0,a.R3)(e),t.openChat({id:n,threadId:o}),t.loadViewportMessages()})),(0,a.Q6)("openForwardMenu",((e,t,s)=>{const{fromChatId:a,messageIds:n,groupedId:o}=s;let r;return o&&(r=(0,i.xH)(e,a,o)),{...e,forwardMessages:{fromChatId:a,messageIds:r||n,isModalShown:!0}}})),(0,a.Q6)("exitForwardMode",(e=>{(0,a.R3)({...e,forwardMessages:{}})})),(0,a.Q6)("setForwardChatId",((e,t,s)=>{const{id:n}=s;(0,a.R3)({...e,forwardMessages:{...e.forwardMessages,toChatId:n,isModalShown:!1}}),t.openChat({id:n}),t.closeMediaViewer(),t.exitMessageSelectMode()})),(0,a.Q6)("openForwardMenuForSelectedMessages",((e,t)=>{if(!e.selectedMessages)return;const{chatId:s,messageIds:a}=e.selectedMessages;t.openForwardMenu({fromChatId:s,messageIds:a})})),(0,a.Q6)("enterMessageSelectMode",((e,t,s)=>{const{messageId:a}=s||{},n=(0,i.jr)(e);return n?(0,r.M6)(e,n.id,a):e})),(0,a.Q6)("toggleMessageSelection",((e,t,s)=>{const{messageId:n,groupedId:o,childMessageIds:c,withShift:d}=s,l=(0,i.Bt)(e);if(!l)return;const{chatId:u,threadId:h,type:g}=l;e=(0,r.Ob)(e,u,h,g,n,o,c,d),(0,a.R3)(e),e.shouldShowContextMenuHint&&(t.disableContextMenuHint(),t.showNotification({message:`To **edit** or **reply**, close this menu. Then ${m.$b?"long tap":"right click"} on a message.`}))})),(0,a.Q6)("disableContextMenuHint",(e=>{if(e.shouldShowContextMenuHint)return{...e,shouldShowContextMenuHint:!1}})),(0,a.Q6)("exitMessageSelectMode",r.i9),(0,a.Q6)("openPollModal",(e=>({...e,isPollModalOpen:!0}))),(0,a.Q6)("closePollModal",(e=>({...e,isPollModalOpen:!1}))),(0,a.Q6)("setGlobalSearchQuery",((e,t,s)=>{const{query:a}=s,{chatId:n}=e.globalSearch;return(0,r.No)(e,{globalResults:{},localResults:{},resultsByType:void 0,...a?{fetchingStatus:{chats:!n,messages:!0}}:{fetchingStatus:void 0},query:a})})),(0,a.Q6)("addRecentlyFoundChatId",((e,t,s)=>{const{id:a}=s,{recentlyFoundChatIds:n}=e.globalSearch;if(!n)return(0,r.No)(e,{recentlyFoundChatIds:[a]});const o=n.filter((e=>e!==a));return o.unshift(a),o.length>10&&o.pop(),(0,r.No)(e,{recentlyFoundChatIds:o})})),(0,a.Q6)("clearRecentlyFoundChats",(e=>(0,r.No)(e,{recentlyFoundChatIds:void 0}))),(0,a.Q6)("setGlobalSearchContent",((e,t,s)=>{const{content:a}=s;return(0,r.Og)(e,a)})),(0,a.Q6)("setGlobalSearchChatId",((e,t,s)=>{const{id:a}=s;return(0,r.No)(e,{chatId:a,query:void 0,resultsByType:void 0})})),(0,a.Q6)("setStickerSearchQuery",((e,t,s)=>{const{query:a}=s;return{...e,stickers:{...e.stickers,search:{query:a,resultIds:void 0}}}})),(0,a.Q6)("setGifSearchQuery",((e,t,s)=>{const{query:a}=s;return{...e,gifs:{...e.gifs,search:{query:a,offsetId:void 0,results:void 0}}}})),(0,a.Q6)("openUserInfo",((e,t,s)=>{const{id:a}=s;t.openChat({id:a})})),(0,a.Q6)("openChat",(e=>(0,r.x1)(e,void 0))),(0,a.Q6)("setUserSearchQuery",((e,t,s)=>{const{query:a}=s;return(0,r.Lm)(e,{globalUserIds:void 0,localUserIds:void 0,fetchingStatus:Boolean(a),query:a})})),s(3781);var I=s(1947);(0,a.Q6)("toggleChatInfo",(e=>({...e,isChatInfoShown:!e.isChatInfoShown}))),(0,a.Q6)("toggleManagement",(e=>{const{chatId:t}=(0,i.Bt)(e)||{};if(t)return{...e,management:{byChatId:{...e.management.byChatId,[t]:{...e.management.byChatId[t],isActive:!(e.management.byChatId[t]||{}).isActive}}}}})),(0,a.Q6)("closeManagement",(e=>{const{chatId:t}=(0,i.Bt)(e)||{};if(t)return{...e,management:{byChatId:{...e.management.byChatId,[t]:{...e.management.byChatId[t],isActive:!1}}}}})),(0,a.Q6)("openChat",(e=>{if(m.wB||m.p7)return{...e,isLeftColumnShown:0===e.messages.messageLists.length}})),(0,a.Q6)("toggleLeftColumn",(e=>({...e,isLeftColumnShown:!e.isLeftColumnShown}))),(0,a.Q6)("addRecentEmoji",((e,t,s)=>{const{emoji:a}=s,{recentEmojis:n}=e;if(!n)return{...e,recentEmojis:[a]};const o=n.filter((e=>e!==a));return o.unshift(a),o.length>18&&o.pop(),{...e,recentEmojis:o}})),(0,a.Q6)("addRecentSticker",((e,t,s)=>{const{sticker:a}=s,{recent:n}=e.stickers;if(!n)return{...e,stickers:{...e.stickers,recent:{hash:0,stickers:[a]}}};const o=n.stickers.filter((e=>e.id!==a.id));return o.unshift(a),{...e,stickers:{...e.stickers,recent:{...n,stickers:o}}}})),(0,a.Q6)("showNotification",((e,t,s)=>{const a=s,n=[...e.notifications],o=n.findIndex((e=>e.message===a.message));return-1!==o&&n.splice(o,1),n.push(a),{...e,notifications:n}})),(0,a.Q6)("dismissNotification",(e=>{const t=[...e.notifications];return t.pop(),{...e,notifications:t}})),(0,a.Q6)("showDialog",((e,t,s)=>{const{data:a}=s;if("message"in a&&a.hasErrorKey&&!(0,I.ZP)(a))return e;const n=[...e.dialogs];if("message"in a){const e=n.findIndex((e=>e.message===a.message));-1!==e&&n.splice(e,1)}return n.push(a),{...e,dialogs:n}})),(0,a.Q6)("dismissDialog",(e=>{const t=[...e.dialogs];return t.pop(),{...e,dialogs:t}})),(0,a.Q6)("toggleSafeLinkModal",((e,t,s)=>{const{url:a}=s;return{...e,safeLinkModalUrl:a}})),(0,a.Q6)("openHistoryCalendar",((e,t,s)=>{const{selectedAt:a}=s;return{...e,historyCalendarSelectedAt:a}})),(0,a.Q6)("closeHistoryCalendar",(e=>({...e,historyCalendarSelectedAt:void 0}))),(0,a.Q6)("openPaymentModal",((e,t,s)=>{const{chatId:a,messageId:n}=s;return{...e,payment:{...e.payment,chatId:a,messageId:n,isPaymentModalOpen:!0}}})),(0,a.Q6)("closePaymentModal",(e=>{const t=(0,r.bp)(e);return(0,r.WY)(t)})),(0,a.Q6)("addPaymentError",((e,t,s)=>{const{error:a}=s;return{...e,payment:{...e.payment,error:a}}})),s(1363);var v=s(1226),y=s(9118);const Z=(0,y.P2)((e=>e()),1e3,!0),P=(0,y.P2)((e=>e()),3e3,!0),C=(0,y.Ds)((e=>e()),500,!1,!0);async function w(e,t,s){const o=await(0,v.t9)("fetchChats",{limit:n.Ov,offsetDate:s,archived:"archived"===e,withPinned:void 0===(0,a.Rd)().chats.orderedPinnedIds[e],serverTimeOffset:(0,a.Rd)().serverTimeOffset});if(!o)return;const{chatIds:i}=o;i.length>0&&i[0]===t&&i.shift();let c=(0,a.Rd)();c=(0,r.Sh)(c,(0,g.ee)(o.users,"id")),c=(0,r.GL)(c,(0,g.ee)(o.chats,"id")),c=(0,r.B1)(c,e,i),c=(0,r.vv)(c,e,o),Object.keys(o.draftsById).map(Number).forEach((e=>{c=(0,r.pf)(c,e,u._f,"draft",o.draftsById[e])})),Object.keys(o.replyingToById).map(Number).forEach((e=>{c=(0,r.pf)(c,e,u._f,"replyingToId",o.replyingToById[e])})),0!==i.length||c.chats.isFullyLoaded[e]||(c={...c,chats:{...c.chats,isFullyLoaded:{...c.chats.isFullyLoaded,[e]:!0}}}),(0,a.R3)(c)}async function b(e){const t=await(0,v.t9)("fetchFullChat",e);if(!t)return;const{users:s,fullInfo:n}=t;let o=(0,a.Rd)();s&&(o=(0,r.Sh)(o,(0,g.ee)(s,"id"))),o=(0,r.a4)(o,e.id,{fullInfo:n}),(0,a.R3)(o)}async function M(e,t,s){const n=(0,a.Rd)(),o=(0,i.DI)(n,t);if(o&&!o.isMin)return void(s?e.focusMessage({chatId:o.id,messageId:s}):e.openChat({id:o.id}));const c=(0,i.jr)(n);e.openChat({id:-1});const d=await(0,v.t9)("getChatByUsername",t);if(!d)return c&&e.openChat({id:c.id}),void e.showNotification({message:"User does not exist"});(0,a.R3)((0,r.a4)((0,a.Rd)(),d.id,d)),s?e.focusMessage({chatId:d.id,messageId:s}):e.openChat({id:d.id})}(0,a.Q6)("preloadTopChatMessages",((e,t)=>{(async()=>{const s=[];for(let o=0;o<n.ul;o++){await(0,y.wO)(100);const{byId:n,listIds:{active:o},orderedPinnedIds:{active:r}}=(0,a.Rd)().chats;if(!o)return;const{chatId:c}=(0,i.Bt)(e)||{},{pinnedChats:l,otherChats:h}=(0,d.O)(n,o,r),m=[...l,...h].find((({id:e})=>e!==c&&!s.includes(e)));if(!m)return;s.push(m.id),t.loadViewportMessages({chatId:m.id,threadId:u._f})}})()})),(0,a.Q6)("openChat",((e,t,s)=>{const{id:a,threadId:n}=s,{currentUserId:o}=e,r=(0,i.Z1)(e,a);if(r&&r.hasUnreadMark&&t.toggleChatUnread({id:a}),r)(0,d.Hp)(r)&&!r.isMin&&t.requestChatUpdate({chatId:a});else if(a===o)(0,v.t9)("fetchChat",{type:"self"});else{const t=(0,i.dy)(e,a);t&&(0,v.t9)("fetchChat",{type:"user",user:t})}n!==u._f&&((0,i.qS)(e,a,n)||t.requestThreadInfoUpdate({chatId:a,threadId:n}))})),(0,a.Q6)("openSupportChat",((e,t)=>{const s=(0,i.P_)(e);t.openChat({id:s?s.id:-1}),s||(async()=>{const e=await(0,v.t9)("fetchChat",{type:"support"});e&&t.openChat({id:e.chatId})})()})),(0,a.Q6)("openTipsChat",((e,t,s)=>{const{langCode:a}=s,o="pt-br"===a?"BR":n.Db.includes(a)?a.toUpperCase():"";t.openChatByUsername({username:`${n.vi}${o}`})})),(0,a.Q6)("loadMoreChats",((e,t,s)=>{const{listType:a="active"}=s,n=e.chats.listIds[a];if(e.chats.isFullyLoaded[a])return;const o=n?n.map((t=>e.chats.byId[t])).filter((t=>Boolean(t&&t.lastMessage)&&!(0,i.ep)(e,t.id))).sort(((e,t)=>e.lastMessage.date-t.lastMessage.date))[0]:void 0;Z(o?()=>w(a,o.id,o.lastMessage.date):()=>w(a))})),(0,a.Q6)("loadFullChat",((e,t,s)=>{const{chatId:a,force:n}=s,o=(0,i.Z1)(e,a);o&&(n?b(o):C((()=>b(o))))})),(0,a.Q6)("loadTopChats",(()=>{P((()=>w("active")))})),(0,a.Q6)("requestChatUpdate",((e,t,s)=>{const{serverTimeOffset:a}=e,{chatId:n}=s,o=(0,i.Z1)(e,n);o&&(0,v.t9)("requestChatUpdate",{chat:o,serverTimeOffset:a})})),(0,a.Q6)("updateChatMutedState",((e,t,s)=>{const{serverTimeOffset:n}=e,{chatId:o,isMuted:c}=s,d=(0,i.Z1)(e,o);d&&((0,a.R3)((0,r.a4)(e,o,{isMuted:c})),(0,v.t9)("updateChatMutedState",{chat:d,isMuted:c,serverTimeOffset:n}))})),(0,a.Q6)("createChannel",((e,t,s)=>{const{title:n,about:o,photo:c,memberIds:d}=s;!async function(e,t,s,n){(0,a.R3)({...(0,a.Rd)(),chatCreation:{progress:h.Nh.InProgress}});const o=await(0,v.t9)("createChannel",{title:e,about:s,users:t});if(!o)return;const{id:i,accessHash:c}=o;let d=(0,a.Rd)();d=(0,r.a4)(d,i,o),d={...d,chatCreation:{...d.chatCreation,progress:o?h.Nh.Complete:h.Nh.Error}},(0,a.R3)(d),(0,a.uC)().openChat({id:i}),i&&c&&n&&await(0,v.t9)("editChatPhoto",{chatId:i,accessHash:c,photo:n})}(n,d.map((t=>(0,i.dy)(e,t))).filter(Boolean),o,c)})),(0,a.Q6)("joinChannel",((e,t,s)=>{const{chatId:a}=s,n=(0,i.Z1)(e,a);if(!n)return;const{id:o,accessHash:r}=n;o&&r&&(0,v.t9)("joinChannel",{channelId:o,accessHash:r})})),(0,a.Q6)("deleteChatUser",((e,t,s)=>{(async()=>{const{chatId:a,userId:n}=s,o=(0,i.Z1)(e,a),r=(0,i.dy)(e,n);if(!o||!r)return;await(0,v.t9)("deleteChatUser",{chat:o,user:r});const c=(0,i.Bt)(e);c&&c.chatId===a&&e.currentUserId===n&&t.openChat({id:void 0})})()})),(0,a.Q6)("deleteChat",((e,t,s)=>{(async()=>{const{chatId:a}=s,n=(0,i.Z1)(e,a);if(!n)return;await(0,v.t9)("deleteChat",{chatId:n.id});const o=(0,i.Bt)(e);o&&o.chatId===a&&t.openChat({id:void 0})})()})),(0,a.Q6)("leaveChannel",((e,t,s)=>{(async()=>{const{chatId:a}=s,n=(0,i.Z1)(e,a);if(!n)return;const{id:o,accessHash:r}=n;o&&r&&await(0,v.t9)("leaveChannel",{channelId:o,accessHash:r});const c=(0,i.Bt)(e);c&&c.chatId===a&&t.openChat({id:void 0})})()})),(0,a.Q6)("deleteChannel",((e,t,s)=>{(async()=>{const{chatId:a}=s,n=(0,i.Z1)(e,a);if(!n)return;const{id:o,accessHash:r}=n;o&&r&&await(0,v.t9)("deleteChannel",{channelId:o,accessHash:r});const c=(0,i.Bt)(e);c&&c.chatId===a&&t.openChat({id:void 0})})()})),(0,a.Q6)("createGroupChat",((e,t,s)=>{const{title:n,memberIds:o,photo:c}=s;!async function(e,t,s){(0,a.R3)({...(0,a.Rd)(),chatCreation:{progress:h.Nh.InProgress}});const n=await(0,v.t9)("createGroupChat",{title:e,users:t});if(!n)return;const{id:o}=n;let i=(0,a.Rd)();i=(0,r.a4)(i,o,n),i={...i,chatCreation:{...i.chatCreation,progress:n?h.Nh.Complete:h.Nh.Error}},(0,a.R3)(i),(0,a.uC)().openChat({id:o}),o&&s&&await(0,v.t9)("editChatPhoto",{chatId:o,photo:s})}(n,o.map((t=>(0,i.dy)(e,t))).filter(Boolean),c)})),(0,a.Q6)("toggleChatPinned",((e,t,s)=>{const{id:a,folderId:o}=s,r=(0,i.Z1)(e,a);if(r)if(o){const t=(0,i.Mw)(e,o);if(t){const s=!(0,i.ep)(e,a,o),{pinnedChatIds:n,includedChatIds:r}=t,c=s?[a,...n||[]]:(n||[]).filter((e=>e!==a)),d=[a,...r];(0,v.t9)("editChatFolder",{id:o,folderUpdate:{...t,pinnedChatIds:c,includedChatIds:d}})}}else{const t=(0,i.Ek)(e,a),s=(0,i.ep)(e,a,"archived"===t?n.WS:void 0);(0,v.t9)("toggleChatPinned",{chat:r,shouldBePinned:!s})}})),(0,a.Q6)("toggleChatArchived",((e,t,s)=>{const{id:a}=s,o=(0,i.Z1)(e,a);o&&(0,v.t9)("toggleChatArchived",{chat:o,folderId:(0,d.pE)(o)?0:n.WS})})),(0,a.Q6)("loadChatFolders",(()=>{!async function(){const e=await(0,v.t9)("fetchChatFolders");if(e){const t=(0,a.Rd)();(0,a.R3)({...t,chatFolders:{...t.chatFolders,...e}})}}()})),(0,a.Q6)("loadRecommendedChatFolders",(()=>{!async function(){const e=await(0,v.t9)("fetchRecommendedChatFolders");if(e){const t=(0,a.Rd)();(0,a.R3)({...t,chatFolders:{...t.chatFolders,recommended:e}})}}()})),(0,a.Q6)("editChatFolder",((e,t,s)=>{const{id:a,folderUpdate:n}=s,o=(0,i.Mw)(e,a);o&&(0,v.t9)("editChatFolder",{id:a,folderUpdate:{id:a,emoticon:o.emoticon,pinnedChatIds:o.pinnedChatIds,...n}})})),(0,a.Q6)("addChatFolder",((e,t,s)=>{const{folder:o}=s,{orderedIds:r}=e.chatFolders;!async function(e,t){const{id:s,description:n,...o}=e;if(await(0,v.t9)("editChatFolder",{id:t+1,folderUpdate:{id:t+1,...o}}),!n)return;const r=(0,a.Rd)(),{recommended:i}=r.chatFolders;i&&(0,a.R3)({...r,chatFolders:{...r.chatFolders,recommended:i.filter((({id:e})=>e!==s))}})}(o,r&&r.length?Math.max.apply(Math.max,r):n.WS)})),(0,a.Q6)("deleteChatFolder",((e,t,s)=>{const{id:a}=s;(0,i.Mw)(e,a)&&async function(e){await(0,v.t9)("deleteChatFolder",e)}(a)})),(0,a.Q6)("toggleChatUnread",((e,t,s)=>{const{id:a}=s,{serverTimeOffset:n}=e,o=(0,i.Z1)(e,a);o&&(o.unreadCount?(0,v.t9)("markMessageListRead",{serverTimeOffset:n,chat:o,threadId:u._f}):(0,v.t9)("toggleDialogUnread",{chat:o,hasUnreadMark:!o.hasUnreadMark}))})),(0,a.Q6)("openTelegramLink",((e,t,s)=>{const{url:a}=s;let o=n.Lj.exec(a);if(o){const e=o[1];(async()=>{const s=await(0,v.t9)("openChatByInvite",e);s&&t.openChat({id:s.chatId})})()}else{o=n.FS.exec(a);const e=o[1],s=o[2]?Number(o[2]):void 0,r=o[3]?Number(o[3]):void 0;"c"===e&&s&&r?t.focusMessage({chatId:-s,messageId:r}):M(t,e,s)}})),(0,a.Q6)("acceptInviteConfirmation",((e,t,s)=>{const{hash:a}=s;(async()=>{const e=await(0,v.t9)("importChatInvite",{hash:a});e&&t.openChat({id:e.id})})()})),(0,a.Q6)("openChatByUsername",((e,t,s)=>{const{username:a}=s;M(t,a)})),(0,a.Q6)("togglePreHistoryHidden",((e,t,s)=>{const{chatId:a,isEnabled:n}=s;let o=(0,i.Z1)(e,a);o&&(async()=>{if((0,d.G9)(o)){if(o=await(0,v.t9)("migrateChat",o),!o)return;t.openChat({id:o.id})}(0,v.t9)("togglePreHistoryHidden",{chat:o,isEnabled:n})})()})),(0,a.Q6)("updateChatDefaultBannedRights",((e,t,s)=>{const{chatId:a,bannedRights:n}=s,o=(0,i.Z1)(e,a);o&&(0,v.t9)("updateChatDefaultBannedRights",{chat:o,bannedRights:n})})),(0,a.Q6)("updateChatMemberBannedRights",((e,t,s)=>{const{chatId:n,userId:o,bannedRights:c}=s;let l=(0,i.Z1)(e,n);const u=(0,i.dy)(e,o);l&&u&&(async()=>{if((0,d.G9)(l)){if(l=await(0,v.t9)("migrateChat",l),!l)return;t.openChat({id:l.id})}await(0,v.t9)("updateChatMemberBannedRights",{chat:l,user:u,bannedRights:c});const e=(0,a.Rd)(),s=(0,i.Z1)(e,n);if(!s||!s.fullInfo)return;const{members:h,kickedMembers:m}=s.fullInfo,g=!!c.viewMessages,p=!Object.keys(c).length;(0,a.R3)((0,r.a4)(e,n,{fullInfo:{...s.fullInfo,...h&&g&&{members:h.filter((e=>e.userId!==o))},...h&&!g&&{members:h.map((e=>e.userId===o?{...e,bannedRights:c}:e))},...p&&m&&{kickedMembers:m.filter((e=>e.userId!==o))}}}))})()})),(0,a.Q6)("updateChatAdmin",((e,t,s)=>{const{chatId:n,userId:o,adminRights:c,customTitle:l}=s;let u=(0,i.Z1)(e,n);const h=(0,i.dy)(e,o);u&&h&&(async()=>{if((0,d.G9)(u)){if(u=await(0,v.t9)("migrateChat",u),!u)return;t.openChat({id:u.id})}await(0,v.t9)("updateChatAdmin",{chat:u,user:h,adminRights:c,customTitle:l});const e=(0,a.Rd)(),s=(0,i.Z1)(e,n);if(!s||!s.fullInfo)return;const{adminMembers:m}=s.fullInfo,g=!Object.keys(c).length;(0,a.R3)((0,r.a4)(e,n,{fullInfo:{...s.fullInfo,...m&&g&&{adminMembers:m.filter((e=>e.userId!==o))},...m&&!g&&{adminMembers:m.map((e=>e.userId===o?{...e,adminRights:c,customTitle:l}:e))}}}))})()})),(0,a.Q6)("updateChat",((e,t,s)=>{const{chatId:n,title:o,about:c,photo:d}=s,l=(0,i.Z1)(e,n);l&&(async()=>{(0,a.R3)((0,r.H9)((0,a.Rd)(),h.wv.InProgress)),await Promise.all([l.title!==o?(0,v.t9)("updateChatTitle",l,o):void 0,l.fullInfo&&l.fullInfo.about!==c?(0,v.t9)("updateChatAbout",l,c):void 0,d?(0,v.t9)("editChatPhoto",{chatId:n,accessHash:l.accessHash,photo:d}):void 0]),(0,a.R3)((0,r.H9)((0,a.Rd)(),h.wv.Complete))})()})),(0,a.Q6)("toggleSignatures",((e,t,s)=>{const{chatId:a,isEnabled:n}=s,o=(0,i.Z1)(e,a);o&&(0,v.t9)("toggleSignatures",{chat:o,isEnabled:n})})),(0,a.Q6)("loadGroupsForDiscussion",(()=>{(async()=>{const e=await(0,v.t9)("fetchGroupsForDiscussion");if(!e)return;const t=e.reduce(((e,t)=>(t&&(e[t.id]=t),e)),{}),s=(0,r.fZ)((0,a.Rd)(),t);(0,a.R3)({...s,chats:{...s.chats,forDiscussionIds:Object.keys(t).map(Number)}})})()})),(0,a.Q6)("linkDiscussionGroup",((e,t,s)=>{const{channelId:a,chatId:n}=s,o=(0,i.Z1)(e,a);let r=(0,i.Z1)(e,n);o&&r&&(async()=>{if((0,d.G9)(r)){if(r=await(0,v.t9)("migrateChat",r),!r)return;t.openChat({id:r.id})}let{fullInfo:e}=r;if(!e){const t=await(0,v.t9)("fetchFullChat",r);if(!t)return;e=t.fullInfo}e.isPreHistoryHidden&&await(0,v.t9)("togglePreHistoryHidden",{chat:r,isEnabled:!1}),(0,v.t9)("setDiscussionGroup",{channel:o,chat:r})})()})),(0,a.Q6)("unlinkDiscussionGroup",((e,t,s)=>{const{channelId:a}=s,n=(0,i.Z1)(e,a);if(!n)return;let o;n.fullInfo&&n.fullInfo.linkedChatId&&(o=(0,i.Z1)(e,n.fullInfo.linkedChatId)),(async()=>{await(0,v.t9)("setDiscussionGroup",{channel:n}),o&&b(o)})()})),(0,a.Q6)("setActiveChatFolder",((e,t,s)=>({...e,chatFolders:{...e.chatFolders,activeChatFolder:s}}))),(0,a.Q6)("loadMoreMembers",(e=>{(async()=>{const{chatId:t}=(0,i.Bt)(e)||{},s=t?(0,i.Z1)(e,t):void 0;if(!s||(0,d.G9)(s))return;const n=s.fullInfo&&s.fullInfo.members&&s.fullInfo.members.length||void 0,o=await(0,v.t9)("fetchMembers",s.id,s.accessHash,"recent",n);if(!o)return;const{members:c,users:l}=o;c&&c.length&&(e=(0,a.Rd)(),e=(0,r.Sh)(e,(0,g.ee)(l,"id")),e=(0,r.a4)(e,s.id,{fullInfo:{...s.fullInfo,members:[...(s.fullInfo||{}).members||[],...c||[]]}}),(0,a.R3)(e))})()})),(0,a.Q6)("addChatMembers",((e,t,s)=>{const{chatId:a,memberIds:n}=s,o=(0,i.Z1)(e,a),r=n.map((t=>(0,i.dy)(e,t))).filter(Boolean);o&&r.length&&(t.setNewChatMembersDialogState(h.WB.Loading),(async()=>{await(0,v.t9)("addChatMembers",o,r),t.setNewChatMembersDialogState(h.WB.Closed),b(o)})())})),(0,a.Q6)("deleteChatMember",((e,t,s)=>{const{chatId:a,userId:n}=s,o=(0,i.Z1)(e,a),r=(0,i.dy)(e,n);o&&r&&(async()=>{await(0,v.t9)("deleteChatMember",o,r),b(o)})()}));const S=new Map,E=(0,y.Ds)((e=>e()),500,!1);async function k(e,t,s,o,c=!1,d=!1){const l=e.id;let u;switch(o){case h.Uq.Backwards:u=void 0;break;case h.Uq.Around:u=-(Math.round(n.hT/2)+1);break;case h.Uq.Forwards:u=-(n.hT+1)}const m=await(0,v.t9)("fetchMessages",{chat:(0,i.Cm)((0,a.Rd)(),l,t),offsetId:s,addOffset:u,limit:n.hT,threadId:t});if(!m)return;const{messages:p,users:f,chats:I,threadInfos:y}=m,Z=(0,g.ee)(p,"id"),P=Object.keys(Z).map(Number);let C=(0,a.Rd)();C=(0,r.c_)(C,l,Z),C=c?(0,r.ff)(C,l,t,P):(0,r.xj)(C,l,t,P),C=(0,r.Sh)(C,(0,g.ee)(f,"id")),C=(0,r.fZ)(C,(0,g.ee)(I,"id")),C=(0,r.j6)(C,l,y);let w=(0,i.gb)(C,l,t);const b=(0,i.qC)(C,l,t);if(c&&w&&b&&(0,g.YE)(w,b)&&(C=(0,r.xj)(C,l,t,b),w=(0,i.gb)(C,l,t),C=(0,r.pf)(C,l,t,"outlyingIds",void 0),c=!1),!d){const e=c?b:w,{newViewportIds:a}=R(e,s,o);C=(0,r.y9)(C,l,t,a)}(0,a.R3)(C)}function R(e,t,s){const{length:a}=e,o=t?function(e,t){return t<e[0]?0:t>e[e.length-1]?e.length-1:e.findIndex(((s,a)=>s===t||s<t&&e[a+1]>t))}(e,t):-1,r=s===h.Uq.Backwards?o:o+1||a,i=r-n.hT,c=r+n.hT-1,d=e.slice(Math.max(0,i),c+1);let l,u;switch(s){case h.Uq.Backwards:l=r>0,u=i>=0;break;case h.Uq.Forwards:l=r<a,u=c<=a-1;break;case h.Uq.Around:default:l=d.length>0,u=d.length===n.hT}return{newViewportIds:d,areSomeLocal:l,areAllLocal:u}}async function T(e){let t;const s=e.attachment?(e,n)=>{S.has(n)||(t=n,S.set(n,s));const o=(0,a.Rd)();(0,a.R3)({...o,fileUploads:{byMessageLocalId:{...o.fileUploads.byMessageLocalId,[n]:{progress:e}}}})}:void 0;(e.replyingTo||m.cj)&&await(0,y.Pn)();const n=(0,a.Rd)();e.serverTimeOffset=n.serverTimeOffset;const o=(0,i.Bt)(n);if(!o)return;const{threadId:r}=o;e.replyingTo||r===u._f||(e.replyingTo=(0,i.qS)(n,e.chat.id,r)),await(0,v.t9)("sendMessage",e,s),s&&t&&S.delete(t)}(0,a.Q6)("loadViewportMessages",((e,t,s)=>{const{direction:a=h.Uq.Around,isBudgetPreload:o=!1}=s||{};let{chatId:c,threadId:d}=s||{};if(!c){const t=(0,i.Bt)(e);if(!t)return;c=t.chatId,d=t.threadId}const l=(0,i.Z1)(e,c);if(!l||l.isRestricted)return;const u=(0,i.Cb)(e,c,d),m=(0,i.gb)(e,c,d),g=(0,i.qC)(e,c,d);if(u&&u.length&&a!==h.Uq.Around){const s=a===h.Uq.Backwards?u[0]:u[u.length-1],n=Boolean(g),i=n?g:m,{newViewportIds:p,areSomeLocal:f,areAllLocal:I}=R(i,s,a);if(f&&(e=(0,r.y9)(e,c,d,p)),async function(e,t,s,a,n,o,r,i){t||await k(n,o,i,r,s,a),a||(await Promise.resolve(),e.loadViewportMessages({chatId:n.id,threadId:o,direction:r,isBudgetPreload:!0}))}(t,I,n,o,l,d,a,s),o)return}else{const t=(0,i.G$)(e,c)||(0,i.rd)(e,c,d),s=Boolean(t&&m&&!m.includes(t)),a=(s?g:m)||[],{newViewportIds:u,areSomeLocal:p,areAllLocal:f}=R(a,t,h.Uq.Around);p&&u.length>=n.hT&&(e=(0,r.y9)(e,c,d,u)),f||k(l,d,t,h.Uq.Around,s,o)}return e})),(0,a.Q6)("loadMessage",((e,t,s)=>{const{chatId:n,messageId:o,replyOriginForId:c}=s,d=(0,i.Z1)(e,n);d&&async function(e,t,s){const n=await(0,v.t9)("fetchMessage",{chat:e,messageId:t});if(!n)return;if(n===u._Q){if(s){let t=(0,a.Rd)();const n=(0,i.hj)(t,e.id,s);t=(0,r.cY)(t,e.id,s,{...n,replyToMessageId:void 0}),(0,a.R3)(t)}return}let o=(0,a.Rd)();o=(0,r.cY)(o,e.id,t,n.message),o=(0,r.Sh)(o,(0,g.ee)(n.users,"id")),(0,a.R3)(o)}(d,o,c)})),(0,a.Q6)("sendMessage",((e,t,s)=>{const a=(0,i.Bt)(e);if(!a)return;const{chatId:o,threadId:r,type:c}=a;if("scheduled"===c&&!s.scheduledAt)return{...e,messages:{...e.messages,contentToBeScheduled:s}};const d=(0,i.Z1)(e,o);t.setReplyingToId({messageId:void 0}),t.clearWebPagePreview({chatId:o,threadId:r,value:!1});const l={...s,chat:d,replyingTo:(0,i.Yy)(e,o,r),noWebPage:(0,i.tV)(e,o,r)},u=!s.attachments||s.attachments.length<=1,h=!u&&s.attachments&&s.attachments.length>1;if(u){const{attachments:e,...t}=l;T({...t,attachment:e?e[0]:void 0})}else if(h){const{text:e,entities:t,attachments:s,...a}=l,o=(0,g.Vl)(s,n.DU);for(let s=0;s<o.length;s++){const[n,...r]=o[s],i=`${Date.now()}${s}`;T({...a,text:0===s?e:void 0,entities:0===s?t:void 0,attachment:n,groupedId:r.length>0?i:void 0}),r.forEach((e=>{T({...a,attachment:e,groupedId:i})}))}}else{const{text:e,entities:t,attachments:s,replyingTo:a,...n}=l;e&&T({...n,text:e,entities:t,replyingTo:a}),s.forEach((e=>{T({...n,attachment:e})}))}})),(0,a.Q6)("editMessage",((e,t,s)=>{const{serverTimeOffset:a}=e,{text:n,entities:o}=s,r=(0,i.Bt)(e);if(!r)return;const{chatId:c,threadId:d,type:l}=r,u=(0,i.Z1)(e,c),h=(0,i.kK)(e,c,d,l);u&&h&&((0,v.t9)("editMessage",{chat:u,message:h,text:n,entities:o,noWebPage:(0,i.tV)(e,c,d),serverTimeOffset:a}),t.setEditingId({messageId:void 0}))})),(0,a.Q6)("cancelSendingMessage",((e,t,s)=>{const{chatId:a,messageId:n}=s,o=(0,i.hj)(e,a,n),r=o&&S.get(o.previousLocalId||o.id);r&&(0,v.u3)(r),t.apiUpdate({"@type":"deleteMessages",ids:[n],chatId:a})})),(0,a.Q6)("saveDraft",((e,t,s)=>{const{chatId:a,threadId:n,draft:o}=s;if(!o)return;const{text:c,entities:d}=o,l=(0,i.Z1)(e,a);return n===u._f&&(0,v.t9)("saveDraft",{chat:l,text:c,entities:d,replyToMsgId:(0,i.Yy)(e,a,n)}),e=(0,r.pf)(e,a,n,"draft",o),(0,r.a4)(e,a,{draftDate:Math.round(Date.now()/1e3)})})),(0,a.Q6)("clearDraft",((e,t,s)=>{const{chatId:a,threadId:n,localOnly:o}=s;if(!(0,i.Ms)(e,a,n))return;const c=(0,i.Z1)(e,a);return o||n!==u._f||(0,v.t9)("clearDraft",c),e=(0,r.pf)(e,a,n,"draft",void 0),(0,r.a4)(e,a,{draftDate:void 0})})),(0,a.Q6)("toggleMessageWebPage",((e,t,s)=>{const{chatId:a,threadId:n,noWebPage:o}=s;return(0,r.pf)(e,a,n,"noWebPage",o)})),(0,a.Q6)("pinMessage",((e,t,s)=>{const a=(0,i.jr)(e);if(!a)return;const{messageId:n,isUnpin:o,isOneSide:r,isSilent:c}=s;(0,v.t9)("pinMessage",{chat:a,messageId:n,isUnpin:o,isOneSide:r,isSilent:c})})),(0,a.Q6)("unpinAllMessages",((e,t,s)=>{const n=(0,i.Z1)(e,s.chatId);n&&async function(e){await(0,v.t9)("unpinAllMessages",{chat:e});let t=(0,a.Rd)();t=(0,r.pf)(t,e.id,u._f,"pinnedIds",[]),(0,a.R3)(t)}(n)})),(0,a.Q6)("deleteMessages",((e,t,s)=>{const{messageIds:a,shouldDeleteForAll:n}=s,o=(0,i.Bt)(e);if(!o)return;const{chatId:r,threadId:c}=o,d=(0,i.Z1)(e,r);(0,v.t9)("deleteMessages",{chat:d,messageIds:a,shouldDeleteForAll:n});const l=(0,i._$)(e,r,c);a.includes(l)&&t.setEditingId({messageId:void 0})})),(0,a.Q6)("deleteScheduledMessages",((e,t,s)=>{const{messageIds:a}=s,n=(0,i.Bt)(e);if(!n)return;const{chatId:o}=n,r=(0,i.Z1)(e,o);(0,v.t9)("deleteScheduledMessages",{chat:r,messageIds:a});const c=(0,i.wU)(e,o);a.includes(c)&&t.setEditingId({messageId:void 0})})),(0,a.Q6)("deleteHistory",((e,t,s)=>{(async()=>{const{chatId:a,shouldDeleteForAll:n}=s,o=(0,i.Z1)(e,a);if(!o)return;const r=o.lastMessage&&o.lastMessage.id;await(0,v.t9)("deleteHistory",{chat:o,shouldDeleteForAll:n,maxId:r});const c=(0,i.Bt)(e);c&&c.chatId===a&&t.openChat({id:void 0})})()})),(0,a.Q6)("reportMessages",((e,t,s)=>{(async()=>{const{messageIds:a,reason:n,description:o}=s,r=(0,i.Bt)(e);if(!r)return;const{chatId:c}=r,d=(0,i.Z1)(e,c),l=await(0,v.t9)("reportMessages",{peer:d,messageIds:a,reason:n,description:o});t.showNotification({message:l?"Thank you! Your report will be reviewed by our team.":"Error occured while submiting report. Please, try again later."})})()})),(0,a.Q6)("markMessageListRead",((e,t,s)=>{const{serverTimeOffset:a}=e,n=(0,i.Bt)(e);if(!n)return;const{chatId:o,threadId:c}=n,d=(0,i.Cm)(e,o,c);if(!d)return;const{maxId:l}=s;if(E((()=>{(0,v.t9)("markMessageListRead",{serverTimeOffset:a,chat:d,threadId:c,maxId:l})})),c!==u._f)return;const h=(0,i.Cb)(e,o,c),m=(0,i.It)(e,o,c);if(!h||!m||!d.unreadCount)return;const g=function(e,t,s){let a=0;for(let n=0,o=e.length;n<o&&(e[n]>=t&&e[n]<=s&&a++,!(e[n]>=s));n++);return a}(h,m,l);return g?(0,r.a4)(e,o,{lastReadInboxMessageId:l,unreadCount:Math.max(0,d.unreadCount-g)}):void 0})),(0,a.Q6)("markMessagesRead",((e,t,s)=>{const a=(0,i.jr)(e);if(!a)return;const{messageIds:n}=s;(0,v.t9)("markMessagesRead",{chat:a,messageIds:n})})),(0,a.Q6)("loadWebPagePreview",((e,t,s)=>{const{text:n}=s;!async function(e){const t=await(0,v.t9)("fetchWebPagePreview",{message:e});(0,a.R3)({...(0,a.Rd)(),webPagePreview:t})}(n)})),(0,a.Q6)("clearWebPagePreview",(e=>{if(e.webPagePreview)return{...e,webPagePreview:void 0}})),(0,a.Q6)("sendPollVote",((e,t,s)=>{const{chatId:a,messageId:n,options:o}=s,r=(0,i.Z1)(e,a);r&&(0,v.t9)("sendPollVote",{chat:r,messageId:n,options:o})})),(0,a.Q6)("loadPollOptionResults",((e,t,s)=>{const{chat:n,messageId:o,option:i,offset:c,limit:d,shouldResetVoters:l}=s;!async function(e,t,s,n,o,i){const c=await(0,v.t9)("loadPollOptionResults",{chat:e,messageId:t,option:s,offset:n,limit:o});if(!c)return;let d=(0,a.Rd)();d=(0,r.Sh)(d,(0,g.ee)(c.users,"id"));const{voters:l}=d.pollResults;(0,a.R3)({...d,pollResults:{...d.pollResults,voters:{...l,[s]:[...!i&&l&&l[s]?l[s]:[],...c&&c.users.map((e=>e.id))].filter(((e,t,s)=>s.indexOf(e)===t))},offsets:{...d.pollResults.offsets?d.pollResults.offsets:{},[s]:c.nextOffset||""}}})}(n,o,i,c,d,l)})),(0,a.Q6)("forwardMessages",(e=>{const{fromChatId:t,messageIds:s,toChatId:n}=e.forwardMessages,o=t?(0,i.Z1)(e,t):void 0,r=n?(0,i.Z1)(e,n):void 0,c=t&&s?s.sort(((e,t)=>e-t)).map((s=>(0,i.hj)(e,t,s))).filter(Boolean):void 0;o&&r&&c&&c.length&&function(e,t,s){(0,v.t9)("forwardMessages",{fromChat:e,toChat:t,messages:s,serverTimeOffset:(0,a.Rd)().serverTimeOffset}),(0,a.R3)({...(0,a.Rd)(),forwardMessages:{}})}(o,r,c)})),(0,a.Q6)("loadScheduledHistory",(e=>{const t=(0,i.jr)(e);if(!t)return;const{hash:s}=e.scheduledMessages.byChatId[t.id]||{};!async function(e,t){const s=await(0,v.t9)("fetchScheduledHistory",{chat:e,hash:t});if(!s)return;const{hash:n,messages:o}=s,i=(0,g.ee)(o,"id"),c=Object.keys(i).map(Number).sort(((e,t)=>t-e));let d=(0,a.Rd)();d=(0,r.w3)(d,e.id,i,n),d=(0,r.pf)(d,e.id,u._f,"scheduledIds",c),(0,a.R3)(d)}(t,s)})),(0,a.Q6)("sendScheduledMessages",((e,t,s)=>{const{chatId:a,id:n}=s,o=(0,i.Z1)(e,a);o&&(0,v.t9)("sendScheduledMessages",{chat:o,ids:[n]})})),(0,a.Q6)("rescheduleMessage",((e,t,s)=>{const{chatId:a,messageId:n,scheduledAt:o}=s,r=(0,i.Z1)(e,a),c=r&&(0,i.Tm)(e,r.id,n);r&&c&&(0,v.t9)("rescheduleMessage",{chat:r,message:c,scheduledAt:o})})),(0,a.Q6)("requestThreadInfoUpdate",((e,t,s)=>{const{chatId:a,threadId:n}=s,o=(0,i.Cm)(e,a,n);o&&(0,v.t9)("requestThreadInfoUpdate",{chat:o,threadId:n})})),(0,a.Q6)("loadPinnedMessages",((e,t,s)=>{const{chatId:n}=s,o=(0,i.Z1)(e,n);o&&async function(e){const t=await(0,v.t9)("fetchPinnedMessages",{chat:e});if(!t)return;const{messages:s,chats:n,users:o}=t,i=(0,g.ee)(s,"id"),c=Object.keys(i).map(Number).sort(((e,t)=>t-e));let d=(0,a.Rd)();d=(0,r.c_)(d,e.id,i),d=(0,r.pf)(d,e.id,u._f,"pinnedIds",c),d=(0,r.Sh)(d,(0,g.ee)(o,"id")),d=(0,r.fZ)(d,(0,g.ee)(n,"id")),(0,a.R3)(d)}(o)}));var N=s(5765);const B=(0,y.P2)((e=>e()),500,!1);async function x(e,t){const s=await(0,v.t9)("searchGifs",{query:e,offset:t});s&&(0,a.R3)((0,r.rq)((0,a.Rd)(),!t,s.gifs,s.nextOffset))}(0,a.Q6)("loadStickerSets",(e=>{const{hash:t}=e.stickers.added||{};!async function(e=0){const t=await(0,v.t9)("fetchStickerSets",{hash:e});t&&(0,a.R3)((0,r.z3)((0,a.Rd)(),"added",t.hash,t.sets))}(t)})),(0,a.Q6)("loadAddedStickers",((e,t)=>{const{setIds:s}=e.stickers.added;s&&s.length&&(async()=>{for(let e=0;e<s.length;e++)t.loadStickers({stickerSetId:s[e]}),e%50==0&&e>0&&await(0,y.wO)(500)})()})),(0,a.Q6)("loadRecentStickers",(e=>{const{hash:t}=e.stickers.recent||{};!async function(e=0){const t=await(0,v.t9)("fetchRecentStickers",{hash:e});if(!t)return;const s=(0,a.Rd)();(0,a.R3)({...s,stickers:{...s.stickers,recent:t}})}(t)})),(0,a.Q6)("loadFavoriteStickers",(e=>{const{hash:t}=e.stickers.favorite||{};!async function(e=0){const t=await(0,v.t9)("fetchFavoriteStickers",{hash:e});if(!t)return;const s=(0,a.Rd)();(0,a.R3)({...s,stickers:{...s.stickers,favorite:t}})}(t)})),(0,a.Q6)("loadGreetingStickers",(e=>{const{hash:t}=e.stickers.greeting||{};(async()=>{const e=await(0,v.t9)("fetchStickersForEmoji",{emoji:"ðŸ‘‹â­ï¸",hash:t});if(!e)return;const s=(0,a.Rd)();(0,a.R3)({...s,stickers:{...s.stickers,greeting:{hash:e.hash,stickers:e.stickers.filter((e=>"ðŸ‘‹"===e.emoji))}}})})()})),(0,a.Q6)("loadFeaturedStickers",(e=>{const{hash:t}=e.stickers.featured||{};!async function(e=0){const t=await(0,v.t9)("fetchFeaturedStickers",{hash:e});t&&(0,a.R3)((0,r.z3)((0,a.Rd)(),"featured",t.hash,t.sets))}(t)})),(0,a.Q6)("loadStickers",((e,t,s)=>{const{stickerSetId:n,stickerSetShortName:o}=s;let{stickerSetAccessHash:c}=s;if(!c&&!o){const t=(0,i.Ny)(e,n);if(!t)return;c=t.accessHash}!async function(e,t,s){const n=await(0,v.t9)("fetchStickers",{stickerSetShortName:s,stickerSetId:e,accessHash:t});if(!n)return;const{set:o,stickers:i,packs:c}=n;let d=(0,a.Rd)();d=(0,r.Rg)(d,o.id,{...o,stickers:i,packs:c});const l=d.stickers.forEmoji.emoji;l&&c[l]&&(d=(0,r.vy)(d)),(0,a.R3)(d)}(n,c,o)})),(0,a.Q6)("loadAnimatedEmojis",(()=>{!async function(){const e=await(0,v.t9)("fetchAnimatedEmojis");if(!e)return;const{set:t,stickers:s}=e;(0,a.R3)((0,r.g_)((0,a.Rd)(),{...t,stickers:s}))}()})),(0,a.Q6)("loadSavedGifs",(e=>{const{hash:t}=e.gifs.saved;!async function(e=0){const t=await(0,v.t9)("fetchSavedGifs",{hash:e});if(!t)return;const s=(0,a.Rd)();(0,a.R3)({...s,gifs:{...s.gifs,saved:t}})}(t)})),(0,a.Q6)("faveSticker",((e,t,s)=>{const{sticker:a}=s;a&&(0,v.t9)("faveSticker",{sticker:a})})),(0,a.Q6)("unfaveSticker",((e,t,s)=>{const{sticker:n}=s;n&&function(e){const t=(0,a.Rd)();(0,a.R3)({...t,stickers:{...t.stickers,favorite:{...t.stickers.favorite,stickers:t.stickers.favorite.stickers.filter((({id:t})=>t!==e.id))}}}),(0,v.t9)("faveSticker",{sticker:e,unfave:!0})}(n)})),(0,a.Q6)("toggleStickerSet",((e,t,s)=>{const{stickerSetId:a}=s,n=(0,i.Ny)(e,a);if(!n)return;const{accessHash:o,installedDate:r}=n;(0,v.t9)(r?"uninstallStickerSet":"installStickerSet",{stickerSetId:a,accessHash:o})})),(0,a.Q6)("loadEmojiKeywords",((e,t,s)=>{const{language:n}=s;let o=e.emojiKeywords[n];o&&o.isLoading||((0,a.R3)({...e,emojiKeywords:{...e.emojiKeywords,[n]:{...o,isLoading:!0}}}),(async()=>{const t=await(0,v.t9)("fetchEmojiKeywords",{language:n,fromVersion:o?o.version:0});e=(0,a.Rd)(),o=e.emojiKeywords[n],t?(0,a.R3)({...e,emojiKeywords:{...e.emojiKeywords,[n]:{isLoading:!1,version:t.version,keywords:{...o&&o.keywords,...t.keywords}}}}):(0,a.R3)({...e,emojiKeywords:{...e.emojiKeywords,[n]:{...o,isLoading:!1}}})})())})),(0,a.Q6)("setStickerSearchQuery",((e,t,s)=>{const{query:n}=s;n&&B((()=>{!async function(e,t=0){const s=await(0,v.t9)("searchStickers",{query:e,hash:t});if(!s)return;const n=(0,a.Rd)(),{setsById:o,added:i}=n.stickers,c=s.sets.map((({id:e})=>e));i.setIds&&i.setIds.forEach((t=>{if(!c.includes(t)){const{title:s}=o[t]||{};s&&(0,N.Z)(s,e)&&c.unshift(t)}})),(0,a.R3)((0,r.z3)(n,"search",s.hash,s.sets,c))}(n)}))})),(0,a.Q6)("setGifSearchQuery",((e,t,s)=>{const{query:a}=s;"string"==typeof a&&B((()=>{x(a)}))})),(0,a.Q6)("searchMoreGifs",(e=>{const{query:t,offset:s}=e.gifs.search;"string"==typeof t&&B((()=>{x(t,s)}))})),(0,a.Q6)("loadStickersForEmoji",((e,t,s)=>{const{emoji:n}=s,{hash:o}=e.stickers.forEmoji;B((()=>{!async function(e,t=0){let s=(0,a.Rd)();(0,a.R3)({...s,stickers:{...s.stickers,forEmoji:{...s.stickers.forEmoji,emoji:e}}});const n=await(0,v.t9)("fetchStickersForEmoji",{emoji:e,hash:t});s=(0,a.Rd)(),n&&s.stickers.forEmoji.emoji===e&&(s=(0,r.IM)(s,e,n.stickers,n.hash),(0,a.R3)(s))}(n,o)}))})),(0,a.Q6)("clearStickersForEmoji",(e=>({...e,stickers:{...e.stickers,forEmoji:{}}}))),(0,a.Q6)("openStickerSetShortName",((e,t,s)=>{const{stickerSetShortName:a}=s;return{...e,openedStickerSetShortName:a}}));var A=s(790);const L=(0,y.P2)((e=>e()),500,!1);async function O(e="",t,s,o,c,d){let l;if(o){const a=await(0,v.t9)("searchMessagesLocal",{chatOrUser:o,query:e,type:t,limit:n.Hk,offsetId:s,minDate:d,maxDate:c});if(a){const{messages:e,users:t,totalCount:s,nextOffsetId:n}=a;l={messages:e,users:t,chats:[],totalCount:s,nextRate:n}}}else l=await(0,v.t9)("searchMessagesGlobal",{query:e,offsetRate:s,limit:n.Hk,type:t,maxDate:c,minDate:d});let u=(0,a.Rd)();const h=(0,i.JX)(u);if(!l||""!==e&&e!==h)return void(0,a.R3)((0,r.xv)(u,{messages:!1}));const{messages:m,users:p,chats:f,totalCount:I,nextRate:y}=l;f.length&&(u=(0,r.fZ)(u,(0,g.ee)(f,"id"))),p.length&&(u=(0,r.Sh)(u,(0,g.ee)(p,"id"))),m.length&&(u=(0,r.m6)(u,m)),u=(0,r.px)(u,m,I,t,y),(0,a.R3)(u)}async function U(){const e=await(0,v.t9)("fetchChats",{limit:n.Ov,archived:!0,withPinned:!0,serverTimeOffset:(0,a.Rd)().serverTimeOffset});if(!e)return;let t=(0,a.Rd)();t=(0,r.eD)(t,(0,g.ee)(e.users,"id")),t=(0,r.GL)(t,(0,g.ee)(e.chats,"id")),t=(0,r.Mg)(t,"archived",e.chatIds),t=(0,r.vv)(t,"archived",e),(0,a.R3)(t)}async function F(){let e=(0,a.Rd)();const{recentlyFoundChatIds:t}=e.globalSearch,{userIds:s}=e.contactList||{};if(!(s&&s.length||t&&t.length))return;const n=[...t||[],...s||[]].map((t=>(0,i.dy)(e,t))).filter(Boolean),o=await(0,v.t9)("fetchUsers",{users:n});o&&(e=(0,a.Rd)(),e=(0,r.eD)(e,(0,g.ee)(o,"id")),(0,a.R3)(e))}function $(e){return(0,v.t9)("fetchMessages",{chat:e,threadId:u._f,offsetId:e.lastReadInboxMessageId,addOffset:-(Math.round(n.hT/2)+1),limit:n.hT})}(0,a.Q6)("setGlobalSearchQuery",((e,t,s)=>{const{chatId:n}=e.globalSearch,{query:o}=s;o&&!n&&L((()=>{!async function(e){const t=await(0,v.t9)("searchChats",{query:e});let s=(0,a.Rd)();const n=(0,i.JX)(s);if(!t||!n||e!==n)return void(0,a.R3)((0,r.xv)(s,{chats:!1}));const{localChats:o,localUsers:c,globalChats:d,globalUsers:l}=t;(o.length||d.length)&&(s=(0,r.fZ)(s,(0,g.ee)([...o,...d],"id"))),(c.length||l.length)&&(s=(0,r.Sh)(s,(0,g.ee)([...c,...l],"id"))),s=(0,r.xv)(s,{chats:!1}),s=(0,r.No)(s,{localResults:{chatIds:o.map((({id:e})=>e)),userIds:c.map((({id:e})=>e))},globalResults:{...s.globalSearch.globalResults,chatIds:l.map((({id:e})=>e)),userIds:d.map((({id:e})=>e))}}),(0,a.R3)(s)}(o)}))})),(0,a.Q6)("setGlobalSearchDate",((e,t,s)=>{const{date:n}=s,o=n?(0,A.IS)(n):n,c=(0,r.No)(e,{date:n,query:"",resultsByType:{...e.globalSearch.resultsByType,text:{totalCount:void 0,foundIds:[],nextOffsetId:0}}});(0,a.R3)(c);const{chatId:d}=e.globalSearch;O("","text",void 0,d?(0,i.Z1)(e,d):void 0,o,n)})),(0,a.Q6)("searchMessagesGlobal",((e,t,s)=>{const{query:a,resultsByType:n,chatId:o,date:r}=e.globalSearch,c=r?(0,A.IS)(r):r,{type:d}=s,{nextOffsetId:l}=n&&n[d]||{};O(a,d,l,o?(0,i.Z1)(e,o):void 0,c,r)})),(0,a.Q6)("searchTextMessagesLocal",(e=>{const{chatId:t,threadId:s}=(0,i.Bt)(e)||{},o=t?(0,i.Z1)(e,t):void 0,c=(0,i.n5)(e);if(!o||!c||!s)return;const{query:d,results:l}=c,h=l?l.nextOffsetId:void 0;let m;if(s!==u._f){const a=(0,i.tZ)(e,t,s);m=a?a.topMessageId:void 0}!async function(e,t,s,o,c){const d=await(0,v.t9)("searchMessagesLocal",{chatOrUser:e,type:"text",query:o,topMessageId:s,limit:n.pn,offsetId:c});if(!d)return;const{messages:l,users:u,totalCount:h,nextOffsetId:m}=d,p=(0,g.ee)(l,"id"),f=Object.keys(p).map(Number);let I=(0,a.Rd)();const y=(0,i.n5)(I);!y||o&&o!==y.query||(I=(0,r.c_)(I,e.id,p),I=(0,r.Sh)(I,(0,g.ee)(u,"id")),I=(0,r.dx)(I,e.id,t,f,h,m),(0,a.R3)(I))}(o,s,m,d,h)})),(0,a.Q6)("searchMediaMessagesLocal",(e=>{const t=(0,i.og)(e),s=t?e.users.byId[t]||e.chats.byId[t]:void 0,o=(0,i.we)(e);if(!s||!o)return;const{currentType:c,resultsByType:d}=o,l=c&&d&&d[c],u=l?l.nextOffsetId:void 0;c&&async function(e,t,s){const o=await(0,v.t9)("searchMessagesLocal",{chatOrUser:e,type:t,limit:n.EN,offsetId:s});if(!o)return;const{messages:c,users:d,totalCount:l,nextOffsetId:u}=o,h=(0,g.ee)(c,"id"),m=Object.keys(h).map(Number);let p=(0,a.Rd)();(0,i.we)(p)&&(p=(0,r.c_)(p,e.id,h),p=(0,r.Sh)(p,(0,g.ee)(d,"id")),p=(0,r.c1)(p,e.id,t,m,l,u),(0,a.R3)(p))}(s,c,u)})),(0,a.Q6)("searchMessagesByDate",((e,t,s)=>{const{timestamp:n}=s,{chatId:o}=(0,i.Bt)(e)||{};if(!o)return;const r=(0,i.Z1)(e,o);r&&async function(e,t){const s=await(0,v.t9)("findFirstMessageIdAfterDate",{chat:e,timestamp:t});s&&(0,a.uC)().focusMessage({chatId:e.id,messageId:s})}(r,n)})),(0,a.Q6)("checkPublicLink",((e,t,s)=>{const{chatId:n}=(0,i.Bt)(e)||{};if(!n)return;if(e.management.progress===h.wv.InProgress)return;const{username:o}=s;(async()=>{e=(0,r.H9)(e,h.wv.InProgress),e=(0,r.fw)(e,n,{isUsernameAvailable:void 0}),(0,a.R3)(e);const t=await(0,v.t9)("checkChatUsername",{username:o});e=(0,a.Rd)(),e=(0,r.H9)(e,t?h.wv.Complete:h.wv.Error),e=(0,r.fw)(e,n,{isUsernameAvailable:t}),(0,a.R3)(e)})()})),(0,a.Q6)("updatePublicLink",((e,t,s)=>{const{chatId:n}=(0,i.Bt)(e)||{};let o=n&&(0,i.Z1)(e,n);if(!n||!o)return;const{username:c}=s;(async()=>{if(e=(0,r.H9)(e,h.wv.InProgress),(0,a.R3)(e),(0,d.G9)(o)){if(o=await(0,v.t9)("migrateChat",o),!o)return;t.openChat({id:o.id})}const s=await(0,v.t9)("setChatUsername",{chat:o,username:c});e=(0,a.Rd)(),e=(0,r.H9)(e,s?h.wv.Complete:h.wv.Error),e=(0,r.fw)(e,n,{isUsernameAvailable:void 0}),(0,a.R3)(e)})()})),(0,a.Q6)("updatePrivateLink",(e=>{const{chatId:t}=(0,i.Bt)(e)||{},s=t&&(0,i.Z1)(e,t);t&&s&&(0,v.t9)("updatePrivateLink",{chat:s})})),(0,a.Q6)("sync",((e,t)=>{!async function(e){n.eM&&console.log(">>> START SYNC"),await(0,v.t9)("fetchCurrentUser");const t=await async function(){const e=await(0,v.t9)("fetchChats",{limit:n.Ov,withPinned:!0,serverTimeOffset:(0,a.Rd)().serverTimeOffset});if(!e)return;let t=(0,a.Rd)();const{recentlyFoundChatIds:s}=t.globalSearch,{userIds:o}=t.contactList||{},{currentUserId:c}=t,l=[...s||[],...o||[],...c?[c]:[]],h=l.map((e=>(0,i.dy)(t,e))).filter(Boolean),m=l.map((e=>(0,i.Z1)(t,e))).filter(Boolean),{chatId:p}=(0,i.Bt)(t)||{};if(p){const e=(0,i.Z1)(t,p);if(e&&!l.includes(p)&&m.push(e),(0,d.YA)(p)){const e=(0,i.dy)(t,p);e&&!l.includes(p)&&h.push(e)}}return h.push(...e.users),m.push(...e.chats),t=(0,r.SL)(t,(0,g.ee)(m,"id")),t=(0,r.Mg)(t,"active",e.chatIds),t={...t,chats:{...t.chats}},t=(0,r.vv)(t,"active",e),Object.keys(e.draftsById).map(Number).forEach((s=>{t=(0,r.pf)(t,s,u._f,"draft",e.draftsById[s])})),Object.keys(e.replyingToById).map(Number).forEach((s=>{t=(0,r.pf)(t,s,u._f,"replyingToId",e.replyingToById[s])})),(0,a.R3)(t),p&&!t.chats.byId[p]&&(0,a.uC)().openChat({id:void 0}),h}();await async function(e){let t=!1,s=e||[],n=(0,a.Rd)();const{chatId:o,threadId:c}=(0,i.Bt)(n)||{},d=Object.keys(n.messages.byChatId).map(Number).reduce(((e,t)=>{const s=(0,i.Ms)(n,t,u._f);return s?{...e,[t]:s}:e}),{});if(o){const e=await $(n.chats.byId[o]);n=(0,a.Rd)();const{chatId:d}=(0,i.Bt)(n)||{},l=c&&(0,i.tZ)(n,o,c);if(e&&d===o){const a=n.messages.byChatId[o],i=(0,g.ee)(e.messages,"id"),d=Object.keys(i).map(Number);if(n={...n,messages:{...n.messages,byChatId:{[o]:{byId:i,threadsById:{[u._f]:{...a&&a.threadsById[u._f],listedIds:d,viewportIds:d,outlyingIds:void 0}}}}}},c&&l&&l.originChannelId){const{originChannelId:e}=l,t=n.messages.byChatId[e],s=await $(n.chats.byId[e]);if(s){const e=(0,g.ee)(s.messages,"id"),r=Object.keys(e).map(Number);n={...n,messages:{...n.messages,byChatId:{...n.messages.byChatId,[l.originChannelId]:{byId:e,threadsById:{[u._f]:{...t&&t.threadsById[u._f],listedIds:r,viewportIds:r,outlyingIds:void 0}}},[o]:{...n.messages.byChatId[o],threadsById:{...n.messages.byChatId[o].threadsById,[c]:{...a&&a.threadsById[c],outlyingIds:void 0}}}}}}}}n=(0,r.GL)(n,(0,g.ee)(e.chats,"id")),n=(0,r.j6)(n,o,e.threadInfos),t=!0,s=Array.prototype.concat(s,e.users)}}t||(n={...n,messages:{...n.messages,byChatId:{}}}),Object.keys(d).map(Number).forEach((e=>{n=(0,r.pf)(n,e,u._f,"draft",d[e])})),e?n=(0,r.s5)(n,(0,g.ee)(s,"id")):s&&(n=(0,r.eD)(n,(0,g.ee)(s,"id"))),(0,a.R3)(n);const{chatId:l,messageId:h}=n.audioPlayer;l&&h&&!(0,i.hj)(n,l,h)&&(0,a.uC)().closeAudioPlayer()}(t),(0,a.R3)({...(0,a.Rd)(),lastSyncTime:Date.now()}),n.eM&&console.log(">>> FINISH SYNC"),e()}(t.afterSync)})),(0,a.Q6)("afterSync",((e,t)=>{!async function(e){n.eM&&console.log(">>> START AFTER-SYNC"),e.loadFavoriteStickers(),await Promise.all([F(),U()]),await(0,v.t9)("fetchCurrentUser"),n.eM&&console.log(">>> FINISH AFTER-SYNC")}(t)}));const Q=(0,y.Ds)((e=>e()),500,!1,!0),D=(0,y.P2)((e=>e()),500,!1);function q(e,t,s){return{...e,inlineBots:{...e.inlineBots,byUsername:{...e.inlineBots.byUsername,[t]:s}}}}function G(e,t){return{...e,inlineBots:{...e.inlineBots,isLoading:t}}}(0,a.Q6)("loadFullUser",((e,t,s)=>{const{userId:a}=s,n=(0,i.dy)(e,a);if(!n)return;const{id:o,accessHash:r}=n;Q((()=>(0,v.t9)("fetchFullUser",{id:o,accessHash:r})))})),(0,a.Q6)("loadUser",((e,t,s)=>{const{userId:n}=s,o=(0,i.dy)(e,n);o&&(async()=>{const t=await(0,v.t9)("fetchUsers",{users:[o]});t&&(e=(0,a.Rd)(),e=(0,r.eD)(e,(0,g.ee)(t,"id")),(0,a.R3)(e))})()})),(0,a.Q6)("loadTopUsers",(e=>{const{serverTimeOffset:t,topPeers:{hash:s,lastRequestedAt:n}}=e;(!n||Date.now()/1e3+t-n>60)&&async function(e){const t=await(0,v.t9)("fetchTopUsers",{hash:e});if(!t)return;const{hash:s,ids:n,users:o}=t;let i=(0,a.Rd)();i=(0,r.Sh)(i,(0,g.ee)(o,"id")),i={...i,topPeers:{...i.topPeers,hash:s,userIds:n,lastRequestedAt:Date.now()/1e3+i.serverTimeOffset}},(0,a.R3)(i)}(s)})),(0,a.Q6)("loadContactList",(e=>{const{hash:t}=e.contactList||{};!async function(e){const t=await(0,v.t9)("fetchContactList",{hash:e});if(!t)return;let s=(0,r.Sh)((0,a.Rd)(),(0,g.ee)(t.users,"id"));s=(0,r.fZ)(s,(0,g.ee)(t.chats,"id"));const n=e=>e.lastName||e.firstName||"",o=new Intl.Collator("en-US"),i=t.users.sort(((e,t)=>o.compare(n(e),n(t)))).filter((e=>!e.isSelf));(0,a.R3)({...s,contactList:{hash:t.hash,userIds:i.map((e=>e.id))}})}(t)})),(0,a.Q6)("loadCurrentUser",(()=>{(0,v.t9)("fetchCurrentUser")})),(0,a.Q6)("updateContact",((e,t,s)=>{const{userId:n,isMuted:o,firstName:c,lastName:d}=s;!async function(e,t,s,n){const o=(0,a.Rd)(),c=(0,i.dy)(o,e);c&&((0,a.uC)().updateChatMutedState({chatId:e,isMuted:t}),(0,a.R3)((0,r.H9)((0,a.Rd)(),h.wv.InProgress)),await(0,v.t9)("updateContact",{phone:c.phoneNumber,firstName:s,lastName:n})&&(0,a.R3)((0,r.Nq)((0,a.Rd)(),c.id,{firstName:s,lastName:n})),(0,a.R3)((0,r.H9)((0,a.Rd)(),h.wv.Complete)))}(n,o,c,d)})),(0,a.Q6)("deleteUser",((e,t,s)=>{const{userId:n}=s;!async function(e){const t=(0,a.Rd)(),s=(0,i.dy)(t,e);if(!s)return;const{id:n,accessHash:o}=s;await(0,v.t9)("deleteUser",{id:n,accessHash:o})}(n)})),(0,a.Q6)("loadProfilePhotos",((e,t,s)=>{const{profileId:n}=s,o=(0,d.YA)(n),c=o?(0,i.dy)(e,n):void 0,l=o?void 0:(0,i.Z1)(e,n);(async()=>{const e=await(0,v.t9)("fetchProfilePhotos",c,l);if(!e||!e.photos)return;let t=(0,a.Rd)();o?t=(0,r.Nq)(t,n,{photos:e.photos}):(t=(0,r.Sh)(t,(0,g.ee)(e.users,"id")),t=(0,r.a4)(t,n,{photos:e.photos})),(0,a.R3)(t)})()})),(0,a.Q6)("setUserSearchQuery",((e,t,s)=>{const{query:n}=s;n&&D((()=>{!async function(e){const t=await(0,v.t9)("searchChats",{query:e});let s=(0,a.Rd)();const n=s.userSearch.query;if(!t||!n||e!==n)return void(0,a.R3)((0,r.Q3)(s,!1));const{localUsers:o,globalUsers:i}=t;let c,d;o.length&&(s=(0,r.Sh)(s,(0,g.ee)(o,"id")),c=o.map((({id:e})=>e))),i.length&&(s=(0,r.Sh)(s,(0,g.ee)(i,"id")),d=i.map((({id:e})=>e))),s=(0,r.Q3)(s,!1),s=(0,r.Lm)(s,{localUserIds:c,globalUserIds:d}),(0,a.R3)(s)}(n)}))}));const H=(0,y.Ds)((e=>e()),500,!1);async function j(e,t,s){await(0,v.t9)("sendMessage",{chat:e,text:s})}(0,a.Q6)("clickInlineButton",((e,t,s)=>{const{button:o}=s;switch(o.type){case"command":t.sendBotCommand({command:o.value});break;case"url":o.value.match(n.Lj)||o.value.match(n.FS)?t.openTelegramLink({url:o.value}):t.toggleSafeLinkModal({url:o.value});break;case"callback":{const t=(0,i.jr)(e);if(!t)return;!async function(e,t,s){const n=await(0,v.t9)("answerCallbackButton",{chatId:e.id,accessHash:e.accessHash,messageId:t,data:s});if(!n||!n.message)return;const{message:o,alert:r}=n;r?(0,a.uC)().showDialog({data:{message:o}}):(0,a.uC)().showNotification({message:o})}(t,o.messageId,o.value);break}case"requestPoll":t.openPollModal();break;case"buy":{const s=(0,i.jr)(e),{messageId:a,value:n}=o;if(!s)return;n?t.getReceipt({receiptMessageId:n,chatId:s.id,messageId:a}):(t.getPaymentForm({chat:s,messageId:a}),t.setInvoiceMessageInfo((0,i.hj)(e,s.id,a)),t.openPaymentModal({chatId:s.id,messageId:a}));break}}})),(0,a.Q6)("sendBotCommand",((e,t,s)=>{const{command:a,chatId:n}=s,{currentUserId:o}=e,r=n?(0,i.Z1)(e,n):(0,i.jr)(e);o&&r&&j(r,0,a)})),(0,a.Q6)("restartBot",((e,t,s)=>{const{chatId:n}=s,{currentUserId:o}=e,c=(0,i.jr)(e),d=o&&(0,i.IK)(e,n);o&&c&&d&&(async()=>{await(0,v.t9)("unblockContact",d.id,d.accessHash)&&((0,a.R3)((0,r.rB)((0,a.Rd)(),d.id)),j(c,0,"/start"))})()})),(0,a.Q6)("loadTopInlineBots",(e=>{const{serverTimeOffset:t}=e,{hash:s,lastRequestedAt:n}=e.topInlineBots;n&&Date.now()+1e3*t-n<6e4||(async()=>{const e=await(0,v.t9)("fetchTopInlineBots",{hash:s});if(!e)return;const{hash:n,ids:o,users:i}=e;let c=(0,a.Rd)();c=(0,r.Sh)(c,(0,g.ee)(i,"id")),c={...c,topInlineBots:{...c.topInlineBots,hash:n,userIds:o,lastRequestedAt:Date.now()+1e3*t}},(0,a.R3)(c)})()})),(0,a.Q6)("queryInlineBot",((e,t,s)=>{const{chatId:n,username:o,query:c,offset:d}=s;(async()=>{let t=e.inlineBots.byUsername[o];if(!1!==t){if(void 0===t){const{user:s,chat:n}=await(0,v.t9)("fetchInlineBot",{username:o})||{};if(e=(0,a.Rd)(),!s||!n)return void(0,a.R3)(q(e,o,!1));e=(0,r.Sh)(e,{[s.id]:s}),e=(0,r.fZ)(e,{[n.id]:n}),t={id:s.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[]},e=q(e,o,t),(0,a.R3)(e)}(c!==t.query||t.canLoadMore)&&H((()=>{!async function({username:e,inlineBotData:t,chatId:s,query:n,offset:o}){let r=(0,a.Rd)();const c=(0,i.dy)(r,t.id),d=(0,i.Z1)(r,s);if(!c||!d)return;const l=t.query!==n;r=G(r,!0),r=q(r,e,{...t,query:n,...l&&{offset:void 0,results:[]}}),(0,a.R3)(r);const u=await(0,v.t9)("fetchInlineBotResults",{bot:c,chat:d,query:n,offset:l?void 0:o}),h=r.inlineBots.byUsername[e];if(r=G((0,a.Rd)(),!1),!u||!h||n!==h.query)return void(0,a.R3)(r);const m=new Set((h.results||[]).map((e=>e.id))),g=u.results.filter((e=>!m.has(e.id)));r=q(r,e,{...h,help:u.help,...g.length&&{isGallery:u.isGallery},...u.switchPm&&{switchPm:u.switchPm},canLoadMore:u.results.length>0&&Boolean(u.nextOffset),results:""===h.offset||h.offset===u.nextOffset?u.results:(h.results||[]).concat(g),offset:g.length?u.nextOffset:""}),(0,a.R3)(r)}({username:o,inlineBotData:t,chatId:n,query:c,offset:d})}))}})()})),(0,a.Q6)("sendInlineBotResult",((e,t,s)=>{const{id:a,queryId:n}=s,o=(0,i.Bt)(e);if(!o||!a)return;const{chatId:r,threadId:c}=o,d=(0,i.Z1)(e,r);t.setReplyingToId({messageId:void 0}),t.clearWebPagePreview({chatId:r,threadId:c,value:!1}),(0,v.t9)("sendInlineBotResult",{chat:d,resultId:a,queryId:n,replyingTo:(0,i.Yy)(e,r,c)})})),(0,a.Q6)("resetInlineBot",((e,t,s)=>{const{username:n}=s;let o=e.inlineBots.byUsername[n];o&&(o={id:o.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[]},(0,a.R3)(q(e,n,o)))})),s(9667),(0,a.Q6)("loadPasswordInfo",(()=>{(async()=>{const e=await(0,v.t9)("getPasswordInfo");if(!e)return;let t=(0,a.Rd)();t=(0,r.BI)(t,{hasPassword:e.hasPassword}),t=(0,r.IE)(t,{hint:e.hint}),(0,a.R3)(t)})()})),(0,a.Q6)("checkPassword",((e,t,s)=>{const{currentPassword:n,onSuccess:o}=s;(0,a.R3)((0,r.IE)(e,{isLoading:!0,error:void 0})),(async()=>{const e=await(0,v.t9)("checkPassword",n);(0,a.R3)((0,r.IE)((0,a.Rd)(),{isLoading:!1})),e&&o()})()})),(0,a.Q6)("clearPassword",((e,t,s)=>{const{currentPassword:n,onSuccess:o}=s;(0,a.R3)((0,r.IE)(e,{isLoading:!0,error:void 0})),(async()=>{const e=await(0,v.t9)("clearPassword",n);(0,a.R3)((0,r.IE)((0,a.Rd)(),{isLoading:!1})),e&&o()})()})),(0,a.Q6)("updatePassword",((e,t,s)=>{const{currentPassword:n,password:o,hint:i,email:c,onSuccess:d}=s;(0,a.R3)((0,r.IE)(e,{isLoading:!0,error:void 0})),(async()=>{const e=await(0,v.t9)("updatePassword",n,o,i,c);(0,a.R3)((0,r.IE)((0,a.Rd)(),{isLoading:!1})),e&&d()})()})),(0,a.Q6)("updateRecoveryEmail",((e,t,s)=>{const{currentPassword:n,email:o,onSuccess:i}=s;(0,a.R3)((0,r.IE)(e,{isLoading:!0,error:void 0})),(async()=>{const e=await(0,v.t9)("updateRecoveryEmail",n,o);(0,a.R3)((0,r.IE)((0,a.Rd)(),{isLoading:!1,waitingEmailCodeLength:void 0})),e&&i()})()})),(0,a.Q6)("provideTwoFaEmailCode",((e,t,s)=>{const{code:a}=s;(0,v.t9)("provideRecoveryEmailCode",a)})),(0,a.Q6)("clearTwoFaError",(e=>(0,r.IE)(e,{error:void 0}))),(0,a.Q6)("validateRequestedInfo",((e,t,s)=>{const{requestInfo:n,saveInfo:o}=s,c=(0,i.gx)(e),d=c&&(0,i.Z1)(e,c),l=(0,i.Mz)(e);d&&l&&async function(e,t,s,n){const o=await(0,v.t9)("validateRequestedInfo",{chat:e,messageId:t,requestInfo:s,shouldSave:n});if(!o)return;const{id:i,shippingOptions:c}=o;if(!i)return;let d=(0,r.vT)((0,a.Rd)(),i);c?(d=(0,r.TM)(d,c),d=(0,r.Q$)(d,h.KB.Shipping)):d=(0,r.Q$)(d,h.KB.PaymentInfo),(0,a.R3)(d)}(d,l,n,o)})),(0,a.Q6)("getPaymentForm",((e,t,s)=>{const{chat:n,messageId:o}=s;n&&o&&async function(e,t){const s=await(0,v.t9)("getPaymentForm",{chat:e,messageId:t});if(!s)return;let n=(0,r._7)((0,a.Rd)(),s),o=h.KB.PaymentInfo;n.payment.invoice&&(n.payment.invoice.shippingAddressRequested||n.payment.invoice.nameRequested||n.payment.invoice.phoneRequested||n.payment.invoice.emailRequested)&&(o=h.KB.ShippingInfo),n=(0,r.Q$)(n,o),(0,a.R3)(n)}(n,o)})),(0,a.Q6)("getReceipt",((e,t,s)=>{const{receiptMessageId:n,chatId:o,messageId:c}=s,d=o&&(0,i.Z1)(e,o);c&&n&&d&&async function(e,t,s){const n=await(0,v.t9)("getReceipt",e,s);if(!n)return;let o=(0,a.Rd)();const c=(0,i.hj)(o,e.id,t);o=(0,r.Dq)(o,n,c),(0,a.R3)(o)}(d,c,n)})),(0,a.Q6)("clearPaymentError",(e=>{(0,a.R3)({...e,payment:{...e.payment,error:void 0}})})),(0,a.Q6)("clearReceipt",(e=>{(0,a.R3)({...e,payment:{...e.payment,receipt:void 0}})})),(0,a.Q6)("sendCredentialsInfo",((e,t,s)=>{const n=(0,i.$$)(e);if(!n)return;const{credentials:o}=s,{data:c}=o;!async function(e,t){const s=function(e){const t=Object.keys(e).map((t=>`${t}=${e[t]}`)).join("&");return t.length>0?`?${t}`:""}({"card[number]":e.cardNumber,"card[exp_month]":e.expiryMonth,"card[exp_year]":e.expiryYear,"card[cvc]":e.cvv,"card[address_zip]":e.zip,"card[address_country]":e.country}),n=await fetch(`https://api.stripe.com/v1/tokens${s}`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${t}`}}),o=await n.json();if(o.error){const e=(0,d.Ow)(o.error),t=(0,a.Rd)();return void(0,a.R3)({...t,payment:{...t.payment,error:{...e}}})}let i=(0,r.QH)((0,a.Rd)(),{type:o.type,id:o.id});i=(0,r.Q$)(i,h.KB.Checkout),(0,a.R3)(i)}(c,n)})),(0,a.Q6)("sendPaymentForm",((e,t,s)=>{const{shippingOptionId:n,saveCredentials:o}=s,c=(0,i.gx)(e),d=c&&(0,i.Z1)(e,c),l=(0,i.Mz)(e),u=(0,i.eh)(e),h=(0,i.sp)(e),m=(0,i.$$)(e),g=(0,i.i3)(e);d&&l&&m&&u&&async function(e,t,s,n,o,i){if(await(0,v.t9)("sendPaymentForm",{chat:e,messageId:t,formId:s,credentials:n,requestedInfoId:o,shippingOptionId:i})){const e=(0,r.bp)((0,a.Rd)());(0,a.R3)((0,r.WY)(e))}}(d,l,u,{save:o,data:g},h,n)})),(0,a.Q6)("setPaymentStep",((e,t,s={})=>(0,r.Q$)(e,s.step||h.KB.ShippingInfo))),(0,a.Q6)("setInvoiceMessageInfo",((e,t,s)=>(0,r.nA)(e,s))),s(4907);var _=s(8406),V=s(7358);const X=(0,y.P2)((e=>e()),500,!0);(0,a.Q6)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateChat":{s.noTopChatsRequest||(0,i.N)(e,s.id)||t.loadTopChats();const n=(0,r.a4)(e,s.id,s.chat,s.newProfilePhoto);(0,a.R3)(n),X((()=>(0,V.w)((0,i.A1)((0,a.Rd)()))));break}case"updateChatJoin":{const n=(0,i.Ek)(e,s.id);if(!n)break;e=(0,r.B1)(e,n,[s.id]),e=(0,r.a4)(e,s.id,{isNotJoined:!1}),(0,a.R3)(e);const o=(0,i.Z1)(e,s.id);o&&t.requestChatUpdate({chatId:o.id});break}case"updateChatLeave":{const t=(0,i.Ek)(e,s.id);if(!t)break;const{[t]:n}=e.chats.listIds;n&&(e=(0,r.Mg)(e,t,n.filter((e=>e!==s.id)))),e=(0,r.a4)(e,s.id,{isNotJoined:!0}),(0,a.R3)(e);break}case"updateChatInbox":(0,a.R3)((0,r.a4)(e,s.id,s.chat)),X((()=>(0,V.w)((0,i.A1)((0,a.Rd)()))));break;case"updateChatTypingStatus":{const{id:t,typingStatus:n}=s;(0,a.R3)((0,r.a4)(e,t,{typingStatus:n})),setTimeout((()=>{const e=(0,a.Rd)(),s=(0,i.Z1)(e,t);s&&n&&s.typingStatus&&s.typingStatus.timestamp===n.timestamp&&(0,a.R3)((0,r.a4)(e,t,{typingStatus:void 0}))}),6e3);break}case"newMessage":{const{message:n}=s,{chatId:o,threadId:c,type:d}=(0,i.Bt)(e)||{};if(n.senderId===e.currentUserId&&!n.isFromScheduled)return;const l=(0,i.Z1)(e,s.chatId);if(!l)return;const h="thread"===d&&c===u._f&&s.chatId===o;h?setTimeout((()=>{t.requestChatUpdate({chatId:s.chatId})}),1500):(0,a.R3)((0,r.a4)(e,s.chatId,{unreadCount:l.unreadCount?l.unreadCount+1:1,...s.message.hasUnreadMention&&{unreadMentionsCount:l.unreadMentionsCount?l.unreadMentionsCount+1:1}})),(0,V.w)((0,i.A1)((0,a.Rd)()));const{hasWebNotifications:m}=(0,i.dZ)(e);m&&(0,_.VL)({chat:l,message:n,isActiveChat:h});break}case"updateCommonBoxMessages":case"updateChannelMessages":{const{ids:t,messageUpdate:n}=s;if(!1!==n.hasUnreadMention)return;t.forEach((t=>{const a="channelId"in s?s.channelId:(0,i.X5)(e,t),n=(0,i.Z1)(e,a);n&&n.unreadMentionsCount&&(e=(0,r.a4)(e,a,{unreadMentionsCount:n.unreadMentionsCount-1}))})),(0,a.R3)(e);break}case"updateChatFullInfo":{const{fullInfo:t}=s,n=e.chats.byId[s.id];if(!n)return;(0,a.R3)((0,r.a4)(e,s.id,{fullInfo:{...n.fullInfo,...t}}));break}case"updatePinnedChatIds":{const{ids:t,folderId:o}=s,r=o===n.WS?"archived":"active";e={...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[r]:t.length?t:void 0}}},(0,a.R3)(e);break}case"updateChatPinned":{const{id:t,isPinned:o}=s,r=(0,i.Ek)(e,t);if(r){const{[r]:s}=e.chats.orderedPinnedIds;let a=s||[];if(o){if(!a.includes(t)){if("active"===r&&a.length>=n.EG){const t=e.chats.listIds.active;a=a.filter((e=>t&&t.includes(e)))}a=[t,...a]}}else a=a.filter((e=>e!==t));e={...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[r]:a.length?a:void 0}}}}(0,a.R3)(e);break}case"updateChatListType":{const{id:t,folderId:n}=s;(0,a.R3)((0,r.Pi)(e,t,n));break}case"updateChatFolder":{const{id:t,folder:n}=s,{byId:o,orderedIds:r}=e.chatFolders,i=n?{...o,[t]:n}:(0,g.ei)(o,Object.keys(o).map(Number).filter((e=>e!==t))),c=n?r&&r.includes(t)?r:[...r||[],t]:r?r.filter((e=>e!==t)):void 0;(0,a.R3)({...e,chatFolders:{...e.chatFolders,byId:i,orderedIds:c}});break}case"updateChatFoldersOrder":{const{orderedIds:t}=s;(0,a.R3)({...e,chatFolders:{...e.chatFolders,orderedIds:t}});break}case"updateRecommendedChatFolders":{const{folders:t}=s;(0,a.R3)({...e,chatFolders:{...e.chatFolders,recommended:t}});break}case"updateChatMembers":{const t=e.chats.byId[s.id],{replacedMembers:n,addedMember:o,deletedMemberId:i}=s;if(!t)return;let c=!1,d=t.fullInfo&&t.fullInfo.members?[...t.fullInfo.members]:[];if(n)d=n,c=!0;else if(o)d.length&&d.some((e=>e.userId===o.userId))||(d.push(o),c=!0);else if(d.length&&i){const e=d.findIndex((e=>e.userId===i));e>-1&&(d.slice(e,1),c=!0)}if(c){const n=d.filter((({isOwner:e,isAdmin:t})=>e||t));(0,a.R3)((0,r.a4)(e,s.id,{membersCount:d.length,fullInfo:{...t.fullInfo,members:d,adminMembers:n}}))}break}case"deleteProfilePhotos":{const{chatId:t,ids:n}=s,o=e.chats.byId[t];o&&o.photos&&(0,a.R3)((0,r.a4)(e,t,{photos:o.photos.filter((e=>!n.includes(e.id)))}));break}case"draftMessage":{const{chatId:t,formattedText:n,date:o,replyingToId:i}=s;e.chats.byId[t]&&(e=(0,r.pf)(e,t,u._f,"draft",n),e=(0,r.pf)(e,t,u._f,"replyingToId",i),e=(0,r.a4)(e,t,{draftDate:o}),(0,a.R3)(e));break}case"showInvite":{const{data:e}=s;t.showDialog({data:e});break}}}));const K=350;function W(e,t,s,a,n=!1){const o=n?(0,i.Tm)(e,t,s):(0,i.hj)(e,t,s);if(o&&a.content){const{photo:e,video:t,sticker:s,document:n}=(0,d.qp)(o);e&&a.content.photo?(a.content.photo.blobUrl=e.blobUrl,a.content.photo.thumbnail=e.thumbnail):t&&a.content.video?a.content.video.blobUrl=t.blobUrl:s&&a.content.sticker?a.content.sticker.isPreloadedGlobally=s.isPreloadedGlobally:n&&a.content.document&&(a.content.document.previewBlobUrl=n.previewBlobUrl)}return n?(0,r.P4)(e,t,s,a):(0,r.cY)(e,t,s,a)}function z(e,t){const{id:s,chatId:a}=t,{threadInfo:n,firstMessageId:o}=(0,i.Db)(e,a,t)||{},c=(0,i.Z1)(e,a),l=c&&c.unreadCount&&!(0,i.gb)(e,a,u._f);if(n&&(!o&&(0,d.CI)(t)||(e=(0,r.xj)(e,a,n.threadId,[s]),(0,i.b9)(e,a,n.threadId)&&(e=(0,r.$S)(e,a,n.threadId,s),o||(e=(0,r.pf)(e,a,n.threadId,"firstMessageId",t.id)))),e=(0,r.pf)(e,a,n.threadId,"threadInfo",{...n,lastMessageId:t.id,messagesCount:n.messagesCount+1})),l)return e;if(e=(0,r.xj)(e,a,u._f,[s]),(0,i.b9)(e,a,u._f)){const t=(0,i.It)(e,a,u._f),n=(0,r.$S)(e,a,u._f,s),o=(0,i.Cb)(n,a,u._f);t&&!o.includes(t)||(e=n)}return e}function Y(e,t,s,a=!1){const{chats:n}=e,o=n.byId[t]&&n.byId[t].lastMessage;return!o||a||o.id===s.id||o.id===s.previousLocalId||s.id>o.id?(0,r.a4)(e,t,{lastMessage:s}):e}function J(e,t){const s=(0,i.Zw)(e,t),a=(0,i.gb)(e,t,u._f);if(!s||!a)return;let n=a.length;for(;n--;){const e=s[a[n]];if(!e.isDeleting)return e}}function ee(e,t,s,n){if(e){t.forEach((t=>{const s=J(n=(0,r.cY)(n,e,t,{isDeleting:!0}),e);s&&(n=Y(n,e,s,!0))})),(0,a.R3)(n),s.requestChatUpdate({chatId:e});const o=[];return t.forEach((t=>{const s=(0,i.hj)(n,e,t);if(!s)return;const{threadInfo:a}=(0,i.Db)(n,e,s)||{};a&&o.push(a.threadId)})),void setTimeout((()=>{(0,a.R3)((0,r.K4)((0,a.Rd)(),e,t)),(0,g.Tw)(o).forEach((t=>{s.requestThreadInfoUpdate({chatId:e,threadId:t})}))}),K)}const o=[];t.forEach((e=>{const t=(0,i.X5)(n,e);if(t){o.push(t);const s=J(n=(0,r.cY)(n,t,e,{isDeleting:!0}),t);s&&(n=Y(n,t,s,!0)),setTimeout((()=>{(0,a.R3)((0,r.K4)((0,a.Rd)(),t,[e]))}),K)}})),(0,a.R3)(n),(0,g.Tw)(o).forEach((e=>{s.requestChatUpdate({chatId:e})}))}(0,a.Q6)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"newMessage":{const{chatId:n,id:o,message:c}=s;e=z(e=W(e,n,o,c),c),c.threadInfo&&(e=(0,r.Xg)(e,c.threadInfo.chatId,c.threadInfo.threadId,c.threadInfo)),(0,a.R3)(e);const l=(0,i.hj)(e,n,o);if((0,i.hg)(e,n,c)){if(c.isOutgoing&&(!c.content||!c.content.action)){const s=(0,i.Bt)(e);s&&t.focusMessage({chatId:n,threadId:s.threadId,messageId:c.id,noHighlight:!0,isResizingContainer:!0})}const{threadInfo:s}=(0,i.Db)(e,n,c)||{};s&&t.requestThreadInfoUpdate({chatId:n,threadId:s.threadId}),(0,d.CI)(c)||setTimeout((()=>{(0,a.R3)(Y((0,a.Rd)(),n,l))}),K)}else(0,a.R3)(Y((0,a.Rd)(),n,l));(0,i.N)(e,n)||t.loadTopChats();break}case"newScheduledMessage":{const{chatId:t,id:n,message:o}=s;e=W(e,t,n,o,!0);const c=(0,i.qy)(e,t)||[];e=(0,r.pf)(e,t,u._f,"scheduledIds",(0,g.Tw)([...c,n])),(0,a.R3)(e);break}case"updateMessage":{const{chatId:t,id:n,message:o}=s;if(!(0,i.hj)(e,t,n))return;e=W(e,t,n,o);const c=(0,i.hj)(e,t,n);o.threadInfo&&(e=(0,r.Xg)(e,o.threadInfo.chatId,o.threadInfo.threadId,o.threadInfo)),e=Y(e,t,c),(0,a.R3)(e);break}case"updateScheduledMessage":{const{chatId:t,id:n,message:o}=s;if(!(0,i.Tm)(e,t,n))return;e=W(e,t,n,o,!0);const c=Object.keys((0,i.Fn)(e,t)||{}).map(Number).sort(((e,t)=>t-e));e=(0,r.pf)(e,t,u._f,"scheduledIds",c),(0,a.R3)(e);break}case"updateMessageSendSucceeded":{const{chatId:n,localId:o,message:c}=s;e=z(e,c);const d=(0,i.hj)(e,n,o);e=(0,r.K4)(e,n,[o]),c.isScheduled&&(e=(0,r.bV)(e,n,[o])),e=(0,r.cY)(e,n,c.id,{...d,...c,previousLocalId:o});const l=(0,i.hj)(e,n,c.id);e=Y(e,n,l);const u=(0,i.Db)(e,n,c);u&&u.threadInfo&&(t.markMessageListRead({maxId:c.id}),e=(0,r.pf)(e,n,u.threadInfo.threadId,"threadInfo",{...u.threadInfo,lastMessageId:c.id,lastReadInboxMessageId:c.id})),(0,a.R3)(e);break}case"updateScheduledMessageSendSucceeded":{const{chatId:t,localId:n,message:o}=s,c=(0,i.qy)(e,t)||[];e=(0,r.pf)(e,t,u._f,"scheduledIds",[...c,o.id]);const d=(0,i.Tm)(e,t,n);e=(0,r.bV)(e,t,[n]),e=(0,r.P4)(e,t,o.id,{...d,...o,previousLocalId:n}),(0,a.R3)(e);break}case"updatePinnedIds":{const{chatId:t,isPinned:n,messageIds:o}=s,c=(0,i.KB)(e,t)||[],d=n?[...c,...o].sort(((e,t)=>t-e)):c.filter((e=>!o.includes(e)));(0,a.R3)((0,r.pf)(e,t,u._f,"pinnedIds",d));break}case"updateThreadInfo":{const{chatId:t,threadId:n,threadInfo:o,firstMessageId:c}=s,d={...(0,i.tZ)(e,t,n),...o};if(!d.threadId)return;e=(0,r.Xg)(e,t,n,d),c&&(e=(0,r.pf)(e,t,n,"firstMessageId",c)),(0,a.R3)(e);break}case"resetMessages":{const{id:n}=s,o=(0,i.Zw)(e,n);o&&!(0,d.YA)(n)&&(e=(0,r.K4)(e,n,Object.keys(o).map(Number)),(0,a.R3)(e),t.loadFullChat({chatId:n,force:!0}));break}case"deleteMessages":{const{ids:a,chatId:n}=s;ee(n,a,t,e);break}case"deleteScheduledMessages":{const{ids:t,chatId:n}=s;!function(e,t,s,n){e&&(t.forEach((t=>{n=(0,r.P4)(n,e,t,{isDeleting:!0})})),(0,a.R3)(n),setTimeout((()=>{n=(0,r.bV)((0,a.Rd)(),e,t);const s=(0,i.Fn)(n,e);n=(0,r.pf)(n,e,u._f,"scheduledIds",Object.keys(s||{}).map(Number)),(0,a.R3)(n)}),K))}(n,t,0,e);break}case"deleteHistory":{const{chatId:a}=s,n=e.messages.byChatId[a];n?ee(a,Object.keys(n.byId).map(Number),t,e):t.requestChatUpdate({chatId:a});break}case"updateCommonBoxMessages":{const{ids:t,messageUpdate:n}=s;t.forEach((t=>{const s=(0,i.X5)(e,t);s&&(e=(0,r.cY)(e,s,t,n))})),(0,a.R3)(e);break}case"updateChannelMessages":{const{channelId:t,ids:n,messageUpdate:o}=s;n.forEach((s=>{e=(0,r.cY)(e,t,s,o)})),(0,a.R3)(e);break}case"updateMessagePoll":{const{pollId:t,pollUpdate:n}=s,o=(0,i.ZB)(e,t);if(o&&o.content.poll){const t={...o.content.poll,...n},{results:s}=t.results||{};if(s&&!s.some((e=>e.isChosen))){const{results:e}=o.content.poll.results,a=e&&e.filter((e=>e.isChosen));a&&a.forEach((e=>{const a=s.findIndex((t=>t.option===e.option));a>=0&&(t.results.results[a].isChosen=!0)}))}(0,a.R3)((0,r.cY)(e,o.chatId,o.id,{content:{...o.content,poll:t}}))}break}case"updateMessagePollVote":{const{pollId:t,userId:n,options:o}=s,c=(0,i.ZB)(e,t);if(!c||!c.content.poll||!c.content.poll.results)break;const{poll:d}=c.content,{recentVoterIds:l,totalVoters:u,results:h}=d.results,m=l?[...l]:[],g=u?u+1:1,p=h?[...h]:[];m.push(n),o.forEach((t=>{const s=p.find((e=>e.option===t)),a=p.findIndex((e=>e.option===t)),o=s?{...s}:{option:t,votersCount:0};o.votersCount+=1,n===e.currentUserId&&(o.isChosen=!0),a?p[a]=o:p.push(o)})),(0,a.R3)((0,r.cY)(e,c.chatId,c.id,{content:{...c.content,poll:{...d,results:{...d.results,recentVoterIds:m,totalVoters:g,results:p}}}}));break}}}));const te=(0,y.P2)((function(){let e=(0,a.Rd)();se.forEach((([t,s])=>{e=(0,r.Nq)(e,t,{status:s})})),(0,a.R3)(e),se=[]}),3e3,!0);let se=[];(0,a.Q6)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"deleteUser":return(0,r.h8)(e,s.id);case"updateUser":return(0,r.Nq)(e,s.id,s.user);case"updateUserStatus":return a=s.userId,n=s.status,se.push([a,n]),void te();case"updateUserFullInfo":{const{id:t,fullInfo:a}=s,n=e.users.byId[t];if(!n)return;return(0,r.Nq)(e,t,{fullInfo:{...n.fullInfo,...a}})}}var a,n})),(0,a.Q6)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateStickerSet":return(0,r.Rg)(e,s.id,s.stickerSet)}})),(0,a.Q6)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updatePeerBlocked":return s.isBlocked?(0,r.O4)((0,a.Rd)(),s.id):(0,r.rB)((0,a.Rd)(),s.id);case"updateResetContactList":(0,a.R3)({...(0,a.Rd)(),contactList:{hash:0,userIds:[]}});break;case"updateFavoriteStickers":t.loadFavoriteStickers();break;case"updatePrivacy":e.settings.privacy[s.key]=s.rules}})),(0,a.Q6)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateNotifySettings":return(0,r.HN)(e,s.peerType,s.isSilent,s.shouldShowPreviews);case"updateNotifyExceptions":{const{chatId:t,isMuted:n,isSilent:o,shouldShowPreviews:i}=s;e.chats.byId[t]&&(e=(0,r.a4)(e,t,{isMuted:n})),(0,a.R3)((0,r.aK)(e,t,{isMuted:n,isSilent:o,shouldShowPreviews:i}));break}}})),(0,a.Q6)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateTwoFaStateWaitCode":return{...e,twoFaSettings:{...e.twoFaSettings,isLoading:!1,waitingEmailCodeLength:s.length}};case"updateTwoFaError":return{...e,twoFaSettings:{...e.twoFaSettings,error:s.message}}}}));var ae=s(8674),ne=s(6752),oe=s(1279),re=s(1212),ie=s(5332);function ce(e){(0,o.d4)((()=>(0,y.Gq)(e)),[e])}var de=s(9290);function le(e){e.preventDefault()}var ue=s(6590),he=s(3989),me=s(3455),ge=s(2255),pe=s(706),fe=s(9107),Ie=s(6917),ve=s(3106),ye=s(8964),Ze=s(231),Pe=s(9589),Ce=s(9187);const we=(0,o.X$)((({id:e,name:t,value:s,label:a,checked:n=!1,disabled:r,inactive:i,noAnimation:c,onChange:d,onCheck:l})=>{const u=(0,o.I4)((e=>{d&&d(e),l&&l(e.currentTarget.checked)}),[d,l]),h=(0,ne.Z)("Switcher",r&&"disabled",i&&"inactive",c&&"no-animation");return o.ZP.createElement("label",{className:h,title:a},o.ZP.createElement("input",{type:"checkbox",id:e,name:t,value:s,checked:n,disabled:r,onChange:u}),o.ZP.createElement("span",{className:"widget"}))})),be=[0,1,2],Me=(0,o.X$)((0,a.c$)((e=>{const{query:t,fetchingStatus:s,chatId:a,date:n}=e.globalSearch,{currentUserId:o}=e,{byId:r}=e.chats,{animationLevel:c}=e.settings.byKey;return{searchQuery:t,isLoading:!!s&&Boolean(s.chats||s.messages),currentUserId:o,chatsById:r,globalSearchChatId:a,searchDate:n,theme:(0,i.Pu)(e),animationLevel:c}}),((e,t)=>(0,g.ei)(t,["openChat","openTipsChat","setGlobalSearchDate","setGlobalSearchChatId","setSettingOption"])))((({content:e,contactsFilter:t,onSearchQuery:s,onSelectSettings:a,onSelectContacts:r,onSelectArchived:i,setGlobalSearchChatId:c,onReset:l,searchQuery:u,isLoading:g,shouldSkipTransition:p,currentUserId:f,globalSearchChatId:I,searchDate:v,theme:y,animationLevel:Z,chatsById:P,openChat:C,openTipsChat:w,setGlobalSearchDate:b,setSettingOption:M})=>{const S=(0,fe.Z)(),E=e===h.du.ChatList,k=(0,o.Ye)((()=>v?(0,A.xH)(new Date(1e3*v)):void 0),[v]),R=(0,o.Ye)((()=>E&&P?Object.values(P).reduce(((e,t)=>(0,d.pE)(t)&&t.unreadCount?e+1:e),0):0),[E,P]),T="web.telegram.org"===window.location.hostname,N=(0,o.Ye)((()=>({onTrigger:e,isOpen:t})=>o.ZP.createElement(Ze.Z,{round:!0,ripple:E&&!m.wB,size:"smaller",color:"translucent",className:t?"active":"",onClick:E?e:()=>l(),ariaLabel:E?S("AccDescrOpenMenu2"):"Return to chat list"},o.ZP.createElement("div",{className:(0,ne.Z)("animated-menu-icon",!E&&"state-back",p&&"no-animation")}))),[E,S,l,p]),B=(0,o.I4)((()=>{u||s("")}),[u,s]),x=(0,o.I4)((()=>{C({id:f,shouldReplaceHistory:!0})}),[f,C]),L=(0,o.I4)((e=>{e.stopPropagation();const t="light"===y?"dark":"light";M({theme:t}),M({shouldUseSystemTheme:!1}),(0,Ie.Z)(t,Z===n.zy)}),[Z,M,y]),O=(0,o.I4)((e=>{e.stopPropagation();const t=0===Z?2:0;be.forEach(((e,s)=>{document.body.classList.toggle(`animation-level-${s}`,t===s)})),M({animationLevel:t})}),[Z,M]),U=Boolean(I)||e===h.du.GlobalSearch||e===h.du.Contacts,F=e===h.du.Contacts?S("SearchFriends"):S("Search");return o.ZP.createElement("div",{className:"LeftMainHeader"},o.ZP.createElement("div",{id:"LeftMainHeader",className:"left-header"},o.ZP.createElement(ve.Z,{trigger:N,footer:`${n.iC} alpha ${n.Ji}`},o.ZP.createElement(ye.Z,{icon:"saved-messages",onClick:x},S("SavedMessages")),o.ZP.createElement(ye.Z,{icon:"archive",onClick:i},o.ZP.createElement("span",{className:"menu-item-name"},S("ArchivedChats")),R>0&&o.ZP.createElement("div",{className:"archived-badge"},R)),o.ZP.createElement(ye.Z,{icon:"user",onClick:r},S("Contacts")),o.ZP.createElement(ye.Z,{icon:"settings",onClick:a},S("Settings")),o.ZP.createElement(ye.Z,{icon:"darkmode",onClick:L},o.ZP.createElement("span",{className:"menu-item-name"},S("lng_menu_night_mode")),o.ZP.createElement(we,{id:"darkmode",label:S("dark"===y?"lng_settings_disable_night_theme":"lng_settings_enable_night_theme"),checked:"dark"===y,noAnimation:!0})),o.ZP.createElement(ye.Z,{icon:"animations",onClick:O},o.ZP.createElement("span",{className:"menu-item-name capitalize"},S("Appearance.Animations").toLowerCase()),o.ZP.createElement(we,{id:"animations",label:"Toggle Animations",checked:Z>0})),o.ZP.createElement(ye.Z,{icon:"help",onClick:()=>{w({langCode:S.code})}},S("TelegramFeatures")),o.ZP.createElement(ye.Z,{icon:"bug",href:n.mU},"Report Bug"),T&&o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement(ye.Z,{icon:"char-K",href:"https://web.telegram.org/k/",onClick:()=>{localStorage.setItem("kz_version",JSON.stringify("K")),(0,ue.Wv)()}},"Switch to K Version"),o.ZP.createElement(ye.Z,{icon:"char-W",href:"https://web.telegram.org/?legacy=1",onClick:ue.Wv},"Switch to Old Version"))),o.ZP.createElement(Pe.Z,{inputId:"telegram-search-input",parentContainerClassName:"LeftSearch",className:I||v?"with-picker-item":"",value:t||u,focused:U,isLoading:g,placeholder:F,autoComplete:"off",canClose:Boolean(I||v),onChange:s,onReset:l,onFocus:B},k&&o.ZP.createElement(Ce.Z,{icon:"calendar",title:k,canClose:!0,isMinimized:Boolean(I),className:"search-date",onClick:b,clickArg:{date:void 0}}),I&&o.ZP.createElement(Ce.Z,{chatOrUserId:I,onClick:c,canClose:!0,clickArg:{id:void 0}}))))})));var Se=s(9204);const Ee=(0,o.X$)((()=>{const e=(0,fe.Z)();return o.ZP.createElement("div",{id:"ConnectionState",dir:e.isRtl?"rtl":void 0},o.ZP.createElement(Se.Z,{color:"black"}),o.ZP.createElement("div",{className:"state-text"},e("WaitingForNetwork")))}));var ke=s(1174);var Re=s(3133),Te=s(9359);const Ne=(0,o.X$)((0,a.c$)((e=>{const{chats:{byId:t},users:{byId:s},chatFolders:{byId:a,orderedIds:n,activeChatFolder:o},currentUserId:r,lastSyncTime:c}=e;return{chatsById:t,usersById:s,chatFoldersById:a,orderedFolderIds:n,lastSyncTime:c,notifySettings:(0,i.dZ)(e),notifyExceptions:(0,i.NJ)(e),activeChatFolder:o,currentUserId:r}}),((e,t)=>(0,g.ei)(t,["loadChatFolders","setActiveChatFolder","openChat"])))((({chatsById:e,usersById:t,chatFoldersById:s,notifySettings:a,notifyExceptions:n,orderedFolderIds:r,activeChatFolder:i,currentUserId:c,lastSyncTime:l,foldersDispatch:u,onScreenSelect:h,loadChatFolders:p,setActiveChatFolder:f,openChat:I})=>{const v=(0,o.sO)(null),Z=(0,fe.Z)();(0,o.d4)((()=>{l&&p()}),[l,p]);const P=(0,o.Ye)((()=>r?r.map((e=>s[e]||{})).filter(Boolean):void 0),[s,r]),C=((e,t,s)=>{const a=((e,t=!1)=>(0,o.Ye)((()=>(0,y.P2)((e=>e()),e,!t)),[e,t]))(t,!0),[n,r]=(0,o.eJ)(),[i,c,d]=(0,pe.Z)();return(0,ae.ZP)(c,d),(0,de.Z)((()=>{i||a((()=>{r(e())}))}),s.concat([i])),n})((()=>{if(!P||!P.length)return;const s=Object.keys(e).map(Number),o=P.map((o=>{const{unreadDialogsCount:r,hasActiveDialogs:i}=(0,d.Fu)(e,t,o,s,a,n)||{};return{id:o.id,badgeCount:r,isBadgeActive:i}}));return(0,g.ee)(o,"id")}),3e3,[P,e,t,a,n]),w=(0,o.Ye)((()=>{if(P&&P.length)return[{title:"en"===Z.code?"All":Z("FilterAllChats")},...P.map((e=>({title:e.title,...C&&C[e.id]})))]}),[P,C,Z]),b=(0,o.I4)((e=>{f(e)}),[f]);(0,o.d4)((()=>{w&&w.length&&i>=w.length&&f(0)}),[i,w,f]),(0,o.d4)((()=>{if(v.current&&m.$b&&w&&w.length)return(0,ke.s)(v.current,{onSwipe:(e,t)=>{t===ke.e.Left?f(Math.min(i+1,w.length-1)):t===ke.e.Right&&f(Math.max(0,i-1))}})}),[i,w,f]);const M=(0,o.sO)();M.current=0!==i,(0,o.d4)((()=>M.current?(0,he.Z)((()=>{M.current&&f(0)})):void 0),[i,f]),(0,ue.ZP)(0!==i,(()=>f(0))),(0,o.d4)((()=>{const e=e=>{if(e.ctrlKey&&e.shiftKey&&e.code.startsWith("Digit")&&w){const[,t]=e.code.match(/Digit(\d)/)||[];if(!t)return;if("0"===t)return void I({id:c,shouldReplaceHistory:!0});const s=Number(t)-1;if(s>w.length-1)return;f(s),e.preventDefault()}};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}}));const{shouldRender:S,transitionClassNames:E}=(0,re.Z)(!r,void 0,!0);function k(e){const t=Object.values(s).find((({title:e})=>e===w[i].title));return t&&0!==i?o.ZP.createElement(Te.Z,{folderType:"folder",folderId:t.id,isActive:e,onScreenSelect:h,foldersDispatch:u}):o.ZP.createElement(Te.Z,{folderType:"all",isActive:e,foldersDispatch:u,onScreenSelect:h})}return o.ZP.createElement("div",{className:"ChatFolders"},w&&w.length?o.ZP.createElement(Re.Z,{tabs:w,activeTab:i,onSwitchTab:b}):S?o.ZP.createElement("div",{className:(0,ne.Z)("tabs-placeholder",E)}):void 0,o.ZP.createElement(ge.Z,{ref:v,name:Z.isRtl?"slide-reversed":"slide",activeKey:i,renderCount:w?w.length:void 0},k))})));var Be=s(9203),xe=s(8778),Ae=s(4288);const Le=(0,o.X$)((e=>{const t=(0,xe.Z)(Be.gl.Extra,"LeftSearch");return t?o.ZP.createElement(t,e):o.ZP.createElement(Ae.Z,null)})),Oe=(0,o.X$)((e=>{const t=(0,xe.Z)(Be.gl.Extra,"ContactList");return t?o.ZP.createElement(t,e):o.ZP.createElement(Ae.Z,null)}));var Ue=s(2328);let Fe;const $e=(0,o.X$)((({isShown:e,onNewPrivateChat:t,onNewChannel:s,onNewGroup:a})=>{const[n,r]=(0,o.eJ)(!1);(0,o.d4)((()=>{e||r(!1)}),[e]);const i=(0,fe.Z)(),c=(0,ne.Z)("NewChatButton",e&&"revealed",n&&"menu-is-open"),d=(0,o.I4)((()=>{Fe&&(clearTimeout(Fe),Fe=void 0)}),[]),l=(0,o.I4)((()=>{Fe&&(clearTimeout(Fe),Fe=void 0),Fe=window.setTimeout((()=>{r(!1)}),750)}),[]);return o.ZP.createElement("div",{className:c,onMouseEnter:d,onMouseLeave:l},o.ZP.createElement(Ze.Z,{round:!0,color:"primary",className:n?"active":"",onClick:()=>{r(!n)},ariaLabel:i(n?"Close":"NewMessageTitle"),tabIndex:-1},o.ZP.createElement("i",{className:"icon-new-chat-filled"}),o.ZP.createElement("i",{className:"icon-close"})),o.ZP.createElement(Ue.Z,{isOpen:n,positionX:"right",positionY:"bottom",autoClose:!0,onClose:()=>{r(!1)}},o.ZP.createElement(ye.Z,{icon:"channel",onClick:s},i("NewChannel")),o.ZP.createElement(ye.Z,{icon:"group",onClick:a},i("NewGroup")),o.ZP.createElement(ye.Z,{icon:"user",onClick:t},i("NewMessageTitle"))))}));var Qe=s(126);const De=Object.keys(h.du).length/2;let qe;const Ge=(0,a.c$)((e=>(0,g.ei)(e,["connectionState"])))((({content:e,searchQuery:t,searchDate:s,contactsFilter:a,shouldSkipTransition:n,foldersDispatch:r,onSearchQuery:i,onContentChange:c,onScreenSelect:d,onReset:l,connectionState:u})=>{const[g,p]=(0,o.eJ)(m.$b),f=!function(){const[e,t]=(0,o.eJ)(window.navigator.onLine);return(0,o.d4)((()=>{function e(){t(window.navigator.onLine)}return window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("offline",e),window.removeEventListener("online",e)}}),[]),e}()||"connectionStateConnecting"===u,I=(0,o.sO)(!1),v=(0,o.I4)((()=>{c(h.du.Settings)}),[c]),y=(0,o.I4)((()=>{c(h.du.Contacts)}),[c]),Z=(0,o.I4)((()=>{c(h.du.NewChannelStep1)}),[c]),P=(0,o.I4)((()=>{c(h.du.NewGroupStep1)}),[c]),C=(0,o.I4)((()=>{c(h.du.Archived)}),[c]),w=(0,o.I4)((()=>{e===h.du.ChatList&&(I.current=!0,p(!0))}),[e]),b=(0,o.I4)((()=>{I.current=!1,qe&&(clearTimeout(qe),qe=void 0),qe=window.setTimeout((()=>{I.current||p(!1)}),250)}),[]);(0,o.d4)((()=>{let t;return e!==h.du.ChatList?t=window.setTimeout((()=>{p(!1)}),250):(I.current||m.$b)&&p(!0),()=>{t&&(clearTimeout(t),t=void 0)}}),[e]);const[M,S,E]=function(){const[e,t]=(0,pe.Z)(!1);(0,o.d4)((()=>{const e=window.setTimeout(t,2592e5);return()=>{clearTimeout(e)}}),[t]);const{shouldRender:s,transitionClassNames:a}=(0,re.Z)(e);return[s,a,()=>{window.location.reload()}]}(),k=(0,fe.Z)();return o.ZP.createElement("div",{id:"LeftColumn-main",onMouseEnter:m.$b?void 0:w,onMouseLeave:m.$b?void 0:b},o.ZP.createElement(Me,{content:e,contactsFilter:a,onSearchQuery:i,onSelectSettings:v,onSelectContacts:y,onSelectArchived:C,onReset:l,shouldSkipTransition:n}),o.ZP.createElement(Qe.Z,{isOpen:f,isCustom:!0,className:"connection-state-wrapper opacity-transition slow"},(()=>o.ZP.createElement(Ee,null))),o.ZP.createElement(ge.Z,{name:n?"none":"zoom-fade",renderCount:De,activeKey:e,shouldCleanup:!0,cleanupExceptionKey:h.du.ChatList,className:f?"pull-down":void 0},(n=>{switch(e){case h.du.ChatList:return o.ZP.createElement(Ne,{onScreenSelect:d,foldersDispatch:r});case h.du.GlobalSearch:return o.ZP.createElement(Le,{searchQuery:t,searchDate:s,isActive:n,onReset:l});case h.du.Contacts:return o.ZP.createElement(Oe,{filter:a,isActive:n,onReset:l});default:return}})),M&&o.ZP.createElement(Ze.Z,{fluid:!0,pill:!0,className:(0,ne.Z)("btn-update",S),onClick:E},k("lng_update_telegram")),o.ZP.createElement($e,{isShown:g,onNewPrivateChat:y,onNewChannel:Z,onNewGroup:P}))})),He=(0,o.X$)((e=>{const t=(0,xe.Z)(Be.gl.Extra,"Settings");return t?o.ZP.createElement(t,e):o.ZP.createElement(Ae.Z,null)})),je=(0,o.X$)((e=>{const t=(0,xe.Z)(Be.gl.Extra,"NewChat");return t?o.ZP.createElement(t,e):o.ZP.createElement(Ae.Z,null)})),_e=(0,o.X$)((e=>{const t=(0,xe.Z)(Be.gl.Extra,"ArchivedChats");return t?o.ZP.createElement(t,e):o.ZP.createElement(Ae.Z,null)}));var Ve;!function(e){e[e.Main=0]="Main",e[e.Settings=1]="Settings",e[e.Archived=2]="Archived",e[e.NewGroup=3]="NewGroup",e[e.NewChannel=4]="NewChannel"}(Ve||(Ve={}));const Xe=Object.keys(Ve).length/2,Ke=(0,o.X$)((0,a.c$)((e=>{const{globalSearch:{query:t,date:s},chatFolders:{activeChatFolder:a},shouldSkipHistoryAnimations:n}=e;return{searchQuery:t,searchDate:s,activeChatFolder:a,shouldSkipHistoryAnimations:n}}),((e,t)=>(0,g.ei)(t,["setGlobalSearchQuery","setGlobalSearchChatId","resetChatCreation","setGlobalSearchDate","loadPasswordInfo","clearTwoFaError"])))((({searchQuery:e,searchDate:t,activeChatFolder:s,shouldSkipHistoryAnimations:a,setGlobalSearchQuery:n,setGlobalSearchChatId:r,resetChatCreation:i,setGlobalSearchDate:c,loadPasswordInfo:d,clearTwoFaError:l})=>{const[u,g]=(0,o.eJ)(h.du.ChatList),[p,f]=(0,o.eJ)(h.MT.Main),[I,v]=(0,o.eJ)(""),[y,Z]=(0,me.ZP)(),[P,C]=(0,o.eJ)(0);let w=Ve.Main;switch(u){case h.du.Archived:w=Ve.Archived;break;case h.du.Settings:w=Ve.Settings;break;case h.du.NewChannelStep1:case h.du.NewChannelStep2:w=Ve.NewChannel;break;case h.du.NewGroupStep1:case h.du.NewGroupStep2:w=Ve.NewGroup}const b=(0,o.I4)((e=>{if(u!==h.du.NewGroupStep2||e)if(u!==h.du.NewChannelStep2||e){if(u===h.du.NewGroupStep1){const e=document.getElementById("new-group-picker-search");e&&e.blur()}if(u===h.du.Settings)switch(p){case h.MT.EditProfile:case h.MT.Folders:case h.MT.General:case h.MT.Notifications:case h.MT.Privacy:case h.MT.Language:return void f(h.MT.Main);case h.MT.GeneralChatBackground:return void f(h.MT.General);case h.MT.GeneralChatBackgroundColor:return void f(h.MT.GeneralChatBackground);case h.MT.PrivacyPhoneNumber:case h.MT.PrivacyLastSeen:case h.MT.PrivacyProfilePhoto:case h.MT.PrivacyForwarding:case h.MT.PrivacyGroupChats:case h.MT.PrivacyActiveSessions:case h.MT.PrivacyBlockedUsers:case h.MT.TwoFaDisabled:case h.MT.TwoFaEnabled:case h.MT.TwoFaCongratulations:return void f(h.MT.Privacy);case h.MT.PrivacyPhoneNumberAllowedContacts:case h.MT.PrivacyPhoneNumberDeniedContacts:return void f(h.MT.PrivacyPhoneNumber);case h.MT.PrivacyLastSeenAllowedContacts:case h.MT.PrivacyLastSeenDeniedContacts:return void f(h.MT.PrivacyLastSeen);case h.MT.PrivacyProfilePhotoAllowedContacts:case h.MT.PrivacyProfilePhotoDeniedContacts:return void f(h.MT.PrivacyProfilePhoto);case h.MT.PrivacyForwardingAllowedContacts:case h.MT.PrivacyForwardingDeniedContacts:return void f(h.MT.PrivacyForwarding);case h.MT.PrivacyGroupChatsAllowedContacts:case h.MT.PrivacyGroupChatsDeniedContacts:return void f(h.MT.PrivacyGroupChats);case h.MT.TwoFaNewPassword:return void f(h.MT.TwoFaDisabled);case h.MT.TwoFaNewPasswordConfirm:return void f(h.MT.TwoFaNewPassword);case h.MT.TwoFaNewPasswordHint:return void f(h.MT.TwoFaNewPasswordConfirm);case h.MT.TwoFaNewPasswordEmail:return void f(h.MT.TwoFaNewPasswordHint);case h.MT.TwoFaNewPasswordEmailCode:return void f(h.MT.TwoFaNewPasswordEmail);case h.MT.TwoFaChangePasswordCurrent:case h.MT.TwoFaTurnOff:case h.MT.TwoFaRecoveryEmailCurrentPassword:return void f(h.MT.TwoFaEnabled);case h.MT.TwoFaChangePasswordNew:return void f(h.MT.TwoFaChangePasswordCurrent);case h.MT.TwoFaChangePasswordConfirm:return void f(h.MT.TwoFaChangePasswordNew);case h.MT.TwoFaChangePasswordHint:return void f(h.MT.TwoFaChangePasswordConfirm);case h.MT.TwoFaRecoveryEmail:return void f(h.MT.TwoFaRecoveryEmailCurrentPassword);case h.MT.TwoFaRecoveryEmailCode:return void f(h.MT.TwoFaRecoveryEmail);case h.MT.FoldersCreateFolder:case h.MT.FoldersEditFolder:return void f(h.MT.Folders);case h.MT.FoldersIncludedChatsFromChatList:case h.MT.FoldersExcludedChatsFromChatList:return void f(h.MT.FoldersEditFolderFromChatList);case h.MT.FoldersEditFolderFromChatList:return g(h.du.ChatList),void f(h.MT.Main)}u!==h.du.ChatList||0!==s?(g(h.du.ChatList),v(""),n({query:""}),c({date:void 0}),r({id:void 0}),i(),setTimeout((()=>{C(Date.now())}),250)):g(h.du.GlobalSearch)}else g(h.du.NewChannelStep1);else g(h.du.NewGroupStep1)}),[u,s,p,n,c,r,i]),M=(0,o.I4)((t=>{u!==h.du.Contacts?(g(h.du.GlobalSearch),t!==e&&n({query:t})):v(t)}),[u,e,n]);(0,o.d4)((()=>u!==h.du.ChatList||0===s?(0,he.Z)((()=>b())):void 0),[s,u,b]),(0,o.d4)((()=>{l(),p===h.MT.Privacy&&d()}),[l,d,p]);const S=e=>{g(h.du.Settings),f(e)};return o.ZP.createElement(ge.Z,{id:"LeftColumn",name:a?"none":m.s0,renderCount:Xe,activeKey:w,shouldCleanup:!0,cleanupExceptionKey:Ve.Main},(s=>{switch(w){case Ve.Archived:return o.ZP.createElement(_e,{isActive:s,onReset:b,onContentChange:g});case Ve.Settings:return o.ZP.createElement(He,{isActive:s,currentScreen:p,foldersState:y,foldersDispatch:Z,onScreenSelect:S,onReset:b,shouldSkipTransition:a});case Ve.NewChannel:return o.ZP.createElement(je,{key:P,isActive:s,isChannel:!0,content:u,onContentChange:g,onReset:b});case Ve.NewGroup:return o.ZP.createElement(je,{key:P,isActive:s,content:u,onContentChange:g,onReset:b});default:return o.ZP.createElement(Ge,{content:u,searchQuery:e,searchDate:t,contactsFilter:I,foldersDispatch:Z,onContentChange:g,onSearchQuery:M,onScreenSelect:S,onReset:b,shouldSkipTransition:a})}}))})));var We=s(2420),ze=s(9524),Ye=s(1394),Je=s(3858);const et=()=>{const[e,t]=(0,o.eJ)(Je.Z.get());return(0,o.d4)((()=>{const e=(0,y.P2)((()=>{t(Je.Z.get())}),250,!1);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),e};var tt=s(2678);const st=728;const at=e=>e.chatId.toString()+("thread"!==e.type?`_${e.type}`:-1!==e.threadId?`_${e.threadId}`:"");var nt=s(3570),ot=s(5790),rt=s(8360),it=s(2155),ct=s(6058),dt=s(8799);const lt=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"HeaderMenuContainer",!t);return s?o.ZP.createElement(s,e):void 0})),ut=(0,o.X$)((0,a.c$)(((e,{chatId:t,threadId:s,messageListType:a})=>{const n=(0,i.Z1)(e,t),o=Boolean(n&&(0,d.eA)(n));if(n&&n.isRestricted)return{noMenu:!0};const r=(0,i.IK)(e,t),c=(0,i.FM)(e,t),l="thread"===a&&s===u._f,h="thread"===a&&s!==u._f,g=(0,i.Jf)(e),p=Boolean(r&&(0,i.s4)(e,r.id)),f=!p&&Boolean((0,i.pk)(e,t)),I=Boolean(l&&n&&(o||(0,d.ZV)(n))&&n.isNotJoined),v=l||h,y=l&&!c&&!I,Z=!(0,i.CA)(e),P=l&&!I;return{noMenu:!(m.wB&&I||m.wB&&v||y||Z||P),isChannel:o,isRightColumnShown:g,canStartBot:f,canRestartBot:p,canSubscribe:I,canSearch:v,canMute:y,canSelect:Z,canLeave:P}}),((e,t)=>(0,g.ei)(t,["joinChannel","sendBotCommand","openLocalTextSearch","restartBot"])))((({chatId:e,threadId:t,noMenu:s,isChannel:a,canStartBot:n,canRestartBot:r,canSubscribe:i,canSearch:c,canMute:d,canSelect:l,canLeave:u,isRightColumnShown:h,joinChannel:g,sendBotCommand:p,openLocalTextSearch:f,restartBot:I})=>{const v=(0,o.sO)(null),[y,Z]=(0,o.eJ)(!1),[P,C]=(0,o.eJ)(void 0),w=(0,o.I4)((()=>{Z(!0);const e=v.current.getBoundingClientRect();C({x:e.right,y:e.bottom})}),[]),b=(0,o.I4)((()=>{Z(!1)}),[]),M=(0,o.I4)((()=>{C(void 0)}),[]),S=(0,o.I4)((()=>{g({chatId:e})}),[g,e]),E=(0,o.I4)((()=>{p({command:"/start"})}),[p]),k=(0,o.I4)((()=>{I({chatId:e})}),[e,I]),R=(0,o.I4)((()=>{f(),m.wB?document.querySelector("#MobileSearch input").focus():setTimeout((()=>{const e=document.querySelector(".RightHeader .SearchInput input");e&&e.focus()}),400)}),[f]),T=(0,fe.Z)();return o.ZP.createElement("div",{className:"HeaderActions"},!m.wB&&i&&o.ZP.createElement(Ze.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:S},T(a?"Subscribe":"Join Group")),!m.wB&&n&&o.ZP.createElement(Ze.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:E},T("BotStart")),!m.wB&&r&&o.ZP.createElement(Ze.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:k},T("BotRestart")),!m.wB&&c&&o.ZP.createElement(Ze.Z,{round:!0,ripple:h,color:"translucent",size:"smaller",onClick:R,ariaLabel:"Search in this chat"},o.ZP.createElement("i",{className:"icon-search"})),(m.wB||!i)&&o.ZP.createElement(Ze.Z,{ref:v,className:y?"active":"",round:!0,ripple:!m.wB,size:"smaller",color:"translucent",disabled:s,ariaLabel:"More actions",onClick:w},o.ZP.createElement("i",{className:"icon-more"})),P&&o.ZP.createElement(lt,{chatId:e,threadId:t,isOpen:y,anchor:P,isChannel:a,canStartBot:n,canRestartBot:r,canSubscribe:i,canSearch:c,canMute:d,canSelect:l,canLeave:u,onSubscribeChannel:S,onSearchClick:R,onClose:b,onCloseAnimationEnd:M}))})));var ht=s(4399),mt=s(2340),gt=s(6202),pt=s(862);function ft(e){const t=e&&(0,d.DH)(e),{sticker:s}=e&&e.content||{},a=t&&s&&!(0,m.on)()&&t.includes("image/webp"),[r,i]=(0,o.eJ)(pt.Hu),c=e&&e.id;return(0,o.bt)((()=>{a&&(0,pt.p6)(`b64-${c}`,t).then(i).catch((e=>{n.eM&&console.error(e)}))}),[c,a,t]),a?r:t}var It=s(7551),vt=s(8512);function yt(e,t,s,a,n){return`M${e},${t+n}a${n},${n},0,0,1,\n  ${s},0v${a-2*n}a${n},${n},0,0,1,${-s},0Z`}const Zt=(0,o.X$)((({count:e,index:t})=>{const s=(0,o.sO)(null),a=(0,o.Ye)((()=>function(e,t){const s=e-t-1,a=function(e){let t=8;return 1===e?t=36:2===e?t=17:3===e?t=11:(4===e||e>3)&&(t=7.5),t}(e),n=function(e,t){let s=36;return 1===e?s=36:2===e?s=17:3===e?s=1===t?12:11:(4===e||e>3)&&(s=7.5),s}(e,s),o=function(e,t){return e<=3?36:t*e+2*(e-1)}(e,a),r=`clipPath${e}`;return{markHeight:n,clipPath:function(e,t,s){let a="";if(3===s)a=yt(0,0,2,t,1)+yt(0,12,2,t+1,1)+yt(0,25,2,t,1);else for(let e=0;e<s;e++)a+=yt(0,(t+2)*e,2,t,1);return`<clipPath id="${e}">\n      <path d="${a}" />\n    </clipPath>`}(r,a,e),markTranslateY:function(e,t,s){return 1===s?0:2===s?0===e?0:t+2:3===s?0===e?0:1===e?12:25:(t+2)*e}(s,a,e),trackTranslateY:function(e,t,s,a){return t<=4||e<=1?0:e>=t-2?a-36:(s+4)/2+(e-2)*(s+2)}(s,e,a,o),trackHeight:o,clipPathId:r}}(e,t)),[e,t]);if((0,o.d4)((()=>{if(!s.current)return;const{trackHeight:e,trackTranslateY:t,markHeight:n,markTranslateY:o,clipPathId:r,clipPath:i}=a,c=s.current.firstElementChild;if(s&&s.current){const a=s.current,{style:d}=a;d.height=`${e}px`,d.transform=`translateY(-${t}px)`,d.clipPath=`url("#${r}")`;const l=a.querySelector("svg"),u=a.querySelector("div"),h=a.querySelector("defs");l||c&&(c.innerHTML=`<svg height="0" width="0"><defs> ${i} </defs></svg>`),h&&(h.innerHTML=i),u&&(u.style.height=`${n}px`,u.style.transform=`translateY(${o}px)`)}}),[a]),1===e)return o.ZP.createElement("div",{className:"pinned-message-border"},o.ZP.createElement("div",{className:"pinned-message-border-wrapper-1",ref:s}));const{trackHeight:n,trackTranslateY:r,markHeight:i,markTranslateY:c,clipPathId:d}=a;return o.ZP.createElement("div",{className:(0,ne.Z)("pinned-message-border",e>4&&"pinned-message-border-mask")},o.ZP.createElement("div",{className:"pinned-message-border-wrapper",ref:s,style:`clip-path: url("#${d}"); width: 2px;\n          height: ${n}px; transform: translateY(-${r}px);`},o.ZP.createElement("span",null),o.ZP.createElement("div",{className:"pinned-message-border-mark",style:`height: ${i}px; transform: translateY(${c}px);`})))})),Pt=(0,o.X$)((({message:e,count:t,index:s,customTitle:a,className:n,onUnpinMessage:r,onClick:i,onAllPinnedClick:c})=>{const l=(0,fe.Z)(),u=ft(e),h=(0,gt.Z)((0,d.Ti)(e,"pictogram")),m=(0,d.MK)(l,e,Boolean(u)),[g,p,f]=(0,pe.Z)(),I=(0,o.I4)((()=>{f(),r&&r(e.id)}),[f,r,e.id]);return o.ZP.createElement("div",{className:(0,ne.Z)("HeaderPinnedMessage-wrapper",n)},t>1&&o.ZP.createElement(Ze.Z,{round:!0,size:"smaller",color:"translucent",className:"pin-list-button",ariaLabel:l("EventLogFilterPinnedMessages"),onClick:c},o.ZP.createElement("i",{className:"icon-pin-list"})),r&&o.ZP.createElement(Ze.Z,{round:!0,size:"smaller",color:"translucent",ariaLabel:l("UnpinMessageAlertTitle"),className:"unpin-button",onClick:p},o.ZP.createElement("i",{className:"icon-close"})),o.ZP.createElement(It.Z,{isOpen:g,onClose:f,text:"Would you like to unpin this message?",confirmLabel:"Unpin",confirmHandler:I}),o.ZP.createElement("div",{className:"HeaderPinnedMessage",onClick:i,dir:l.isRtl?"rtl":void 0},o.ZP.createElement(Zt,{count:t,index:s}),u&&function(e,t){const{width:s,height:a}=(0,ht.W7)();return o.ZP.createElement("img",{src:t||e,width:s,height:a,alt:""})}(u,h),o.ZP.createElement("div",{className:"message-text"},o.ZP.createElement("div",{className:"title",dir:"auto"},a||`${l("PinnedMessage")} ${s>0?"#"+(t-s):""}`),o.ZP.createElement("p",{dir:"auto"},(0,mt.Z)(m))),o.ZP.createElement(vt.Z,null)))}));var Ct=s(647),wt=s(3186);const bt=(0,a.c$)(((e,{message:t})=>({sender:(0,i.Ur)(e,t)})),((e,t)=>(0,g.ei)(t,["focusMessage","closeAudioPlayer"])))((({message:e,className:t,noUi:s,sender:a,focusMessage:n,closeAudioPlayer:r})=>{const i=(0,fe.Z)(),c=a?(0,d.OU)(i,a):void 0,l=Ct.UV((0,d.Ti)(e,"inline")),{playPause:u,isPlaying:h}=(0,wt.Z)((0,d.Tp)(e),(0,d.XV)(e),l,void 0,void 0,!0),g=(0,o.I4)((()=>{n({chatId:e.chatId,messageId:e.id})}),[n,e.chatId,e.id]),p=(0,o.I4)((()=>{h&&u(),r()}),[r,h,u]);if(s)return;const f=(0,d.oP)(e);return o.ZP.createElement("div",{className:(0,ne.Z)("AudioPlayer",t),dir:i.isRtl?"rtl":void 0},o.ZP.createElement(Ze.Z,{round:!0,ripple:!m.wB,color:"translucent",size:"smaller",className:(0,ne.Z)("toggle-play",h?"pause":"play"),onClick:u,ariaLabel:h?"Pause audio":"Play audio"},o.ZP.createElement("i",{className:"icon-play"}),o.ZP.createElement("i",{className:"icon-pause"})),o.ZP.createElement("div",{className:"AudioPlayer-content",onClick:g},f?function(e){const{title:t,performer:s,fileName:a}=e;return o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement("div",{className:"title",dir:"auto"},(0,mt.Z)(t||a)),s&&o.ZP.createElement("div",{className:"subtitle",dir:"auto"},(0,mt.Z)(s)))}(f):function(e,t){return o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement("div",{className:"title",dir:"auto"},t&&(0,mt.Z)(t)),o.ZP.createElement("div",{className:"subtitle",dir:"auto"},e))}(i("AttachAudio"),c),o.ZP.createElement(vt.Z,null)),o.ZP.createElement(Ze.Z,{round:!0,className:"player-close",color:"translucent",size:"smaller",onClick:p,ariaLabel:"Close player"},o.ZP.createElement("i",{className:"icon-close"})))})),Mt=(0,o.X$)((0,a.c$)(((e,{chatId:t,threadId:s,messageListType:a})=>{const{isLeftColumnShown:n,lastSyncTime:o,shouldSkipHistoryAnimations:r}=e,{byId:c}=e.chats,d=(0,i.Z1)(e,t),{typingStatus:l}=d||{},{chatId:h,messageId:m}=e.audioPlayer,g=h&&m?(0,i.hj)(e,h,m):void 0;let p;if("pinned"===a){const s=(0,i.KB)(e,t);p=s&&s.length}else if("scheduled"===a){const s=(0,i.qy)(e,t);p=s&&s.length}else if("thread"===a&&s!==u._f){const a=(0,i.tZ)(e,t,s);a&&(p=a.messagesCount)}const f={typingStatus:l,isLeftColumnShown:n,isRightColumnShown:(0,i.Jf)(e),isSelectModeActive:(0,i.CA)(e),audioMessage:g,chat:d,chatsById:c,messagesCount:p,isChatWithSelf:(0,i.FM)(e,t),isChatWithBot:d&&(0,i.xo)(e,d),lastSyncTime:o,shouldSkipHistoryAnimations:r,currentTransitionKey:Math.max(0,e.messages.messageLists.length-1)},I=(0,i.Zw)(e,t);if("thread"!==a||!I)return f;if(Object.assign(f,{messagesById:I}),s!==u._f){const a=(0,i.qS)(e,t,s),n=a?(0,i.hj)(e,t,a):void 0,o=n?(0,i.cv)(e,n):void 0;return{...f,pinnedMessageIds:a,canUnpin:!1,topMessageSender:o}}const v=(0,i.KB)(e,t);if(v&&v.length){const t=I[v[0]],{canUnpin:a}=t&&(0,i._k)(e,t,s)||{};return{...f,pinnedMessageIds:v,canUnpin:a}}return f}),((e,t)=>(0,g.ei)(t,["openChatWithInfo","pinMessage","focusMessage","openChat","openPreviousChat","loadPinnedMessages","toggleLeftColumn","exitMessageSelectMode"])))((({chatId:e,threadId:t,messageListType:s,isReady:r,pinnedMessageIds:c,messagesById:l,canUnpin:h,topMessageSender:g,typingStatus:p,isSelectModeActive:f,isLeftColumnShown:I,isRightColumnShown:v,audioMessage:y,chat:Z,chatsById:P,messagesCount:C,isChatWithSelf:w,isChatWithBot:b,lastSyncTime:M,shouldSkipHistoryAnimations:S,currentTransitionKey:E,openChatWithInfo:k,pinMessage:R,focusMessage:T,openChat:N,openPreviousChat:B,loadPinnedMessages:x,toggleLeftColumn:A,exitMessageSelectMode:L})=>{const O=(0,fe.Z)(),[U,F]=(0,o.eJ)(0),$=Array.isArray(c)?c[U]:c,Q=l&&$?l[$]:void 0,D=Array.isArray(c)?c.length:c?1:0,q=Z&&(0,d.U)(O,Z).length,G=g?(0,d.OU)(O,g):void 0;(0,o.d4)((()=>{t===u._f&&M&&r&&x({chatId:e})}),[e,x,M,t,r]),(0,o.d4)((()=>{F(0)}),[c]),(0,ot.Z)(e,$,Q);const{width:H}=et(),j=H<=n.ks,_=m.p7&&I,V=(0,o.sO)(null),X=(0,o.sO)(!0),K=(0,o.I4)((()=>{k({id:e})}),[k,e]),W=(0,o.I4)((t=>{R({chatId:e,messageId:t,isUnpin:!0})}),[R,e]),z=(0,o.I4)((()=>{if(Q){T({chatId:Q.chatId,threadId:t,messageId:Q.id});const e=(0,nt.Z)(D,U+1);F(e)}}),[Q,T,t,D,U]),Y=(0,o.I4)((()=>{N({id:e,threadId:u._f,type:"pinned"})}),[N,e]),J=(0,o.I4)((e=>{if(m.wB){const e=document.getElementById(n.R2);e&&e.blur()}t!==u._f||"thread"!==s||0!==E?("scheduled"===s&&f&&L(),B()):m.wB||_?(e.stopPropagation(),N({id:void 0})):A()}),[t,s,E,f,B,_,N,A,L]),ee=(0,o.Ye)((()=>{if(j&&P)return(0,i.A1)((0,a.Rd)())||void 0}),[j,P]),te=H>=n.ks&&H<n.jT||H>n.l3&&H<n.ks&&(!q||q>30),se=te||H>n._m&&H<n.QU,{shouldRender:ae,transitionClassNames:oe}=(0,re.Z)(Boolean(y)),ie=(0,rt.Z)(y),{shouldRender:ce,transitionClassNames:de}=(0,re.Z)(Q&&!ae),le=(0,rt.Z)(Q),ue=(0,rt.Z)(G),he=ce&&le||ae&&ie;function me(){return"thread"===s&&t===u._f?o.ZP.createElement(o.ZP.Fragment,null,(j||E>0)&&pe(_,!0),o.ZP.createElement("div",{className:"chat-info-wrapper",onClick:K},(0,d.YA)(e)?o.ZP.createElement(ct.Z,{userId:e,typingStatus:p,withFullInfo:b,withMediaViewer:!0,withUpdatingStatus:!0,noRtl:!0}):o.ZP.createElement(dt.Z,{chatId:e,typingStatus:p,noRtl:!0,withMediaViewer:!0,withFullInfo:!0,withUpdatingStatus:!0}))):"thread"===s?o.ZP.createElement(o.ZP.Fragment,null,pe(),o.ZP.createElement("h3",null,O("CommentsCount",C))):"pinned"===s?o.ZP.createElement(o.ZP.Fragment,null,pe(),o.ZP.createElement("h3",null,O("PinnedMessagesCount",C))):"scheduled"===s?o.ZP.createElement(o.ZP.Fragment,null,pe(),o.ZP.createElement("h3",null,w?O("Reminders"):O("messages",C,"i"))):void 0}function pe(e=!1,t=!1){return o.ZP.createElement("div",{className:"back-button"},o.ZP.createElement(Ze.Z,{round:!0,size:"smaller",color:"translucent",onClick:J,ariaLabel:e?"Close":"Back"},o.ZP.createElement("div",{className:(0,ne.Z)("animated-close-icon",!e&&"state-back")})),t&&ee&&o.ZP.createElement("div",{className:"unread-count active"},(0,it.bi)(ee)))}return(0,o.d4)((()=>{const e=V.current;if(e)return se&&he?void(v||te?(X.current&&(e.classList.add("tools-stacked","animated"),X.current=!1),setTimeout((()=>{e.classList.remove("animated")}),350)):(e.classList.remove("tools-stacked"),X.current=!0)):(e.classList.remove("tools-stacked","animated"),void(X.current=!0))}),[se,he,te,v]),o.ZP.createElement("div",{className:"MiddleHeader",ref:V},o.ZP.createElement(ge.Z,{name:S?"none":"slide-fade",activeKey:E},me),o.ZP.createElement("div",{className:"header-tools"},ce&&le&&!ae&&o.ZP.createElement(Pt,{key:e,message:le,count:D,index:U,customTitle:ue,className:de,onUnpinMessage:h?W:void 0,onClick:z,onAllPinnedClick:Y}),ae&&ie&&o.ZP.createElement(bt,{key:(0,d.Tp)(ie),message:ie,className:oe}),o.ZP.createElement(ut,{chatId:e,threadId:t,messageListType:s})))})));var St=s(2645),Et=s(274);function kt(e){return"albumId"in e}function Rt(e,t){let s,a=[],n={originalDate:e[0].date,datetime:Number((0,A.$Y)(1e3*e[0].date)),senderGroups:[a]};const o=[n];return e.forEach(((r,i)=>{r.isInAlbum?s?(s.messages.push(r),r.content.text&&(s.mainMessage=r)):s={albumId:r.groupedId,messages:[r],mainMessage:r}:a.push(r);const c=e[i+1];if(!s||c&&c.groupedId&&c.groupedId===s.albumId||(a.push(s),s=void 0),c){const e=Number((0,A.$Y)(1e3*c.date));n.datetime!==e?(n={originalDate:c.date,datetime:e,senderGroups:[]},o.push(n),a=[],n.senderGroups.push(a)):(c.id===t||r.senderId!==c.senderId||r.isOutgoing!==c.isOutgoing||(0,d.Lo)(r)||(0,d.Lo)(c)||r.forwardInfo&&c.forwardInfo&&(r.forwardInfo.senderUserId!==c.forwardInfo.senderUserId||r.forwardInfo.fromChatId!==c.forwardInfo.fromChatId||r.forwardInfo.hiddenUserName!==c.forwardInfo.hiddenUserName)||r.inlineButtons||c.inlineButtons||c.date-r.date>600)&&(a=[],n.senderGroups.push(a))}})),o}function Tt(e){!m.wB&&document.activeElement&&document.activeElement.id===n.R2&&e.target===e.currentTarget&&e.preventDefault()}var Nt=s(7675),Bt=s(539),xt=s(3657);const At=m.wZ?1e3:350,Lt=m.wB?300:500;var Ot=s(7240),Ut=s(935);function Ft(e){return"number"==typeof e}function $t(e,t){return e?t?238:175:t?238:100}function Qt(e,t){const s=(0,d.B4)(e),a=(0,d.MF)(e),n=(0,d.O$)(e)||(0,d.F$)(e),o=(0,d.b7)(e),r=Boolean((0,d.F$)(e)),{width:i,height:c}=n?(0,ht.Eh)(n,s,a,r,t):(0,ht.GC)(o,s,a,t),l=$t(Boolean((0,d.UD)(e)));let u=1;i<l&&l-i<12&&(u=l/i),c*u<90&&90-c*u<12&&(u=90/c);const h=Math.round(i*u),m=Math.round(c*u);return{width:h,height:m,isSmall:h<l||m<90}}function Dt(e,t){return e.reduce(((e,t)=>e+t),t)}function qt(e,t,s){return e<t?t:e>s?s:e}function Gt(e){const t={width:0,height:0};return e.forEach((({dimensions:e,sides:s})=>{2&s&&(t.width=e.width+e.x),4&s&&(t.height=e.height+e.y)})),t}function Ht(e,t,s,a){const n=a.messages.map((e=>{const t=Qt(e);return t.width/t.height})),o=function(e){return e.map((e=>e>1.2?"w":e<.8?"n":"q")).join("")}(n),r=function(e){return e.reduce(((e,t)=>t+e),1)/e.length}(n),i=n.length,c=n.some((e=>e>2)),d=(0,ht.kc)(e,t,!1,s)-(t?2.5:0)*ht.Gw;let l;const u={ratios:n,proportions:o,averageRatio:r,maxWidth:d,minWidth:100,maxHeight:d,spacing:2};return l=i>=5||c?function({ratios:e,averageRatio:t,maxWidth:s,minWidth:a,spacing:n,maxHeight:o=4*s/3}){const r=function(e,t){return e.map((e=>t>1.1?qt(e,1,2.75):qt(e,.6667,1)))}(e,t),i=e.length,c=new Array(i),d=[],l=e=>{const t=[];let a=0;e.forEach((e=>{t.push(((e,t)=>{const a=Dt(r.slice(e,e+t),0);return(s-(t-1)*n)/a})(a,e)),a+=e})),d.push({lineCounts:e,heights:t})};for(let e=1;e!==i;++e){const t=i-e;e<=3&&t<=3&&l([e,t])}for(let e=1;e!==i-1;++e)for(let s=1;s!==i-e;++s){const a=i-e-s;e<=3&&s<=(t<.85?4:3)&&a<=3&&l([e,s,a])}for(let e=1;e!==i-1;++e)for(let t=1;t!==i-e;++t)for(let s=1;s!==i-e-t;++s){const a=i-e-t-s;e<=3&&t<=3&&s<=3&&a<=4&&l([e,t,s,a])}let u,h=0;for(let e=0;e<d.length;e++){const{heights:t,lineCounts:s}=d[e],r=s.length,i=Dt(t,0)+n*(r-1),c=Math.min(...t)<a?1.5:1,l=(()=>{for(let e=1;e!==r;++e)if(s[e-1]>s[e])return 1.5;return 1})(),m=Math.abs(i-o)*c*l;(!u||m<h)&&(u=d[e],h=m)}const m=u.lineCounts,g=u.heights,p=m.length;let f=0,I=0;for(let e=0;e!==p;++e){const t=m[e],a=g[e],o=Math.round(a);let i=0;for(let d=0;d!==t;++d){const l=0|(0===e?1:0)|(e===p-1?4:0)|(0===d?8:0)|(d===t-1?2:0),u=r[f],h=d===t-1?s-i:Math.round(u*a);c[f]={dimensions:{x:i,y:I,width:h,height:o},sides:l},i+=h+n,++f}I+=o+n}return c}(u):2===i?function(e){const{ratios:t,proportions:s,averageRatio:a}=e;return"ww"===s&&a>1.4&&t[1]-t[0]<.2?function(e){const{ratios:t,maxWidth:s,spacing:a,maxHeight:n}=e,o=Math.round(Math.min(s/t[0],Math.min(s/t[1],(n-a)/2)));return[{dimensions:{x:0,y:0,width:s,height:o},sides:11},{dimensions:{x:0,y:o+a,width:s,height:o},sides:14}]}(e):"ww"===s||"qq"===s?function(e){const{ratios:t,maxWidth:s,spacing:a,maxHeight:n}=e,o=(s-a)/2,r=Math.round(Math.min(o/t[0],Math.min(o/t[1],n)));return[{dimensions:{x:0,y:0,width:o,height:r},sides:13},{dimensions:{x:o+a,y:0,width:o,height:r},sides:7}]}(e):function(e){const{ratios:t,minWidth:s,maxWidth:a,spacing:n,maxHeight:o}=e,r=Math.round(1.5*s),i=Math.min(Math.round(Math.max(.4*(a-n),(a-n)/t[0]/(1/t[0]+1/t[1]))),a-n-r),c=a-i-n,d=Math.min(o,Math.round(Math.min(c/t[0],i/t[1])));return[{dimensions:{x:0,y:0,width:c,height:d},sides:13},{dimensions:{x:c+n,y:0,width:i,height:d},sides:7}]}(e)}(u):3===i?function(e){const{proportions:t}=e;return"n"===t[0]?function(e){const{maxHeight:t,spacing:s,ratios:a,maxWidth:n,minWidth:o}=e,r=t,i=Math.round(Math.min((t-s)/2,a[1]*(n-s)/(a[2]+a[1]))),c=r-i-s,d=Math.max(o,Math.round(Math.min((n-s)/2,Math.min(i*a[2],c*a[1])))),l=Math.min(Math.round(r*a[0]),n-s-d);return[{dimensions:{x:0,y:0,width:l,height:r},sides:13},{dimensions:{x:l+s,y:0,width:d,height:c},sides:3},{dimensions:{x:l+s,y:c+s,width:d,height:i},sides:6}]}(e):function(e){const{maxWidth:t,ratios:s,maxHeight:a,spacing:n}=e,o=t,r=Math.round(Math.min(o/s[0],.66*(a-n))),i=(t-n)/2,c=Math.min(a-r-n,Math.round(Math.min(i/s[1],i/s[2])));return[{dimensions:{x:0,y:0,width:o,height:r},sides:11},{dimensions:{x:0,y:r+n,width:i,height:c},sides:12},{dimensions:{x:i+n,y:r+n,width:o-i-n,height:c},sides:6}]}(e)}(u):function(e){const{proportions:t}=e;return"w"===t[0]?function({maxWidth:e,ratios:t,spacing:s,maxHeight:a,minWidth:n}){const o=e,r=Math.round(Math.min(o/t[0],.66*(a-s))),i=Math.round((e-2*s)/(t[1]+t[2]+t[3])),c=Math.max(n,Math.round(Math.min(.4*(e-2*s),i*t[1]))),d=Math.round(Math.max(Math.max(n,.33*(e-2*s)),i*t[3])),l=o-c-d-2*s,u=Math.min(a-r-s,i);return[{dimensions:{x:0,y:0,width:o,height:r},sides:11},{dimensions:{x:0,y:r+s,width:c,height:u},sides:12},{dimensions:{x:c+s,y:r+s,width:l,height:u},sides:4},{dimensions:{x:c+s+l+s,y:r+s,width:d,height:u},sides:6}]}(e):function({maxHeight:e,ratios:t,maxWidth:s,spacing:a,minWidth:n}){const o=e,r=Math.round(Math.min(o*t[0],.6*(s-a))),i=Math.round((e-2*a)/(1/t[1]+1/t[2]+1/t[3])),c=Math.round(i/t[1]),d=Math.round(i/t[2]),l=o-c-d-2*a,u=Math.max(n,Math.min(s-r-a,i));return[{dimensions:{x:0,y:0,width:r,height:o},sides:13},{dimensions:{x:r+a,y:0,width:u,height:c},sides:3},{dimensions:{x:r+a,y:c+a,width:u,height:d},sides:2},{dimensions:{x:r+a,y:c+d+2*a,width:u,height:l},sides:6}]}(e)}(u),{layout:l,containerStyle:Gt(l)}}let jt;function _t(e){return jt||(jt=document.createElement("span"),jt.style.font=m.cj?'400 12px system-ui, -apple-system, BlinkMacSystemFont, "Roboto", "Apple Color Emoji", "Helvetica Neue", sans-serif':'400 12px "Roboto", -apple-system, "Apple Color Emoji", BlinkMacSystemFont, "Helvetica Neue", sans-serif',jt.style.whiteSpace="nowrap",jt.style.position="absolute",jt.style.left="-999px",jt.style.opacity=".01",document.body.appendChild(jt)),jt.innerHTML=e,jt.offsetWidth}function Vt(e,t,s,a,n,r){(0,o.bt)((()=>{if(s&&e.current){const t=e.current.closest(".MessageList");(0,Bt.Z)(t,e.current,n?"end":"centerOrTop",20,void 0!==a?1e3:void 0,a,void 0,r)}}),[e,t,s,a,n,r])}var Xt=s(172),Kt=s(2864);const Wt=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"ContextMenuContainer",!t);return s?o.ZP.createElement(s,e):void 0})),zt=(0,o.X$)((0,a.c$)(((e,{message:t})=>{const{byId:s}=e.users,a=t.senderId,{targetUserIds:n,targetChatId:o}=t.content.action||{},r=t.replyToMessageId,c=r?(0,i.hj)(e,t.chatId,r):void 0,l=(0,i._X)(e,t),{direction:u,noHighlight:h}=l&&e.focusedMessage||{},m=(0,i.Z1)(e,t.chatId);return{usersById:s,sender:m&&((0,d.eA)(m)||a===t.chatId)?m:a?(0,i.dy)(e,a):void 0,targetChatId:o,targetUserIds:n,targetMessage:c,isFocused:l,...l&&{focusDirection:u,noFocusHighlight:h}}}))((({message:e,observeIntersection:t,isEmbedded:s,appearanceOrder:a=0,isLastInList:n,usersById:r,sender:i,targetUserIds:c,targetMessage:d,targetChatId:l,isFocused:u,focusDirection:h,noFocusHighlight:m})=>{const g=(0,o.sO)(null);(0,xt._N)(g,t),(0,ot.Z)(e.chatId,e.replyToMessageId,d),Vt(g,e.chatId,u,h,m);const p=(0,fe.Z)(),f=a<=0,[I,v]=(0,pe.Z)(f);(0,o.d4)((()=>{f||setTimeout(v,10*a)}),[a,v,f]);const{transitionClassNames:y}=(0,re.Z)(I,void 0,f,!1),Z=(0,o.Ye)((()=>c?c.map((e=>r&&r[e])).filter(Boolean):void 0),[c,r]),P=(0,Kt.D)(p,e,i,Z,d,l,s?{isEmbedded:!0,asPlain:!0}:void 0),{isContextMenuOpen:C,contextMenuPosition:w,handleBeforeContextMenu:b,handleContextMenu:M,handleContextMenuClose:S,handleContextMenuHide:E}=(0,Ot.Z)(g),k=void 0!==w;if(s)return o.ZP.createElement("span",{className:"embedded-action-message"},(0,mt.Z)(P));const R=(0,ne.Z)("ActionMessage message-list-item",u&&!m&&"focused",k&&"has-menu-open",n&&"last-in-list",y);return o.ZP.createElement("div",{ref:g,id:`message${e.id}`,className:R,"data-message-id":e.id,onMouseDown:e=>{Tt(e),b(e)},onContextMenu:M},o.ZP.createElement("span",null,P),w&&o.ZP.createElement(Wt,{isOpen:C,anchor:w,message:e,messageListType:"thread",onClose:S,onCloseAnimationEnd:E}))}))),Yt=({className:e,message:t,sender:s,title:a,customText:n,observeIntersection:r,onClick:i})=>{const c=(0,o.sO)(null),l=(0,xt.Op)(c,r),u=(0,gt.Z)(t&&(0,d.Ti)(t,"pictogram"),!l),h=t&&`sticker-reply-thumb${t.id}`,m=ft(t),g=Boolean(t&&(0,d.Y5)(t)),p=(0,fe.Z)(),f=s&&(0,d.OU)(p,s);return o.ZP.createElement("div",{ref:c,className:(0,ne.Z)("EmbeddedMessage",e),onClick:t?i:void 0},m&&function(e,t,s,a){const{width:n,height:r}=(0,ht.W7)();return o.ZP.createElement("img",{id:e,src:s||t,width:n,height:r,alt:"",className:a?"round":""})}(h,m,u,g),o.ZP.createElement("div",{className:"message-text"},o.ZP.createElement("p",{dir:"auto"},t?(0,d.Lo)(t)?o.ZP.createElement(zt,{message:t,isEmbedded:!0}):(0,mt.Z)((0,d.MK)(p,t,Boolean(m))):n||"Â "),o.ZP.createElement("div",{className:"message-title",dir:"auto"},(0,mt.Z)(f||a||"Â "))))};var Jt=s(2535),es=s(4752),ts=s(8018);const ss=(0,o.X$)((({message:e,outgoingStatus:t,signature:s,onClick:a})=>{const n=(0,fe.Z)();return o.ZP.createElement("span",{className:"MessageMeta",dir:n.isRtl?"rtl":"ltr",onClick:a},Boolean(e.views)&&o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement("span",{className:"message-views"},(0,it.bi)(e.views)),o.ZP.createElement("i",{className:"icon-channelviews"})),s&&o.ZP.createElement("span",{className:"message-signature"},(0,mt.Z)(s)),o.ZP.createElement("span",{className:"message-time"},e.isEdited&&`${n("EditedMessage")} `,(0,A.mr)(1e3*e.date)),t&&o.ZP.createElement(ts.Z,{status:t}))}));var as=s(8835),ns=s(7799),os=s(4851);const rs=({message:e,observeIntersection:t,observeIntersectionForPlaying:s,shouldLoop:a,lastSyncTime:r})=>{const i=(0,o.sO)(null),[c,l,u]=(0,pe.Z)(),h=e.content.sticker,{isAnimated:m,stickerSetId:g}=h,p=g===n.n,f=(0,xt.Op)(i,t),I=(0,xt.Op)(i,s),v=h.isPreloadedGlobally?`sticker${h.id}`:(0,d.Ti)(e,"inline"),y=ft(e),Z=(0,gt.Z)(v,!f,(0,d.kG)(e,"inline",!0),r),P=Boolean(Z),[C,w]=(0,pe.Z)(P),b=m?C:P,{shouldRenderFullMedia:M,transitionClassNames:S}=(0,as.Z)(b,"slow"),{width:E,height:k}=(0,ht.Wr)(h),R=(0,ne.Z)("thumbnail",!y&&"empty"),T=(0,ne.Z)("Sticker media-inner",p&&"inactive");return o.ZP.createElement("div",{ref:i,className:T,onClick:p?void 0:l},!b&&o.ZP.createElement("img",{id:`sticker-thumb-${e.id}`,src:y,width:E,height:k,alt:"",className:R}),!m&&M&&o.ZP.createElement("img",{id:`sticker-${e.id}`,src:Z,width:E,height:k,alt:"",className:(0,ne.Z)("full-media",S)}),m&&P&&o.ZP.createElement(ns.Z,{key:v,className:(0,ne.Z)("full-media",S),id:v,animationData:Z,size:E,play:I,noLoop:!a,onLoad:w}),o.ZP.createElement(os.Z,{isOpen:c,fromSticker:h,onClose:u}))};var is=s(7854),cs=s(2761),ds=s(5866);function ls(e,t){return(0,ds.Z)((0,d.DH)(e),Boolean(t),m.wB&&!m.vX)}var us=s(7204);const hs=Promise.resolve("rgba(255,255,255,1)");var ms=s(9196);const gs=({id:e,message:t,observeIntersection:s,noAvatars:a,shouldAutoLoad:n,isInSelectMode:r,isSelected:i,uploadProgress:c,size:l="inline",dimensions:u,nonInteractive:h,shouldAffectAppendix:m,onClick:g,onCancelUpload:p})=>{const f=(0,o.sO)(null),I=((0,d.O$)(t)||(0,d.F$)(t)).blobUrl,v=(0,xt.Op)(f,s),[y,Z]=(0,o.eJ)(n),P=y&&v,{mediaData:C,downloadProgress:w}=(0,cs.Z)((0,d.Ti)(t,l),!P),b=I||C,M=ls(t,b),{isUploading:S,isTransferring:E,transferProgress:k}=(0,d.Sc)(t,c||w,P&&!b),R=!1===(0,us.Z)(y),{shouldRender:T,transitionClassNames:N}=(0,re.Z)(E,void 0,R,"slow"),{shouldRenderThumb:B,shouldRenderFullMedia:x,transitionClassNames:A}=(0,as.Z)(b,"slow"),L=(0,o.I4)((()=>{S?p&&p(t):b?g&&g(t.id):Z((e=>!e))}),[b,S,t,p,g]),O=(0,d.B4)(t);(0,o.bt)((()=>{if(!m)return;const e=f.current.closest(".message-content");b?function(e,t,s,a){return a?hs:async function(e,t){const s=new Image;s.src=e,s.width||await new Promise((e=>{s.onload=e}));const a=document.createElement("canvas"),n=a.getContext("2d");a.width=s.width,a.height=s.height,n.drawImage(s,0,0,s.width,s.height);const o=t?s.width-1:0,r=s.height-1;return`rgba(${Array.from(n.getImageData(o,r,1,1).data).join(",")})`}(e,t)}(b,O,0,i).then((t=>{e.style.setProperty("--appendix-bg",t),e.setAttribute("data-has-custom-appendix","")})):e.classList.add("has-appendix-thumb")}),[b,O,m,r,i]);const{width:U,height:F,isSmall:$}=u||Qt(t,a),Q=(0,ne.Z)("media-inner",!S&&!h&&"interactive",$&&"small-image",U===F&&"square-image"),D=u?`width: ${U}px; height: ${F}px; left: ${u.x}px; top: ${u.y}px;`:"";return o.ZP.createElement("div",{id:e,ref:f,className:Q,style:D,onClick:S?void 0:L},B&&o.ZP.createElement("canvas",{ref:M,className:"thumbnail",style:`width: ${U}px; height: ${F}px`}),x&&o.ZP.createElement("img",{src:b,className:`full-media ${A}`,width:U,height:F,alt:""}),T&&o.ZP.createElement("div",{className:`media-loading ${N}`},o.ZP.createElement(ms.Z,{progress:k,onClick:S?L:void 0})),!b&&!y&&o.ZP.createElement("i",{className:"icon-download"}),E&&o.ZP.createElement("span",{className:"message-upload-progress"},Math.round(100*k),"%"))};var ps=s(2019),fs=s(4753);function Is(e,t){const s=(0,o.sO)();s.current=t;const a=(0,o.I4)((()=>{e.current&&e.current.pause()}),[e]),n=(0,o.I4)((()=>{e.current&&s.current&&(0,fs.Z)(e.current)}),[e]);(0,ae.ZP)(a,n)}var vs=s(6898);const ys=(e,t=!1)=>{const s=(0,o.sO)(!1),a=(0,o.sO)(!1),n=(0,o.I4)((()=>{a.current=!0,t&&e.current&&(s.current||(s.current=!e.current.paused),e.current.pause())}),[t,e]),r=(0,o.I4)((()=>{t&&e.current&&s.current&&document.body.contains(e.current)&&(0,fs.Z)(e.current),s.current=!1,a.current=!1}),[t,e]),i=(0,o.I4)((()=>{(0,y.T2)(r)}),[r]);document.hasFocus()||n(),(0,ie.Z)(n,i)};function Zs(){return(Zs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}const Ps=({id:e,message:t,observeIntersection:s,noAvatars:a,shouldAutoLoad:n,shouldAutoPlay:r,uploadProgress:i,lastSyncTime:c,dimensions:l,onClick:u,onCancelUpload:h})=>{const m=(0,o.sO)(null),g=(0,o.sO)(null),p=(0,d.b7)(t)||(0,d.Cg)(t),f=p.blobUrl,I=(0,xt.Op)(m,s),[v,y]=(0,o.eJ)(n),Z=Boolean(v&&I&&c),[P,C]=(0,o.eJ)(r),w=(0,gt.Z)((0,d.Ti)(t,"pictogram"),!(I&&c),(0,d.kG)(t,"pictogram"),c),{mediaData:b,downloadProgress:M}=(0,cs.Z)((0,d.Ti)(t,"inline"),!Z,(0,d.kG)(t,"inline"),c),S=f||b,E=Boolean(I&&S),k=ls(t,w),{isBuffered:R,bufferingHandlers:T}=(0,ps.Z)(!n),{isUploading:N,isTransferring:B,transferProgress:x}=(0,d.Sc)(t,i||M,Z&&!R),L=!1===(0,us.Z)(v),{shouldRender:O,transitionClassNames:U}=(0,re.Z)(B,void 0,L),{transitionClassNames:F}=(0,as.Z)(S,"slow"),[$,Q]=(0,o.eJ)(0),D=(0,o.I4)((e=>{Q(Math.max(0,e.currentTarget.currentTime-1))}),[]),q=g.current&&g.current.duration||p.duration||0,G=(0,d.B4)(t),H=(0,d.MF)(t),{width:j,height:_}=l||(0,ht.GC)(p,G,H,a);Is(g,Boolean(E&&r)),ys(g,P),(0,vs.Z)(g,[E]);const V=(0,o.I4)((()=>{N?h&&h(t):S?S&&!P?(C(!0),g.current.play()):u&&u(t.id):y((e=>!e))}),[N,S,P,u,h,t]),X=(0,ne.Z)("media-inner dark",!N&&"interactive"),K=(0,ne.Z)("full-media",F),W=l?`width: ${j}px; height: ${_}px; left: ${l.x}px; top: ${l.y}px;`:"";return o.ZP.createElement("div",{ref:m,id:e,className:X,style:W,onClick:N?void 0:V},!w&&o.ZP.createElement("canvas",{ref:k,className:"thumbnail",style:`width: ${j}px; height: ${_}px;`}),w&&o.ZP.createElement("img",{src:w,className:"thumbnail",style:`width: ${j}px; height: ${_}px;`,alt:""}),E&&o.ZP.createElement("video",Zs({ref:g,className:K,width:j,height:_,autoPlay:P,muted:!0,loop:!0,playsInline:!0},T,{onTimeUpdate:D}),o.ZP.createElement("source",{src:S})),v&&!P&&!O&&o.ZP.createElement("i",{className:"icon-large-play"}),O&&o.ZP.createElement("div",{className:`media-loading ${U}`},o.ZP.createElement(ms.Z,{progress:x,onClick:N?V:void 0})),!v&&o.ZP.createElement("i",{className:"icon-download"}),B?o.ZP.createElement("span",{className:"message-upload-progress"},"..."):o.ZP.createElement("div",{className:"message-media-duration"},p.isGif?"GIF":(0,A.k9)(Math.max(q-$,0))))};var Cs=s(2969);const ws=(0,a.c$)(((e,{contact:t})=>({user:(0,i.dy)(e,t.userId)})),((e,t)=>(0,g.ei)(t,["openUserInfo"])))((({contact:e,user:t,openUserInfo:s})=>{const{firstName:a,lastName:n,phoneNumber:r,userId:i}=e,c=(0,o.I4)((()=>{s({id:i})}),[s,i]);return o.ZP.createElement("div",{className:(0,ne.Z)("Contact",Boolean(i)&&"interactive"),onClick:i?c:void 0},o.ZP.createElement(Xt.Z,{size:"large",user:t,text:a||n}),o.ZP.createElement("div",{className:"contact-info"},o.ZP.createElement("div",{className:"contact-name"},a," ",n),o.ZP.createElement("div",{className:"contact-phone"},(0,Cs.WZ)(r))))}));var bs=s(4605);const Ms=(0,o.X$)((({id:e,options:t,selected:s=[],disabled:a,round:n,loadingOptions:r,onChange:i})=>{const[c,d]=(0,o.eJ)([]),l=(0,o.I4)((e=>{const{value:t,checked:s}=e.currentTarget;let a;a=s?[...c,t]:c.filter((e=>e!==t)),d(a),i(a)}),[i,c]);return o.ZP.createElement("div",{id:e,className:"radio-group"},t.map((e=>o.ZP.createElement(bs.Z,{label:e.label,subLabel:e.subLabel,value:e.value,checked:-1!==s.indexOf(e.value),disabled:a,round:n,isLoading:r?-1!==r.indexOf(e.value):void 0,onChange:l}))))}));var Ss=s(4434),Es=s(6937);function ks(e,t){return t>0?(e/t*100).toFixed():0}const Rs=({answer:e,voteResults:t,totalVoters:s,maxVotersCount:a,correctResults:n,shouldAnimate:r})=>{const i=t&&t.find((t=>t.option===e.option)),c=0===n.length||-1!==n.indexOf(e.option),d=n.length>0&&c||i&&i.isChosen,l=i?ks(i.votersCount,s||0):0,[u,h]=(0,o.eJ)(r?0:l),m=(0,o.sO)(null),g=i?ks(i.votersCount,a||0):0,p=u<l;if((0,o.d4)((()=>{r&&h(l)}),[r,l]),(0,o.d4)((()=>{const e=m.current;if(e&&r){const t=e.firstElementChild,s=p?"":"stroke-dasharray: 100% 200%; stroke-dashoffset: -44";t?t.setAttribute("style",s):e.innerHTML=`\n          <svg class="poll-line" xmlns="http://www.w3.org/2000/svg" style="${s}">\n            <path d="M4.47 5.33v13.6a9 9 0 009 9h13"/>\n          </svg>`}}),[p,r]),!t||!i)return;const f=`width: ${g}%; transform:scaleX(${p?0:1})`;return o.ZP.createElement("div",{className:"PollOption",dir:"ltr"},o.ZP.createElement("div",{className:"poll-option-share "+("100"===l?"limit-width":"")},l,"%",d&&o.ZP.createElement("span",{className:(0,ne.Z)("poll-option-chosen",!c&&"wrong",r&&"animate")},o.ZP.createElement("i",{className:c?"icon-check":"icon-close"}))),o.ZP.createElement("div",{className:"poll-option-right"},o.ZP.createElement("div",{className:"poll-option-text",dir:"auto"},(0,mt.Z)(e.text)),o.ZP.createElement("div",{className:(0,ne.Z)("poll-option-answer",d&&!c&&"wrong")},o.ZP.createElement("div",{className:"poll-option-corner",ref:m}),o.ZP.createElement("div",{className:"poll-option-line",style:f}))))},Ts=(0,o.X$)((0,a.c$)(((e,{poll:t})=>{const{recentVoterIds:s}=t.results,{serverTimeOffset:a,users:{byId:n}}=e;return s&&0!==s.length?{recentVoterIds:s,usersById:n,serverTimeOffset:a}:{}}),((e,t)=>(0,g.ei)(t,["loadMessage","openPollResults"])))((({message:e,poll:t,recentVoterIds:s,usersById:a,loadMessage:n,onSendVote:r,openPollResults:i,serverTimeOffset:c})=>{const{id:d,chatId:l}=e,{summary:u,results:h}=t,[m,g]=(0,o.eJ)(!1),[p,f]=(0,o.eJ)([]),[I,v]=(0,o.eJ)(!1),[y,Z]=(0,o.eJ)(!1),[P,C]=(0,o.eJ)(!u.closed&&u.closeDate&&u.closeDate>0?Math.min(u.closeDate-Math.floor(Date.now()/1e3)+c,u.closePeriod):0),w=(0,o.sO)(null),{results:b,totalVoters:M}=h,S=b&&b.some((e=>e.isChosen)),E=!u.closed&&!S,k=!E&&u.isPublic&&Number(h.totalVoters)>0,R=E&&u.multipleChoice,T=b?Math.max(...b.map((e=>e.votersCount))):M,N=b?b.reduce(((e,t)=>(t.isCorrect&&e.push(t.option),e)),[]):[],B=u.answers.map((e=>({label:e.text,value:e.option,hidden:Boolean(u.quiz&&u.closePeriod&&P<=0)})));(0,o.d4)((()=>{m&&t.results.results&&t.results.results.some((e=>e.isChosen))&&g(!1)}),[m,t.results.results]),(0,o.d4)((()=>{P>0&&setTimeout((()=>C(P-1)),1e3);const e=w.current;if(e){const t=12*Math.PI,s=e.lastElementChild,a=e.firstElementChild;if(P<=5&&e.classList.add("hurry-up"),s&&a){const e=(u.closePeriod-P)/u.closePeriod*t;a.textContent=(0,A.k9)(P),s.firstElementChild.setAttribute("stroke-dashoffset",`-${e}`)}else e.innerHTML=`\n        <span>${(0,A.k9)(P)}</span>\n        <svg width="16px" height="16px">\n          <circle cx="8" cy="8" r="6" class="poll-countdown-progress" transform="rotate(-90, 8, 8)"\n            stroke-dasharray="${t} ${t}"\n            stroke-dashoffset="0"\n          />\n        </svg>`}}),[P,u.closePeriod]),(0,o.d4)((()=>{u.quiz&&(P<=0||S&&!u.closed)&&n({chatId:l,messageId:d})}),[l,P,S,n,d,u.closed,u.quiz]),(0,o.d4)((()=>{let e;return u.quiz&&!u.closed&&u.closePeriod&&u.closePeriod>0&&(e=window.setTimeout((()=>{n({chatId:l,messageId:d})}),1e3*u.closePeriod)),()=>{e&&window.clearTimeout(e)}}),[E,l,n,d,u.closePeriod,u.closed,u.quiz]);const x=(0,o.Ye)((()=>s?s.reduce(((e,t)=>{const s=a[t];return s&&e.push(s),e}),[]):[]),[a,s]),L=(0,o.I4)((e=>{f([e]),g(!0),Z(!0),r([e])}),[r]),O=(0,o.I4)((e=>{f(e)}),[]),U=(0,o.I4)((()=>{g(!0),Z(!0),r(p)}),[r,p]),F=(0,o.I4)((()=>{i({chatId:l,messageId:d})}),[l,d,i]),$=(0,o.I4)((()=>{v(!0)}),[]),Q=(0,o.I4)((()=>{v(!1),Z(!1)}),[]);(0,o.d4)((()=>{y&&S&&u.quiz&&h.results&&t.results.solution&&(h.results.find((e=>e.isChosen&&e.isCorrect))||v(!0))}),[S,y,h.results,u.quiz,t.results.solution]);const D=(0,fe.Z)();return o.ZP.createElement("div",{className:"Poll",dir:D.isRtl?"auto":"ltr"},I&&t.results.solution&&o.ZP.createElement(Es.Z,{message:(0,Ut.H)(t.results.solution,t.results.solutionEntities),duration:5e3,onDismiss:Q,containerId:"#middle-column-portals"}),o.ZP.createElement("div",{className:"poll-question"},(0,mt.Z)(u.question)),o.ZP.createElement("div",{className:"poll-type"},D(function(e){return void 0===e.isPublic?"Â ":e.quiz?e.isPublic?"QuizPoll":"AnonymousQuizPoll":e.closed?"FinalResults":e.isPublic?"PublicPoll":"AnonymousPoll"}(u)),x.length>0&&o.ZP.createElement("div",{className:"poll-recent-voters"},x.map((e=>o.ZP.createElement(Xt.Z,{size:"micro",user:e})))),P>0&&E&&o.ZP.createElement("div",{ref:w,className:"poll-countdown"}),u.quiz&&t.results.solution&&!E&&o.ZP.createElement(Ze.Z,{round:!0,size:"tiny",color:"translucent",className:"poll-quiz-help",disabled:I,onClick:$,ariaLabel:"Show Solution"},o.ZP.createElement("i",{className:"icon-lamp"}))),E&&o.ZP.createElement("div",{className:"poll-answers"},R?o.ZP.createElement(Ms,{options:B,onChange:O,disabled:e.isScheduled||m,loadingOptions:m?p:void 0,round:!0}):o.ZP.createElement(Ss.Z,{name:`poll-${d}`,options:B,onChange:L,disabled:e.isScheduled||m,loadingOption:m?p[0]:void 0})),!E&&o.ZP.createElement("div",{className:"poll-results"},u.answers.map((function(e){return o.ZP.createElement(Rs,{key:e.option,shouldAnimate:y,answer:e,voteResults:b,totalVoters:M,maxVotersCount:T,correctResults:N})}))),!k&&!R&&o.ZP.createElement("div",{className:"poll-voters-count"},function(e,t,s){return s?e(t?"Answer":"Vote",s,"i"):e(t?"Chat.Quiz.TotalVotesEmpty":"Chat.Poll.TotalVotesResultEmpty")}(D,u.quiz,h.totalVoters)),R&&o.ZP.createElement(Ze.Z,{isText:!0,disabled:0===p.length,size:"tiny",onClick:U},D("PollSubmitVotes")),k&&o.ZP.createElement(Ze.Z,{isText:!0,size:"tiny",onClick:F},D("PollViewResults")))})));var Ns=s(8035),Bs=s(88);const xs=(0,o.X$)((({message:e,observeIntersection:t,noAvatars:s,shouldAutoLoad:a,shouldAutoPlay:n,inPreview:r,lastSyncTime:i,onMediaClick:c,onCancelMediaTransfer:l})=>{const u=(0,d.s1)(e);let h=!1;if(u&&u.photo&&!u.video){const{width:t,height:s}=Qt(e);h=t===s}const m=(0,o.I4)((()=>{c()}),[c]);if(!u)return;const{siteName:g,url:p,displayUrl:f,title:I,description:v,photo:y,video:Z}=u,P=(y||Z)&&c&&!h,C=(0,Ns.Z)(v,170),w=(0,ne.Z)("WebPage",h&&"with-square-photo",!y&&!Z&&!r&&"without-media",Z&&"with-video");return o.ZP.createElement("div",{className:w,"data-initial":(g||f)[0],dir:"auto"},y&&!Z&&o.ZP.createElement(gs,{message:e,observeIntersection:t,noAvatars:s,shouldAutoLoad:a,size:h?"pictogram":"inline",nonInteractive:!P,onClick:P?m:void 0,onCancelUpload:l}),o.ZP.createElement("div",{className:"WebPage-text"},o.ZP.createElement(Bs.Z,{className:"site-name",url:p,text:g||f}),!r&&I&&o.ZP.createElement("p",{className:"site-title"},(0,mt.Z)(I)),C&&o.ZP.createElement("p",{className:"site-description"},(0,mt.Z)(C,["emoji","br"]))),!r&&Z&&o.ZP.createElement(Ps,{message:e,observeIntersection:t,noAvatars:s,shouldAutoLoad:a,shouldAutoPlay:n,lastSyncTime:i,onClick:P?m:void 0,onCancelUpload:l}))}));var As=s(9937);const Ls=(0,o.X$)((({message:e})=>{const t=(0,fe.Z)(),s=(0,d.eO)(e),{title:a,text:n,amount:r,currency:i,isTest:c,photoUrl:l}=s;return o.ZP.createElement("div",{className:"Invoice"},a&&o.ZP.createElement("p",{className:"title"},(0,mt.Z)(a)),n&&o.ZP.createElement("p",null,(0,mt.Z)(n,["emoji","br"])),o.ZP.createElement("div",{className:"description "+(l?"has-image":"")},l&&o.ZP.createElement("img",{className:"invoice-image",src:l,alt:""}),o.ZP.createElement("p",{className:"description-text"},(0,As.x)(r,i,t.code),c&&o.ZP.createElement("span",null,t("PaymentTestInvoice")))))}));function Os(e){return(0,o.X$)((0,a.c$)(((e,t)=>{const{message:s}=t;return{isInSelectMode:(0,i.CA)(e),isSelected:(0,i.vk)(e,s.id)}}),((e,t)=>(0,g.ei)(t,["toggleMessageSelection"])))((t=>{const{isInSelectMode:s,isSelected:a,message:n,toggleMessageSelection:r,dimensions:i}=t,c=(0,o.I4)((e=>{e.stopPropagation(),r({messageId:n.id,withShift:e&&e.shiftKey})}),[r,n]),d=(0,o.Ye)((()=>({...t,isInSelectMode:s,isSelected:a,dimensions:{...t.dimensions,x:0,y:0},onClick:s?void 0:t.onClick})),[t,s,a]);return o.ZP.createElement("div",{className:(0,ne.Z)("album-item-select-wrapper",a&&"is-selected"),style:i?`left: ${i.x}px; top: ${i.y}px;`:"",onClick:s?c:void 0},s&&o.ZP.createElement("div",{className:"message-select-control"},a&&o.ZP.createElement("i",{className:"icon-select"})),o.ZP.createElement(e,d))})))}const Us=Os(gs),Fs=Os(Ps),$s=(0,a.c$)((e=>({uploadsById:e.fileUploads.byMessageLocalId})),((e,t)=>(0,g.ei)(t,["cancelSendingMessage"])))((({album:e,observeIntersection:t,shouldAutoLoad:s,shouldAutoPlay:a,hasCustomAppendix:n,lastSyncTime:r,isOwn:i,albumLayout:c,onMediaClick:l,uploadsById:u,cancelSendingMessage:h})=>{const m=e.messages.length,g=(0,o.I4)((e=>{h({chatId:e.chatId,messageId:e.id})}),[h]),{width:p,height:f}=c.containerStyle;return o.ZP.createElement("div",{className:"Album",style:`width: ${p}px; height: ${f}px;`},e.messages.map((function(e,h){const{photo:p,video:f}=(0,d.qp)(e),I=u[e.previousLocalId||e.id],v=I?I.progress:void 0,{dimensions:y,sides:Z}=c.layout[h];if(p){const a=n&&(i?h===m-1:Boolean(8&Z&&4&Z));return o.ZP.createElement(Us,{id:`album-media-${e.id}`,message:e,observeIntersection:t,shouldAutoLoad:s,shouldAffectAppendix:a,uploadProgress:v,dimensions:y,onClick:l,onCancelUpload:g})}if(f)return o.ZP.createElement(Fs,{id:`album-media-${e.id}`,message:e,observeIntersection:t,shouldAutoLoad:s,shouldAutoPlay:a,uploadProgress:v,lastSyncTime:r,dimensions:y,onClick:l,onCancelUpload:g})})))}));function Qs(){return(Qs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}let Ds;const qs=({message:e,observeIntersection:t,shouldAutoLoad:s,shouldAutoPlay:a,lastSyncTime:n})=>{const r=(0,o.sO)(null),i=(0,o.sO)(null),c=(0,o.sO)(null),l=e.content.video,u=(0,xt.Op)(r,t),[h,m]=(0,o.eJ)(s&&a),g=Boolean(h&&u&&n),{mediaData:p,downloadProgress:f}=(0,cs.Z)((0,d.Ti)(e,"inline"),!g,(0,d.kG)(e,"inline"),n),I=ls(e,p),{isBuffered:v,bufferingHandlers:Z}=(0,ps.Z)(),P=h&&!v,C=!1===(0,us.Z)(h),{shouldRender:w,transitionClassNames:b}=(0,re.Z)(P||!v,void 0,C),{shouldRenderThumb:M,transitionClassNames:S}=(0,as.Z)(p,"slow"),[E,k]=(0,o.eJ)(!1),[R,T]=(0,o.eJ)(0);(0,o.d4)((()=>{if(!E)return;const e=188*Math.PI,t=e-R*e,s=c.current,a=i.current,n=a.firstElementChild;n?n.firstElementChild.setAttribute("stroke-dashoffset",t.toString()):a.innerHTML=`<svg width="200px" height="200px">\n          <circle cx="100" cy="100" r="94" class="progress-circle" transform="rotate(-90, 100, 100)"\n            stroke-dasharray="${e} ${e}"\n            stroke-dashoffset="${e}"\n          />\n        </svg>`,T(s.currentTime/s.duration)}),[E,R]);const N=Boolean(p&&u),B=()=>{k(!1),T(0),(0,fs.Z)(c.current),(0,y.T2)((()=>{i.current.innerHTML=""}))},x=(L=B,()=>{Ds&&Ds(),Ds=L});var L;(0,o.d4)((()=>{c.current&&(N?(0,fs.Z)(c.current):c.current.pause())}),[N]),Is(c,N),ys(c,Boolean(p)),(0,vs.Z)(c,[p]);const O=(0,o.I4)((()=>{if(!p)return void m((e=>!e));const e=c.current;E?e.paused?(0,fs.Z)(e):e.pause():(x(),e.pause(),e.currentTime=0,(0,fs.Z)(e),k(!0))}),[x,E,p]),U=(0,o.I4)((e=>{const t=e.currentTarget;T(t.currentTime/t.duration)}),[]),F=(0,ne.Z)("full-media",S);return o.ZP.createElement("div",{ref:r,className:"RoundVideo media-inner",onClick:O},(M||p)&&o.ZP.createElement("div",{className:"thumbnail-wrapper"},o.ZP.createElement("canvas",{ref:I,className:"thumbnail",style:`width: ${ht.vw}px; height: ${ht.vw}px`})),p&&o.ZP.createElement("div",{className:"video-wrapper"},o.ZP.createElement("video",Qs({ref:c,className:F,width:ht.vw,height:ht.vw,autoPlay:!0,muted:!E,loop:!E,playsInline:!0,onEnded:E?B:void 0},Z,{onTimeUpdate:E?U:void 0}),o.ZP.createElement("source",{src:p}))),o.ZP.createElement("div",{className:"progress",ref:i}),w&&o.ZP.createElement("div",{className:`media-loading ${b}`},o.ZP.createElement(ms.Z,{progress:f})),!p&&!h&&o.ZP.createElement("i",{className:"icon-large-play"}),o.ZP.createElement("div",{className:"message-media-duration"},E?(0,A.k9)(c.current.currentTime):(0,A.k9)(l.duration),(!E||c.current.paused)&&o.ZP.createElement("i",{className:"icon-muted-chat"})))},Gs=({message:e,onClick:t})=>{const s=(0,fe.Z)();return o.ZP.createElement("div",{className:"InlineButtons"},e.inlineButtons.map((e=>o.ZP.createElement("div",{className:"row"},e.map((e=>o.ZP.createElement(Ze.Z,{size:"tiny",ripple:!0,disabled:"NOT_SUPPORTED"===e.type,onClick:()=>t({button:e})},(0,mt.Z)(s(e.text)),"buy"===e.type&&o.ZP.createElement("i",{className:"icon-card"}),"url"===e.type&&!e.value.match(n.FS)&&o.ZP.createElement("i",{className:"icon-arrow-right"}))))))))},Hs=(0,o.X$)((0,a.c$)(((e,{message:t})=>{const{threadId:s,chatId:a}=t.threadInfo,n=(0,i.tZ)(e,a,s)||t.threadInfo,o=(0,i.Cm)(e,a,s),{byId:r}=e.users,{byId:c}=e.chats;return{threadInfo:n,usersById:r,chatsById:c,shouldRequestThreadUpdate:!!o&&!n.topMessageId}}),((e,t)=>(0,g.ei)(t,["openChat","requestThreadInfoUpdate"])))((({disabled:e,threadInfo:t,usersById:s,chatsById:a,shouldRequestThreadUpdate:n,openChat:r,requestThreadInfoUpdate:i})=>{const c=(0,fe.Z)(),{threadId:l,chatId:u,messagesCount:h,lastMessageId:m,lastReadInboxMessageId:g,recentReplierIds:p}=t,f=(0,o.I4)((()=>{r({id:u,threadId:l})}),[r,u,l]);if((0,o.d4)((()=>{n&&i({chatId:u,threadId:l})}),[u,i,n,l]),void 0===h)return;const I=p&&p.map((e=>(0,d.YA)(e)?s[e]:a[e])).filter(Boolean),v=Boolean(g&&m&&g<m);return o.ZP.createElement("div",{"data-cnt":(0,it.bi)(h),className:(0,ne.Z)("CommentButton",v&&"has-unread",e&&"disabled"),dir:c.isRtl?"rtl":"ltr",onClick:f},o.ZP.createElement("i",{className:"icon-comments-sticker"}),(!I||0===I.length)&&o.ZP.createElement("i",{className:"icon-comments"}),I&&I.length>0&&o.ZP.createElement("div",{className:"recent-repliers",dir:c.isRtl?"rtl":"ltr"},I.map((e=>o.ZP.createElement(Xt.Z,{key:e.id,size:"small",user:(0,d.YA)(e.id)?e:void 0,chat:(0,d.YA)(e.id)?void 0:e})))),o.ZP.createElement("div",{className:"label",dir:"auto"},h?c("Comments",h,"i"):c("LeaveAComment")),o.ZP.createElement("i",{className:"icon-next"}))}))),js="data-is-document-group-hover";function _s(e){const t=Xs(e.currentTarget);t&&t.setAttribute(js,"")}function Vs(e){const t=Xs(e.currentTarget);t&&t.removeAttribute(js)}function Xs(e){let t=e;do{t=t.nextElementSibling}while(t&&!t.classList.contains("last-in-document-group"));return t}const Ks=(0,o.X$)((0,a.c$)(((e,t)=>{const{focusedMessage:s,forwardMessages:a,lastSyncTime:n}=e,{message:o,album:r,withSenderName:c,withAvatar:l,threadId:u,messageListType:h}=t,{id:m,chatId:g,viaBotId:p,replyToMessageId:f,isOutgoing:I}=o,v=(0,i.Z1)(e,g),y=(0,i.FM)(e,g),Z=v&&(0,d.eA)(v),P=v&&v.username,C=!y&&(0,d.Ul)(o),w=c||l||C?(0,i.Ur)(e,o):void 0,b=(0,i.cv)(e,o),M=p?(0,i.dy)(e,p):void 0,S=u?(0,i.qS)(e,g,u):void 0,E=o.id===S,k=f===S,R=f&&!k?(0,i.hj)(e,g,f):void 0,T=R&&(0,i.Ur)(e,R),N=(0,i.uZ)(e,o),B="thread"===h&&(r?r.messages.some((t=>(0,i._X)(e,t))):(0,i._X)(e,o)),{direction:x,noHighlight:A,isResizingContainer:L}=B&&s||{},O=a.messageIds&&a.messageIds.includes(m),{query:U}=(0,i.n5)(e)||{},F=(0,d._O)(o);let $;return $=r&&r.messages?r.messages.every((({id:t})=>(0,i.vk)(e,t))):(0,i.vk)(e,m),{theme:(0,i.Pu)(e),chatUsername:P,forceSenderName:C,sender:w,originSender:b,botSender:M,shouldHideReply:k,isThreadTop:E,replyMessage:R,replyMessageSender:T,isFocused:B,isForwarding:O,isChatWithSelf:y,isChannel:Z,lastSyncTime:n,highlight:U,isSingleEmoji:Boolean(F),animatedEmoji:F?(0,i.zB)(e,F):void 0,isInSelectMode:(0,i.CA)(e),isSelected:$,isGroupSelected:!!o.groupedId&&!o.isInAlbum&&(0,i.a6)(e,g,o.groupedId),threadId:u,isPinnedList:"pinned"===h,shouldAutoLoadMedia:v?(0,i.TD)(e,o,v,w):void 0,shouldAutoPlayMedia:(0,i.pv)(e,o),shouldLoopStickers:(0,i.yB)(e),...I&&{outgoingStatus:(0,i.dT)(e,o,"scheduled"===h)},..."number"==typeof N&&{uploadProgress:N},...B&&{focusDirection:x,noFocusHighlight:A,isResizingContainer:L}}}),((e,t)=>(0,g.ei)(t,["focusMessage","openMediaViewer","openAudioPlayer","cancelSendingMessage","openUserInfo","openChat","markMessagesRead","sendPollVote","toggleMessageSelection","setReplyingToId","openForwardMenu","clickInlineButton","disableContextMenuHint","showNotification"])))((({message:e,chatUsername:t,observeIntersectionForBottom:s,observeIntersectionForMedia:a,observeIntersectionForAnimatedStickers:n,album:r,noAvatars:i,withAvatar:c,withSenderName:l,noComments:g,appearanceOrder:p,isFirstInGroup:f,isLastInGroup:I,isFirstInDocumentGroup:v,isLastInDocumentGroup:y,isLastInList:Z,theme:P,forceSenderName:C,sender:w,originSender:b,botSender:M,isThreadTop:S,shouldHideReply:E,replyMessage:k,replyMessageSender:R,outgoingStatus:T,uploadProgress:N,isFocused:B,focusDirection:x,noFocusHighlight:A,isResizingContainer:L,isForwarding:O,isChatWithSelf:U,isChannel:F,lastSyncTime:$,highlight:Q,animatedEmoji:D,isInSelectMode:q,isSelected:G,isGroupSelected:H,threadId:j,messageListType:_,isPinnedList:V,shouldAutoLoadMedia:X,shouldAutoPlayMedia:K,shouldLoopStickers:W,focusMessage:z,openMediaViewer:Y,openAudioPlayer:J,openUserInfo:ee,openChat:te,cancelSendingMessage:se,markMessagesRead:ae,sendPollVote:oe,toggleMessageSelection:ie,setReplyingToId:ce,openForwardMenu:de,clickInlineButton:le,disableContextMenuHint:ue,showNotification:he})=>{const me=(0,o.sO)(null),ge=(0,o.sO)(null),Ie=(0,o.sO)(null),ve=(0,fe.Z)();(0,xt._N)(ge,s);const{isContextMenuOpen:ye,contextMenuPosition:Pe,handleBeforeContextMenu:Ce,handleContextMenu:we,handleContextMenuClose:be,handleContextMenuHide:Me}=(0,Ot.Z)(me,m.$b&&q,!0,m.wZ);(0,o.d4)((()=>{ye&&ue()}),[ye,ue]);const Se=p<=0,[Ee,ke]=(0,pe.Z)(Se);(0,o.d4)((()=>{Se||setTimeout(ke,10*p)}),[p,ke,Se]);const{transitionClassNames:Re}=(0,re.Z)(Ee,void 0,Se,!1),{chatId:Te,id:Ne,threadInfo:Be}=e,xe=(0,d.CI)(e),Ae=(0,d.B4)(e),Le="scheduled"===_||e.isScheduled,Oe=(0,d.ss)(e)&&!E,Ue=Boolean(Be)&&"thread"===_,{forwardInfo:Fe,viaBotId:$e}=e,Qe=Fe&&!U&&!Fe.isLinkedChannelPost,De=!!e.groupedId&&!e.isInAlbum,qe=Boolean(r)&&r.messages.length>1,{text:Ge,photo:He,video:je,audio:_e,voice:Ve,document:Xe,sticker:Ke,contact:We,poll:ze,webPage:Ye,invoice:et}=(0,d.qp)(e),tt=(0,d.$D)(e),st=(0,Ut.X)(e,Q,Ft(tt)),at=void 0!==Pe,nt=F&&e.adminTitle||Fe&&!Qe&&Fe.adminTitle||void 0,rt=(0,o.Ye)((()=>nt?_t(nt):void 0),[nt]),it=!(at||q||O)&&(!De||y),ct=F&&!Le,dt=Boolean(V||Fe&&(Fe.isChannelPost||U&&!Ae)&&Fe.fromMessageId),lt=!Fe||!U&&w?w:b,ut=Fe?b:w,gt=(0,ne.Z)("Message message-list-item",f&&"first-in-group",I&&"last-in-group",v&&"first-in-document-group",y&&"last-in-document-group",Z&&"last-in-list",Ae&&"own",Boolean(e.views)&&"has-views",e.isEdited&&"was-edited",Oe&&"has-reply",at&&"has-menu-open",B&&!A&&"focused",O&&"is-forwarding",e.isDeleting&&"is-deleting",De&&"is-in-document-group",qe&&"is-album",e.hasUnreadMention&&"has-unread-mention",G&&"is-selected",q&&"is-in-selection-mode",S&&"is-thread-top",Boolean(e.inlineButtons)&&"has-inline-buttons",Re),pt=function(e,{hasReply:t,customShape:s,isLastInGroup:a,asForwarded:n,hasThread:o,forceSenderName:r,hasComments:i,hasActionButton:c}={}){const{text:l,photo:u,video:h,audio:m,voice:g,document:p,poll:f,webPage:I,contact:v}=(0,d.qp)(e),y=["message-content"],Z=u||h,P=Z&&!l,C=Boolean(e.viaBotId);return Ft(s)?y.push(`emoji-only emoji-only-${s}`):l&&y.push("text"),c&&y.push("has-action-button"),s&&(y.push("custom-shape"),h&&h.isRound&&y.push("round"),i&&y.push("has-comments")),u||h?y.push("media"):m?y.push("audio"):g?y.push("voice"):p?y.push("document"):v?y.push("contact"):f?y.push("poll"):I&&(y.push("web-page"),(I.photo||I.video)&&y.push("media")),n&&!s&&y.push("is-forwarded"),t&&y.push("is-reply"),o&&y.push("has-replies"),C&&y.push("is-via-bot"),r&&y.push("force-sender-name"),s||(y.push("has-shadow"),Z&&i&&y.push("has-background"),(t||n||!P||C||r)&&y.push("has-solid-background"),!a||!u&&P||y.push("has-appendix")),y.join(" ")}(e,{hasReply:Oe,customShape:tt,isLastInGroup:I,asForwarded:Qe,hasThread:Ue,forceSenderName:C,hasComments:e.threadInfo&&e.threadInfo.messagesCount>0,hasActionButton:ct||dt}),ft=e.threadInfo&&(!De||y)&&"thread"===_&&!g,It=pt.includes("has-appendix");(0,ot.Z)(Te,Oe?e.replyToMessageId:void 0,k,e.id),Vt(me,Te,B,x,A,L),(0,o.bt)((()=>{Ie.current&&(Ie.current.innerHTML=Ae?'<svg width="9" height="20" xmlns="http://www.w3.org/2000/svg"><defs><filter x="-50%" y="-14.7%" width="200%" height="141.2%" filterUnits="objectBoundingBox" id="a"><feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0" in="shadowBlurOuter1"/></filter></defs><g fill="none" fill-rule="evenodd"><path d="M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z" fill="#000" filter="url(#a)"/><path d="M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z" fill="#EEFFDE" class="corner"/></g></svg>':'<svg width="9" height="20" xmlns="http://www.w3.org/2000/svg"><defs><filter x="-50%" y="-14.7%" width="200%" height="141.2%" filterUnits="objectBoundingBox" id="a"><feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0" in="shadowBlurOuter1"/></filter></defs><g fill="none" fill-rule="evenodd"><path d="M3 17h6V0c-.193 2.84-.876 5.767-2.05 8.782-.904 2.325-2.446 4.485-4.625 6.48A1 1 0 003 17z" fill="#000" filter="url(#a)"/><path d="M3 17h6V0c-.193 2.84-.876 5.767-2.05 8.782-.904 2.325-2.446 4.485-4.625 6.48A1 1 0 003 17z" fill="#FFF" class="corner"/></g></svg>')}),[Ae,It]);const vt=(0,o.I4)((t=>{t.stopPropagation(),ie({messageId:Ne,groupedId:e.groupedId})}),[Ne,e.groupedId,ie]),yt=(0,o.I4)((e=>{if(xe)return;const t=qe&&r&&r.messages?{messageId:Ne,childMessageIds:r.messages.map((({id:e})=>e)),withShift:e&&e.shiftKey}:{messageId:Ne,withShift:e&&e.shiftKey};ie(t)}),[xe,qe,r,Ne,ie]),Zt=(0,o.I4)((()=>{ce({messageId:Ne})}),[ce,Ne]),Pt=(0,o.I4)((e=>{e.stopPropagation()}),[]),Ct=(0,o.I4)((()=>{lt&&((0,d.YA)(lt.id)?ee({id:lt.id}):te({id:lt.id}))}),[lt,ee,te]),wt=(0,o.I4)((()=>{ut?(0,d.YA)(ut.id)?ee({id:ut.id}):te({id:ut.id}):he({message:ve("HidAccount")})}),[ut,he,ve,ee,te]),bt=(0,o.I4)((()=>{M&&ee({id:M.id})}),[M,ee]),Mt=(0,o.I4)((()=>{z({chatId:Te,threadId:j,messageId:e.replyToMessageId,replyMessageId:Ne})}),[z,Te,j,e.replyToMessageId,Ne]),St=(0,o.I4)((()=>{Y({chatId:Te,threadId:j,messageId:Ne,origin:Le?h.bZ.ScheduledInline:h.bZ.Inline})}),[Te,j,Ne,Y,Le]),Et=(0,o.I4)((()=>{J({chatId:Te,messageId:Ne})}),[Te,Ne,J]),kt=(0,o.I4)((e=>{Y({chatId:Te,threadId:j,messageId:e,origin:Le?h.bZ.ScheduledAlbum:h.bZ.Album})}),[Te,j,Y,Le]),Rt=(0,o.I4)((e=>{const t=e.target;(t.classList.contains("text-content")||t.classList.contains("Message"))&&(m.wZ&&Je.Z.getIsKeyboardVisible()?setTimeout((()=>{we(e)}),350):we(e))}),[we]),Nt=(0,o.I4)((e=>{m.wZ?yt(e):we(e)}),[we,yt]),Bt=(0,o.I4)((()=>{ae({messageIds:[Ne]})}),[Ne,ae]),At=(0,o.I4)((()=>{se({chatId:Te,messageId:Ne})}),[se,Te,Ne]),Lt=(0,o.I4)((e=>{oe({chatId:Te,messageId:Ne,options:e})}),[Te,Ne,oe]),Dt=(0,o.I4)((()=>{de({fromChatId:Te,groupedId:e.groupedId})}),[de,Te,e.groupedId]),qt=(0,o.I4)((()=>{if(r&&r.messages){const e=r.messages.map((({id:e})=>e));de({fromChatId:Te,messageIds:e})}else de({fromChatId:Te,messageIds:[Ne]})}),[r,de,Te,Ne]),Gt=(0,o.I4)((()=>{z({chatId:Te,threadId:u._f,messageId:Ne})}),[z,Te,Ne]),jt=(0,o.I4)((()=>{z(De?{chatId:Fe.fromChatId,groupedId:e.groupedId,groupedChatId:Te}:{chatId:Fe.fromChatId,messageId:Fe.fromMessageId})}),[z,Fe,e,Te,De]);let Kt,zt="",ts=!1;const as=(0,o.Ye)((()=>qe?Ht(Ae,Boolean(Qe),Boolean(i),r):void 0),[qe,Ae,Qe,i,r]),ns=Qe?28:0;if(qe||!He&&!je)as&&(Kt=Math.max($t(Boolean(Ge),ft),as.containerStyle.width),Kt-as.containerStyle.width>18&&(ts=!0));else{let t;He?t=Qt(e,i).width:je&&(t=je.isRound?ht.vw:Qt(e,i).width),t&&(Kt=Math.max($t(Boolean(Ge),ft),t),Kt-t>18&&(ts=!0))}return Kt&&(zt=`width: ${Kt+ns}px`),o.ZP.createElement("div",{ref:me,id:`message${Ne}`,className:gt,style:rt?`--meta-safe-author-width: ${rt}px`:void 0,"data-message-id":Ne,onClick:q?yt:m.wZ?Rt:void 0,onDoubleClick:q?void 0:Zt,onMouseDown:q?void 0:e=>{Tt(e),xe||Ce(e)},onContextMenu:q||xe?void 0:Nt,onMouseEnter:De&&!y?_s:void 0,onMouseLeave:De&&!y?Vs:void 0},o.ZP.createElement("div",{ref:ge,className:"bottom-marker","data-message-id":Ne,"data-last-message-id":r?r.messages[r.messages.length-1].id:void 0,"data-has-unread-mention":e.hasUnreadMention}),!xe&&!De&&o.ZP.createElement("div",{className:"message-select-control"},G&&o.ZP.createElement("i",{className:"icon-select"})),!xe&&y&&o.ZP.createElement("div",{className:(0,ne.Z)("message-select-control group-select",H&&"is-selected"),onClick:vt},H&&o.ZP.createElement("i",{className:"icon-select"})),c&&function(){const e=lt&&(0,d.YA)(lt.id),t=lt&&e?lt:void 0,s=lt&&!e?lt:void 0,a=!lt&&Fe?Fe.hiddenUserName:void 0;return o.ZP.createElement(Xt.Z,{size:"small",user:t,chat:s,text:a,lastSyncTime:$,onClick:t||s?Ct:void 0})}(),o.ZP.createElement("div",{className:(0,ne.Z)("message-content-wrapper",pt.includes("text")&&"can-select-text"),onClick:q&&De?yt:void 0},o.ZP.createElement("div",{className:pt,style:zt,dir:"auto"},Qe&&!tt&&(!De||v)&&o.ZP.createElement("div",{className:"message-title"},ve("ForwardedMessage")),function(){const t=(0,ne.Z)("content-inner",Qe&&!tt&&"forwarded-message",Oe&&"reply-message",ts&&"no-media-corners"),s=I&&!st&&!Qe&&!Ue,c=!Ye&&!D&&st,u=(0,ne.Z)("text-content",c&&"with-meta",T&&"with-outgoing-icon");return o.ZP.createElement("div",{className:t,onDoubleClick:Pt,dir:"auto"},function(){if(tt&&!$e||!(l&&!He&&!je||Qe||$e||C)||De&&!v)return;let t,s;return!ut||tt&&$e?Fe&&Fe.hiddenUserName&&(t=Fe.hiddenUserName):(t=(0,d.OU)(ve,ut),Qe||(s=`color-${(0,d.Rs)(ut)}`)),o.ZP.createElement("div",{className:"message-title",dir:"ltr"},t?o.ZP.createElement("span",{className:(0,ne.Z)("interactive",s),onClick:wt,dir:"auto"},(0,mt.Z)(t)):M?void 0:"Â ",M&&o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement("span",{className:"via"},ve("ViaBot")),o.ZP.createElement("span",{className:"interactive",onClick:bt},(0,mt.Z)(`@${M.username}`))),Fe&&Fe.isLinkedChannelPost?o.ZP.createElement("span",{className:"admin-title",dir:"auto"},ve("DiscussChannel")):e.adminTitle&&!F?o.ZP.createElement("span",{className:"admin-title",dir:"auto"},e.adminTitle):void 0)}(),Oe&&o.ZP.createElement(Yt,{message:k,sender:R,observeIntersection:a,onClick:Mt}),Ke&&o.ZP.createElement(rs,{message:e,observeIntersection:a,observeIntersectionForPlaying:n,shouldLoop:W,lastSyncTime:$}),D&&o.ZP.createElement(is.Z,{size:"small",sticker:D,observeIntersection:a,lastSyncTime:$,forceLoadPreview:xe}),qe&&o.ZP.createElement($s,{album:r,albumLayout:as,observeIntersection:a,shouldAutoLoad:X,shouldAutoPlay:K,isOwn:Ae,hasCustomAppendix:s,lastSyncTime:$,onMediaClick:kt}),!qe&&He&&o.ZP.createElement(gs,{message:e,observeIntersection:a,noAvatars:i,shouldAutoLoad:X,uploadProgress:N,shouldAffectAppendix:s,onClick:St,onCancelUpload:At}),!qe&&je&&je.isRound&&o.ZP.createElement(qs,{message:e,observeIntersection:a,shouldAutoLoad:X,shouldAutoPlay:K,lastSyncTime:$}),!qe&&je&&!je.isRound&&o.ZP.createElement(Ps,{message:e,observeIntersection:a,noAvatars:i,shouldAutoLoad:X,shouldAutoPlay:K,uploadProgress:N,lastSyncTime:$,onClick:St,onCancelUpload:At}),(_e||Ve)&&o.ZP.createElement(es.Z,{theme:P,message:e,uploadProgress:N,lastSyncTime:$,isSelectable:De,isSelected:G,onPlay:Et,onReadMedia:!Ve||Ae&&!U?void 0:Bt,onCancelUpload:At}),Xe&&o.ZP.createElement(Jt.Z,{message:e,observeIntersection:a,uploadProgress:N,isSelectable:De,isSelected:G,onMediaClick:St,onCancelUpload:At}),We&&o.ZP.createElement(ws,{contact:We}),ze&&o.ZP.createElement(Ts,{message:e,poll:ze,onSendVote:Lt}),!D&&st&&o.ZP.createElement("p",{className:u,dir:"auto"},st,c&&o.ZP.createElement(ss,{message:e,outgoingStatus:T,signature:nt,onClick:yt})),Ye&&o.ZP.createElement(xs,{message:e,observeIntersection:a,noAvatars:i,shouldAutoLoad:X,shouldAutoPlay:K,lastSyncTime:$,onMediaClick:St,onCancelMediaTransfer:At}),et&&o.ZP.createElement(Ls,{message:e}))}(),(!De||y)&&!(!Ye&&!D&&st)&&o.ZP.createElement(ss,{message:e,outgoingStatus:T,signature:nt,onClick:yt}),it&&ct?o.ZP.createElement(Ze.Z,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:ve("lng_context_forward_msg"),onClick:y?Dt:qt},o.ZP.createElement("i",{className:"icon-share-filled"})):it&&dt?o.ZP.createElement(Ze.Z,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:"Focus message",onClick:V?Gt:jt},o.ZP.createElement("i",{className:"icon-arrow-right"})):void 0,ft&&o.ZP.createElement(Hs,{message:e,disabled:g}),It&&o.ZP.createElement("div",{className:"svg-appendix",ref:Ie})),e.inlineButtons&&o.ZP.createElement(Gs,{message:e,onClick:le})),Pe&&o.ZP.createElement(Wt,{isOpen:ye,anchor:Pe,message:e,album:r,chatUsername:t,messageListType:_,onClose:be,onCloseAnimationEnd:Me}))}))),Ws=(0,o.X$)((({messageIds:e,messageGroups:t,isViewportNewest:s,isUnread:r,withUsers:i,noAvatars:c,containerRef:l,anchorIdRef:u,memoUnreadDividerBeforeIdRef:m,memoFirstUnreadIdRef:p,threadId:f,type:I,threadTopMessageId:v,hasLinkedChat:Z,isSchedule:P,noAppearanceAnimation:C,onFabToggle:w,onNotchToggle:b,openHistoryCalendar:M})=>{const{observeIntersectionForMedia:S,observeIntersectionForReading:E,observeIntersectionForAnimatedStickers:k}=function(e,t,s){const{markMessageListRead:n,markMessagesRead:o}=(0,a.uC)(),{observe:r}=(0,xt.S1)({rootRef:t,throttleMs:At,margin:Lt}),{observe:i,freeze:c,unfreeze:d}=(0,xt.S1)({rootRef:t,throttleMs:150},(t=>{if("thread"!==e)return;let a=0;const r=[];t.forEach((e=>{const{isIntersecting:t,target:s}=e;if(!t)return;const{dataset:n}=s,o=Number(n.lastMessageId||n.messageId);o>a&&(a=o),n.hasUnreadMention&&r.push(o)})),s.current&&a>=s.current&&n({maxId:a}),r.length&&o({messageIds:r})}));(0,ie.Z)(c,d);const{observe:l}=(0,xt.S1)({rootRef:t,throttleMs:At});return{observeIntersectionForMedia:r,observeIntersectionForReading:i,observeIntersectionForAnimatedStickers:l}}(I,l,p),{backwardsTriggerRef:R,forwardsTriggerRef:T,fabTriggerRef:N}=function(e,t,s,r,i,c,d){const{loadViewportMessages:l}=(0,a.uC)(),[u,m]=(0,o.Ye)((()=>"thread"===e?[(0,y.Ds)((()=>l({direction:h.Uq.Backwards})),1e3,!0,!1),(0,y.Ds)((()=>l({direction:h.Uq.Forwards})),1e3,!0,!1)]:[]),[l,s]),g=(0,o.sO)(null),p=(0,o.sO)(null),f=(0,o.sO)(null),I=(0,o.I4)((()=>{if(!s||!s.length)return c(!1),void d(!1);if(!r)return c(!0),void d(!0);const{offsetHeight:e,scrollHeight:a,scrollTop:n}=t.current,o=a-n-e,l=o<=0;c(i?!l:!(o<=50)),d(!l)}),[s,r,t,c,i,d]),{observe:v}=(0,xt.S1)({rootRef:t,margin:n.gZ},(e=>{if(!m||!u)return;const s=e.find((({isIntersecting:e})=>e));if(!s)return;const{target:a}=s;"backwards-trigger"===a.className?((0,Nt.Z)(t.current),u()):"forwards-trigger"===a.className&&((0,Nt.Z)(t.current),m())}));(0,xt._N)(g,v),(0,xt._N)(p,v);const{observe:Z,freeze:P,unfreeze:C}=(0,xt.S1)({rootRef:t,margin:50},I);(0,xt._N)(f,Z);const{observe:w,freeze:b,unfreeze:M}=(0,xt.S1)({rootRef:t},I);return(0,xt._N)(f,w),(0,de.Z)((()=>{P(),b(),setTimeout((()=>{M(),C()}),100)}),[s]),{backwardsTriggerRef:g,forwardsTriggerRef:p,fabTriggerRef:f}}(I,l,e,s,r,w,b),B=(0,fe.Z)(),x=o.ZP.createElement("div",{className:(0,ne.Z)("unread-divider","local-action-message"),key:"unread-messages"},o.ZP.createElement("span",null,B("UnreadMessages"))),L=C?0:t.reduce(((e,t)=>e+(0,g.xH)(t.senderGroups).length),0);let O=0;const U=t.map(((e,t,s)=>{const a=e.senderGroups.map(((e,a,n)=>{if(1===e.length&&!kt(e[0])&&(0,d.Lo)(e[0])){const r=e[0],i=a===n.length-1&&t===s.length-1;return(0,g.oA)([r.id===m.current&&x,o.ZP.createElement(zt,{key:r.id,message:r,observeIntersection:E,appearanceOrder:L-++O,isLastInList:i})])}let r;return(0,g.xH)(e.map(((l,h)=>{const p=kt(l)?l.mainMessage:l,y=kt(l)?l:void 0,P=(0,d.B4)(p),C=kt(l),w=e[h+1];p.previousLocalId&&u.current===`message${p.previousLocalId}`&&(u.current=`message${p.id}`);const b=!C&&p.groupedId?p.groupedId:void 0,M=w&&!kt(w)?w.groupedId:void 0,R={isFirstInGroup:0===h,isLastInGroup:h===e.length-1,isFirstInDocumentGroup:Boolean(b&&b!==r),isLastInDocumentGroup:Boolean(b&&b!==M),isLastInList:h===e.length-1&&a===n.length-1&&t===s.length-1};r=b;const T=(0,d.KK)(p),N="scheduled"!==I?T:`${p.date}_${T}`;return(0,g.oA)([p.id===m.current&&x,o.ZP.createElement(Ks,{key:N,message:p,observeIntersectionForBottom:E,observeIntersectionForMedia:S,observeIntersectionForAnimatedStickers:k,album:y,noAvatars:c,withAvatar:R.isLastInGroup&&i&&!P&&!(p.id===v),withSenderName:R.isFirstInGroup&&i&&!P,threadId:f,messageListType:I,noComments:!1===Z,appearanceOrder:L-++O,isFirstInGroup:R.isFirstInGroup,isLastInGroup:R.isLastInGroup,isFirstInDocumentGroup:R.isFirstInDocumentGroup,isLastInDocumentGroup:R.isLastInDocumentGroup,isLastInList:R.isLastInList}),p.id===v&&o.ZP.createElement("div",{className:"local-action-message",key:"discussion-started"},o.ZP.createElement("span",null,B("DiscussionStarted")))])})))}));return o.ZP.createElement("div",{className:"message-date-group",key:e.datetime,onMouseDown:Tt,teactFastList:!0},o.ZP.createElement("div",{className:(0,ne.Z)("sticky-date",!P&&"interactive"),key:"date-header",onMouseDown:Tt,onClick:P?void 0:()=>M({selectedAt:e.datetime})},o.ZP.createElement("span",{dir:"auto"},P&&e.originalDate===n.t4&&B("MessageScheduledUntilOnline"),P&&e.originalDate!==n.t4&&B("MessageScheduledOn",(0,A.j1)(B,e.datetime,void 0,!0)),!P&&(0,A.j1)(B,e.datetime))),(0,g.xH)(a))}));return o.ZP.createElement("div",{className:"messages-container",teactFastList:!0},o.ZP.createElement("div",{ref:R,key:"backwards-trigger",className:"backwards-trigger"}),(0,g.xH)(U),o.ZP.createElement("div",{ref:T,key:"forwards-trigger",className:"forwards-trigger"}),o.ZP.createElement("div",{ref:N,key:"fab-trigger",className:"fab-trigger"}))}));var zs=s(3547);const Ys=(0,o.X$)((0,a.c$)(((e,{userId:t})=>{const{stickers:s}=e.stickers.greeting,a=s&&s.length?s[t%s.length]:void 0,n=(0,i.Z1)(e,t);return n?{sticker:a,lastUnreadMessageId:n.lastMessage&&n.lastMessage.id!==n.lastReadInboxMessageId?n.lastMessage.id:void 0,connectionState:e.connectionState}:{}}),((e,t)=>(0,g.ei)(t,["loadGreetingStickers","sendMessage","markMessageListRead"])))((({sticker:e,connectionState:t,lastUnreadMessageId:s,loadGreetingStickers:a,sendMessage:n,markMessageListRead:r})=>{const i=(0,fe.Z)(),c=(0,o.sO)(null),{observe:d}=(0,xt.S1)({rootRef:c,debounceMs:200});(0,o.d4)((()=>{e||"connectionStateReady"!==t||a()}),[t,a,e]),(0,o.d4)((()=>{"connectionStateReady"===t&&s&&r({maxId:s})}),[t,r,s]);const l=(0,o.I4)((e=>{e={...e,isPreloadedGlobally:!0},n({sticker:e})}),[n]);return o.ZP.createElement("div",{className:"ContactGreeting",ref:c},o.ZP.createElement("div",{className:"wrapper"},o.ZP.createElement("p",{className:"title",dir:"auto"},i("Conversation.EmptyPlaceholder")),o.ZP.createElement("p",{className:"description",dir:"auto"},i("Conversation.GreetingText")),o.ZP.createElement("div",{className:"sticker"},e&&o.ZP.createElement(zs.Z,{sticker:e,onClick:l,clickArg:e,observeIntersection:d,size:160,className:"large"}))))}))),Js=(0,o.X$)((({isChatWithSelf:e,type:t,isGroupChatJustCreated:s})=>{const a=(0,fe.Z)();return"scheduled"===t?function(e){return o.ZP.createElement("div",{className:"empty"},o.ZP.createElement("span",null,e("ScheduledMessages.EmptyPlaceholder")))}(a):e?function(e){return o.ZP.createElement("div",{className:"NoMessages"},o.ZP.createElement("div",{className:"wrapper"},o.ZP.createElement("i",{className:"icon icon-cloud-download"}),o.ZP.createElement("h3",{className:"title"},e("Conversation.CloudStorageInfo.Title")),o.ZP.createElement("ul",{className:"description"},o.ZP.createElement("li",null,e("Conversation.ClousStorageInfo.Description1")),o.ZP.createElement("li",null,e("Conversation.ClousStorageInfo.Description2")),o.ZP.createElement("li",null,e("Conversation.ClousStorageInfo.Description3")),o.ZP.createElement("li",null,e("Conversation.ClousStorageInfo.Description4")))))}(a):s?function(e){return o.ZP.createElement("div",{className:"NoMessages"},o.ZP.createElement("div",{className:"wrapper",dir:e.isRtl?"rtl":void 0},o.ZP.createElement("h3",{className:"title"},e("EmptyGroupInfo.Title")),o.ZP.createElement("p",{className:"description"},e("EmptyGroupInfo.Subtitle")),o.ZP.createElement("ul",{className:"list-checkmarks"},o.ZP.createElement("li",null,e("EmptyGroupInfo.Line1")),o.ZP.createElement("li",null,e("EmptyGroupInfo.Line2")),o.ZP.createElement("li",null,e("EmptyGroupInfo.Line3")),o.ZP.createElement("li",null,e("EmptyGroupInfo.Line4")))))}(a):o.ZP.createElement("div",{className:"empty"},o.ZP.createElement("span",null,a("NoMessages")))})),ea=(0,y.Ds)((e=>e()),200,!1);function ta(e,t){return t&&1===t.length&&1===t[0].senderGroups.length&&1===t[0].senderGroups[0].length&&"content"in t[0].senderGroups[0][0]&&t[0].senderGroups[0][0].content.action&&t[0].senderGroups[0][0].content.action.type===e}const sa=(0,o.X$)((0,a.c$)(((e,{chatId:t,threadId:s,type:a})=>{const n=(0,i.Z1)(e,t);if(!n)return{};const o=(0,i.$W)(e,t,s,a),r="scheduled"===a?(0,i.Fn)(e,t):(0,i.Zw)(e,t),c=(0,i.qS)(e,t,s);if(s!==u._f&&!(r&&c&&r[c]))return{};const{isRestricted:l,restrictionReason:h,lastMessage:m}=n,g=(0,i.G$)(e,t),p=g?!e.focusedMessage.noHighlight:void 0,f=s===u._f&&!o&&!n.unreadCount&&!g&&m&&!m.groupedId,I=(0,i.IK)(e,t);let v;if((0,i.pk)(e,t)){const s=(0,i.IK)(e,t);v=s.fullInfo?s.fullInfo.botDescription||"NoMessages":"Updating bot info..."}return{isChatLoaded:!0,isRestricted:l,restrictionReason:h,isChannelChat:(0,d.eA)(n),isGroupChat:(0,d.Bf)(n),isCreator:n.isCreator,isChatWithSelf:(0,i.FM)(e,t),isBot:Boolean(I),messageIds:o,messagesById:r,firstUnreadId:(0,i.It)(e,t,s),isViewportNewest:"thread"!==a||(0,i.b9)(e,t,s),threadFirstMessageId:(0,i.yZ)(e,t,s),focusingId:g,hasFocusHighlight:p,isSelectModeActive:(0,i.CA)(e),botDescription:v,threadTopMessageId:c,hasLinkedChat:n.fullInfo&&"linkedChatId"in n.fullInfo?Boolean(n.fullInfo.linkedChatId):void 0,...f&&{lastMessage:m}}}),((e,t)=>(0,g.ei)(t,["loadViewportMessages","setScrollOffset","openHistoryCalendar"])))((({chatId:e,threadId:t,type:s,hasTools:r,onFabToggle:c,onNotchToggle:l,isChatLoaded:u,isChannelChat:m,isGroupChat:p,canPost:f,isReady:I,isChatWithSelf:v,isCreator:Z,isBot:P,messageIds:C,messagesById:w,firstUnreadId:b,isViewportNewest:M,threadFirstMessageId:S,isRestricted:E,restrictionReason:k,focusingId:R,hasFocusHighlight:T,isSelectModeActive:N,loadViewportMessages:B,setScrollOffset:x,lastMessage:A,botDescription:L,threadTopMessageId:O,hasLinkedChat:U,openHistoryCalendar:F})=>{const $=(0,o.sO)(null),Q=(0,o.sO)("thread"===s&&(0,i.Vt)((0,a.Rd)(),e,t)||0),D=(0,o.sO)(),q=(0,o.sO)(),G=(0,o.sO)(),H=(0,o.sO)(),j=(0,o.sO)(),_=(0,o.sO)(),V=(0,o.sO)(!1),X=(0,o.sO)(Boolean(A)),[K,W]=(0,o.eJ)(),z=Boolean(C);(0,de.Z)((()=>{z&&(0,y.R3)((()=>{X.current=!1}))}),[z]),(0,de.Z)((()=>{H.current=b}),[b]),(0,de.Z)((()=>{z&&(j.current=H.current)}),[z]),(0,de.Z)((()=>{_.current=R}),[R]);const Y=(0,o.Ye)((()=>{if(!C||!w)return;const e=!O||C[0]&&S!==C[0]?C:[O,...C];if(!e.length)return;const t=e.map((e=>w[e])).filter(Boolean);return Rt((0,g.Xo)(t,["date","id"]),j.current)}),[C,w,S,O]),J=(0,o.Ye)((()=>{if("thread"===s)return(0,y.Ds)((()=>B({direction:h.Uq.Around})),1e3,!0,!1)}),[B,C]),{isScrolled:ee,updateStickyDates:te}=function(){const[e,t]=(0,pe.Z)(!1),s=(0,o.Ye)((()=>(0,y.Ds)((e=>e()),1e3,!1,a)),[1e3,!1,a]);var a;return{isScrolled:e,updateStickyDates:(0,o.I4)(((e,a)=>{t(),document.body.classList.contains("is-scrolling-messages")||(0,y.T2)((()=>{document.body.classList.add("is-scrolling-messages")})),s((()=>{(0,y.T2)((()=>{const t=document.querySelector(".stuck");t&&t.classList.remove("stuck");const s=function(e,t){const s=e.querySelectorAll(".sticky-date"),a=e.scrollTop;return Array.from(s).find((e=>{const{offsetTop:s,offsetHeight:n}=e,o=s-a;return-n<=o&&o<=(t?60:10)}))}(e,a);s&&s.classList.add("stuck"),document.body.classList.remove("is-scrolling-messages")}))}))}),[t,s])}}(),se=(0,o.I4)((()=>{if(V.current)return void(V.current=!1);const a=$.current;_.current||te(a,r),ea((()=>{(0,y.T2)((()=>{a.parentElement&&(Q.current=a.scrollHeight-a.scrollTop,"thread"===s&&x({chatId:e,threadId:t,scrollOffset:Q.current}))}))}))}),[te,r,s,x,e,t]);(0,o.d4)((()=>{if(!("ResizeObserver"in window))return;const e=new ResizeObserver((([e])=>{e.target.offsetParent&&W(e.contentRect.height)}));return e.observe($.current),()=>{e.disconnect()}}),[]);const{height:oe}=et();(0,o.d4)((()=>{I&&($.current.dataset.normalHeight=String($.current.offsetHeight))}),[oe,I]),(0,o.d4)((()=>{if(!J||!u||E||R)return;const e=$.current;(!C||C.length<n.hT/2&&e.firstElementChild.clientHeight<=e.offsetHeight)&&J()}),[u,C,J,R,E]),(0,de.Z)((()=>{if(!C||!G.current||!I)return;const e=G.current.filter((e=>C.includes(Number(e.dataset.messageId)))),t=e[1]||e[0];t&&(D.current=t.id,q.current=t.getBoundingClientRect().top)}),[C,M,K,r,I]),(0,St.Z)((([e,t,s])=>{const a=$.current;if(G.current=Array.from(a.querySelectorAll(".message-list-item")),!a.offsetParent)return;const o=M&&C&&C.length<n.hT/2&&!a.parentElement.classList.contains("force-messages-scroll")&&a.firstElementChild.clientHeight<=2*a.offsetHeight;o&&(a.parentElement.classList.add("force-messages-scroll"),setTimeout((()=>{a.parentElement&&a.parentElement.classList.remove("force-messages-scroll")}),1e3));const{scrollTop:i,scrollHeight:c,offsetHeight:d}=a,l=Q.current,u=G.current[G.current.length-1],h=M&&t&&l-(s||d)<=20;let m;const g=C&&e&&C[0]!==e[0],p=C&&e&&C[C.length-1]!==e[e.length-1],f=C&&_.current===C[C.length-1];if(h&&p&&!g&&!f&&(u&&(0,y.T2)((()=>{(0,Bt.Z)(a,u,"end",20,void 0,void 0,void 0,!0)})),m=c-d,Q.current=Math.max(c-m,d),!o))return;const I=void 0!==s&&s!==K,v=D.current&&a.querySelector(`#${D.current}`),Z=!v&&j.current&&a.querySelector(".unread-divider");if(h&&I){if((0,Bt.N)())return;m=c-d}else m=v?i+(v.getBoundingClientRect().top-(q.current||0)):Z?Math.min(Z.offsetTop-(r?60:10),c-l):c-l;(0,Nt.Z)(a,m),_.current||(V.current=!0,(0,y.T2)((()=>{V.current=!1}))),Q.current=Math.max(c-m,d)}),[C,M,K,r]),(0,Et.Z)((([e])=>{void 0!==e&&(0,ae.YW)(200+n.fK)}),[N]);const re=(0,fe.Z)(),ie=Boolean(e&&(0,d.YA)(e)),ce=Boolean(!ie&&!m||v),le=Boolean(!ce||m),ue=(0,d.YA)(e)&&!v&&!P&&(!Y&&!A&&C&&(!G.current||0===G.current.length)||ta("contactSignUp",Y)||A&&A.content.action&&"contactSignUp"===A.content.action.type),he=p&&Z&&ta("chatCreate",Y),me=(0,ne.Z)("MessageList custom-scroll",le&&"no-avatars",!f&&"no-composer","pinned"===s&&"type-pinned",T&&"has-focus-highlight",N&&"select-mode-active",ee&&"scrolled",!I&&"is-animating");return o.ZP.createElement("div",{ref:$,className:me,onScroll:se,onMouseDown:Tt},E?o.ZP.createElement("div",{className:"empty"},o.ZP.createElement("span",null,k?k.text:"This is a private "+(m?"channel":"chat"))):L?o.ZP.createElement("div",{className:"empty rich"},o.ZP.createElement("span",null,(0,mt.Z)(re(L),["br","emoji","links"]))):ue?o.ZP.createElement(Ys,{userId:e}):!C||Y&&!he?C&&Y||A?o.ZP.createElement(Ws,{messageIds:C||[A.id],messageGroups:Y||Rt([A]),isViewportNewest:Boolean(M),isUnread:Boolean(b),withUsers:ce,noAvatars:le,containerRef:$,anchorIdRef:D,memoUnreadDividerBeforeIdRef:j,memoFirstUnreadIdRef:H,threadId:t,type:s,threadTopMessageId:O,hasLinkedChat:U,isSchedule:!!Y&&"scheduled"===s,noAppearanceAnimation:!Y||!X.current,onFabToggle:c,onNotchToggle:l,openHistoryCalendar:F}):o.ZP.createElement(Ae.Z,{color:"white"}):o.ZP.createElement(Js,{chatId:e,type:s,isChatWithSelf:v,isGroupChatJustCreated:he}))}))),aa=(0,o.X$)((0,a.c$)((e=>{const t=(0,i.Bt)(e);if(!t)return{};const{chatId:s,threadId:a,type:n}=t,o=(0,i.Z1)(e,s);return{messageListType:n,unreadCount:o&&a===u._f&&"thread"===n?o.unreadCount:void 0}}),((e,t)=>(0,g.ei)(t,["focusNextReply"])))((({isShown:e,canPost:t,messageListType:s,unreadCount:a,focusNextReply:n})=>{const r=(0,fe.Z)(),i=(0,o.sO)(null),c=(0,o.I4)((()=>{if(e)if("thread"===s)n();else{const e=i.current.parentElement.querySelector(".MessageList"),t=e.querySelectorAll(".message-list-item"),s=t[t.length-1];if(!s)return;(0,Bt.Z)(e,s,"end",20)}}),[e,s,n]),d=(0,ne.Z)("ScrollDownButton",e&&"revealed",!t&&"no-composer");return o.ZP.createElement("div",{ref:i,className:d},o.ZP.createElement("div",{className:"ScrollDownButton-inner"},o.ZP.createElement(Ze.Z,{color:"secondary",round:!0,onClick:c,ariaLabel:r("AccDescrPageDown")},o.ZP.createElement("i",{className:"icon-arrow-down"})),Boolean(a)&&o.ZP.createElement("div",{className:"unread-count"},(0,it.bi)(a))))})));var na=s(5723),oa=s(6980);const ra=1280;async function ia(e,t,s,a){const n=URL.createObjectURL(t),{type:o,size:r}=t;let i,c;if(o.startsWith("image/"))if(s){const s=await(0,Ye.pt)(n),{width:r,height:c}=s;if(r>ra||c>ra||"image/jpeg"!==o){const o=await function(e){return new Promise((t=>{const s=document.createElement("canvas"),a=s.getContext("2d");let{width:n,height:o}=e;(n>ra||o>ra)&&(n>=o?(o*=ra/n,n=ra):(n*=ra/o,o=ra)),s.width=n,s.height=o,a.drawImage(e,0,0,e.width,e.height,0,0,n,o),s.toBlob(t,"image/jpeg",100)}))}(s);return o?(URL.revokeObjectURL(n),ia(e,o,!0,a)):ia(e,t,!1,a)}i={width:r,height:c}}else c=n;else if(o.startsWith("video/")){if(r<10485760){const{videoWidth:e,videoHeight:t,duration:s}=await(0,Ye.jj)(n);i={width:e,height:t,duration:s}}c=await(0,Ye.ud)(n)}return{blobUrl:n,filename:e,mimeType:o,size:r,quick:i,previewBlobUrl:c,...a}}var ca=s(6391);let da;function la(e){da.focus(),e.focus()}m.cj&&(da=document.createElement("input"),da.classList.add("for-ios-autocapitalization-fix"),document.body.appendChild(da));const ua={encoderPath:s.p+"c0155344d336103c2b6a0b28cc510750.js",reuseWorker:!0},ha={type:"audio/ogg"};let ma,ga,pa;async function fa(){return ma||(ma=s.e(161).then(s.t.bind(s,1161,23)),ga=(await ma).default,pa=new ga(ua)),ma}async function Ia(e){await async function(){await fa(),await pa.start()}();const t=Date.now();let s;const a=[],n=[];pa.ondataavailable=e=>{a.push(e)};const o=function(t,s){const a=t.sourceNode,o=a.context.createAnalyser();o.fftSize=64,a.connect(o);const r=o.frequencyBinCount,i=new Uint8Array(r);let c=!1;return function t(){if(c)return;o.getByteFrequencyData(i);const s=i.reduce(((e,t)=>e+t),0)/r/255;(t=>{n.push(255*t),e(t)})(s<.1?0:s),requestAnimationFrame(t)}(),()=>{c=!0}}(pa);return{stop:()=>new Promise(((e,r)=>{pa.onstop=()=>{e({blob:new Blob(a,ha),duration:Math.round(((s||Date.now())-t)/1e3),waveform:n})},pa.onerror=r;const i=Math.max(0,t+1e3-Date.now());setTimeout((()=>{pa.stop(),o()}),i)})),pause:()=>{const e=Math.max(0,t+1e3-Date.now());setTimeout((()=>{pa.pause(),s=Date.now(),o()}),e)}}}const va=["image/png","image/jpeg","image/gif"];function ya(e){const{text:t,entities:s}=e||{};if(!t)return"";const a=(0,Ut.H)(t,s,void 0,void 0,!0);return Array.isArray(a)?a.join(""):a}let Za,Pa;var Ca=s(4784),wa=s(8353),ba=s(2365);const Ma=document.createElement("div"),Sa=/^@([a-z0-9_]{1,32})[\u00A0\u0020]+(.*)/i,Ea=/^@([a-z0-9_]{1,32})[\u00A0\u0020]+\n{2,}/i;const ka=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"DeleteMessageModal",!t);return s?o.ZP.createElement(s,e):void 0}));function Ra(){return(Ra=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}let Ta,Na=!0;const Ba=(0,o.X$)((({onActivate:e,...t})=>{const s=(0,o.sO)(!1),a=(0,o.I4)((()=>{if(s.current=!0,Na)return Na=!1,void e();Ta&&(clearTimeout(Ta),Ta=void 0),Ta=window.setTimeout((()=>{s.current&&e()}),200)}),[e]),n=(0,o.I4)((()=>{s.current=!1}),[]);return o.ZP.createElement(Ze.Z,Ra({},t,{onMouseEnter:m.$b?void 0:a,onMouseLeave:m.$b?void 0:n,onClick:m.$b?e:void 0}))})),xa=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"AttachMenu",!t);return s?o.ZP.createElement(s,e):void 0})),Aa=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"SymbolMenu",!t);return s?o.ZP.createElement(s,e):void 0})),La=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"InlineBotTooltip",!t);return s?o.ZP.createElement(s,e):void 0})),Oa=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"MentionTooltip",!t);return s?o.ZP.createElement(s,e):void 0})),Ua=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"CustomSendMenu",!t);return s?o.ZP.createElement(s,e):void 0})),Fa=e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"StickerTooltip",!t);return s?o.ZP.createElement(s,e):void 0};var $a=s(9830),Qa=s(6503);const Da=(0,o.X$)((0,a.c$)(((e,{messageId:t})=>{const{chatId:s}=(0,i.Bt)(e)||{};return s?{message:(0,i.hj)(e,s,t)}:{}}),((e,t)=>(0,g.ei)(t,["clickInlineButton"])))((({isOpen:e,message:t,onClose:s,clickInlineButton:a})=>{const[n,r]=(0,Qa.Z)(e,s),{isKeyboardSingleUse:i}=t||{},[c,d,l]=(0,pe.Z)(!0),u=()=>{l(),s()};if((0,o.d4)((()=>{d()}),[d,t]),t&&t.keyboardButtons)return o.ZP.createElement(Ue.Z,{isOpen:e||c,autoClose:i,positionX:"right",positionY:"bottom",onClose:u,className:"BotKeyboardMenu",onCloseAnimationEnd:u,onMouseEnter:m.$b?void 0:n,onMouseLeave:m.$b?void 0:r},o.ZP.createElement("div",{className:"content"},t.keyboardButtons.map((e=>o.ZP.createElement("div",{className:"row"},e.map((e=>o.ZP.createElement(Ze.Z,{ripple:!0,disabled:"NOT_SUPPORTED"===e.type,onClick:()=>a({button:e})},e.text))))))))})));var qa=s(3616),Ga=s(7891);const Ha=(0,o.X$)((0,a.c$)((e=>{const{chatId:t,threadId:s,type:a}=(0,i.Bt)(e)||{};if(!t||!s||!a)return{};const{currentUserId:n,forwardMessages:{fromChatId:o,toChatId:r,messageIds:c}}=e,l=(0,i.Yy)(e,t,s),u="scheduled"===a?(0,i.wU)(e,t):(0,i._$)(e,t,s),h=e.settings.byKey.animationLevel>=1,m=r===t;let g,p;if(l?g=(0,i.hj)(e,t,l):u?g=(0,i.kK)(e,t,s,a):m&&1===c.length&&(g=(0,i.hj)(e,o,c[0])),l&&g){const{forwardInfo:s}=g,a=t===n;s&&(s.isChannelPost||a)&&(p=(0,i.cv)(e,g)),p||(p=(0,i.Ur)(e,g))}else m&&(p=(0,d.YA)(o)?(0,i.dy)(e,o):(0,i.Z1)(e,o));return{replyingToId:l,editingId:u,message:g,sender:p,shouldAnimate:h,forwardedMessagesCount:m?c.length:void 0}}),((e,t)=>(0,g.ei)(t,["setReplyingToId","setEditingId","focusMessage","exitForwardMode"])))((({replyingToId:e,editingId:t,message:s,sender:a,shouldAnimate:n,forwardedMessagesCount:r,setReplyingToId:i,setEditingId:c,focusMessage:d,exitForwardMode:l})=>{const u=Boolean((e||t)&&s||a&&r),h=(0,Ga.Z)([r],r?300:void 0),{shouldRender:m,transitionClassNames:g}=(0,re.Z)(h&&u,void 0,!n,void 0,!n),p=(0,o.I4)((()=>{e?i({messageId:void 0}):t?c({messageId:void 0}):r&&l()}),[e,t,r,i,c,l]);(0,o.d4)((()=>u?(0,he.Z)(p):void 0),[u,p]);const f=(0,o.I4)((()=>{d({chatId:s.chatId,messageId:s.id})}),[d,s]),I=(0,ne.Z)("ComposerEmbeddedMessage",g),v=r&&r>1?`${r} forwarded messages`:void 0;if(m)return o.ZP.createElement("div",{className:I},o.ZP.createElement("div",null,o.ZP.createElement(Ze.Z,{round:!0,color:"translucent",ariaLabel:"Cancel replying",onClick:p},o.ZP.createElement("i",{className:"icon-close"})),o.ZP.createElement(Yt,{className:"inside-input",message:s,sender:a,customText:v,title:t?"Edit Message":void 0,onClick:f})))}))),ja=(0,o.X$)((e=>{const{attachments:t}=e,s=(0,xe.Z)(Be.gl.Extra,"AttachmentModal",!t.length);return s?o.ZP.createElement(s,e):void 0})),_a=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"PollModal",!t);return s?o.ZP.createElement(s,e):void 0})),Va=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"DropArea",!t);return s?o.ZP.createElement(s,e):void 0})),Xa=new RegExp(n.FM,"i"),Ka=(0,o.X$)((0,a.c$)(((e,{chatId:t,threadId:s})=>{const a=(0,i.tV)(e,t,s);return{webPagePreview:e.webPagePreview,noWebPage:a}}),((e,t)=>(0,g.ei)(t,["loadWebPagePreview","clearWebPagePreview","toggleMessageWebPage"])))((({chatId:e,threadId:t,messageText:s,disabled:a,webPagePreview:n,noWebPage:r,loadWebPagePreview:i,clearWebPagePreview:c,toggleMessageWebPage:d})=>{const l=(0,o.Ye)((()=>{const{text:e,entities:t}=(0,oa.Z)(s),a=t&&t.find((({type:e})=>e===u.Vv.TextUrl));if(a)return a.url;const n=e.match(Xa);return n?n[0]:void 0}),[s]);(0,o.d4)((()=>{l?i({text:l}):(c(),d({chatId:e,threadId:t}))}),[e,d,c,l,i,t]),(0,de.Z)((()=>{c(),d({chatId:e,threadId:t})}),[e]);const h=Boolean(n&&s.length&&!r&&!a),{shouldRender:m,transitionClassNames:g}=(0,re.Z)(h),p=(0,rt.Z)(n);if(!m||!p)return;const{photo:f,...I}=p,v={content:{webPage:I}};return o.ZP.createElement("div",{className:(0,ne.Z)("WebPagePreview",g)},o.ZP.createElement("div",null,o.ZP.createElement(Ze.Z,{round:!0,color:"translucent",ariaLabel:"Clear Webpage Preview",onClick:()=>{d({chatId:e,threadId:t,noWebPage:!0})}},o.ZP.createElement("i",{className:"icon-close"})),o.ZP.createElement(xs,{message:v,inPreview:!0})))})));var Wa=s(2898);const za=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"CalendarModal",!t);return s?o.ZP.createElement(s,e):void 0})),Ya=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"PaymentModal",!t);return s?o.ZP.createElement(s,e):void 0})),Ja=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"ReceiptModal",!t);return s?o.ZP.createElement(s,e):void 0}));var en;!function(e){e.Send="send",e.Record="record",e.Edit="edit"}(en||(en={}));const tn=(0,o.X$)((0,a.c$)(((e,{chatId:t,threadId:s,messageListType:a})=>{const o=(0,i.Z1)(e,t),r=o&&(0,i.Dg)(e,o),c=o?(0,i.xo)(e,o):void 0,l=(0,i.FM)(e,t),h=c&&(0,i.FT)(e,t),m=(0,i.qy)(e,t),{language:g}=e.settings.byKey,p=e.emojiKeywords[n.pR],f=g!==n.pR?e.emojiKeywords[g]:void 0,I=h?h.id:void 0,v=I?(0,i.hj)(e,t,I):void 0;return{editingMessage:(0,i.kK)(e,t,s,a),connectionState:e.connectionState,draft:(0,i.Ms)(e,t,s),chat:o,isChatWithBot:c,isChatWithSelf:l,canScheduleUntilOnline:!l&&!c&&o&&r&&(0,d.YA)(t)&&r.status&&Boolean(r.status.wasOnline),isRightColumnShown:(0,i.Jf)(e),isSelectModeActive:(0,i.CA)(e),withScheduledButton:s===u._f&&"thread"===a&&Boolean(m&&m.length),shouldSchedule:"scheduled"===a,botKeyboardMessageId:I,botKeyboardPlaceholder:v?v.keyboardPlaceholder:void 0,isForwarding:t===e.forwardMessages.toChatId,isPollModalOpen:e.isPollModalOpen,stickersForEmoji:e.stickers.forEmoji.stickers,groupChatMembers:o&&o.fullInfo&&o.fullInfo.members,topInlineBotIds:e.topInlineBots&&e.topInlineBots.userIds,currentUserId:e.currentUserId,usersById:e.users.byId,lastSyncTime:e.lastSyncTime,contentToBeScheduled:e.messages.contentToBeScheduled,isPaymentModalOpen:e.payment.isPaymentModalOpen,isReceiptModalOpen:Boolean(e.payment.receipt),shouldSuggestStickers:e.settings.byKey.shouldSuggestStickers,recentEmojis:e.recentEmojis,baseEmojiKeywords:p?p.keywords:void 0,emojiKeywords:f?f.keywords:void 0,serverTimeOffset:e.serverTimeOffset,inlineBots:e.inlineBots.byUsername,isInlineBotLoading:e.inlineBots.isLoading}}),((e,t)=>(0,g.ei)(t,["sendMessage","editMessage","saveDraft","clearDraft","showDialog","setStickerSearchQuery","setGifSearchQuery","forwardMessages","openPollModal","closePollModal","closePaymentModal","clearReceipt","loadScheduledHistory","openChat","addRecentEmoji","sendInlineBotResult"])))((({dropAreaState:e,shouldSchedule:t,canScheduleUntilOnline:s,isReady:r,onDropHide:i,editingMessage:c,chatId:l,threadId:h,messageListType:g,draft:p,chat:f,connectionState:I,isChatWithBot:v,isChatWithSelf:Z,isRightColumnShown:P,isSelectModeActive:C,isForwarding:w,isPollModalOpen:b,isPaymentModalOpen:M,isReceiptModalOpen:S,botKeyboardMessageId:E,botKeyboardPlaceholder:k,withScheduledButton:R,stickersForEmoji:T,groupChatMembers:N,topInlineBotIds:B,currentUserId:x,usersById:L,lastSyncTime:O,contentToBeScheduled:U,shouldSuggestStickers:F,baseEmojiKeywords:$,emojiKeywords:Q,serverTimeOffset:D,recentEmojis:q,inlineBots:G,isInlineBotLoading:H,sendMessage:j,editMessage:_,saveDraft:V,clearDraft:X,showDialog:K,setStickerSearchQuery:W,setGifSearchQuery:z,forwardMessages:Y,openPollModal:J,closePollModal:ee,loadScheduledHistory:te,closePaymentModal:se,openChat:ae,clearReceipt:oe,addRecentEmoji:re,sendInlineBotResult:de})=>{const le=(0,fe.Z)(),ue=(0,o.sO)(null),[me,ge]=(0,o.eJ)(""),Ie=(0,o.sO)(),ve=(0,us.Z)(e),[ye,Pe,Ce]=(0,pe.Z)(),[we,be]=(0,o.eJ)(),{width:Me}=Je.Z.get(),Ee=(0,o.sO)(me);(0,o.d4)((()=>{Ee.current=me}),[me]),(0,o.d4)((()=>{Ie.current=void 0}),[l]),(0,o.d4)((()=>{l&&O&&h===u._f&&r&&te()}),[r,l,te,O,h]),(0,o.bt)((()=>{ue.current&&(ue.current.innerHTML='<svg width="9" height="20" xmlns="http://www.w3.org/2000/svg"><defs><filter x="-50%" y="-14.7%" width="200%" height="141.2%" filterUnits="objectBoundingBox" id="a"><feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0" in="shadowBlurOuter1"/></filter></defs><g fill="none" fill-rule="evenodd"><path d="M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z" fill="#000" filter="url(#a)"/><path d="M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z" fill="#FFF" class="corner"/></g></svg>')}),[]),(0,o.d4)((()=>{U&&(be(U),Pe())}),[U,Pe]);const[ke,Re]=(0,o.eJ)([]),[Te,Ne,Be]=(0,pe.Z)(),[xe,Ae,Le]=(0,pe.Z)(),[Oe,Ue,Fe]=(0,pe.Z)(),[$e,Qe,De]=(0,pe.Z)(),[qe,Ge]=(0,pe.Z)(),[He,je,_e]=(0,pe.Z)(),{startRecordingVoice:Ve,stopRecordingVoice:Xe,pauseRecordingVoice:Ke,activeVoiceRecording:ze,currentRecordTime:Ye,recordButtonRef:et,startRecordTimeRef:tt}=(()=>{const e=(0,o.sO)(null),[t,s]=(0,o.eJ)(),a=(0,o.sO)(),[n,r]=(0,o.eJ)();(0,o.d4)((()=>{m.cj&&m.mh&&fa()}),[]);const i=(0,o.I4)((async()=>{try{const{stop:t,pause:n}=await Ia((t=>{e.current&&(a.current&&Date.now()%4==0&&(e.current.style.boxShadow=`0 0 0 ${50*(t||0)}px rgba(0,0,0,.15)`),r(Date.now()))}));a.current=Date.now(),r(Date.now()),s({stop:t,pause:n})}catch(e){console.error(e)}}),[]),c=(0,o.I4)((()=>{if(t){e.current&&(e.current.style.boxShadow="none");try{return t.pause()}catch(e){return void console.error(e)}}}),[t]),d=(0,o.I4)((()=>{if(t){s(void 0),a.current=void 0,r(void 0),e.current&&(e.current.style.boxShadow="none");try{return t.stop()}catch(e){return void console.error(e)}}}),[t]);return(0,o.d4)((()=>t?(0,he.Z)(d):void 0),[t,d]),{startRecordingVoice:i,pauseRecordingVoice:c,stopRecordingVoice:d,activeVoiceRecording:t,currentRecordTime:n,recordButtonRef:e,startRecordTimeRef:a}})(),st=c?en.Edit:!m.mh||ze||me&&!ke.length||w?en.Send:en.Record,at=!t,{isMentionTooltipOpen:nt,mentionFilter:ot,closeMentionTooltip:rt,insertMention:it,mentionFilteredUsers:ct}=(0,ba.Z)(!ke.length,me,ge,void 0,N,B,x,L),{isOpen:dt,id:lt,isGallery:ut,switchPm:ht,results:gt,closeTooltip:pt,help:ft,loadMore:It}=function(e,t,s,n){const[r,i,c]=(0,pe.Z)(),d=function(e){return Ma.innerHTML=e.replace(/<br>/g,"\n"),Ma.innerText}(s),{queryInlineBot:l,resetInlineBot:u}=(0,a.uC)(),{username:h,query:m,canShowHelp:g}=function(e){const t=e.match(Sa);return t?{username:t[1],query:t[2],canShowHelp:""===t[2]&&!e.match(Ea)}:{username:"",query:"",canShowHelp:!1}}(d),p=h.toLowerCase(),f=(0,us.Z)(m),I=(0,us.Z)(h),v=n&&n[p],{id:y,switchPm:Z,offset:P,results:C,isGallery:w,help:b}=v||{};(0,o.d4)((()=>{f!==m&&c()}),[f,m,c]),(0,o.d4)((()=>{e&&p&&t&&l({chatId:t,username:p,query:m})}),[m,e,l,t,p]);const M=(0,o.I4)((()=>{l({chatId:t,username:p,query:m,offset:P})}),[P,t,m,l,p]);return(0,o.d4)((()=>{e&&y&&(Z||C&&C.length)?i():c()}),[y,e,i,C,Z,c]),I!==h&&u({username:I}),{isOpen:r,closeTooltip:c,loadMore:M,username:h,id:y,isGallery:w,switchPm:Z,results:C,help:g&&b?`@${h} ${b}`:void 0}}(Boolean(!ke.length&&O),l,me,G),{isContextMenuOpen:vt,handleContextMenu:yt,handleContextMenuClose:Zt,handleContextMenuHide:Pt}=(0,Ot.Z)(et,!(st===en.Send&&at)),Ct=(0,o.Ye)((()=>(0,d.H5)(f,v)),[f,v]),wt=f&&(0,d.Nl)(f),bt=(0,d.Hd)(f),{isStickerTooltipOpen:Mt,closeStickerTooltip:St}=function(e,t,s,n=!1){const{loadStickersForEmoji:r,clearStickersForEmoji:i}=(0,a.uC)(),c=m.op&&1===(0,Ca.Z)(t)||!m.op&&Boolean(t.match(/^<img.[^>]*?>$/g)),d=Boolean(s)&&c;return(0,o.d4)((()=>{n||(e&&c?r({emoji:t}):!d&&c||i())}),[t,c,i,r,e,n]),{isStickerTooltipOpen:d,closeStickerTooltip:i}}(Boolean(F&&Ct.canSendStickers&&!ke.length),me,T,!r),{isEmojiTooltipOpen:Et,closeEmojiTooltip:kt,filteredEmojis:Rt,insertEmoji:Tt}=(0,wa.Z)(Boolean(F&&Ct.canSendStickers&&!ke.length),me,q,void 0,ge,$,Q,!r),Nt=(0,o.I4)(((e,t=n.R2)=>{const s=window.getSelection(),a=document.getElementById(t),o=(0,mt.Z)(e,["escape_html","emoji_html","br_html"]).join("").replace(/\u200b+/g,"â€‹");if(s.rangeCount){const e=s.getRangeAt(0);if((0,ca.R)(e,t))return function(e){const t=window.getSelection();if(t&&t.getRangeAt&&t.rangeCount){const s=t.getRangeAt(0);s.deleteContents();const a=s.createContextualFragment(e),n=a.lastChild;s.insertNode(a),n?(s.setStartAfter(n),s.setEndAfter(n)):s.collapse(!1),t.removeAllRanges(),t.addRange(s)}}(o),void a.dispatchEvent(new Event("input",{bubbles:!0}))}ge(`${Ee.current}${o}`),requestAnimationFrame((()=>{(0,na.Z)(a)}))}),[]),Bt=(0,o.I4)((()=>{const e=window.getSelection();if(e.rangeCount){const t=e.getRangeAt(0);if((0,ca.R)(t,n.R2))return void document.execCommand("delete",!1)}ge(function(e){const t=document.createElement("div");t.contentEditable="true",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.innerHTML=e,document.body.appendChild(t);let s=t.lastChild;if(s.lastChild)for(;s.lastChild;)s=s.lastChild;const a=s.textContent.length,n=document.createRange(),o=window.getSelection();n.setStart(s,a),n.setEnd(s,a),o.removeAllRanges(),o.addRange(n),document.execCommand("delete",!1);const r=t.innerHTML;return document.body.removeChild(t),r}(Ee.current))}),[]),xt=(0,o.I4)(((e=!1)=>{e||ge(""),Re([]),St(),Ce(),be(void 0),rt(),kt(),m.wB?setTimeout((()=>Fe()),350):Fe()}),[St,Ce,rt,kt,Fe]),At=(0,us.Z)(l);(0,o.d4)((()=>{At&&l!==At&&(Xe(),xt())}),[l,At,xt,Xe]);const Lt=((e,t,s,a,r,i)=>((0,o.d4)((()=>{s?(t(ya(s.content.text)),requestAnimationFrame((()=>{const e=document.getElementById(n.R2);(0,na.Z)(e,!0)}))):t("")}),[s,t]),(0,o.I4)((()=>{const{text:t,entities:n}=(0,oa.Z)(e.current);s&&(t||(0,d.u8)(s)?(i({messageId:s.id,text:t,entities:n}),a()):r())}),[i,s,e,r,a])))(Ee,ge,c,xt,Qe,_);((e,t,s,a,r,i,c,d,l)=>{const u=(0,o.I4)(((e,t)=>{r.current.length&&!c?d({chatId:e,threadId:t,draft:(0,oa.Z)(r.current)}):l({chatId:e,threadId:t})}),[l,c,r,d]),h=(0,o.Ye)((()=>(0,y.Ds)((e=>e()),n.r_,!1)),[t]),g=(0,us.Z)(t),p=(0,us.Z)(s);(0,o.d4)((()=>(Za=t,Pa=s,()=>{Za=void 0,Pa=void 0,u(t,s)})),[t,s,u]),(0,o.d4)((()=>{t===g&&s===p||e&&(i(ya(e)),m.$b||requestAnimationFrame((()=>{const e=document.getElementById(n.R2);(0,na.Z)(e,!0)})))}),[t,s,e,i,u,g,p]);const f=(0,us.Z)(a);(0,o.d4)((()=>{t&&s&&g===t&&p===s&&f!==a&&(a.length?h((()=>{Za===t&&Pa===s&&u(t,s)})):u(t,s))}),[t,a,g,f,p,h,s,u]);const I=(0,o.I4)((()=>{t&&s&&u(t,s)}),[t,s,u]);(0,ie.Z)(I),ce(I)})(p,l,h,me,Ee,ge,c,V,X),((e,t,s)=>{(0,o.d4)((()=>{async function a(a){if(!a.clipboardData)return;const o=document.activeElement;if(o&&![n.R2,n.nY].includes(o.id))return;const{items:r}=a.clipboardData,i=Array.from(r).find((e=>va.includes(e.type))),c=i&&i.getAsFile(),d=a.clipboardData.getData("text").substring(0,4096);if(c||d){if(a.preventDefault(),c&&!s){const e=await ia(c.name,c,!0);t((t=>[...t,e]))}d&&e(d,o?o.id:void 0)}}return document.addEventListener("paste",a,!1),()=>{document.removeEventListener("paste",a,!1)}}),[e,s,t])})(Nt,Re,c);const Ut=(0,o.I4)((async(e,t)=>{Re(await Promise.all(e.map((e=>ia(e.name,e,t)))))}),[]),Ft=(0,o.I4)((async(e,t)=>{Re([...ke,...await Promise.all(e.map((e=>ia(e.name,e,t))))])}),[ke]),$t=(0,o.I4)((()=>{Re([])}),[]),Qt=(0,o.I4)((async(e=!1,t)=>{if("connectionStateReady"!==I)return;let s=ke;if(ze){const e=await Xe();if(e){const{blob:t,duration:a,waveform:n}=e;s=[await ia("wonderful-voice-message.ogg",t,!1,{voice:{duration:a,waveform:n}})]}}const{text:a,entities:o}=(0,oa.Z)(Ee.current);if(!s.length&&!a&&!w)return;if(s.length&&a&&a.length>1024){const e=a.length-1024;return void K({data:{message:"CAPTION_TOO_LONG_PLEASE_REMOVE_CHARACTERS",textParams:{"{EXTRA_CHARS_COUNT}":e,"{PLURAL_S}":e>1?"s":""},hasErrorKey:!0}})}const r=document.getElementById(n.R2);if(s.length||a){if(bt&&!wt){const e=Math.floor(Date.now()/1e3)+D,t=Ie.current&&Math.floor(e-Ie.current),s=bt.nextSendDate&&bt.nextSendDate>e;if(t&&t<bt.seconds||s){const a=s?bt.nextSendDate-e:bt.seconds-t;return K({data:{message:le("SlowModeHint",(0,A.k9)(a)),isSlowMode:!0,hasErrorKey:!1}}),void r.blur()}}j({text:a,entities:o,attachments:s,scheduledAt:t,isSilent:e})}w&&Y(),Ie.current=Math.floor(Date.now()/1e3)+D,X({chatId:l,localOnly:!0}),m.cj&&r===document.activeElement&&la(r),requestAnimationFrame((()=>{xt()}))}),[I,ke,ze,w,D,X,l,xt,Xe,K,bt,wt,j,Y,le]),Dt=(0,o.I4)(((e,s=!1)=>{e={...e,isPreloadedGlobally:!0},t?(be({sticker:e}),Pe()):(j({sticker:e}),requestAnimationFrame((()=>{xt(s)})))}),[t,Pe,j,xt]),qt=(0,o.I4)((e=>{t?(be({gif:e}),Pe()):(j({gif:e}),requestAnimationFrame((()=>{xt(!0)})))}),[t,Pe,j,xt]),Gt=(0,o.I4)((e=>{if("connectionStateReady"!==I)return;de({id:e.id,queryId:e.queryId});const t=document.getElementById(n.R2);m.cj&&t===document.activeElement&&la(t),X({chatId:l,localOnly:!0}),requestAnimationFrame((()=>{xt()}))}),[l,X,I,xt,de]),Ht=(0,o.I4)((e=>{t?(be({poll:e}),ee(),Pe()):(j({poll:e}),ee())}),[ee,Pe,j,t]),jt=(0,o.I4)((()=>{t?(be({isSilent:!0}),Pe()):Qt(!0)}),[Qt,Pe,t]),_t=(0,o.I4)(((e,t=!1)=>{const{isSilent:s,...a}=we||{},n=Math.round(Math.max(e.getTime(),Date.now()+6e4)/1e3)+(t?0:D);we&&0!==Object.keys(a).length?(j({...we,scheduledAt:n}),requestAnimationFrame((()=>{xt()}))):Qt(!!s,n),Ce()}),[Ce,Qt,xt,we,j,D]),Vt=(0,o.I4)((()=>{_t(new Date(1e3*n.t4),!0)}),[_t]),Xt=(0,o.I4)((()=>{Ce(),be(void 0)}),[Ce]),Kt=(0,o.I4)((e=>{"stickers"===e?(W({query:""}),z({query:void 0})):(z({query:""}),W({query:void 0}))}),[W,z]),Wt=(0,o.I4)((()=>{const e=document.getElementById(n.R2);m.wB&&e===document.activeElement?(e.blur(),setTimeout((()=>{Ue()}),100)):Ue()}),[Ue]),zt=(0,o.I4)((()=>{ae({id:l,threadId:h,type:"scheduled"})}),[ae,l,h]);(0,o.d4)((()=>{P&&m.wB&&Fe()}),[P,Fe]),(0,o.d4)((()=>{r&&(C?je():setTimeout((()=>{_e()}),200))}),[C,_e,je,r]);const Yt=(0,o.I4)((()=>{switch(st){case en.Send:t?(ze&&Ke(),Pe()):(Qt(),requestAnimationFrame((()=>{xt()})));break;case en.Record:Ve();break;case en.Edit:Lt()}}),[st,xt,t,Ve,Lt,ze,Pe,Ke,Qt]),Jt=st===en.Record&&!Ct.canAttachMedia,es=(0,us.Z)(c,!0),ts=c||es,ss=new Date;ss.setSeconds(0),ss.setMilliseconds(0);const as=new Date;as.setFullYear(as.getFullYear()+1);let ns="SendMessage";switch(st){case en.Edit:ns="Save edited message";break;case en.Record:ns=Jt?"Conversation.DefaultRestrictedMedia":"AccDescrVoiceMessage"}const os=(0,ne.Z)("Composer",!C&&"shown",He&&"hover-disabled"),rs=(0,ne.Z)("mobile-symbol-menu-button",!r&&"not-ready",qe?Oe&&"menu-opened":Oe&&"is-loading"),is=st===en.Edit?Lt:t?Pe:Qt;return o.ZP.createElement("div",{className:os},Ct.canAttachMedia&&r&&o.ZP.createElement(Wa.Z,{containerId:"#middle-column-portals"},o.ZP.createElement(Va,{isOpen:e!==We.t.None,withQuick:[e,ve].includes(We.t.QuickFile),onHide:i,onFileSelect:Ut})),o.ZP.createElement(ja,{attachments:ke,caption:ke.length?me:"",groupChatMembers:N,currentUserId:x,usersById:L,recentEmojis:q,isReady:r,onCaptionUpdate:ge,baseEmojiKeywords:$,emojiKeywords:Q,addRecentEmoji:re,onSend:t?Pe:Qt,onFileAppend:Ft,onClear:$t}),o.ZP.createElement(_a,{isOpen:Boolean(b),onClear:ee,onSend:Ht}),o.ZP.createElement(Ya,{isOpen:Boolean(M),onClose:se}),o.ZP.createElement(Ja,{isOpen:Boolean(S),onClose:oe}),ts&&o.ZP.createElement(ka,{isOpen:$e,isSchedule:"scheduled"===g,onClose:De,message:ts}),o.ZP.createElement(Oa,{isOpen:nt,filter:ot,onClose:rt,onInsertUserName:it,filteredUsers:ct,usersById:L}),o.ZP.createElement(La,{isOpen:dt,botId:lt,allowedAttachmentOptions:Ct,isGallery:ut,inlineBotResults:gt,switchPm:ht,onSelectResult:Gt,loadMore:It,onClose:pt}),o.ZP.createElement("div",{id:"message-compose"},o.ZP.createElement("div",{className:"svg-appendix",ref:ue}),o.ZP.createElement(Ha,null),o.ZP.createElement(Ka,{chatId:l,threadId:h,messageText:ke.length?"":me,disabled:!Ct.canAttachEmbedLinks}),o.ZP.createElement("div",{className:"message-input-wrapper"},m.wB?o.ZP.createElement(Ze.Z,{className:rs,round:!0,faded:!0,color:"translucent",onClick:Oe?Fe:Wt,ariaLabel:"Choose emoji, sticker or GIF"},o.ZP.createElement("i",{className:"icon-smile"}),o.ZP.createElement("i",{className:"icon-keyboard"}),Oe&&!qe&&o.ZP.createElement(Se.Z,{color:"gray"})):o.ZP.createElement(Ba,{className:Oe?"activated":"",round:!0,faded:!0,color:"translucent",onActivate:Ue,ariaLabel:"Choose emoji, sticker or GIF"},o.ZP.createElement("i",{className:"icon-smile"})),o.ZP.createElement(qa.Z,{id:"message-input-text",html:ke.length?"":me,placeholder:ze&&Me<=600?"":k||le("Message"),forcedPlaceholder:ft,shouldSetFocus:Oe,shouldSuppressFocus:m.wB&&Oe,shouldSuppressTextFormatter:Et||nt||dt,onUpdate:ge,onSend:is,onSuppressedFocus:Fe}),H&&Boolean(lt)&&o.ZP.createElement(Se.Z,{color:"gray"}),R&&o.ZP.createElement(Ze.Z,{round:!0,faded:!0,className:"scheduled-button",color:"translucent",onClick:zt,ariaLabel:"Open scheduled messages"},o.ZP.createElement("i",{className:"icon-schedule"})),E&&!ze&&!c&&o.ZP.createElement(Ba,{className:Te?"activated":"",round:!0,faded:!0,color:"translucent",onActivate:Ne,ariaLabel:"Open bot command keyboard"},o.ZP.createElement("i",{className:"icon-bot-command"})),!ze&&!c&&o.ZP.createElement(Ba,{className:xe?"activated":"",round:!0,faded:!0,color:"translucent",onActivate:Ae,ariaLabel:"Add an attachment"},o.ZP.createElement("i",{className:"icon-attach"})),ze&&Ye&&o.ZP.createElement("span",{className:"recording-state"},(0,A.rM)(Ye-tt.current)),o.ZP.createElement(Fa,{isOpen:Mt,onStickerSelect:Dt}),o.ZP.createElement($a.Z,{isOpen:Et,emojis:Rt,onClose:kt,onEmojiSelect:Tt,addRecentEmoji:re}),o.ZP.createElement(xa,{isOpen:xe,allowedAttachmentOptions:Ct,onFileSelect:Ut,onPollCreate:J,onClose:Le}),E&&o.ZP.createElement(Da,{messageId:E,isOpen:Te,onClose:Be}),o.ZP.createElement(Aa,{isOpen:Oe,allowedAttachmentOptions:Ct,onLoad:Ge,onClose:Fe,onEmojiSelect:Nt,onStickerSelect:Dt,onGifSelect:qt,onRemoveSymbol:Bt,onSearchOpen:Kt,addRecentEmoji:re}))),ze&&o.ZP.createElement(Ze.Z,{round:!0,color:"danger",className:"cancel",onClick:Xe,ariaLabel:"Cancel voice recording"},o.ZP.createElement("i",{className:"icon-delete"})),o.ZP.createElement(Ze.Z,{ref:et,round:!0,color:"secondary",className:(0,ne.Z)(st,!r&&"not-ready",ze&&"recording"),disabled:Jt,ariaLabel:le(ns),onClick:Yt,onContextMenu:st===en.Send&&at?yt:void 0},o.ZP.createElement("i",{className:"icon-send"}),o.ZP.createElement("i",{className:"icon-microphone-alt"}),o.ZP.createElement("i",{className:"icon-check"})),at&&o.ZP.createElement(Ua,{isOpen:vt,onSilentSend:Z?void 0:jt,onScheduleSend:t?void 0:Pe,onClose:Zt,onCloseAnimationEnd:Pt}),o.ZP.createElement(za,{isOpen:ye,withTimePicker:!0,selectedAt:ss.getTime(),maxAt:(0,A._F)(as),isFutureMode:!0,secondButtonLabel:s?"Send When Online":void 0,onClose:Xt,onSubmit:_t,onSecondButtonClick:s?Vt:void 0}))}))),sn=(0,o.X$)((e=>{const{isActive:t}=e,s=(0,xe.Z)(Be.gl.Extra,"MobileSearch",!t,!0);return s?o.ZP.createElement(s,e):void 0})),an=(0,o.X$)((e=>{const{isActive:t}=e,s=(0,xe.Z)(Be.gl.Extra,"MessageSelectToolbar",!t);return s?o.ZP.createElement(s,e):void 0})),nn=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"UnpinAllMessagesModal",!t);return s?o.ZP.createElement(s,e):void 0})),on=m.wB?450+n.fK:void 0;function rn(e){return"file"===e.kind&&e.type&&n.AK.has(e.type)}const cn=(0,o.X$)((0,a.c$)((e=>{const t=(0,i.Pu)(e),{isBlurred:s,background:a,backgroundColor:n,patternColor:o}=e.settings.themes[t]||{},{messageLists:r}=e.messages,c=(0,i.Bt)(e),{isLeftColumnShown:l,chats:{listIds:h}}=e,g={theme:t,customBackground:a,backgroundColor:n,patternColor:o,isLeftColumnShown:l,isRightColumnShown:(0,i.Jf)(e),isBackgroundBlurred:s,isMobileSearchActive:Boolean(m.wB&&(0,i.n5)(e)),isSelectModeActive:(0,i.CA)(e),animationLevel:e.settings.byKey.animationLevel,currentTransitionKey:Math.max(0,e.messages.messageLists.length-1)};if(!c||!h.active)return g;const{chatId:p,threadId:f,type:I}=c,v=(0,i.Z1)(e,p),y=(0,i.KB)(e,p),{chatId:Z,messageId:P}=e.audioPlayer,C=v&&(0,d.Qm)(v,f),w=(0,i.pk)(e,p),b="pinned"===I,M="scheduled"===I;return{...g,chatId:p,threadId:f,messageListType:I,isPrivate:(0,d.YA)(p),canPost:!b&&(!v||C)&&!w,isPinnedMessageList:b,isScheduledMessageList:M,currentUserBannedRights:v&&v.currentUserBannedRights,defaultBannedRights:v&&v.defaultBannedRights,hasPinnedOrAudioMessage:f!==u._f||Boolean(y&&y.length)||Boolean(Z&&P),pinnedMessagesCount:y?y.length:0,shouldSkipHistoryAnimations:e.shouldSkipHistoryAnimations,messageLists:r}}),((e,t)=>(0,g.ei)(t,["openChat","unpinAllMessages","loadUser","closeLocalTextSearch","exitMessageSelectMode"])))((({chatId:e,threadId:t,messageListType:s,isPrivate:a,isPinnedMessageList:r,messageLists:i,canPost:c,currentUserBannedRights:l,defaultBannedRights:u,hasPinnedOrAudioMessage:h,pinnedMessagesCount:g,customBackground:p,theme:f,backgroundColor:I,patternColor:v,isLeftColumnShown:y,isRightColumnShown:Z,isBackgroundBlurred:P,isMobileSearchActive:C,isSelectModeActive:w,animationLevel:b,shouldSkipHistoryAnimations:M,currentTransitionKey:S,openChat:E,unpinAllMessages:k,loadUser:R,closeLocalTextSearch:T,exitMessageSelectMode:N})=>{const{width:B}=et(),x=(0,fe.Z)(),[A,L]=(0,o.eJ)(We.t.None),[O,U]=(0,o.eJ)(),[F,$]=(0,o.eJ)(),[Q,D]=(0,o.eJ)(!1),[q,G]=(0,o.eJ)(!m.wB||b===n.oB),H=h&&(B<n.l3||Z&&B>n._m&&B<n.QU||B>=n.ks&&B<n.jT),j=(0,tt.Z)(e,on),_=(0,tt.Z)(t,on),V=(0,tt.Z)(s,on),X=(0,tt.Z)(c,on),K=(0,tt.Z)(H,on),W=(0,tt.Z)(O,on);(0,o.d4)((()=>e?(0,he.Z)((()=>{E({id:void 0})})):void 0),[e,E]),(0,o.d4)((()=>{L(We.t.None),U(void 0),$(void 0)}),[e]),(0,o.d4)((()=>{b===n.oB&&G(!0)}),[b]),(0,o.d4)((()=>{a&&R({userId:e})}),[e,a,R]);const z=(0,o.I4)((e=>{if(m.$b)return;const{items:t}=e.dataTransfer||{},s=t&&Array.from(t).filter((e=>"text/uri-list"!==e.type)).every(rn);L(s?We.t.QuickFile:We.t.Document)}),[]),Y=(0,o.I4)((()=>{L(We.t.None)}),[]),J=(0,o.I4)((()=>{D(!0)}),[]),ee=(0,o.I4)((()=>{D(!1)}),[]),te=(0,o.I4)((()=>{k({chatId:e}),ee(),E({id:e})}),[k,E,ee,e]),se=(0,o.I4)((()=>{E({id:e})}),[E,e]),ae=((e,t)=>{const[s,a]=(0,o.eJ)(t);return(0,o.d4)((()=>{t&&(t.startsWith("#")?a(t):ze.fetch(n.fo,e,ze.Type.Blob).then((e=>{const t=URL.createObjectURL(e);(0,Ye.pt)(t).then((()=>{a(`url(${t})`)}))})))}),[t,e]),t?s:void 0})(f,p),oe=(0,ne.Z)(K&&"has-header-tools",p&&"custom-bg-image",I&&"custom-bg-color",p&&P&&"blurred",m.aZ?"mask-image-disabled":"mask-image-enabled"),re=(0,ne.Z)("messaging-disabled",!w&&"shown"),ie=(0,d.q8)(x,l,u),{composerHiddenScale:ce,toolbarHiddenScale:de,composerTranslateX:le,toolbarTranslateX:me,unpinHiddenScale:pe,toolbarForUnpinHiddenScale:Ie}=(0,o.Ye)((()=>function(e,t){const s=e<=n.l3?16:32,a=function(e){if(e>n._m){const t=Math.min(Math.max(.25*e,288),424),s=Math.min(.25*e,424);return Math.min(e-t-s,st)}if(e>n.ks){const t=Math.min(Math.max(.4*e,288),424);return Math.min(e-t,st)}return e>st?st:e}(e),o=e<=n.l3?54:64,r=t?a-s-o:a-s,i=e>n.l3?Math.min(a-s,512):a-s,c=i/r,d=r/i;return{composerHiddenScale:c,toolbarHiddenScale:d,composerTranslateX:t?o/2*d:0,toolbarTranslateX:t?o/2*-1*c:0,unpinHiddenScale:i/258,toolbarForUnpinHiddenScale:258/i}}(B,X)),[X,B]),ve=(0,ne.Z)("middle-column-footer",!X&&"no-composer",X&&F&&!w&&"with-notch");return(0,ue.ZP)(j&&_,(()=>{E({id:void 0},!0)}),void 0,void 0,void 0,i?i.map(at):[]),(0,ue.ZP)(C,T),(0,ue.ZP)(w,N),o.ZP.createElement("div",{id:"MiddleColumn",className:oe,onTransitionEnd:t=>{"transform"===t.propertyName&&t.target===t.currentTarget&&G(Boolean(e))},style:`\n        --composer-hidden-scale: ${ce};\n        --toolbar-hidden-scale: ${de};\n        --unpin-hidden-scale: ${pe};\n        --toolbar-unpin-hidden-scale: ${Ie};\n        --composer-translate-x: ${le}px;\n        --toolbar-translate-x: ${me}px;\n        --pattern-color: ${v};\n        --theme-background-color:\n          ${I||("dark"===f?n.It:n.p3)};\n      `,onClick:m.p7&&y?se:void 0},o.ZP.createElement("div",{id:"middle-column-bg",style:ae?`--custom-background: ${ae}`:void 0}),o.ZP.createElement("div",{id:"middle-column-portals"}),j&&_&&o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement("div",{className:"messages-layout",onDragEnter:X?z:void 0},o.ZP.createElement(Mt,{chatId:j,threadId:_,messageListType:V,isReady:q}),o.ZP.createElement(ge.Z,{name:M?"none":b===n.zy?"slide":"fade",activeKey:S,shouldCleanup:!0},(()=>o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement(sa,{key:`${j}-${_}-${V}`,chatId:j,threadId:_,type:V,canPost:X,hasTools:K,onFabToggle:U,onNotchToggle:$,isReady:q}),o.ZP.createElement("div",{className:ve},X&&o.ZP.createElement(tn,{chatId:j,threadId:_,messageListType:V,dropAreaState:A,onDropHide:Y,isReady:q}),r&&o.ZP.createElement("div",{className:"unpin-button-container",dir:x.isRtl?"rtl":void 0},o.ZP.createElement(Ze.Z,{size:"tiny",fluid:!0,color:"secondary",className:"unpin-all-button",onClick:J},o.ZP.createElement("i",{className:"icon-unpin"}),o.ZP.createElement("span",null,x("Chat.Pinned.UnpinAll",g,"i")))),!r&&!X&&ie&&o.ZP.createElement("div",{className:re},o.ZP.createElement("div",{className:"messaging-disabled-inner"},o.ZP.createElement("span",null,ie))),o.ZP.createElement(an,{messageListType:V,isActive:w,canPost:X}))))),o.ZP.createElement(aa,{isShown:W,canPost:X})),m.wB&&o.ZP.createElement(sn,{isActive:Boolean(C)})),e&&o.ZP.createElement(nn,{isOpen:Q,chatId:e,pinnedMessagesCount:g,onClose:ee,onUnpin:te}))}))),dn=(0,y.Ds)((e=>e()),200,!1);var ln;!function(e){e[e.Profile=0]="Profile",e[e.MemberList=1]="MemberList",e[e.SharedMedia=2]="SharedMedia",e[e.Search=3]="Search",e[e.Management=4]="Management",e[e.ManageInitial=5]="ManageInitial",e[e.ManageChannelSubscribers=6]="ManageChannelSubscribers",e[e.ManageChatAdministrators=7]="ManageChatAdministrators",e[e.ManageChatPrivacyType=8]="ManageChatPrivacyType",e[e.ManageDiscussion=9]="ManageDiscussion",e[e.ManageGroupPermissions=10]="ManageGroupPermissions",e[e.ManageGroupRemovedUsers=11]="ManageGroupRemovedUsers",e[e.ManageGroupUserPermissionsCreate=12]="ManageGroupUserPermissionsCreate",e[e.ManageGroupUserPermissions=13]="ManageGroupUserPermissions",e[e.ManageGroupRecentActions=14]="ManageGroupRecentActions",e[e.ManageGroupAdminRights=15]="ManageGroupAdminRights",e[e.ManageGroupMembers=16]="ManageGroupMembers",e[e.StickerSearch=17]="StickerSearch",e[e.GifSearch=18]="GifSearch",e[e.PollResults=19]="PollResults",e[e.AddingMembers=20]="AddingMembers"}(ln||(ln={}));const un=(0,o.X$)((0,a.c$)(((e,{chatId:t,isProfile:s,isManagement:a})=>{const{query:n}=(0,i.n5)(e)||{},{query:o}=(0,i.y5)(e)||{},{query:r}=(0,i.yN)(e)||{},c=t?(0,i.Z1)(e,t):void 0,l=c&&(0,d.eA)(c);return{canManage:Boolean(!a&&s&&c&&!(0,i.FM)(e,c.id)&&((0,d.YA)(c.id)||((0,d.Nl)(c)||c.isCreator)&&!c.isNotJoined)),isChannel:l,messageSearchQuery:n,stickerSearchQuery:o,gifSearchQuery:r}}),((e,t)=>(0,g.ei)(t,["setLocalTextSearchQuery","setStickerSearchQuery","setGifSearchQuery","searchTextMessagesLocal","toggleManagement","openHistoryCalendar"])))((({isColumnOpen:e,isProfile:t,isSearch:s,isManagement:a,isStickerSearch:n,isGifSearch:r,isPollResults:i,isAddingChatMembers:c,profileState:d,managementScreen:l,canManage:u,isChannel:g,onClose:p,messageSearchQuery:f,stickerSearchQuery:I,gifSearchQuery:v,setLocalTextSearchQuery:y,setStickerSearchQuery:Z,setGifSearchQuery:P,searchTextMessagesLocal:C,toggleManagement:w,openHistoryCalendar:b,shouldSkipAnimation:M})=>{var S;const E=(0,o.sO)(null),k=(0,o.I4)((e=>{y({query:e}),e.length&&dn(C)}),[C,y]),R=(0,o.I4)((e=>{Z({query:e})}),[Z]),T=(0,o.I4)((e=>{P({query:e})}),[P]),[N,B]=(0,o.eJ)(!e);(0,o.d4)((()=>{setTimeout((()=>{B(!e)}),300)}),[e]);const x=(0,fe.Z)(),L=t?d===h.vi.Profile?ln.Profile:d===h.vi.SharedMedia?ln.SharedMedia:d===h.vi.MemberList?ln.MemberList:-1:s?ln.Search:i?ln.PollResults:n?ln.StickerSearch:r?ln.GifSearch:c?ln.AddingMembers:a?l===h.u1.Initial?ln.ManageInitial:l===h.u1.ChatPrivacyType?ln.ManageChatPrivacyType:l===h.u1.Discussion?ln.ManageDiscussion:l===h.u1.ChannelSubscribers?ln.ManageChannelSubscribers:l===h.u1.GroupPermissions?ln.ManageGroupPermissions:l===h.u1.ChatAdministrators?ln.ManageChatAdministrators:l===h.u1.GroupRemovedUsers?ln.ManageGroupRemovedUsers:l===h.u1.GroupUserPermissionsCreate?ln.ManageGroupUserPermissionsCreate:l===h.u1.GroupUserPermissions?ln.ManageGroupUserPermissions:l===h.u1.GroupRecentActions?ln.ManageGroupRecentActions:l===h.u1.ChatAdminRights?ln.ManageGroupAdminRights:l===h.u1.GroupMembers?ln.ManageGroupMembers:void 0:void 0,O=null!==(S=(0,rt.Z)(L,!0))&&void 0!==S?S:-1;function U(){if(-1!==O)switch(O){case ln.PollResults:return o.ZP.createElement("h3",null,x("PollResults"));case ln.Search:return o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement(Pe.Z,{parentContainerClassName:"RightSearch",value:f,onChange:k}),o.ZP.createElement(Ze.Z,{round:!0,size:"smaller",color:"translucent",onClick:()=>b({selectedAt:(0,A._F)(Date.now())}),ariaLabel:"Search messages by date"},o.ZP.createElement("i",{className:"icon-calendar"})));case ln.AddingMembers:return o.ZP.createElement("h3",null,x("GroupAddMembers"));case ln.ManageInitial:return o.ZP.createElement("h3",null,x("Edit"));case ln.ManageChatPrivacyType:return o.ZP.createElement("h3",null,x(g?"ChannelTypeHeader":"GroupTypeHeader"));case ln.ManageDiscussion:return o.ZP.createElement("h3",null,x("Discussion"));case ln.ManageChatAdministrators:return o.ZP.createElement("h3",null,x("ChannelAdministrators"));case ln.ManageGroupRecentActions:return o.ZP.createElement("h3",null,x("Group.Info.AdminLog"));case ln.ManageGroupAdminRights:return o.ZP.createElement("h3",null,x("EditAdminRights"));case ln.ManageGroupPermissions:return o.ZP.createElement("h3",null,x("ChannelPermissions"));case ln.ManageGroupRemovedUsers:return o.ZP.createElement("h3",null,x("ChannelBlockedUsers"));case ln.ManageGroupUserPermissionsCreate:return o.ZP.createElement("h3",null,x("ChannelAddException"));case ln.ManageGroupUserPermissions:return o.ZP.createElement("h3",null,x("UserRestrictions"));case ln.StickerSearch:return o.ZP.createElement(Pe.Z,{value:I,placeholder:x("SearchStickersHint"),onChange:R});case ln.GifSearch:return o.ZP.createElement(Pe.Z,{value:v,placeholder:x("SearchGifsTitle"),onChange:T});case ln.SharedMedia:return o.ZP.createElement("h3",null,x("SharedMedia"));case ln.ManageChannelSubscribers:return o.ZP.createElement("h3",null,x("ChannelSubscribers"));case ln.MemberList:case ln.ManageGroupMembers:return o.ZP.createElement("h3",null,x("GroupMembers"));default:return o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement("h3",null,"Profile"),o.ZP.createElement("section",{className:"tools"},u&&o.ZP.createElement(Ze.Z,{round:!0,color:"translucent",size:"smaller",ariaLabel:x("Edit"),onClick:w},o.ZP.createElement("i",{className:"icon-edit"}))))}}const F=m.wB||L===ln.SharedMedia||L===ln.MemberList||L===ln.AddingMembers||a,$=(0,ne.Z)("animated-close-icon",(N||M)&&"no-transition");return(0,o.d4)((()=>{E.current.classList.toggle("state-back",F)}),[F]),o.ZP.createElement("div",{className:"RightHeader"},o.ZP.createElement(Ze.Z,{className:"close-button",round:!0,color:"translucent",size:"smaller",onClick:p,ariaLabel:x(F?"Common.Back":"Common.Close")},o.ZP.createElement("div",{ref:E,className:$})),o.ZP.createElement(ge.Z,{name:N||M?"none":"slide-fade",activeKey:O},U))})));var hn=s(7407);function mn(e,t,s,a,r,i){const c=(0,o.sO)();(0,de.Z)((()=>{t===e&&r&&i&&(c.current=(0,d.R5)(r,i,e).reverse())}),[r,i,t,e]);const[l,u]=(0,hn.Z)(a?s:void 0,c.current,void 0,"media"===e?n.EN:n.pn);return[l,u,!(!l||!c.current||l[0]===c.current[0])]}const gn=(0,y.P2)((e=>e()),250,!1);let pn=!1;var fn=s(1273),In=s(1876),vn=s(9411),yn=s(2937);const Zn=(0,o.X$)((({chat:e,user:t,photo:s,isFirstPhoto:a,isSavedMessages:n,lastSyncTime:r,onClick:i})=>{const c=(0,fe.Z)(),l=t&&(0,d.NB)(t);function h(a="big",o){if(s&&!o)return`photo${s.id}?size=c`;let r;return n||l||(t?r=(0,d.RT)(t,a):e&&(r=(0,d.RT)(e,a))),r}const m=h(),g=(0,gt.Z)(m,!1,u.IU.BlobUrl,r),p=(0,gt.Z)(!g&&a?h("normal",!0):void 0,!1,u.IU.BlobUrl,r),f=(0,yn.Z)(!g&&s&&s.thumbnail&&s.thumbnail.dataUri),I=g||p||f,v=(0,us.Z)(I);let y="";if(n)y=o.ZP.createElement("i",{className:"icon-avatar-saved-messages"});else if(l)y=o.ZP.createElement("i",{className:"icon-avatar-deleted-account"});else if(I)y=o.ZP.createElement("img",{src:I,className:"avatar-media",alt:"",decoding:"async"});else if(!I&&t){const e=(0,d.Js)(t);y=e?(0,it.Xv)(e,2):void 0}else if(!I&&e){const t=(0,d.U)(c,e);y=t&&(0,it.Xv)(t,(0,d.YA)(e.id)?2:1)}else y=o.ZP.createElement("div",{className:"spinner-wrapper"},o.ZP.createElement(Se.Z,{color:"white"}));const Z=(0,ne.Z)("ProfilePhoto",`color-bg-${(0,d.Rs)(t||e)}`,n&&"saved-messages",l&&"deleted-account",!n&&!I&&"no-photo");return o.ZP.createElement("div",{className:Z,onClick:I?i:void 0},v&&I&&v!==I&&o.ZP.createElement("img",{src:v,className:"prev-avatar-media",alt:"",decoding:"async"}),"string"==typeof y?(0,mt.Z)(y,["hq_emoji"]):y)})),Pn=(0,o.X$)((0,a.c$)(((e,{userId:t,forceShowSelf:s})=>{const{lastSyncTime:a,serverTimeOffset:n}=e,o=(0,i.dy)(e,t),r=(0,i.Z1)(e,t),c=!s&&o&&o.isSelf,{animationLevel:d}=e.settings.byKey;return{lastSyncTime:a,user:o,chat:r,isSavedMessages:c,animationLevel:d,serverTimeOffset:n}}),((e,t)=>(0,g.ei)(t,["loadFullUser","openMediaViewer"])))((({user:e,chat:t,isSavedMessages:s,lastSyncTime:a,animationLevel:n,loadFullUser:r,openMediaViewer:i,serverTimeOffset:c})=>{const{id:l}=e||{},{id:g}=t||{},p=e?(0,d.Js)(e):t?t.title:"",f=(e?e.photos:t?t.photos:void 0)||[],I=n>=1?"slide":"none",[v,y]=(0,o.eJ)(0),Z=s||f.length<=1||0===v,P=s||f.length<=1||v===f.length-1;(0,o.d4)((()=>{v>f.length&&y(Math.max(0,f.length-1))}),[v,f.length]);const C=(0,fe.Z)();(0,o.d4)((()=>{a&&l&&r({userId:l})}),[l,r,a]),function(e,t,s){(0,o.d4)((()=>{t.slice(s,s+4).forEach((e=>{Ct.UV(`photo${e.id}?size=c`)||Ct.he(`photo${e.id}?size=c`,u.IU.BlobUrl)}))}),[s,t])}(0,f,v);const w=(0,o.I4)((()=>{i({avatarOwnerId:l||g,profilePhotoIndex:v,origin:h.bZ.ProfileAvatar})}),[i,l,g,v]),b=(0,o.I4)((()=>{Z||y(v-1)}),[v,Z]),M=(0,o.I4)((()=>{P||y(v+1)}),[v,P]);if((0,o.d4)((()=>{const e=document.querySelector(".photo-wrapper");if(e)return(0,ke.s)(e,{onSwipe:m.$b?(e,t)=>{t===ke.e.Right?b():t===ke.e.Left&&M()}:void 0})}),[M,b]),!e&&!t)return;function S(){const a=!s&&f&&f.length>0?f[v]:void 0;return o.ZP.createElement(Zn,{key:v,user:e,chat:t,photo:a,isSavedMessages:s,isFirstPhoto:Z,onClick:w})}const E=e&&e.isVerified||t&&t.isVerified;return o.ZP.createElement("div",{className:"ProfileInfo",dir:C.isRtl?"rtl":void 0},o.ZP.createElement("div",{className:"photo-wrapper"},function(){if(!(s||!f||f.length<=1))return o.ZP.createElement("div",{className:"photo-dashes"},f.map(((e,t)=>o.ZP.createElement("span",{className:"photo-dash "+(t===v?"current":"")}))))}(),o.ZP.createElement(ge.Z,{activeKey:v,name:I,className:"profile-slide-container"},S),!Z&&o.ZP.createElement("button",{type:"button",className:"navigation prev","aria-label":C("AccDescrPrevious"),onClick:b}),!P&&o.ZP.createElement("button",{type:"button",className:"navigation next","aria-label":C("Next"),onClick:M})),o.ZP.createElement("div",{className:"info",dir:C.isRtl?"rtl":"auto"},s?o.ZP.createElement("div",{className:"title"},o.ZP.createElement("h3",{dir:"auto"},C("SavedMessages"))):o.ZP.createElement("div",{className:"title"},o.ZP.createElement("h3",{dir:"auto"},p&&(0,mt.Z)(p)),E&&o.ZP.createElement(vn.Z,null)),!s&&(e?o.ZP.createElement("div",{className:"status "+((0,d.kM)(e)?"online":"")},o.ZP.createElement("span",{className:"user-status",dir:"auto"},(0,d.Tq)(C,e,c))):o.ZP.createElement("span",{className:"status",dir:"auto"},(0,d.eA)(t)?C("Subscribers",t.membersCount,"i"):C("Members",t.membersCount,"i")))))})));var Cn=s(4319);const wn=(0,o.X$)((0,a.c$)(((e,{chatOrUserId:t})=>{const{lastSyncTime:s}=e,a=t?(0,i.Z1)(e,t):void 0,n=(0,d.YA)(t)?(0,i.dy)(e,t):void 0,o=a&&(0,d.i4)(a,(0,i.dZ)(e),(0,i.NJ)(e));return{lastSyncTime:s,chat:a,user:n,canInviteUsers:a&&!n&&(!(0,d.eA)(a)&&!(0,d.Mg)(a,"inviteUsers")||(0,d.VE)(a,"inviteUsers")),isMuted:o}}),((e,t)=>(0,g.ei)(t,["loadFullUser","updateChatMutedState","showNotification"])))((({lastSyncTime:e,user:t,chat:s,forceShowSelf:a,canInviteUsers:n,isMuted:r,loadFullUser:i,showNotification:c,updateChatMutedState:l})=>{const{id:u,fullInfo:h,username:m,phoneNumber:g,isSelf:p}=t||{},{id:f}=s||{},I=(0,fe.Z)();(0,o.d4)((()=>{e&&u&&i({userId:u})}),[i,u,e]);const v=(0,o.I4)((()=>{l({chatId:f,isMuted:!r})}),[f,r,l]);if(!s||s.isRestricted||p&&!a)return;function y(e,t){(0,Cn.TE)(e),c({message:`${t} was copied`})}const Z=g&&(0,Cs.WZ)(g),P=(0,d.hu)(s),C=h&&h.bio||(0,d.GM)(s);return o.ZP.createElement("div",{className:"ChatExtra"},Z&&!!Z.length&&o.ZP.createElement(In.Z,{icon:"phone",multiline:!0,narrow:!0,ripple:!0,onClick:()=>y(Z,I("Phone"))},o.ZP.createElement("span",{className:"title",dir:"auto"},Z),o.ZP.createElement("span",{className:"subtitle"},I("Phone"))),m&&o.ZP.createElement(In.Z,{icon:"mention",multiline:!0,narrow:!0,ripple:!0,onClick:()=>y(`@${m}`,I("Username"))},o.ZP.createElement("span",{className:"title",dir:"auto"},(0,mt.Z)(m)),o.ZP.createElement("span",{className:"subtitle"},I("Username"))),C&&!!C.length&&o.ZP.createElement(In.Z,{icon:"info",multiline:!0,narrow:!0,isStatic:!0},o.ZP.createElement("span",{className:"title",dir:"auto"},(0,mt.Z)(C,["br","links","emoji"])),o.ZP.createElement("span",{className:"subtitle"},I(u?"UserBio":"Info"))),(n||!m)&&P&&o.ZP.createElement(In.Z,{icon:"mention",multiline:!0,narrow:!0,ripple:!0,onClick:()=>y(P,I("SetUrlPlaceholder"))},o.ZP.createElement("div",{className:"title"},P),o.ZP.createElement("span",{className:"subtitle"},I("SetUrlPlaceholder"))),o.ZP.createElement(In.Z,{icon:"unmute",ripple:!0,onClick:v},o.ZP.createElement("span",null,I("Notifications")),o.ZP.createElement(we,{id:"group-notifications",label:u?"Toggle User Notifications":"Toggle Chat Notifications",checked:!r,inactive:!0})))})));var bn=s(3709),Mn=s(5418),Sn=s(7262),En=s(1151),kn=s(3103);const Rn=(0,o.X$)((0,a.c$)(((e,{userId:t})=>{const s=(0,i.jr)(e),a=t&&(0,i.dy)(e,t);return{chat:s,contactName:a?(0,d.Vl)(a):void 0}}),((e,t)=>(0,g.ei)(t,["deleteChatMember"])))((({isOpen:e,chat:t,userId:s,contactName:a,onClose:n,deleteChatMember:r})=>{const i=(0,fe.Z)(),c=(0,o.I4)((()=>{r({chatId:t.id,userId:s}),n()}),[t,r,n,s]);if(t&&s)return o.ZP.createElement(kn.Z,{isOpen:e,onClose:n,onEnter:c,className:"delete",title:i("GroupRemoved.Remove")},o.ZP.createElement("p",null,(0,mt.Z)(i("PeerInfo.Confirm.RemovePeer",a))),o.ZP.createElement(Ze.Z,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:c},i("lng_box_remove")),o.ZP.createElement(Ze.Z,{className:"confirm-dialog-button",isText:!0,onClick:n},i("Cancel")))}))),Tn=[{type:"media",title:"SharedMediaTab2"},{type:"documents",title:"SharedFilesTab2"},{type:"links",title:"SharedLinksTab2"},{type:"audio",title:"SharedMusicTab2"}];function Nn(e){return[`.shared-media-transition > div:only-child > .${e}-list > .scroll-item`,`.shared-media-transition > div.active > .${e}-list > .scroll-item`].join(", ")}const Bn=(0,o.X$)((0,a.c$)(((e,{chatId:t,userId:s})=>{const a=(0,i.Z1)(e,t),n=(0,i.Zw)(e,s||t),{currentType:o,resultsByType:r}=(0,i.we)(e)||{},{foundIds:c}=r&&o&&r[o]||{},{byId:l}=e.users,u=a&&(0,d.Bf)(a),h=a&&(0,d.eA)(a),m=u||h&&(0,d.Nl)(a),g=a&&a.fullInfo&&a.fullInfo.members,p=m&&a&&a.fullInfo&&!a.fullInfo.canViewMembers,f=m&&a&&((0,d.VE)(a,"inviteUsers")||a.isCreator),I=m&&a&&((0,d.VE)(a,"banUsers")||a.isCreator);let v;return s?v=s:(0,d.YA)(t)&&(v=t),{theme:(0,i.Pu)(e),isChannel:h,resolvedUserId:v,chatMessages:n,foundIds:c,mediaSearchType:o,hasMembersTab:m,areMembersHidden:p,canAddMembers:f,canDeleteMembers:I,currentUserId:e.currentUserId,isRightColumnShown:(0,i.Jf)(e),isRestricted:a&&a.isRestricted,lastSyncTime:e.lastSyncTime,serverTimeOffset:e.serverTimeOffset,...m&&g&&{members:g,usersById:l}}}),((e,t)=>(0,g.ei)(t,["setLocalMediaSearchType","loadMoreMembers","searchMediaMessagesLocal","openMediaViewer","openAudioPlayer","openUserInfo","focusMessage","loadProfilePhotos","setNewChatMembersDialogState"])))((({chatId:e,profileState:t,onProfileStateChange:s,theme:a,isChannel:r,resolvedUserId:i,currentUserId:c,chatMessages:l,foundIds:g,mediaSearchType:p,hasMembersTab:f,areMembersHidden:I,canAddMembers:v,canDeleteMembers:y,members:Z,usersById:P,isRightColumnShown:C,isRestricted:w,lastSyncTime:b,setLocalMediaSearchType:M,loadMoreMembers:S,searchMediaMessagesLocal:E,openMediaViewer:k,openAudioPlayer:R,openUserInfo:T,focusMessage:N,loadProfilePhotos:B,setNewChatMembersDialogState:x,serverTimeOffset:A})=>{const L=(0,o.sO)(null),O=(0,o.sO)(null),U=(0,fe.Z)(),[F,$]=(0,o.eJ)(0),[Q,D]=(0,o.eJ)(),q=(0,o.Ye)((()=>[...f?[{type:"members",title:r?"ChannelSubscribers":"GroupMembers"}]:[],...Tn]),[f,r]),G=q[F].type,[H,j,_,V]=function(e,t,s,a,r,i,c,l,u,h,m,g=0){const p="members"!==a&&r?r:a,f=(0,o.Ye)((()=>{if(i&&c)return(0,d.Z0)(i.map((({userId:e})=>e)),c,void 0,g)}),[i,g,c]),[I,v,y]=function(e,t,s,a){const[o,r]=(0,hn.Z)(s?t:void 0,a,void 0,n.Vk);return[o,r,!(!o||!a||o[0]===a[0])]}(0,t,m,f),[Z,P,C]=mn("media",p,s,m,l,u),[w,b,M]=mn("documents",p,s,m,l,u),[S,E,k]=mn("links",p,s,m,l,u),[R,T,N]=mn("audio",p,s,m,l,u);let B,x,A=!1;switch(p){case"members":B=I,x=v,A=y;break;case"media":B=Z,x=P,A=C;break;case"documents":B=w,x=b,A=M;break;case"links":B=S,x=E,A=k;break;case"audio":B=R,x=T,A=N}return[p,B,x,A]}(0,S,E,G,p,Z,P,l,g,0,b,A),X=q.findIndex((({type:e})=>e===H)),{handleScroll:K}=function(e,t,s,a){(0,Et.Z)((([s])=>{if(s&&s!==t){const s=e.current,n=s.querySelector(".TabList");s.scrollTop<n.offsetTop&&(a("members"===t?h.vi.MemberList:h.vi.SharedMedia),pn=!0,(0,Bt.Z)(s,n,"start",void 0,void 0,void 0,300),setTimeout((()=>{pn=!1}),350))}}),[t,a]),(0,Et.Z)((([t])=>{if(s!==h.vi.Profile||s===t)return;const n=e.current;if(!n)return;const o=n.querySelector(".TabList");!o||o.offsetTop>n.scrollTop||(pn=!0,(0,Bt.Z)(n,n.firstElementChild,"start",void 0,2*n.offsetHeight),setTimeout((()=>{pn=!1}),350),a(s))}),[s]);const n=(0,o.I4)((()=>{const s=e.current;if(!s)return;const n=s.querySelector(".TabList");if(!n)return;let o=h.vi.Profile;s.scrollTop>=n.offsetTop&&(o="members"===t?h.vi.MemberList:h.vi.SharedMedia),a(o)}),[e,a,t]);return(0,o.d4)((()=>{pn||n()}),[n,t]),{handleScroll:(0,o.I4)((()=>{pn||gn(n)}),[n])}}(L,G,t,s),{applyTransitionFix:W,releaseTransitionFix:z}=function(e,t=".Transition.shared-media-transition"){return(0,o.d4)((()=>{function s(){const s=e.current,a=s.querySelector(t),n=s.querySelector(".TabList");a&&n&&(a.style.minHeight=s.offsetHeight-n.offsetHeight+"px")}return s(),window.addEventListener("resize",s,!1),()=>{window.removeEventListener("resize",s,!1)}}),[e,t]),{applyTransitionFix:(0,o.I4)((()=>{const t=e.current;if("hidden"!==t.style.overflowY){const e=t.offsetWidth-t.clientWidth;t.style.overflowY="hidden",t.style.marginRight=`${e}px`}}),[e]),releaseTransitionFix:(0,o.I4)((()=>{const t=e.current;t.style.overflowY="scroll",t.style.marginRight="0"}),[e])}}(L),[Y,J]=(()=>{const[e,t]=(0,o.eJ)(!1);return[e,(0,o.I4)((()=>{t((e=>!e))}),[])]})(),ee=(0,o.I4)((()=>{z(),J()}),[z,J]),te=(0,o.I4)((()=>{x(h.WB.InProgress)}),[x]);(0,o.d4)((()=>{M({mediaType:G})}),[M,G]);const se=i||e;(0,o.d4)((()=>{b&&B({profileId:se})}),[B,se,b]);const ae=(0,o.I4)((e=>{k({chatId:se,threadId:u._f,messageId:e,origin:h.bZ.SharedMedia})}),[se,k]),ne=(0,o.I4)((e=>{R({chatId:se,messageId:e})}),[se,R]),oe=(0,o.I4)((e=>{T({id:e})}),[T]),re=(0,o.I4)((e=>{N({chatId:se,messageId:e})}),[se,N]),ie=(0,o.I4)((()=>{D(void 0)}),[]);let ce;(0,o.d4)((()=>{if(O.current&&m.$b)return(0,ke.s)(O.current,{onSwipe:(e,t)=>{t===ke.e.Left?$(Math.min(F+1,q.length-1)):t===ke.e.Right&&$(Math.max(0,F-1))}})}),[F,q.length]);const de="members"===H||!f&&"media"===H;de?ce=C?0:1e3:j||(ce=n.Y);const le=(0,Ga.Z)([e,H],ce);function ue(e){return e!==c&&y?[{title:U("lng_context_remove_from_group"),icon:"stop",handler:()=>{D(e)}}]:void 0}function he(){if(!j||!le||!l){const e=de&&j&&!le;return o.ZP.createElement("div",{className:"content empty-list"},!e&&o.ZP.createElement(Se.Z,null))}if(!j.length){let e;switch(H){case"members":e=I?"You have no access to group members list.":"No members found";break;case"documents":e=U("lng_media_file_empty_search");break;case"links":e=U("lng_media_link_empty_search");break;case"audio":e=U("lng_media_song_empty_search");break;default:e=U("SharedMedia.EmptyTitle")}return o.ZP.createElement("div",{className:"content empty-list"},o.ZP.createElement(Sn.Z,{text:e}))}return o.ZP.createElement("div",{className:`content ${H}-list`,dir:U.isRtl&&"media"===H?"rtl":void 0,teactFastList:!0},"media"===H?j.map((e=>l[e]&&o.ZP.createElement(bn.Z,{key:e,message:l[e],onClick:ae}))):"documents"===H?j.map((e=>l[e]&&o.ZP.createElement(Jt.Z,{key:e,message:l[e],withDate:!0,smaller:!0,className:"scroll-item",onDateClick:re}))):"links"===H?j.map((e=>l[e]&&o.ZP.createElement(Mn.Z,{key:e,message:l[e],onMessageClick:re}))):"audio"===H?j.map((e=>l[e]&&o.ZP.createElement(es.Z,{key:e,theme:a,message:l[e],target:"sharedMedia",date:l[e].date,lastSyncTime:b,className:"scroll-item",onPlay:ne,onDateClick:re}))):"members"===H?j.map(((e,t)=>o.ZP.createElement(In.Z,{key:e,teactOrderKey:t,className:"chat-item-clickable scroll-item small-icon",onClick:()=>oe(e),contextActions:ue(e)},o.ZP.createElement(ct.Z,{userId:e,forceShowSelf:!0})))):void 0)}return o.ZP.createElement(fn.Z,{ref:L,className:"Profile custom-scroll",itemSelector:Nn(H),items:le?j:void 0,cacheBuster:Y,sensitiveArea:n.qU,preloadBackwards:le?"members"===H?n.Vk:n.EN:0,noScrollRestoreOnTop:!0,noFastList:!0,onLoadMore:_,onScroll:K},!V&&function(e,t){return o.ZP.createElement("div",{className:"profile-info"},o.ZP.createElement(Pn,{userId:t||e,forceShowSelf:t!==e}),o.ZP.createElement(wn,{chatOrUserId:t||e,forceShowSelf:t!==e}))}(e,i),!w&&o.ZP.createElement("div",{className:"shared-media"},o.ZP.createElement(ge.Z,{ref:O,name:U.isRtl?"slide-reversed":"slide",activeKey:X,renderCount:q.length,shouldRestoreHeight:!0,className:"shared-media-transition",onStart:W,onStop:ee},he),o.ZP.createElement(Re.Z,{big:!0,activeTab:F,tabs:q,onSwitchTab:$})),v&&o.ZP.createElement(En.Z,{isShown:"members"===H,onClick:te,ariaLabel:U("lng_channel_add_users")},o.ZP.createElement("i",{className:"icon-add-user-filled"})),y&&o.ZP.createElement(Rn,{isOpen:Boolean(Q),userId:Q,onClose:ie}))}))),xn=(0,o.X$)((e=>{const t=(0,xe.Z)(Be.gl.Extra,"RightSearch");return t?o.ZP.createElement(t,e):o.ZP.createElement(Ae.Z,null)})),An=(0,o.X$)((e=>{const t=(0,xe.Z)(Be.gl.Extra,"Management");return t?o.ZP.createElement(t,e):o.ZP.createElement(Ae.Z,null)})),Ln=(0,o.X$)((()=>{const e=(0,xe.Z)(Be.gl.Extra,"StickerSearch");return e?o.ZP.createElement(e,null):o.ZP.createElement(Ae.Z,null)})),On=(0,o.X$)((()=>{const e=(0,xe.Z)(Be.gl.Extra,"GifSearch");return e?o.ZP.createElement(e,null):o.ZP.createElement(Ae.Z,null)})),Un=(0,o.X$)((()=>{const e=(0,xe.Z)(Be.gl.Extra,"PollResults");return e?o.ZP.createElement(e,null):o.ZP.createElement(Ae.Z,null)}));var Fn=s(1820);const $n=(0,o.X$)((0,a.c$)(((e,{chatId:t})=>{const s=(0,i.Z1)(e,t),{userIds:a}=e.contactList||{},{byId:n}=e.users,{byId:o}=e.chats,{currentUserId:r,newChatMembersProgress:c,connectionState:l}=e,u=s&&(0,d.eA)(s),{query:m,fetchingStatus:g,globalUserIds:p,localUserIds:f}=e.userSearch;return{isChannel:u,members:s&&s.fullInfo?s.fullInfo.members:void 0,currentUserId:r,usersById:n,chatsById:o,localContactIds:a,searchQuery:m,isSearching:g,isLoading:c===h.WB.Loading,globalUserIds:p,localUserIds:f,connectionState:l}}),((e,t)=>(0,g.ei)(t,["loadContactList","setUserSearchQuery"])))((({isChannel:e,connectionState:t,members:s,onNextStep:a,currentUserId:n,usersById:r,chatsById:i,localContactIds:c,isLoading:l,searchQuery:u,isSearching:h,localUserIds:m,globalUserIds:p,setUserSearchQuery:f,onClose:I,isActive:v,loadContactList:y})=>{const Z=(0,fe.Z)(),[P,C]=(0,o.eJ)([]),w=(0,us.Z)(P)===P;(0,o.d4)((()=>{v&&"connectionStateReady"===t&&y()}),[t,v,y]),(0,ue.ZP)(v,I);const b=(0,o.Ye)((()=>s?s.map((e=>e.userId)):[]),[s]),M=(0,o.I4)((e=>{f({query:e})}),[f]),S=(0,o.Ye)((()=>{const t=c?(0,d.ih)(c.filter((e=>e!==n)),i):[];if(!u)return t.filter((e=>!b.includes(e)));const s=t.filter((e=>{const t=r[e];if(!t)return!1;const s=(0,d.Js)(t);return s&&(0,N.Z)(s,u)}));return(0,d.ih)((0,g.Tw)([...s,...m||[],...p||[]]).filter((t=>{const s=r[t];return!b.includes(t)&&(!s||!(0,d.cS)(s)||!e&&s.canBeInvitedToGroup)})),i)}),[c,i,u,m,p,n,r,b,e]),E=(0,o.I4)((()=>{P.length&&(f({query:""}),a(P))}),[P,f,a]);return o.ZP.createElement("div",{className:"AddChatMembers"},o.ZP.createElement("div",{className:"AddChatMembers-inner"},o.ZP.createElement(Fn.Z,{itemIds:S,selectedIds:P,filterValue:u,filterPlaceholder:Z("lng_channel_add_users"),searchInputId:"new-members-picker-search",isLoading:h,onSelectedIdsChange:C,onFilterChange:M,noScrollRestore:w}),o.ZP.createElement(En.Z,{isShown:Boolean(P.length),disabled:l,ariaLabel:Z("lng_channel_add_users"),onClick:E},l?o.ZP.createElement(Se.Z,{color:"white"}):o.ZP.createElement("i",{className:"icon-arrow-right"}))))}))),Qn=Object.keys(h.qt).length/2,Dn=Object.keys(h.u1).length/2;function qn(){const e=document.querySelector(".RightHeader .SearchInput input");e&&e.blur()}const Gn=(0,o.X$)((0,a.c$)((e=>{const{chatId:t,threadId:s}=(0,i.Bt)(e)||{},a=(0,i.g4)(e);return{contentKey:(0,i.Wq)(e),chatId:t,threadId:s,currentProfileUserId:e.users.selectedId,isChatSelected:Boolean(t&&a),shouldSkipHistoryAnimations:e.shouldSkipHistoryAnimations}}),((e,t)=>(0,g.ei)(t,["openUserInfo","toggleChatInfo","toggleManagement","closeLocalTextSearch","setStickerSearchQuery","setGifSearchQuery","closePollResults","addChatMembers","setNewChatMembersDialogState"])))((({contentKey:e,chatId:t,threadId:s,currentProfileUserId:a,isChatSelected:r,toggleChatInfo:i,toggleManagement:c,openUserInfo:d,closeLocalTextSearch:l,setStickerSearchQuery:u,setGifSearchQuery:m,closePollResults:g,addChatMembers:p,setNewChatMembersDialogState:f,shouldSkipHistoryAnimations:I})=>{var v;const{width:y}=et(),[Z,P]=(0,o.eJ)(h.vi.Profile),[C,w]=(0,o.eJ)(h.u1.Initial),[b,M]=(0,o.eJ)(),[S,E]=(0,o.eJ)(),k=Z!==h.vi.Profile,R=void 0!==e,T=e===h.qt.ChatInfo||e===h.qt.UserInfo,N=e===h.qt.Search,B=e===h.qt.Management,x=e===h.qt.StickerSearch,A=e===h.qt.GifSearch,L=e===h.qt.PollResults,O=e===h.qt.AddingMembers,U=y<=n._m,[F,$]=(0,o.eJ)(!R),Q=null!==(v=(0,rt.Z)(e,!0,!r))&&void 0!==v?v:-1,D=(0,o.I4)(((t=!0)=>{switch(e){case h.qt.AddingMembers:f(h.WB.Closed);break;case h.qt.ChatInfo:if(k&&t){P(h.vi.Profile);break}i(void 0,!0);break;case h.qt.UserInfo:if(k&&t){P(h.vi.Profile);break}d({id:void 0},!0);break;case h.qt.Management:switch(C){case h.u1.Initial:c();break;case h.u1.ChatPrivacyType:case h.u1.Discussion:case h.u1.GroupPermissions:case h.u1.GroupType:case h.u1.ChatAdministrators:case h.u1.ChannelSubscribers:case h.u1.GroupMembers:w(h.u1.Initial);break;case h.u1.GroupUserPermissionsCreate:case h.u1.GroupRemovedUsers:case h.u1.GroupUserPermissions:w(h.u1.GroupPermissions),M(void 0),E(void 0);break;case h.u1.ChatAdminRights:case h.u1.GroupRecentActions:w(h.u1.ChatAdministrators)}break;case h.qt.Search:qn(),l();break;case h.qt.StickerSearch:qn(),u({query:void 0});break;case h.qt.GifSearch:qn(),m({query:void 0});break;case h.qt.PollResults:g()}}),[e,k,i,d,g,f,C,c,l,u,m]),q=(0,o.I4)(((e,t)=>{M(e),E(t)}),[]),G=(0,o.I4)((e=>{p({chatId:t,memberIds:e})}),[p,t]);function H(e){if(-1!==Q)switch(Q){case h.qt.AddingMembers:return o.ZP.createElement($n,{chatId:t,onNextStep:G,isActive:R&&e,onClose:D});case h.qt.ChatInfo:case h.qt.UserInfo:return o.ZP.createElement(Bn,{key:a||t,chatId:t,userId:a,profileState:Z,onProfileStateChange:P});case h.qt.Search:return o.ZP.createElement(xn,{chatId:t,threadId:s,onClose:D,isActive:R&&e});case h.qt.Management:return o.ZP.createElement(An,{chatId:t,currentScreen:C,isPromotedByCurrentUser:S,selectedChatMemberId:b,onScreenSelect:w,onChatMemberSelect:q,isActive:R&&e,onClose:D});case h.qt.StickerSearch:return o.ZP.createElement(Ln,{onClose:D,isActive:R&&e});case h.qt.GifSearch:return o.ZP.createElement(On,{onClose:D,isActive:R&&e});case h.qt.PollResults:return o.ZP.createElement(Un,{onClose:D,isActive:R&&e})}}return(0,o.d4)((()=>R?(0,he.Z)(D):void 0),[R,D]),(0,o.d4)((()=>{setTimeout((()=>{$(!R)}),300)}),[R]),(0,o.d4)((()=>{R&&U&&D()}),[U]),(0,St.Z)((([s,a])=>{(s===h.qt.ChatInfo&&e===h.qt.UserInfo||s===h.qt.UserInfo&&e===h.qt.ChatInfo||a!==t)&&(P(h.vi.Profile),w(h.u1.Initial))}),[e,t]),(0,ue.ZP)(r&&(e===h.qt.ChatInfo||e===h.qt.UserInfo||e===h.qt.Management||e===h.qt.AddingMembers),(()=>D(!1)),i),o.ZP.createElement("div",{id:"RightColumn-wrapper",className:r?void 0:"is-hidden"},U&&o.ZP.createElement("div",{className:"overlay-backdrop",onClick:D}),o.ZP.createElement("div",{id:"RightColumn"},o.ZP.createElement(un,{chatId:t,isColumnOpen:R,isProfile:T,isSearch:N,isManagement:B,isStickerSearch:x,isGifSearch:A,isPollResults:L,isAddingChatMembers:O,profileState:Z,managementScreen:C,onClose:D,shouldSkipAnimation:F||I}),o.ZP.createElement(ge.Z,{name:F||I?"none":"zoom-fade",renderCount:Qn+Dn,activeKey:B?Qn+C:Q,shouldCleanup:!0,cleanupExceptionKey:h.qt.ChatInfo},H)))}))),Hn=(0,o.X$)((({isOpen:e})=>{const t=(0,xe.Z)(Be.gl.Extra,"MediaViewer",!e);return t?o.ZP.createElement(t,null):void 0})),jn=(0,o.X$)((({isOpen:e})=>{const t=(0,xe.Z)(Be.gl.Extra,"Notifications",!e);return t?o.ZP.createElement(t,null):void 0})),_n=(0,o.X$)((({isOpen:e})=>{const t=(0,xe.Z)(Be.gl.Extra,"Dialogs",!e);return t?o.ZP.createElement(t,null):void 0})),Vn=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"ForwardPicker",!t);return s?o.ZP.createElement(s,e):void 0})),Xn=(0,o.X$)((e=>{const{url:t}=e,s=(0,xe.Z)(Be.gl.Extra,"SafeLinkModal",!t);return s?o.ZP.createElement(s,e):void 0})),Kn=(0,o.X$)((e=>{const{isOpen:t}=e,s=(0,xe.Z)(Be.gl.Extra,"HistoryCalendar",!t);return s?o.ZP.createElement(s,e):void 0}));let Wn,zn=!1;function Yn(e){document.querySelectorAll('link[rel="icon"]').forEach((t=>{e?t.href.includes("favicon-unread")||(t.href=t.href.replace("favicon","favicon-unread")):t.href=t.href.replace("favicon-unread","favicon")}))}function Jn(e){document.title!==e&&(document.title=e)}const eo=(0,o.X$)((0,a.c$)((e=>{const{chatId:t,messageId:s}=e.audioPlayer,a=t&&s?(0,i.hj)(e,t,s):void 0;return{animationLevel:e.settings.byKey.animationLevel,lastSyncTime:e.lastSyncTime,isLeftColumnShown:e.isLeftColumnShown,isRightColumnShown:(0,i.Jf)(e),isMediaViewerOpen:(0,i.zQ)(e),isForwardModalOpen:(0,i.Ev)(e),hasNotifications:Boolean(e.notifications.length),hasDialogs:Boolean(e.dialogs.length),audioMessage:a,safeLinkModalUrl:e.safeLinkModalUrl,isHistoryCalendarOpen:Boolean(e.historyCalendarSelectedAt),shouldSkipHistoryAnimations:e.shouldSkipHistoryAnimations,language:e.settings.byKey.language,openedStickerSetShortName:e.openedStickerSetShortName}}),((e,t)=>(0,g.ei)(t,["loadAnimatedEmojis","loadNotificationSettings","loadNotificationExceptions","updateIsOnline","loadTopInlineBots","loadEmojiKeywords","openStickerSetShortName"])))((({lastSyncTime:e,isLeftColumnShown:t,isRightColumnShown:s,isMediaViewerOpen:r,isForwardModalOpen:c,animationLevel:d,hasNotifications:l,hasDialogs:u,audioMessage:h,safeLinkModalUrl:g,isHistoryCalendarOpen:p,shouldSkipHistoryAnimations:f,language:I,openedStickerSetShortName:v,loadAnimatedEmojis:Z,loadNotificationSettings:P,loadNotificationExceptions:C,updateIsOnline:w,loadTopInlineBots:b,loadEmojiKeywords:M,openStickerSetShortName:S})=>{n.eM&&!zn&&(zn=!0,console.log(">>> RENDER MAIN")),(0,o.d4)((()=>{e&&(w(!0),Z(),P(),C(),b(),M({language:n.pR}),I!==n.pR&&M({language:I}))}),[e,Z,C,P,w,b,M,I]),(0,o.d4)((()=>{e&&ue.Oy.startsWith("#?tgaddr=")&&(e=>{const{protocol:t,searchParams:s,pathname:n}=new URL(e);if("tg:"!==t)return;const{openChatByUsername:o,openStickerSetShortName:r}=(0,a.uC)(),i=n.replace(/^\/\//,""),c={};switch(s.forEach(((e,t)=>{c[t]=e})),i){case"resolve":{const{domain:e}=c;"telegrampassport"!==e&&o({username:e});break}case"privatepost":case"bg":case"join":break;case"addstickers":{const{set:e}=c;r({stickerSetShortName:e});break}}})(decodeURIComponent(ue.Oy.substr("#?tgaddr=".length)))}),[e]);const{transitionClassNames:E}=(0,re.Z)(!t,void 0,!0,void 0,f),{transitionClassNames:k}=(0,re.Z)(s,void 0,!0,void 0,f),R=(0,ne.Z)(E.replace(/([\w-]+)/g,"middle-column-$1"),k.replace(/([\w-]+)/g,"right-column-$1"),f&&"history-animation-disabled");(0,de.Z)((([e])=>{if(void 0===e||0===d)return;const t=(0,ae.YW)();(0,oe.L)(document.getElementById("MiddleColumn"),t)}),[t]),(0,de.Z)((([e])=>{if(void 0===e||0===d)return;(0,y.T2)((()=>{document.body.classList.add("animating-right-column")}));const t=(0,ae.YW)();(0,oe.L)(document.getElementById("RightColumn"),(()=>{t(),(0,y.T2)((()=>{document.body.classList.remove("animating-right-column")}))}))}),[s]);const T=(0,o.I4)((()=>{w(!1);const e=(0,i.A1)((0,a.Rd)());let t=0;clearInterval(Wn),Wn=window.setInterval((()=>{if(document.title.includes(n.ou))Yn(!1);else{if(t%2==0){const t=(0,i.A1)((0,a.Rd)())-e;t>0&&(Jn(`${t} notification${t>1?"s":""}`),Yn(!0))}else Jn(n.Ti),Yn(!1);t++}}),1e3)}),[w]),N=(0,o.I4)((()=>{w(!0),clearInterval(Wn),Wn=void 0,document.title.includes(n.ou)||Jn(n.Ti),Yn(!1)}),[w]),B=(0,o.I4)((()=>{S({stickerSetShortName:void 0})}),[S]);function x(e){e.preventDefault(),e.stopPropagation()}return(0,ie.Z)(T,N),ce(T),function(e=!1){(0,o.d4)((()=>{if(m.cj&&!e)return document.addEventListener("gesturestart",le),()=>{document.removeEventListener("gesturestart",le)}}),[e])}(r),o.ZP.createElement("div",{id:"Main",className:R,onDrop:x,onDragOver:x},o.ZP.createElement(Ke,null),o.ZP.createElement(cn,null),o.ZP.createElement(Gn,null),o.ZP.createElement(Hn,{isOpen:r}),o.ZP.createElement(Vn,{isOpen:c}),o.ZP.createElement(jn,{isOpen:l}),o.ZP.createElement(_n,{isOpen:u}),h&&o.ZP.createElement(bt,{key:h.id,message:h,noUi:!0}),o.ZP.createElement(Xn,{url:g}),o.ZP.createElement(Kn,{isOpen:p}),o.ZP.createElement(os.Z,{isOpen:Boolean(v),onClose:B,stickerSetShortName:v}))})));n.eM&&console.log(">>> FINISH LOAD MAIN BUNDLE"),(0,a.Rd)().connectionState||(0,a.uC)().initApi()}}]);
//# sourceMappingURL=923.c17c0e40e2a0e4c583b5.js.map