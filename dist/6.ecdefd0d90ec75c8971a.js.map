{"version":3,"sources":["webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/croppie/croppie.js","webpack:///./node_modules/timers-browserify/main.js","webpack:///./node_modules/setimmediate/setImmediate.js","webpack:///./node_modules/process/browser.js"],"names":["g","this","Function","e","window","module","exports","self","Promise","a","b","apply","arguments","c","TypeError","_state","_value","_deferreds","i","f","d","push","k","onFulfilled","onRejected","reject","resolve","then","call","length","h","j","setTimeout","setImmediate","l","Array","isArray","Object","prototype","toString","all","slice","constructor","race","_setImmediateFn","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event","HTMLCanvasElement","toBlob","defineProperty","value","callback","type","quality","binStr","atob","toDataURL","split","len","arr","Uint8Array","charCodeAt","Blob","CSS_TRANS_ORG","CSS_TRANSFORM","CSS_USERSELECT","cssPrefixes","emptyStyles","createElement","style","EXIF_NORM","EXIF_FLIP","vendorPrefix","prop","capProp","toUpperCase","deepExtend","destination","source","property","clone","object","dispatchChange","element","initEvent","dispatchEvent","fireEvent","css","el","styles","val","tmp","addClass","classList","add","className","setAttributes","attrs","key","setAttribute","num","v","parseInt","naturalImageDimensions","img","ornt","w","naturalWidth","naturalHeight","orient","getExifOrientation","x","width","height","TRANSLATE_OPTS","suffix","Transform","y","scale","parseFloat","parse","indexOf","fromMatrix","fromString","vals","substring","values","translate","Croppie","globals","TransformOrigin","exifdata","Orientation","drawCanvas","canvas","orientation","ctx","getContext","save","rotate","Math","PI","drawImage","restore","_create","boundary","viewport","overlay","bw","bh","customViewportClass","options","useCanvas","enableOrientation","_hasExif","data","elements","preview","isNaN","appendChild","customClass","_initDraggable","enableZoom","_initializeZoom","enableResize","_initializeResize","enableExif","EXIF","direction","originalX","originalY","maxWidth","maxHeight","vr","hr","wrap","isDragging","mouseDown","ev","button","preventDefault","overlayRect","getBoundingClientRect","pageX","pageY","currentTarget","touches","addEventListener","mouseMove","mouseUp","body","deltaX","deltaY","newHeight","newWidth","_updateOverlay","_updateZoomLimits","_updateCenterPoint","_triggerUpdate","removeEventListener","resizeControls","_setZoomerVal","z","zoomer","fix","max","min","zoomerWrap","change","_onZoom","origin","viewportRect","transform","scroll","delta","targetZoom","mouseWheelZoom","ctrlKey","wheelDelta","_currentZoom","step","display","showZoomer","ui","vpRect","applyCss","transCss","enforceBoundary","boundaries","_getVirtualBoundaries","transBoundaries","oBoundaries","maxX","minX","maxY","minY","_debouncedOverlay","vpWidth","vpHeight","centerFromBoundaryX","clientWidth","centerFromBoundaryY","clientHeight","imgRect","curImgWidth","curImgHeight","halfWidth","halfHeight","originMinX","originMinY","vpData","pc","top","left","center","adj","cx","cy","tx","ty","newCss","originalDistance","assignTransformCoordinates","bottom","right","toggleGrabState","touch1","touch2","dist","sqrt","zoom","shiftKey","keyCode","enableKeyMovement","movement","parseKeyDown","keyMove","setZoom","boundRect","imgData","func","wait","immediate","timeout","context","args","later","callNow","clearTimeout","get","_isVisible","update","$","Prototype","trigger","offsetHeight","offsetWidth","_updatePropertiesFromImage","cssReset","transformReset","originReset","bound","_originalImageWidth","_originalImageHeight","points","_bindPoints","_centerImage","initial","initialZoom","defaultInitialZoom","minW","minH","minZoom","maxZoom","boundaryData","boundZoom","pointsWidth","vpOffset","originTop","originLeft","transformTop","transformLeft","imgDim","vpDim","boundDim","vpLeft","vpTop","_transferImageToCanvas","customOrientation","clearRect","_getCanvas","circle","canvasWidth","outputWidth","canvasHeight","outputHeight","backgroundColor","fillStyle","fillRect","sx","sy","sWidth","sHeight","dx","dy","dWidth","dHeight","abs","globalCompositeOperation","beginPath","arc","closePath","fill","_getHtmlResult","div","src","url","_getBase64Result","format","_getBlobResult","blob","_replaceImage","parentNode","forEach","replaceChild","_bind","cb","doExif","hasExif","Image","opacity","_resolve","removeAttribute","match","onload","getData","onerror","relative","natDim","rect","aspectRatio","x0","y0","x1","y1","map","p","decimalPoints","toFixed","_get","widthDiff","heightDiff","x2","y2","Infinity","Number","NEGATIVE_INFINITY","RESULT_DEFAULTS","RESULT_FORMATS","_result","opts","resultType","size","ratio","toLowerCase","_refresh","_rotate","deg","index","offset","_destroy","removeChild","remove","replace","jQuery","fn","croppie","ot","singleInst","result","bind","each","method","isFunction","removeData","Error","defaults","tagName","origImage","replacementDiv","bindOpts","orientationControls","enabled","leftClass","rightClass","refresh","destroy","Timeout","id","clearFn","_id","_clearFn","scope","setInterval","clearInterval","close","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","global","clearImmediate","registerImmediate","html","channel","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","doc","attachTo","getPrototypeOf","process","handle","nextTick","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","port2","documentElement","script","onreadystatechange","random","attachEvent","task","run","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","marker","runClearTimeout","Item","array","noop","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask"],"mappings":"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","file":"6.ecdefd0d90ec75c8971a.js","sourcesContent":["var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/*************************\r\n * Croppie\r\n * Copyright 2019\r\n * Foliotek\r\n * Version: 2.6.4\r\n *************************/\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define(factory);\r\n    } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {\r\n        // CommonJS\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals\r\n        root.Croppie = factory();\r\n    }\r\n}(typeof self !== 'undefined' ? self : this, function () {\r\n\r\n    /* Polyfills */\r\n    if (typeof Promise !== 'function') {\r\n        /*! promise-polyfill 3.1.0 */\r\n        !function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if(\"object\"!==typeof this)throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!==typeof a)throw new TypeError(\"not a function\");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void k(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError(\"A promise cannot be resolved with itself.\");if(a&&(\"object\"===typeof a||\"function\"===typeof a)){var c=a.then;if(\"function\"===typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled=\"function\"===typeof a?a:null,this.onRejected=\"function\"===typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=setTimeout,k=\"function\"===typeof setImmediate&&setImmediate||function(a){j(a,1)},l=Array.isArray||function(a){return\"[object Array]\"===Object.prototype.toString.call(a)};c.prototype[\"catch\"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&(\"object\"===typeof g||\"function\"===typeof g)){var h=g.then;if(\"function\"===typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&\"object\"===typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},c._setImmediateFn=function(a){k=a},\"undefined\"!==typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this);\r\n    }\r\n\r\n    if ( typeof window.CustomEvent !== \"function\" ) {\r\n        (function(){\r\n            function CustomEvent ( event, params ) {\r\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\r\n                var evt = document.createEvent( 'CustomEvent' );\r\n                evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\r\n                return evt;\r\n            }\r\n            CustomEvent.prototype = window.Event.prototype;\r\n            window.CustomEvent = CustomEvent;\r\n        }());\r\n    }\r\n\r\n    if (!HTMLCanvasElement.prototype.toBlob) {\r\n        Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\r\n            value: function (callback, type, quality) {\r\n                var binStr = atob( this.toDataURL(type, quality).split(',')[1] ),\r\n                len = binStr.length,\r\n                arr = new Uint8Array(len);\r\n\r\n                for (var i=0; i<len; i++ ) {\r\n                    arr[i] = binStr.charCodeAt(i);\r\n                }\r\n\r\n                callback( new Blob( [arr], {type: type || 'image/png'} ) );\r\n            }\r\n        });\r\n    }\r\n    /* End Polyfills */\r\n\r\n    var cssPrefixes = ['Webkit', 'Moz', 'ms'],\r\n        emptyStyles = document.createElement('div').style,\r\n        EXIF_NORM = [1,8,3,6],\r\n        EXIF_FLIP = [2,7,4,5],\r\n        CSS_TRANS_ORG,\r\n        CSS_TRANSFORM,\r\n        CSS_USERSELECT;\r\n\r\n    function vendorPrefix(prop) {\r\n        if (prop in emptyStyles) {\r\n            return prop;\r\n        }\r\n\r\n        var capProp = prop[0].toUpperCase() + prop.slice(1),\r\n            i = cssPrefixes.length;\r\n\r\n        while (i--) {\r\n            prop = cssPrefixes[i] + capProp;\r\n            if (prop in emptyStyles) {\r\n                return prop;\r\n            }\r\n        }\r\n    }\r\n\r\n    CSS_TRANSFORM = vendorPrefix('transform');\r\n    CSS_TRANS_ORG = vendorPrefix('transformOrigin');\r\n    CSS_USERSELECT = vendorPrefix('userSelect');\r\n\r\n    function getExifOffset(ornt, rotate) {\r\n        var arr = EXIF_NORM.indexOf(ornt) > -1 ? EXIF_NORM : EXIF_FLIP,\r\n            index = arr.indexOf(ornt),\r\n            offset = (rotate / 90) % arr.length;// 180 = 2%4 = 2 shift exif by 2 indexes\r\n\r\n        return arr[(arr.length + index + (offset % arr.length)) % arr.length];\r\n    }\r\n\r\n    // Credits to : Andrew Dupont - http://andrewdupont.net/2009/08/28/deep-extending-objects-in-javascript/\r\n    function deepExtend(destination, source) {\r\n        destination = destination || {};\r\n        for (var property in source) {\r\n            if (source[property] && source[property].constructor && source[property].constructor === Object) {\r\n                destination[property] = destination[property] || {};\r\n                deepExtend(destination[property], source[property]);\r\n            } else {\r\n                destination[property] = source[property];\r\n            }\r\n        }\r\n        return destination;\r\n    }\r\n\r\n    function clone(object) {\r\n        return deepExtend({}, object);\r\n    }\r\n\r\n    function debounce(func, wait, immediate) {\r\n        var timeout;\r\n        return function () {\r\n            var context = this, args = arguments;\r\n            var later = function () {\r\n                timeout = null;\r\n                if (!immediate) func.apply(context, args);\r\n            };\r\n            var callNow = immediate && !timeout;\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(later, wait);\r\n            if (callNow) func.apply(context, args);\r\n        };\r\n    }\r\n\r\n    function dispatchChange(element) {\r\n        if (\"createEvent\" in document) {\r\n            var evt = document.createEvent(\"HTMLEvents\");\r\n            evt.initEvent(\"change\", false, true);\r\n            element.dispatchEvent(evt);\r\n        }\r\n        else {\r\n            element.fireEvent(\"onchange\");\r\n        }\r\n    }\r\n\r\n    //http://jsperf.com/vanilla-css\r\n    function css(el, styles, val) {\r\n        if (typeof (styles) === 'string') {\r\n            var tmp = styles;\r\n            styles = {};\r\n            styles[tmp] = val;\r\n        }\r\n\r\n        for (var prop in styles) {\r\n            el.style[prop] = styles[prop];\r\n        }\r\n    }\r\n\r\n    function addClass(el, c) {\r\n        if (el.classList) {\r\n            el.classList.add(c);\r\n        }\r\n        else {\r\n            el.className += ' ' + c;\r\n        }\r\n    }\r\n\r\n    function removeClass(el, c) {\r\n        if (el.classList) {\r\n            el.classList.remove(c);\r\n        }\r\n        else {\r\n            el.className = el.className.replace(c, '');\r\n        }\r\n    }\r\n\r\n    function setAttributes(el, attrs) {\r\n        for (var key in attrs) {\r\n            el.setAttribute(key, attrs[key]);\r\n        }\r\n    }\r\n\r\n    function num(v) {\r\n        return parseInt(v, 10);\r\n    }\r\n\r\n    /* Utilities */\r\n    function loadImage(src, doExif) {\r\n        var img = new Image();\r\n        img.style.opacity = '0';\r\n        return new Promise(function (resolve, reject) {\r\n            function _resolve() {\r\n                img.style.opacity = '1';\r\n                setTimeout(function () {\r\n                    resolve(img);\r\n                }, 1);\r\n            }\r\n\r\n            img.removeAttribute('crossOrigin');\r\n            if (src.match(/^https?:\\/\\/|^\\/\\//)) {\r\n                img.setAttribute('crossOrigin', 'anonymous');\r\n            }\r\n\r\n            img.onload = function () {\r\n                if (doExif) {\r\n                    EXIF.getData(img, function () {\r\n                        _resolve();\r\n                    });\r\n                }\r\n                else {\r\n                    _resolve();\r\n                }\r\n            };\r\n            img.onerror = function (ev) {\r\n                img.style.opacity = 1;\r\n                setTimeout(function () {\r\n                    reject(ev);\r\n                }, 1);\r\n            };\r\n            img.src = src;\r\n        });\r\n    }\r\n\r\n    function naturalImageDimensions(img, ornt) {\r\n        var w = img.naturalWidth;\r\n        var h = img.naturalHeight;\r\n        var orient = ornt || getExifOrientation(img);\r\n        if (orient && orient >= 5) {\r\n            var x= w;\r\n            w = h;\r\n            h = x;\r\n        }\r\n        return { width: w, height: h };\r\n    }\r\n\r\n    /* CSS Transform Prototype */\r\n    var TRANSLATE_OPTS = {\r\n        'translate3d': {\r\n            suffix: ', 0px'\r\n        },\r\n        'translate': {\r\n            suffix: ''\r\n        }\r\n    };\r\n    var Transform = function (x, y, scale) {\r\n        this.x = parseFloat(x);\r\n        this.y = parseFloat(y);\r\n        this.scale = parseFloat(scale);\r\n    };\r\n\r\n    Transform.parse = function (v) {\r\n        if (v.style) {\r\n            return Transform.parse(v.style[CSS_TRANSFORM]);\r\n        }\r\n        else if (v.indexOf('matrix') > -1 || v.indexOf('none') > -1) {\r\n            return Transform.fromMatrix(v);\r\n        }\r\n        else {\r\n            return Transform.fromString(v);\r\n        }\r\n    };\r\n\r\n    Transform.fromMatrix = function (v) {\r\n        var vals = v.substring(7).split(',');\r\n        if (!vals.length || v === 'none') {\r\n            vals = [1, 0, 0, 1, 0, 0];\r\n        }\r\n\r\n        return new Transform(num(vals[4]), num(vals[5]), parseFloat(vals[0]));\r\n    };\r\n\r\n    Transform.fromString = function (v) {\r\n        var values = v.split(') '),\r\n            translate = values[0].substring(Croppie.globals.translate.length + 1).split(','),\r\n            scale = values.length > 1 ? values[1].substring(6) : 1,\r\n            x = translate.length > 1 ? translate[0] : 0,\r\n            y = translate.length > 1 ? translate[1] : 0;\r\n\r\n        return new Transform(x, y, scale);\r\n    };\r\n\r\n    Transform.prototype.toString = function () {\r\n        var suffix = TRANSLATE_OPTS[Croppie.globals.translate].suffix || '';\r\n        return Croppie.globals.translate + '(' + this.x + 'px, ' + this.y + 'px' + suffix + ') scale(' + this.scale + ')';\r\n    };\r\n\r\n    var TransformOrigin = function (el) {\r\n        if (!el || !el.style[CSS_TRANS_ORG]) {\r\n            this.x = 0;\r\n            this.y = 0;\r\n            return;\r\n        }\r\n        var css = el.style[CSS_TRANS_ORG].split(' ');\r\n        this.x = parseFloat(css[0]);\r\n        this.y = parseFloat(css[1]);\r\n    };\r\n\r\n    TransformOrigin.prototype.toString = function () {\r\n        return this.x + 'px ' + this.y + 'px';\r\n    };\r\n\r\n    function getExifOrientation (img) {\r\n        return img.exifdata && img.exifdata.Orientation ? num(img.exifdata.Orientation) : 1;\r\n    }\r\n\r\n    function drawCanvas(canvas, img, orientation) {\r\n        var width = img.width,\r\n            height = img.height,\r\n            ctx = canvas.getContext('2d');\r\n\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        ctx.save();\r\n        switch (orientation) {\r\n          case 2:\r\n             ctx.translate(width, 0);\r\n             ctx.scale(-1, 1);\r\n             break;\r\n\r\n          case 3:\r\n              ctx.translate(width, height);\r\n              ctx.rotate(180*Math.PI/180);\r\n              break;\r\n\r\n          case 4:\r\n              ctx.translate(0, height);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 5:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(90*Math.PI/180);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 6:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(90*Math.PI/180);\r\n              ctx.translate(0, -height);\r\n              break;\r\n\r\n          case 7:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(-90*Math.PI/180);\r\n              ctx.translate(-width, height);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 8:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.translate(0, width);\r\n              ctx.rotate(-90*Math.PI/180);\r\n              break;\r\n        }\r\n        ctx.drawImage(img, 0,0, width, height);\r\n        ctx.restore();\r\n    }\r\n\r\n    /* Private Methods */\r\n    function _create() {\r\n        var self = this,\r\n            contClass = 'croppie-container',\r\n            customViewportClass = self.options.viewport.type ? 'cr-vp-' + self.options.viewport.type : null,\r\n            boundary, img, viewport, overlay, bw, bh;\r\n\r\n        self.options.useCanvas = self.options.enableOrientation || _hasExif.call(self);\r\n        // Properties on class\r\n        self.data = {};\r\n        self.elements = {};\r\n\r\n        boundary = self.elements.boundary = document.createElement('div');\r\n        viewport = self.elements.viewport = document.createElement('div');\r\n        img = self.elements.img = document.createElement('img');\r\n        overlay = self.elements.overlay = document.createElement('div');\r\n\r\n        if (self.options.useCanvas) {\r\n            self.elements.canvas = document.createElement('canvas');\r\n            self.elements.preview = self.elements.canvas;\r\n        }\r\n        else {\r\n            self.elements.preview = img;\r\n        }\r\n\r\n        addClass(boundary, 'cr-boundary');\r\n        boundary.setAttribute('aria-dropeffect', 'none');\r\n        bw = self.options.boundary.width;\r\n        bh = self.options.boundary.height;\r\n        css(boundary, {\r\n            width: (bw + (isNaN(bw) ? '' : 'px')),\r\n            height: (bh + (isNaN(bh) ? '' : 'px'))\r\n        });\r\n\r\n        addClass(viewport, 'cr-viewport');\r\n        if (customViewportClass) {\r\n            addClass(viewport, customViewportClass);\r\n        }\r\n        css(viewport, {\r\n            width: self.options.viewport.width + 'px',\r\n            height: self.options.viewport.height + 'px'\r\n        });\r\n        viewport.setAttribute('tabindex', 0);\r\n\r\n        addClass(self.elements.preview, 'cr-image');\r\n        setAttributes(self.elements.preview, { 'alt': 'preview', 'aria-grabbed': 'false' });\r\n        addClass(overlay, 'cr-overlay');\r\n\r\n        self.element.appendChild(boundary);\r\n        boundary.appendChild(self.elements.preview);\r\n        boundary.appendChild(viewport);\r\n        boundary.appendChild(overlay);\r\n\r\n        addClass(self.element, contClass);\r\n        if (self.options.customClass) {\r\n            addClass(self.element, self.options.customClass);\r\n        }\r\n\r\n        _initDraggable.call(this);\r\n\r\n        if (self.options.enableZoom) {\r\n            _initializeZoom.call(self);\r\n        }\r\n\r\n        // if (self.options.enableOrientation) {\r\n        //     _initRotationControls.call(self);\r\n        // }\r\n\r\n        if (self.options.enableResize) {\r\n            _initializeResize.call(self);\r\n        }\r\n    }\r\n\r\n    // function _initRotationControls () {\r\n    //     var self = this,\r\n    //         wrap, btnLeft, btnRight, iLeft, iRight;\r\n\r\n    //     wrap = document.createElement('div');\r\n    //     self.elements.orientationBtnLeft = btnLeft = document.createElement('button');\r\n    //     self.elements.orientationBtnRight = btnRight = document.createElement('button');\r\n\r\n    //     wrap.appendChild(btnLeft);\r\n    //     wrap.appendChild(btnRight);\r\n\r\n    //     iLeft = document.createElement('i');\r\n    //     iRight = document.createElement('i');\r\n    //     btnLeft.appendChild(iLeft);\r\n    //     btnRight.appendChild(iRight);\r\n\r\n    //     addClass(wrap, 'cr-rotate-controls');\r\n    //     addClass(btnLeft, 'cr-rotate-l');\r\n    //     addClass(btnRight, 'cr-rotate-r');\r\n\r\n    //     self.elements.boundary.appendChild(wrap);\r\n\r\n    //     btnLeft.addEventListener('click', function () {\r\n    //         self.rotate(-90);\r\n    //     });\r\n    //     btnRight.addEventListener('click', function () {\r\n    //         self.rotate(90);\r\n    //     });\r\n    // }\r\n\r\n    function _hasExif() {\r\n        return this.options.enableExif && window.EXIF;\r\n    }\r\n\r\n    function _initializeResize () {\r\n        var self = this;\r\n        var wrap = document.createElement('div');\r\n        var isDragging = false;\r\n        var direction;\r\n        var originalX;\r\n        var originalY;\r\n        var minSize = 50;\r\n        var maxWidth;\r\n        var maxHeight;\r\n        var vr;\r\n        var hr;\r\n\r\n        addClass(wrap, 'cr-resizer');\r\n        css(wrap, {\r\n            width: this.options.viewport.width + 'px',\r\n            height: this.options.viewport.height + 'px'\r\n        });\r\n\r\n        if (this.options.resizeControls.height) {\r\n            vr = document.createElement('div');\r\n            addClass(vr, 'cr-resizer-vertical');\r\n            wrap.appendChild(vr);\r\n        }\r\n\r\n        if (this.options.resizeControls.width) {\r\n            hr = document.createElement('div');\r\n            addClass(hr, 'cr-resizer-horisontal');\r\n            wrap.appendChild(hr);\r\n        }\r\n\r\n        function mouseDown(ev) {\r\n            if (ev.button !== undefined && ev.button !== 0) return;\r\n\r\n            ev.preventDefault();\r\n            if (isDragging) {\r\n                return;\r\n            }\r\n\r\n            var overlayRect = self.elements.overlay.getBoundingClientRect();\r\n\r\n            isDragging = true;\r\n            originalX = ev.pageX;\r\n            originalY = ev.pageY;\r\n            direction = ev.currentTarget.className.indexOf('vertical') !== -1 ? 'v' : 'h';\r\n            maxWidth = overlayRect.width;\r\n            maxHeight = overlayRect.height;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                originalX = touches.pageX;\r\n                originalY = touches.pageY;\r\n            }\r\n\r\n            window.addEventListener('mousemove', mouseMove);\r\n            window.addEventListener('touchmove', mouseMove);\r\n            window.addEventListener('mouseup', mouseUp);\r\n            window.addEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = 'none';\r\n        }\r\n\r\n        function mouseMove(ev) {\r\n            var pageX = ev.pageX;\r\n            var pageY = ev.pageY;\r\n\r\n            ev.preventDefault();\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                pageX = touches.pageX;\r\n                pageY = touches.pageY;\r\n            }\r\n\r\n            var deltaX = pageX - originalX;\r\n            var deltaY = pageY - originalY;\r\n            var newHeight = self.options.viewport.height + deltaY;\r\n            var newWidth = self.options.viewport.width + deltaX;\r\n\r\n            if (direction === 'v' && newHeight >= minSize && newHeight <= maxHeight) {\r\n                css(wrap, {\r\n                    height: newHeight + 'px'\r\n                });\r\n\r\n                self.options.boundary.height += deltaY;\r\n                css(self.elements.boundary, {\r\n                    height: self.options.boundary.height + 'px'\r\n                });\r\n\r\n                self.options.viewport.height += deltaY;\r\n                css(self.elements.viewport, {\r\n                    height: self.options.viewport.height + 'px'\r\n                });\r\n            }\r\n            else if (direction === 'h' && newWidth >= minSize && newWidth <= maxWidth) {\r\n                css(wrap, {\r\n                    width: newWidth + 'px'\r\n                });\r\n\r\n                self.options.boundary.width += deltaX;\r\n                css(self.elements.boundary, {\r\n                    width: self.options.boundary.width + 'px'\r\n                });\r\n\r\n                self.options.viewport.width += deltaX;\r\n                css(self.elements.viewport, {\r\n                    width: self.options.viewport.width + 'px'\r\n                });\r\n            }\r\n\r\n            _updateOverlay.call(self);\r\n            _updateZoomLimits.call(self);\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalY = pageY;\r\n            originalX = pageX;\r\n        }\r\n\r\n        function mouseUp() {\r\n            isDragging = false;\r\n            window.removeEventListener('mousemove', mouseMove);\r\n            window.removeEventListener('touchmove', mouseMove);\r\n            window.removeEventListener('mouseup', mouseUp);\r\n            window.removeEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n        }\r\n\r\n        if (vr) {\r\n            vr.addEventListener('mousedown', mouseDown);\r\n            vr.addEventListener('touchstart', mouseDown);\r\n        }\r\n\r\n        if (hr) {\r\n            hr.addEventListener('mousedown', mouseDown);\r\n            hr.addEventListener('touchstart', mouseDown);\r\n        }\r\n\r\n        this.elements.boundary.appendChild(wrap);\r\n    }\r\n\r\n    function _setZoomerVal(v) {\r\n        if (this.options.enableZoom) {\r\n            var z = this.elements.zoomer,\r\n                val = fix(v, 4);\r\n\r\n            z.value = Math.max(parseFloat(z.min), Math.min(parseFloat(z.max), val)).toString();\r\n        }\r\n    }\r\n\r\n    function _initializeZoom() {\r\n        var self = this,\r\n            wrap = self.elements.zoomerWrap = document.createElement('div'),\r\n            zoomer = self.elements.zoomer = document.createElement('input');\r\n\r\n        addClass(wrap, 'cr-slider-wrap');\r\n        addClass(zoomer, 'cr-slider');\r\n        zoomer.type = 'range';\r\n        zoomer.step = '0.0001';\r\n        zoomer.value = '1';\r\n        zoomer.style.display = self.options.showZoomer ? '' : 'none';\r\n        zoomer.setAttribute('aria-label', 'zoom');\r\n\r\n        self.element.appendChild(wrap);\r\n        wrap.appendChild(zoomer);\r\n\r\n        self._currentZoom = 1;\r\n\r\n        function change() {\r\n            _onZoom.call(self, {\r\n                value: parseFloat(zoomer.value),\r\n                origin: new TransformOrigin(self.elements.preview),\r\n                viewportRect: self.elements.viewport.getBoundingClientRect(),\r\n                transform: Transform.parse(self.elements.preview)\r\n            });\r\n        }\r\n\r\n        function scroll(ev) {\r\n            var delta, targetZoom;\r\n\r\n            if(self.options.mouseWheelZoom === 'ctrl' && ev.ctrlKey !== true){\r\n              return 0; \r\n            } else if (ev.wheelDelta) {\r\n                delta = ev.wheelDelta / 1200; //wheelDelta min: -120 max: 120 // max x 10 x 2\r\n            } else if (ev.deltaY) {\r\n                delta = ev.deltaY / 1060; //deltaY min: -53 max: 53 // max x 10 x 2\r\n            } else if (ev.detail) {\r\n                delta = ev.detail / -60; //delta min: -3 max: 3 // max x 10 x 2\r\n            } else {\r\n                delta = 0;\r\n            }\r\n\r\n            targetZoom = self._currentZoom + (delta * self._currentZoom);\r\n\r\n            ev.preventDefault();\r\n            _setZoomerVal.call(self, targetZoom);\r\n            change.call(self);\r\n        }\r\n\r\n        self.elements.zoomer.addEventListener('input', change);// this is being fired twice on keypress\r\n        self.elements.zoomer.addEventListener('change', change);\r\n\r\n        if (self.options.mouseWheelZoom) {\r\n            self.elements.boundary.addEventListener('mousewheel', scroll);\r\n            self.elements.boundary.addEventListener('DOMMouseScroll', scroll);\r\n        }\r\n    }\r\n\r\n    function _onZoom(ui) {\r\n        var self = this,\r\n            transform = ui ? ui.transform : Transform.parse(self.elements.preview),\r\n            vpRect = ui ? ui.viewportRect : self.elements.viewport.getBoundingClientRect(),\r\n            origin = ui ? ui.origin : new TransformOrigin(self.elements.preview);\r\n\r\n        function applyCss() {\r\n            var transCss = {};\r\n            transCss[CSS_TRANSFORM] = transform.toString();\r\n            transCss[CSS_TRANS_ORG] = origin.toString();\r\n            css(self.elements.preview, transCss);\r\n        }\r\n\r\n        self._currentZoom = ui ? ui.value : self._currentZoom;\r\n        transform.scale = self._currentZoom;\r\n        self.elements.zoomer.setAttribute('aria-valuenow', self._currentZoom);\r\n        applyCss();\r\n\r\n        if (self.options.enforceBoundary) {\r\n            var boundaries = _getVirtualBoundaries.call(self, vpRect),\r\n                transBoundaries = boundaries.translate,\r\n                oBoundaries = boundaries.origin;\r\n\r\n            if (transform.x >= transBoundaries.maxX) {\r\n                origin.x = oBoundaries.minX;\r\n                transform.x = transBoundaries.maxX;\r\n            }\r\n\r\n            if (transform.x <= transBoundaries.minX) {\r\n                origin.x = oBoundaries.maxX;\r\n                transform.x = transBoundaries.minX;\r\n            }\r\n\r\n            if (transform.y >= transBoundaries.maxY) {\r\n                origin.y = oBoundaries.minY;\r\n                transform.y = transBoundaries.maxY;\r\n            }\r\n\r\n            if (transform.y <= transBoundaries.minY) {\r\n                origin.y = oBoundaries.maxY;\r\n                transform.y = transBoundaries.minY;\r\n            }\r\n        }\r\n        applyCss();\r\n        _debouncedOverlay.call(self);\r\n        _triggerUpdate.call(self);\r\n    }\r\n\r\n    function _getVirtualBoundaries(viewport) {\r\n        var self = this,\r\n            scale = self._currentZoom,\r\n            vpWidth = viewport.width,\r\n            vpHeight = viewport.height,\r\n            centerFromBoundaryX = self.elements.boundary.clientWidth / 2,\r\n            centerFromBoundaryY = self.elements.boundary.clientHeight / 2,\r\n            imgRect = self.elements.preview.getBoundingClientRect(),\r\n            curImgWidth = imgRect.width,\r\n            curImgHeight = imgRect.height,\r\n            halfWidth = vpWidth / 2,\r\n            halfHeight = vpHeight / 2;\r\n\r\n        var maxX = ((halfWidth / scale) - centerFromBoundaryX) * -1;\r\n        var minX = maxX - ((curImgWidth * (1 / scale)) - (vpWidth * (1 / scale)));\r\n\r\n        var maxY = ((halfHeight / scale) - centerFromBoundaryY) * -1;\r\n        var minY = maxY - ((curImgHeight * (1 / scale)) - (vpHeight * (1 / scale)));\r\n\r\n        var originMinX = (1 / scale) * halfWidth;\r\n        var originMaxX = (curImgWidth * (1 / scale)) - originMinX;\r\n\r\n        var originMinY = (1 / scale) * halfHeight;\r\n        var originMaxY = (curImgHeight * (1 / scale)) - originMinY;\r\n\r\n        return {\r\n            translate: {\r\n                maxX: maxX,\r\n                minX: minX,\r\n                maxY: maxY,\r\n                minY: minY\r\n            },\r\n            origin: {\r\n                maxX: originMaxX,\r\n                minX: originMinX,\r\n                maxY: originMaxY,\r\n                minY: originMinY\r\n            }\r\n        };\r\n    }\r\n\r\n    function _updateCenterPoint(rotate) {\r\n        var self = this,\r\n            scale = self._currentZoom,\r\n            data = self.elements.preview.getBoundingClientRect(),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            transform = Transform.parse(self.elements.preview.style[CSS_TRANSFORM]),\r\n            pc = new TransformOrigin(self.elements.preview),\r\n            top = (vpData.top - data.top) + (vpData.height / 2),\r\n            left = (vpData.left - data.left) + (vpData.width / 2),\r\n            center = {},\r\n            adj = {};\r\n\r\n        if (rotate) {\r\n            var cx = pc.x;\r\n            var cy = pc.y;\r\n            var tx = transform.x;\r\n            var ty = transform.y;\r\n\r\n            center.y = cx;\r\n            center.x = cy;\r\n            transform.y = tx;\r\n            transform.x = ty;\r\n        }\r\n        else {\r\n            center.y = top / scale;\r\n            center.x = left / scale;\r\n\r\n            adj.y = (center.y - pc.y) * (1 - scale);\r\n            adj.x = (center.x - pc.x) * (1 - scale);\r\n\r\n            transform.x -= adj.x;\r\n            transform.y -= adj.y;\r\n        }\r\n\r\n        var newCss = {};\r\n        newCss[CSS_TRANS_ORG] = center.x + 'px ' + center.y + 'px';\r\n        newCss[CSS_TRANSFORM] = transform.toString();\r\n        css(self.elements.preview, newCss);\r\n    }\r\n\r\n    function _initDraggable() {\r\n        var self = this,\r\n            isDragging = false,\r\n            originalX,\r\n            originalY,\r\n            originalDistance,\r\n            vpRect,\r\n            transform;\r\n\r\n        function assignTransformCoordinates(deltaX, deltaY) {\r\n            var imgRect = self.elements.preview.getBoundingClientRect(),\r\n                top = transform.y + deltaY,\r\n                left = transform.x + deltaX;\r\n\r\n            if (self.options.enforceBoundary) {\r\n                if (vpRect.top > imgRect.top + deltaY && vpRect.bottom < imgRect.bottom + deltaY) {\r\n                    transform.y = top;\r\n                }\r\n\r\n                if (vpRect.left > imgRect.left + deltaX && vpRect.right < imgRect.right + deltaX) {\r\n                    transform.x = left;\r\n                }\r\n            }\r\n            else {\r\n                transform.y = top;\r\n                transform.x = left;\r\n            }\r\n        }\r\n\r\n        function toggleGrabState(isDragging) {\r\n          self.elements.preview.setAttribute('aria-grabbed', isDragging);\r\n          self.elements.boundary.setAttribute('aria-dropeffect', isDragging? 'move': 'none');\r\n        }\r\n\r\n        function keyDown(ev) {\r\n            var LEFT_ARROW  = 37,\r\n                UP_ARROW    = 38,\r\n                RIGHT_ARROW = 39,\r\n                DOWN_ARROW  = 40;\r\n\r\n            if (ev.shiftKey && (ev.keyCode === UP_ARROW || ev.keyCode === DOWN_ARROW)) {\r\n                var zoom;\r\n                if (ev.keyCode === UP_ARROW) {\r\n                    zoom = parseFloat(self.elements.zoomer.value) + parseFloat(self.elements.zoomer.step)\r\n                }\r\n                else {\r\n                    zoom = parseFloat(self.elements.zoomer.value) - parseFloat(self.elements.zoomer.step)\r\n                }\r\n                self.setZoom(zoom);\r\n            }\r\n            else if (self.options.enableKeyMovement && (ev.keyCode >= 37 && ev.keyCode <= 40)) {\r\n                ev.preventDefault();\r\n                var movement = parseKeyDown(ev.keyCode);\r\n\r\n                transform = Transform.parse(self.elements.preview);\r\n                document.body.style[CSS_USERSELECT] = 'none';\r\n                vpRect = self.elements.viewport.getBoundingClientRect();\r\n                keyMove(movement);\r\n            }\r\n\r\n            function parseKeyDown(key) {\r\n                switch (key) {\r\n                    case LEFT_ARROW:\r\n                        return [1, 0];\r\n                    case UP_ARROW:\r\n                        return [0, 1];\r\n                    case RIGHT_ARROW:\r\n                        return [-1, 0];\r\n                    case DOWN_ARROW:\r\n                        return [0, -1];\r\n                }\r\n            }\r\n        }\r\n\r\n        function keyMove(movement) {\r\n            var deltaX = movement[0],\r\n                deltaY = movement[1],\r\n                newCss = {};\r\n\r\n            assignTransformCoordinates(deltaX, deltaY);\r\n\r\n            newCss[CSS_TRANSFORM] = transform.toString();\r\n            css(self.elements.preview, newCss);\r\n            _updateOverlay.call(self);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalDistance = 0;\r\n        }\r\n\r\n        function mouseDown(ev) {\r\n            if (ev.button !== undefined && ev.button !== 0) return;\r\n\r\n            ev.preventDefault();\r\n            if (isDragging) return;\r\n            isDragging = true;\r\n            originalX = ev.pageX;\r\n            originalY = ev.pageY;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                originalX = touches.pageX;\r\n                originalY = touches.pageY;\r\n            }\r\n            toggleGrabState(isDragging);\r\n            transform = Transform.parse(self.elements.preview);\r\n            window.addEventListener('mousemove', mouseMove);\r\n            window.addEventListener('touchmove', mouseMove);\r\n            window.addEventListener('mouseup', mouseUp);\r\n            window.addEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = 'none';\r\n            vpRect = self.elements.viewport.getBoundingClientRect();\r\n        }\r\n\r\n        function mouseMove(ev) {\r\n            ev.preventDefault();\r\n            var pageX = ev.pageX,\r\n                pageY = ev.pageY;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                pageX = touches.pageX;\r\n                pageY = touches.pageY;\r\n            }\r\n\r\n            var deltaX = pageX - originalX,\r\n                deltaY = pageY - originalY,\r\n                newCss = {};\r\n\r\n            if (ev.type === 'touchmove') {\r\n                if (ev.touches.length > 1) {\r\n                    var touch1 = ev.touches[0];\r\n                    var touch2 = ev.touches[1];\r\n                    var dist = Math.sqrt((touch1.pageX - touch2.pageX) * (touch1.pageX - touch2.pageX) + (touch1.pageY - touch2.pageY) * (touch1.pageY - touch2.pageY));\r\n\r\n                    if (!originalDistance) {\r\n                        originalDistance = dist / self._currentZoom;\r\n                    }\r\n\r\n                    var scale = dist / originalDistance;\r\n\r\n                    _setZoomerVal.call(self, scale);\r\n                    dispatchChange(self.elements.zoomer);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            assignTransformCoordinates(deltaX, deltaY);\r\n\r\n            newCss[CSS_TRANSFORM] = transform.toString();\r\n            css(self.elements.preview, newCss);\r\n            _updateOverlay.call(self);\r\n            originalY = pageY;\r\n            originalX = pageX;\r\n        }\r\n\r\n        function mouseUp() {\r\n            isDragging = false;\r\n            toggleGrabState(isDragging);\r\n            window.removeEventListener('mousemove', mouseMove);\r\n            window.removeEventListener('touchmove', mouseMove);\r\n            window.removeEventListener('mouseup', mouseUp);\r\n            window.removeEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalDistance = 0;\r\n        }\r\n\r\n        self.elements.overlay.addEventListener('mousedown', mouseDown);\r\n        self.elements.viewport.addEventListener('keydown', keyDown);\r\n        self.elements.overlay.addEventListener('touchstart', mouseDown);\r\n    }\r\n\r\n    function _updateOverlay() {\r\n        if (!this.elements) return; // since this is debounced, it can be fired after destroy\r\n        var self = this,\r\n            boundRect = self.elements.boundary.getBoundingClientRect(),\r\n            imgData = self.elements.preview.getBoundingClientRect();\r\n\r\n        css(self.elements.overlay, {\r\n            width: imgData.width + 'px',\r\n            height: imgData.height + 'px',\r\n            top: (imgData.top - boundRect.top) + 'px',\r\n            left: (imgData.left - boundRect.left) + 'px'\r\n        });\r\n    }\r\n    var _debouncedOverlay = debounce(_updateOverlay, 500);\r\n\r\n    function _triggerUpdate() {\r\n        var self = this,\r\n            data = self.get();\r\n\r\n        if (!_isVisible.call(self)) {\r\n            return;\r\n        }\r\n\r\n        self.options.update.call(self, data);\r\n        if (self.$ && typeof Prototype === 'undefined') {\r\n            self.$(self.element).trigger('update.croppie', data);\r\n        }\r\n        else {\r\n            var ev;\r\n            if (window.CustomEvent) {\r\n                ev = new CustomEvent('update', { detail: data });\r\n            } else {\r\n                ev = document.createEvent('CustomEvent');\r\n                ev.initCustomEvent('update', true, true, data);\r\n            }\r\n\r\n            self.element.dispatchEvent(ev);\r\n        }\r\n    }\r\n\r\n    function _isVisible() {\r\n        return this.elements.preview.offsetHeight > 0 && this.elements.preview.offsetWidth > 0;\r\n    }\r\n\r\n    function _updatePropertiesFromImage() {\r\n        var self = this,\r\n            initialZoom = 1,\r\n            cssReset = {},\r\n            img = self.elements.preview,\r\n            imgData,\r\n            transformReset = new Transform(0, 0, initialZoom),\r\n            originReset = new TransformOrigin(),\r\n            isVisible = _isVisible.call(self);\r\n\r\n        if (!isVisible || self.data.bound) {// if the croppie isn't visible or it doesn't need binding\r\n            return;\r\n        }\r\n\r\n        self.data.bound = true;\r\n        cssReset[CSS_TRANSFORM] = transformReset.toString();\r\n        cssReset[CSS_TRANS_ORG] = originReset.toString();\r\n        cssReset['opacity'] = 1;\r\n        css(img, cssReset);\r\n\r\n        imgData = self.elements.preview.getBoundingClientRect();\r\n\r\n        self._originalImageWidth = imgData.width;\r\n        self._originalImageHeight = imgData.height;\r\n        self.data.orientation = getExifOrientation(self.elements.img);\r\n\r\n        if (self.options.enableZoom) {\r\n            _updateZoomLimits.call(self, true);\r\n        }\r\n        else {\r\n            self._currentZoom = initialZoom;\r\n        }\r\n\r\n        transformReset.scale = self._currentZoom;\r\n        cssReset[CSS_TRANSFORM] = transformReset.toString();\r\n        css(img, cssReset);\r\n\r\n        if (self.data.points.length) {\r\n            _bindPoints.call(self, self.data.points);\r\n        }\r\n        else {\r\n            _centerImage.call(self);\r\n        }\r\n\r\n        _updateCenterPoint.call(self);\r\n        _updateOverlay.call(self);\r\n    }\r\n\r\n    function _updateZoomLimits (initial) {\r\n        var self = this,\r\n            minZoom = Math.max(self.options.minZoom, 0) || 0,\r\n            maxZoom = self.options.maxZoom || 1.5,\r\n            initialZoom,\r\n            defaultInitialZoom,\r\n            zoomer = self.elements.zoomer,\r\n            scale = parseFloat(zoomer.value),\r\n            boundaryData = self.elements.boundary.getBoundingClientRect(),\r\n            imgData = naturalImageDimensions(self.elements.img, self.data.orientation),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            minW,\r\n            minH;\r\n        if (self.options.enforceBoundary) {\r\n            minW = vpData.width / imgData.width;\r\n            minH = vpData.height / imgData.height;\r\n            minZoom = Math.max(minW, minH);\r\n        }\r\n\r\n        if (minZoom >= maxZoom) {\r\n            maxZoom = minZoom + 1;\r\n        }\r\n\r\n        zoomer.min = fix(minZoom, 4);\r\n        zoomer.max = fix(maxZoom, 4);\r\n        \r\n        if (!initial && (scale < zoomer.min || scale > zoomer.max)) {\r\n            _setZoomerVal.call(self, scale < zoomer.min ? zoomer.min : zoomer.max);\r\n        }\r\n        else if (initial) {\r\n            defaultInitialZoom = Math.max((boundaryData.width / imgData.width), (boundaryData.height / imgData.height));\r\n            initialZoom = self.data.boundZoom !== null ? self.data.boundZoom : defaultInitialZoom;\r\n            _setZoomerVal.call(self, initialZoom);\r\n        }\r\n\r\n        dispatchChange(zoomer);\r\n    }\r\n\r\n    function _bindPoints(points) {\r\n        if (points.length !== 4) {\r\n            throw \"Croppie - Invalid number of points supplied: \" + points;\r\n        }\r\n        var self = this,\r\n            pointsWidth = points[2] - points[0],\r\n            // pointsHeight = points[3] - points[1],\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            boundRect = self.elements.boundary.getBoundingClientRect(),\r\n            vpOffset = {\r\n                left: vpData.left - boundRect.left,\r\n                top: vpData.top - boundRect.top\r\n            },\r\n            scale = vpData.width / pointsWidth,\r\n            originTop = points[1],\r\n            originLeft = points[0],\r\n            transformTop = (-1 * points[1]) + vpOffset.top,\r\n            transformLeft = (-1 * points[0]) + vpOffset.left,\r\n            newCss = {};\r\n\r\n        newCss[CSS_TRANS_ORG] = originLeft + 'px ' + originTop + 'px';\r\n        newCss[CSS_TRANSFORM] = new Transform(transformLeft, transformTop, scale).toString();\r\n        css(self.elements.preview, newCss);\r\n\r\n        _setZoomerVal.call(self, scale);\r\n        self._currentZoom = scale;\r\n    }\r\n\r\n    function _centerImage() {\r\n        var self = this,\r\n            imgDim = self.elements.preview.getBoundingClientRect(),\r\n            vpDim = self.elements.viewport.getBoundingClientRect(),\r\n            boundDim = self.elements.boundary.getBoundingClientRect(),\r\n            vpLeft = vpDim.left - boundDim.left,\r\n            vpTop = vpDim.top - boundDim.top,\r\n            w = vpLeft - ((imgDim.width - vpDim.width) / 2),\r\n            h = vpTop - ((imgDim.height - vpDim.height) / 2),\r\n            transform = new Transform(w, h, self._currentZoom);\r\n\r\n        css(self.elements.preview, CSS_TRANSFORM, transform.toString());\r\n    }\r\n\r\n    function _transferImageToCanvas(customOrientation) {\r\n        var self = this,\r\n            canvas = self.elements.canvas,\r\n            img = self.elements.img,\r\n            ctx = canvas.getContext('2d');\r\n\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        var orientation = self.options.enableOrientation && customOrientation || getExifOrientation(img);\r\n        drawCanvas(canvas, img, orientation);\r\n    }\r\n\r\n    function _getCanvas(data) {\r\n        var self = this,\r\n            points = data.points,\r\n            left = num(points[0]),\r\n            top = num(points[1]),\r\n            right = num(points[2]),\r\n            bottom = num(points[3]),\r\n            width = right-left,\r\n            height = bottom-top,\r\n            circle = data.circle,\r\n            canvas = document.createElement('canvas'),\r\n            ctx = canvas.getContext('2d'),\r\n            startX = 0,\r\n            startY = 0,\r\n            canvasWidth = data.outputWidth || width,\r\n            canvasHeight = data.outputHeight || height;\r\n\r\n        canvas.width = canvasWidth;\r\n        canvas.height = canvasHeight;\r\n\r\n        if (data.backgroundColor) {\r\n            ctx.fillStyle = data.backgroundColor;\r\n            ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        }\r\n\r\n        // By default assume we're going to draw the entire\r\n        // source image onto the destination canvas.\r\n        var sx = left,\r\n            sy = top,\r\n            sWidth = width,\r\n            sHeight = height,\r\n            dx = 0,\r\n            dy = 0,\r\n            dWidth = canvasWidth,\r\n            dHeight = canvasHeight;\r\n\r\n        //\r\n        // Do not go outside of the original image's bounds along the x-axis.\r\n        // Handle translations when projecting onto the destination canvas.\r\n        //\r\n\r\n        // The smallest possible source x-position is 0.\r\n        if (left < 0) {\r\n            sx = 0;\r\n            dx = (Math.abs(left) / width) * canvasWidth;\r\n        }\r\n\r\n        // The largest possible source width is the original image's width.\r\n        if (sWidth + sx > self._originalImageWidth) {\r\n            sWidth = self._originalImageWidth - sx;\r\n            dWidth =  (sWidth / width) * canvasWidth;\r\n        }\r\n\r\n        //\r\n        // Do not go outside of the original image's bounds along the y-axis.\r\n        //\r\n\r\n        // The smallest possible source y-position is 0.\r\n        if (top < 0) {\r\n            sy = 0;\r\n            dy = (Math.abs(top) / height) * canvasHeight;\r\n        }\r\n\r\n        // The largest possible source height is the original image's height.\r\n        if (sHeight + sy > self._originalImageHeight) {\r\n            sHeight = self._originalImageHeight - sy;\r\n            dHeight = (sHeight / height) * canvasHeight;\r\n        }\r\n\r\n        // console.table({ left, right, top, bottom, canvasWidth, canvasHeight, width, height, startX, startY, circle, sx, sy, dx, dy, sWidth, sHeight, dWidth, dHeight });\r\n\r\n        ctx.drawImage(this.elements.preview, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);\r\n        if (circle) {\r\n            ctx.fillStyle = '#fff';\r\n            ctx.globalCompositeOperation = 'destination-in';\r\n            ctx.beginPath();\r\n            ctx.arc(canvas.width / 2, canvas.height / 2, canvas.width / 2, 0, Math.PI * 2, true);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        }\r\n        return canvas;\r\n    }\r\n\r\n    function _getHtmlResult(data) {\r\n        var points = data.points,\r\n            div = document.createElement('div'),\r\n            img = document.createElement('img'),\r\n            width = points[2] - points[0],\r\n            height = points[3] - points[1];\r\n\r\n        addClass(div, 'croppie-result');\r\n        div.appendChild(img);\r\n        css(img, {\r\n            left: (-1 * points[0]) + 'px',\r\n            top: (-1 * points[1]) + 'px'\r\n        });\r\n        img.src = data.url;\r\n        css(div, {\r\n            width: width + 'px',\r\n            height: height + 'px'\r\n        });\r\n\r\n        return div;\r\n    }\r\n\r\n    function _getBase64Result(data) {\r\n        return _getCanvas.call(this, data).toDataURL(data.format, data.quality);\r\n    }\r\n\r\n    function _getBlobResult(data) {\r\n        var self = this;\r\n        return new Promise(function (resolve) {\r\n            _getCanvas.call(self, data).toBlob(function (blob) {\r\n                resolve(blob);\r\n            }, data.format, data.quality);\r\n        });\r\n    }\r\n\r\n    function _replaceImage(img) {\r\n        if (this.elements.img.parentNode) {\r\n            Array.prototype.forEach.call(this.elements.img.classList, function(c) { img.classList.add(c); });\r\n            this.elements.img.parentNode.replaceChild(img, this.elements.img);\r\n            this.elements.preview = img; // if the img is attached to the DOM, they're not using the canvas\r\n        }\r\n        this.elements.img = img;\r\n    }\r\n\r\n    function _bind(options, cb) {\r\n        var self = this,\r\n            url,\r\n            points = [],\r\n            zoom = null,\r\n            hasExif = _hasExif.call(self);\r\n\r\n        if (typeof (options) === 'string') {\r\n            url = options;\r\n            options = {};\r\n        }\r\n        else if (Array.isArray(options)) {\r\n            points = options.slice();\r\n        }\r\n        else if (typeof (options) === 'undefined' && self.data.url) { //refreshing\r\n            _updatePropertiesFromImage.call(self);\r\n            _triggerUpdate.call(self);\r\n            return null;\r\n        }\r\n        else {\r\n            url = options.url;\r\n            points = options.points || [];\r\n            zoom = typeof(options.zoom) === 'undefined' ? null : options.zoom;\r\n        }\r\n\r\n        self.data.bound = false;\r\n        self.data.url = url || self.data.url;\r\n        self.data.boundZoom = zoom;\r\n\r\n        return loadImage(url, hasExif).then(function (img) {\r\n            _replaceImage.call(self, img);\r\n            if (!points.length) {\r\n                var natDim = naturalImageDimensions(img);\r\n                var rect = self.elements.viewport.getBoundingClientRect();\r\n                var aspectRatio = rect.width / rect.height;\r\n                var imgAspectRatio = natDim.width / natDim.height;\r\n                var width, height;\r\n\r\n                if (imgAspectRatio > aspectRatio) {\r\n                    height = natDim.height;\r\n                    width = height * aspectRatio;\r\n                }\r\n                else {\r\n                    width = natDim.width;\r\n                    height = natDim.height / aspectRatio;\r\n                }\r\n\r\n                var x0 = (natDim.width - width) / 2;\r\n                var y0 = (natDim.height - height) / 2;\r\n                var x1 = x0 + width;\r\n                var y1 = y0 + height;\r\n                self.data.points = [x0, y0, x1, y1];\r\n            }\r\n            else if (self.options.relative) {\r\n                points = [\r\n                    points[0] * img.naturalWidth / 100,\r\n                    points[1] * img.naturalHeight / 100,\r\n                    points[2] * img.naturalWidth / 100,\r\n                    points[3] * img.naturalHeight / 100\r\n                ];\r\n            }\r\n\r\n            self.data.points = points.map(function (p) {\r\n                return parseFloat(p);\r\n            });\r\n            if (self.options.useCanvas) {\r\n                _transferImageToCanvas.call(self, options.orientation);\r\n            }\r\n            _updatePropertiesFromImage.call(self);\r\n            _triggerUpdate.call(self);\r\n            cb && cb();\r\n        });\r\n    }\r\n\r\n    function fix(v, decimalPoints) {\r\n        return parseFloat(v).toFixed(decimalPoints || 0);\r\n    }\r\n\r\n    function _get() {\r\n        var self = this,\r\n            imgData = self.elements.preview.getBoundingClientRect(),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            x1 = vpData.left - imgData.left,\r\n            y1 = vpData.top - imgData.top,\r\n            widthDiff = (vpData.width - self.elements.viewport.offsetWidth) / 2, //border\r\n            heightDiff = (vpData.height - self.elements.viewport.offsetHeight) / 2,\r\n            x2 = x1 + self.elements.viewport.offsetWidth + widthDiff,\r\n            y2 = y1 + self.elements.viewport.offsetHeight + heightDiff,\r\n            scale = self._currentZoom;\r\n\r\n        if (scale === Infinity || isNaN(scale)) {\r\n            scale = 1;\r\n        }\r\n\r\n        var max = self.options.enforceBoundary ? 0 : Number.NEGATIVE_INFINITY;\r\n        x1 = Math.max(max, x1 / scale);\r\n        y1 = Math.max(max, y1 / scale);\r\n        x2 = Math.max(max, x2 / scale);\r\n        y2 = Math.max(max, y2 / scale);\r\n\r\n        return {\r\n            points: [fix(x1), fix(y1), fix(x2), fix(y2)],\r\n            zoom: scale,\r\n            orientation: self.data.orientation\r\n        };\r\n    }\r\n\r\n    var RESULT_DEFAULTS = {\r\n            type: 'canvas',\r\n            format: 'png',\r\n            quality: 1\r\n        },\r\n        RESULT_FORMATS = ['jpeg', 'webp', 'png'];\r\n\r\n    function _result(options) {\r\n        var self = this,\r\n            data = _get.call(self),\r\n            opts = deepExtend(clone(RESULT_DEFAULTS), clone(options)),\r\n            resultType = (typeof (options) === 'string' ? options : (opts.type || 'base64')),\r\n            size = opts.size || 'viewport',\r\n            format = opts.format,\r\n            quality = opts.quality,\r\n            backgroundColor = opts.backgroundColor,\r\n            circle = typeof opts.circle === 'boolean' ? opts.circle : (self.options.viewport.type === 'circle'),\r\n            vpRect = self.elements.viewport.getBoundingClientRect(),\r\n            ratio = vpRect.width / vpRect.height,\r\n            prom;\r\n\r\n        if (size === 'viewport') {\r\n            data.outputWidth = vpRect.width;\r\n            data.outputHeight = vpRect.height;\r\n        } else if (typeof size === 'object') {\r\n            if (size.width && size.height) {\r\n                data.outputWidth = size.width;\r\n                data.outputHeight = size.height;\r\n            } else if (size.width) {\r\n                data.outputWidth = size.width;\r\n                data.outputHeight = size.width / ratio;\r\n            } else if (size.height) {\r\n                data.outputWidth = size.height * ratio;\r\n                data.outputHeight = size.height;\r\n            }\r\n        }\r\n\r\n        if (RESULT_FORMATS.indexOf(format) > -1) {\r\n            data.format = 'image/' + format;\r\n            data.quality = quality;\r\n        }\r\n\r\n        data.circle = circle;\r\n        data.url = self.data.url;\r\n        data.backgroundColor = backgroundColor;\r\n\r\n        prom = new Promise(function (resolve) {\r\n            switch(resultType.toLowerCase())\r\n            {\r\n                case 'rawcanvas':\r\n                    resolve(_getCanvas.call(self, data));\r\n                    break;\r\n                case 'canvas':\r\n                case 'base64':\r\n                    resolve(_getBase64Result.call(self, data));\r\n                    break;\r\n                case 'blob':\r\n                    _getBlobResult.call(self, data).then(resolve);\r\n                    break;\r\n                default:\r\n                    resolve(_getHtmlResult.call(self, data));\r\n                    break;\r\n            }\r\n        });\r\n        return prom;\r\n    }\r\n\r\n    function _refresh() {\r\n        _updatePropertiesFromImage.call(this);\r\n    }\r\n\r\n    function _rotate(deg) {\r\n        if (!this.options.useCanvas || !this.options.enableOrientation) {\r\n            throw 'Croppie: Cannot rotate without enableOrientation && EXIF.js included';\r\n        }\r\n\r\n        var self = this,\r\n            canvas = self.elements.canvas;\r\n\r\n        self.data.orientation = getExifOffset(self.data.orientation, deg);\r\n        drawCanvas(canvas, self.elements.img, self.data.orientation);\r\n        _updateCenterPoint.call(self, true);\r\n        _updateZoomLimits.call(self);\r\n    }\r\n\r\n    function _destroy() {\r\n        var self = this;\r\n        self.element.removeChild(self.elements.boundary);\r\n        removeClass(self.element, 'croppie-container');\r\n        if (self.options.enableZoom) {\r\n            self.element.removeChild(self.elements.zoomerWrap);\r\n        }\r\n        delete self.elements;\r\n    }\r\n\r\n    if (window.jQuery) {\r\n        var $ = window.jQuery;\r\n        $.fn.croppie = function (opts) {\r\n            var ot = typeof opts;\r\n\r\n            if (ot === 'string') {\r\n                var args = Array.prototype.slice.call(arguments, 1);\r\n                var singleInst = $(this).data('croppie');\r\n\r\n                if (opts === 'get') {\r\n                    return singleInst.get();\r\n                }\r\n                else if (opts === 'result') {\r\n                    return singleInst.result.apply(singleInst, args);\r\n                }\r\n                else if (opts === 'bind') {\r\n                    return singleInst.bind.apply(singleInst, args);\r\n                }\r\n\r\n                return this.each(function () {\r\n                    var i = $(this).data('croppie');\r\n                    if (!i) return;\r\n\r\n                    var method = i[opts];\r\n                    if ($.isFunction(method)) {\r\n                        method.apply(i, args);\r\n                        if (opts === 'destroy') {\r\n                            $(this).removeData('croppie');\r\n                        }\r\n                    }\r\n                    else {\r\n                        throw 'Croppie ' + opts + ' method not found';\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                return this.each(function () {\r\n                    var i = new Croppie(this, opts);\r\n                    i.$ = $;\r\n                    $(this).data('croppie', i);\r\n                });\r\n            }\r\n        };\r\n    }\r\n\r\n    function Croppie(element, opts) {\r\n        if (element.className.indexOf('croppie-container') > -1) {\r\n            throw new Error(\"Croppie: Can't initialize croppie more than once\");\r\n        }\r\n        this.element = element;\r\n        this.options = deepExtend(clone(Croppie.defaults), opts);\r\n\r\n        if (this.element.tagName.toLowerCase() === 'img') {\r\n            var origImage = this.element;\r\n            addClass(origImage, 'cr-original-image');\r\n            setAttributes(origImage, {'aria-hidden' : 'true', 'alt' : '' });\r\n            var replacementDiv = document.createElement('div');\r\n            this.element.parentNode.appendChild(replacementDiv);\r\n            replacementDiv.appendChild(origImage);\r\n            this.element = replacementDiv;\r\n            this.options.url = this.options.url || origImage.src;\r\n        }\r\n\r\n        _create.call(this);\r\n        if (this.options.url) {\r\n            var bindOpts = {\r\n                url: this.options.url,\r\n                points: this.options.points\r\n            };\r\n            delete this.options['url'];\r\n            delete this.options['points'];\r\n            _bind.call(this, bindOpts);\r\n        }\r\n    }\r\n\r\n    Croppie.defaults = {\r\n        viewport: {\r\n            width: 100,\r\n            height: 100,\r\n            type: 'square'\r\n        },\r\n        boundary: { },\r\n        orientationControls: {\r\n            enabled: true,\r\n            leftClass: '',\r\n            rightClass: ''\r\n        },\r\n        resizeControls: {\r\n            width: true,\r\n            height: true\r\n        },\r\n        customClass: '',\r\n        showZoomer: true,\r\n        enableZoom: true,\r\n        enableResize: false,\r\n        mouseWheelZoom: true,\r\n        enableExif: false,\r\n        enforceBoundary: true,\r\n        enableOrientation: false,\r\n        enableKeyMovement: true,\r\n        update: function () { }\r\n    };\r\n\r\n    Croppie.globals = {\r\n        translate: 'translate3d'\r\n    };\r\n\r\n    deepExtend(Croppie.prototype, {\r\n        bind: function (options, cb) {\r\n            return _bind.call(this, options, cb);\r\n        },\r\n        get: function () {\r\n            var data = _get.call(this);\r\n            var points = data.points;\r\n            if (this.options.relative) {\r\n                points[0] /= this.elements.img.naturalWidth / 100;\r\n                points[1] /= this.elements.img.naturalHeight / 100;\r\n                points[2] /= this.elements.img.naturalWidth / 100;\r\n                points[3] /= this.elements.img.naturalHeight / 100;\r\n            }\r\n            return data;\r\n        },\r\n        result: function (type) {\r\n            return _result.call(this, type);\r\n        },\r\n        refresh: function () {\r\n            return _refresh.call(this);\r\n        },\r\n        setZoom: function (v) {\r\n            _setZoomerVal.call(this, v);\r\n            dispatchChange(this.elements.zoomer);\r\n        },\r\n        rotate: function (deg) {\r\n            _rotate.call(this, deg);\r\n        },\r\n        destroy: function () {\r\n            return _destroy.call(this);\r\n        }\r\n    });\r\n    return Croppie;\r\n}));\r\n","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n"],"sourceRoot":""}