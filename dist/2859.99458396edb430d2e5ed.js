"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[2859],{42347:(t,e,a)=>{a.d(e,{A$:()=>B,Jm:()=>L,ad:()=>J});var s=a(97335),d=a(89925),o=a(31481),i=a(85982),n=a(55148),r=a(46275),c=a(14487),l=a(49763),h=a(87894),u=a(65934),p=a(50140),I=a(37836),g=a(59852),m=a(4875),f=a(59589),b=a(13439),V=a(99881),C=a(80840),w=a(32989),v=a(67321),y=a(71331),F=a(64520);const A={id:o.zv8,accessHash:"0",type:"userTypeRegular",isMin:!0,phoneNumber:""},S=new Set(["FILTERS_TOO_MUCH","CHATLISTS_TOO_MUCH","INVITES_TOO_MUCH"]),U=(0,I.nF)((t=>t()),3e3,!0),T=(0,I.sg)((t=>t()),500,!1,!0);function M(t,e){(0,m.px)("abortChatRequests",{chatId:t,threadId:e})}function x(t,e,a){for(var s=arguments.length,d=new Array(s>3?s-3:0),o=3;o<s;o++)d[o-3]=arguments[o];let[i=(0,c.g0)()]=d;const n=(0,v.Xf0)(t,i),r=n?.chatId,l=n?.threadId;if(r&&(r!==e||l!==a)){const[a,s]=Object.values(t.byTabId).reduce(((e,a)=>{let[s,d]=e,{id:o}=a;if(o===i||s&&d)return[s,d];const n=(0,v.Xf0)(t,o),c=n?.chatId===r;return[s||c,d||c&&n?.threadId===l]}),[r===e,!1]);(!a||!s)&&M(r,a?l:void 0)}}async function P(t,e,a){let d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,n=(0,b.mS)(),r=(0,v.xzS)(n)?.id;const c="saved"===t?await(0,m.px)("fetchSavedChats",{limit:o.uCr,offsetDate:a,withPinned:d}):await(0,m.px)("fetchChats",{limit:o.uCr,offsetDate:a,archived:"archived"===t,withPinned:d,lastLocalServiceMessageId:r});if(!c)return;const{chatIds:u}=c;if(u.length>0&&u[0]===e&&u.shift(),n=(0,b.mS)(),r=(0,v.xzS)(n)?.id,d)if("active"===t){if(!u.includes(o.zv8)){const t=await(0,m.px)("fetchChat",{type:"user",user:A});n=(0,b.mS)();const e=t&&(0,v.hds)(n,t.chatId);e&&(u.unshift(e.id),c.chats.unshift(e),r&&(c.lastMessageByChatId[e.id]=r))}const e=Object.values(n.byTabId),a=(0,l.YA)(o._E9)?.slice(0,o.Q$7).map((t=>(0,v.hds)(n,t))).filter(Boolean),s=e.flatMap((t=>{let{id:e}=t;const a=(0,v.meB)(n,e);return a?[a]:[]})).concat(a||[]),d=e.flatMap((t=>{let{id:e}=t;return(0,v.NHc)(n,e)||[]}));n.currentUserId&&n.users.byId[n.currentUserId]&&d.push(n.users.byId[n.currentUserId]),n=(0,V.de)(n,(0,h.dU)(d.concat(c.users),"id")),n=(0,V.wW)(n,c.userStatusesById),n=(0,V.W9)(n,(0,h.dU)(s.concat(c.chats),"id")),n=(0,V.hO)(n,t,u)}else n=(0,V.g1)(n,(0,h.dU)(c.users,"id")),n=(0,V.d2)(n,c.userStatusesById),n=(0,V.h7)(n,(0,h.dU)(c.chats,"id")),n=(0,V.hO)(n,t,u);else{const e=(0,h.dU)(c.chats,"id");n=(0,V.g1)(n,(0,h.dU)(c.users,"id")),n=(0,V.d2)(n,c.userStatusesById),n=(0,V.h7)(n,e),n=(0,V.wx)(n,t,u)}n=(0,V.qw)(n,t,c),n=(0,V.Kc)(n,c.messages),n=(0,V.XU)(n,c.lastMessageByChatId,t),(i?c.chatIds:Object.keys(c.draftsById)).forEach((t=>{const e=c.draftsById[t],a=(0,v.$jd)(n,t,s.l3);(e||a)&&((0,v.GA4)(n,t,s.l3)?.isLocal||(n=(0,V.ew)(n,t,s.l3,"draft",e)))})),0!==u.length&&u.length!==c.totalChatCount||n.chats.isFullyLoaded[t]||(n={...n,chats:{...n.chats,isFullyLoaded:{...n.chats.isFullyLoaded,[t]:!0}}}),(0,b.UF)(n)}async function J(t,e,a){for(var s=arguments.length,d=new Array(s>3?s-3:0),o=3;o<s;o++)d[o-3]=arguments[o];let[i=(0,c.g0)()]=d;const n=await(0,m.px)("fetchFullChat",a);if(!n)return;const{chats:r,users:l,userStatusesById:u,fullInfo:p,groupCall:I,membersCount:g,isForumAsMessages:f}=n;if(t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(l,"id")),t=(0,V.h7)(t,(0,h.dU)(r,"id")),u&&(t=(0,V.d2)(t,u)),I){const e=(0,y.Ip)(t,I.id);t=(0,C.h9)(t,I.id,(0,h.cJ)(I,["connectionState","isLoaded"]),void 0,e?void 0:I.participantsCount)}void 0!==g&&(t=(0,V.wi)(t,a.id,{membersCount:g})),a.isForum&&(t=(0,V.wi)(t,a.id,{isForumAsMessages:f})),t=(0,V.iW)(t,a.id,p),(0,b.UF)(t);const w=p.stickerSet,F=w&&(0,v.ycM)(t,w);w&&!F&&e.loadStickers({stickerSetInfo:{id:w.id,accessHash:w.accessHash},tabId:i});const A=p.emojiSet,S=A&&(0,v.ycM)(t,A);return A&&!S&&e.loadStickers({stickerSetInfo:{id:A.id,accessHash:A.accessHash},tabId:i}),n}async function B(t,e){t=(0,b.mS)();const a=(0,v.qn$)(t,e);if(a&&!a.isMin)return a;const{chat:s,user:d}=await(0,m.px)("getChatByUsername",e)||{};return s?(t=(0,b.mS)(),t=(0,V.wi)(t,s.id,s),d&&(t=(0,V.TK)(t,d.id,d)),(0,b.UF)(t),s):void 0}async function H(t,e,a){for(var s=arguments.length,d=new Array(s>3?s-3:0),o=3;o<s;o++)d[o-3]=arguments[o];let[i=(0,c.g0)()]=d;const n=await B(t,a);if(!n)return;t=(0,b.mS)();const r=(0,v.mBe)(t,n.id);if(!r)return;if(!(0,f.tv)(r))return;const l=await(0,m.px)("loadAttachBot",{bot:r});if(t=(0,b.mS)(),l)return t=(0,V.g1)(t,(0,h.dU)(l.users,"id")),(0,b.UF)(t),l.bot;e.showNotification({message:u.Tl("WebApp.AddToAttachmentUnavailableError"),tabId:i})}async function R(t,e,a,s,d){for(var o=arguments.length,i=new Array(o>5?o-5:0),n=5;n<o;n++)i[n-5]=arguments[n];let[r=(0,c.g0)()]=i;t=(0,b.mS)();const l=await H(t,e,s,r);l&&e.callAttachBot({bot:l,chatId:a,..."string"==typeof d&&{startParam:d},tabId:r})}async function L(t,e,a){for(var s=arguments.length,d=new Array(s>3?s-3:0),o=3;o<s;o++)d[o-3]=arguments[o];let[i=(0,c.g0)()]=d;const n=(0,v.hds)(t,a);if(!n||!(0,f.yn)(n))return n;const r=await async function(t,e,a){for(var s=arguments.length,d=new Array(s>3?s-3:0),o=3;o<s;o++)d[o-3]=arguments[o];let[i=(0,c.g0)()]=d;try{return await(0,m.px)("migrateChat",a)}catch(t){return void("CHANNELS_TOO_MUCH"===t.message?e.openLimitReachedModal({limit:"channels",tabId:i}):e.showDialog({data:{...t,hasErrorKey:!0},tabId:i}))}}(t,e,n,i);return r?(e.loadFullChat({chatId:r.id,tabId:i}),e.openChat({id:r.id,tabId:i}),r):void 0}(0,b.aJ)("preloadTopChatMessages",(async(t,e)=>{const a=new Set;for(let d=0;d<o.irO;d++){await(0,I.v7)(100),t=(0,b.mS)();const d=Object.values(t.byTabId).map((e=>{let{id:a}=e;return(0,v.Xf0)(t,a)?.chatId})).filter(Boolean),i=(0,l.YA)(o.DSF),n=i?.find((t=>!d.includes(t)&&!a.has(t)));if(!n)return;a.add(n),e.loadViewportMessages({chatId:n,threadId:s.l3,tabId:(0,c.g0)()})}})),(0,b.aJ)("openChat",((t,e,a)=>{const{id:d,type:i,noForumTopicPanel:n,shouldReplaceHistory:r,shouldReplaceLast:l,tabId:h=(0,c.g0)()}=a;if(e.processOpenChatOrThread({chatId:d,type:i,threadId:s.l3,noForumTopicPanel:n,shouldReplaceHistory:r,shouldReplaceLast:l,tabId:h}),x(t,d,s.l3,h),!d||d===o.Xab)return;const u=(0,v.hds)(t,d);u?.hasUnreadMark&&e.toggleChatUnread({id:d});const p=!(0,v.ZZX)(t,d);if(u)p&&!u.isMin&&e.requestChatUpdate({chatId:d});else if((0,v.nZ4)(t,d))(0,m.px)("fetchChat",{type:"self"});else{const e=(0,v.mBe)(t,d);e&&(0,m.px)("fetchChat",{type:"user",user:e})}e.closeStoryViewer({tabId:h})})),(0,b.aJ)("openSavedDialog",((t,e,a)=>{const{chatId:s,tabId:d=(0,c.g0)(),...o}=a;e.openThread({chatId:t.currentUserId,threadId:s,tabId:d,...o})})),(0,b.aJ)("openThread",(async(t,e,a)=>{const{type:d,isComments:o,noForumTopicPanel:i,shouldReplaceHistory:n,shouldReplaceLast:r,focusMessageId:l,tabId:p=(0,c.g0)()}=a;let I,g,C,{chatId:y}=a;if(o){const{originChannelId:t,originMessageId:e}=a;g=t,C=e}else{g=a.chatId,I=a.threadId,C=I;const c=(0,v.hds)(t,g);if(I===s.l3)return void e.openChat({id:y,type:d,noForumTopicPanel:i,shouldReplaceHistory:n,shouldReplaceLast:r,tabId:p});if(c?.isForum||y&&(0,f.cG)(y,I,t.currentUserId))return void e.processOpenChatOrThread({chatId:y,type:d,threadId:I,isComments:o,noForumTopicPanel:i,shouldReplaceHistory:n,shouldReplaceLast:r,tabId:p})}const F=(0,v.hds)(t,g),A=(0,v.Vw0)(t,g,C),S=(0,v.$jd)(t,g,C);if(!F)return;if(x(t,g,C,p),y&&A?.threadId&&(o||S?.listedIds?.length&&S.listedIds.includes(Number(A.threadId))))return t=(0,w.w)(t,{loadingThread:void 0},p),(0,b.UF)(t),void e.processOpenChatOrThread({chatId:y,type:d,threadId:A.threadId,isComments:o,noForumTopicPanel:i,shouldReplaceHistory:n,shouldReplaceLast:r,tabId:p});let{loadingThread:U}=(0,v.nTw)(t,p);U&&M(U.loadingChatId,U.loadingMessageId),t=(0,w.w)(t,{loadingThread:{loadingChatId:g,loadingMessageId:Number(C)}},p),(0,b.UF)(t);const T=()=>{const t=(0,b.mS)();o||(0,v.Xf0)(t,p)?.chatId!==g||(0,v.Xf0)(t,p)?.threadId!==C||e.openPreviousChat({tabId:p})};o||e.processOpenChatOrThread({chatId:y,type:d,threadId:I,tabId:p,isComments:o,noForumTopicPanel:i,shouldReplaceHistory:n,shouldReplaceLast:r});const P=await(0,m.px)("fetchDiscussionMessage",{chat:(0,v.hds)(t,g),messageId:Number(C)});if(t=(0,b.mS)(),U=(0,v.nTw)(t,p).loadingThread,U?.loadingChatId===g&&U?.loadingMessageId===C){if(!P)return t=(0,w.w)(t,{loadingThread:void 0},p),(0,b.UF)(t),e.showNotification({message:u.Tl(o?"ChannelPostDeleted":"lng_message_not_found"),tabId:p}),void T();I??(I=P.threadId),y??(y=P.chatId),y?(t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(P.users,"id")),t=(0,V.Nl)(t,(0,h.dU)(P.chats,"id")),t=(0,V.Kc)(t,P.messages),o&&(t=(0,V.eA)(t,g,C,{threadId:I}),t=(0,V.eA)(t,y,I,{isCommentsInfo:!1,threadId:I,chatId:y,fromChannelId:g,fromMessageId:C,...A&&(0,h.Up)(A,["messagesCount","lastMessageId","lastReadInboxMessageId","recentReplierIds"])})),t=(0,V.e4)(t,y,I,{firstMessageId:P.firstMessageId}),(0,b.UF)(t),l&&e.focusMessage({chatId:y,threadId:I,messageId:l,tabId:p}),e.loadViewportMessages({chatId:y,threadId:I,tabId:p,onError:()=>{t=(0,b.mS)(),t=(0,w.w)(t,{loadingThread:void 0},p),(0,b.UF)(t),e.showNotification({message:u.Tl("Group.ErrorAccessDenied"),tabId:p})},onLoaded:()=>{t=(0,b.mS)(),U=(0,v.nTw)(t,p).loadingThread,U?.loadingChatId===g&&U?.loadingMessageId===C&&(t=(0,w.w)(t,{loadingThread:void 0},p),(0,b.UF)(t),e.processOpenChatOrThread({chatId:y,type:d,threadId:I,tabId:p,isComments:o,noForumTopicPanel:i,shouldReplaceHistory:n,shouldReplaceLast:r}))}})):T()}else T()})),(0,b.aJ)("openLinkedChat",(async(t,e,a)=>{const{id:s,tabId:d=(0,c.g0)()}=a,o=(0,v.hds)(t,s);if(!o)return;const i=await(0,m.px)("fetchFullChat",o);i?.fullInfo?.linkedChatId&&e.openChat({id:i.fullInfo.linkedChatId,tabId:d})})),(0,b.aJ)("openSupportChat",(async(t,e,a)=>{const{tabId:s=(0,c.g0)()}=a||{},d=(0,v.ke9)(t);if(d)return void e.openChat({id:d.id,shouldReplaceHistory:!0,tabId:s});e.openChat({id:o.Xab,shouldReplaceHistory:!0,tabId:s});const i=await(0,m.px)("fetchChat",{type:"support"});i&&e.openChat({id:i.chatId,shouldReplaceHistory:!0,tabId:s})})),(0,b.aJ)("loadAllChats",(async(t,e,a)=>{const s=a.listType,{onReplace:d}=a;let{shouldReplace:i}=a,n=0;const r=e=>(0,v.yHC)(t,e.id,"saved"===s?"saved":"all")?.date||e.creationDate;for(;i||!t.chats.isFullyLoaded[s];){if(n++>=100)return void(o.Oig&&console.error("`actions/loadAllChats`: Infinite loop detected"));if("connectionStateReady"!==(t=(0,b.mS)()).connectionState||"authorizationStateReady"!==t.authState)return;const e=!i&&t.chats.listIds[s],a=e?e.map((e=>t.chats.byId[e])).filter((e=>Boolean(e&&r(e))&&e.id!==o.zv8&&!(0,v.D3D)(t,e.id))).sort(((t,e)=>r(t)-r(e)))[0]:void 0;await P(s,a?.id,a?r(a):void 0,i,!0),i&&(d?.(),i=!1),t=(0,b.mS)()}})),(0,b.aJ)("loadFullChat",((t,e,a)=>{const{chatId:s,force:d,tabId:o=(0,c.g0)(),withPhotos:i}=a,n=(0,v.hds)(t,s);if(!n)return;const r=async()=>{await J(t,e,n,o),i&&e.loadProfilePhotos({profileId:s})};d?r():T(r)})),(0,b.aJ)("loadTopChats",(()=>{U((()=>{P("active"),P("archived")}))})),(0,b.aJ)("requestChatUpdate",((t,e,a)=>{const{chatId:s}=a,d=(0,v.hds)(t,s);d&&(0,m.px)("requestChatUpdate",{chat:d,...s===o.zv8&&{lastLocalMessage:(0,v.xzS)(t)?.message}})})),(0,b.aJ)("requestSavedDialogUpdate",(async(t,e,a)=>{const{chatId:s}=a,d=(0,v.hds)(t,s);if(!d)return;const o=await(0,m.px)("fetchMessages",{chat:d,isSavedDialog:!0,limit:1});o&&(t=(0,b.mS)(),t=(0,V.Kc)(t,o.messages),t=(0,V.g1)(t,(0,h.dU)(o.users,"id")),t=(0,V.Nl)(t,(0,h.dU)(o.chats,"id")),o.messages.length?(t=(0,V.yK)(t,s,o.messages[0].id,"saved"),t=(0,V.wx)(t,"saved",[s]),(0,b.UF)(t)):(t=(0,V.SJ)(t,s,"saved"),(0,b.UF)(t),Object.values(t.byTabId).forEach((a=>{let{id:d}=a;const o=(0,v.Xf0)(t,d);if(!o)return;const{chatId:i,threadId:n}=o;(0,v.nZ4)(t,i)&&n===s&&e.openChat({id:void 0,tabId:d})}))))})),(0,b.aJ)("updateChatMutedState",((t,e,a)=>{const{chatId:s,muteUntil:d=0}=a,o=(0,v.hds)(t,s);if(!o)return;const i=a.isMuted??d>0;t=(0,V.wi)(t,s,{isMuted:i}),(0,b.UF)(t),(0,m.px)("updateChatMutedState",{chat:o,isMuted:i,muteUntil:d})})),(0,b.aJ)("updateTopicMutedState",((t,e,a)=>{const{chatId:s,topicId:d,muteUntil:o=0}=a,i=(0,v.hds)(t,s);if(!i)return;const n=a.isMuted??o>0;t=(0,V.Tw)(t,s,d,{isMuted:n}),(0,b.UF)(t),(0,m.px)("updateTopicMutedState",{chat:i,topicId:d,isMuted:n,muteUntil:o})})),(0,b.aJ)("createChannel",(async(t,e,a)=>{const{title:s,about:o,photo:i,memberIds:n,tabId:r=(0,c.g0)()}=a,l=n.map((e=>(0,v.mBe)(t,e))).filter(Boolean);let h,u;t=(0,w.w)(t,{chatCreation:{progress:d.n7.InProgress}},r),(0,b.UF)(t);try{const t=await(0,m.px)("createChannel",{title:s,about:o,users:l});h=t?.channel,u=t?.missingUsers}catch(a){t=(0,b.mS)(),t=(0,w.w)(t,{chatCreation:{progress:d.n7.Error}},r),(0,b.UF)(t),"CHANNELS_TOO_MUCH"===a.message?e.openLimitReachedModal({limit:"channels",tabId:r}):e.showDialog({data:{...a,hasErrorKey:!0},tabId:r})}if(!h)return;const{id:p,accessHash:I}=h;t=(0,b.mS)(),t=(0,V.wi)(t,p,h),t=(0,w.w)(t,{chatCreation:{...(0,v.nTw)(t,r).chatCreation,progress:h?d.n7.Complete:d.n7.Error}},r),(0,b.UF)(t),e.openChat({id:p,shouldReplaceHistory:!0,tabId:r}),u&&(t=(0,b.mS)(),t=(0,V.hQ)(t,p,u,r),(0,b.UF)(t)),p&&I&&i&&await(0,m.px)("editChatPhoto",{chatId:p,accessHash:I,photo:i})})),(0,b.aJ)("joinChannel",(async(t,e,a)=>{const{chatId:s,tabId:d=(0,c.g0)()}=a,o=(0,v.hds)(t,s);if(!o)return;const{id:i,accessHash:n}=o;if(i&&n)try{await(0,m.px)("joinChannel",{channelId:i,accessHash:n})}catch(t){"CHANNELS_TOO_MUCH"===t.message?e.openLimitReachedModal({limit:"channels",tabId:d}):e.showDialog({data:{...t,hasErrorKey:!0},tabId:d})}})),(0,b.aJ)("deleteChatUser",((t,e,a)=>{const{chatId:s,userId:d,tabId:o=(0,c.g0)()}=a,i=(0,v.hds)(t,s),n=(0,v.mBe)(t,d);i&&n&&(t=(0,V.CX)(t,s),(0,b.UF)(t),(0,v.Xf0)(t,o)?.chatId===s&&e.openChat({id:void 0,tabId:o}),(0,m.px)("deleteChatUser",{chat:i,user:n}))})),(0,b.aJ)("deleteChat",((t,e,a)=>{const{chatId:s,tabId:d=(0,c.g0)()}=a,o=(0,v.hds)(t,s);o&&(t=(0,V.CX)(t,s),(0,b.UF)(t),(0,v.Xf0)(t,d)?.chatId===s&&e.openChat({id:void 0,tabId:d}),(0,m.px)("deleteChat",{chatId:o.id}))})),(0,b.aJ)("leaveChannel",(async(t,e,a)=>{const{chatId:s,tabId:d=(0,c.g0)()}=a,o=(0,v.hds)(t,s);if(!o)return;t=(0,V.CX)(t,s),(0,b.UF)(t),(0,v.Xf0)(t,d)?.chatId===s&&e.openChat({id:void 0,tabId:d});const{id:i,accessHash:n}=o;if(i&&n){await(0,m.px)("leaveChannel",{channelId:i,accessHash:n}),t=(0,b.mS)();const e=(0,v.zeq)(t,s),a=Object.keys(e).map(Number).filter(p.iL);t=(0,V.AH)(t,s,a),(0,b.UF)(t)}})),(0,b.aJ)("deleteChannel",((t,e,a)=>{const{chatId:s,tabId:d=(0,c.g0)()}=a,o=(0,v.hds)(t,s);if(!o)return;t=(0,V.CX)(t,s),(0,b.UF)(t),(0,v.Xf0)(t,d)?.chatId===s&&e.openChat({id:void 0,tabId:d});const{id:i,accessHash:n}=o;i&&n&&(0,m.px)("deleteChannel",{channelId:i,accessHash:n})})),(0,b.aJ)("createGroupChat",(async(t,e,a)=>{const{title:s,memberIds:o,photo:i,tabId:n=(0,c.g0)()}=a,r=o.map((e=>(0,v.mBe)(t,e))).filter(Boolean);t=(0,w.w)(t,{chatCreation:{progress:d.n7.InProgress}},n),(0,b.UF)(t);try{const{chat:a,missingUsers:o}=await(0,m.px)("createGroupChat",{title:s,users:r})??{};if(!a)return;const{id:c}=a;t=(0,b.mS)(),t=(0,V.wi)(t,c,a),t=(0,w.w)(t,{chatCreation:{...(0,v.nTw)(t,n).chatCreation,progress:a?d.n7.Complete:d.n7.Error}},n),(0,b.UF)(t),e.openChat({id:c,shouldReplaceHistory:!0,tabId:n}),o&&(t=(0,b.mS)(),t=(0,V.hQ)(t,c,o,n),(0,b.UF)(t)),c&&i&&await(0,m.px)("editChatPhoto",{chatId:c,photo:i})}catch(e){"USERS_TOO_FEW"===e.message&&(t=(0,b.mS)(),t=(0,w.w)(t,{chatCreation:{...(0,v.nTw)(t,n).chatCreation,progress:d.n7.Error,error:"CreateGroupError"}},n),(0,b.UF)(t))}})),(0,b.aJ)("toggleChatPinned",((t,e,a)=>{const{id:s,folderId:d,tabId:i=(0,c.g0)()}=a,n=(0,v.hds)(t,s);if(!n)return;const r=(0,F.d)(t,"dialogFolderPinned");if(d){const e=(0,v.$aQ)(t,d);if(e){const a=!(0,v.D3D)(t,s,d),{pinnedChatIds:o,includedChatIds:i}=e,n=a?[s,...o||[]]:(o||[]).filter((t=>t!==s)),r=[s,...i];(0,m.px)("editChatFolder",{id:d,folderUpdate:{...e,pinnedChatIds:n,includedChatIds:r}})}}else{const a=(0,v.P4G)(t,s),d=(0,v.D3D)(t,s,"archived"===a?o._E9:void 0),c=t.chats.orderedPinnedIds["archived"===a?"archived":"active"];if((c?.length||0)>=r&&!d)return void e.openLimitReachedModal({limit:"dialogFolderPinned",tabId:i});(0,m.px)("toggleChatPinned",{chat:n,shouldBePinned:!d})}})),(0,b.aJ)("toggleChatArchived",((t,e,a)=>{const{id:s}=a,d=(0,v.hds)(t,s);d&&(0,m.px)("toggleChatArchived",{chat:d,folderId:(0,f.TJ)(d)?0:o._E9})})),(0,b.aJ)("toggleSavedDialogPinned",((t,e,a)=>{const{id:s,tabId:d=(0,c.g0)()}=a,i=(0,v.hds)(t,s);if(!i)return;const n=(0,F.d)(t,"savedDialogsPinned"),r=(0,v.D3D)(t,s,o.pX9),l=t.chats.orderedPinnedIds.saved;(l?.length||0)>=n&&!r?e.openLimitReachedModal({limit:"savedDialogsPinned",tabId:d}):(0,m.px)("toggleSavedDialogPinned",{chat:i,shouldBePinned:!r})})),(0,b.aJ)("loadChatFolders",(async t=>{const e=await(0,m.px)("fetchChatFolders");e&&(t=(0,b.mS)(),t={...t,chatFolders:{...t.chatFolders,...e}},(0,b.UF)(t))})),(0,b.aJ)("loadRecommendedChatFolders",(async t=>{const e=await(0,m.px)("fetchRecommendedChatFolders");e&&(t=(0,b.mS)(),t={...t,chatFolders:{...t.chatFolders,recommended:e}},(0,b.UF)(t))})),(0,b.aJ)("editChatFolders",((t,e,a)=>{const{chatId:s,idsToRemove:d,idsToAdd:o,tabId:i=(0,c.g0)()}=a,n=(0,F.d)(t,"dialogFiltersChats");o.some((e=>(0,v.$aQ)(t,e).includedChatIds.length>=n))?e.openLimitReachedModal({limit:"dialogFiltersChats",tabId:i}):(d.forEach((async e=>{const a=(0,v.$aQ)(t,e);a&&await(0,m.px)("editChatFolder",{id:e,folderUpdate:{...a,pinnedChatIds:a.pinnedChatIds?.filter((t=>t!==s)),includedChatIds:a.includedChatIds.filter((t=>t!==s))}})})),o.forEach((async e=>{const a=(0,v.$aQ)(t,e);a&&await(0,m.px)("editChatFolder",{id:e,folderUpdate:{...a,includedChatIds:a.includedChatIds.concat(s)}})})))})),(0,b.aJ)("editChatFolder",((t,e,a)=>{const{id:s,folderUpdate:d}=a,o=(0,v.$aQ)(t,s);o&&(0,m.px)("editChatFolder",{id:s,folderUpdate:{id:s,emoticon:o.emoticon,pinnedChatIds:o.pinnedChatIds,...d}})})),(0,b.aJ)("addChatFolder",(async(t,e,a)=>{const{folder:s,tabId:d=(0,c.g0)()}=a,{orderedIds:i,byId:n}=t.chatFolders,r=(0,F.d)(t,"dialogFilters");if(Object.keys(n).length>=r)return void e.openLimitReachedModal({limit:"dialogFilters",tabId:d});const l=Math.max(...i||[],o._E9),{id:h,description:u,...p}=s,I=l+1,g={id:I,...p};if(await(0,m.px)("editChatFolder",{id:I,folderUpdate:g}),e.apiUpdate({"@type":"updateChatFolder",id:I,folder:g}),e.requestNextSettingsScreen({foldersAction:{type:"setFolderId",payload:l+1},tabId:d}),!u)return;t=(0,b.mS)();const{recommended:f}=t.chatFolders;f&&(t={...t,chatFolders:{...t.chatFolders,recommended:f.filter((t=>{let{id:e}=t;return e!==h}))}},(0,b.UF)(t))})),(0,b.aJ)("sortChatFolders",(async(t,e,a)=>{const{folderIds:s}=a;await(0,m.px)("sortChatFolders",s)&&(t=(0,b.mS)(),t={...t,chatFolders:{...t.chatFolders,orderedIds:s}},(0,b.UF)(t))})),(0,b.aJ)("deleteChatFolder",(async(t,e,a)=>{const{id:s}=a;(0,v.$aQ)(t,s)&&await(0,m.px)("deleteChatFolder",s)})),(0,b.aJ)("toggleChatUnread",((t,e,a)=>{const{id:d}=a,o=(0,v.hds)(t,d);o&&(o.unreadCount?(0,m.px)("markMessageListRead",{chat:o,threadId:s.l3}):(0,m.px)("toggleDialogUnread",{chat:o,hasUnreadMark:!o.hasUnreadMark}))})),(0,b.aJ)("markTopicRead",((t,e,a)=>{const{chatId:s,topicId:d}=a,o=(0,v.hds)(t,s);if(!o)return;const i=o.topics?.[d]?.lastMessageId;i&&((0,m.px)("markMessageListRead",{chat:o,threadId:d,maxId:i}),t=(0,b.mS)(),t=(0,V.Tw)(t,s,d,{unreadCount:0}),t=(0,V.eA)(t,s,d,{lastReadInboxMessageId:i}),(0,b.UF)(t))})),(0,b.aJ)("openChatByInvite",(async(t,e,a)=>{const{hash:s,tabId:d=(0,c.g0)()}=a,o=await(0,m.px)("openChatByInvite",s);o&&e.openChat({id:o.chatId,tabId:d})})),(0,b.aJ)("openChatByPhoneNumber",(async(t,e,a)=>{const{phoneNumber:s,startAttach:d,attach:i,text:n,tabId:r=(0,c.g0)()}=a;e.openChat({id:o.Xab,tabId:r});const l=await async function(t,e){t=(0,b.mS)();const a=(0,v.gTO)(t,e);if(a&&!a.isMin)return(0,v.hds)(t,a.id);const{chat:s,user:d}=await(0,m.px)("getChatByPhoneNumber",e)||{};return s?(t=(0,b.mS)(),t=(0,V.wi)(t,s.id,s),d&&(t=(0,V.TK)(t,d.id,d)),(0,b.UF)(t),s):void 0}(t,s);if(!l)return e.openPreviousChat({tabId:r}),void e.showNotification({message:u.Tl("lng_username_by_phone_not_found").replace("{phone}",s),tabId:r});n?e.openChatWithDraft({chatId:l.id,text:{text:n},tabId:r}):e.openChat({id:l.id,tabId:r}),i&&R(t=(0,b.mS)(),e,l.id,i,d,r)})),(0,b.aJ)("openTelegramLink",((t,e,a)=>{const{url:s,tabId:d=(0,c.g0)()}=a,{openChatByPhoneNumber:i,openChatByInvite:l,openStickerSet:h,openChatWithDraft:u,joinVoiceChatByLink:p,focusMessage:I,openInvoice:g,processAttachBotParameters:m,checkChatlistInvite:b,openChatByUsername:V,openStoryViewerByUsername:C,processBoostParameters:w,checkGiftCode:v}=e;if((0,r.z)(s)&&((0,n.__)(s)||s.match(o.bnE)))return;const y=new URL(s.toLowerCase().startsWith("http")?s:`https://${s}`);if(o.G38.has(y.hostname)&&"/"===y.pathname)return void window.open(y.toString(),"_blank","noopener");const F=(o.G38.has(y.hostname)?"t.me":y.hostname).split(".");if(F.length>3)return;const A=3===F.length?`${F[0]}/${y.pathname}`:y.pathname,[S,U,T]=A.split("/").filter(Boolean).map((t=>decodeURI(t))),M=Object.fromEntries(y.searchParams);let x;"joinchat"===S&&(x=U);const P=M.hasOwnProperty("startattach"),J=M.hasOwnProperty("startapp"),B=(0,n._o)(M.choose),H="s"===U&&(Number(T)||void 0),R=M.hasOwnProperty("boost");if(S.match(/^\+([0-9]+)(\?|$)/))return void i({phoneNumber:S.substr(1,S.length-1),startAttach:M.startattach,attach:M.attach,text:M.text,tabId:d});if(H)return void C({username:S,storyId:H,tabId:d});if((S.startsWith(" ")||S.startsWith("+"))&&(x=S.substr(1,S.length-1)),x)return void l({hash:x,tabId:d});if("addstickers"===S||"addemoji"===S)return void h({stickerSetInfo:{shortName:U},tabId:d});if("share"===S)return void u({text:(0,n.Ey)(M.url,M.text),tabId:d});if("addlist"===S)return void b({slug:U,tabId:d});if("giftcode"===S)return void v({slug:U,tabId:d});const L=U||void 0,N=T?Number(T):void 0,D=M.comment?Number(M.comment):void 0;if(M.hasOwnProperty("voicechat")||M.hasOwnProperty("livestream"))p({username:S,inviteHash:M.voicechat||M.livestream,tabId:d});else if("boost"===S){const t=U,e=M.c;w({usernameOrId:t||e,isPrivate:!t&&Boolean(e),tabId:d})}else R?w({usernameOrId:L||S,isPrivate:"c"===S&&Boolean(L),tabId:d}):"c"===S&&L&&N?I({chatId:(0,f.QE)(L),messageId:N,tabId:d}):S.startsWith("$")?g({type:"slug",slug:S.substring(1),tabId:d}):"invoice"===S?g({type:"slug",slug:U,tabId:d}):P&&B||!U&&J?m({username:S,filter:B,startParam:M.startattach||M.startapp,tabId:d}):V({username:S,messageId:N||Number(L),threadId:N?Number(L):void 0,commentId:D,startParam:M.start,startAttach:M.startattach,attach:M.attach,startApp:M.startapp,originalParts:[S,U,T],tabId:d})})),(0,b.aJ)("processBoostParameters",(async(t,e,a)=>{const{usernameOrId:s,isPrivate:d,tabId:o=(0,c.g0)()}=a;let i;if(d){const a=(0,f.QE)(s);if(i=(0,v.hds)(t,a),!i)return void e.showNotification({message:"Chat does not exist",tabId:o})}else if(i=await B(t,s),!i)return void e.showNotification({message:"User does not exist",tabId:o});(0,f.WX)(i)||(0,f.Vs)(i)?e.openBoostModal({chatId:i.id,tabId:o}):e.openChat({id:i.id,tabId:o})})),(0,b.aJ)("acceptInviteConfirmation",(async(t,e,a)=>{const{hash:s,tabId:d=(0,c.g0)()}=a,o=await(0,m.px)("importChatInvite",{hash:s});o&&e.openChat({id:o.id,tabId:d})})),(0,b.aJ)("openChatByUsername",(async(t,e,a)=>{const{username:d,messageId:i,commentId:n,startParam:r,startAttach:l,attach:h,threadId:u,originalParts:p,startApp:I,text:m,tabId:f=(0,c.g0)()}=a,V=(0,v.meB)(t,f),C=p?.[1],w=C&&!Number(C)&&!p?.[2];if(!n){if(void 0===l&&i&&!r&&V?.usernames?.some((t=>t.username===d)))return void e.focusMessage({chatId:V.id,threadId:u,messageId:i,tabId:f});if(!w)return void await async function(t,e,a){for(var d=arguments.length,i=new Array(d>3?d-3:0),n=3;n<d;n++)i[n-3]=arguments[n];let[r=(0,c.g0)()]=i;const{username:l,threadId:h,channelPostId:u,startParam:p,startAttach:I,attach:g,text:m}=a;t=(0,b.mS)();const f=(0,v.meB)(t,r);if(void 0!==I&&!g){const a=await H(t,e,l,r);if(!a)return;return void e.callAttachBot({bot:a,chatId:f?.id||a.id,startParam:I,tabId:r})}const V=f?.usernames?.some((t=>t.username===l));V||e.openChat({id:o.Xab,tabId:r});const C=await B(t,l);C?(u?e.focusMessage({chatId:C.id,threadId:h,messageId:u,tabId:r}):V||e.openThread({chatId:C.id,threadId:h??s.l3,tabId:r}),p&&e.startBot({botId:C.id,param:p}),g&&R(t=(0,b.mS)(),e,C.id,g,I,r),m&&e.openChatWithDraft({chatId:C.id,text:{text:m},tabId:r})):V||(e.openPreviousChat({tabId:r}),e.showNotification({message:"User does not exist",tabId:r}))}(t,e,{username:d,threadId:u,channelPostId:i,startParam:r,startAttach:l,attach:h,text:m},f)}const y=(0,v.qn$)(t,d);if(n&&i&&y)return void e.openThread({isComments:!0,originChannelId:y.id,originMessageId:i,tabId:f,focusMessageId:n});w||e.openChat({id:o.Xab,tabId:f});const F=await B(t,d);if(F)if(w&&F){const t=(0,g.A)();e.requestAppWebView({appName:C,botId:F.id,tabId:f,startApp:I,theme:t})}else i&&e.openThread({isComments:!0,originChannelId:F.id,originMessageId:i,tabId:f,focusMessageId:n})})),(0,b.aJ)("togglePreHistoryHidden",(async(t,e,a)=>{const{chatId:s,isEnabled:d,tabId:o=(0,c.g0)()}=a,i=await L(t,e,s,o);i&&(t=(0,b.mS)(),t=(0,V.lt)(t,i.id,{isPreHistoryHidden:d}),(0,b.UF)(t),(0,m.px)("togglePreHistoryHidden",{chat:i,isEnabled:d}))})),(0,b.aJ)("updateChatDefaultBannedRights",((t,e,a)=>{const{chatId:s,bannedRights:d}=a,o=(0,v.hds)(t,s);o&&(0,m.px)("updateChatDefaultBannedRights",{chat:o,bannedRights:d})})),(0,b.aJ)("updateChatMemberBannedRights",(async(t,e,a)=>{const{chatId:s,userId:d,bannedRights:o,tabId:i=(0,c.g0)()}=a,n=(0,v.mBe)(t,d);if(!n)return;const r=await L(t,e,s,i);if(!r)return;await(0,m.px)("updateChatMemberBannedRights",{chat:r,user:n,bannedRights:o}),t=(0,b.mS)();const l=(0,v.AWZ)(t,r.id);if(!l)return;const{members:h,kickedMembers:u}=l,p=Boolean(o.viewMessages),I=!Object.keys(o).length;t=(0,V.lt)(t,r.id,{...h&&p&&{members:h.filter((t=>t.userId!==d))},...h&&!p&&{members:h.map((t=>t.userId===d?{...t,bannedRights:o}:t))},...I&&u&&{kickedMembers:u.filter((t=>t.userId!==d))}}),(0,b.UF)(t)})),(0,b.aJ)("updateChatAdmin",(async(t,e,a)=>{const{chatId:s,userId:d,adminRights:o,customTitle:i,tabId:n=(0,c.g0)()}=a,r=(0,v.mBe)(t,d);if(!r)return;const l=await L(t,e,s,n);if(!l)return;await(0,m.px)("updateChatAdmin",{chat:l,user:r,adminRights:o,customTitle:i});const h=await(0,m.px)("fetchFullChat",l);if(!h?.fullInfo)return;const{adminMembersById:u}=h.fullInfo,p=!Object.keys(o).length;let I;if(u)if(p){const{[d]:t,...e}=u;I=e}else I={...u,[d]:{...u[d],adminRights:o,customTitle:i}};I&&(t=(0,b.mS)(),t=(0,V.lt)(t,l.id,{adminMembersById:I}),(0,b.UF)(t))})),(0,b.aJ)("updateChat",(async(t,e,a)=>{const{chatId:s,title:o,about:i,photo:n,tabId:r=(0,c.g0)()}=a,l=(0,v.hds)(t,s),h=(0,v.AWZ)(t,s);l&&(t=(0,b.mS)(),t=(0,V.nH)(t,d.TD.InProgress,r),(0,b.UF)(t),await Promise.all([l.title!==o?(0,m.px)("updateChatTitle",l,o):void 0,h?.about!==i?(0,m.px)("updateChatAbout",l,i):void 0,n?(0,m.px)("editChatPhoto",{chatId:s,accessHash:l.accessHash,photo:n}):void 0]),t=(0,b.mS)(),t=(0,V.nH)(t,d.TD.Complete,r),(0,b.UF)(t),n&&e.loadFullChat({chatId:s,tabId:r,withPhotos:!0}))})),(0,b.aJ)("updateChatPhoto",(async(t,e,a)=>{const{photo:s,chatId:d,tabId:o=(0,c.g0)()}=a,i=(0,v.hds)(t,d);i&&(t=(0,V.wi)(t,d,{avatarHash:void 0}),t=(0,V.lt)(t,d,{profilePhoto:void 0}),(0,b.UF)(t),await(0,m.px)("editChatPhoto",{chatId:d,accessHash:i.accessHash,photo:s}),await(0,m.px)("deleteProfilePhotos",[s]),e.loadFullChat({chatId:d,tabId:o,withPhotos:!0}))})),(0,b.aJ)("deleteChatPhoto",(async(t,e,a)=>{const{photo:s,chatId:d,tabId:o=(0,c.g0)()}=a,i=(0,v.hds)(t,d);if(!i)return;const n=[s];if(i.avatarHash===s.id){const e=i.photos?.[1];e&&n.push(e),t=(0,V.wi)(t,d,{avatarHash:void 0}),t=(0,V.lt)(t,d,{profilePhoto:void 0}),(0,b.UF)(t),await(0,m.px)("editChatPhoto",{chatId:d,accessHash:i.accessHash,photo:e})}const{photos:r=[]}=i,l=r.filter((t=>n.some((e=>e.id!==t.id))));t=(0,b.mS)(),t=(0,V.wi)(t,d,{photos:l}),(0,b.UF)(t),await(0,m.px)("deleteProfilePhotos",n)&&e.loadFullChat({chatId:d,tabId:o,withPhotos:!0})})),(0,b.aJ)("toggleSignatures",((t,e,a)=>{const{chatId:s,isEnabled:d}=a,o=(0,v.hds)(t,s);o&&(0,m.px)("toggleSignatures",{chat:o,isEnabled:d})})),(0,b.aJ)("loadGroupsForDiscussion",(async t=>{const e=await(0,m.px)("fetchGroupsForDiscussion");if(!e)return;const a=e.reduce(((t,e)=>(e&&!e.isForum&&(t[e.id]=e),t)),{});t=(0,b.mS)(),t=(0,V.Nl)(t,a),t={...t,chats:{...t.chats,forDiscussionIds:Object.keys(a)}},(0,b.UF)(t)})),(0,b.aJ)("linkDiscussionGroup",(async(t,e,a)=>{const{channelId:s,chatId:d,tabId:o=(0,c.g0)()}=a||{},i=(0,v.hds)(t,s);if(!i)return;const n=await L(t,e,d,o);if(!n)return;let r=(0,v.AWZ)(t,n.id);if(!r){const t=await(0,m.px)("fetchFullChat",n);if(!t)return;r=t.fullInfo}r.isPreHistoryHidden&&(t=(0,b.mS)(),t=(0,V.lt)(t,n.id,{isPreHistoryHidden:!1}),(0,b.UF)(t),await(0,m.px)("togglePreHistoryHidden",{chat:n,isEnabled:!1})),(0,m.px)("setDiscussionGroup",{channel:i,chat:n})})),(0,b.aJ)("unlinkDiscussionGroup",(async(t,e,a)=>{const{channelId:s,tabId:d=(0,c.g0)()}=a,o=(0,v.hds)(t,s);if(!o)return;const i=(0,v.AWZ)(t,s);let n;i?.linkedChatId&&(n=(0,v.hds)(t,i.linkedChatId)),await(0,m.px)("setDiscussionGroup",{channel:o}),n&&J(t=(0,b.mS)(),e,n,d)})),(0,b.aJ)("setActiveChatFolder",((t,e,a)=>{const{activeChatFolder:s,tabId:d=(0,c.g0)()}=a;if(!(s+1>(0,F.d)(t,"dialogFilters")))return(0,w.w)(t,{activeChatFolder:s},d);e.openLimitReachedModal({limit:"dialogFilters",tabId:d})})),(0,b.aJ)("resetOpenChatWithDraft",((t,e,a)=>{const{tabId:s=(0,c.g0)()}=a||{};return(0,w.w)(t,{requestedDraft:void 0},s)})),(0,b.aJ)("loadMoreMembers",(async(t,e,a)=>{const{tabId:s=(0,c.g0)()}=a||{},{chatId:d}=(0,v.Xf0)(t,s)||{},o=d?(0,v.hds)(t,d):void 0;if(!o||(0,f.yn)(o))return;const i=(0,v.AWZ)(t,o.id)?.members?.length;if(void 0!==i&&void 0!==o.membersCount&&i>=o.membersCount)return;const n=await(0,m.px)("fetchMembers",o.id,o.accessHash,"recent",i);if(!n)return;const{members:r,users:l,userStatusesById:u}=n;r&&r.length&&(t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(l,"id")),t=(0,V.d2)(t,u),t=(0,V.t_)(t,o,r),(0,b.UF)(t))})),(0,b.aJ)("addChatMembers",(async(t,e,a)=>{const{chatId:s,memberIds:o,tabId:i=(0,c.g0)()}=a,n=(0,v.hds)(t,s),r=o.map((e=>(0,v.mBe)(t,e))).filter(Boolean);if(!n||!r.length)return;e.setNewChatMembersDialogState({newChatMembersProgress:d.D7.Loading,tabId:i});const l=await(0,m.px)("addChatMembers",n,r);l&&(t=(0,b.mS)(),t=(0,V.hQ)(t,s,l,i),(0,b.UF)(t)),e.setNewChatMembersDialogState({newChatMembersProgress:d.D7.Closed,tabId:i}),J(t=(0,b.mS)(),e,n,i)})),(0,b.aJ)("deleteChatMember",(async(t,e,a)=>{const{chatId:s,userId:d,tabId:o=(0,c.g0)()}=a,i=(0,v.hds)(t,s),n=(0,v.mBe)(t,d);i&&n&&(await(0,m.px)("deleteChatMember",i,n),J(t=(0,b.mS)(),e,i,o))})),(0,b.aJ)("toggleIsProtected",((t,e,a)=>{const{chatId:s,isProtected:d}=a,o=(0,v.hds)(t,s);o&&(0,m.px)("toggleIsProtected",{chat:o,isProtected:d})})),(0,b.aJ)("setChatEnabledReactions",(async(t,e,a)=>{const{chatId:s,enabledReactions:d,tabId:o=(0,c.g0)()}=a,i=(0,v.hds)(t,s);i&&(await(0,m.px)("setChatEnabledReactions",{chat:i,enabledReactions:d}),J(t=(0,b.mS)(),e,i,o))})),(0,b.aJ)("fetchChat",((t,e,a)=>{const{chatId:s}=a;if(!(0,v.hds)(t,s))if((0,v.nZ4)(t,s))(0,m.px)("fetchChat",{type:"self"});else{const e=(0,v.mBe)(t,s);e&&(0,m.px)("fetchChat",{type:"user",user:e})}})),(0,b.aJ)("loadChatSettings",(async(t,e,a)=>{const{chatId:s}=a,d=(0,v.hds)(t,s);if(!d)return;const o=await(0,m.px)("fetchChatSettings",d);if(!o)return;const{settings:i,users:n}=o;t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(n,"id")),t=(0,V.wi)(t,d.id,{settings:i}),(0,b.UF)(t)})),(0,b.aJ)("toggleJoinToSend",(async(t,e,a)=>{const{chatId:s,isEnabled:d}=a,o=(0,v.hds)(t,s);o&&((0,f.Vs)(o)||(0,f.WX)(o))&&await(0,m.px)("toggleJoinToSend",o,d)})),(0,b.aJ)("toggleJoinRequest",(async(t,e,a)=>{const{chatId:s,isEnabled:d}=a,o=(0,v.hds)(t,s);o&&((0,f.Vs)(o)||(0,f.WX)(o))&&await(0,m.px)("toggleJoinRequest",o,d)})),(0,b.aJ)("openForumPanel",((t,e,a)=>{const{chatId:s,tabId:d=(0,c.g0)()}=a;return e.toggleStoryRibbon({isShown:!1,tabId:d}),e.toggleStoryRibbon({isShown:!1,isArchived:!0,tabId:d}),(0,w.w)(t,{forumPanelChatId:s},d)})),(0,b.aJ)("closeForumPanel",((t,e,a)=>{const{tabId:s=(0,c.g0)()}=a||{};return(0,w.w)(t,{forumPanelChatId:void 0},s)})),(0,b.aJ)("processAttachBotParameters",(async(t,e,a)=>{const{username:s,filter:d,startParam:o,tabId:i=(0,c.g0)()}=a,n=await H(t,e,s,i);if(!n)return;if(!Boolean(d))return void e.callAttachBot({isFromSideMenu:!0,bot:n,startParam:o,tabId:i});t=(0,b.mS)();const{attachMenu:{bots:r}}=t;if(!r[n.id])return t=(0,w.w)(t,{requestedAttachBotInstall:{bot:n,onConfirm:{action:"requestAttachBotInChat",payload:{bot:n,filter:d,startParam:o}}}},i),void(0,b.UF)(t);e.requestAttachBotInChat({bot:n,filter:d,startParam:o,tabId:i})})),(0,b.aJ)("loadTopics",(async(t,e,a)=>{const{chatId:s,force:d}=a,i=(0,v.hds)(t,s);if(!i)return;if(!d&&i.listedTopicIds&&i.listedTopicIds.length===i.topicsCount)return;const n=!d&&i.listedTopicIds?i.listedTopicIds.reduce(((t,e)=>{const a=i.topics?.[e],s=i.topics?.[t];return a&&(!s||a.lastMessageId<s.lastMessageId)?e:t})):void 0,{id:r,date:c,lastMessageId:l}=n&&i.topics?.[n]||{},u=await(0,m.px)("fetchTopics",{chat:i,offsetTopicId:r,offsetId:l,offsetDate:c,limit:r?o.iIc:o.qj6});u&&(t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(u.users,"id")),t=(0,V.Nl)(t,(0,h.dU)(u.chats,"id")),t=(0,V.Kc)(t,u.messages),t=(0,V.mI)(t,s,u.count,u.topics),t=(0,V.Y4)(t,s,u.topics.map((t=>t.id))),Object.entries(u.draftsById||{}).forEach((e=>{let[a,d]=e;t=(0,V.ew)(t,s,Number(a),"draft",d)})),Object.entries(u.readInboxMessageIdByTopicId||{}).forEach((e=>{let[a,d]=e;t=(0,V.eA)(t,s,Number(a),{lastReadInboxMessageId:d})})),(0,b.UF)(t))})),(0,b.aJ)("loadTopicById",(async(t,e,a)=>{const{chatId:s,topicId:d}=a,o=(0,v.hds)(t,s);if(!o)return;const i=await(0,m.px)("fetchTopicById",{chat:o,topicId:d});if(i)t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(i.users,"id")),t=(0,V.Nl)(t,(0,h.dU)(i.chats,"id")),t=(0,V.Kc)(t,i.messages),t=(0,V.Tw)(t,s,d,i.topic),(0,b.UF)(t);else if("tabId"in a&&a.shouldCloseChatOnError){const{tabId:t=(0,c.g0)()}=a;e.openChat({id:void 0,tabId:t})}})),(0,b.aJ)("toggleForum",(async(t,e,a)=>{const{chatId:s,isEnabled:d,tabId:o=(0,c.g0)()}=a,i=await L(t,e,s,o);if(!i)return;let n;try{n=await(0,m.px)("toggleForum",{chat:i,isEnabled:d})}catch(t){t.message.startsWith("A wait of")?e.showNotification({message:u.Tl("FloodWait"),tabId:o}):e.showDialog({data:{...t,hasErrorKey:!0},tabId:o})}n&&(t=(0,b.mS)(),t=(0,V.wi)(t,i.id,{isForum:d}),(0,b.UF)(t),d?e.openForumPanel({chatId:i.id,tabId:o}):e.closeForumPanel({tabId:o}))})),(0,b.aJ)("toggleParticipantsHidden",(async(t,e,a)=>{const{chatId:s,isEnabled:d}=a,o=(0,v.hds)(t,s);if(!o)return;const i=(0,v.AWZ)(t,o.id)?.areParticipantsHidden;t=(0,V.lt)(t,s,{areParticipantsHidden:d}),(0,b.UF)(t),await(0,m.px)("toggleParticipantsHidden",{chat:o,isEnabled:d})||void 0===i||(t=(0,b.mS)(),t=(0,V.lt)(t,s,{areParticipantsHidden:i}),(0,b.UF)(t))})),(0,b.aJ)("createTopic",(async(t,e,a)=>{const{chatId:s,title:d,iconColor:o,iconEmojiId:i,tabId:n=(0,c.g0)()}=a,r=(0,v.hds)(t,s);if(!r)return;(0,v.nTw)(t,n).createTopicPanel&&(t=(0,w.w)(t,{createTopicPanel:{chatId:s,isLoading:!0}},n),(0,b.UF)(t));const l=await(0,m.px)("createTopic",{chat:r,title:d,iconColor:o,iconEmojiId:i});l&&e.openThread({chatId:s,threadId:l,shouldReplaceHistory:!0,tabId:n}),e.closeCreateTopicPanel({tabId:n})})),(0,b.aJ)("deleteTopic",(async(t,e,a)=>{const{chatId:s,topicId:d}=a,o=(0,v.hds)(t,s);o&&(await(0,m.px)("deleteTopic",{chat:o,topicId:d}),t=(0,b.mS)(),t=(0,V.do)(t,s,d),(0,b.UF)(t))})),(0,b.aJ)("editTopic",(async(t,e,a)=>{const{chatId:s,topicId:d,tabId:o=(0,c.g0)(),...i}=a,n=(0,v.hds)(t,s),r=n?.topics?.[d];n&&r&&((0,v.nTw)(t,o).editTopicPanel&&(t=(0,w.w)(t,{editTopicPanel:{chatId:s,topicId:d,isLoading:!0}},o),(0,b.UF)(t)),await(0,m.px)("editTopic",{chat:n,topicId:d,...i})&&(t=(0,b.mS)(),t=(0,V.Tw)(t,s,d,i),(0,b.UF)(t),e.closeEditTopicPanel({tabId:o})))})),(0,b.aJ)("toggleTopicPinned",((t,e,a)=>{const{chatId:s,topicId:d,isPinned:o,tabId:i=(0,c.g0)()}=a,{topicsPinnedLimit:n}=t.appConfig||{},r=(0,v.hds)(t,s);r&&r.topics&&n&&(o&&Object.values(r.topics).filter((t=>t.isPinned)).length>=n?e.showNotification({message:u.Tl("LimitReachedPinnedTopics",n,"i"),tabId:i}):(0,m.px)("togglePinnedTopic",{chat:r,topicId:d,isPinned:o}))})),(0,b.aJ)("checkChatlistInvite",(async(t,e,a)=>{const{slug:s,tabId:d=(0,c.g0)()}=a,o=await(0,m.px)("checkChatlistInvite",{slug:s});o?(t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(o.users,"id")),t=(0,V.Nl)(t,(0,h.dU)(o.chats,"id")),t=(0,w.w)(t,{chatlistModal:{invite:o.invite}},d),(0,b.UF)(t)):e.showNotification({message:u.Tl("lng_group_invite_bad_link"),tabId:d})})),(0,b.aJ)("joinChatlistInvite",(async(t,e,a)=>{const{invite:s,peerIds:d,tabId:o=(0,c.g0)()}=a,i=d.map((e=>(0,v.hds)(t,e))).filter(Boolean),n=i.filter((t=>t.isNotJoined)).length,r="folderId"in s?(0,v.$aQ)(t,s.folderId):void 0,l="title"in s?s.title:r?.title;try{if(!await(0,m.px)("joinChatlistInvite",{slug:s.slug,peers:i}))return;e.showNotification({title:u.Tl(r?"FolderLinkUpdatedTitle":"FolderLinkAddedTitle",l),message:u.Tl("FolderLinkAddedSubtitle",n,"i"),tabId:o})}catch(t){"CHATLISTS_TOO_MUCH"===t.message?e.openLimitReachedModal({limit:"chatlistJoined",tabId:o}):e.showDialog({data:{...t,hasErrorKey:!0},tabId:o})}})),(0,b.aJ)("leaveChatlist",(async(t,e,a)=>{const{folderId:s,peerIds:d,tabId:o=(0,c.g0)()}=a,i=(0,v.$aQ)(t,s),n=d?.map((e=>(0,v.hds)(t,e))).filter(Boolean)||[];await(0,m.px)("leaveChatlist",{folderId:s,peers:n})&&e.showNotification({title:u.Tl("FolderLinkDeletedTitle",i.title),message:u.Tl("FolderLinkDeletedSubtitle",n.length,"i"),tabId:o})})),(0,b.aJ)("loadChatlistInvites",(async(t,e,a)=>{const{folderId:s}=a,d=await(0,m.px)("fetchChatlistInvites",{folderId:s});d&&(t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(d.users,"id")),t=(0,V.Nl)(t,(0,h.dU)(d.chats,"id")),t={...t,chatFolders:{...t.chatFolders,invites:{...t.chatFolders.invites,[s]:d.invites}}},(0,b.UF)(t))})),(0,b.aJ)("createChatlistInvite",(async(t,e,a)=>{const{folderId:s,tabId:o=(0,c.g0)()}=a,i=(0,v.$aQ)(t,s);if(!i)return;let n;t=(0,w.w)(t,{shareFolderScreen:{...(0,v.nTw)(t,o).shareFolderScreen,isLoading:!0}},o),(0,b.UF)(t);try{n=await(0,m.px)("createChalistInvite",{folderId:s,peers:i.includedChatIds.concat(i.pinnedChatIds||[]).map((e=>(0,v.hds)(t,e)||(0,v.mBe)(t,e))).filter(Boolean)})}catch(t){S.has(t.message)?(e.openLimitReachedModal({limit:"chatlistInvites",tabId:o}),e.requestNextSettingsScreen({screen:d.VS.Folders,tabId:o})):e.showDialog({data:{...t,hasErrorKey:!0},tabId:o})}if(!n||!n.invite)return;const{shareFolderScreen:r}=(0,v.nTw)(t,o);r&&(t=(0,b.mS)(),t={...t,chatFolders:{...t.chatFolders,byId:{...t.chatFolders.byId,[s]:{...t.chatFolders.byId[s],...n.filter}},invites:{...t.chatFolders.invites,[s]:[...t.chatFolders.invites[s]||[],n.invite]}}},t=(0,w.w)(t,{shareFolderScreen:{...r,url:n.invite.url,isLoading:!1}},o),(0,b.UF)(t))})),(0,b.aJ)("editChatlistInvite",(async(t,e,a)=>{const{folderId:s,peerIds:d,url:o,tabId:i=(0,c.g0)()}=a,n=o.split("/").pop();if(!n)return;const r=d.map((e=>(0,v.hds)(t,e)||(0,v.mBe)(t,e))).filter(Boolean);t=(0,w.w)(t,{shareFolderScreen:{...(0,v.nTw)(t,i).shareFolderScreen,isLoading:!0}},i),(0,b.UF)(t);try{const e=await(0,m.px)("editChatlistInvite",{folderId:s,slug:n,peers:r});if(!e)return;t=(0,b.mS)(),t={...t,chatFolders:{...t.chatFolders,invites:{...t.chatFolders.invites,[s]:t.chatFolders.invites[s]?.map((t=>t.url===o?e:t))}}},(0,b.UF)(t)}catch(t){e.showDialog({data:{...t,hasErrorKey:!0},tabId:i})}finally{t=(0,b.mS)(),t=(0,w.w)(t,{shareFolderScreen:{...(0,v.nTw)(t,i).shareFolderScreen,isLoading:!1}},i),(0,b.UF)(t)}})),(0,b.aJ)("deleteChatlistInvite",(async(t,e,a)=>{const{folderId:s,url:d}=a,o=d.split("/").pop();o&&await(0,m.px)("deleteChatlistInvite",{folderId:s,slug:o})&&(t=(0,b.mS)(),t={...t,chatFolders:{...t.chatFolders,invites:{...t.chatFolders.invites,[s]:t.chatFolders.invites[s]?.filter((t=>t.url!==d))}}},(0,b.UF)(t))})),(0,b.aJ)("openDeleteChatFolderModal",(async(t,e,a)=>{const{folderId:s,isConfirmedForChatlist:d,tabId:o=(0,c.g0)()}=a,i=(0,v.$aQ)(t,s);if(i){if(i.isChatList&&(!i.hasMyInvites||d)){const e=await(0,m.px)("fetchLeaveChatlistSuggestions",{folderId:s});return t=(0,b.mS)(),t=(0,w.w)(t,{chatlistModal:{removal:{folderId:s,suggestedPeerIds:e}}},o),void(0,b.UF)(t)}t=(0,w.w)(t,{deleteFolderDialogModal:s},o),(0,b.UF)(t)}})),(0,b.aJ)("updateChatDetectedLanguage",((t,e,a)=>{const{chatId:s,detectedLanguage:d}=a;return t=(0,b.mS)(),(0,V.wi)(t,s,{detectedLanguage:d})})),(0,b.aJ)("togglePeerTranslations",(async(t,e,a)=>{const{chatId:s,isEnabled:d}=a,o=(0,v.hds)(t,s);o&&void 0!==await(0,m.px)("togglePeerTranslations",{chat:o,isEnabled:d})&&(t=(0,b.mS)(),t=(0,V.zT)(t,s,{isTranslationDisabled:!d||void 0}),(0,b.UF)(t))})),(0,b.aJ)("setViewForumAsMessages",((t,e,a)=>{const{chatId:s,isEnabled:d}=a,o=(0,v.hds)(t,s);o?.isForum&&o.isForumAsMessages!==d&&(t=(0,V.wi)(t,s,{isForumAsMessages:d||void 0}),(0,b.UF)(t),(0,m.px)("setViewForumAsMessages",{chat:o,isEnabled:d}))})),(0,b.aJ)("loadChannelRecommendations",(async(t,e,a)=>{const{chatId:s}=a,d=s?(0,v.hds)(t,s):void 0;if(s&&!d)return;if(!s&&(0,v.dg4)(t,o.rBM))return;const i=await(0,m.px)("fetchChannelRecommendations",{chat:d});if(!i)return;const{similarChannels:n,count:r}=i,c=(0,h.dU)(n,"id");t=(0,b.mS)(),t=(0,V.Nl)(t,c),t=(0,V.NO)(t,s||o.rBM,Object.keys(c),r),(0,b.UF)(t)})),(0,b.aJ)("toggleChannelRecommendations",((t,e,a)=>{const{chatId:s}=a;(0,v.hds)(t,s)&&(t=(0,V.Cb)(t,s),(0,b.UF)(t))})),(0,b.aJ)("resolveBusinessChatLink",(async(t,e,a)=>{const{slug:s,tabId:d=(0,c.g0)()}=a,o=await(0,m.px)("resolveBusinessChatLink",{slug:s});if(!o)return void e.showNotification({message:u.Tl("BusinessLink.ErrorExpired"),tabId:d});const{users:i,chats:n,chatLink:r}=o;t=(0,b.mS)(),t=(0,V.g1)(t,(0,h.dU)(i,"id")),t=(0,V.Nl)(t,(0,h.dU)(n,"id")),(0,b.UF)(t),e.openChatWithDraft({chatId:r.chatId,text:r.text,tabId:d})})),(0,b.aJ)("requestCollectibleInfo",(async(t,e,a)=>{const{type:s,collectible:d,peerId:o,tabId:n=(0,c.g0)()}=a;let r;if("phone"===s&&(r={phone:d}),"username"===s&&(r={username:d}),!r)return;const l=await(0,m.px)("fetchCollectionInfo",r);l?(t=(0,b.mS)(),t=(0,w.w)(t,{collectibleInfoModal:{...l,type:s,collectible:d,peerId:o}},n),(0,b.UF)(t)):(0,i.eM)(d)}))},12859:(t,e,a)=>{a.d(e,{Hc:()=>M,JD:()=>F,cw:()=>y,ow:()=>x,re:()=>P,sN:()=>T});var s=a(66644),d=a(85982),o=a(14487),i=a(87894),n=a(65934),r=a(41733),c=a(82393),l=a(4875),h=a(59589),u=a(13439),p=a(99881),I=a(80840),g=a(32989),m=a(67321),f=a(71331),b=a(42347);const V="data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";let C,w,v;function y(){return F(),Promise.all(Object.values(v).map((t=>{const e=t.src;return t.src=V,t.muted=!0,t.volume=1e-4,t.play().then((()=>{t.pause(),t.volume=1,t.currentTime=0,t.muted=!1,(0,s.Uz)((()=>{t.src=e}))}))})))}function F(){if(v)return;const t=new Audio("./voicechat_join.mp3"),e=new Audio("./voicechat_connecting.mp3");e.loop=!0;const a=new Audio("./voicechat_leave.mp3"),s=new Audio("./voicechat_onallowtalk.mp3"),d=new Audio("./call_busy.mp3"),o=new Audio("./call_connect.mp3"),i=new Audio("./call_end.mp3"),n=new Audio("./call_incoming.mp3");n.loop=!0;const r=new Audio("./call_ringing.mp3");r.loop=!0,v={join:t,allowTalk:s,leave:a,connecting:e,incoming:n,end:i,connect:o,busy:d,ringing:r}}async function A(t,e){const a=await(0,l.px)("getGroupCall",{call:e});if(!a)return;t=(0,u.mS)();const s=(0,f.Ip)(t,e.id);return t=(0,I.h9)(t,e.id,(0,i.cJ)(a.groupCall,["connectionState"]),void 0,s?.isLoaded?void 0:a.groupCall.participantsCount),t=(0,p.g1)(t,(0,i.dU)(a.users,"id")),t=(0,p.Nl)(t,(0,i.dU)(a.chats,"id")),(0,u.UF)(t),a.groupCall}async function S(t,e,a){const s=await(0,l.px)("fetchGroupCallParticipants",{call:e,offset:a});s&&(t=(0,u.mS)(),t=(0,p.g1)(t,(0,i.dU)(s.users,"id")),t=(0,p.Nl)(t,(0,i.dU)(s.chats,"id")),(0,u.UF)(t))}(0,u.aJ)("toggleGroupCallPanel",((t,e,a)=>{const{force:s,tabId:d=(0,o.g0)()}=a||{};return(0,g.w)(t,{isCallPanelVisible:"force"in(a||{})?s:!(0,m.nTw)(t,d).isCallPanelVisible},d)})),(0,u.aJ)("subscribeToGroupCallUpdates",(async(t,e,a)=>{const{subscribed:s,id:d}=a,o=(0,f.Ip)(t,d);o&&(s&&(await A(t,o),t=(0,u.mS)(),await S(t,o)),await(0,l.px)("toggleGroupCallStartSubscription",{subscribed:s,call:o}))})),(0,u.aJ)("createGroupCall",(async(t,e,a)=>{const{chatId:s,tabId:d=(0,o.g0)()}=a,i=(0,m.hds)(t,s);if(!i)return;const n=await(0,l.px)("createGroupCall",{peer:i});n&&(t=(0,u.mS)(),t=(0,I.h9)(t,n.id,{...n,chatId:s}),(0,u.UF)(t),e.requestMasterAndJoinGroupCall({id:n.id,accessHash:n.accessHash,tabId:d}))})),(0,u.aJ)("createGroupCallInviteLink",(async(t,e,a)=>{const{tabId:s=(0,o.g0)()}=a||{},i=(0,f.iT)(t);if(!i||!i.chatId)return;const n=(0,m.hds)(t,i.chatId);if(!n)return;const r=Boolean((0,h.Kl)(n));let c=(0,m.AWZ)(t,n.id)?.inviteLink;r&&(c=await(0,l.px)("exportGroupCallInvite",{call:i,canSelfUnmute:!1})),c&&((0,d.eM)(c),e.showNotification({message:"Link copied to clipboard",tabId:s}))})),(0,u.aJ)("joinVoiceChatByLink",(async(t,e,a)=>{const{username:s,inviteHash:d,tabId:i=(0,o.g0)()}=a,r=await(0,b.A$)(t,s);if(!r)return void e.showNotification({message:n.Tl("NoUsernameFound"),tabId:i});t=(0,u.mS)();const c=await(0,b.ad)(t,e,r,i);c?.groupCall&&e.requestMasterAndJoinGroupCall({id:c.groupCall.id,accessHash:c.groupCall.accessHash,inviteHash:d,tabId:i})})),(0,u.aJ)("requestMasterAndJoinGroupCall",((t,e,a)=>{e.requestMasterAndCallAction({action:"joinGroupCall",payload:a,tabId:a.tabId||(0,o.g0)()})})),(0,u.aJ)("requestMasterAndAcceptCall",((t,e,a)=>{e.requestMasterAndCallAction({action:"acceptCall",payload:void 0,tabId:a?.tabId||(0,o.g0)()})})),(0,u.aJ)("joinGroupCall",(async(t,e,a)=>{const{chatId:s,id:d,accessHash:i,inviteHash:n,tabId:l=(0,o.g0)()}=a;if(!c.OL)return void e.showNotification({message:"Sorry, your browser doesn't support group calls",tabId:l});if(t.phoneCall)return void e.toggleGroupCallPanel({tabId:l});!function(){const t=new(window.AudioContext||window.webkitAudioContext);C=new Audio,w=t,C.srcObject=U(t),(0,r.A)(C)}(),F(),P(t=(0,u.mS)(),e,!0,l);const{groupCalls:{activeGroupCallId:h}}=t;let p=d?(0,f.Ip)(t,d):(0,f.mD)(t,s);if(p&&p.id===h)e.toggleGroupCallPanel({tabId:l});else if(h)"leaveGroupCall"in e&&e.leaveGroupCall({rejoin:a,tabId:l});else if(p&&h===p.id)e.toggleGroupCallPanel({tabId:l});else{if(p||d&&i||!s)!p&&d&&i&&(p=await A(t,{id:d,accessHash:i}));else{const a=(0,m.hds)(t,s);if(!a)return;await(0,b.ad)(t,e,a,l),t=(0,u.mS)(),p=(0,f.mD)(t,s)}p&&(t=(0,u.mS)(),t=(0,I.h9)(t,p.id,{...p,inviteHash:n},void 0,p.participantsCount+1),t={...t,groupCalls:{...t.groupCalls,activeGroupCallId:p.id}},(0,u.UF)(t),e.toggleGroupCallPanel({force:!1,tabId:l}))}})),(0,u.aJ)("playGroupCallSound",((t,e,a)=>{const{sound:s}=a;v[s]&&("connecting"!==s&&v.connecting.pause(),"incoming"!==s&&v.incoming.pause(),"ringing"!==s&&v.ringing.pause(),(0,r.A)(v[s]))})),(0,u.aJ)("loadMoreGroupCallParticipants",(t=>{const e=(0,f.iT)(t);e&&S(t,e,e.nextOffset)})),(0,u.aJ)("requestMasterAndRequestCall",((t,e,a)=>{e.requestMasterAndCallAction({action:"requestCall",payload:a,tabId:a.tabId||(0,o.g0)()})})),(0,u.aJ)("requestCall",((t,e,a)=>{const{userId:s,isVideo:d,tabId:i=(0,o.g0)()}=a;t.phoneCall?e.toggleGroupCallPanel({tabId:i}):(0,m.mBe)(t,s)&&(F(),P(t=(0,u.mS)(),e,d,i),t=(0,u.mS)(),t={...t,phoneCall:{id:"",state:"requesting",participantId:s,isVideo:d,adminId:t.currentUserId}},(0,u.UF)(t),e.toggleGroupCallPanel({force:!1,tabId:i}))}));const U=t=>{const e=t.createOscillator(),a=e.connect(t.createMediaStreamDestination());return e.start(),new MediaStream([Object.assign(a.stream.getAudioTracks()[0],{enabled:!1})])};function T(){return C}function M(){return w}function x(){C?.pause(),w=void 0,C=void 0}function P(t,e,a){for(var s=arguments.length,d=new Array(s>3?s-3:0),i=3;i<s;i++)d[i-3]=arguments[i];let[r=(0,o.g0)()]=d;a?navigator.mediaDevices.getUserMedia({video:!0}).then((a=>{0===a.getVideoTracks().length?e.showNotification({message:n.Tl("Call.Camera.Error"),tabId:r}):(a.getTracks().forEach((t=>t.stop())),J(t,e,r))})).catch((()=>{e.showNotification({message:n.Tl("Call.Camera.Error"),tabId:r})})):J(t,e,r)}function J(t,e){for(var a=arguments.length,s=new Array(a>2?a-2:0),d=2;d<a;d++)s[d-2]=arguments[d];let[i=(0,o.g0)()]=s;navigator.mediaDevices.getUserMedia({audio:!0}).then((t=>{0===t.getAudioTracks().length?e.showNotification({message:n.Tl("RequestAcces.Error.HaveNotAccess.Call"),tabId:i}):t.getTracks().forEach((t=>t.stop()))})).catch((()=>{e.showNotification({message:n.Tl("RequestAcces.Error.HaveNotAccess.Call"),tabId:i})}))}},80840:(t,e,a)=>{a.d(e,{R6:()=>c,c5:()=>l,h9:()=>n,um:()=>r});var s=a(87894),d=a(67321),o=a(71331),i=a(16350);function n(t,e,a,d,o){const i=Object.values({...t.groupCalls.byId[e]?.participants,...a.participants}).filter((t=>{let{isLeft:e}=t;return!e})).reduce(((t,e)=>(t[e.id]=e,t)),{});return{...t,groupCalls:{...t.groupCalls,byId:{...t.groupCalls.byId,[e]:{...t.groupCalls.byId[e],...(0,s.cJ)(a,["participantsCount"]),...d&&{participantsCount:t.groupCalls.byId[e].participantsCount+d},...void 0!==o&&{participantsCount:o},participants:i}}}}}function r(t,e){const a=(0,o.Ip)(t,e);return a&&a.chatId&&(0,d.hds)(t,a.chatId)&&(t=(0,i.lt)(t,a.chatId,{groupCallId:void 0})),{...t,groupCalls:{...t.groupCalls,byId:{...(0,s.cJ)(t.groupCalls.byId,[e.toString()])}}}}function c(t,e,a){return t.groupCalls.activeGroupCallId?n(t,t.groupCalls.activeGroupCallId,e,void 0,a):t}function l(t,e,a,s){let d=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=(0,o.Ip)(t,e);return i?n(t,e,{participants:{...i.participants,[a]:{...i.participants[a],...s}}},s.isLeft?d?0:-1:i.participants[a]||d?0:1):t}}}]);
//# sourceMappingURL=2859.99458396edb430d2e5ed.js.map