"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[6930],{25404:(e,t,i)=>{i.d(t,{A:()=>p});var a=i(84051),r=i(13439),n=i(31481),o=i(85982),s=i(17663),l=i(80140),c=i(39351),d=i(17712),u=i(59030),m=i(24433),f=i(20021);const p=(0,a.ph)(({peerId:e,canManage:t,gift:i,currentUserEmojiStatus:p,collectibleEmojiStatuses:h})=>{const{showNotification:g,openChatWithDraft:A,openGiftTransferModal:b,openGiftResalePriceComposerModal:S,openGiftStatusInfoModal:v,setEmojiStatus:N,toggleSavedGiftPinned:y,changeGiftVisibility:C,updateStarGiftPrice:G,closeGiftInfoModal:I}=(0,r.ko)(),k=(0,c.A)(),Y=(0,u.A)(),P=i&&"gift"in i,B=P?i:void 0,w=P?i.gift:i,T="starGiftUnique"===w?.type?w.slug:void 0,D=(0,a.Kr)(()=>{if(T)return`${n.jsp}nft/${T}`},[T]),M=(0,a.Kr)(()=>{if(T)return h?.find(e=>"collectible"===e.type&&e.slug===T)},[T,h]),F="collectible"===p?.type?p.slug:void 0,U=w&&"starGiftUnique"===w.type,R=U&&F===w.slug,x=M&&!R,O=U?w.resellPrice:void 0,L=t&&B&&!B.isUnsaved&&U,K=(0,d.A)(()=>{const{inputGift:e,isUnsaved:t}=B;C({gift:e,shouldUnsave:!t})}),q=(0,d.A)(()=>{D&&((0,o.eM)(D),g({message:k("LinkCopied")}))}),V=(0,d.A)(()=>{D&&A({text:{text:D}})}),E=(0,d.A)(()=>{B&&"starGiftUnique"===B?.gift.type&&(B.canTransferAt&&B.canTransferAt>(0,l.Fm)()?g({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,s.U)(Y,1e3*B.canTransferAt)}}}):b({gift:B}))}),H=(0,d.A)(()=>{B&&(B.canResellAt&&B.canResellAt>(0,l.Fm)()?g({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,s.U)(Y,1e3*B.canResellAt)}}}):S({peerId:e,gift:B}))}),z=(0,d.A)(()=>{B&&"starGiftUnique"===B.gift.type&&B.inputGift&&(I(),G({gift:B.inputGift,price:{currency:n.OUy,amount:0,nanos:0}}),g({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:k("GiftUnique",{title:B.gift.title,number:B.gift.number})}}}))}),W=(0,d.A)(()=>{"starGiftUnique"===w?.type&&M&&v({emojiStatus:M})}),J=(0,d.A)(()=>{R&&N({emojiStatus:{type:"regular",documentId:n.zNY}})}),j=(0,d.A)(()=>{y({peerId:e,gift:B})});return(0,f.FD)(f.FK,{children:[L&&(0,f.Y)(m.A,{icon:B.isPinned?"unpin":"pin",onClick:j,children:k(B.isPinned?"ChatListUnpinFromTop":"ChatListPinToTop")}),(0,f.Y)(m.A,{icon:"link-badge",onClick:q,children:k("CopyLink")}),(0,f.Y)(m.A,{icon:"forward",onClick:V,children:k("Share")}),t&&U&&(0,f.Y)(m.A,{icon:"diamond",onClick:E,children:k("GiftInfoTransfer")}),t&&U&&!O&&(0,f.Y)(m.A,{icon:"sell-outline",onClick:H,children:k("Sell")}),t&&U&&Boolean(O)&&(0,f.Y)(m.A,{icon:"unlist-outline",onClick:z,children:k("GiftInfoUnlist")}),t&&B&&(0,f.Y)(m.A,{icon:B.isUnsaved?"eye-outline":"eye-crossed-outline",onClick:K,children:k(B.isUnsaved?"GiftActionShow":"GiftActionHide")}),x&&(0,f.Y)(m.A,{icon:"crown-wear-outline",onClick:W,children:k("GiftInfoWear")}),R&&(0,f.Y)(m.A,{icon:"crown-take-off-outline",onClick:J,children:k("GiftInfoTakeOff")})]})})},88470:(e,t,i)=>{i.r(t),i.d(t,{ChatRefundModal:()=>Li,GiftDescriptionRemoveModal:()=>Oi,GiftInfoModal:()=>ri,GiftInfoValueModal:()=>oi,GiftLockedModal:()=>si,GiftModal:()=>Wt,GiftRecipientPicker:()=>Jt,GiftResalePriceComposerModal:()=>ci,GiftStatusInfoModal:()=>Si,GiftTransferConfirmModal:()=>xi,GiftTransferModal:()=>Ri,GiftUpgradeModal:()=>hi,GiftWithdrawModal:()=>Ii,PaidReactionModal:()=>nt,PriceConfirmModal:()=>qi,StarGiftPriceDecreaseInfoModal:()=>gi,StarPaymentModal:()=>be,StarsBalanceModal:()=>fe,StarsGiftModal:()=>N,StarsGiftingPickerModal:()=>P,StarsSubscriptionModal:()=>qe,StarsTransactionInfoModal:()=>Oe});var a=i(84051),r=i(13439),n=i(70636),o=i(91048),s=i(87357),l=i(17142),c=i(4961),d=i(14),u=i(17712),m=i(59030),f=i(21849),p=i(84685),h=i(22337),g=i(1526);const A={modalDialog:"MFXAwnxJ",content:"Sl6xVf1R",main:"bTN9Jeph",headerInfo:"c6MiyJgW",logo:"StGLWvzb",logoBackground:"SyTXSfml",description:"kFe3mIZo",section:"BgfHkWd2",header:"zMtAGfXs",starHeaderText:"q3v8orGj",hiddenHeader:"bq3FnXT0",closeButton:"bDsDTkbe",avatar:"jK36xUj4",center:"v1PckUQn",secondaryInfo:"TDWSRfP9"},b=i.p+"GoldStar.fb6812e915ddfe27f504.svg",S=i.p+"stars-bg.dee4c4b73c7d21c2ec73.png";var v=i(20021);const N=(0,a.ph)((0,r.EK)((e,{modal:t})=>({user:t?.forUserId?(0,o.mBe)(e,t.forUserId):void 0}))(({modal:e,user:t})=>{const{closeStarsGiftModal:i,openInvoice:o,requestConfetti:N}=(0,r.ko)(),y=(0,a.li)(),C=Boolean(e?.isOpen),G=(0,d.A)(e),I=(0,m.A)(),[k,Y]=(0,a.J0)(),[P,B]=(0,a.J0)(!0);(0,a.vJ)(()=>{C||B(!0)},[C]);const w=(0,u.A)(()=>{const e=y.current;if(e&&C){const{top:t,left:i,width:a,height:r}=e.querySelector(".modal-content").getBoundingClientRect();N({top:t,left:i,width:a,height:r,withStars:!0})}});(0,a.vJ)(()=>{G?.isCompleted&&w()},[G,w]);const T=(0,u.A)(e=>{G&&(Y(e),o(t?{type:"starsgift",userId:t.id,stars:e.stars,currency:e.currency,amount:e.amount}:{type:"stars",stars:e.stars,currency:e.currency,amount:e.amount}))}),D=(0,u.A)(()=>{i()}),M=(0,a.Kr)(()=>{const e=I("lng_credits_summary_options_about").split("{link}");return[e[0],(0,v.Y)(p.A,{url:I("StarsTOSLink"),text:I("lng_credits_summary_options_about_link")}),e[1]]},[I]);return(0,v.Y)(h.A,{className:(0,s.A)(A.modalDialog),contentClassName:A.content,dialogRef:y,isSlim:!0,onClose:D,isOpen:C,hasAbsoluteCloseButton:!0,children:(0,v.FD)("div",{className:(0,s.A)(A.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;B(t<=150)},children:[(0,v.Y)("div",{className:(0,s.A)(A.header,P&&A.hiddenHeader),children:(0,v.Y)("h2",{className:A.starHeaderText,children:I(t?"GiftStarsTitle":"Star.List.GetStars")})}),(0,v.Y)("div",{className:A.headerInfo,children:t?(0,v.FD)(v.FK,{children:[(0,v.Y)(f.A,{size:100,peer:t,className:A.avatar}),(0,v.Y)("img",{className:A.logoBackground,src:S,alt:"",draggable:!1})]}):(0,v.FD)(v.FK,{children:[(0,v.Y)("img",{className:A.logo,src:b,alt:"",draggable:!1}),(0,v.Y)("img",{className:A.logoBackground,src:S,alt:"",draggable:!1})]})}),(0,v.Y)("h2",{className:(0,s.A)(A.headerText,A.center),children:G?.isCompleted?t?(0,c.A)(I("Notification.StarsGift.SentYou",(0,l.Ad)(k.amount,k.currency,I.code)),["simple_markdown"]):(0,c.A)(I("StarsAcquiredInfo",k?.stars),["simple_markdown"]):I(t?"GiftStarsTitle":"Star.List.GetStars")}),(0,v.Y)("p",{className:A.description,children:t?(0,c.A)(I("ActionGiftStarsSubtitle",(0,n.F9)(I,t)),["simple_markdown"]):I("Stars.Purchase.GetStarsInfo")}),(0,v.FD)("div",{className:A.section,children:[(0,v.Y)(g.A,{options:G?.starsGiftOptions,onClick:T}),(0,v.Y)("div",{className:A.secondaryInfo,children:M})]})]})})}));var y=i(31481),C=i(90709),G=i(87894),I=i(79582),k=i(54960),Y=i(34642);const P=(0,a.ph)((0,r.EK)(e=>{const{chats:{listIds:t},currentUserId:i}=e;return{userIds:e.contactList?.userIds,activeListIds:t.active,archivedListIds:t.archived,currentUserId:i}})(({isOpen:e,currentUserId:t,activeListIds:i,archivedListIds:o,userIds:s})=>{const{closeStarsGiftingPickerModal:l,openStarsGiftModal:c}=(0,r.ko)(),d=(0,m.A)(),[f,p]=(0,a.J0)(""),h=(0,a.Kr)(()=>{const e=(0,r.mS)().users.byId,a=(0,G.Am)([...s||[],...i||[],...o||[]]),l=(0,n.PU)({ids:a,query:f,type:"user"});return(0,I.A)(l.filter(i=>{const a=e[i];return!(!a||a.isSupport||(0,C.tv)(a)||(0,C.PL)(a)||i===t||i===y.zv8)}))},[t,f,s,i,o]),g=(0,u.A)(e=>{e?.length&&(c({forUserId:e}),l())});return(0,v.Y)(Y.A,{className:"s3k01dTm",isOpen:e,onClose:l,title:d("GiftStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Continue"),onEnter:l,children:(0,v.Y)(k.A,{className:"cuI2eDIY",itemIds:h,filterValue:f,filterPlaceholder:d("Search"),onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,onSelectedIdChange:g})})}));var B=i(30708),w=i(31460),T=i(76023),D=i(37661),M=i(39351),F=i(18276),U=i(64493),R=i(46222),x=i(24680),O=i(41036),L=i(38777),K=i(86046),q=i(81949),V=i(9267);const E={root:"TtE8LQNJ",minimal:"nkV4JXHc",transition:"nXQS4E59",main:"JuWZY1ds",container:"mnhBs1uK",section:"lYkNd_gb",lastSection:"f749AI4g",sectionTitle:"FF8gm7MP",tos:"Vu6blJk9",hint:"Rs8WXoOz",topUpButton:"dc_DZoVF",tonBalanceContainer:"lorbW9II",tonBalance:"h2Fs3tOv",tonIconBalance:"Ut6GidJP",tonInUsd:"FdcdsB4l",tonIconLogo:"_hCjjyEv",description:"teXilLxe",header:"fnhXotO2",starHeaderText:"iUwego5s",botItem:"AhxcrKWn",hiddenHeader:"DZk6d6hF",noSeparator:"UwUaTrab",closeButton:"piD1PXHW",addStarsButton:"dqnGL2uh",addStarsIcon:"w9Db2eiK",balanceBlock:"Yk0OQBKC",balanceInfo:"p2dW9NOV",smallerText:"rUnPcfmE",balanceBottom:"F5BTkZ9G",modalBalance:"t8tMrx3y",starButton:"oOt4VBD2",paymentContent:"OReEUNTV",paymentImages:"oKorQYTC",paymentPhoto:"HGTrEtUF",avatarStar:"Wu10dXoa",paymentImageBackground:"os8jb_qv",paymentButton:"VzR5cibf",paymentButtonStar:"Uhg7yWxK",transactions:"Qvc0fTTH",subscriptions:"IX5BhCUF",tabs:"KZVEyKOX",disclaimer:"bpVifdwH",amountBadge:"BPM7LKwo",loadMore:"TKmZjMyd",loadMoreIcon:"buepwtN1"},H=(0,a.ph)(({balance:e,className:t,withAddButton:i})=>{const a=(0,M.A)(),{openStarsBalanceModal:n}=(0,r.ko)();return(0,v.Y)("div",{className:(0,s.A)(E.balanceBlock,t),children:(0,v.FD)("div",{className:E.balanceInfo,children:[(0,v.Y)("span",{className:E.smallerText,children:a("StarsBalance")}),(0,v.Y)("div",{className:E.balanceBottom,children:e?.currency===y.ykW?(0,v.FD)(v.FK,{children:[(0,v.Y)(F.A,{name:"toncoin"}),void 0!==e?(0,l.UL)(e.amount,e.currency):"…"]}):(0,v.FD)(v.FK,{children:[(0,v.Y)(V.A,{type:"gold",size:"middle"}),void 0!==e&&e.currency===y.OUy?(0,K.ZF)(a,e):"…",i&&(0,v.Y)(q.A,{className:E.addStarsButton,onClick:()=>n({}),children:(0,v.Y)(F.A,{className:E.addStarsIcon,name:"add"})})]})})]})})});var z=i(17663),W=i(14242),J=i(63527);const j={root:"ZXnbeQxP",info:"zLaaDX3c",status:"HbF2qTB2",statusPricing:"AveGvpdV",amount:"_CBiOQcv",title:"k9ZIv5Pd",description:"FlRlxMx2",subtitle:"YN2J8dw6",statusPeriod:"MRrP7Oew",statusEnded:"pRHwfr8m",preview:"t6Syyhzd",subscriptionStar:"ftlbevPm"},_=(0,a.ph)(({subscription:e})=>{const{openStarsSubscriptionModal:t}=(0,r.ko)(),{peerId:i,pricing:a,until:s,isCancelled:l,title:d,photo:p}=e,h=(0,m.A)(),g=(0,J.A)(function(e){return t=>(0,o.PVB)(t,e)}(i)),A=(0,u.A)(()=>{t({subscription:e})});if(!g)return;const b=s<Date.now()/1e3,S=(0,z.A)(1e3*s,h.code,!0,"long");return(0,v.FD)("div",{className:j.root,onClick:A,children:[(0,v.FD)("div",{className:j.preview,children:[(0,v.Y)(f.A,{size:"medium",peer:g}),(0,v.Y)(V.A,{className:j.subscriptionStar,type:"gold",size:"small"})]}),(0,v.FD)("div",{className:j.info,children:[(0,v.Y)("h3",{className:j.title,children:(0,c.A)((0,n.F9)(h,g)||"")}),d&&(0,v.FD)("p",{className:j.subtitle,children:[p&&(0,v.Y)(f.A,{webPhoto:p,size:"micro"}),(0,c.A)(d)]}),(0,v.Y)("p",{className:j.description,children:h(b?"StarsSubscriptionExpired":l?"StarsSubscriptionExpires":"StarsSubscriptionRenews",S)})]}),(0,v.Y)("div",{className:j.status,children:l||b?(0,v.Y)("div",{className:j.statusEnded,children:h(b?"StarsSubscriptionStatusExpired":"StarsSubscriptionStatusCancelled")}):(0,v.FD)(v.FK,{children:[(0,v.FD)("div",{className:j.statusPricing,children:[(0,v.Y)(V.A,{className:j.star,type:"gold",size:"adaptive"}),(0,v.Y)("span",{className:j.amount,children:(0,W.Sm)(a.amount)})]}),(0,v.Y)("div",{className:j.statusPeriod,children:h("StarsParticipantSubscriptionPerMonth")})]})})]})});var Q=i(58968),X=i(66833);function $(e,t,i){if(i.paidMessages)return t("PaidMessageTransaction",{count:i.paidMessages},{withNodes:!0,pluralValue:i.paidMessages});if(i.isGiftResale)return Z(i.amount)?t("StarGiftSaleTransaction"):t("StarGiftPurchaseTransaction");if(i.isPostsSearch)return t("PostsSearchTransaction");if(i.isDropOriginalDetails)return t("DropOriginalDetailsTransaction");if(i.isPrepaidUpgrade)return t("GiftPrepaidUpgradeTransactionTitle");if(i.starRefCommision)return e("StarTransactionCommission",(0,W.l9)(i.starRefCommision));if(i.isGiftUpgrade)return e("Gift2TransactionUpgraded");if(i.extendedMedia)return e("StarMediaPurchase");if(i.subscriptionPeriod)return i.title||e("StarSubscriptionPurchase");if(i.isReaction)return e("StarsReactionsSent");if(i.giveawayPostId)return e("StarsGiveawayPrizeReceived");if(i.isMyGift)return e("StarsGiftSent");if(i.isGift)return i.amount.currency===y.ykW?t("TonGiftReceived"):e("StarsGiftReceived");if(i.starGift)return Z(i.amount)?e("Gift2TransactionSent"):e("Gift2ConvertedTitle");const a=i.peer&&(0,K.MA)(i)&&(0,K.Pc)(i)||void 0;return a?a.title||e(a.titleKey):i.title}function Z(e){return e.currency===y.OUy?e.amount?e.amount<0:e.nanos<0:e.amount<0}var ee=i(79577),te=i(40558),ie=i(62587),ae=i(27860);const re={root:"jQkp75Gb",preview:"OYGSN3PF",count:"KX1yz2Jy",thumb:"EvinKr5k",noOutline:"KSAAsUDv",itemCount1:"GxDajfX_",itemCount2:"jXuZoxq8",itemCount3:"TPn3XGHJ",blurry:"hWZuxLS8",full:"w56QPFhl",fadeIn:"ds43W8Wq"};function ne({boughtMedia:e,index:t,className:i}){const a=e.video||e.photo,r=(0,C.VO)(a,"pictogram"),n=(0,C.VD)(a),o=(0,ie.A)(r);return(0,v.FD)("div",{className:(0,s.A)(re.thumb,void 0!==t&&`stars-transaction-media-${t}`,i),children:[n&&(0,v.Y)("img",{className:re.blurry,src:n,alt:""}),o&&(0,v.Y)("img",{className:re.full,src:o,alt:""})]})}const oe=(0,a.ph)(({media:e,className:t,isTransactionPreview:i,onClick:a})=>{const r=Math.min(e.length,i?2:3),n="mediaType"in e[0];return(0,v.FD)("div",{className:(0,s.A)(re.root,re[`itemCount${r}`],i&&re.preview,t),dir:"rtl",onClick:a,children:[e.slice(0,r).reverse().map((e,t,a)=>{const r=a.length-t-1;return"mediaType"in e?(0,v.Y)(ae.A,{className:re.thumb,isVisible:!0,width:e.width,height:e.height,thumbDataUri:e.thumbnail?.dataUri}):(0,v.Y)(ne,{className:(0,s.A)(i&&r>0&&re.noOutline),boughtMedia:e,index:r})}),n&&(0,v.FD)("div",{className:re.count,children:[(0,v.Y)(F.A,{name:"stars-lock"}),e.length>1?e.length:""]})]})}),se={root:"aHAxv_Jg",info:"oyYrn3II",stars:"K5lc75ku",amount:"QLQPuLAr",title:"e0pK8CJ_",description:"xbERdDMQ",date:"l6CwQ0Ev",positive:"P_42_ZWR",negative:"TGjnLJfH",preview:"cnjGihOT",subscriptionStar:"z43YvnDX",uniqueGiftBackground:"eNvzMw2p",giftSticker:"U3dqmnM4"},le=(0,a.ph)(({transaction:e,className:t})=>{const{openStarsTransactionModal:i}=(0,r.ko)(),{date:l,amount:d,photo:p,peer:h,extendedMedia:g,subscriptionPeriod:A}=e,b=(0,M.A)(),S=(0,m.A)(),N="peer"===h.type?h.id:void 0,C=(0,J.A)(function(e){return t=>e?(0,o.PVB)(t,e):void 0}(N)),G=e.starGift,I="starGiftUnique"===G?.type,k=G&&(0,X.yQ)(G),Y=(0,a.Kr)(()=>{let t,i,a,r=$(S,b,e);if((0,K.MA)(e)){const i=(0,K.Pc)(e);r=i.title||S(i.titleKey),t=S(i.subtitleKey),a=i}else t=C&&(0,n.F9)(S,C),a=C||Q.lw;return(e.isGiftUpgrade||e.isDropOriginalDetails)&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isGiftResale&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isPostsSearch&&(r=$(S,b,e),t=void 0),e.photo&&(a=void 0),e.isRefund&&(i=S("StarsRefunded")),e.hasFailed&&(i=S("StarsFailed")),e.isPending&&(i=S("StarsPending")),{title:r,description:t,avatarPeer:a,status:i}},[S,b,C,e]),P=(0,a.Kr)(()=>{if(I){const{backdrop:e}=(0,X.uc)(G),t=[e.centerColor,e.edgeColor];return(0,v.FD)(v.FK,{children:[(0,v.Y)(te.A,{className:se.uniqueGiftBackground,backgroundColors:t}),(0,v.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1})]})}return k?(0,v.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1}):g?(0,v.Y)(oe,{media:g,isTransactionPreview:!0}):(0,v.FD)(v.FK,{children:[(0,v.Y)(f.A,{size:"medium",webPhoto:p,peer:Y.avatarPeer}),Boolean(A)&&(0,v.Y)(V.A,{className:se.subscriptionStar,type:"gold",size:"small"})]})},[I,g,p,Y.avatarPeer,A,G,k]),B=(0,u.A)(()=>{i({transaction:e})}),w=Z(d)?se.negative:se.positive;return(0,v.FD)("div",{className:(0,s.A)(se.root,t),onClick:B,children:[(0,v.Y)("div",{className:se.preview,children:P}),(0,v.FD)("div",{className:se.info,children:[(0,v.Y)("h3",{className:se.title,children:Y.title}),Y.description&&(0,v.Y)("p",{className:se.description,children:(0,c.A)(Y.description)}),(0,v.FD)("p",{className:se.date,children:[(0,z.L2)(1e3*l,S.code,!0),Y.status&&` — (${Y.status})`]})]}),(0,v.FD)("div",{className:se.stars,children:[(0,v.Y)("span",{className:(0,s.A)(se.amount,w),children:(0,K.hk)(b,d)}),d.currency===y.OUy&&(0,v.Y)(V.A,{className:se.star,type:"gold",size:"adaptive"}),d.currency===y.ykW&&(0,v.Y)(F.A,{name:"toncoin",className:w})]})]})}),ce=3.5*T.$,de=["all","inbound","outbound"],ue=["StarsTransactionsAll","StarsTransactionsIncoming","StarsTransactionsOutgoing"],me="StarsTransactionItem",fe=(0,a.ph)((0,r.EK)((e,{modal:t})=>({shouldForceHeight:t?.currency===y.ykW?Boolean(e.ton?.history?.all?.transactions.length):Boolean(e.stars?.history?.all?.transactions.length),starsBalanceState:e.stars,tonBalanceState:e.ton,canBuyPremium:!(0,o.n_C)(e),tonUsdRate:e.appConfig.tonUsdRate,tonTopupUrl:e.appConfig.tonTopupUrl,animationLevel:(0,B.lS)(e).animationLevel}))(({modal:e,starsBalanceState:t,tonBalanceState:i,canBuyPremium:d,shouldForceHeight:f,tonUsdRate:A,tonTopupUrl:b,animationLevel:S})=>{const{closeStarsBalanceModal:N,loadStarsTransactions:G,loadStarsSubscriptions:I,openStarsGiftingPickerModal:k,openInvoice:Y,openUrl:P}=(0,r.ko)(),B=e?.currency||y.OUy,T=B===y.ykW?i:t,{balance:K,history:q}=T||{},{subscriptions:V}=B===y.OUy&&t||{},z=(0,m.A)(),W=(0,M.A)(),[J,j]=(0,a.J0)(!0),[Q,X,$]=(0,D.A)(!1),[Z,ee]=(0,a.J0)(0),[te,ie,ae]=(0,D.A)(),re=(0,a.li)(),ne=Boolean(e&&(t||i)),{originStarsPayment:oe,originReaction:se,originGift:fe,topup:pe}=e||{},he=oe||se||fe||pe,ge=oe?.form?.invoice?.totalAmount||oe?.subscriptionInfo?.subscriptionPricing?.amount||se?.amount||fe?.gift.stars||pe?.balanceNeeded,Ae=ge?ge-(K?.amount||0):void 0,be=(0,a.Kr)(()=>{const e=(0,r.mS)();if(se){const t=(0,o.hds)(e,se.chatId);if(!t)return;return z("StarsNeededTextReactions",(0,C.Js)(z,t))}if(oe){const t=oe.form?.botId?(0,o.mBe)(e,oe.form.botId):void 0;if(!t)return;return z("StarsNeededText",(0,C.Yg)(t))}if(fe){const t=(0,o.mBe)(e,fe.peerId);if(!t)return;return z("StarsNeededTextGift",(0,n.F9)(W,t))}return"subs"===pe?.purpose?z("StarsNeededTextLink"):pe?.purpose===y.D3m?W("StarsNeededTextSendPaidMessages",void 0,{withMarkdown:!0,withNodes:!0}):void 0},[se,oe,fe,pe?.purpose,W,z]),Se=Boolean(q?.all?.transactions.length&&!he),ve=!he,Ne=(0,a.Kr)(()=>{const e=q?.all?.transactions.length||0;return 1===e?"35.5rem":2===e?"39.25rem":3===e?"43rem":"45rem"},[q?.all?.transactions.length]),ye=(0,a.Kr)(()=>ue.map(e=>({title:W(e)})),[W]);(0,a.vJ)(()=>{ne||(j(!0),ee(0),ae(),$())},[ne]),(0,a.vJ)(()=>{he?ie():ae()},[he]);const Ce=(0,a.Kr)(()=>{if(!ne)return;const e=z("lng_credits_summary_options_about").split("{link}");return[e[0],(0,v.Y)(p.A,{url:z("StarsTOSLink"),text:z("lng_credits_summary_options_about_link")}),e[1]]},[ne,z]),Ge=(0,u.A)(()=>{G({type:de[Z],isTon:B===y.ykW})}),Ie=(0,u.A)(()=>{I()}),ke=(0,u.A)(()=>{k({})}),Ye=(0,u.A)(e=>{const t=oe?.inputInvoice;let i;switch(t?.type){case"message":i=t.chatId;break;case"slug":{const e=oe?.form;i=e?.botId;break}}se&&(i=se.chatId),Y({type:"stars",stars:e.stars,currency:e.currency,amount:e.amount,spendPurposePeerId:i})}),Pe=(0,u.A)(()=>{P({url:b})});return(0,v.Y)(h.A,{className:(0,s.A)(E.root,!f&&!te&&E.minimal),isOpen:ne,onClose:N,dialogStyle:`--modal-height: ${Ne}`,hasAbsoluteCloseButton:!0,children:(0,v.FD)("div",{className:(0,s.A)(E.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;if(j(t<=150),re.current){const{top:t}=re.current.getBoundingClientRect(),{top:i}=e.currentTarget.getBoundingClientRect();t-i<=ce?X():$()}},children:[B!==y.ykW&&(0,v.Y)(H,{balance:K,className:E.modalBalance}),(0,v.Y)("div",{className:(0,s.A)(E.header,J&&E.hiddenHeader,Q&&E.noSeparator),children:(0,v.Y)("h2",{className:E.starHeaderText,children:z("TelegramStars")})}),(0,v.Y)("div",{className:E.section,children:B===y.ykW?(()=>{const e=(0,l.UL)(K?.amount||0,y.ykW);return(0,v.FD)(v.FK,{children:[(0,v.Y)(L.A,{model:"speeding-diamond",color:"blue",title:W("CurrencyTon"),description:W("DescriptionAboutTon"),isDisabled:!ne}),(0,v.FD)("div",{className:E.tonBalanceContainer,children:[(0,v.FD)("div",{className:E.tonBalance,children:[(0,v.Y)(F.A,{name:"toncoin",className:E.tonIconBalance}),e]}),Boolean(A)&&(0,v.Y)("span",{className:E.tonInUsd,children:`≈ ${(0,l.Ad)((0,l.C)(K?.amount||0,A,!0),"USD",W.code)}`})]}),(0,v.Y)(U.A,{className:E.topUpButton,onClick:Pe,fluid:!0,children:W("ButtonTopUpViaFragment")}),B===y.ykW&&(0,v.Y)("div",{className:E.hint,children:W("TonModalHint")})]})})():(0,v.FD)(v.FK,{children:[(0,v.Y)(L.A,{model:"swaying-star",color:"gold",title:Ae?z("StarsNeededTitle",ge):z("TelegramStars"),description:(0,c.A)(be||z("TelegramStarsInfo"),["simple_markdown","emoji"]),isDisabled:!ne}),d&&!te&&(0,v.Y)(U.A,{className:E.starButton,onClick:ie,fluid:!0,children:z("Star.List.BuyMoreStars")}),d&&!te&&ve&&(0,v.Y)(U.A,{isText:!0,noForcedUpperCase:!0,className:E.starButton,fluid:!0,onClick:ke,children:z("TelegramStarsGift")}),te&&t?.topupOptions&&(0,v.Y)(g.A,{starsNeeded:Ae,options:t.topupOptions,onClick:Ye})]})}),te&&(0,v.Y)("div",{className:E.tos,children:Ce}),Se&&Boolean(V?.list.length)&&(0,v.FD)("div",{className:E.section,children:[(0,v.Y)("h3",{className:E.sectionTitle,children:z("StarMySubscriptions")}),(0,v.FD)("div",{className:E.subscriptions,children:[V?.list.map(e=>(0,v.Y)(_,{subscription:e},e.id)),V?.nextOffset&&(0,v.FD)(U.A,{isText:!0,disabled:V.isLoading,size:"smaller",noForcedUpperCase:!0,className:E.loadMore,onClick:Ie,children:[(0,v.Y)(F.A,{name:"down",className:E.loadMoreIcon}),z("StarMySubscriptionsExpand")]})]})]}),Se&&(0,v.FD)("div",{className:E.container,children:[(0,v.Y)("div",{className:E.lastSection,children:(0,v.Y)(O.Ay,{name:(0,w.P)("slideOptimized",S,void 0,W.isRtl),activeKey:Z,renderCount:ue.length,shouldRestoreHeight:!0,className:E.transition,children:(0,v.Y)(R.A,{onLoadMore:Ge,items:q?.[de[Z]]?.transactions,scrollContainerClosest:`.${E.main}`,itemSelector:`.${me}`,className:E.transactions,noFastList:!0,noScrollRestoreOnTop:!0,children:q?.[de[Z]]?.transactions.map(e=>(0,v.Y)(le,{transaction:e,className:me},`${e.id}-${e.isRefund}`))})})}),(0,v.Y)(x.A,{ref:re,className:E.tabs,tabClassName:E.tab,activeTab:Z,tabs:ye,onSwitchTab:ee})]})]})})}));var pe=i(48775),he=i(29886),ge=i(84991),Ae=i(10187);const be=(0,a.ph)((0,r.EK)((e,{modal:t})=>{const i=t?.form?.botId?(0,o.mBe)(e,t.form.botId):void 0,a="message"===t?.inputInvoice?.type?t.inputInvoice:void 0,r=a?(0,o.O5q)(e,a.chatId,a.messageId):void 0,n=a?(0,o.hds)(e,a.chatId):void 0,s=r?.content.paidMedia;return{bot:i,starsBalanceState:e.stars,paidMediaMessage:s?r:void 0,paidMediaChat:s?n:void 0}})(({modal:e,bot:t,starsBalanceState:i,paidMediaMessage:n,paidMediaChat:o})=>{const{closeStarsPaymentModal:l,openStarsBalanceModal:d,sendStarPaymentForm:g}=(0,r.ko)(),[A,b,N]=(0,D.A)(),y=Boolean(e?.inputInvoice&&i),G=(0,he.A)(e),I=e||G,{form:k,subscriptionInfo:Y}=I||{},P=k?.invoice?.totalAmount||Y?.subscriptionPricing?.amount,B=Boolean(k?.invoice.subscriptionPeriod),w=!Y?.subscriptionPricing,T=k?.photo,F=(0,m.A)(),R=(0,M.A)();(0,a.vJ)(()=>{y||N()},[y]);const x=(0,a.Kr)(()=>{if(!I?.inputInvoice)return"";const e=(0,C.Yg)(t),i=F("Stars.Intro.PurchasedText.Stars",P);if(n){const e=n.content.paidMedia.extendedMedia,t=e.every(e=>!e.duration),a=e.every(e=>Boolean(e.duration)),r=F(t?"Stars.Transfer.Photos":a?"Stars.Transfer.Videos":"Media",e.length),s=(0,C.Js)(F,o);return F("Stars.Transfer.UnlockInfo",[r,s,i])}return Y?R("StarsSubscribeText",{chat:Y.title,amount:P},{withNodes:!0,withMarkdown:!0,pluralValue:P}):B?R("StarsSubscribeBotText",{name:k.title,amount:P,bot:e},{pluralValue:P}):F("Stars.Transfer.Info",[k.title,e,i])},[I?.inputInvoice,t,F,P,n,Y,B,k,o,R]),O=(0,a.Kr)(()=>{if(Y)return R("StarsSubscribeInfo",{link:(0,v.Y)(p.A,{url:R("StarsSubscribeInfoLink"),text:R("StarsSubscribeInfoLinkText")})},{withNodes:!0})},[Y,R]),L=(0,a.Kr)(()=>{if(Y)return(0,C.nr)(Y)},[Y]),K=(0,u.A)(()=>{const t=i?.balance;void 0!==P&&void 0!==t&&(P>t.amount?d({originStarsPayment:e}):(g({}),b()))});return(0,v.FD)(h.A,{contentClassName:E.paymentContent,isOpen:y,hasAbsoluteCloseButton:!0,isSlim:!0,onClose:l,children:[(0,v.Y)(H,{balance:i?.balance,className:E.modalBalance}),(0,v.FD)("div",{className:E.paymentImages,dir:R.isRtl?"ltr":"rtl",children:[n?(0,v.Y)(oe,{media:n.content.paidMedia.extendedMedia}):L?(0,v.FD)(v.FK,{children:[(0,v.Y)(f.A,{className:E.paymentPhoto,peer:L,size:"giant"}),(0,v.Y)(V.A,{type:"gold",size:"adaptive",className:E.avatarStar})]}):(0,v.Y)(ge.A,{peer:T?void 0:t,avatarWebPhoto:T,avatarSize:"giant",badgeIcon:"star",badgeText:(0,W.Sm)(P),badgeClassName:E.amountBadge,className:E.paymentPhoto}),(0,v.Y)("img",{className:E.paymentImageBackground,src:S,alt:"",draggable:!1})]}),(0,v.Y)("h2",{className:E.headerText,children:F(L?"StarsSubscribeTitle":"StarsConfirmPurchaseTitle")}),w&&(0,v.Y)(Ae.A,{className:E.botItem,peerId:k?.botId}),(0,v.Y)("div",{className:E.description,children:(0,c.A)(x,["simple_markdown","emoji"])}),(0,v.Y)(U.A,{className:E.paymentButton,onClick:K,isLoading:A,children:R(B?"StarsSubscribeBotButtonMonth":"StarsPay",{amount:(0,pe.U2)(R,P,{asFont:!0})},{withNodes:!0})}),Boolean(O)&&(0,v.Y)("div",{className:(0,s.A)(E.disclaimer,E.smallerText),children:O})]})}));var Se=i(89925),ve=i(85982),Ne=i(97040),ye=i(70046),Ce=i(96454),Ge=i(95807),Ie=i(537),ke=i(43874),Ye=i(80140);const Pe="biAUzmLA",Be="hsDNs5hG",we="APNjRx1K",Te=(0,a.ph)((0,r.EK)(e=>{const{currentUserId:t}=e,i=t?(0,o.mBe)(e,t):void 0,a=i?.emojiStatus,r=e.collectibleEmojiStatuses?.statuses;return{currentUserEmojiStatus:a,collectibleEmojiStatuses:r}})(({savedGift:e,currentUserEmojiStatus:t,collectibleEmojiStatuses:i})=>{const{openGiftTransferModal:n,openGiftResalePriceComposerModal:s,openGiftStatusInfoModal:l,setEmojiStatus:c,updateStarGiftPrice:d,showNotification:f,closeGiftInfoModal:p}=(0,r.ko)(),h=(0,M.A)(),g=(0,m.A)(),A=e?.gift,b="starGiftUnique"===A?.type?A.resellPrice:void 0,S=(0,r.mS)(),N=(0,o.nTw)(S).giftInfoModal,C=N?.peerId,G="starGiftUnique"===A?.type?A.slug:void 0,I=(0,a.Kr)(()=>{if(G)return i?.find(e=>"collectible"===e.type&&e.slug===G)},[G,i]),k="collectible"===t?.type?t.slug:void 0,Y=void 0!==G&&k===G,P=Boolean(I)&&!Y,B=(0,u.A)(()=>{e&&"starGiftUnique"===e?.gift.type&&(e.canTransferAt&&e.canTransferAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,z.U)(g,1e3*e.canTransferAt)}}}):n({gift:e}))}),w=(0,u.A)(()=>{Y?c({emojiStatus:{type:"regular",documentId:y.zNY}}):I&&l({emojiStatus:I})}),T=(0,u.A)(()=>{e&&C&&(e.canResellAt&&e.canResellAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,z.U)(g,1e3*e.canResellAt)}}}):s({peerId:C,gift:e}))}),D=(0,u.A)(()=>{e&&"starGiftUnique"===e.gift.type&&e.inputGift&&(p(),d({gift:e.inputGift,price:{currency:y.OUy,amount:0,nanos:0}}),f({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:h("GiftUnique",{title:e.gift.title,number:e.gift.number})}}}))});return(0,v.FD)("div",{className:"feHNN0j8",children:[(0,v.Y)(U.A,{color:"transparentBlured",iconName:"gift-transfer-inline",iconAlignment:"top",iconClassName:we,onClick:B,ariaLabel:h("GiftInfoTransfer"),noForcedUpperCase:!0,fluid:!0,className:Pe,children:(0,v.Y)("span",{className:Be,children:h("GiftInfoTransfer")})}),(P||!Y)&&(0,v.Y)(U.A,{color:"transparentBlured",iconName:Y?"crown-take-off":"crown-wear",iconAlignment:"top",iconClassName:we,onClick:P||Y?w:void 0,disabled:!P&&!Y,ariaLabel:h(Y?"GiftInfoTakeOff":"GiftInfoWear"),noForcedUpperCase:!0,fluid:!0,className:Pe,children:(0,v.Y)("span",{className:Be,children:h(Y?"GiftInfoTakeOff":"GiftInfoWear")})}),!b&&(0,v.Y)(U.A,{color:"transparentBlured",iconName:"sell",iconAlignment:"top",iconClassName:we,onClick:T,ariaLabel:h("Sell"),noForcedUpperCase:!0,fluid:!0,className:Pe,children:(0,v.Y)("span",{className:Be,children:h("Sell")})}),Boolean(b)&&(0,v.Y)(U.A,{color:"transparentBlured",iconName:"unlist",iconAlignment:"top",iconClassName:we,onClick:D,ariaLabel:h("GiftInfoUnlist"),noForcedUpperCase:!0,fluid:!0,className:Pe,children:(0,v.Y)("span",{className:Be,children:h("GiftInfoUnlist")})})]})})),De={root:"irv1C8bo",withManageButtons:"QcTw5OSp",sticker:"a1ASgPwu",subtitleBadge:"V7kDVPLm",radialPattern:"UvhsGZLf",amount:"zTVWZg63",transition:"Tu6_OHoq",transitionSlide:"iUTKLzTN",title:"ECTvfOda",subtitle:"S6JwvHWD"},Me=(0,a.ph)(({modelAttribute:e,backdropAttribute:t,patternAttribute:i,title:n,subtitle:o,subtitlePeer:l,className:c,resellPrice:d,showManageButtons:u,savedGift:m})=>{const{openChat:f}=(0,r.ko)(),{isMobile:p}=(0,ke.Ay)(),h=(0,M.A)(),[g,A,b]=(0,D.A)(!1),S=(0,Ie.A)([e,t,i]),N=t?.textColor,y=(0,a.Kr)(()=>{const e=[t.centerColor,t.edgeColor];return(0,v.Y)(te.A,{className:De.radialPattern,canvasClassName:De.radialPatternCanvas,backgroundColors:e,patternIcon:i.sticker,yPosition:7.5*T.$,maxRadius:.26,patternSize:p?14:16,ovalFactor:1.2})},[t,i,p]);return(0,v.FD)("div",{className:(0,s.A)(De.root,"interactive-gift",u&&De.withManageButtons,c),children:[(0,v.FD)(O.Ay,{className:De.transition,slideClassName:(0,s.A)(De.transitionSlide),activeKey:S,direction:1,name:"zoomBounceSemiFade",children:[y,(0,v.Y)(ee.A,{className:De.sticker,sticker:e.sticker,size:120,noLoop:!g,onMouseEnter:Ce.TF?void 0:A,onMouseLeave:Ce.TF?void 0:b})]}),n&&(0,v.Y)("h1",{className:De.title,children:n}),Boolean(o)&&(0,v.Y)("div",{className:(0,s.A)(De.subtitle,l&&De.subtitleBadge),style:(0,Ge.A)(N&&`color: ${N}`),onClick:()=>{l&&f({id:l.id})},children:o}),m&&u&&(0,v.Y)(Te,{savedGift:m}),d&&(0,v.FD)("p",{className:De.amount,children:[(0,v.Y)("span",{children:(0,K.hk)(h,d)}),"XTR"===d.currency&&(0,v.Y)(V.A,{type:"gold",size:"middle"}),"TON"===d.currency&&(0,v.Y)(F.A,{name:"toncoin"})]})]})}),Fe="qBOIq6Jn",Ue="sso9uZM6",Re="NuWOY7ED",xe=[0,-50],Oe=(0,a.ph)((0,r.EK)((e,{modal:t})=>{const i="peer"===t?.transaction?.peer?.type&&t.transaction.peer.id,a=i?(0,o.PVB)(e,i):void 0,r=e.appConfig.starsPaidMessageCommissionPermille,n=t?.transaction.amount,s=t?.transaction.isGift?n?.currency===y.OUy?(0,o.WLj)(e,n?.amount):(0,o.OD9)(e,n?.amount):void 0;return{peer:a,canPlayAnimatedEmojis:(0,o.BWX)(e),topSticker:s,paidMessageCommission:r}})(({modal:e,peer:t,canPlayAnimatedEmojis:i,topSticker:n,paidMessageCommission:o})=>{const{showNotification:l,openMediaViewer:c,closeStarsTransactionModal:d}=(0,r.ko)(),h=(0,M.A)(),g=(0,m.A)(),{transaction:A}=e||{},b=(0,a.li)(),S=(0,u.A)(()=>{const e=A?.extendedMedia;e&&c({origin:Se.TQ.StarsTransaction,standaloneMedia:e.flatMap(e=>Object.values(e))})}),N=(0,u.A)(()=>{b.current?.()}),G=(0,u.A)(e=>{b.current=e}),I=(0,a.Kr)(()=>{if(!A)return;const{giveawayPostId:e,photo:a,amount:r,isGiftUpgrade:c,isDropOriginalDetails:d,starGift:u,isGiftResale:m,starRefCommision:b}=A,I=A?.starGift,k="starGiftUnique"===I?.type,Y=A?.starGift?(0,X.yQ)(A.starGift):n,P=k?(0,X.uc)(I):void 0,B=A.peer&&(0,K.MA)(A)&&(0,K.Pc)(A)||void 0,w="peer"===A.peer?.type?A.peer.id:void 0,T=A.peer&&g(function(e){switch(e.type){case"appStore":return"AppStore";case"playMarket":return"PlayMarket";case"fragment":return"Fragment";case"premiumBot":return"StarsTransactionBot";case"ads":return"StarsTransactionAds";case"api":return"Stars.Intro.Transaction.TelegramBotApi.Subtitle";default:return"Stars.Transaction.Unsupported.Title"}}(A.peer)),D=$(g,h,A),M=t&&A.messageId&&!c&&!d?(0,C.yt)(t,void 0,A.messageId):void 0,U=t&&e?(0,C.yt)(t,void 0,e):void 0,R=A.extendedMedia,x=R?.length||0,O=R?.every(e=>!e.video),L=R?.every(e=>!e.photo),q=g(O?"Stars.Transfer.Photos":L?"Stars.Transfer.Videos":"Media",x),E=A.description||((c||d)&&"starGiftUnique"===u?.type?u.title:void 0)||(R?q:void 0),H=!R&&!Y&&!A.isPostsSearch,J=a?void 0:!(0,K.MA)(A)&&t||B,j=k&&(0,v.Y)("div",{className:(0,s.A)(Fe,"ApoQz22o"),children:(0,v.Y)(Me,{backdropAttribute:P.backdrop,patternAttribute:P.pattern,modelAttribute:P.model,title:I.title,subtitle:h("GiftInfoCollectible",{number:I.number}),resellPrice:A.amount})}),_=Z(r)?"xDyq9cc0":"jvBZSrpd",Q=(0,v.FD)("div",{className:Fe,children:[R&&(0,v.Y)(oe,{className:(0,s.A)("C5r59yiV","transaction-media-preview"),media:R,onClick:S}),!R&&Y&&(0,v.Y)(ee.A,{sticker:Y,play:i,noLoop:!0},A.id),H&&(0,v.Y)(f.A,{className:"hcrszlpT",peer:J,webPhoto:a,size:"giant",onMouseMove:N}),!Y&&!A.isPostsSearch&&(0,v.Y)(Ne.A,{className:(0,s.A)("nML8IQqX"),color:"gold",onRequestAnimation:G,centerShift:xe}),Boolean(D)&&(0,v.Y)("h1",{className:"ZZAj3hj7",children:D}),(0,v.Y)("p",{className:Re,children:E}),(0,v.FD)("p",{className:Ue,children:[(0,v.Y)("span",{className:(0,s.A)(Ue,_),children:(0,K.hk)(h,r)}),r.currency===y.OUy&&(0,v.Y)(V.A,{type:"gold",size:"middle"}),"TON"===r.currency&&(0,v.Y)(F.A,{name:"toncoin",className:_}),A.isRefund&&(0,v.Y)("p",{className:"sxWAwxTd",children:h("Refunded")})]}),Boolean(A.paidMessages&&A.starRefCommision&&o)&&(0,v.Y)("p",{className:Re,children:h("PaidMessageTransactionDescription",{percent:(0,W.l9)(o/10)},{withNodes:!0,withMarkdown:!0})})]}),te=[];let ie;A&&b&&!A.paidMessages&&!m&&te.push([g("StarsTransaction.StarRefReason.Title"),g("StarsTransaction.StarRefReason.Program")]),c&&te.push([g("StarGiftReason"),g("StarGiftReasonUpgrade")]),d&&te.push([g("StarGiftReason"),h("StarGiftReasonDropOriginalDetails")]),m&&te.push([g("StarGiftReason"),Z(A.amount)?h("StarGiftSaleTransaction"):h("StarGiftPurchaseTransaction")]),ie=c?g("Stars.Transaction.GiftFrom"):Z(r)||A.isMyGift?g("Stars.Transaction.To"):!A.starRefCommision||A.paidMessages||m?g(w?"Star.Transaction.From":"Stars.Transaction.Via"):g("StarsTransaction.StarRefReason.Miniapp"),A.isPostsSearch||d||te.push([ie,w?{chatId:w}:T||""]),A.starRefCommision&&A.paidMessages&&te.push([h("PaidMessageTransactionTotal"),(0,pe.U2)(h,A.amount.amount/((100-A.starRefCommision)/100),{asFont:!1,className:"cU5QlvwL",containerClassName:"Z2YALGgl"})]),M&&te.push([g("Stars.Transaction.Reaction.Post"),(0,v.Y)(p.A,{url:M,text:M})]),U&&A.amount.currency===y.OUy&&(te.push([g("BoostReason"),(0,v.Y)(p.A,{url:U,text:g("Giveaway")})]),te.push([g("Gift"),g("Stars",A.amount,"i")])),A.id&&te.push([g("Stars.Transaction.Id"),(0,v.FD)(v.FK,{children:[(0,v.Y)("div",{className:"tMF8VIOM",onClick:()=>{(0,ve.eM)(A.id),l({message:g("StarsTransactionIDCopied")})},children:A.id}),(0,v.Y)(F.A,{className:"voCttFzS",name:"copy"})]})]),te.push([g("Stars.Transaction.Date"),(0,z.L2)(1e3*A.date,g.code,!0)]);const ae=g("lng_credits_box_out_about").split("{link}");return{header:k?j:Q,tableData:te,footer:(0,v.FD)("span",{className:"KgzPpgS6",children:[ae[0],(0,v.Y)(p.A,{url:g("StarsTOSLink"),text:g("lng_credits_summary_options_about_link")}),ae[1]]})}},[A,g,h,t,i,n,o,G]),k=(0,he.A)(I)||I;return(0,v.Y)(ye.A,{isOpen:Boolean(A),className:"IzhfRIWu",hasBackdrop:"starGiftUnique"===A?.starGift?.type,header:k?.header,tableData:k?.tableData,footer:k?.footer,buttonText:g("OK"),onClose:d})})),Le="oBLHWBtJ",Ke=[0,-50],qe=(0,a.ph)((0,r.EK)((e,{modal:t})=>{const i=t?.subscription.peerId;return{peer:i?(0,o.PVB)(e,i):void 0}})(({modal:e,peer:t})=>{const{closeStarsSubscriptionModal:i,fulfillStarsSubscription:o,changeStarsSubscription:l,checkChatInvite:c,loadStarStatus:d,openInvoice:h}=(0,r.ko)(),g=(0,m.A)(),A=(0,M.A)(),{subscription:b}=e||{},S=(0,a.li)(),N=(0,u.A)(()=>{S.current?.()}),C=(0,u.A)(e=>{S.current=e}),G=(0,a.Kr)(()=>{if(!b)return"hidden";if(b.canRefulfill)return"refulfill";const e=b.until>Date.now()/1e3;if(e&&!b.isCancelled)return"cancel";if(e&&b.isCancelled)return"renew";const t=b.chatInviteHash||b.invoiceSlug;return!e&&t?"restart":"ok"},[b]),I=(0,u.A)(()=>{if(b){switch(G){case"refulfill":o({id:b.id});break;case"restart":b.chatInviteHash?c({hash:b.chatInviteHash}):b.invoiceSlug&&h({type:"slug",slug:b.invoiceSlug}),d();break;case"renew":l({id:b.id,isCancelled:!1});break;case"cancel":l({id:b.id,isCancelled:!0})}i()}}),k=(0,a.Kr)(()=>{if(!b||!t)return;const{pricing:e,until:i,isCancelled:a,canRefulfill:r,photo:o,title:l,hasBotCancelled:c}=b,d=(0,n.mO)(t),u=(0,v.FD)("div",{className:"E3R22yAI",children:[(0,v.FD)("div",{className:"wuTMXDP9",children:[(0,v.Y)(f.A,{peer:o?void 0:t,webPhoto:o,size:"giant",onMouseMove:N}),(0,v.Y)(V.A,{className:"enRetSny",type:"gold",size:"adaptive"})]}),(0,v.Y)(Ne.A,{className:(0,s.A)("zGCayu45"),color:"gold",onRequestAnimation:C,centerShift:Ke}),(0,v.Y)("h1",{className:"qdydQHgc",children:l||g("StarsSubscriptionTitle")}),(0,v.Y)("p",{className:"FI6rEJlK",children:A("StarsPerMonth",{amount:e.amount},{withNodes:!0,specialReplacement:{[y.Cyx]:(0,v.Y)(V.A,{className:"J8HIcN6k",size:"adaptive",type:"gold"})}})})]}),m=[];m.push([g(d?"StarsSubscriptionBot":"StarsSubscriptionChannel"),{chatId:t.id}]),l&&m.push([g("StarsSubscriptionBotProduct"),l]);const h=i<Date.now()/1e3;m.push([g(h?"StarsSubscriptionUntilExpired":a?"StarsSubscriptionUntilExpires":"StarsSubscriptionUntilRenews"),(0,z.L2)(1e3*i,g.code,!0)]);const S=A("StarsTransactionTOS",{link:(0,v.Y)(p.A,{url:A("StarsTransactionTOSLink"),text:A("StarsTransactionTOSLinkText")})},{withNodes:!0});return{header:u,tableData:m,footer:(0,v.FD)("span",{className:"GMWMuWCr",children:[(0,v.Y)("p",{className:Le,children:S}),a&&(0,v.Y)("p",{className:"nkwiG25Q",children:g(c?"StarsSubscriptionBotCancelledText":"StarsSubscriptionCancelledText")}),r&&(0,v.Y)("p",{className:Le,children:g("StarsSubscriptionRefulfillInfo",(0,z.L2)(1e3*i,g.code,!0))}),!a&&!r&&h&&(0,v.Y)("p",{className:Le,children:g("StarsSubscriptionExpiredInfo",(0,z.L2)(1e3*i,g.code,!0))}),!a&&!r&&!h&&(0,v.Y)("p",{className:Le,children:g("StarsSubscriptionCancelInfo",(0,z.L2)(1e3*i,g.code,!0))}),"hidden"!==G&&(0,v.Y)(U.A,{color:"cancel"===G?"danger":"primary",isText:"cancel"===G,onClick:I,children:g("cancel"===G?"StarsSubscriptionCancel":"refulfill"===G?"StarsSubscriptionRefulfill":"restart"===G?"StarsSubscriptionAgain":"renew"===G?"StarsSubscriptionRenew":"OK")})]})}},[G,A,g,t,b]),Y=(0,he.A)(k)||k;return(0,v.Y)(ye.A,{isOpen:Boolean(b),className:"eR_RZfGB",header:Y?.header,tableData:Y?.tableData,footer:Y?.footer,onClose:i})}));var Ve=i(34431),Ee=i(19806),He=i(22699),ze=i(24433),We=i(32581),Je=i(66644),je=i(15283),_e=i(93545),Qe=i(68292),Xe=i(85118);const $e={root:"CuBAw2yg",slider:"euOOAbZi",sparkles:"_L1YQTIP",progress:"kwK0cNPX",floatingBadgeWrapper:"uvlMoXj0",floatingBadge:"BGSDWAYc",floatingBadgeText:"qqQan8uF",floatingBadgeTriangle:"mIdJOmsB"},Ze=[50,100,500,1e3,2e3,5e3,1e4];function et(e,t){const i=e.findIndex(e=>t<=e),a=e[i-1]||1,r=e[i]||e[e.length-1];return i+(t-a)/(r-a)}function tt(e,t){const i=Math.floor(t),a=e[i-1]||1,r=a+((e[i]||e[e.length-1])-a)*(t-i);return Math.round(r)}const it=(0,a.ph)(({maxValue:e,defaultValue:t,className:i,onChange:r})=>{const n=(0,a.li)(),o=(0,a.Kr)(()=>{const t=[];for(let i=0;i<Ze.length;i++)if(Ze[i]<e&&t.push(Ze[i]),Ze[i]>=e){t.push(e);break}return t},[e]),[l,c]=(0,a.J0)(0);(0,je.A)(()=>{c(et(o,t))});const d=(0,u.A)(()=>{const e=n.current;if(!e)return;const t=e.parentElement;(0,Je.YS)(()=>{const i=t.offsetLeft+e.offsetWidth/2,a=t.offsetLeft+t.offsetWidth-e.offsetWidth/2;(0,Je.RK)(()=>{t.style.setProperty("--_min-x",`${i}px`),t.style.setProperty("--_max-x",`${a}px`)})})});(0,_e.A)(n,d);const m=(0,u.A)(e=>{const t=Number(e.currentTarget.value);c(t),r(tt(o,t))});return(0,v.FD)("div",{className:(0,s.A)($e.root,i),style:"--progress: "+l/o.length,children:[(0,v.Y)("div",{className:$e.floatingBadgeWrapper,children:(0,v.FD)("div",{className:$e.floatingBadge,ref:n,children:[(0,v.FD)("div",{className:$e.floatingBadgeText,children:[(0,v.Y)(F.A,{name:"star",className:$e.floatingBadgeIcon}),(0,v.Y)(Qe.A,{text:(0,W.Sm)(tt(o,l))})]}),(0,v.FD)("svg",{className:$e.floatingBadgeTriangle,width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",children:[(0,v.Y)("defs",{children:(0,v.FD)("linearGradient",{id:"StarBadgeTriangle",x1:"0",x2:"1",y1:"0",y2:"0",children:[(0,v.Y)("stop",{offset:"-50%","stop-color":"#FFAA00"}),(0,v.Y)("stop",{offset:"150%","stop-color":"#FFCD3A"})]})}),(0,v.Y)("path",{d:"m 28,4 v 9 c 0.0089,7.283278 -3.302215,5.319646 -6.750951,8.589815 l -5.8284,5.82843 c -0.781,0.78105 -2.0474,0.78104 -2.8284,0 L 6.7638083,21.589815 C 2.8288652,17.959047 0.04527024,20.332086 0,13 V 4 C 0,4 0.00150581,0.97697493 3,1 5.3786658,1.018266 22.594519,0.9142007 25,1 c 2.992326,0.1067311 3,3 3,3 z",fill:"url(#StarBadgeTriangle)"})]})]})}),(0,v.Y)("div",{className:$e.progress,children:(0,v.Y)(Xe.A,{preset:"progress",className:$e.sparkles})}),(0,v.Y)("input",{className:$e.slider,type:"range",min:0,max:o.length,defaultValue:et(o,t),step:"any",onChange:m})]})}),at={content:"RdhRpsCn",title:"yzbjj73U",slider:"xePPMXOI",description:"BlpfdOtK",itemInfo:"nS9V516D",itemTitle:"sH5Nukjy",itemSubtitle:"dHlNODTI",itemIcon:"H_iHihXU",sendAsPeerButtonAvatar:"_mjvLELm",sendAsPeerMenuButton:"zxsRaWYV",buttonDownIcon:"zrwUUELS",sendAsPeerMenuBubble:"X1PB6mhQ",sendAsPeerMenu:"Px1MDij9",sendAsPeersMenuContainer:"Al1nfhHJ",headerControlPanel:"vu90kSL_",separator:"uhQLUjmo",checkBox:"Mc3bVeF0",topLabel:"bnou4CpV",top:"QludQDKR",topBadge:"JBF9pTUK",buttonStar:"NJJFuym9",topPeer:"Ty4Ud_Rd",disclaimer:"KRvkHeo1"},rt={avatarIcon:"author-hidden",customPeerAvatarColor:"#9eaab5",isCustomPeer:!0,titleKey:"StarsReactionAnonymous"},nt=(0,a.ph)((0,r.EK)((e,{modal:t})=>{const i=t&&(0,o.hds)(e,t.chatId),a=t&&(0,o.O5q)(e,t.chatId,t.messageId),r=e.stars?.balance,n=e.appConfig.paidReactionMaxAmount||2500,s=e.settings.paidReactionPrivacy,l=i?.sendPaidReactionsAsPeerIds,c=e.currentUserId;return{chat:i,message:a,starBalance:r,maxAmount:n,defaultPrivacy:s,sendPaidReactionsAsPeerIds:l,currentUserId:c,currentUser:(0,o.mBe)(e,c)}})(({modal:e,chat:t,message:i,maxAmount:l,starBalance:d,defaultPrivacy:g,sendPaidReactionsAsPeerIds:A,currentUserId:b,currentUser:S})=>{const{closePaidReactionModal:N,addLocalPaidReaction:C,loadSendPaidReactionsAs:G}=(0,r.ko)(),[I,k]=(0,a.J0)(50),[Y,P,B]=(0,D.A)(),[w,T]=(0,a.J0)(!0),[R,x]=(0,a.J0)(b),O=t?.id,L=R?(0,o.PVB)((0,r.mS)(),R):S,K=(0,m.A)(),{isMobile:q}=(0,ke.Ay)(),V=(0,M.A)(),E=(0,u.A)(e=>{T(!e.target.checked)}),z=(0,u.A)(e=>{k(e),P()});(0,a.vJ)(()=>{O&&!A&&G({chatId:O})},[O,A]);const J=(0,a.Kr)(()=>{const e=A?.map(e=>e.id).filter(e=>e!==O);return e?.unshift(b),e},[A,O,b]),j=J&&J.length>1;(0,a.vJ)(()=>{e||B()},[e]),(0,a.vJ)(()=>{const e=i?.reactions?.topReactors?.find(e=>e.isMy);if(e)return T(Boolean(e.isAnonymous)),void(e.peerId&&x(e.peerId));T("anonymous"===g?.type||!1),"peer"===g?.type&&J?.includes(g.peerId)?x(g.peerId):x(b)},[g,i?.reactions?.topReactors,J,b]);const _=(0,u.A)(()=>{e&&(C({chatId:e.chatId,messageId:e.messageId,count:I,isPrivate:w,peerId:w||R===b?void 0:R,shouldIgnoreDefaultPrivacy:!0}),N())}),Q=(0,u.A)(e=>{T(!1),x(e)}),X=(0,u.A)(e=>{const t=(0,o.PVB)((0,r.mS)(),e),i=R===e&&!w;if(t)return(0,v.FD)(ze.A,{onClick:()=>Q(e),children:[(0,v.Y)(f.A,{size:"small",peer:t}),(0,v.FD)("div",{className:(0,s.A)(at.itemInfo),children:[(0,v.Y)(Ve.A,{className:at.itemTitle,peer:t,noFake:!0,noVerified:!0}),(0,v.Y)("span",{className:at.itemSubtitle,children:(0,n.mO)(t)?V("PeerPersonalAccount"):V("PeerChannel")})]}),(0,v.Y)(F.A,{className:at.itemIcon,name:i?"check":"placeholder"})]})}),$=(0,a.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,v.FD)(U.A,{ripple:!q,size:"smaller",color:"translucent",className:(0,s.A)(at.sendAsPeerMenuButton,t?"active":""),onClick:e,ariaLabel:V("AriaLabelOpenMenu"),children:[(0,v.Y)(f.A,{className:at.sendAsPeerButtonAvatar,size:"mini",peer:w?rt:L}),(0,v.Y)(F.A,{name:"down",className:at.buttonDownIcon})]}),[q,V,L,w]),Z=(0,a.Kr)(()=>{if(j)return(0,v.Y)(He.A,{className:(0,s.A)(at.sendAsPeerMenu,"with-menu-transitions"),bubbleClassName:at.sendAsPeerMenuBubble,trigger:$,positionX:"right",autoClose:!0,children:J.map(e=>X(e))})},[$,J,j]),ee=(0,a.Kr)(()=>{const e=(0,r.mS)(),t=i?.reactions?.topReactors;if(!t)return;const a=[];let n=!1,s=0;if(t.forEach(t=>{const i=t.peerId?(0,o.PVB)(e,t.peerId):void 0;if(!i&&!t.isAnonymous&&!t.isMy)return;if(t.isMy&&(s=t.count),t.isMy&&(t.peerId!==R||t.isAnonymous&&!w))return;const r=R===t.peerId||w&&t.isAnonymous;r&&(n=!0),a.push({amount:t.count,localAmount:r&&Y?I:0,isMy:t.isMy,isAnonymous:t.isAnonymous,user:i})}),!n){const t=(0,o.PVB)(e,R);a.push({amount:s,localAmount:Y?I:0,isMy:!0,user:t})}return a.sort((e,t)=>t.amount+t.localAmount-(e.amount+e.localAmount)),a.slice(0,3)},[Y,i?.reactions?.topReactors,I,R,w]),te=t&&(0,n.F9)(K,t);return(0,v.FD)(h.A,{isOpen:Boolean(e),onClose:N,isSlim:!0,hasAbsoluteCloseButton:!0,contentClassName:at.content,isLowStackPriority:!0,children:[(0,v.Y)("div",{className:at.sendAsPeersMenuContainer,children:Z}),(0,v.Y)("div",{className:at.headerControlPanel,children:(0,v.Y)(H,{balance:d,className:at.modalBalance,withAddButton:!0})}),(0,v.Y)(it,{className:at.slider,defaultValue:50,maxValue:l,onChange:z}),(0,v.Y)("h3",{className:at.title,children:K("StarsReactionTitle")}),(0,v.Y)("div",{className:at.description,children:(0,c.A)(K("StarsReactionText",te),["simple_markdown","emoji"])}),(0,v.Y)(We.A,{children:ee&&(0,v.Y)("div",{className:at.topLabel,children:K("StarsReactionTopSenders")})}),ee&&(0,v.Y)("div",{className:at.top,children:ee.map(e=>{const t=(0,W.Sm)(e.amount+e.localAmount),i=e.isAnonymous||!e.user||e.isMy&&w?rt:e.user,a="isCustomPeer"in i?K(i.titleKey):i&&(0,n.F9)(K,i);return(0,v.Y)(ge.A,{className:at.topPeer,peer:i,badgeText:t,badgeIcon:"star",badgeClassName:at.topBadge,text:a},`${e.user?.id||"anonymous"}-${t}`)})}),ee&&(0,v.Y)(We.A,{className:at.separator}),(0,v.Y)(Ee.A,{className:(0,s.A)(at.checkBox,"dialog-checkbox"),checked:!w,onChange:E,label:K("StarsReactionShowMeInTopSenders")}),(0,v.Y)(U.A,{onClick:_,children:V("SendPaidReaction",{amount:I},{withNodes:!0,specialReplacement:{[y.Cyx]:(0,v.Y)(F.A,{className:at.buttonStar,name:"star"})}})}),(0,v.Y)("p",{className:at.disclaimer,children:V("StarsReactionTerms",{link:(0,v.Y)(p.A,{text:V("StarsReactionLinkText"),url:V("StarsReactionLink")})},{withNodes:!0})})]})}));var ot=i(37836),st=i(5912),lt=i(23174),ct=i(65632),dt=i(20333),ut=i(36143),mt=i(96530),ft=i(22720),pt=i(63152),ht=i(94079);const gt="zZUpGRSI",At="zAee80Dv",bt="nTPAv1ci",St=(0,a.ph)((0,r.EK)((e,{peerId:t})=>{const i=(0,o.SJA)(e),{stars:a}=e,{isBlurred:r,patternColor:n,background:s,backgroundColor:l}=(0,o.Gyz)(e,i)||{},c=(0,o.PVB)(e,t),d=(0,o.WA9)(e,t),u=(0,o.vGo)(e,t),m=e.currentUserId===t,f=!m&&u?.disallowedGifts?.shouldDisallowUniqueStarGifts,p=!m&&u?.disallowedGifts?.shouldDisallowLimitedStarGifts,h=(0,o.nTw)(e);return{starBalance:a?.balance,peer:c,theme:i,isBackgroundBlurred:r,patternColor:n,customBackground:s,backgroundColor:l,captionLimit:e.appConfig.starGiftMaxMessageLength,currentUserId:e.currentUserId,isPaymentFormLoading:h.isPaymentFormLoading,paidMessagesStars:d,areUniqueStarGiftsDisallowed:f,shouldDisallowLimitedStarGifts:p}})(function({gift:e,giftByStars:t,peerId:i,peer:o,captionLimit:c,theme:d,isBackgroundBlurred:m,patternColor:f,backgroundColor:p,customBackground:h,currentUserId:g,isPaymentFormLoading:A,starBalance:b,paidMessagesStars:S,areUniqueStarGiftsDisallowed:N,shouldDisallowLimitedStarGifts:y}){const{sendStarGift:C,sendPremiumGiftByStars:G,openInvoice:I,openGiftUpgradeModal:k,openStarsBalanceModal:Y}=(0,r.ko)(),P=(0,M.A)(),[B,w]=(0,a.J0)(""),[T,D]=(0,a.J0)(!1),[F,R]=(0,a.J0)(!1),[x,O]=(0,a.J0)(!1),L=(0,ct.A)(d,h);(0,a.vJ)(()=>{y&&R(!0)},[y,F]);const K="id"in e&&"starGift"===e.type,q="months"in e,V=t&&"amount"in t,E=o&&(0,n.mO)(o),H=i===g,z=(0,a.Kr)(()=>{if(q){const i=x&&V?t:e;return{id:-1,chatId:"0",isOutgoing:!1,senderId:g,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"giftPremium",amount:i.amount,currency:i.currency,days:30*e.months,message:B?{text:B}:void 0}}}}if(K)return{id:-1,chatId:"0",isOutgoing:!1,senderId:g,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"starGift",message:B?.length?{text:B}:void 0,isNameHidden:T||void 0,starsToConvert:e.starsToConvert,canUpgrade:F||void 0,alreadyPaidUpgradeStars:F?e.upgradeStars:void 0,gift:e,peerId:i,fromId:g}}}},[g,e,B,K,T,F,i,x,V,t,q]),W=(0,u.A)(e=>{w(e.target.value)}),J=(0,u.A)(()=>{D(!T)}),j=(0,u.A)(()=>{R(!F)}),_=(0,u.A)(()=>{V&&O(!x)}),Q=(0,u.A)(()=>{K&&k({giftId:e.id,peerId:i})}),X=(0,u.A)(()=>{Y({})}),$=(0,u.A)(()=>{K?C({peerId:i,shouldHideName:T,gift:e,message:B?{text:B}:void 0,shouldUpgrade:F}):x&&V?G({userId:i,months:t.months,amount:t.amount,message:B?{text:B}:void 0}):q&&I({type:"giftcode",userIds:[i],currency:e.currency,amount:e.amount,option:e,message:B?{text:B}:void 0})}),Z=V&&b&&b.amount>t.amount,ee=(0,s.A)("ZORVRSG3","soDpW2YR",h&&"Eny_G3JI",p&&"TkJZPU2u",h&&m&&"M6k91TdM");if((K||q)&&z)return(0,v.FD)("div",{className:(0,s.A)("jKOG0It6","custom-scroll"),children:[(0,v.FD)("div",{className:(0,s.A)("CB1mxsgp","MessageList"),inert:!0,style:(0,Ge.A)(`--pattern-color: ${f}`,p&&`--theme-background-color: ${p}`),children:[(0,v.Y)("div",{className:ee,style:L?`--custom-background: ${L}`:void 0}),(0,v.Y)(ut.A,{message:z,threadId:lt.l3,appearanceOrder:0},K?e.id:q?e.months:void 0)]}),function(){const i=c?c-B.length:void 0,a=(0,n.F9)(P,o);return(0,v.FD)("div",{className:"Y68CEIKn",children:[!S&&(0,v.Y)(ht.A,{className:"o5r2IPoA",onChange:W,value:B,label:P("GiftMessagePlaceholder"),maxLength:c,maxLengthIndicator:i&&i<50?i.toString():void 0}),Z&&(0,v.FD)(ft.A,{className:gt,narrow:!0,ripple:!0,onClick:_,children:[(0,v.Y)("span",{children:P("GiftPremiumPayWithStars",{stars:(0,pe.U2)(P,t.amount,{className:At})},{withNodes:!0})}),(0,v.Y)(pt.A,{checked:x,onChange:_,label:P("GiftPremiumPayWithStarsAcc")})]}),V&&b&&(0,v.Y)("div",{className:bt,children:P("GiftPremiumDescriptionYourBalance",{stars:(0,pe.U2)(P,b.amount,{className:At}),link:(0,v.Y)(mt.A,{isPrimary:!0,onClick:X,children:P("GetMoreStarsLinkText")})},{withNodes:!0,withMarkdown:!0})}),K&&Boolean(e.upgradeStars)&&!N&&(0,v.FD)(ft.A,{className:gt,narrow:!0,ripple:!0,onClick:j,disabled:y,children:[(0,v.Y)("span",{children:P("GiftMakeUnique",{stars:(0,pe.U2)(P,e.upgradeStars,{className:At})},{withNodes:!0})}),(0,v.Y)(pt.A,{checked:F,onChange:j,label:P("GiftMakeUniqueAcc")})]}),K&&Boolean(e.upgradeStars)&&!N&&(0,v.Y)("div",{className:bt,children:E?P("GiftMakeUniqueDescription",{user:a,link:(0,v.Y)(mt.A,{isPrimary:!0,onClick:Q,children:P("GiftMakeUniqueLink")})},{withNodes:!0}):P("GiftMakeUniqueDescriptionChannel",{peer:a,link:(0,v.Y)(mt.A,{isPrimary:!0,onClick:Q,children:P("GiftMakeUniqueLink")})},{withNodes:!0})}),K&&(0,v.FD)(ft.A,{className:gt,narrow:!0,ripple:!0,onClick:J,children:[(0,v.Y)("span",{children:P("GiftHideMyName")}),(0,v.Y)(pt.A,{checked:T,onChange:J,label:P("GiftHideMyName")})]}),K&&(0,v.Y)("div",{className:bt,children:H?P("GiftHideNameDescriptionSelf"):E?P("GiftHideNameDescription",{receiver:a}):P("GiftHideNameDescriptionChannel")})]})}(),(0,v.Y)("div",{className:"ATowWJ60"}),function(){const i=x&&V?(0,pe.U2)(P,t.amount,{asFont:!0}):K?(0,pe.U2)(P,e.stars+(F?e.upgradeStars:0),{asFont:!0}):q?(0,l.vv)(P,e.amount,e.currency):void 0;return(0,v.FD)("div",{className:"jxWZSvet",children:[K&&Boolean(e.availabilityRemains)&&(0,v.Y)(dt.A,{isPrimary:!0,progress:e.availabilityRemains/e.availabilityTotal,rightText:P("GiftSoldCount",{count:e.availabilityTotal-e.availabilityRemains}),leftText:P("GiftLeftCount",{count:e.availabilityRemains}),className:"mWzLu0c0"}),(0,v.Y)(U.A,{className:"IDuhjrne",size:"smaller",onClick:$,isLoading:A,children:P("GiftSend",{amount:i},{withNodes:!0})})]})}()]})}));var vt=i(87049);const Nt="G1mBmzxs",yt="a8no5WH0",Ct="DvJLTVFU",Gt=(0,a.ph)((0,r.EK)((e,{option:t})=>({sticker:(0,o.t0O)(e,t.months),canPlayAnimatedEmojis:(0,o.BWX)(e)}))(function({sticker:e,canPlayAnimatedEmojis:t,baseMonthAmount:i,option:a,optionByStars:r,onClick:n}){const{months:o,amount:s,currency:c}=a,d=(0,M.A)(),m=(0,u.A)(()=>{n(a)}),f=Math.floor(s/o),p=i&&i>f?Math.ceil(100-f/(i/100)):void 0;return(0,v.FD)("div",{className:Nt,tabIndex:0,role:"button",onClick:m,children:[(0,v.Y)(ee.A,{sticker:e,play:t,noLoop:!0,nonInteractive:!0,size:86}),function(){const e=12===o?d("Years",{count:1},{pluralValue:1}):d("Months",{count:o},{pluralValue:o});return(0,v.Y)("div",{className:"rn9aWFNA",children:e})}(),(0,v.Y)("div",{className:"q4_ydkAx",children:d("PremiumGiftDescription")}),(0,v.Y)(U.A,{className:yt,color:"adaptive",nonInteractive:!0,size:"tiny",pill:!0,fluid:!0,children:(0,l.Ad)(s,c)}),r&&(0,v.Y)("div",{className:"QB5SI7ta",children:d("GiftPremiumStarsPrice",{stars:(0,pe.U2)(d,r.amount,{className:"jgnEfoeM"})},{withNodes:!0,withMarkdown:!0})}),Boolean(p)&&(0,v.Y)(vt.A,{color:"purple",text:d("GiftDiscount",{percent:p})})]})}));var It=i(82855);const kt=(0,a.ph)((0,r.EK)(e=>({isCurrentUserPremium:(0,o.g29)(e)}))(function({gift:e,isResale:t,isCurrentUserPremium:i,withTransferBadge:n,observeIntersection:o,onClick:l}){const{openGiftInfoModal:c,openPremiumModal:d,showNotification:m,checkCanSendGift:f}=(0,r.ko)(),p=(0,a.li)(),h=(0,a.li)(),g=(0,M.A)(),[A,b]=(0,a.J0)(!1),[S,N,C]=(0,D.A)(),G=(0,X.yQ)(e),I="starGiftUnique"===e.type,k=I?e:void 0,Y=I?void 0:e,P=I?function(t){if(!t)return{amount:0,currency:y.OUy};if("starGiftUnique"===e.type&&e.resaleTonOnly){const e=t.find(e=>e.currency===y.ykW);if(e)return e}return t.find(e=>e.currency===y.OUy)}(k?.resellPrice):{amount:Y?.stars||0,currency:y.OUy},B=P?.currency||y.OUy,w=Y?.resellMinStars,T=!I&&t&&w?g.number(w)+"+":P?.amount||0,R=!I&&Boolean(Y?.isLimited),x=!I&&Boolean(Y?.isSoldOut),O=Boolean(e?.requirePremium),L=Boolean(Y?.limitedPerUser&&!Y?.perUserRemains),K=Y?.perUserTotal,q=(0,u.A)(()=>{!x||t?L?m({message:g("NotificationGiftsLimit2",{count:K},{pluralValue:K,withMarkdown:!0,withNodes:!0})}):!O||i?H?f({gift:e,onSuccess:()=>l(e,t?"resell":"original")}):l(e,t?"resell":"original"):d({gift:e}):c({gift:e})}),V=(0,a.Kr)(()=>{const{backdrop:t,pattern:i}=(0,X.uc)(e)||{};if(!t||!i)return;const a=[t.centerColor,t.edgeColor];return(0,v.Y)(te.A,{className:"Nkotr8Q4",backgroundColors:a,patternIcon:i.sticker,ringsCount:1,ovalFactor:1})},[e]),E=I?e.number:0,H=Boolean("starGift"===e.type&&e.lockedUntilDate),z=(0,a.Kr)(()=>{if(I){const{backdrop:t}=(0,X.uc)(e)||{};if(!t)return;return(0,v.Y)(vt.A,{color:[t.centerColor,t.edgeColor],text:g("GiftSavedNumber",{number:E})})}return t?(0,v.Y)(vt.A,{color:"green",text:g("GiftRibbonResale")}):x?(0,v.Y)(vt.A,{color:"red",text:g("GiftSoldOut")}):O?(0,v.Y)(vt.A,{color:"orange",text:g("LimitPremium")}):R?(0,v.Y)(vt.A,{color:"blue",text:g("GiftLimited")}):void 0},[I,t,e,x,R,g,E,O]);(0,st.mv)(p,o,e=>{const t=e.isIntersecting;b(t)});const W=(0,a.Kr)(()=>n?g("GiftTransferTitle"):B===y.ykW?(0,pe.Ms)(g,T||0,{shouldConvertFromNanos:!0,className:Ct}):(0,pe.U2)(g,T||0,{asFont:!0,className:Ct}),[n,B,T,g]);return(0,v.FD)("div",{ref:p,className:(0,s.A)("interactive-gift",Nt,"f5ArEO1S","starGiftItem",O&&"NBYIITte"),tabIndex:0,role:"button",onClick:q,onMouseEnter:Ce.TF?void 0:N,onMouseLeave:Ce.TF?void 0:C,children:[V,(0,v.Y)("div",{ref:h,className:"rUSoeQXb",style:"width: 90px; height: 90px",children:G&&(0,v.Y)(It.A,{observeIntersectionForPlaying:o,observeIntersectionForLoading:o,containerRef:h,sticker:G,size:90,shouldLoop:S,shouldPreloadPreview:!0})}),(0,v.Y)(U.A,{className:(0,s.A)(yt,n&&"nqN62arv"),nonInteractive:!0,size:"tiny",color:I?"bluredStarsBadge":"stars",withSparkleEffect:A&&!n,pill:!0,fluid:!0,children:W}),z,H&&(0,v.Y)(F.A,{name:"lock-badge",className:"kwuipwV7"})]})}));var Yt=i(13235),Pt=i(36175),Bt=i(96374),wt=i(64489);const Tt={root:"tJK1W0pJ",transition:"pP8TxefR",content:"o3V1HqbL",resaleScreenRoot:"Vce_TsJO",main:"cVXqeu9P",giftSection:"v4eKefwN",section:"EqfarEYb",resaleStarGiftsContainer:"RSFcSNGL",starGiftsContainer:"OQX3GZl5",premiumGiftsGallery:"n40m3BK2",header:"iqqoyRgW",noBorder:"cuvdjW2y",resaleHeader:"cJRBgg9B",resaleHeaderContentContainer:"OXYQmfGK",headerSlide:"BTWhJUQB",headerText:"lLRmbpIu",hiddenHeader:"XgGzn1cQ",resaleHeaderText:"bp_KPx8I",commonHeaderText:"ybZo03if",resaleHeaderDescription:"XefHUFm1",closeButton:"r_Y5uG1T",balance:"soqAknia",avatars:"N_7tYJKr",avatar:"_3hY4vIep",logoBackground:"ieK4TzSb",center:"Ey5gX40t",description:"ZioU5h_k",starGiftsDescription:"gFgzS8pV",boostIcon:"Qi2YR6Dz",optionBottom:"RTbClMKE",secondaryInfo:"g0R9GSNq",footer:"J3Gju3bv",starGiftsTransition:"kB6IyXqS",notFoundGiftsRoot:"UqnRlJ1n",notFoundGiftsDescription:"g0VbwIG_",notFoundGiftsLink:"j2zPEQr8"},Dt=(0,a.ph)((0,r.EK)(e=>{const{starGifts:t}=e,{resaleGifts:i}=(0,o.nTw)(e),a=i?.giftId?t?.byId[i.giftId]:void 0,r=i.filter,n=i.isAllLoaded,s=i.isLoading,l=i.updateIteration;return{resellGifts:i.gifts,gift:a,filter:r,areGiftsAllLoaded:n,areGiftsLoading:s,updateIteration:l}})(({resellGifts:e,gift:t,filter:i,areGiftsAllLoaded:n,areGiftsLoading:o,updateIteration:l,onGiftClick:c})=>{const{loadResaleGifts:d,updateResaleGiftsFilter:m}=(0,r.ko)(),f=(0,a.li)(),p=(0,M.A)(),h=(0,a.Kr)(()=>e?.map(e=>e.id),[e]),g=Boolean(i?.modelAttributes?.length||i?.patternAttributes?.length||i?.backdropAttributes?.length),A=(0,u.A)(()=>{if(t){const e="regularGiftId"in t?t.regularGiftId:t.id;d({giftId:e})}}),b=Boolean(!e||0===e.length),[S,N]=(0,Bt.A)(A,h,!t,Yt.bc),{observe:y}=(0,st.BL)({rootRef:f,throttleMs:200}),C=(0,u.A)(()=>{m({filter:{...i,modelAttributes:[],backdropAttributes:[],patternAttributes:[]}})});return(0,v.Y)("div",{ref:f,className:(0,s.A)(Tt.resaleScreenRoot,"custom-scroll"),children:(0,v.FD)(O.Ay,{name:"zoomFade",activeKey:l,children:[b&&n&&(0,v.FD)("div",{className:Tt.notFoundGiftsRoot,children:[(0,v.Y)(wt.A,{size:160,tgsUrl:Pt.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,v.Y)("div",{className:Tt.notFoundGiftsDescription,children:p("ResellGiftsNoFound")}),g&&(0,v.Y)(mt.A,{className:Tt.notFoundGiftsLink,onClick:C,children:p("ResellGiftsClearFilters")})]}),(0,v.Y)(R.A,{className:(0,s.A)(Tt.resaleStarGiftsContainer),items:S,onLoadMore:N,itemSelector:".starGiftItem",noFastList:!0,preloadBackwards:Yt.bc,scrollContainerClosest:`.${Tt.resaleScreenRoot}`,children:e?.map(e=>(0,v.Y)(kt,{gift:e,observeIntersection:y,isResale:!0,onClick:c},e.id))})]})})}));var Mt=i(10722),Ft=i(71429),Ut=i(36393),Rt=i(87094);const xt=1.5*T.$,Ot=(0,a.ph)((0,r.EK)(e=>({theme:(0,o.SJA)(e)}))(({className:e,type:t,sticker:i,observeIntersectionForLoading:r,observeIntersectionForPlaying:n,theme:o})=>{const l=(0,a.li)(),c=(0,Rt.A)(l,void 0,"pattern"!==t);return(0,v.Y)("div",{ref:l,className:(0,s.A)("KLFLR9ji",e),style:`width: ${xt}px; height: ${xt}px`,children:(0,v.Y)(It.A,{containerRef:l,sticker:i,size:xt,shouldPreloadPreview:!0,observeIntersectionForLoading:r,observeIntersectionForPlaying:n,thumbClassName:"fCL5rY2D",customColor:c})})})),Lt={root:"_VgmQnUg",buttonsContainer:"IDlp6U6g",itemIcon:"yuctLnuR",sticker:"VT562JS0",backdropAttributeMenuItemText:"D50wFfRL",menuItemStickerText:"THcGWXSA",menuItemText:"L6EVE2Ux",backdrop:"A29QNxKb",menuItemIcon:"GL4rVsev",item:"qiYcBOYc",menuContentContainer:"EDsBn29z",menu:"ISaNdBwd",left:"e4Kkh_MR",right:"Kz_nCGC3"},Kt=(0,a.ph)((0,r.EK)(e=>{const{resaleGifts:t}=(0,o.nTw)(e);return{attributes:t.attributes,counters:t.counters,filter:t.filter}})(({attributes:e,counters:t,filter:i,dialogRef:n})=>{const o=(0,M.A)(),{updateResaleGiftsFilter:l}=(0,r.ko)(),[c,d]=(0,a.J0)(""),[m,f]=(0,a.J0)(""),[p,h]=(0,a.J0)(""),g=(0,a.Kr)(()=>{const i={model:[],pattern:[],backdrop:[]};for(const a of t??[]){const{attribute:t}=a;if(!a.count)continue;const r=e?.find(e=>"backdrop"===e.type&&"backdrop"===t.type?e.backdropId===t.backdropId:("model"===e.type&&"model"===t.type||"pattern"===e.type&&"pattern"===t.type)&&e.sticker.id===t.documentId);"backdrop"===r?.type&&i.backdrop.push(r),"model"===r?.type&&i.model.push(r),"pattern"===r?.type&&i.pattern.push(r)}return i},[e,t]),A=(0,a.Kr)(()=>{const e=(e,t)=>t.trim()?e.filter(e=>Boolean(e.name?.toLowerCase().includes(t.toLowerCase()))):e;return{model:e(g.model,c),pattern:e(g.pattern,p),backdrop:e(g.backdrop,m)}},[g,c,m,p]),b=(0,a.li)(),{isContextMenuOpen:S,contextMenuAnchor:N,handleContextMenu:y,handleContextMenuClose:C,handleContextMenuHide:G}=(0,Mt.A)(n),I=(0,u.A)(()=>b.current),k=(0,a.li)(),{isContextMenuOpen:Y,contextMenuAnchor:P,handleContextMenu:B,handleContextMenuClose:w,handleContextMenuHide:T}=(0,Mt.A)(n),D=(0,u.A)(()=>k.current),U=(0,a.li)(),{isContextMenuOpen:R,contextMenuAnchor:x,handleContextMenu:O,handleContextMenuClose:L,handleContextMenuHide:K}=(0,Mt.A)(n),q=(0,u.A)(()=>U.current),V=(0,a.li)(),{isContextMenuOpen:E,contextMenuAnchor:H,handleContextMenu:z,handleContextMenuClose:W,handleContextMenuHide:J}=(0,Mt.A)(n),j=(0,u.A)(()=>V.current),_=(0,a.Kr)(()=>{const e=i.sortType;return({onTrigger:t,isOpen:i})=>(0,v.FD)("div",{className:Lt.item,onClick:t,children:["byDate"===e&&o("ValueGiftSortByDate"),"byNumber"===e&&o("ValueGiftSortByNumber"),"byPrice"===e&&o("ValueGiftSortByPrice"),(0,v.Y)(F.A,{name:"dropdown-arrows",className:Lt.itemIcon})]})},[o,i]),Q=(0,a.Kr)(()=>{const e=i?.modelAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,v.FD)("div",{className:Lt.item,onClick:t,children:[0===e&&o("GiftAttributeModel"),e>0&&o("GiftAttributeModelPlural",{count:e},{pluralValue:e}),(0,v.Y)(F.A,{name:"dropdown-arrows",className:Lt.itemIcon})]})},[o,i]),X=(0,a.Kr)(()=>{const e=i?.backdropAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,v.FD)("div",{className:Lt.item,onClick:t,children:[0===e&&o("GiftAttributeBackdrop"),e>0&&o("GiftAttributeBackdropPlural",{count:e},{pluralValue:e}),(0,v.Y)(F.A,{name:"dropdown-arrows",className:Lt.itemIcon})]})},[o,i]),$=(0,a.Kr)(()=>{const e=i?.patternAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,v.FD)("div",{className:Lt.item,onClick:t,children:[0===e&&o("GiftAttributeSymbol"),e>0&&o("GiftAttributeSymbolPlural",{count:e},{pluralValue:e}),(0,v.Y)(F.A,{name:"dropdown-arrows",className:Lt.itemIcon})]})},[o,i]),Z=(0,u.A)(e=>{l({filter:{...i,sortType:e}})}),ee=(0,u.A)(()=>{l({filter:{...i,modelAttributes:[]}})}),ie=(0,u.A)(()=>{l({filter:{...i,patternAttributes:[]}})}),ae=(0,u.A)(()=>{l({filter:{...i,backdropAttributes:[]}})}),re=(0,u.A)(e=>{if(!t)return;const a=i.modelAttributes||[],r=t.find(t=>"model"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!r)return;const n=a.some(e=>e.documentId===r.documentId)?a.filter(e=>e.documentId!==r.documentId):[...a,r];l({filter:{...i,modelAttributes:n}})}),ne=(0,u.A)(e=>{if(!t)return;const a=i.patternAttributes||[],r=t.find(t=>"pattern"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!r)return;const n=a.some(e=>e.documentId===r.documentId)?a.filter(e=>e.documentId!==r.documentId):[...a,r];l({filter:{...i,patternAttributes:n}})}),oe=(0,u.A)(e=>{if(!t)return;const a=i.backdropAttributes||[],r=t.find(t=>"backdrop"===t.attribute.type&&t.attribute.backdropId===e.backdropId)?.attribute;if(!r)return;const n=a.some(e=>e.backdropId===r.backdropId)?a.filter(e=>e.backdropId!==r.backdropId):[...a,r];l({filter:{...i,backdropAttributes:n}})}),se=(0,a.hb)(()=>{d("")},[]),le=(0,a.hb)(()=>{f("")},[]),ce=(0,a.hb)(()=>{h("")},[]),de=(0,u.A)(e=>{e.stopPropagation(),e.preventDefault()}),ue=(0,a.li)(),{observe:me}=(0,st.BL)({rootRef:ue,isDisabled:!P});return(0,v.FD)("div",{className:Lt.root,children:[Boolean(N)&&(0,v.Y)(Ft.A,{isOpen:S,anchor:N,ref:b,className:(0,s.A)(Lt.menu,Lt.left,"with-menu-transitions"),getMenuElement:I,autoClose:!0,onClose:C,onCloseAnimationEnd:G,positionX:"left",children:(0,v.FD)(v.FK,{children:[(0,v.FD)(ze.A,{icon:"sort-by-price",onClick:()=>{Z("byPrice")},children:[(0,v.Y)("div",{className:Lt.menuItemText,children:o("GiftSortByPrice")}),(0,v.Y)(F.A,{className:Lt.menuItemIcon,name:"byPrice"===i?.sortType?"check":"placeholder"})]}),(0,v.FD)(ze.A,{icon:"sort-by-date",onClick:()=>{Z("byDate")},children:[(0,v.Y)("div",{className:Lt.menuItemText,children:o("GiftSortByDate")}),(0,v.Y)(F.A,{className:Lt.menuItemIcon,name:"byDate"===i?.sortType?"check":"placeholder"})]}),(0,v.FD)(ze.A,{icon:"sort-by-number",onClick:()=>{Z("byNumber")},children:[(0,v.Y)("div",{className:Lt.menuItemText,children:o("GiftSortByNumber")}),(0,v.Y)(F.A,{className:Lt.menuItemIcon,name:"byNumber"===i?.sortType?"check":"placeholder"})]})]})}),Boolean(P)&&(0,v.Y)(Ft.A,{isOpen:Y,anchor:P,ref:k,className:(0,s.A)(Lt.menu,Lt.left,"with-menu-transitions"),getMenuElement:D,autoClose:!0,onClose:w,onCloseAnimationEnd:T,children:function(){const e=A.model,t=i.modelAttributes??[],a=0===t.length;return(0,v.FD)("div",{className:Lt.menuContentContainer,ref:ue,children:[(0,v.Y)(Ut.A,{onClick:de,className:Lt.search,value:c,onChange:d,onReset:se,placeholder:o("Search")}),(0,v.Y)(ze.A,{icon:"select",onClick:ee,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,v.FD)(ze.A,{onClick:()=>{re(e)},children:[(0,v.Y)(Ot,{className:Lt.sticker,sticker:e.sticker,type:"model",observeIntersectionForLoading:me,observeIntersectionForPlaying:me}),(0,v.Y)("div",{className:Lt.menuItemStickerText,children:e.name}),(0,v.Y)(F.A,{className:Lt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(x)&&(0,v.Y)(Ft.A,{isOpen:R,anchor:x,ref:U,className:(0,s.A)(Lt.menu,Lt.right,"with-menu-transitions"),getMenuElement:q,autoClose:!0,onClose:L,onCloseAnimationEnd:K,positionX:"right",children:function(){const e=A.backdrop,t=i.backdropAttributes??[],a=0===t.length;return(0,v.FD)("div",{className:Lt.menuContentContainer,children:[(0,v.Y)(Ut.A,{onClick:de,className:Lt.search,value:m,onChange:f,onReset:le,placeholder:o("Search")}),(0,v.Y)(ze.A,{icon:"select",onClick:ae,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.backdropId===e.backdropId);return(0,v.FD)(ze.A,{onClick:()=>{oe(e)},children:[(0,v.Y)(te.A,{className:Lt.backdrop,backgroundColors:[e.centerColor,e.edgeColor]}),(0,v.Y)("div",{className:Lt.backdropAttributeMenuItemText,children:e.name}),(0,v.Y)(F.A,{className:Lt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(H)&&(0,v.Y)(Ft.A,{isOpen:E,anchor:H,ref:V,className:(0,s.A)(Lt.menu,Lt.right,"with-menu-transitions"),getMenuElement:j,autoClose:!0,onClose:W,onCloseAnimationEnd:J,children:function(){const e=A.pattern,t=i.patternAttributes??[],a=0===t.length;return(0,v.FD)("div",{className:Lt.menuContentContainer,children:[(0,v.Y)(Ut.A,{onClick:de,className:Lt.search,value:p,onChange:h,onReset:ce,placeholder:o("Search")}),(0,v.Y)(ze.A,{icon:"select",onClick:ie,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,v.FD)(ze.A,{onClick:()=>{ne(e)},children:[(0,v.Y)(Ot,{className:Lt.sticker,sticker:e.sticker,type:"pattern"}),(0,v.Y)("div",{className:Lt.menuItemStickerText,children:e.name}),(0,v.Y)(F.A,{className:Lt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),(0,v.FD)("div",{className:Lt.buttonsContainer,children:[(0,v.Y)(_,{onTrigger:y,isOpen:S}),(0,v.Y)(Q,{onTrigger:B,isOpen:Y}),(0,v.Y)(X,{onTrigger:O,isOpen:R}),(0,v.Y)($,{onTrigger:z,isOpen:E})]})]})}));var qt=i(36838);const Vt=(0,a.ph)((0,r.EK)(e=>{const{starGifts:t}=e;return{idsByCategory:t?.idsByCategory}})(({ref:e,idsByCategory:t,onCategoryChanged:i,areUniqueStarGiftsDisallowed:r,areLimitedStarGiftsDisallowed:n,isSelf:o,hasMyUnique:l,isPinned:c})=>{let d=(0,a.li)();e&&(d=e);const u=(0,M.A)(),m=Boolean(t?.collectible?.length),[f,p]=(0,a.J0)("all");function h(e){return"all"===e?u("AllGiftsCategory"):"myUnique"===e?u("GiftCategoryMyGifts"):"collectible"===e?u("GiftCategoryCollectibles"):e}function g(e){return(0,v.Y)("div",{className:(0,s.A)("dO7FKYY4",f===e&&"B2lEJk1v"),onClick:()=>function(e){p(e),i(e)}(e),children:h(e)})}return(0,qt.A)(d,void 0,!0),(0,v.FD)("div",{ref:d,className:(0,s.A)("cUjwvN00",c&&"NhJABU3M","no-scrollbar"),children:[g("all"),!r&&!o&&l&&g("myUnique"),(!r||!n)&&m&&g("collectible")]})})),Et=[0,-50],Ht=3.5*T.$,zt=(0,ot.nF)(e=>e(),200,!0),Wt=(0,a.ph)((0,r.EK)((e,{modal:t})=>{const{starGifts:i,stars:a,currentUserId:r}=e,n=t?.forPeerId?(0,o.PVB)(e,t.forPeerId):void 0,s=Boolean(r&&t?.forPeerId===r),l=n?(0,o.vGo)(e,n?.id):void 0,{resaleGifts:c}=(0,o.nTw)(e),d=c.count,u=!1!==c.isLoading,m=t?.selectedResaleGift;return{boostPerSentGift:e.appConfig.boostsPerSentGift,starGiftsById:i?.byId,starGiftIdsByCategory:i?.idsByCategory,myUniqueGiftsById:e.myUniqueGifts?.byId,myUniqueGiftIds:e.myUniqueGifts?.ids,starBalance:a?.balance,peer:n,isSelf:s,disallowedGifts:l?.disallowedGifts,resaleGiftsCount:d,areResaleGiftsLoading:u,selectedResaleGift:m,tabId:(0,o.nTw)(e).id}})(({modal:e,starGiftsById:t,starGiftIdsByCategory:i,myUniqueGiftsById:o,myUniqueGiftIds:l,starBalance:c,peer:g,isSelf:A,disallowedGifts:b,resaleGiftsCount:S,areResaleGiftsLoading:N,selectedResaleGift:G,tabId:I})=>{const{closeGiftModal:k,openGiftInfoModal:Y,resetResaleGifts:P,loadResaleGifts:B,openGiftInMarket:w,closeResaleGiftsMarket:T,loadMyUniqueGifts:F,openGiftTransferConfirmModal:x}=(0,r.ko)(),L=(0,a.li)(),K=(0,a.li)(),q=(0,a.li)(),V=(0,a.li)(),E=(0,a.li)(),z=Boolean(e),W=(0,d.A)(e),J=g&&(0,n.mO)(g)?g:void 0,j=g&&(0,n.vj)(g)?g:void 0,[_,Q]=(0,a.J0)(),[X,$]=(0,a.J0)(!1),[Z,ee]=(0,a.J0)(!1),[te,ie]=(0,a.J0)(!1),[ae,re]=(0,a.J0)("all"),[ne,oe,se]=(0,D.A)(!1),le=(0,a.li)(),ce=(0,a.Kr)(()=>{if(!b)return;const{shouldDisallowPremiumGifts:e,...t}=b;return!A&&Object.values(t).every(Boolean)},[A,b]),de=!A&&b?.shouldDisallowUnlimitedStarGifts,ue=!A&&b?.shouldDisallowLimitedStarGifts,me=!A&&b?.shouldDisallowUniqueStarGifts,fe=(0,m.A)(),pe=(0,M.A)(),he=W?.gifts,ge=(0,a.Kr)(()=>he?.sort((e,t)=>e.months-t.months).filter(e=>1===e.users&&e.currency!==y.OUy),[he]),Ae=(0,a.Kr)(()=>{const e=new Map;return ge?(ge.forEach(t=>{const i=he?.find(e=>e.currency===y.OUy&&e.months===t.months);i&&e.set(t,i)}),e):e},[he,ge]),be=(0,a.Kr)(()=>ge?.reduce((e,t)=>e.amount<t.amount?e:t),[ge]),{observe:Se}=(0,st.BL)({rootRef:E,throttleMs:200,isDisabled:!z}),ve=Boolean(G)&&!_,ye=Boolean(_),Ce=ve||ye||X,Ge=ye?te:Z;(0,a.vJ)(()=>{if(G){const e="regularGiftId"in G?G.regularGiftId:G.id;B({giftId:e})}},[G]),(0,a.vJ)(()=>{z||($(!1),Q(void 0),re("all"))},[z,I,T]);const Ie=(0,u.A)(e=>{if(ye)return;const t=e.currentTarget;zt(()=>{const{scrollTop:e}=t;if($(e>150),K.current&&q.current){const{top:e}=q.current.getBoundingClientRect(),{top:t}=K.current.getBoundingClientRect();ee(e-t<=0)}if(V.current&&E.current){const{top:e}=V.current.getBoundingClientRect(),{top:t}=E.current.getBoundingClientRect();e-t<=Ht?oe():se()}})}),ke=pe("GiftPremiumDescription",{user:(0,C.Yg)(J),link:(0,v.Y)(p.A,{text:pe("GiftPremiumDescriptionLinkCaption"),url:pe("GiftPremiumDescriptionLink")})},{withNodes:!0}),Ye=(0,a.Kr)(()=>j?pe("StarGiftDescriptionChannel",{peer:(0,n.F9)(pe,j)},{withNodes:!0,withMarkdown:!0}):A?pe("StarGiftDescriptionSelf",void 0,{withNodes:!0,renderTextFilters:["br"]}):"collectible"===ae?pe("StarGiftDescriptionCollectibles"):pe("StarGiftDescription",{user:(0,C.Yg)(J)},{withNodes:!0,withMarkdown:!0}),[j,A,ae,J,pe]),Pe=(0,u.A)((e,t)=>{if("resell"===t){if(!("id"in e))return;return ve?void Y({gift:e,recipientId:W?.forPeerId}):void w({gift:e,tabId:I})}Q(e),ie("id"in e)}),Be=(0,u.A)(e=>{if("starGift"===e.type||!o||!g?.id)return;const t=o[e.id];x({gift:t,recipientId:g.id})}),we=(0,u.A)(()=>{"myUnique"===ae&&F()});const Te=(0,u.A)(e=>{re(e)}),De=(0,u.A)(()=>{Q(void 0),P(),k()}),Me=(0,u.A)(()=>{ve?T({tabId:I}):ye?Q(void 0):De()}),Fe=(0,u.A)(()=>{le.current?.()}),Ue=(0,u.A)(e=>{le.current=e}),Re=ye||ve,xe=(0,s.A)("animated-close-icon",Re&&"state-back");return(0,v.FD)(h.A,{dialogRef:L,onClose:De,isOpen:z,isSlim:!0,contentClassName:Tt.content,className:(0,s.A)(Tt.modalDialog,Tt.root),isLowStackPriority:!0,children:[(0,v.Y)(U.A,{className:Tt.closeButton,round:!0,color:"translucent",size:"tiny",onClick:Me,ariaLabel:fe(Re?"Common.Back":"Common.Close"),children:(0,v.Y)("div",{className:xe})}),(0,v.Y)(H,{className:Tt.balance,balance:c,withAddButton:!0}),(0,v.Y)("div",{className:(0,s.A)(Tt.header,ve&&Tt.resaleHeader,!Ce&&Tt.hiddenHeader,ne&&Tt.noBorder),children:(0,v.Y)(O.Ay,{name:"slideVerticalFade",activeKey:Ce?ve?1:Ge?2:3:0,slideClassName:Tt.headerSlide,children:function(){if(Ce){if(ve){const e=N&&!S;return(0,v.FD)("div",{className:Tt.resaleHeaderContentContainer,children:[(0,v.Y)("h2",{className:Tt.resaleHeaderText,children:G.title}),e&&(0,v.Y)("div",{className:Tt.resaleHeaderDescription,children:pe("Loading")}),!e&&void 0!==S&&(0,v.Y)("div",{className:Tt.resaleHeaderDescription,children:pe("HeaderDescriptionResaleGifts",{count:S},{withNodes:!0,withMarkdown:!0,pluralValue:S})}),(0,v.Y)(Kt,{dialogRef:L})]})}return(0,v.Y)("h2",{className:Tt.commonHeaderText,children:pe(Ge?A?"StarsGiftHeaderSelf":"StarsGiftHeader":"GiftPremiumHeader")})}}()})}),(0,v.FD)(O.Ay,{ref:K,className:Tt.transition,name:"pushSlide",activeKey:ye?1:ve?2:0,children:[!ye&&!ve&&(0,v.FD)("div",{ref:E,className:(0,s.A)(Tt.main,"custom-scroll"),onScroll:Ie,children:[(0,v.FD)("div",{className:Tt.avatars,children:[(0,v.Y)(f.A,{className:Tt.avatar,size:100,peer:g,onMouseMove:Fe}),(0,v.Y)(Ne.A,{className:Tt.logoBackground,color:"gold",centerShift:Et,onRequestAnimation:Ue})]}),!A&&!j&&!b?.shouldDisallowPremiumGifts&&(0,v.FD)(v.FK,{children:[(0,v.Y)("h2",{className:(0,s.A)(Tt.headerText,Tt.center),children:pe("GiftPremiumHeader")}),(0,v.Y)("p",{className:(0,s.A)(Tt.description,Tt.center),children:ke}),(0,v.Y)("div",{className:Tt.premiumGiftsGallery,children:ge?.map(e=>(0,v.Y)(Gt,{option:e,optionByStars:Ae.get(e),baseMonthAmount:be?Math.floor(be.amount/be.months):void 0,onClick:Pe}))})]}),!ce&&(0,v.FD)(v.FK,{children:[(0,v.Y)("h2",{ref:q,className:(0,s.A)(Tt.headerText,Tt.center),children:pe(A?"StarsGiftHeaderSelf":"StarsGiftHeader")}),(0,v.Y)("p",{className:(0,s.A)(Tt.description,Tt.starGiftsDescription,Tt.center),children:Ye}),(0,v.Y)(Vt,{ref:V,areUniqueStarGiftsDisallowed:me,areLimitedStarGiftsDisallowed:ue,isSelf:A,hasMyUnique:Boolean(l?.length),isPinned:ne,onCategoryChanged:Te}),(0,v.Y)(O.Ay,{name:"zoomFade",activeKey:(Oe=ae,"all"===Oe?0:"myUnique"===Oe?1:2),className:Tt.starGiftsTransition,children:function(){if("myUnique"===ae)return(0,v.Y)(R.A,{className:Tt.starGiftsContainer,items:l,onLoadMore:we,scrollContainerClosest:`.${Tt.main}`,itemSelector:".starGiftItem",children:o&&l?.map(e=>{const t=o[e];if(t)return(0,v.Y)(kt,{gift:t.gift,observeIntersection:Se,onClick:Be,withTransferBadge:!0},e)})});const e=i?.[ae]?.filter(e=>{const i=t?.[e];if(!i)return!1;const{isLimited:a,availabilityResale:r}=i;return ue&&a?!me&&r:!(de&&!a)});return(0,v.Y)("div",{className:Tt.starGiftsContainer,children:t&&e?.flatMap(e=>{const i=t[e],a=Boolean(i.availabilityResale)&&!me,r=a&&!i.isSoldOut&&!ue,n=[(0,v.Y)(kt,{gift:i,observeIntersection:Se,isResale:a&&!r,onClick:Pe},e)];return r&&n.push((0,v.Y)(kt,{isResale:!0,gift:i,observeIntersection:Se,onClick:Pe},`resale_${e}`)),n})})}()})]})]}),ve&&G&&(0,v.Y)(Dt,{onGiftClick:Pe}),ye&&W?.forPeerId&&(0,v.Y)(St,{gift:_,giftByStars:Ae.get(_),peerId:W.forPeerId})]})]});var Oe}));const Jt=(0,a.ph)((0,r.EK)(e=>{const{currentUserId:t}=e;return{currentUserId:t,userIds:e.contactList?.userIds}})(({modal:e,currentUserId:t,userIds:i})=>{const{closeGiftRecipientPicker:s,openGiftModal:l}=(0,r.ko)(),c=(0,m.A)(),d=e,[f,p]=(0,a.J0)(""),h=(0,a.Kr)(()=>{const e=(0,r.mS)(),a=i?i.concat(t):void 0,s=a?(0,n.PU)({ids:a,query:f}):[];return(0,I.A)((0,G.Am)(s).filter(t=>(0,o.X2D)(e,t)),void 0,[t])},[t,f,i]),g=(0,u.A)(e=>{l({forUserId:e}),s()});return(0,v.Y)(Y.A,{className:"W3JMs1YE",isOpen:d,onClose:s,title:c("GiftTelegramPremiumOrStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,children:(0,v.Y)(k.A,{className:"wOipz1Y_",itemIds:h,filterValue:f,filterPlaceholder:c("Search"),onSelectedIdChange:g,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,forceShowSelf:!0})})}));var jt=i(79089),_t=i(18501);function Qt({originalDetails:e,recipient:t,sender:i,onOpenChat:a,lang:r}){const{recipientId:o,senderId:s,date:l,message:c}=e,d=(0,z.L2)(1e3*l,r.code,!0),u=(0,v.Y)(mt.A,{onClick:()=>a(o),isPrimary:!0,children:(0,n.F9)(r,t)});if(!i||s===o)return c?r("GiftInfoPeerOriginalInfoText",{peer:u,text:(0,_t.fd)(c),date:d},{withNodes:!0}):r("GiftInfoPeerOriginalInfo",{peer:u,date:d},{withNodes:!0});const m=(0,v.Y)(mt.A,{onClick:()=>a(i.id),isPrimary:!0,children:(0,n.F9)(r,i)});return c?r("GiftInfoPeerOriginalInfoTextSender",{peer:u,sender:m,text:(0,_t.fd)(c),date:d},{withNodes:!0}):r("GiftInfoPeerOriginalInfoSender",{peer:u,date:d,sender:m},{withNodes:!0})}var Xt=i(25404);const $t={root:"Ef0cKSqQ",giftPreview:"IvuNzslN",backdrop:"dNukis4X",arrow:"oufsMLLF"},Zt=4*T.$,ei=3*T.$,ti=(0,a.ph)(({peer:e,gift:t})=>{const i=(0,a.Kr)(()=>(0,X.uc)(t),[t]);if(i)return(0,v.FD)("div",{className:$t.root,children:[(0,v.FD)("div",{className:$t.giftPreview,children:[(0,v.Y)(te.A,{className:$t.backdrop,backgroundColors:[i.backdrop.centerColor,i.backdrop.edgeColor],patternIcon:i.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,v.Y)(ee.A,{className:$t.sticker,size:ei,sticker:i.model?.sticker})]}),(0,v.Y)(F.A,{name:"next",className:$t.arrow}),(0,v.Y)(f.A,{peer:e,size:Zt,className:$t.avatar})]})});var ii=i(94189);const ai={modal:"nnublcCk",checkBox:"fjE0wGvw",checkBoxDescription:"tepUTe4z",upgradeIcon:"lgyInH5K",descriptionConfirm:"BJh2Tufh",titleConfirm:"gA102W1G",header:"p7FTs7_p",title:"pIbzzTir",description:"CCPfr26t",soldOut:"kjWcRp4W",modalContent:"o9rFZ6By",headerSplitButton:"XOMI_4PO",moreMenuButton:"EMwExRMy",closeButton:"jQv0ZSEW",giftResalePriceContainer:"BN8gf5y6",starAmountIcon:"_5guecUe",giftResalePriceStar:"H_q8o2vY",headerButton:"WA0INleU",left:"aOhTHZlf",right:"rJOB1u5Q",footer:"bho0GTYt",footerDescription:"VUylTszM",footerHint:"mxS8kDnA",buyButton:"i1MmnrPG",unknown:"zDauXmpS",giftValue:"w_E4LkUj",uniqueValue:"uAjIRJva",uniqueAttribute:"OJQnkf17",attributeName:"dq7wCHJb",uniqueGift:"I6o_pGAm",modalHeader:"ie9tImaj",modalCloseButton:"p38RBGdC",ownerAddress:"DavMRg4Q",copyIcon:"SLX5tX8C",messageContainer:"oW5T3mkV",removeMessageButton:"TrW2LVm5"},ri=(0,a.ph)((0,r.EK)((e,{modal:t})=>{const i=t?.gift,a=i&&"gift"in i,r=e.currentUserId,s=a&&i.fromId,l=s?(0,o.PVB)(e,s):void 0,c=t?.peerId?(0,o.PVB)(e,t.peerId):void 0,d=c&&(0,n.vj)(c)?c:void 0,u=d&&(0,C.ub)(d,"postMessages"),m=(0,o.mBe)(e,r),f=t?.recipientId&&r!==t.recipientId?(0,o.PVB)(e,t.recipientId):void 0,p=m?.emojiStatus,h=e.collectibleEmojiStatuses?.statuses,g=a?i.gift:i,A="starGiftUnique"===g?.type&&g.releasedByPeerId;return{fromPeer:l,targetPeer:c,releasedByPeer:A?(0,o.PVB)(e,A):void 0,currentUserId:r,starGiftMaxConvertPeriod:e.appConfig.starGiftMaxConvertPeriod,tonExplorerUrl:e.appConfig.tonExplorerUrl,hasAdminRights:u,currentUserEmojiStatus:p,collectibleEmojiStatuses:h,currentUser:m,recipientPeer:f}})(({modal:e,fromPeer:t,targetPeer:i,releasedByPeer:c,currentUserId:h,starGiftMaxConvertPeriod:g,hasAdminRights:A,currentUserEmojiStatus:b,collectibleEmojiStatuses:S,tonExplorerUrl:N,currentUser:C,recipientPeer:G})=>{const{closeGiftInfoModal:I,changeGiftVisibility:k,convertGiftToStars:Y,openChatWithInfo:P,focusMessage:B,openGiftUpgradeModal:w,showNotification:T,buyStarGift:R,closeGiftModal:x,openGiftInfoValueModal:O,updateResaleGiftsFilter:L,openGiftInMarket:K,openGiftDescriptionRemoveModal:V}=(0,r.ko)(),[E,H,J]=(0,D.A)(),j=(0,M.A)(),_=(0,m.A)(),[$,Z]=(0,a.J0)(!1),[te,ie]=(0,a.J0)(!1),ae=(0,a.li)(),re=(0,a.li)(),ne=(0,a.li)(),{isContextMenuOpen:oe,contextMenuAnchor:se,handleContextMenu:le,handleContextMenuClose:ce,handleContextMenuHide:de}=(0,Mt.A)(ae),ue=(0,u.A)(()=>{Be&&rt?.pattern&&(K({gift:Be}),L({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[],patternAttributes:[{type:"pattern",documentId:rt.pattern.sticker.id}]}}))}),me=(0,u.A)(()=>{Be&&rt?.backdrop&&(K({gift:Be}),L({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[{type:"backdrop",backdropId:rt.backdrop.backdropId}],patternAttributes:[]}}))}),fe=(0,u.A)(()=>{Be&&rt?.model&&(K({gift:Be}),L({filter:{sortType:"byDate",modelAttributes:[{type:"model",documentId:rt.model.sticker.id}],backdropAttributes:[],patternAttributes:[]}}))}),he=Boolean(e),ge=(0,d.A)(e),Ae=(0,d.A)(t),be=(0,d.A)(i),Se=be&&(0,n.vj)(be),{gift:Ne}=ge||{},Ce=Ne&&"gift"in Ne,Ge=Ce?Ne:void 0,Ie=Ge?.fromId===h,ke=Ge&&g&&Ge.date+g-(0,Ye.Fm)()||0,Pe=Math.ceil(ke/60/60/24),Be=Ce?Ne.gift:Ne,we=Be&&(0,X.yQ)(Be),Te=ke>0&&Boolean(Ge?.starsToConvert),De=Be&&"starGiftUnique"===Be.type,Fe=De?Be:void 0,Ue=(0,a.Kr)(()=>{if(Be&&"starGiftUnique"===Be.type){if(c){const e=`@${(0,jt.Kl)(c)}`||(0,n.F9)(j,c),t=(0,n.mO)(c)?j("ActionFallbackUser"):j("ActionFallbackChannel");return j("GiftInfoCollectibleBy",{number:Be.number,owner:e||t},{withNodes:!0,withMarkdown:!0})}return j("GiftInfoCollectible",{number:Be.number})}},[Be,c,j]),Re="starGiftUnique"===Be?.type?Be.slug:void 0,xe=(0,a.Kr)(()=>{if(Re)return S?.find(e=>"collectible"===e.type&&e.slug===Re)},[Re,S]),Oe=Boolean(xe),Le=Boolean(Ge?.upgradeMsgId),Ke=!Le&&Ge?.inputGift&&(Se?A:"starGift"===Be?.type?be?.id===h:Be?.ownerId===h||Oe);function qe(e){if(!De)return;const t=Be.resellPrice;return t?Be?.resaleTonOnly||e?t.find(e=>e.currency===y.ykW):t.find(e=>e.currency===y.OUy):void 0}const Ve=qe(),He=qe(te),ze=Ve?.currency===y.ykW&&De?Be.resellPrice?.find(e=>e.currency===y.OUy):void 0,We=!Oe&&"starGiftUnique"===Be?.type&&Be.ownerId!==h&&Boolean(Ve),Je=(()=>{if(!De)return;const{ownerName:e,ownerId:t}=Be,i=(0,r.mS)(),a=t?(0,o.PVB)(i,t):void 0;return a?(0,n.F9)(j,a):e})(),je=(0,u.A)(()=>{I()}),_e=(0,u.A)(()=>{const e=Ie?be:Ae;if(!Ge?.upgradeMsgId||!e)return;const{upgradeMsgId:t}=Ge;B({chatId:e.id,messageId:t}),je()}),Qe=(0,u.A)(()=>{const{inputGift:e,isUnsaved:t}=Ge;k({gift:e,shouldUnsave:!t}),je()}),Xe=(0,u.A)(()=>{const{inputGift:e}=Ge;Y({gift:e}),J(),je()}),$e=(0,u.A)(()=>{if(!(Ge?.inputGift&&Ge.dropOriginalDetailsStars&&Be&&rt))return;const{originalDetails:e}=rt;e&&V({gift:Ge,price:Ge.dropOriginalDetailsStars,details:e})}),Ze=(0,u.A)(()=>{if(!Ge)return;const e=be?.id;w({giftId:Ge.gift.id,gift:Ge,peerId:e})}),et=(0,u.A)(()=>{"starGiftUnique"===Be?.type&&qe()&&Z(!0)}),tt=(0,u.A)(()=>{Z(!1)}),it=(0,u.A)(()=>{const e=G||C,t=qe(te);e&&t&&"starGiftUnique"===Be?.type&&(tt(),x(),R({peerId:e.id,slug:Be.slug,price:t}))}),at=(0,u.A)(()=>{Be&&"starGiftUnique"===Be.type&&O({gift:Be})}),rt=(0,a.Kr)(()=>Be&&(0,X.uc)(Be),[Be]),nt=(0,u.A)(()=>We?(0,v.FD)(U.A,{className:ai.buyButton,onClick:et,children:[(0,v.Y)("div",{children:j("ButtonBuyGift",{stars:Ve?.currency===y.ykW?(0,pe.Ms)(j,Ve.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ve?.amount,{asFont:!0})},{withNodes:!0})}),Ve?.currency===y.ykW&&Boolean(ze)&&(0,v.Y)("div",{className:ai.footerHint,children:j("GiftBuyEqualsTo",{stars:(0,pe.U2)(j,ze.amount,{asFont:!0})},{withNodes:!0})})]}):Le?(0,v.Y)(U.A,{onClick:_e,children:j("GiftInfoViewUpgraded")}):Ke&&Ge?.alreadyPaidUpgradeStars&&!Ge.upgradeMsgId?(0,v.Y)(U.A,{isShiny:!0,onClick:Ze,iconName:"arrow-down-circle",iconClassName:ai.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgradeForFree")}):Ke&&Ge?.canUpgrade&&!Ge.upgradeMsgId?(0,v.Y)(U.A,{isShiny:!0,onClick:Ze,iconName:"arrow-down-circle",iconClassName:ai.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgrade")}):Ge?.prepaidUpgradeHash?(0,v.Y)(U.A,{isShiny:!0,onClick:Ze,iconName:"arrow-down-circle",iconClassName:ai.upgradeIcon,iconAlignment:"end",children:j("GiftAnUpgradeButton")}):(0,v.Y)(U.A,{onClick:je,children:j("OK")})),ot=(0,a.Kr)(()=>{if(!Be)return;let e="";return"starGift"===Be.type&&(Be.firstSaleDate&&(e+=`${j("GiftInfoFirstSale")} ${(0,z.L2)(1e3*Be.firstSaleDate,j.code,!0)}`),Be.lastSaleDate&&(e+="\n",e+=`${j("GiftInfoLastSale")} ${(0,z.L2)(1e3*Be.lastSaleDate,j.code,!0)}`)),e},[Be,j]),st=(0,a.Kr)(()=>{if(!Ne||!Be)return;const{fromId:e,isNameHidden:t,starsToConvert:i,isUnsaved:a,isConverted:d,upgradeMsgId:u}=Ge||{},m=Te&&Boolean(i),h=t&&be,g=(()=>{if(!Ge)return j("GiftInfoSoldOutDescription");if(!Se){if(Ge.upgradeMsgId)return j("GiftInfoDescriptionUpgraded");if(Ke&&Ge.canUpgrade&&Ge.alreadyPaidUpgradeStars&&!Ge.upgradeMsgId)return j("GiftInfoDescriptionUpgrade2");if(Ge.canUpgrade&&Ke)return Ke?j("GiftInfoDescriptionFreeUpgrade"):j("GiftInfoPeerDescriptionFreeUpgradeOut",{peer:(0,n.F9)(j,be)});if(Ke||Ie)return d&&m?Ke?j("GiftInfoDescriptionConverted",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoPeerDescriptionOutConverted",{amount:i,peer:(0,n.F9)(j,be)},{pluralValue:i,withNodes:!0,withMarkdown:!0}):Ge.canUpgrade&&Ke?m?j("GiftInfoDescriptionUpgrade",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoDescriptionUpgradeRegular"):Ke?m?j("GiftInfoDescription",{amount:i},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoDescriptionRegular"):m?j("GiftInfoPeerDescriptionOut",{amount:i,peer:(0,n.F9)(j,be)},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoPeerDescriptionOutRegular",{peer:(0,n.F9)(j,be)})}})(),A=(0,v.FD)("div",{className:ai.modalHeader,children:[(0,v.Y)(U.A,{className:ai.closeButton,round:!0,color:"translucent-white",size:"tiny",iconName:"close",ariaLabel:j("Close"),onClick:je}),(0,v.Y)(U.A,{ref:ae,className:ai.moreMenuButton,round:!0,color:"translucent-white",size:"tiny",iconName:"more","aria-haspopup":"menu","aria-label":j("AriaMoreButton"),onContextMenu:le,onClick:le}),Boolean(Ve?.amount)&&(0,v.Y)("div",{className:ai.giftResalePriceContainer,children:Ve.currency===y.ykW?(0,pe.Ms)(j,Ve.amount,{className:ai.giftResalePriceStar,shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ve.amount,{asFont:!0,className:ai.giftResalePriceStar})})]}),b=De&&(0,v.Y)("div",{ref:ne,className:(0,s.A)(ai.header,ai.uniqueGift),children:(0,v.Y)(Me,{backdropAttribute:rt.backdrop,patternAttribute:rt.pattern,modelAttribute:rt.model,title:Be.title,subtitle:Ue,subtitlePeer:c,showManageButtons:Ke,savedGift:Ge})}),S=(0,v.FD)("div",{className:ai.header,children:[(0,v.Y)(ee.A,{className:ai.giftSticker,sticker:we,size:120}),(0,v.Y)("h1",{className:ai.title,children:De?Be.title:j(Ge?Ke?"GiftInfoReceived":"GiftInfoTitle":"GiftInfoSoldOutTitle")}),Boolean(g)&&(0,v.Y)("p",{className:(0,s.A)(ai.description,!Ge&&"starGift"===Be?.type&&ai.soldOut),children:g})]}),C=[];if("starGift"===Be.type){(e||t)&&C.push([j("GiftInfoFrom"),e?{chatId:e}:(0,v.FD)(v.FK,{children:[(0,v.Y)(f.A,{size:"small",peer:Q.I5}),(0,v.Y)("span",{className:ai.unknown,children:_(Q.I5.titleKey)})]})]),Ge?.date&&C.push([j("GiftInfoDate"),(0,v.Y)("span",{title:ot,children:(0,z.L2)(1e3*Ge.date,j.code,!0)})]),Be.firstSaleDate&&!Ge&&C.push([j("GiftInfoFirstSale"),(0,z.L2)(1e3*Be.firstSaleDate,j.code,!0)]),Be.lastSaleDate&&!Ge&&C.push([j("GiftInfoLastSale"),(0,z.L2)(1e3*Be.lastSaleDate,j.code,!0)]);const a=Be.stars+(Ge?.alreadyPaidUpgradeStars||0);C.push([j("GiftInfoValue"),(0,v.FD)("div",{className:ai.giftValue,children:[(0,pe.U2)(j,a,{className:ai.starAmountIcon}),Ke&&Te&&Boolean(i)&&(0,v.Y)(q.A,{onClick:H,children:j("GiftInfoConvert",{amount:i},{pluralValue:i})})]})]),Be.availabilityTotal&&C.push([j("GiftInfoAvailability"),j("GiftInfoAvailabilityValue",{count:Be.availabilityRemains||0,total:Be.availabilityTotal},{pluralValue:Be.availabilityRemains||0})]),Be.upgradeStars&&!u&&C.push([j("GiftInfoStatus"),(0,v.Y)("div",{className:ai.giftValue,children:j("GiftInfoStatusNonUnique")})]),Ge?.message&&C.push([void 0,(0,_t.fd)(Ge.message)])}if(De){const{ownerName:e,ownerAddress:t,ownerId:i}=Be,a=i?(0,o.PVB)((0,r.mS)(),i):void 0,{model:n,backdrop:s,pattern:c,originalDetails:d}=rt||{};if(t?C.push([j("GiftInfoOwner"),(0,v.FD)("span",{className:ai.ownerAddress,onClick:()=>{(0,ve.eM)(t),T({message:{key:"WalletAddressCopied"},icon:"copy"})},children:[t,(0,v.Y)(F.A,{className:ai.copyIcon,name:"copy"})]})]):(a||e)&&C.push([j("GiftInfoOwner"),i?{chatId:i,withEmojiStatus:!0}:e||""]),n&&C.push([j("GiftAttributeModel"),(0,v.FD)("span",{className:ai.uniqueAttribute,children:[(0,v.Y)("span",{className:ai.attributeName,onClick:fe,children:n.name}),(0,v.Y)(q.A,{children:(0,W.l9)(n.rarityPercent)})]})]),s&&C.push([j("GiftAttributeBackdrop"),(0,v.FD)("span",{className:ai.uniqueAttribute,children:[(0,v.Y)("span",{className:ai.attributeName,onClick:me,children:s.name}),(0,v.Y)(q.A,{children:(0,W.l9)(s.rarityPercent)})]})]),c&&C.push([j("GiftAttributeSymbol"),(0,v.FD)("span",{className:ai.uniqueAttribute,children:[(0,v.Y)("span",{className:ai.attributeName,onClick:ue,children:c.name}),(0,v.Y)(q.A,{children:(0,W.l9)(c.rarityPercent)})]})]),C.push([j("GiftInfoAvailability"),j("GiftInfoIssued",{issued:Be.issuedCount,total:Be.totalCount})]),Be.valueAmount&&Be.valueCurrency&&C.push([j("GiftInfoValue"),(0,v.FD)("span",{className:ai.uniqueValue,children:["~"," ",(0,l.Ad)(Be.valueAmount,Be.valueCurrency,j.code),(0,v.Y)(q.A,{onClick:at,children:j("GiftInfoValueLinkMore")})]})]),d){const{recipientId:e,senderId:t}=d,i=(0,r.mS)(),a=e=>{P({id:e}),I()},n=Qt({originalDetails:d,recipient:(0,o.PVB)(i,e),sender:t?(0,o.PVB)(i,t):void 0,onOpenChat:a,lang:j});C.push([void 0,(0,v.FD)("div",{className:ai.messageContainer,children:[(0,v.Y)("div",{children:n}),Boolean(Ge?.dropOriginalDetailsStars)&&(0,v.Y)(U.A,{round:!0,className:ai.removeMessageButton,size:"smaller",color:"translucent",ariaLabel:"Delete original details",onClick:$e,iconName:"delete"})]})])}}const G=N&&De&&Be.giftAddress&&`${N}${Be.giftAddress}`,k=(0,v.FD)("div",{className:ai.footer,children:[(Ke||G||We)&&(0,v.FD)("div",{className:ai.footerDescription,children:[G&&(0,v.Y)("div",{children:j("GiftInfoTonText",{link:(0,v.Y)(p.A,{url:G,shouldSkipModal:!0,text:j("GiftInfoTonLinkText")})},{withNodes:!0})}),Ke&&(0,v.Y)("div",{children:j(`GiftInfo${Se?"Channel":""}${a?"Hidden":"Saved"}`,{link:(0,v.Y)(mt.A,{isPrimary:!0,onClick:Qe,children:j("GiftInfoSaved"+(a?"Show":"Hide"))})},{withNodes:!0})}),!We&&h&&(0,v.Y)("div",{children:j("GiftInfoSenderHidden")}),We&&Je&&(0,v.Y)("div",{children:j("GiftInfoBuyGift",{user:Je},{withNodes:!0})})]}),nt()]});return{modalHeader:De?A:void 0,header:De?b:S,tableData:C,footer:k}},[Ne,Ge,be,we,j,Ke,Te,Ie,_,N,Be,rt,nt,Se,De,ot,We,Je,Ve,Ue,c,ue,me,fe,le]),lt=(0,u.A)(()=>ne.current),ct=(0,u.A)(()=>ae.current),dt=(0,u.A)(()=>re.current),ut=(0,u.A)(()=>({withPortal:!0})),ft=se&&Ne&&(0,v.Y)(Ft.A,{ref:re,isOpen:oe,anchor:se,className:"gift-context-menu with-menu-transitions",autoClose:!0,withPortal:!0,onClose:ce,onCloseAnimationEnd:de,positionX:"right",getTriggerElement:ct,getRootElement:lt,getMenuElement:dt,getLayout:ut,children:(0,v.Y)(Xt.A,{peerId:ge.peerId,gift:Ne,canManage:Ke,collectibleEmojiStatuses:S,currentUserEmojiStatus:b})});return(0,v.FD)(v.FK,{children:[(0,v.Y)(ye.A,{isOpen:he,modalHeader:st?.modalHeader,header:st?.header,hasBackdrop:De,tableData:st?.tableData,footer:st?.footer,className:ai.modal,contentClassName:ai.modalContent,onClose:je,withBalanceBar:Boolean(We),currencyInBalanceBar:He?.currency,isLowStackPriority:!0}),ft,Fe&&C&&Boolean(He)&&(0,v.FD)(ii.A,{isOpen:$,noDefaultTitle:!0,onClose:tt,confirmLabel:j("ButtonBuyGift",{stars:He?.currency===y.ykW?(0,pe.Ms)(j,He.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,He.amount,{asFont:!0})},{withNodes:!0}),confirmHandler:it,children:[Fe.resaleTonOnly&&(0,v.Y)("div",{className:ai.descriptionConfirm,children:j("ConfirmBuyGiftForTonDescription")}),(0,v.Y)(ti,{peer:G||C,gift:Fe}),(0,v.Y)("div",{className:ai.titleConfirm,children:j("TitleConfirmPayment")}),!G&&(0,v.Y)("p",{children:j("GiftBuyConfirmDescription",{gift:j("GiftUnique",{title:Fe.title,number:Fe.number}),stars:He?.currency===y.ykW?(0,pe.QH)(j,He.amount,!0):(0,pe.Kk)(j,He.amount)},{withNodes:!0,withMarkdown:!0})}),G&&(0,v.Y)("p",{children:j("GiftBuyForPeerConfirmDescription",{gift:j("GiftUnique",{title:Fe.title,number:Fe.number}),stars:He?.currency===y.ykW?(0,pe.QH)(j,He.amount,!0):(0,pe.Kk)(j,He.amount),peer:(0,n.F9)(j,G)},{withNodes:!0,withMarkdown:!0})}),!Fe.resaleTonOnly&&(0,v.FD)(v.FK,{children:[(0,v.Y)(Ee.A,{className:ai.checkBox,label:j("LabelPayInTON"),checked:te,onCheck:ie}),(0,v.Y)("div",{className:ai.checkBoxDescription,children:j("DescriptionPayInTON")})]})]}),Ge&&(0,v.FD)(ii.A,{isOpen:E,onClose:J,confirmHandler:Xe,title:j("GiftInfoConvertTitle"),children:[(0,v.Y)("div",{children:j("GiftInfoPeerConvertDescription",{amount:(0,pe.Kk)(j,Ge.starsToConvert),peer:(0,n.F9)(j,Ae)},{withNodes:!0,withMarkdown:!0})}),Te&&(0,v.Y)("div",{children:j("GiftInfoConvertDescriptionPeriod",{count:Pe},{withNodes:!0,withMarkdown:!0,pluralValue:Pe})}),(0,v.Y)("div",{children:j("GiftInfoConvertDescription2")})]})]})})),ni="hspYTy7V",oi=(0,a.ph)(({modal:e})=>{const{closeGiftInfoValueModal:t,openUrl:i,openGiftInMarket:n}=(0,r.ko)(),o=(0,M.A)(),s=Boolean(e),c=(0,d.A)(e),m=(0,u.A)(()=>{e?.valueInfo.fragmentListedUrl&&i({url:e.valueInfo.fragmentListedUrl})}),f=(0,u.A)(()=>{e?.gift&&n({gift:e.gift})}),p=(0,a.Kr)(()=>{if(!c)return;const{gift:e,valueInfo:t}=c,i=(0,X.uc)(e);if(!i)return;const a=(0,v.FD)("div",{className:"v4GJBsdC",children:[(0,v.Y)(ee.A,{className:"lJodRD0R",sticker:i.model.sticker,size:120}),(0,v.Y)(U.A,{pill:!0,size:"tiny",fluid:!0,nonInteractive:!0,children:(0,l.Ad)(t.value,t.currency,o.code)}),(0,v.Y)("div",{className:"VjWaO8un",children:o("GiftValueDescription",{giftName:e.title},{withMarkdown:!0,withNodes:!0})})]}),r=[];r.push([o("GiftValueTitleInitialSale"),(0,z.A)(1e3*t.initialSaleDate,o.code)]),r.push([o("GiftValueTitleInitialPrice"),(0,v.FD)("span",{className:"K7zsAhVt",children:[(0,pe.U2)(o,t.initialSaleStars,{className:"Xw91xwpe"})," (~ ",(0,l.Ad)(t.initialSalePrice,t.currency,o.code),")"]})]),t.lastSaleDate&&r.push([o("GiftValueTitleLastSale"),(0,z.A)(1e3*t.lastSaleDate,o.code)]),t.lastSalePrice&&r.push([o("GiftValueTitleLastPrice"),(0,l.Ad)(t.lastSalePrice,t.currency,o.code)]),t.floorPrice&&r.push([o("GiftValueTitleMinimumPrice"),(0,l.Ad)(t.floorPrice,t.currency,o.code)]),t.averagePrice&&r.push([o("GiftValueTitleAveragePrice"),(0,l.Ad)(t.averagePrice,t.currency,o.code)]);const n=Boolean(t.fragmentListedUrl&&t.fragmentListedCount),s=Boolean(t.listedCount&&t.listedCount);return{header:a,tableData:r,footer:(n||s)&&(0,v.FD)("div",{className:"OJDo2xUd",children:[n&&(0,v.FD)(U.A,{isText:!0,onClick:m,noForcedUpperCase:!0,size:"tiny",children:[o.number(t.fragmentListedCount),(0,v.Y)(ee.A,{className:ni,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnFragment")]}),s&&(0,v.FD)(U.A,{isText:!0,noForcedUpperCase:!0,size:"tiny",onClick:f,children:[o.number(t.listedCount),(0,v.Y)(ee.A,{className:ni,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnTelegram")]})]})}},[o,c,m,f]);if(p)return(0,v.Y)(ye.A,{isOpen:s,onClose:t,header:p.header,tableData:p.tableData,footer:p.footer})}),si=(0,a.ph)(({modal:e})=>{const{closeLockedGiftModal:t}=(0,r.ko)(),i=(0,M.A)(),n=(0,u.A)(()=>{t()}),o=(0,a.hb)(()=>{if(!e)return"";if(e.untilDate){const t=e.untilDate?e.untilDate-(0,Ye.Fm)():0;return i("GiftLockedMessage",{relativeDate:(0,z.A$)(i,t)},{withNodes:!0,withMarkdown:!0})}return e.reason?(0,_t.fd)(e.reason):i("TitleGiftLocked")},[e,i]);return(0,v.FD)(h.A,{isOpen:Boolean(e),className:"narrow",onClose:n,title:i("TitleGiftLocked"),headerClassName:"AqB1qB8W",children:[(0,v.Y)("p",{className:"pA8Bz4TW",children:o()}),(0,v.Y)(U.A,{onClick:n,children:i("OK")})]})});var li=i(40664);const ci=(0,a.ph)((0,r.EK)(e=>{const t=e.appConfig.starsStargiftResaleCommissionPermille,i=t?t/1e3:void 0,a=e.appConfig.starsStargiftResaleAmountMin||0,r=e.appConfig.starsStargiftResaleAmountMax,n=e.appConfig.starsUsdWithdrawRateX1000,o=n?n/1e3:1,s=e.appConfig.tonStargiftResaleCommissionPermille,c=s?s/1e3:0,d=(0,l.wD)(e.appConfig.tonStargiftResaleAmountMin||0),u=e.appConfig.tonStargiftResaleAmountMax;return{starsStargiftResaleCommissionPermille:i,starsStargiftResaleAmountMin:a,starsStargiftResaleAmountMax:r,starsUsdWithdrawRate:o,tonStargiftResaleCommissionPermille:c,tonStargiftResaleAmountMin:d,tonStargiftResaleAmountMax:u&&(0,l.wD)(u),tonUsdRate:e.appConfig.tonUsdRate}})(({modal:e,starsStargiftResaleCommissionPermille:t,starsStargiftResaleAmountMin:i,starsStargiftResaleAmountMax:n,starsUsdWithdrawRate:o,tonStargiftResaleCommissionPermille:s,tonStargiftResaleAmountMin:c,tonStargiftResaleAmountMax:m,tonUsdRate:f})=>{const{closeGiftResalePriceComposerModal:p,closeGiftInfoModal:g,updateStarGiftPrice:A,showNotification:b}=(0,r.ko)(),S=Boolean(e),[N,y]=(0,a.J0)(void 0),[C,G]=(0,a.J0)(!1),I=(0,d.A)(e),{gift:k}=I||{},Y=k&&"gift"in k?k:void 0,P=Boolean(N),B=(0,M.A)(),w=(0,u.A)(e=>{const t=e.target.value,i=parseFloat(t),a=C?m:n,r=""===t||Number.isNaN(i)?void 0:a?Math.min(i,a):i;y(r)}),T=(0,u.A)(()=>{p()}),D=(0,u.A)(()=>{Y&&"starGiftUnique"===Y.gift.type&&Y.inputGift&&N&&(p(),g(),A({gift:Y.inputGift,price:{currency:C?"TON":"XTR",amount:C?(0,l.tT)(N):N,nanos:0}}),b({icon:"sell-outline",message:{key:"NotificationGiftIsSale",variables:{gift:B("GiftUnique",{title:Y.gift.title,number:Y.gift.number})}}}))}),F=C?s:t,R=C?c:i,x=P&&N>=R;return(0,v.FD)(h.A,{isOpen:S,title:B(C?"PriceInTON":"PriceInStars"),hasCloseButton:!0,isSlim:!0,onClose:T,children:[(0,v.Y)("div",{className:"ElDo1Bru",children:(0,v.Y)(li.A,{label:B(C?"EnterPriceInTon":"EnterPriceInStars"),onChange:w,value:N?.toString(),inputMode:"numeric",tabIndex:0,teactExperimentControlled:!C})}),(0,v.FD)("div",{className:"SGFmA4kL",children:[(0,v.FD)("span",{children:[!x&&Boolean(F)&&B("DescriptionComposerGiftMinimumPrice",{stars:C?(0,pe.QH)(B,R):(0,pe.Kk)(B,R)},{withMarkdown:!0,withNodes:!0}),x&&(()=>{const e=F?Number((N*F).toFixed()):N;return B("DescriptionComposerGiftResalePrice",{stars:C?(0,pe.QH)(B,e):(0,pe.Kk)(B,e)},{withMarkdown:!0,withNodes:!0})})()]}),x&&Boolean(C?f:o)&&(0,v.Y)("span",{className:"r9R0VR_w",children:`≈ ${(0,l.Ad)(C?(0,l.C)(N,f):N*o,"USD",B.code)}`})]}),(0,v.Y)(Ee.A,{className:"yt_nODdj",label:B("OnlyAcceptTON"),checked:C,onCheck:G}),(0,v.Y)("div",{className:"pWjQiY4m",children:B("OnlyAcceptTONDescription")}),(0,v.FD)(U.A,{noForcedUpperCase:!0,disabled:!x,onClick:D,children:[x&&B("ButtonSellGift",{stars:C?(0,pe.Ms)(B,N):(0,pe.U2)(B,N,{asFont:!0})},{withNodes:!0}),!x&&B("Sell")]})]})}));var di=i(58554),ui=i(32625),mi=i(61361),fi=i(5463);const pi={footer:"EWaVCxY4",footerButton:"_Dt6RSQV",link:"Xu0TqkRj",priceDecreaseTimer:"ryB8xKvy"},hi=(0,a.ph)((0,r.EK)((e,{modal:t})=>{const i=t?.recipientId;return{recipient:i?(0,o.PVB)(e,i):void 0}})(({modal:e,recipient:t})=>{const{closeGiftUpgradeModal:i,closeGiftInfoModal:o,upgradeGift:s,upgradePrepaidGift:l,openStarGiftPriceDecreaseInfoModal:c,shiftGiftUpgradeNextPrice:m}=(0,r.ko)(),f=Boolean(e),p=(0,d.A)(e),h=(0,d.A)(t),[g,A]=(0,a.J0)(!1),b=Boolean(p?.gift?.prepaidUpgradeHash),[S,N]=(0,a.J0)(),y=(0,M.A)(),G=(0,u.A)(()=>i()),I=(0,u.A)(()=>{m()}),k=p?.nextPrices?.[0],Y=k?.date,P=p?.currentUpgradeStars,B=(0,u.A)(()=>{const e=p?.gift;if(e){if(b&&e.prepaidUpgradeHash&&h){if(!P)return;return l({peerId:h.id,hash:e.prepaidUpgradeHash,stars:P}),G(),void o()}e?.inputGift&&(s({gift:e.inputGift,shouldKeepOriginalDetails:g,upgradeStars:e.alreadyPaidUpgradeStars?void 0:P}),G())}}),w=(0,u.A)(()=>{p?.sampleAttributes&&N(function(e,t){const i=e.filter(e=>"model"===e.type&&e.name!==t?.model.name),a=e.filter(e=>"pattern"===e.type&&e.name!==t?.pattern.name),r=e.filter(e=>"backdrop"===e.type&&e.name!==t?.backdrop.name);return{model:i[Math.floor(Math.random()*i.length)],pattern:a[Math.floor(Math.random()*a.length)],backdrop:r[Math.floor(Math.random()*r.length)]}}(p.sampleAttributes,S))}),T=(0,u.A)(()=>{p?.prices&&c({prices:p.prices,currentPrice:P||0,minPrice:p.minPrice||0,maxPrice:p.maxPrice||0})});(0,ui.A)(w,f?3e3:void 0,!0),(0,a.vJ)(()=>{f&&p?.sampleAttributes&&w()},[f,p?.sampleAttributes]),(0,a.vJ)(()=>{const e=p?.sampleAttributes;e&&[...e.filter(e=>"pattern"===e.type).map(e=>e.sticker),...e.filter(e=>"model"===e.type).map(e=>e.sticker)].map(e=>(0,C.Mw)(e,"full")).forEach(e=>{(0,di.hd)(e,lt.qZ.BlobUrl)})},[p?.sampleAttributes]);const D=(0,a.Kr)(()=>P?(0,v.FD)("span",{children:[(0,v.Y)(F.A,{name:"star",className:"star-amount-icon"}),(0,v.Y)(Qe.A,{text:y.number(P)})]}):void 0,[y,P]),R=(0,a.Kr)(()=>{if(!S||!f)return;const e=p?.gift,t=h?(0,n.F9)(y,h):y("ActionFallbackUser"),i=h?[["diamond",y("GiftUpgradeUniqueTitle"),y("GiftPeerUpgradeUniqueDescription",{user:t})],["trade",y("GiftUpgradeTransferableTitle"),y("GiftPeerUpgradeTransferableDescription",{user:t})],["auction",y("GiftUpgradeTradeableTitle"),y("GiftPeerUpgradeTradeableDescription",{user:t})]]:[["diamond",y("GiftUpgradeUniqueTitle"),y("GiftUpgradeUniqueDescription")],["trade",y("GiftUpgradeTransferableTitle"),y("GiftUpgradeTransferableDescription")],["auction",y("GiftUpgradeTradeableTitle"),y("GiftUpgradeTradeableDescription")]],a=h?y("GiftPeerUpgradeText",{peer:(0,n.F9)(y,h)}):y("GiftUpgradeTextOwn"),r=Boolean(Y)&&Boolean(p?.prices?.length)&&!e?.alreadyPaidUpgradeStars;return{listItemData:i,header:(0,v.Y)(Me,{modelAttribute:S.model,backdropAttribute:S.backdrop,patternAttribute:S.pattern,title:y("GiftUpgradeTitle"),subtitle:a}),footer:(0,v.FD)("div",{className:pi.footer,children:[!e&&(0,v.Y)(U.A,{className:pi.footerButton,onClick:G,children:y("OK")}),e&&(0,v.FD)(v.FK,{children:[!b&&(0,v.Y)(Ee.A,{label:y("GiftUpgradeKeepDetails"),onCheck:A,checked:g}),(0,v.Y)(U.A,{className:pi.footerButton,isShiny:!0,onClick:B,children:(0,v.FD)("div",{className:pi.buttonContent,children:[(0,v.Y)("div",{children:e.alreadyPaidUpgradeStars?y("GeneralConfirm"):y(b?"GiftPayForUpgradeButton":"GiftUpgradeButton",{amount:D},{withNodes:!0})}),r&&(0,v.Y)("div",{className:pi.priceDecreaseTimer,children:y("StarGiftPriceDecreaseTimer",{timer:(0,v.Y)(mi.A,{endsAt:Y,onEnd:I})},{withNodes:!0})})]})}),r&&(0,v.Y)(mt.A,{className:pi.link,isPrimary:!0,onClick:T,children:y("StarGiftPriceDecreaseInfoLink")})]})]})}},[S,f,y,h,p?.gift,g,b,p?.prices?.length,Y,D]);return(0,v.Y)(fi.A,{isOpen:f,header:R?.header,footer:R?.footer,listItemData:R?.listItemData,hasBackdrop:!0,onClose:G})})),gi=(0,a.ph)(({modal:e})=>{const{closeStarGiftPriceDecreaseInfoModal:t}=(0,r.ko)(),i=(0,M.A)(),n=Boolean(e),o=(0,d.A)(e),l=(0,u.A)(()=>{t()}),c=(0,a.Kr)(()=>{if(!o)return;const{prices:e}=o;return e.map(e=>[(0,z.L2)(1e3*e.date,i.code,!0,void 0,!0),(0,pe.U2)(i,e.upgradeStars,{containerClassName:"NEElQBO6"})])},[i,o]),m=(0,a.Kr)(()=>{if(n)return(0,v.FD)("div",{className:"OXLUuiYb",children:[(0,v.Y)("p",{className:"TWuxZcHO",children:i("UpgradeCostDrops")}),(0,v.Y)(U.A,{onClick:l,iconName:"understood",iconClassName:"QJryEH9W",children:i("ButtonUnderstood")})]})},[i,n,l]);if(!c||!o)return;const{currentPrice:f,minPrice:p,maxPrice:h}=o,g=h!==p?(f-p)/(h-p):0,A=(0,v.FD)("div",{className:"ETFjTQkC",children:[(0,v.Y)(dt.A,{leftText:(0,pe.Kk)(i,h),rightText:(0,pe.Kk)(i,p),floatingBadgeText:(0,pe.Kk)(i,f),floatingBadgeIcon:"star",progress:g,isInverted:!0,shouldSkipGradient:!0,className:"DJPf4ekd"}),(0,v.Y)("p",{className:"JKYZ8cFl",children:i("StarGiftUpgradeCostModalTitle")}),(0,v.Y)("p",{className:"wHxufgix",children:i("StarGiftUpgradeCostHint")})]});return(0,v.Y)(ye.A,{isOpen:n,onClose:l,header:A,tableData:c,tableClassName:(0,s.A)("WuL_UIYd","custom-scroll"),footer:m})});var Ai=i(45294);const bi=7*T.$,Si=(0,a.ph)((0,r.EK)(e=>({currentUser:(0,o.mBe)(e,e.currentUserId),isCurrentUserPremium:(0,o.g29)(e)}))(({modal:e,currentUser:t,isCurrentUserPremium:i})=>{const{closeGiftStatusInfoModal:n,setEmojiStatus:o}=(0,r.ko)(),l=(0,M.A)(),{isMobile:c}=(0,ke.Ay)(),m=Boolean(e),p=(0,d.A)(e),{emojiStatus:h}=p||{},g=h?.textColor,A=(0,Ai.A)(h?.patternDocumentId),b=(0,u.A)(()=>{n()}),S=(0,u.A)(()=>{h&&o({emojiStatus:h}),n()}),N=(0,a.Kr)(()=>{if(!h||!m)return;const e=[h.centerColor,h.edgeColor];return(0,v.Y)(te.A,{className:"_1RfhkfB",backgroundColors:e,patternIcon:A.customEmoji,yPosition:6.875*T.$,maxRadius:.31,patternSize:c?13:15,ovalFactor:1})},[h,m,c,A]),y=(0,a.Kr)(()=>({...t,emojiStatus:h}),[t,h]),C=(0,a.Kr)(()=>(0,v.FD)("div",{className:"qL0cHbwS",children:[(0,v.FD)("div",{className:(0,s.A)("t18QCmAb"),style:(0,Ge.A)(g&&`color: ${g}`),children:[N,(0,v.Y)(f.A,{peer:y,size:bi,className:"JK2zOWA7"}),(0,v.Y)(Ve.A,{peer:y,className:"lxxbgNCl",withEmojiStatus:!0,noFake:!0,noVerified:!0}),(0,v.Y)("p",{className:"MLMdxkUg",style:(0,Ge.A)(g&&`color: ${g}`),children:l("Online")})]}),(0,v.Y)("div",{className:"wxg_5ou_",children:l("UniqueStatusWearTitle",{gift:y?.emojiStatus?.title})}),(0,v.Y)("div",{className:"KSCLIMZm",children:l("UniqueStatusBenefitsDescription")})]}),[g,N,y,l]),G=[["radial-badge",l("UniqueStatusBadgeBenefitTitle"),l("UniqueStatusBadgeDescription")],["unique-profile",l("UniqueStatusProfileDesignBenefitTitle"),l("UniqueStatusProfileDesignDescription")],["proof-of-ownership",l("UniqueStatusProofOfOwnershipBenefitTitle"),l("UniqueStatusProofOfOwnershipDescription")]],I=(0,a.Kr)(()=>{if(m)return(0,v.Y)("div",{className:"VDrvalBo",children:(0,v.FD)(U.A,{onClick:S,children:[l("UniqueStatusWearButton"),!i&&(0,v.Y)(F.A,{name:"lock-badge",className:"jiPObOWv"})]})})},[l,i,m]);return(0,v.Y)(fi.A,{isOpen:m,header:C,listItemData:G,footer:I,hasBackdrop:!0,onClose:b})}));var vi=i(21309),Ni=i(15535);const yi={header:"LQgz8Nlx",giftPreview:"hgs0ts_O",backdrop:"OnBhMaBw",description:"HBxB4QPY",arrow:"kXTOUpfb",noPassword:"BnqLhoKr"},Ci={isCustomPeer:!0,avatarIcon:"fragment",title:"",customPeerAvatarColor:"#000000"},Gi=4.5*T.$,Ii=(0,a.ph)((0,r.EK)(e=>{const{settings:{byKey:{hasPassword:t}},twoFaSettings:{hint:i}}=e;return{hasPassword:t,passwordHint:i}})(({modal:e,hasPassword:t,passwordHint:i})=>{const{closeGiftWithdrawModal:n,clearGiftWithdrawError:o,closeGiftInfoModal:s,processStarGiftWithdrawal:l,openSettingsScreen:c}=(0,r.ko)(),m=Boolean(e),[p,g]=(0,a.J0)(!1),A=(0,M.A)(),b=(0,d.A)(e),S=b?.gift?.gift,N=S&&(0,X.uc)(S),y=b?.gift?.canExportAt?Math.max(b.gift.canExportAt-(0,Ye.Fm)(),0):void 0,C=(0,u.A)(()=>{n()}),G=(0,u.A)(e=>{l({gift:b.gift.inputGift,password:e})}),I=(0,u.A)(()=>{c({screen:Se.VS.TwoFaDisabled}),n(),s()});return(0,v.FD)(h.A,{isOpen:m,title:A("GiftWithdrawTitle"),isCondensedHeader:!0,hasCloseButton:!0,isSlim:!0,onClose:C,children:[N&&(0,v.FD)(v.FK,{children:[(0,v.FD)("div",{className:yi.header,children:[(0,v.FD)("div",{className:yi.giftPreview,children:[(0,v.Y)(te.A,{className:yi.backdrop,backgroundColors:[N.backdrop.centerColor,N.backdrop.edgeColor],patternIcon:N.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,v.Y)(ee.A,{className:yi.sticker,size:Gi,sticker:N.model?.sticker})]}),(0,v.Y)(F.A,{name:"next",className:yi.arrow}),(0,v.Y)(f.A,{peer:Ci,size:"giant",className:yi.avatar})]}),(0,v.Y)("p",{className:yi.description,children:A("GiftWithdrawDescription",{gift:`${S.title} #${S.number}`},{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]})})]}),Boolean(y)&&(0,v.Y)("p",{className:yi.exportHint,children:A("GiftWithdrawWait",{days:(0,vi._k)(y)},{pluralValue:(0,vi._k)(y)})}),!t&&(0,v.FD)(v.FK,{children:[(0,v.Y)("span",{className:yi.noPassword,children:A("ErrorPasswordMissing")}),(0,v.Y)(U.A,{className:"mt-2",onClick:I,children:A("SetUp2FA")})]}),t&&!y&&(0,v.Y)(Ni.A,{shouldShowSubmit:!0,placeholder:A("CheckPasswordPlaceholder"),error:b?.errorKey&&A.withRegular(b?.errorKey),description:A("CheckPasswordDescription"),onClearError:o,isLoading:b?.isLoading,hint:i,isPasswordVisible:p,shouldResetValue:m,onChangePasswordVisibility:g,submitLabel:A("GiftWithdrawSubmit"),onSubmit:G})]})}));var ki=i(79824),Yi=i(74984),Pi=i(4875),Bi=i(56863),wi=i(30857),Ti=i(84080),Di=i(56133),Mi=i(35297);function Fi(){}async function Ui(e){const t=await(0,Pi.px)("searchChats",{query:e});if(t)return[...t.accountResultIds,...t.globalResultIds]}const Ri=(0,a.ph)((0,r.EK)(e=>{const{contactList:t,currentUserId:i}=e;return{contactIds:t?.userIds,currentUserId:i}})(({modal:e,contactIds:t,currentUserId:i})=>{const{closeGiftTransferModal:n,openGiftWithdrawModal:s,openGiftTransferConfirmModal:l}=(0,r.ko)(),c=Boolean(e),m=(0,M.A)(),[f,p]=(0,a.J0)(""),h=(0,d.A)(e),g=(0,Yi.Rh)(y.DSF),A=(0,a.Kr)(()=>(0,G.Am)([...t||[],...g||[]]),[t,g]),{result:b,currentResultsQuery:S}=function({query:e,queryFn:t=Ui,defaultValue:i,debounceTimeout:r=300,isDisabled:n}){const o=function(e,t,i){const[r,n]=(0,a.J0)(),{isFrozen:o,updateWhenUnfrozen:s}=function(){const e=(0,a.li)(!1),t=(0,a.hb)(()=>{e.current=!0},[]),i=(0,wi.A)(),r=(0,a.hb)(()=>{e.current&&(e.current=!1,i())},[i]);return(0,Ti.Ay)(Fi,r),{isFrozen:(0,a.OV)(),updateWhenUnfrozen:t}}(),l=(0,Di.A)(t,!0);return(0,Mi.A)(()=>{o?s():l(()=>{n(e())})},[...i,o]),r}(()=>e,r,[e]),[s,l]=(0,a.J0)(""),c=e?o:e,d=(0,u.A)(t);return{...(0,Bi.A)(async()=>{if(!c||n)return l(""),Promise.resolve(i);const e=await d(c);return l(c),e},[c,i,d,n],i),currentResultsQuery:s}}({query:f,defaultValue:A}),N=S!==f,C=(0,a.Kr)(()=>S?ki.p:[{type:"withdraw",isCustomPeer:!0,avatarIcon:"toncoin",peerColorId:5,title:m("GiftTransferTON")}],[m,S]),P=(0,u.A)(e=>{"withdraw"===e&&(s({gift:h.gift}),n())}),B=(0,a.Kr)(()=>{if(N)return ki.p;const e=(0,r.mS)();return(0,I.A)((b||[]).filter(t=>t!==i&&(0,o.X2D)(e,t)),!1)},[N,b,i]),w=(0,u.A)(e=>{h?.gift&&l({gift:h.gift,recipientId:e})});return(0,v.Y)(Y.A,{isOpen:c,onClose:n,title:m("GiftTransferTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,ignoreFreeze:!0,children:(0,v.Y)(k.A,{itemIds:B,categories:C,onSelectedCategoryChange:P,withDefaultPadding:!0,withPeerUsernames:!0,isSearchable:!0,noScrollRestore:!0,isLoading:N,filterValue:f,filterPlaceholder:m("Search"),onFilterChange:p,onSelectedIdChange:w})})})),xi=(0,a.ph)((0,r.EK)((e,{modal:t})=>({selectedPeer:t?.recipientId?(0,o.PVB)(e,t.recipientId):void 0}))(({modal:e,selectedPeer:t})=>{const{closeGiftTransferConfirmModal:i,transferGift:a,openChat:o,closeGiftModal:s,closeGiftTransferModal:l}=(0,r.ko)(),c=(0,M.A)(),m=Boolean(e),f=(0,d.A)(e),p=(0,d.A)(t),h=(0,u.A)(()=>{f?.gift.inputGift&&f.recipientId&&(a({gift:f.gift.inputGift,recipientId:f.recipientId,transferStars:f.gift.transferStars}),i(),o({id:f.recipientId}),s(),l())});if(!f)return;const{gift:g}=f,A="starGiftUnique"===g.gift.type?g.gift:void 0;return A?(0,v.FD)(ii.A,{isOpen:m,noDefaultTitle:!0,onClose:i,confirmLabel:g.transferStars?c("GiftTransferConfirmButton",{amount:(0,pe.U2)(c,g.transferStars,{asFont:!0})},{withNodes:!0}):c("GiftTransferConfirmButtonFree"),confirmHandler:h,children:[p&&(0,v.Y)(ti,{peer:p,gift:A}),(0,v.Y)("p",{children:g.transferStars?c("GiftTransferConfirmDescription",{gift:c("GiftUnique",{title:A.title,number:A.number}),amount:(0,pe.Kk)(c,g.transferStars),peer:(0,n.F9)(c,p)},{withNodes:!0,withMarkdown:!0}):c("GiftTransferConfirmDescriptionFree",{gift:c("GiftUnique",{title:A.title,number:A.number}),peer:(0,n.F9)(c,p)},{withNodes:!0,withMarkdown:!0})})]}):void 0})),Oi=(0,a.ph)((0,r.EK)((e,{modal:t})=>({senderPeer:t?.details.senderId?(0,o.PVB)(e,t.details.senderId):void 0,recipientPeer:t?.details.recipientId?(0,o.PVB)(e,t.details.recipientId):void 0}))(({modal:e,senderPeer:t,recipientPeer:i})=>{const{closeGiftDescriptionRemoveModal:a,removeGiftDescription:n,openChat:o}=(0,r.ko)(),s=(0,M.A)(),l=Boolean(e),c=(0,d.A)(e),m=(0,d.A)(t),f=(0,d.A)(i),p=(0,u.A)(e=>{a(),o({id:e})}),h=(0,u.A)(()=>{c?.gift.inputGift&&c.price&&n({gift:c.gift.inputGift,price:c.price})});if(!c||!f)return;const{price:g,details:A}=c,b=Qt({originalDetails:A,recipient:f,sender:m,onOpenChat:p,lang:s});return(0,v.FD)(ii.A,{isOpen:l,title:s("RemoveGiftDescriptionTitle"),onClose:a,confirmLabel:s("RemoveGiftDescriptionButton",{amount:(0,pe.U2)(s,g,{asFont:!0})},{withNodes:!0}),confirmHandler:h,children:[(0,v.Y)("div",{className:"LVOpBXUW",children:s("RemoveGiftDescriptionConfirmText")}),Boolean(b)&&(0,v.Y)("div",{className:"FA1_yVBY",children:b})]})})),Li=(0,a.ph)((0,r.EK)((e,{modal:t})=>({user:t?.userId?(0,o.mBe)(e,t.userId):void 0}))(({modal:e,user:t})=>{const{closeChatRefundModal:i,toggleNoPaidMessagesException:o}=(0,r.ko)(),[s,l]=(0,a.J0)(!1),c=(0,d.A)(e),m=(0,d.A)(t),{starsToRefund:f,userId:p}=c||{},h=(0,M.A)(),g=Boolean(e),A=(0,u.A)(()=>{i(),p&&o({userId:p,shouldRefundCharged:s})});return(0,v.FD)(ii.A,{isOpen:g,onClose:i,title:h("RemoveFeeTitle"),confirmLabel:h("ConfirmRemoveMessageFee"),confirmHandler:A,children:[h("ConfirmDialogMessageRemoveFee",{peer:m&&(0,n.F9)(h,m)},{withMarkdown:!0,withNodes:!0}),Boolean(f)&&(0,v.Y)(Ee.A,{className:"dialog-checkbox",label:h("ConfirmDialogRemoveFeeRefundStars",{amount:(0,pe.Kk)(h,f)},{withMarkdown:!0,withNodes:!0}),checked:s,onCheck:l})]})}));var Ki=i(14487);const qi=(0,a.ph)((0,r.EK)(e=>{const t=e.stars?.balance,i=e.ton?.balance?.amount;return{starBalance:t,tonBalance:i}})(({modal:e,starBalance:t,tonBalance:i})=>{const n=(0,r.ko)(),o=(0,M.A)(),s=(0,a.hb)(()=>{if(!e?.directInfo)return void n.closePriceConfirmModal();const{currency:a,newAmount:r}=e,o="TON"===a,s=o?i:t?.amount;if(void 0!==s){if(s<r)return n.openStarsBalanceModal({currency:o?"TON":"XTR",tabId:(0,Ki.g0)()}),void n.closePriceConfirmModal();n.sendStarPaymentForm({directInfo:e.directInfo,tabId:(0,Ki.g0)()}),n.closePriceConfirmModal()}else n.closePriceConfirmModal()},[e,t,i,n]),c=(0,a.hb)(()=>{n.closePriceConfirmModal()},[n]);if(!e)return;const{originalAmount:d,newAmount:u,currency:m}=e;let f,p;return"TON"===m?(f=(0,pe.QH)(o,(0,l.wD)(d)),p=(0,pe.QH)(o,(0,l.wD)(u))):(f=(0,pe.Kk)(o,d),p=(0,pe.Kk)(o,u)),(0,v.Y)(ii.A,{isOpen:Boolean(e),onClose:c,title:o("PriceChanged"),confirmHandler:s,confirmLabel:o("PayNewPrice"),children:(0,v.Y)("p",{children:o("PriceChangedText",{originalAmount:f,newAmount:p},{withMarkdown:!0,withNodes:!0})})})}))}}]);
//# sourceMappingURL=6930.df2d93ee8c1cde666986.js.map