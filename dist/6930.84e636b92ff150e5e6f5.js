"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[6930],{22401:(e,t,a)=>{a.r(t),a.d(t,{ChatRefundModal:()=>Ba,GiftInfoModal:()=>ea,GiftInfoValueModal:()=>aa,GiftModal:()=>qt,GiftRecipientPicker:()=>zt,GiftResalePriceComposerModal:()=>ra,GiftStatusInfoModal:()=>ua,GiftTransferModal:()=>Pa,GiftUpgradeModal:()=>ca,GiftWithdrawModal:()=>Aa,PaidReactionModal:()=>at,PriceConfirmModal:()=>Ta,StarPaymentModal:()=>ge,StarsBalanceModal:()=>ue,StarsGiftModal:()=>y,StarsGiftingPickerModal:()=>B,StarsSubscriptionModal:()=>xe,StarsTransactionInfoModal:()=>Fe});var i=a(84051),r=a(13439),n=a(70636),o=a(91048),s=a(87357),l=a(17142),c=a(4961),d=a(14),u=a(17712),m=a(59030),p=a(21849),f=a(18276),h=a(84685),g=a(64493),A=a(22337),b=a(1526);const S={modalDialog:"MFXAwnxJ",content:"Sl6xVf1R",main:"bTN9Jeph",headerInfo:"c6MiyJgW",logo:"StGLWvzb",logoBackground:"SyTXSfml",description:"kFe3mIZo",section:"BgfHkWd2",header:"zMtAGfXs",starHeaderText:"q3v8orGj",hiddenHeader:"bq3FnXT0",closeButton:"bDsDTkbe",avatar:"jK36xUj4",center:"v1PckUQn",secondaryInfo:"TDWSRfP9"},v=a.p+"GoldStar.fb6812e915ddfe27f504.svg",N=a.p+"stars-bg.dee4c4b73c7d21c2ec73.png";var C=a(20021);const y=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;return{user:a?.forUserId?(0,o.mBe)(e,a.forUserId):void 0}})(e=>{let{modal:t,user:a}=e;const{closeStarsGiftModal:o,openInvoice:y,requestConfetti:I}=(0,r.ko)(),k=(0,i.li)(),G=Boolean(t?.isOpen),Y=(0,d.A)(t),w=(0,m.A)(),[P,B]=(0,i.J0)(),[M,T]=(0,i.J0)(!0);(0,i.vJ)(()=>{G||T(!0)},[G]);const D=(0,u.A)(()=>{const e=k.current;if(e&&G){const{top:t,left:a,width:i,height:r}=e.querySelector(".modal-content").getBoundingClientRect();I({top:t,left:a,width:i,height:r,withStars:!0})}});(0,i.vJ)(()=>{Y?.isCompleted&&D()},[Y,D]);const F=(0,u.A)(e=>{Y&&(B(e),y(a?{type:"starsgift",userId:a.id,stars:e.stars,currency:e.currency,amount:e.amount}:{type:"stars",stars:e.stars,currency:e.currency,amount:e.amount}))}),U=(0,u.A)(()=>{o()}),R=(0,i.Kr)(()=>{const e=w("lng_credits_summary_options_about").split("{link}");return[e[0],(0,C.Y)(h.A,{url:w("StarsTOSLink"),text:w("lng_credits_summary_options_about_link")}),e[1]]},[w]);return(0,C.Y)(A.A,{className:(0,s.A)(S.modalDialog),contentClassName:S.content,dialogRef:k,isSlim:!0,onClose:U,isOpen:G,children:(0,C.FD)("div",{className:(0,s.A)(S.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;T(t<=150)},children:[(0,C.Y)(g.A,{round:!0,size:"smaller",className:S.closeButton,color:"translucent",onClick:()=>o(),ariaLabel:w("Close"),children:(0,C.Y)(f.A,{name:"close"})}),(0,C.Y)("div",{className:(0,s.A)(S.header,M&&S.hiddenHeader),children:(0,C.Y)("h2",{className:S.starHeaderText,children:w(a?"GiftStarsTitle":"Star.List.GetStars")})}),(0,C.Y)("div",{className:S.headerInfo,children:a?(0,C.FD)(C.FK,{children:[(0,C.Y)(p.A,{size:100,peer:a,className:S.avatar}),(0,C.Y)("img",{className:S.logoBackground,src:N,alt:"",draggable:!1})]}):(0,C.FD)(C.FK,{children:[(0,C.Y)("img",{className:S.logo,src:v,alt:"",draggable:!1}),(0,C.Y)("img",{className:S.logoBackground,src:N,alt:"",draggable:!1})]})}),(0,C.Y)("h2",{className:(0,s.A)(S.headerText,S.center),children:Y?.isCompleted?a?(0,c.A)(w("Notification.StarsGift.SentYou",(0,l.Ad)(P.amount,P.currency,w.code)),["simple_markdown"]):(0,c.A)(w("StarsAcquiredInfo",P?.stars),["simple_markdown"]):w(a?"GiftStarsTitle":"Star.List.GetStars")}),(0,C.Y)("p",{className:S.description,children:a?(0,c.A)(w("ActionGiftStarsSubtitle",(0,n.F9)(w,a)),["simple_markdown"]):w("Stars.Purchase.GetStarsInfo")}),(0,C.FD)("div",{className:S.section,children:[(0,C.Y)(b.A,{options:Y?.starsGiftOptions,onClick:F}),(0,C.Y)("div",{className:S.secondaryInfo,children:R})]})]})})}));var I=a(31481),k=a(90709),G=a(87894),Y=a(79582),w=a(54960),P=a(34642);const B=(0,i.ph)((0,r.EK)(e=>{const{chats:{listIds:t},currentUserId:a}=e;return{userIds:e.contactList?.userIds,activeListIds:t.active,archivedListIds:t.archived,currentUserId:a}})(e=>{let{isOpen:t,currentUserId:a,activeListIds:o,archivedListIds:s,userIds:l}=e;const{closeStarsGiftingPickerModal:c,openStarsGiftModal:d}=(0,r.ko)(),p=(0,m.A)(),[f,h]=(0,i.J0)(""),g=(0,i.Kr)(()=>{const e=(0,r.mS)().users.byId,t=(0,G.Am)([...l||[],...o||[],...s||[]]),i=(0,n.PU)({ids:t,query:f,type:"user"});return(0,Y.A)(i.filter(t=>{const i=e[t];return!(!i||i.isSupport||(0,k.tv)(i)||(0,k.PL)(i)||t===a||t===I.zv8)}))},[a,f,l,o,s]),A=(0,u.A)(e=>{e?.length&&(d({forUserId:e}),c())});return(0,C.Y)(P.A,{className:"s3k01dTm",isOpen:t,onClose:c,title:p("GiftStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:p("Continue"),onEnter:c,children:(0,C.Y)(w.A,{className:"cuI2eDIY",itemIds:g,filterValue:f,filterPlaceholder:p("Search"),onFilterChange:h,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,onSelectedIdChange:A})})}));var M=a(30708),T=a(31460),D=a(37661),F=a(39351),U=a(46222),R=a(24680),x=a(41036),O=a(38777),L=a(86046),K=a(81949),V=a(9267);const E={root:"TtE8LQNJ",minimal:"nkV4JXHc",transition:"nXQS4E59",main:"JuWZY1ds",container:"mnhBs1uK",section:"lYkNd_gb",lastSection:"f749AI4g",sectionTitle:"FF8gm7MP",hint:"Rs8WXoOz",tos:"Vu6blJk9",topUpButton:"dc_DZoVF",tonBalanceContainer:"lorbW9II",tonBalance:"h2Fs3tOv",tonIconBalance:"Ut6GidJP",tonInUsd:"FdcdsB4l",tonIconLogo:"_hCjjyEv",description:"teXilLxe",header:"fnhXotO2",starHeaderText:"iUwego5s",botItem:"AhxcrKWn",hiddenHeader:"DZk6d6hF",closeButton:"piD1PXHW",addStarsButton:"dqnGL2uh",addStarsIcon:"w9Db2eiK",balanceBlock:"Yk0OQBKC",balanceInfo:"p2dW9NOV",smallerText:"rUnPcfmE",balanceBottom:"F5BTkZ9G",modalBalance:"t8tMrx3y",starButton:"oOt4VBD2",paymentContent:"OReEUNTV",paymentImages:"oKorQYTC",paymentPhoto:"HGTrEtUF",avatarStar:"Wu10dXoa",paymentImageBackground:"os8jb_qv",paymentButton:"VzR5cibf",paymentButtonStar:"Uhg7yWxK",transactions:"Qvc0fTTH",subscriptions:"IX5BhCUF",tabs:"KZVEyKOX",disclaimer:"bpVifdwH",amountBadge:"BPM7LKwo",loadMore:"TKmZjMyd",loadMoreIcon:"buepwtN1"},q=(0,i.ph)(e=>{let{balance:t,className:a,withAddButton:i}=e;const n=(0,F.A)(),{openStarsBalanceModal:o}=(0,r.ko)();return(0,C.Y)("div",{className:(0,s.A)(E.balanceBlock,a),children:(0,C.FD)("div",{className:E.balanceInfo,children:[(0,C.Y)("span",{className:E.smallerText,children:n("StarsBalance")}),(0,C.Y)("div",{className:E.balanceBottom,children:t?.currency===I.ykW?(0,C.FD)(C.FK,{children:[(0,C.Y)(f.A,{name:"toncoin"}),void 0!==t?(0,l.UL)(t.amount,t.currency):"…"]}):(0,C.FD)(C.FK,{children:[(0,C.Y)(V.A,{type:"gold",size:"middle"}),void 0!==t&&t.currency===I.OUy?(0,L.ZF)(n,t):"…",i&&(0,C.Y)(K.A,{className:E.addStarsButton,onClick:()=>o({}),children:(0,C.Y)(f.A,{className:E.addStarsIcon,name:"add"})})]})})]})})});var z=a(17663),H=a(14242),J=a(63527);const W={root:"ZXnbeQxP",info:"zLaaDX3c",status:"HbF2qTB2",statusPricing:"AveGvpdV",amount:"_CBiOQcv",title:"k9ZIv5Pd",description:"FlRlxMx2",subtitle:"YN2J8dw6",statusPeriod:"MRrP7Oew",statusEnded:"pRHwfr8m",preview:"t6Syyhzd",subscriptionStar:"ftlbevPm"},_=(0,i.ph)(e=>{let{subscription:t}=e;const{openStarsSubscriptionModal:a}=(0,r.ko)(),{peerId:i,pricing:s,until:l,isCancelled:d,title:f,photo:h}=t,g=(0,m.A)(),A=(0,J.A)(function(e){return t=>(0,o.PVB)(t,e)}(i)),b=(0,u.A)(()=>{a({subscription:t})});if(!A)return;const S=l<Date.now()/1e3,v=(0,z.A)(1e3*l,g.code,!0,"long");return(0,C.FD)("div",{className:W.root,onClick:b,children:[(0,C.FD)("div",{className:W.preview,children:[(0,C.Y)(p.A,{size:"medium",peer:A}),(0,C.Y)(V.A,{className:W.subscriptionStar,type:"gold",size:"small"})]}),(0,C.FD)("div",{className:W.info,children:[(0,C.Y)("h3",{className:W.title,children:(0,c.A)((0,n.F9)(g,A)||"")}),f&&(0,C.FD)("p",{className:W.subtitle,children:[h&&(0,C.Y)(p.A,{webPhoto:h,size:"micro"}),(0,c.A)(f)]}),(0,C.Y)("p",{className:W.description,children:g(S?"StarsSubscriptionExpired":d?"StarsSubscriptionExpires":"StarsSubscriptionRenews",v)})]}),(0,C.Y)("div",{className:W.status,children:d||S?(0,C.Y)("div",{className:W.statusEnded,children:g(S?"StarsSubscriptionStatusExpired":"StarsSubscriptionStatusCancelled")}):(0,C.FD)(C.FK,{children:[(0,C.FD)("div",{className:W.statusPricing,children:[(0,C.Y)(V.A,{className:W.star,type:"gold",size:"adaptive"}),(0,C.Y)("span",{className:W.amount,children:(0,H.Sm)(s.amount)})]}),(0,C.Y)("div",{className:W.statusPeriod,children:g("StarsParticipantSubscriptionPerMonth")})]})})]})});var j=a(58968),Q=a(66833);function X(e,t,a){if(a.paidMessages)return t("PaidMessageTransaction",{count:a.paidMessages},{withNodes:!0,pluralValue:a.paidMessages});if(a.isGiftResale)return $(a.amount)?t("StarGiftSaleTransaction"):t("StarGiftPurchaseTransaction");if(a.isPostsSearch)return t("PostsSearchTransaction");if(a.starRefCommision)return e("StarTransactionCommission",(0,H.l9)(a.starRefCommision));if(a.isGiftUpgrade)return e("Gift2TransactionUpgraded");if(a.extendedMedia)return e("StarMediaPurchase");if(a.subscriptionPeriod)return a.title||e("StarSubscriptionPurchase");if(a.isReaction)return e("StarsReactionsSent");if(a.giveawayPostId)return e("StarsGiveawayPrizeReceived");if(a.isMyGift)return e("StarsGiftSent");if(a.isGift)return a.amount.currency===I.ykW?t("TonGiftReceived"):e("StarsGiftReceived");if(a.starGift)return $(a.amount)?e("Gift2TransactionSent"):e("Gift2ConvertedTitle");const i=a.peer&&(0,L.MA)(a)&&(0,L.Pc)(a)||void 0;return i?i.title||e(i.titleKey):a.title}function $(e){return e.currency===I.OUy?(t=e).amount?t.amount<0:t.nanos<0:e.amount<0;var t}var Z=a(79577),ee=a(40558),te=a(62587),ae=a(27860);const ie={root:"jQkp75Gb",preview:"OYGSN3PF",count:"KX1yz2Jy",thumb:"EvinKr5k",noOutline:"KSAAsUDv",itemCount1:"GxDajfX_",itemCount2:"jXuZoxq8",itemCount3:"TPn3XGHJ",blurry:"hWZuxLS8",full:"w56QPFhl",fadeIn:"ds43W8Wq"};function re(e){let{boughtMedia:t,index:a,className:i}=e;const r=t.video||t.photo,n=(0,k.VO)(r,"pictogram"),o=(0,k.VD)(r),l=(0,te.A)(n);return(0,C.FD)("div",{className:(0,s.A)(ie.thumb,void 0!==a&&`stars-transaction-media-${a}`,i),children:[o&&(0,C.Y)("img",{className:ie.blurry,src:o,alt:""}),l&&(0,C.Y)("img",{className:ie.full,src:l,alt:""})]})}const ne=(0,i.ph)(e=>{let{media:t,className:a,isTransactionPreview:i,onClick:r}=e;const n=Math.min(t.length,i?2:3),o="mediaType"in t[0];return(0,C.FD)("div",{className:(0,s.A)(ie.root,ie[`itemCount${n}`],i&&ie.preview,a),dir:"rtl",onClick:r,children:[t.slice(0,n).reverse().map((e,t,a)=>{const r=a.length-t-1;return"mediaType"in e?(0,C.Y)(ae.A,{className:ie.thumb,isVisible:!0,width:e.width,height:e.height,thumbDataUri:e.thumbnail?.dataUri}):(0,C.Y)(re,{className:(0,s.A)(i&&r>0&&ie.noOutline),boughtMedia:e,index:r})}),o&&(0,C.FD)("div",{className:ie.count,children:[(0,C.Y)(f.A,{name:"stars-lock"}),t.length>1?t.length:""]})]})}),oe={root:"aHAxv_Jg",info:"oyYrn3II",stars:"K5lc75ku",amount:"QLQPuLAr",title:"e0pK8CJ_",description:"xbERdDMQ",date:"l6CwQ0Ev",positive:"P_42_ZWR",negative:"TGjnLJfH",preview:"cnjGihOT",subscriptionStar:"z43YvnDX",uniqueGiftBackground:"eNvzMw2p",giftSticker:"U3dqmnM4"},se=(0,i.ph)(e=>{let{transaction:t,className:a}=e;const{openStarsTransactionModal:l}=(0,r.ko)(),{date:d,amount:h,photo:g,peer:A,extendedMedia:b,subscriptionPeriod:S}=t,v=(0,F.A)(),N=(0,m.A)(),y="peer"===A.type?A.id:void 0,k=(0,J.A)(function(e){return t=>e?(0,o.PVB)(t,e):void 0}(y)),G=t.starGift,Y="starGiftUnique"===G?.type,w=G&&(0,Q.yQ)(G),P=(0,i.Kr)(()=>{let e,a,i,r=X(N,v,t);if((0,L.MA)(t)){const a=(0,L.Pc)(t);r=a.title||N(a.titleKey),e=N(a.subtitleKey),i=a}else e=k&&(0,n.F9)(N,k),i=k||j.lw;return t.isGiftUpgrade&&"starGiftUnique"===t.starGift?.type&&(e=v("GiftUnique",{title:t.starGift.title,number:t.starGift.number})),t.isGiftResale&&"starGiftUnique"===t.starGift?.type&&(e=v("GiftUnique",{title:t.starGift.title,number:t.starGift.number})),t.isPostsSearch&&(r=X(N,v,t),e=void 0),t.photo&&(i=void 0),t.isRefund&&(a=N("StarsRefunded")),t.hasFailed&&(a=N("StarsFailed")),t.isPending&&(a=N("StarsPending")),{title:r,description:e,avatarPeer:i,status:a}},[N,v,k,t]),B=(0,i.Kr)(()=>{if(Y){const{backdrop:e}=(0,Q.uc)(G),t=[e.centerColor,e.edgeColor];return(0,C.FD)(C.FK,{children:[(0,C.Y)(ee.A,{className:oe.uniqueGiftBackground,backgroundColors:t}),(0,C.Y)(Z.A,{className:oe.giftSticker,sticker:w,size:36,play:!1})]})}return w?(0,C.Y)(Z.A,{className:oe.giftSticker,sticker:w,size:36,play:!1}):b?(0,C.Y)(ne,{media:b,isTransactionPreview:!0}):(0,C.FD)(C.FK,{children:[(0,C.Y)(p.A,{size:"medium",webPhoto:g,peer:P.avatarPeer}),Boolean(S)&&(0,C.Y)(V.A,{className:oe.subscriptionStar,type:"gold",size:"small"})]})},[Y,b,g,P.avatarPeer,S,G,w]),M=(0,u.A)(()=>{l({transaction:t})}),T=$(h)?oe.negative:oe.positive;return(0,C.FD)("div",{className:(0,s.A)(oe.root,a),onClick:M,children:[(0,C.Y)("div",{className:oe.preview,children:B}),(0,C.FD)("div",{className:oe.info,children:[(0,C.Y)("h3",{className:oe.title,children:P.title}),P.description&&(0,C.Y)("p",{className:oe.description,children:(0,c.A)(P.description)}),(0,C.FD)("p",{className:oe.date,children:[(0,z.L2)(1e3*d,N.code,!0),P.status&&` — (${P.status})`]})]}),(0,C.FD)("div",{className:oe.stars,children:[(0,C.Y)("span",{className:(0,s.A)(oe.amount,T),children:(0,L.hk)(v,h)}),h.currency===I.OUy&&(0,C.Y)(V.A,{className:oe.star,type:"gold",size:"adaptive"}),h.currency===I.ykW&&(0,C.Y)(f.A,{name:"toncoin",className:T})]})]})}),le=["all","inbound","outbound"],ce=["StarsTransactionsAll","StarsTransactionsIncoming","StarsTransactionsOutgoing"],de="StarsTransactionItem",ue=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;return{shouldForceHeight:a?.currency===I.ykW?Boolean(e.ton?.history?.all?.transactions.length):Boolean(e.stars?.history?.all?.transactions.length),starsBalanceState:e.stars,tonBalanceState:e.ton,canBuyPremium:!(0,o.n_C)(e),tonUsdRate:e.appConfig.tonUsdRate,tonTopupUrl:e.appConfig.tonTopupUrl,animationLevel:(0,M.l)(e).animationLevel}})(e=>{let{modal:t,starsBalanceState:a,tonBalanceState:d,canBuyPremium:p,shouldForceHeight:S,tonUsdRate:v,tonTopupUrl:N,animationLevel:y}=e;const{closeStarsBalanceModal:G,loadStarsTransactions:Y,loadStarsSubscriptions:w,openStarsGiftingPickerModal:P,openInvoice:B,openUrl:M}=(0,r.ko)(),L=t?.currency||I.OUy,K=L===I.ykW?d:a,{balance:V,history:z}=K||{},{subscriptions:H}=L===I.OUy&&a||{},J=(0,m.A)(),W=(0,F.A)(),[j,Q]=(0,i.J0)(!0),[X,$]=(0,i.J0)(0),[Z,ee,te]=(0,D.A)(),ae=Boolean(t&&(a||d)),{originStarsPayment:ie,originReaction:re,originGift:ne,topup:oe}=t||{},ue=ie||re||ne||oe,me=ie?.form?.invoice?.totalAmount||ie?.subscriptionInfo?.subscriptionPricing?.amount||re?.amount||ne?.gift.stars||oe?.balanceNeeded,pe=me?me-(V?.amount||0):void 0,fe=(0,i.Kr)(()=>{const e=(0,r.mS)();if(re){const t=(0,o.hds)(e,re.chatId);if(!t)return;return J("StarsNeededTextReactions",(0,k.Js)(J,t))}if(ie){const t=ie.form?.botId?(0,o.mBe)(e,ie.form.botId):void 0;if(!t)return;return J("StarsNeededText",(0,k.Yg)(t))}if(ne){const t=(0,o.mBe)(e,ne.peerId);if(!t)return;return J("StarsNeededTextGift",(0,n.F9)(W,t))}return"subs"===oe?.purpose?J("StarsNeededTextLink"):oe?.purpose===I.D3m?W("StarsNeededTextSendPaidMessages",void 0,{withMarkdown:!0,withNodes:!0}):void 0},[re,ie,ne,oe?.purpose,W,J]),he=Boolean(z?.all?.transactions.length&&!ue),ge=!ue,Ae=(0,i.Kr)(()=>{const e=z?.all?.transactions.length||0;return 1===e?"35.5rem":2===e?"39.25rem":3===e?"43rem":"45rem"},[z?.all?.transactions.length]),be=(0,i.Kr)(()=>ce.map(e=>({title:W(e)})),[W]);(0,i.vJ)(()=>{ae||(Q(!0),$(0),te())},[ae]),(0,i.vJ)(()=>{ue?ee():te()},[ue]);const Se=(0,i.Kr)(()=>{if(!ae)return;const e=J("lng_credits_summary_options_about").split("{link}");return[e[0],(0,C.Y)(h.A,{url:J("StarsTOSLink"),text:J("lng_credits_summary_options_about_link")}),e[1]]},[ae,J]),ve=(0,u.A)(()=>{Y({type:le[X],isTon:L===I.ykW})}),Ne=(0,u.A)(()=>{w()}),Ce=(0,u.A)(()=>{P({})}),ye=(0,u.A)(e=>{B({type:"stars",stars:e.stars,currency:e.currency,amount:e.amount})}),Ie=(0,u.A)(()=>{M({url:N})});return(0,C.Y)(A.A,{className:(0,s.A)(E.root,!S&&!Z&&E.minimal),isOpen:ae,onClose:G,dialogStyle:`--modal-height: ${Ae}`,children:(0,C.FD)("div",{className:(0,s.A)(E.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;Q(t<=150)},children:[(0,C.Y)(g.A,{round:!0,size:"smaller",className:E.closeButton,color:"translucent",onClick:()=>G(),ariaLabel:W("Close"),children:(0,C.Y)(f.A,{name:"close"})}),L!==I.ykW&&(0,C.Y)(q,{balance:V,className:E.modalBalance}),(0,C.Y)("div",{className:(0,s.A)(E.header,j&&E.hiddenHeader),children:(0,C.Y)("h2",{className:E.starHeaderText,children:J("TelegramStars")})}),(0,C.Y)("div",{className:E.section,children:L===I.ykW?(()=>{const e=(0,l.UL)(V?.amount||0,I.ykW);return(0,C.FD)(C.FK,{children:[(0,C.Y)(O.A,{model:"speeding-diamond",color:"blue",title:W("CurrencyTon"),description:W("DescriptionAboutTon"),isDisabled:!ae}),(0,C.FD)("div",{className:E.tonBalanceContainer,children:[(0,C.FD)("div",{className:E.tonBalance,children:[(0,C.Y)(f.A,{name:"toncoin",className:E.tonIconBalance}),e]}),Boolean(v)&&(0,C.Y)("span",{className:E.tonInUsd,children:`≈ ${(0,l.Ad)((0,l.C)(V?.amount||0,v,!0),"USD",W.code)}`})]}),(0,C.Y)(g.A,{className:E.topUpButton,onClick:Ie,fluid:!0,children:W("ButtonTopUpViaFragment")})]})})():(0,C.FD)(C.FK,{children:[(0,C.Y)(O.A,{model:"swaying-star",color:"gold",title:pe?J("StarsNeededTitle",me):J("TelegramStars"),description:(0,c.A)(fe||J("TelegramStarsInfo"),["simple_markdown","emoji"]),isDisabled:!ae}),p&&!Z&&(0,C.Y)(g.A,{className:E.starButton,onClick:ee,fluid:!0,children:J("Star.List.BuyMoreStars")}),p&&!Z&&ge&&(0,C.Y)(g.A,{isText:!0,noForcedUpperCase:!0,className:E.starButton,fluid:!0,onClick:Ce,children:J("TelegramStarsGift")}),Z&&a?.topupOptions&&(0,C.Y)(b.A,{starsNeeded:pe,options:a.topupOptions,onClick:ye})]})}),Z&&(0,C.Y)("div",{className:E.tos,children:Se}),L===I.ykW&&(0,C.Y)("div",{className:E.hint,children:W("TonModalHint")}),he&&Boolean(H?.list.length)&&(0,C.FD)("div",{className:E.section,children:[(0,C.Y)("h3",{className:E.sectionTitle,children:J("StarMySubscriptions")}),(0,C.FD)("div",{className:E.subscriptions,children:[H?.list.map(e=>(0,C.Y)(_,{subscription:e},e.id)),H?.nextOffset&&(0,C.FD)(g.A,{isText:!0,disabled:H.isLoading,size:"smaller",noForcedUpperCase:!0,className:E.loadMore,onClick:Ne,children:[(0,C.Y)(f.A,{name:"down",className:E.loadMoreIcon}),J("StarMySubscriptionsExpand")]})]})]}),he&&(0,C.FD)("div",{className:E.container,children:[(0,C.Y)("div",{className:E.lastSection,children:(0,C.Y)(x.Ay,{name:(0,T.P)("slideOptimized",y,void 0,W.isRtl),activeKey:X,renderCount:ce.length,shouldRestoreHeight:!0,className:E.transition,children:(0,C.Y)(U.A,{onLoadMore:ve,items:z?.[le[X]]?.transactions,scrollContainerClosest:`.${E.main}`,itemSelector:`.${de}`,className:E.transactions,noFastList:!0,noScrollRestoreOnTop:!0,children:z?.[le[X]]?.transactions.map(e=>(0,C.Y)(se,{transaction:e,className:de},`${e.id}-${e.isRefund}`))})})}),(0,C.Y)(R.A,{className:E.tabs,tabClassName:E.tab,activeTab:X,tabs:be,onSwitchTab:$})]})]})})}));var me=a(48775),pe=a(29886),fe=a(84991),he=a(10187);const ge=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;const i=a?.form?.botId?(0,o.mBe)(e,a.form.botId):void 0,r="message"===a?.inputInvoice?.type?a.inputInvoice:void 0,n=r?(0,o.O5q)(e,r.chatId,r.messageId):void 0,s=r?(0,o.hds)(e,r.chatId):void 0,l=n?.content.paidMedia;return{bot:i,starsBalanceState:e.stars,paidMediaMessage:l?n:void 0,paidMediaChat:l?s:void 0}})(e=>{let{modal:t,bot:a,starsBalanceState:n,paidMediaMessage:o,paidMediaChat:l}=e;const{closeStarsPaymentModal:d,openStarsBalanceModal:f,sendStarPaymentForm:b}=(0,r.ko)(),[S,v,y]=(0,D.A)(),I=Boolean(t?.inputInvoice&&n),G=(0,pe.A)(t),Y=t||G,{form:w,subscriptionInfo:P}=Y||{},B=w?.invoice?.totalAmount||P?.subscriptionPricing?.amount,M=Boolean(w?.invoice.subscriptionPeriod),T=!P?.subscriptionPricing,U=w?.photo,R=(0,m.A)(),x=(0,F.A)();(0,i.vJ)(()=>{I||y()},[I]);const O=(0,i.Kr)(()=>{if(!Y?.inputInvoice)return"";const e=(0,k.Yg)(a),t=R("Stars.Intro.PurchasedText.Stars",B);if(o){const e=o.content.paidMedia.extendedMedia,a=e.every(e=>!e.duration),i=e.every(e=>Boolean(e.duration)),r=R(a?"Stars.Transfer.Photos":i?"Stars.Transfer.Videos":"Media",e.length),n=(0,k.Js)(R,l);return R("Stars.Transfer.UnlockInfo",[r,n,t])}return P?x("StarsSubscribeText",{chat:P.title,amount:B},{withNodes:!0,withMarkdown:!0,pluralValue:B}):M?x("StarsSubscribeBotText",{name:w.title,amount:B,bot:e},{pluralValue:B}):R("Stars.Transfer.Info",[w.title,e,t])},[Y?.inputInvoice,a,R,B,o,P,M,w,l,x]),L=(0,i.Kr)(()=>{if(P)return x("StarsSubscribeInfo",{link:(0,C.Y)(h.A,{url:x("StarsSubscribeInfoLink"),text:x("StarsSubscribeInfoLinkText")})},{withNodes:!0})},[P,x]),K=(0,i.Kr)(()=>{if(P)return(0,k.nr)(P)},[P]),z=(0,u.A)(()=>{const e=n?.balance;void 0!==B&&void 0!==e&&(B>e.amount?f({originStarsPayment:t}):(b({}),v()))});return(0,C.FD)(A.A,{contentClassName:E.paymentContent,isOpen:I,hasAbsoluteCloseButton:!0,isSlim:!0,onClose:d,children:[(0,C.Y)(q,{balance:n?.balance,className:E.modalBalance}),(0,C.FD)("div",{className:E.paymentImages,dir:R.isRtl?"ltr":"rtl",children:[o?(0,C.Y)(ne,{media:o.content.paidMedia.extendedMedia}):K?(0,C.FD)(C.FK,{children:[(0,C.Y)(p.A,{className:E.paymentPhoto,peer:K,size:"giant"}),(0,C.Y)(V.A,{type:"gold",size:"adaptive",className:E.avatarStar})]}):(0,C.Y)(fe.A,{peer:U?void 0:a,avatarWebPhoto:U,avatarSize:"giant",badgeIcon:"star",badgeText:(0,H.Sm)(B),badgeClassName:E.amountBadge,className:E.paymentPhoto}),(0,C.Y)("img",{className:E.paymentImageBackground,src:N,alt:"",draggable:!1})]}),(0,C.Y)("h2",{className:E.headerText,children:R(K?"StarsSubscribeTitle":"StarsConfirmPurchaseTitle")}),T&&(0,C.Y)(he.A,{className:E.botItem,peerId:w?.botId}),(0,C.Y)("div",{className:E.description,children:(0,c.A)(O,["simple_markdown","emoji"])}),(0,C.Y)(g.A,{className:E.paymentButton,onClick:z,isLoading:S,children:x(M?"StarsSubscribeBotButtonMonth":"StarsPay",{amount:(0,me.U2)(x,B,{asFont:!0})},{withNodes:!0})}),Boolean(L)&&(0,C.Y)("div",{className:(0,s.A)(E.disclaimer,E.smallerText),children:L})]})}));var Ae=a(89925),be=a(85982),Se=a(97040),ve=a(70046),Ne=a(96454),Ce=a(95807),ye=a(537),Ie=a(80140);const ke="biAUzmLA",Ge="hsDNs5hG",Ye="APNjRx1K",we=(0,i.ph)((0,r.EK)(e=>{const{currentUserId:t}=e,a=t?(0,o.mBe)(e,t):void 0,i=a?.emojiStatus,r=e.collectibleEmojiStatuses?.statuses;return{currentUserEmojiStatus:i,collectibleEmojiStatuses:r}})(e=>{let{savedGift:t,currentUserEmojiStatus:a,collectibleEmojiStatuses:n}=e;const{openGiftTransferModal:s,openGiftResalePriceComposerModal:l,openGiftStatusInfoModal:c,setEmojiStatus:d,updateStarGiftPrice:p,showNotification:f,closeGiftInfoModal:h}=(0,r.ko)(),A=(0,F.A)(),b=(0,m.A)(),S=t?.gift,v="starGiftUnique"===S?.type?S.resellPrice:void 0,N=(0,r.mS)(),y=(0,o.nTw)(N).giftInfoModal,k=y?.peerId,G="starGiftUnique"===S?.type?S.slug:void 0,Y=(0,i.Kr)(()=>{if(G)return n?.find(e=>"collectible"===e.type&&e.slug===G)},[G,n]),w="collectible"===a?.type?a.slug:void 0,P=void 0!==G&&w===G,B=Boolean(Y)&&!P,M=(0,u.A)(()=>{t&&"starGiftUnique"===t?.gift.type&&(t.canTransferAt&&t.canTransferAt>(0,Ie.Fm)()?f({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,z.U)(b,1e3*t.canTransferAt)}}}):s({gift:t}))}),T=(0,u.A)(()=>{P?d({emojiStatus:{type:"regular",documentId:I.zNY}}):Y&&c({emojiStatus:Y})}),D=(0,u.A)(()=>{t&&k&&(t.canResellAt&&t.canResellAt>(0,Ie.Fm)()?f({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,z.U)(b,1e3*t.canResellAt)}}}):l({peerId:k,gift:t}))}),U=(0,u.A)(()=>{t&&"starGiftUnique"===t.gift.type&&t.inputGift&&(h(),p({gift:t.inputGift,price:{currency:I.OUy,amount:0,nanos:0}}),f({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:A("GiftUnique",{title:t.gift.title,number:t.gift.number})}}}))});return(0,C.FD)("div",{className:"feHNN0j8",children:[(0,C.Y)(g.A,{color:"transparentBlured",iconName:"gift-transfer-inline",iconAlignment:"top",iconClassName:Ye,onClick:M,ariaLabel:A("GiftInfoTransfer"),noForcedUpperCase:!0,fluid:!0,className:ke,children:(0,C.Y)("span",{className:Ge,children:A("GiftInfoTransfer")})}),(B||!P)&&(0,C.Y)(g.A,{color:"transparentBlured",iconName:P?"crown-take-off":"crown-wear",iconAlignment:"top",iconClassName:Ye,onClick:B||P?T:void 0,disabled:!B&&!P,ariaLabel:A(P?"GiftInfoTakeOff":"GiftInfoWear"),noForcedUpperCase:!0,fluid:!0,className:ke,children:(0,C.Y)("span",{className:Ge,children:A(P?"GiftInfoTakeOff":"GiftInfoWear")})}),!v&&(0,C.Y)(g.A,{color:"transparentBlured",iconName:"sell",iconAlignment:"top",iconClassName:Ye,onClick:D,ariaLabel:A("Sell"),noForcedUpperCase:!0,fluid:!0,className:ke,children:(0,C.Y)("span",{className:Ge,children:A("Sell")})}),Boolean(v)&&(0,C.Y)(g.A,{color:"transparentBlured",iconName:"unlist",iconAlignment:"top",iconClassName:Ye,onClick:U,ariaLabel:A("GiftInfoUnlist"),noForcedUpperCase:!0,fluid:!0,className:ke,children:(0,C.Y)("span",{className:Ge,children:A("GiftInfoUnlist")})})]})})),Pe=(0,i.ph)(e=>{let{modelAttribute:t,backdropAttribute:a,patternAttribute:n,title:o,subtitle:l,subtitlePeer:c,className:d,resellPrice:u,showManageButtons:m,savedGift:p}=e;const{openChat:h}=(0,r.ko)(),g=(0,F.A)(),[A,b,S]=(0,D.A)(!1),v=(0,ye.A)([t,a,n]),N=a?.textColor,y=(0,i.Kr)(()=>{const e=[a.centerColor,a.edgeColor],t=a.patternColor;return(0,C.Y)(ee.A,{className:"UvhsGZLf",backgroundColors:e,patternColor:t,patternIcon:n.sticker})},[a,n]);return(0,C.FD)("div",{className:(0,s.A)("irv1C8bo",A&&"interactive-gift",m&&"QcTw5OSp",d),children:[(0,C.FD)(x.Ay,{className:"Tu6_OHoq",slideClassName:(0,s.A)("iUTKLzTN"),activeKey:v,direction:1,name:"zoomBounceSemiFade",children:[y,(0,C.Y)(Z.A,{className:"a1ASgPwu",sticker:t.sticker,size:120,noLoop:!A,onMouseEnter:Ne.TF?void 0:b,onMouseLeave:Ne.TF?void 0:S})]}),o&&(0,C.Y)("h1",{className:"ECTvfOda",children:o}),Boolean(l)&&(0,C.Y)("div",{className:(0,s.A)("S6JwvHWD",c&&"V7kDVPLm"),style:(0,Ce.A)(N&&`color: ${N}`),onClick:()=>{c&&h({id:c.id})},children:l}),p&&m&&(0,C.Y)(we,{savedGift:p}),u&&(0,C.FD)("p",{className:"zTVWZg63",children:[(0,C.Y)("span",{children:(0,L.hk)(g,u)}),"XTR"===u.currency&&(0,C.Y)(V.A,{type:"gold",size:"middle"}),"TON"===u.currency&&(0,C.Y)(f.A,{name:"toncoin"})]})]})}),Be="qBOIq6Jn",Me="sso9uZM6",Te="NuWOY7ED",De=[0,-50],Fe=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;const i="peer"===a?.transaction?.peer?.type&&a.transaction.peer.id,r=i?(0,o.PVB)(e,i):void 0,n=e.appConfig.starsPaidMessageCommissionPermille,s=a?.transaction.amount,l=a?.transaction.isGift?s?.currency===I.OUy?(0,o.WLj)(e,s?.amount):(0,o.OD9)(e,s?.amount):void 0;return{peer:r,canPlayAnimatedEmojis:(0,o.BWX)(e),topSticker:l,paidMessageCommission:n}})(e=>{let{modal:t,peer:a,canPlayAnimatedEmojis:n,topSticker:o,paidMessageCommission:l}=e;const{showNotification:c,openMediaViewer:d,closeStarsTransactionModal:g}=(0,r.ko)(),A=(0,F.A)(),b=(0,m.A)(),{transaction:S}=t||{},v=(0,i.li)(),N=(0,u.A)(()=>{const e=S?.extendedMedia;e&&d({origin:Ae.TQ.StarsTransaction,standaloneMedia:e.flatMap(e=>Object.values(e))})}),y=(0,u.A)(()=>{v.current?.()}),G=(0,u.A)(e=>{v.current=e}),Y=(0,i.Kr)(()=>{if(!S)return;const{giveawayPostId:e,photo:t,amount:i,isGiftUpgrade:r,starGift:d,isGiftResale:u,starRefCommision:m}=S,g=S?.starGift,v="starGiftUnique"===g?.type,Y=S?.starGift?(0,Q.yQ)(S.starGift):o,w=v?(0,Q.uc)(g):void 0,P=S.peer&&(0,L.MA)(S)&&(0,L.Pc)(S)||void 0,B="peer"===S.peer?.type?S.peer.id:void 0,M=S.peer&&b(function(e){switch(e.type){case"appStore":return"AppStore";case"playMarket":return"PlayMarket";case"fragment":return"Fragment";case"premiumBot":return"StarsTransactionBot";case"ads":return"StarsTransactionAds";case"api":return"Stars.Intro.Transaction.TelegramBotApi.Subtitle";default:return"Stars.Transaction.Unsupported.Title"}}(S.peer)),T=X(b,A,S),D=a&&S.messageId&&!r?(0,k.yt)(a,void 0,S.messageId):void 0,F=a&&e?(0,k.yt)(a,void 0,e):void 0,U=S.extendedMedia,R=U?.length||0,x=U?.every(e=>!e.video),O=U?.every(e=>!e.photo),K=b(x?"Stars.Transfer.Photos":O?"Stars.Transfer.Videos":"Media",R),E=S.description||(r&&"starGiftUnique"===d?.type?d.title:void 0)||(U?K:void 0),q=!U&&!Y&&!S.isPostsSearch,J=t?void 0:!(0,L.MA)(S)&&a||P,W=v&&(0,C.Y)("div",{className:(0,s.A)(Be,"ApoQz22o"),children:(0,C.Y)(Pe,{backdropAttribute:w.backdrop,patternAttribute:w.pattern,modelAttribute:w.model,title:g.title,subtitle:A("GiftInfoCollectible",{number:g.number}),resellPrice:S.amount})}),_=$(i)?"xDyq9cc0":"jvBZSrpd",j=(0,C.FD)("div",{className:Be,children:[U&&(0,C.Y)(ne,{className:(0,s.A)("C5r59yiV","transaction-media-preview"),media:U,onClick:N}),!U&&Y&&(0,C.Y)(Z.A,{sticker:Y,play:n,noLoop:!0},S.id),q&&(0,C.Y)(p.A,{className:"hcrszlpT",peer:J,webPhoto:t,size:"giant",onMouseMove:y}),!Y&&!S.isPostsSearch&&(0,C.Y)(Se.A,{className:(0,s.A)("nML8IQqX"),color:"gold",onRequestAnimation:G,centerShift:De}),Boolean(T)&&(0,C.Y)("h1",{className:"ZZAj3hj7",children:T}),(0,C.Y)("p",{className:Te,children:E}),(0,C.FD)("p",{className:Me,children:[(0,C.Y)("span",{className:(0,s.A)(Me,_),children:(0,L.hk)(A,i)}),i.currency===I.OUy&&(0,C.Y)(V.A,{type:"gold",size:"middle"}),"TON"===i.currency&&(0,C.Y)(f.A,{name:"toncoin",className:_}),S.isRefund&&(0,C.Y)("p",{className:"sxWAwxTd",children:A("Refunded")})]}),Boolean(S.paidMessages&&S.starRefCommision&&l)&&(0,C.Y)("p",{className:Te,children:A("PaidMessageTransactionDescription",{percent:(0,H.l9)(l/10)},{withNodes:!0,withMarkdown:!0})})]}),ee=[];let te;S&&m&&!S.paidMessages&&!u&&ee.push([b("StarsTransaction.StarRefReason.Title"),b("StarsTransaction.StarRefReason.Program")]),r&&ee.push([b("StarGiftReason"),b("StarGiftReasonUpgrade")]),u&&ee.push([b("StarGiftReason"),$(S.amount)?A("StarGiftSaleTransaction"):A("StarGiftPurchaseTransaction")]),te=r?b("Stars.Transaction.GiftFrom"):$(i)||S.isMyGift?b("Stars.Transaction.To"):!S.starRefCommision||S.paidMessages||u?b(B?"Star.Transaction.From":"Stars.Transaction.Via"):b("StarsTransaction.StarRefReason.Miniapp"),S.isPostsSearch||ee.push([te,B?{chatId:B}:M||""]),S.starRefCommision&&S.paidMessages&&ee.push([A("PaidMessageTransactionTotal"),(0,me.U2)(A,S.amount.amount/((100-S.starRefCommision)/100),{asFont:!1,className:"cU5QlvwL",containerClassName:"Z2YALGgl"})]),D&&ee.push([b("Stars.Transaction.Reaction.Post"),(0,C.Y)(h.A,{url:D,text:D})]),F&&S.amount.currency===I.OUy&&(ee.push([b("BoostReason"),(0,C.Y)(h.A,{url:F,text:b("Giveaway")})]),ee.push([b("Gift"),b("Stars",S.amount,"i")])),S.id&&ee.push([b("Stars.Transaction.Id"),(0,C.FD)(C.FK,{children:[(0,C.Y)("div",{className:"tMF8VIOM",onClick:()=>{(0,be.eM)(S.id),c({message:b("StarsTransactionIDCopied")})},children:S.id}),(0,C.Y)(f.A,{className:"voCttFzS",name:"copy"})]})]),ee.push([b("Stars.Transaction.Date"),(0,z.L2)(1e3*S.date,b.code,!0)]);const ae=b("lng_credits_box_out_about").split("{link}");return{header:v?W:j,tableData:ee,footer:(0,C.FD)("span",{className:"KgzPpgS6",children:[ae[0],(0,C.Y)(h.A,{url:b("StarsTOSLink"),text:b("lng_credits_summary_options_about_link")}),ae[1]]})}},[S,b,A,a,n,o,l,G]),w=(0,pe.A)(Y)||Y;return(0,C.Y)(ve.A,{isOpen:Boolean(S),className:"IzhfRIWu",hasBackdrop:"starGiftUnique"===S?.starGift?.type,header:w?.header,tableData:w?.tableData,footer:w?.footer,buttonText:b("OK"),onClose:g})})),Ue="oBLHWBtJ",Re=[0,-50],xe=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;const i=a?.subscription.peerId;return{peer:i?(0,o.PVB)(e,i):void 0}})(e=>{let{modal:t,peer:a}=e;const{closeStarsSubscriptionModal:o,fulfillStarsSubscription:l,changeStarsSubscription:c,checkChatInvite:d,loadStarStatus:f,openInvoice:A}=(0,r.ko)(),b=(0,m.A)(),S=(0,F.A)(),{subscription:v}=t||{},N=(0,i.li)(),y=(0,u.A)(()=>{N.current?.()}),k=(0,u.A)(e=>{N.current=e}),G=(0,i.Kr)(()=>{if(!v)return"hidden";if(v.canRefulfill)return"refulfill";const e=v.until>Date.now()/1e3;if(e&&!v.isCancelled)return"cancel";if(e&&v.isCancelled)return"renew";const t=v.chatInviteHash||v.invoiceSlug;return!e&&t?"restart":"ok"},[v]),Y=(0,u.A)(()=>{if(v){switch(G){case"refulfill":l({id:v.id});break;case"restart":v.chatInviteHash?d({hash:v.chatInviteHash}):v.invoiceSlug&&A({type:"slug",slug:v.invoiceSlug}),f();break;case"renew":c({id:v.id,isCancelled:!1});break;case"cancel":c({id:v.id,isCancelled:!0})}o()}}),w=(0,i.Kr)(()=>{if(!v||!a)return;const{pricing:e,until:t,isCancelled:i,canRefulfill:r,photo:o,title:l,hasBotCancelled:c}=v,d=(0,n.mO)(a),u=(0,C.FD)("div",{className:"E3R22yAI",children:[(0,C.FD)("div",{className:"wuTMXDP9",children:[(0,C.Y)(p.A,{peer:o?void 0:a,webPhoto:o,size:"giant",onMouseMove:y}),(0,C.Y)(V.A,{className:"enRetSny",type:"gold",size:"adaptive"})]}),(0,C.Y)(Se.A,{className:(0,s.A)("zGCayu45"),color:"gold",onRequestAnimation:k,centerShift:Re}),(0,C.Y)("h1",{className:"qdydQHgc",children:l||b("StarsSubscriptionTitle")}),(0,C.Y)("p",{className:"FI6rEJlK",children:S("StarsPerMonth",{amount:e.amount},{withNodes:!0,specialReplacement:{[I.Cyx]:(0,C.Y)(V.A,{className:"J8HIcN6k",size:"adaptive",type:"gold"})}})})]}),m=[];m.push([b(d?"StarsSubscriptionBot":"StarsSubscriptionChannel"),{chatId:a.id}]),l&&m.push([b("StarsSubscriptionBotProduct"),l]);const f=t<Date.now()/1e3;m.push([b(f?"StarsSubscriptionUntilExpired":i?"StarsSubscriptionUntilExpires":"StarsSubscriptionUntilRenews"),(0,z.L2)(1e3*t,b.code,!0)]);const A=S("StarsTransactionTOS",{link:(0,C.Y)(h.A,{url:S("StarsTransactionTOSLink"),text:S("StarsTransactionTOSLinkText")})},{withNodes:!0});return{header:u,tableData:m,footer:(0,C.FD)("span",{className:"GMWMuWCr",children:[(0,C.Y)("p",{className:Ue,children:A}),i&&(0,C.Y)("p",{className:"nkwiG25Q",children:b(c?"StarsSubscriptionBotCancelledText":"StarsSubscriptionCancelledText")}),r&&(0,C.Y)("p",{className:Ue,children:b("StarsSubscriptionRefulfillInfo",(0,z.L2)(1e3*t,b.code,!0))}),!i&&!r&&f&&(0,C.Y)("p",{className:Ue,children:b("StarsSubscriptionExpiredInfo",(0,z.L2)(1e3*t,b.code,!0))}),!i&&!r&&!f&&(0,C.Y)("p",{className:Ue,children:b("StarsSubscriptionCancelInfo",(0,z.L2)(1e3*t,b.code,!0))}),"hidden"!==G&&(0,C.Y)(g.A,{color:"cancel"===G?"danger":"primary",isText:"cancel"===G,onClick:Y,children:b("cancel"===G?"StarsSubscriptionCancel":"refulfill"===G?"StarsSubscriptionRefulfill":"restart"===G?"StarsSubscriptionAgain":"renew"===G?"StarsSubscriptionRenew":"OK")})]})}},[G,S,b,a,v]),P=(0,pe.A)(w)||w;return(0,C.Y)(ve.A,{isOpen:Boolean(v),className:"eR_RZfGB",header:P?.header,tableData:P?.tableData,footer:P?.footer,onClose:o})}));var Oe=a(43874),Le=a(34431),Ke=a(19806),Ve=a(22699),Ee=a(24433),qe=a(32581),ze=a(66644),He=a(15283),Je=a(93545),We=a(68292),_e=a(85118);const je={root:"CuBAw2yg",slider:"euOOAbZi",sparkles:"_L1YQTIP",progress:"kwK0cNPX",floatingBadgeWrapper:"uvlMoXj0",floatingBadge:"BGSDWAYc",floatingBadgeText:"qqQan8uF",floatingBadgeTriangle:"mIdJOmsB"},Qe=[50,100,500,1e3,2e3,5e3,1e4];function Xe(e,t){const a=e.findIndex(e=>t<=e),i=e[a-1]||1,r=e[a]||e[e.length-1];return a+(t-i)/(r-i)}function $e(e,t){const a=Math.floor(t),i=e[a-1]||1,r=i+((e[a]||e[e.length-1])-i)*(t-a);return Math.round(r)}const Ze=(0,i.ph)(e=>{let{maxValue:t,defaultValue:a,className:r,onChange:n}=e;const o=(0,i.li)(),l=(0,i.Kr)(()=>{const e=[];for(let a=0;a<Qe.length;a++)if(Qe[a]<t&&e.push(Qe[a]),Qe[a]>=t){e.push(t);break}return e},[t]),[c,d]=(0,i.J0)(0);(0,He.A)(()=>{d(Xe(l,a))});const m=(0,u.A)(()=>{const e=o.current;if(!e)return;const t=e.parentElement;(0,ze.YS)(()=>{const a=t.offsetLeft+e.offsetWidth/2,i=t.offsetLeft+t.offsetWidth-e.offsetWidth/2;(0,ze.RK)(()=>{t.style.setProperty("--_min-x",`${a}px`),t.style.setProperty("--_max-x",`${i}px`)})})});(0,Je.A)(o,m);const p=(0,u.A)(e=>{const t=Number(e.currentTarget.value);d(t),n($e(l,t))});return(0,C.FD)("div",{className:(0,s.A)(je.root,r),style:"--progress: "+c/l.length,children:[(0,C.Y)("div",{className:je.floatingBadgeWrapper,children:(0,C.FD)("div",{className:je.floatingBadge,ref:o,children:[(0,C.FD)("div",{className:je.floatingBadgeText,children:[(0,C.Y)(f.A,{name:"star",className:je.floatingBadgeIcon}),(0,C.Y)(We.A,{text:(0,H.Sm)($e(l,c))})]}),(0,C.FD)("svg",{className:je.floatingBadgeTriangle,width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",children:[(0,C.Y)("defs",{children:(0,C.FD)("linearGradient",{id:"StarBadgeTriangle",x1:"0",x2:"1",y1:"0",y2:"0",children:[(0,C.Y)("stop",{offset:"-50%","stop-color":"#FFAA00"}),(0,C.Y)("stop",{offset:"150%","stop-color":"#FFCD3A"})]})}),(0,C.Y)("path",{d:"m 28,4 v 9 c 0.0089,7.283278 -3.302215,5.319646 -6.750951,8.589815 l -5.8284,5.82843 c -0.781,0.78105 -2.0474,0.78104 -2.8284,0 L 6.7638083,21.589815 C 2.8288652,17.959047 0.04527024,20.332086 0,13 V 4 C 0,4 0.00150581,0.97697493 3,1 5.3786658,1.018266 22.594519,0.9142007 25,1 c 2.992326,0.1067311 3,3 3,3 z",fill:"url(#StarBadgeTriangle)"})]})]})}),(0,C.Y)("div",{className:je.progress,children:(0,C.Y)(_e.A,{preset:"progress",className:je.sparkles})}),(0,C.Y)("input",{className:je.slider,type:"range",min:0,max:l.length,defaultValue:Xe(l,a),step:"any",onChange:p})]})}),et={content:"RdhRpsCn",title:"yzbjj73U",slider:"xePPMXOI",description:"BlpfdOtK",itemInfo:"nS9V516D",itemTitle:"sH5Nukjy",itemSubtitle:"dHlNODTI",itemIcon:"H_iHihXU",sendAsPeerButtonAvatar:"_mjvLELm",sendAsPeerMenuButton:"zxsRaWYV",buttonDownIcon:"zrwUUELS",sendAsPeerMenuBubble:"X1PB6mhQ",sendAsPeerMenu:"Px1MDij9",sendAsPeersMenuContainer:"Al1nfhHJ",headerControlPanel:"vu90kSL_",separator:"uhQLUjmo",checkBox:"Mc3bVeF0",topLabel:"bnou4CpV",top:"QludQDKR",topBadge:"JBF9pTUK",buttonStar:"NJJFuym9",topPeer:"Ty4Ud_Rd",disclaimer:"KRvkHeo1"},tt={avatarIcon:"author-hidden",customPeerAvatarColor:"#9eaab5",isCustomPeer:!0,titleKey:"StarsReactionAnonymous"},at=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;const i=a&&(0,o.hds)(e,a.chatId),r=a&&(0,o.O5q)(e,a.chatId,a.messageId),n=e.stars?.balance,s=e.appConfig.paidReactionMaxAmount||2500,l=e.settings.paidReactionPrivacy,c=i?.sendPaidReactionsAsPeerIds,d=e.currentUserId;return{chat:i,message:r,starBalance:n,maxAmount:s,defaultPrivacy:l,sendPaidReactionsAsPeerIds:c,currentUserId:d,currentUser:(0,o.mBe)(e,d)}})(e=>{let{modal:t,chat:a,message:l,maxAmount:d,starBalance:b,defaultPrivacy:S,sendPaidReactionsAsPeerIds:v,currentUserId:N,currentUser:y}=e;const{closePaidReactionModal:k,addLocalPaidReaction:G,loadSendPaidReactionsAs:Y}=(0,r.ko)(),[w,P]=(0,i.J0)(50),[B,M,T]=(0,D.A)(),[U,R]=(0,i.J0)(!0),[x,O]=(0,i.J0)(N),L=a?.id,K=x?(0,o.PVB)((0,r.mS)(),x):y,V=(0,m.A)(),{isMobile:E}=(0,Oe.Ay)(),z=(0,F.A)(),J=(0,u.A)(e=>{R(!e.target.checked)}),W=(0,u.A)(e=>{P(e),M()});(0,i.vJ)(()=>{L&&!v&&Y({chatId:L})},[L,v]);const _=(0,i.Kr)(()=>{const e=v?.map(e=>e.id).filter(e=>e!==L);return e?.unshift(N),e},[v,L,N]),j=_&&_.length>1;(0,i.vJ)(()=>{t||T()},[t]),(0,i.vJ)(()=>{const e=l?.reactions?.topReactors?.find(e=>e.isMy);if(e)return R(Boolean(e.isAnonymous)),void(e.peerId&&O(e.peerId));R("anonymous"===S?.type||!1),"peer"===S?.type&&_?.includes(S.peerId)?O(S.peerId):O(N)},[S,l?.reactions?.topReactors,_,N]);const Q=(0,u.A)(()=>{t&&(G({chatId:t.chatId,messageId:t.messageId,count:w,isPrivate:U,peerId:U||x===N?void 0:x,shouldIgnoreDefaultPrivacy:!0}),k())}),X=(0,u.A)(e=>{R(!1),O(e)}),$=(0,u.A)(e=>{const t=(0,o.PVB)((0,r.mS)(),e),a=x===e&&!U;if(t)return(0,C.FD)(Ee.A,{onClick:()=>X(e),children:[(0,C.Y)(p.A,{size:"small",peer:t}),(0,C.FD)("div",{className:(0,s.A)(et.itemInfo),children:[(0,C.Y)(Le.A,{className:et.itemTitle,peer:t,noFake:!0,noVerified:!0}),(0,C.Y)("span",{className:et.itemSubtitle,children:(0,n.mO)(t)?z("PeerPersonalAccount"):z("PeerChannel")})]}),(0,C.Y)(f.A,{className:et.itemIcon,name:a?"check":"placeholder"})]})}),Z=(0,i.Kr)(()=>e=>{let{onTrigger:t,isOpen:a}=e;return(0,C.FD)(g.A,{ripple:!E,size:"smaller",color:"translucent",className:(0,s.A)(et.sendAsPeerMenuButton,a?"active":""),onClick:t,ariaLabel:z("AccDescrOpenMenu2"),children:[(0,C.Y)(p.A,{className:et.sendAsPeerButtonAvatar,size:"mini",peer:U?tt:K}),(0,C.Y)(f.A,{name:"down",className:et.buttonDownIcon})]})},[E,z,K,U]),ee=(0,i.Kr)(()=>{if(j)return(0,C.Y)(Ve.A,{className:(0,s.A)(et.sendAsPeerMenu,"with-menu-transitions"),bubbleClassName:et.sendAsPeerMenuBubble,trigger:Z,positionX:"right",autoClose:!0,children:_.map(e=>$(e))})},[Z,_,j]),te=(0,i.Kr)(()=>{const e=(0,r.mS)(),t=l?.reactions?.topReactors;if(!t)return;const a=[];let i=!1,n=0;if(t.forEach(t=>{const r=t.peerId?(0,o.PVB)(e,t.peerId):void 0;if(!r&&!t.isAnonymous&&!t.isMy)return;if(t.isMy&&(n=t.count),t.isMy&&(t.peerId!==x||t.isAnonymous&&!U))return;const s=x===t.peerId||U&&t.isAnonymous;s&&(i=!0),a.push({amount:t.count,localAmount:s&&B?w:0,isMy:t.isMy,isAnonymous:t.isAnonymous,user:r})}),!i){const t=(0,o.PVB)(e,x);a.push({amount:n,localAmount:B?w:0,isMy:!0,user:t})}return a.sort((e,t)=>t.amount+t.localAmount-(e.amount+e.localAmount)),a.slice(0,3)},[B,l?.reactions?.topReactors,w,x,U]),ae=a&&(0,n.F9)(V,a);return(0,C.FD)(A.A,{isOpen:Boolean(t),onClose:k,isSlim:!0,hasAbsoluteCloseButton:!0,contentClassName:et.content,isLowStackPriority:!0,children:[(0,C.Y)("div",{className:et.sendAsPeersMenuContainer,children:ee}),(0,C.Y)("div",{className:et.headerControlPanel,children:(0,C.Y)(q,{balance:b,className:et.modalBalance,withAddButton:!0})}),(0,C.Y)(Ze,{className:et.slider,defaultValue:50,maxValue:d,onChange:W}),(0,C.Y)("h3",{className:et.title,children:V("StarsReactionTitle")}),(0,C.Y)("div",{className:et.description,children:(0,c.A)(V("StarsReactionText",ae),["simple_markdown","emoji"])}),(0,C.Y)(qe.A,{children:te&&(0,C.Y)("div",{className:et.topLabel,children:V("StarsReactionTopSenders")})}),te&&(0,C.Y)("div",{className:et.top,children:te.map(e=>{const t=(0,H.Sm)(e.amount+e.localAmount),a=e.isAnonymous||!e.user||e.isMy&&U?tt:e.user,i="isCustomPeer"in a?V(a.titleKey):a&&(0,n.F9)(V,a);return(0,C.Y)(fe.A,{className:et.topPeer,peer:a,badgeText:t,badgeIcon:"star",badgeClassName:et.topBadge,text:i},`${e.user?.id||"anonymous"}-${t}`)})}),te&&(0,C.Y)(qe.A,{className:et.separator}),(0,C.Y)(Ke.A,{className:(0,s.A)(et.checkBox,"dialog-checkbox"),checked:!U,onChange:J,label:V("StarsReactionShowMeInTopSenders")}),(0,C.Y)(g.A,{onClick:Q,children:z("SendPaidReaction",{amount:w},{withNodes:!0,specialReplacement:{[I.Cyx]:(0,C.Y)(f.A,{className:et.buttonStar,name:"star"})}})}),(0,C.Y)("p",{className:et.disclaimer,children:z("StarsReactionTerms",{link:(0,C.Y)(h.A,{text:z("StarsReactionLinkText"),url:z("StarsReactionLink")})},{withNodes:!0})})]})}));var it=a(37836),rt=a(5912),nt=a(23174),ot=a(65632),st=a(20333),lt=a(36143),ct=a(96530),dt=a(22720),ut=a(63152),mt=a(94079);const pt="zZUpGRSI",ft="zAee80Dv",ht="nTPAv1ci",gt=(0,i.ph)((0,r.EK)((e,t)=>{let{peerId:a}=t;const i=(0,o.SJA)(e),{stars:r}=e,{isBlurred:n,patternColor:s,background:l,backgroundColor:c}=(0,o.Gyz)(e,i)||{},d=(0,o.PVB)(e,a),u=(0,o.WA9)(e,a),m=(0,o.vGo)(e,a),p=e.currentUserId===a,f=!p&&m?.disallowedGifts?.shouldDisallowUniqueStarGifts,h=!p&&m?.disallowedGifts?.shouldDisallowLimitedStarGifts,g=(0,o.nTw)(e);return{starBalance:r?.balance,peer:d,theme:i,isBackgroundBlurred:n,patternColor:s,customBackground:l,backgroundColor:c,captionLimit:e.appConfig.starGiftMaxMessageLength,currentUserId:e.currentUserId,isPaymentFormLoading:g.isPaymentFormLoading,paidMessagesStars:u,areUniqueStarGiftsDisallowed:f,shouldDisallowLimitedStarGifts:h}})(function(e){let{gift:t,giftByStars:a,peerId:o,peer:c,captionLimit:d,theme:m,isBackgroundBlurred:p,patternColor:f,backgroundColor:h,customBackground:A,currentUserId:b,isPaymentFormLoading:S,starBalance:v,paidMessagesStars:N,areUniqueStarGiftsDisallowed:y,shouldDisallowLimitedStarGifts:I}=e;const{sendStarGift:k,sendPremiumGiftByStars:G,openInvoice:Y,openGiftUpgradeModal:w,openStarsBalanceModal:P}=(0,r.ko)(),B=(0,F.A)(),[M,T]=(0,i.J0)(""),[D,U]=(0,i.J0)(!1),[R,x]=(0,i.J0)(!1),[O,L]=(0,i.J0)(!1),K=(0,ot.A)(m,A);(0,i.vJ)(()=>{I&&x(!0)},[I,R]);const V="id"in t&&"starGift"===t.type,E="months"in t,q=a&&"amount"in a,z=c&&(0,n.mO)(c),H=o===b,J=(0,i.Kr)(()=>{if(E){const e=O&&q?a:t;return{id:-1,chatId:"0",isOutgoing:!1,senderId:b,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"giftPremium",amount:e.amount,currency:e.currency,months:t.months,message:M?{text:M}:void 0}}}}if(V)return{id:-1,chatId:"0",isOutgoing:!1,senderId:b,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"starGift",message:M?.length?{text:M}:void 0,isNameHidden:D||void 0,starsToConvert:t.starsToConvert,canUpgrade:R||void 0,alreadyPaidUpgradeStars:R?t.upgradeStars:void 0,gift:t,peerId:o,fromId:b}}}},[b,t,M,V,D,R,o,O,q,a,E]),W=(0,u.A)(e=>{T(e.target.value)}),_=(0,u.A)(()=>{U(!D)}),j=(0,u.A)(()=>{x(!R)}),Q=(0,u.A)(()=>{q&&L(!O)}),X=(0,u.A)(()=>{V&&w({giftId:t.id,peerId:o})}),$=(0,u.A)(()=>{P({})}),Z=(0,u.A)(()=>{V?k({peerId:o,shouldHideName:D,gift:t,message:M?{text:M}:void 0,shouldUpgrade:R}):O&&q?G({userId:o,months:a.months,amount:a.amount,message:M?{text:M}:void 0}):E&&Y({type:"giftcode",userIds:[o],currency:t.currency,amount:t.amount,option:t,message:M?{text:M}:void 0})}),ee=q&&v&&v.amount>a.amount,te=(0,s.A)("ZORVRSG3","soDpW2YR",A&&"Eny_G3JI",h&&"TkJZPU2u",A&&p&&"M6k91TdM");if((V||E)&&J)return(0,C.FD)("div",{className:(0,s.A)("jKOG0It6","custom-scroll"),children:[(0,C.FD)("div",{className:(0,s.A)("CB1mxsgp","MessageList"),inert:!0,style:(0,Ce.A)(`--pattern-color: ${f}`,h&&`--theme-background-color: ${h}`),children:[(0,C.Y)("div",{className:te,style:K?`--custom-background: ${K}`:void 0}),(0,C.Y)(lt.A,{message:J,threadId:nt.l3,appearanceOrder:0},V?t.id:E?t.months:void 0)]}),function(){const e=d?d-M.length:void 0,i=(0,n.F9)(B,c);return(0,C.FD)("div",{className:"Y68CEIKn",children:[!N&&(0,C.Y)(mt.A,{className:"o5r2IPoA",onChange:W,value:M,label:B("GiftMessagePlaceholder"),maxLength:d,maxLengthIndicator:e&&e<50?e.toString():void 0}),ee&&(0,C.FD)(dt.A,{className:pt,narrow:!0,ripple:!0,onClick:Q,children:[(0,C.Y)("span",{children:B("GiftPremiumPayWithStars",{stars:(0,me.U2)(B,a.amount,{className:ft})},{withNodes:!0})}),(0,C.Y)(ut.A,{checked:O,onChange:Q,label:B("GiftPremiumPayWithStarsAcc")})]}),q&&v&&(0,C.Y)("div",{className:ht,children:B("GiftPremiumDescriptionYourBalance",{stars:(0,me.U2)(B,v.amount,{className:ft}),link:(0,C.Y)(ct.A,{isPrimary:!0,onClick:$,children:B("GetMoreStarsLinkText")})},{withNodes:!0,withMarkdown:!0})}),V&&Boolean(t.upgradeStars)&&!y&&(0,C.FD)(dt.A,{className:pt,narrow:!0,ripple:!0,onClick:j,disabled:I,children:[(0,C.Y)("span",{children:B("GiftMakeUnique",{stars:(0,me.U2)(B,t.upgradeStars,{className:ft})},{withNodes:!0})}),(0,C.Y)(ut.A,{checked:R,onChange:j,label:B("GiftMakeUniqueAcc")})]}),V&&Boolean(t.upgradeStars)&&!y&&(0,C.Y)("div",{className:ht,children:z?B("GiftMakeUniqueDescription",{user:i,link:(0,C.Y)(ct.A,{isPrimary:!0,onClick:X,children:B("GiftMakeUniqueLink")})},{withNodes:!0}):B("GiftMakeUniqueDescriptionChannel",{peer:i,link:(0,C.Y)(ct.A,{isPrimary:!0,onClick:X,children:B("GiftMakeUniqueLink")})},{withNodes:!0})}),V&&(0,C.FD)(dt.A,{className:pt,narrow:!0,ripple:!0,onClick:_,children:[(0,C.Y)("span",{children:B("GiftHideMyName")}),(0,C.Y)(ut.A,{checked:D,onChange:_,label:B("GiftHideMyName")})]}),V&&(0,C.Y)("div",{className:ht,children:H?B("GiftHideNameDescriptionSelf"):z?B("GiftHideNameDescription",{receiver:i}):B("GiftHideNameDescriptionChannel")})]})}(),(0,C.Y)("div",{className:"ATowWJ60"}),function(){const e=O&&q?(0,me.U2)(B,a.amount,{asFont:!0}):V?(0,me.U2)(B,t.stars+(R?t.upgradeStars:0),{asFont:!0}):E?(0,l.vv)(B,t.amount,t.currency):void 0;return(0,C.FD)("div",{className:"jxWZSvet",children:[V&&Boolean(t.availabilityRemains)&&(0,C.Y)(st.A,{isPrimary:!0,progress:t.availabilityRemains/t.availabilityTotal,rightText:B("GiftSoldCount",{count:t.availabilityTotal-t.availabilityRemains}),leftText:B("GiftLeftCount",{count:t.availabilityRemains}),className:"mWzLu0c0"}),(0,C.Y)(g.A,{className:"IDuhjrne",size:"smaller",onClick:Z,isLoading:S,children:B("GiftSend",{amount:e},{withNodes:!0})})]})}()]})}));var At=a(87049);const bt="G1mBmzxs",St="a8no5WH0",vt="DvJLTVFU",Nt=(0,i.ph)((0,r.EK)((e,t)=>{let{option:a}=t;return{sticker:(0,o.t0O)(e,a.months),canPlayAnimatedEmojis:(0,o.BWX)(e)}})(function(e){let{sticker:t,canPlayAnimatedEmojis:a,baseMonthAmount:i,option:r,optionByStars:n,onClick:o}=e;const{months:s,amount:c,currency:d}=r,m=(0,F.A)(),p=(0,u.A)(()=>{o(r)}),f=Math.floor(c/s),h=i&&i>f?Math.ceil(100-f/(i/100)):void 0;return(0,C.FD)("div",{className:bt,tabIndex:0,role:"button",onClick:p,children:[(0,C.Y)(Z.A,{sticker:t,play:a,noLoop:!0,nonInteractive:!0,size:86}),function(){const e=12===s?m("Years",{count:1},{pluralValue:1}):m("Months",{count:s},{pluralValue:s});return(0,C.Y)("div",{className:"rn9aWFNA",children:e})}(),(0,C.Y)("div",{className:"q4_ydkAx",children:m("PremiumGiftDescription")}),(0,C.Y)(g.A,{className:St,nonInteractive:!0,size:"tiny",pill:!0,fluid:!0,children:(0,l.Ad)(c,d)}),n&&(0,C.Y)("div",{className:"QB5SI7ta",children:m("GiftPremiumStarsPrice",{stars:(0,me.U2)(m,n.amount,{className:"jgnEfoeM"})},{withNodes:!0,withMarkdown:!0})}),Boolean(h)&&(0,C.Y)(At.A,{color:"purple",text:m("GiftDiscount",{percent:h})})]})}));var Ct=a(82855);const yt=(0,i.ph)((0,r.EK)(e=>({isCurrentUserPremium:(0,o.g29)(e)}))(function(e){let{gift:t,observeIntersection:a,onClick:n,isResale:o,isCurrentUserPremium:l}=e;const{openGiftInfoModal:c,openPremiumModal:d,showNotification:m}=(0,r.ko)(),p=(0,i.li)(),f=(0,i.li)(),h=(0,F.A)(),[A,b]=(0,i.J0)(!1),[S,v,N]=(0,D.A)(),y=(0,Q.yQ)(t),k="starGiftUnique"===t.type,G=k?t:void 0,Y=k?void 0:t,w=k?function(e){if(!e)return{amount:0,currency:I.OUy};if("starGiftUnique"===t.type&&t.resaleTonOnly){const t=e.find(e=>e.currency===I.ykW);if(t)return t}return e.find(e=>e.currency===I.OUy)}(G?.resellPrice):{amount:Y?.stars||0,currency:I.OUy},P=w?.currency||I.OUy,B=Y?.resellMinStars,M=!k&&o&&B?h.number(B)+"+":w?.amount||0,T=!k&&Boolean(Y?.isLimited),U=!k&&Boolean(Y?.isSoldOut),R=Boolean(t?.requirePremium),x=Boolean(Y?.limitedPerUser&&!Y?.perUserRemains),O=Y?.perUserTotal,L=(0,u.A)(()=>{!U||o?x?m({message:h("NotificationGiftsLimit2",{count:O},{pluralValue:O,withMarkdown:!0,withNodes:!0})}):!R||l?n(t,o?"resell":"original"):d({gift:t}):c({gift:t})}),K=(0,i.Kr)(()=>{const{backdrop:e,pattern:a}=(0,Q.uc)(t)||{};if(!e||!a)return;const i=[e.centerColor,e.edgeColor],r=e.patternColor;return(0,C.Y)(ee.A,{className:"Nkotr8Q4",backgroundColors:i,patternColor:r,patternIcon:a.sticker})},[t]),V=k?t.number:0,E=(0,i.Kr)(()=>{if(k){const{backdrop:e}=(0,Q.uc)(t)||{};if(!e)return;return(0,C.Y)(At.A,{color:[e.centerColor,e.edgeColor],text:h("GiftSavedNumber",{number:V})})}return o?(0,C.Y)(At.A,{color:"green",text:h("GiftRibbonResale")}):U?(0,C.Y)(At.A,{color:"red",text:h("GiftSoldOut")}):R?(0,C.Y)(At.A,{color:"orange",text:h("LimitPremium")}):T?(0,C.Y)(At.A,{color:"blue",text:h("GiftLimited")}):void 0},[k,o,t,U,T,h,V,R]);return(0,rt.mv)(p,a,e=>{const t=e.isIntersecting;b(t)}),(0,C.FD)("div",{ref:p,className:(0,s.A)("interactive-gift",bt,"f5ArEO1S","starGiftItem",R&&"NBYIITte"),tabIndex:0,role:"button",onClick:L,onMouseEnter:Ne.TF?void 0:v,onMouseLeave:Ne.TF?void 0:N,children:[K,(0,C.Y)("div",{ref:f,className:"rUSoeQXb",style:"width: 90px; height: 90px",children:y&&(0,C.Y)(Ct.A,{observeIntersectionForPlaying:a,observeIntersectionForLoading:a,containerRef:f,sticker:y,size:90,shouldLoop:S,shouldPreloadPreview:!0})}),(0,C.Y)(g.A,{className:St,nonInteractive:!0,size:"tiny",color:k?"bluredStarsBadge":"stars",withSparkleEffect:A,pill:!0,fluid:!0,children:P===I.ykW?(0,me.Ms)(h,M||0,{shouldConvertFromNanos:!0,className:vt}):(0,me.U2)(h,M||0,{asFont:!0,className:vt})}),E]})}));var It=a(13235),kt=a(58443),Gt=a(96374),Yt=a(64489);const wt={root:"tJK1W0pJ",transition:"pP8TxefR",content:"o3V1HqbL",resaleScreenRoot:"Vce_TsJO",main:"cVXqeu9P",giftSection:"v4eKefwN",section:"EqfarEYb",resaleStarGiftsContainer:"RSFcSNGL",starGiftsContainer:"OQX3GZl5",premiumGiftsGallery:"n40m3BK2",header:"iqqoyRgW",resaleHeader:"cJRBgg9B",resaleHeaderContentContainer:"OXYQmfGK",headerSlide:"BTWhJUQB",headerText:"lLRmbpIu",hiddenHeader:"XgGzn1cQ",resaleHeaderText:"bp_KPx8I",commonHeaderText:"ybZo03if",resaleHeaderDescription:"XefHUFm1",closeButton:"r_Y5uG1T",balance:"soqAknia",avatars:"N_7tYJKr",avatar:"_3hY4vIep",logoBackground:"ieK4TzSb",center:"Ey5gX40t",description:"ZioU5h_k",starGiftsDescription:"gFgzS8pV",boostIcon:"Qi2YR6Dz",optionBottom:"RTbClMKE",secondaryInfo:"g0R9GSNq",footer:"J3Gju3bv",starGiftsTransition:"kB6IyXqS",notFoundGiftsRoot:"UqnRlJ1n",notFoundGiftsDescription:"g0VbwIG_",notFoundGiftsLink:"j2zPEQr8"},Pt=(0,i.ph)((0,r.EK)(e=>{const{starGifts:t}=e,{resaleGifts:a}=(0,o.nTw)(e),i=a?.giftId?t?.byId[a.giftId]:void 0,r=a.filter,n=a.isAllLoaded,s=a.isLoading,l=a.updateIteration;return{resellGifts:a.gifts,gift:i,filter:r,areGiftsAllLoaded:n,areGiftsLoading:s,updateIteration:l}})(e=>{let{resellGifts:t,gift:a,filter:n,areGiftsAllLoaded:o,areGiftsLoading:l,updateIteration:c,onGiftClick:d}=e;const{loadResaleGifts:m,updateResaleGiftsFilter:p}=(0,r.ko)(),f=(0,i.li)(),h=(0,F.A)(),g=(0,i.Kr)(()=>t?.map(e=>e.id),[t]),A=Boolean(n?.modelAttributes?.length||n?.patternAttributes?.length||n?.backdropAttributes?.length),b=(0,u.A)(()=>{if(a){const e="regularGiftId"in a?a.regularGiftId:a.id;m({giftId:e})}}),S=Boolean(!t||0===t.length),[v,N]=(0,Gt.A)(b,g,!a,It.bc),{observe:y}=(0,rt.BL)({rootRef:f,throttleMs:200}),I=(0,u.A)(()=>{p({filter:{...n,modelAttributes:[],backdropAttributes:[],patternAttributes:[]}})});return(0,C.Y)("div",{ref:f,className:(0,s.A)(wt.resaleScreenRoot,"custom-scroll"),children:(0,C.FD)(x.Ay,{name:"zoomFade",activeKey:c,children:[S&&o&&(0,C.FD)("div",{className:wt.notFoundGiftsRoot,children:[(0,C.Y)(Yt.A,{size:160,tgsUrl:kt.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,C.Y)("div",{className:wt.notFoundGiftsDescription,children:h("ResellGiftsNoFound")}),A&&(0,C.Y)(ct.A,{className:wt.notFoundGiftsLink,onClick:I,children:h("ResellGiftsClearFilters")})]}),(0,C.Y)(U.A,{className:(0,s.A)(wt.resaleStarGiftsContainer),items:v,onLoadMore:N,itemSelector:".starGiftItem",noFastList:!0,preloadBackwards:It.bc,scrollContainerClosest:`.${wt.resaleScreenRoot}`,children:t?.map(e=>(0,C.Y)(yt,{gift:e,observeIntersection:y,isResale:!0,onClick:d},e.id))})]})})}));var Bt=a(10722),Mt=a(71429),Tt=a(36393),Dt=a(76023),Ft=a(87094);const Ut=1.5*Dt.$,Rt=(0,i.ph)((0,r.EK)(e=>({theme:(0,o.SJA)(e)}))(e=>{let{className:t,type:a,sticker:r,observeIntersectionForLoading:n,observeIntersectionForPlaying:o,theme:l}=e;const c=(0,i.li)(),d=(0,Ft.A)(c,void 0,"pattern"!==a);return(0,C.Y)("div",{ref:c,className:(0,s.A)("KLFLR9ji",t),style:`width: ${Ut}px; height: ${Ut}px`,children:(0,C.Y)(Ct.A,{containerRef:c,sticker:r,size:Ut,shouldPreloadPreview:!0,observeIntersectionForLoading:n,observeIntersectionForPlaying:o,thumbClassName:"fCL5rY2D",customColor:d})})})),xt={root:"_VgmQnUg",buttonsContainer:"IDlp6U6g",itemIcon:"yuctLnuR",sticker:"VT562JS0",backdropAttributeMenuItemText:"D50wFfRL",menuItemStickerText:"THcGWXSA",menuItemText:"L6EVE2Ux",backdrop:"A29QNxKb",menuItemIcon:"GL4rVsev",item:"qiYcBOYc",menuContentContainer:"EDsBn29z",menu:"ISaNdBwd",left:"e4Kkh_MR",right:"Kz_nCGC3"},Ot=(0,i.ph)((0,r.EK)(e=>{const{resaleGifts:t}=(0,o.nTw)(e);return{attributes:t.attributes,counters:t.counters,filter:t.filter}})(e=>{let{attributes:t,counters:a,filter:n,dialogRef:o}=e;const l=(0,F.A)(),{updateResaleGiftsFilter:c}=(0,r.ko)(),[d,m]=(0,i.J0)(""),[p,h]=(0,i.J0)(""),[g,A]=(0,i.J0)(""),b=(0,i.Kr)(()=>{const e={model:[],pattern:[],backdrop:[]};for(const i of a??[]){const{attribute:a}=i;if(!i.count)continue;const r=t?.find(e=>"backdrop"===e.type&&"backdrop"===a.type?e.backdropId===a.backdropId:("model"===e.type&&"model"===a.type||"pattern"===e.type&&"pattern"===a.type)&&e.sticker.id===a.documentId);"backdrop"===r?.type&&e.backdrop.push(r),"model"===r?.type&&e.model.push(r),"pattern"===r?.type&&e.pattern.push(r)}return e},[t,a]),S=(0,i.Kr)(()=>{const e=(e,t)=>t.trim()?e.filter(e=>Boolean(e.name?.toLowerCase().includes(t.toLowerCase()))):e;return{model:e(b.model,d),pattern:e(b.pattern,g),backdrop:e(b.backdrop,p)}},[b,d,p,g]),v=(0,i.li)(),{isContextMenuOpen:N,contextMenuAnchor:y,handleContextMenu:I,handleContextMenuClose:k,handleContextMenuHide:G}=(0,Bt.A)(o),Y=(0,u.A)(()=>v.current),w=(0,i.li)(),{isContextMenuOpen:P,contextMenuAnchor:B,handleContextMenu:M,handleContextMenuClose:T,handleContextMenuHide:D}=(0,Bt.A)(o),U=(0,u.A)(()=>w.current),R=(0,i.li)(),{isContextMenuOpen:x,contextMenuAnchor:O,handleContextMenu:L,handleContextMenuClose:K,handleContextMenuHide:V}=(0,Bt.A)(o),E=(0,u.A)(()=>R.current),q=(0,i.li)(),{isContextMenuOpen:z,contextMenuAnchor:H,handleContextMenu:J,handleContextMenuClose:W,handleContextMenuHide:_}=(0,Bt.A)(o),j=(0,u.A)(()=>q.current),Q=(0,i.Kr)(()=>{const e=n.sortType;return t=>{let{onTrigger:a,isOpen:i}=t;return(0,C.FD)("div",{className:xt.item,onClick:a,children:["byDate"===e&&l("ValueGiftSortByDate"),"byNumber"===e&&l("ValueGiftSortByNumber"),"byPrice"===e&&l("ValueGiftSortByPrice"),(0,C.Y)(f.A,{name:"dropdown-arrows",className:xt.itemIcon})]})}},[l,n]),X=(0,i.Kr)(()=>{const e=n?.modelAttributes?.length||0;return t=>{let{onTrigger:a,isOpen:i}=t;return(0,C.FD)("div",{className:xt.item,onClick:a,children:[0===e&&l("GiftAttributeModel"),e>0&&l("GiftAttributeModelPlural",{count:e},{pluralValue:e}),(0,C.Y)(f.A,{name:"dropdown-arrows",className:xt.itemIcon})]})}},[l,n]),$=(0,i.Kr)(()=>{const e=n?.backdropAttributes?.length||0;return t=>{let{onTrigger:a,isOpen:i}=t;return(0,C.FD)("div",{className:xt.item,onClick:a,children:[0===e&&l("GiftAttributeBackdrop"),e>0&&l("GiftAttributeBackdropPlural",{count:e},{pluralValue:e}),(0,C.Y)(f.A,{name:"dropdown-arrows",className:xt.itemIcon})]})}},[l,n]),Z=(0,i.Kr)(()=>{const e=n?.patternAttributes?.length||0;return t=>{let{onTrigger:a,isOpen:i}=t;return(0,C.FD)("div",{className:xt.item,onClick:a,children:[0===e&&l("GiftAttributeSymbol"),e>0&&l("GiftAttributeSymbolPlural",{count:e},{pluralValue:e}),(0,C.Y)(f.A,{name:"dropdown-arrows",className:xt.itemIcon})]})}},[l,n]),te=(0,u.A)(e=>{c({filter:{...n,sortType:e}})}),ae=(0,u.A)(()=>{c({filter:{...n,modelAttributes:[]}})}),ie=(0,u.A)(()=>{c({filter:{...n,patternAttributes:[]}})}),re=(0,u.A)(()=>{c({filter:{...n,backdropAttributes:[]}})}),ne=(0,u.A)(e=>{if(!a)return;const t=n.modelAttributes||[],i=a.find(t=>"model"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!i)return;const r=t.some(e=>e.documentId===i.documentId)?t.filter(e=>e.documentId!==i.documentId):[...t,i];c({filter:{...n,modelAttributes:r}})}),oe=(0,u.A)(e=>{if(!a)return;const t=n.patternAttributes||[],i=a.find(t=>"pattern"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!i)return;const r=t.some(e=>e.documentId===i.documentId)?t.filter(e=>e.documentId!==i.documentId):[...t,i];c({filter:{...n,patternAttributes:r}})}),se=(0,u.A)(e=>{if(!a)return;const t=n.backdropAttributes||[],i=a.find(t=>"backdrop"===t.attribute.type&&t.attribute.backdropId===e.backdropId)?.attribute;if(!i)return;const r=t.some(e=>e.backdropId===i.backdropId)?t.filter(e=>e.backdropId!==i.backdropId):[...t,i];c({filter:{...n,backdropAttributes:r}})}),le=(0,i.hb)(()=>{m("")},[]),ce=(0,i.hb)(()=>{h("")},[]),de=(0,i.hb)(()=>{A("")},[]),ue=(0,u.A)(e=>{e.stopPropagation(),e.preventDefault()}),me=(0,i.li)(),{observe:pe}=(0,rt.BL)({rootRef:me,isDisabled:!B});return(0,C.FD)("div",{className:xt.root,children:[Boolean(y)&&(0,C.Y)(Mt.A,{isOpen:N,anchor:y,ref:v,className:(0,s.A)(xt.menu,xt.left,"with-menu-transitions"),getMenuElement:Y,autoClose:!0,onClose:k,onCloseAnimationEnd:G,positionX:"left",children:(0,C.FD)(C.FK,{children:[(0,C.FD)(Ee.A,{icon:"sort-by-price",onClick:()=>{te("byPrice")},children:[(0,C.Y)("div",{className:xt.menuItemText,children:l("GiftSortByPrice")}),(0,C.Y)(f.A,{className:xt.menuItemIcon,name:"byPrice"===n?.sortType?"check":"placeholder"})]}),(0,C.FD)(Ee.A,{icon:"sort-by-date",onClick:()=>{te("byDate")},children:[(0,C.Y)("div",{className:xt.menuItemText,children:l("GiftSortByDate")}),(0,C.Y)(f.A,{className:xt.menuItemIcon,name:"byDate"===n?.sortType?"check":"placeholder"})]}),(0,C.FD)(Ee.A,{icon:"sort-by-number",onClick:()=>{te("byNumber")},children:[(0,C.Y)("div",{className:xt.menuItemText,children:l("GiftSortByNumber")}),(0,C.Y)(f.A,{className:xt.menuItemIcon,name:"byNumber"===n?.sortType?"check":"placeholder"})]})]})}),Boolean(B)&&(0,C.Y)(Mt.A,{isOpen:P,anchor:B,ref:w,className:(0,s.A)(xt.menu,xt.left,"with-menu-transitions"),getMenuElement:U,autoClose:!0,onClose:T,onCloseAnimationEnd:D,children:function(){const e=S.model,t=n.modelAttributes??[],a=0===t.length;return(0,C.FD)("div",{className:xt.menuContentContainer,ref:me,children:[(0,C.Y)(Tt.A,{onClick:ue,className:xt.search,value:d,onChange:m,onReset:le,placeholder:l("Search")}),(0,C.Y)(Ee.A,{icon:"select",onClick:ae,disabled:a,children:l("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,C.FD)(Ee.A,{onClick:()=>{ne(e)},children:[(0,C.Y)(Rt,{className:xt.sticker,sticker:e.sticker,type:"model",observeIntersectionForLoading:pe,observeIntersectionForPlaying:pe}),(0,C.Y)("div",{className:xt.menuItemStickerText,children:e.name}),(0,C.Y)(f.A,{className:xt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(O)&&(0,C.Y)(Mt.A,{isOpen:x,anchor:O,ref:R,className:(0,s.A)(xt.menu,xt.right,"with-menu-transitions"),getMenuElement:E,autoClose:!0,onClose:K,onCloseAnimationEnd:V,positionX:"right",children:function(){const e=S.backdrop,t=n.backdropAttributes??[],a=0===t.length;return(0,C.FD)("div",{className:xt.menuContentContainer,children:[(0,C.Y)(Tt.A,{onClick:ue,className:xt.search,value:p,onChange:h,onReset:ce,placeholder:l("Search")}),(0,C.Y)(Ee.A,{icon:"select",onClick:re,disabled:a,children:l("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.backdropId===e.backdropId);return(0,C.FD)(Ee.A,{onClick:()=>{se(e)},children:[(0,C.Y)(ee.A,{className:xt.backdrop,backgroundColors:[e.centerColor,e.edgeColor],patternColor:e.patternColor}),(0,C.Y)("div",{className:xt.backdropAttributeMenuItemText,children:e.name}),(0,C.Y)(f.A,{className:xt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(H)&&(0,C.Y)(Mt.A,{isOpen:z,anchor:H,ref:q,className:(0,s.A)(xt.menu,xt.right,"with-menu-transitions"),getMenuElement:j,autoClose:!0,onClose:W,onCloseAnimationEnd:_,children:function(){const e=S.pattern,t=n.patternAttributes??[],a=0===t.length;return(0,C.FD)("div",{className:xt.menuContentContainer,children:[(0,C.Y)(Tt.A,{onClick:ue,className:xt.search,value:g,onChange:A,onReset:de,placeholder:l("Search")}),(0,C.Y)(Ee.A,{icon:"select",onClick:ie,disabled:a,children:l("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,C.FD)(Ee.A,{onClick:()=>{oe(e)},children:[(0,C.Y)(Rt,{className:xt.sticker,sticker:e.sticker,type:"pattern"}),(0,C.Y)("div",{className:xt.menuItemStickerText,children:e.name}),(0,C.Y)(f.A,{className:xt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),(0,C.FD)("div",{className:xt.buttonsContainer,children:[(0,C.Y)(Q,{onTrigger:I,isOpen:N}),(0,C.Y)(X,{onTrigger:M,isOpen:P}),(0,C.Y)($,{onTrigger:L,isOpen:x}),(0,C.Y)(Z,{onTrigger:J,isOpen:z})]})]})}));var Lt=a(36838);const Kt=(0,i.ph)((0,r.EK)(e=>{const{starGifts:t}=e;return{idsByCategory:t?.idsByCategory}})(e=>{let{idsByCategory:t,onCategoryChanged:a,areLimitedStarGiftsDisallowed:r}=e;const n=(0,i.li)(),o=(0,F.A)(),l=(0,i.Kr)(()=>t&&Object.keys(t).filter(e=>"all"!==e&&"limited"!==e).map(Number).sort((e,t)=>e-t),[t]),c=t&&t.resale.length>0,[d,u]=(0,i.J0)("all");function m(e){return"all"===e?o("AllGiftsCategory"):"stock"===e?o("StockGiftsCategory"):"limited"===e?o("LimitedGiftsCategory"):"resale"===e?o("GiftCategoryResale"):e}function p(e){return(0,C.FD)("div",{className:(0,s.A)("dO7FKYY4",d===e&&"B2lEJk1v"),onClick:()=>function(e){u(e),a(e)}(e),children:[Number.isInteger(e)&&(0,C.Y)(V.A,{className:"Pb7AU805",type:"gold",size:"middle"}),m(e)]})}return(0,Lt.A)(n,void 0,!0),(0,C.FD)("div",{ref:n,className:(0,s.A)("cUjwvN00","no-scrollbar"),children:[p("all"),!r&&p("limited"),!r&&c&&p("resale"),p("stock"),l?.map(p)]})})),Vt=[0,-50],Et=(0,it.nF)(e=>e(),200,!0),qt=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;const{starGifts:i,stars:r,currentUserId:n}=e,s=a?.forPeerId?(0,o.PVB)(e,a.forPeerId):void 0,l=Boolean(n&&a?.forPeerId===n),c=s?(0,o.vGo)(e,s?.id):void 0,{resaleGifts:d}=(0,o.nTw)(e),u=d.count,m=!1!==d.isLoading,p=a?.selectedResaleGift;return{boostPerSentGift:e.appConfig.boostsPerSentGift,starGiftsById:i?.byId,starGiftIdsByCategory:i?.idsByCategory,starBalance:r?.balance,peer:s,isSelf:l,disallowedGifts:c?.disallowedGifts,resaleGiftsCount:u,areResaleGiftsLoading:m,selectedResaleGift:p,tabId:(0,o.nTw)(e).id}})(e=>{let{modal:t,starGiftsById:a,starGiftIdsByCategory:o,starBalance:l,peer:c,isSelf:f,disallowedGifts:b,resaleGiftsCount:S,areResaleGiftsLoading:v,selectedResaleGift:N,tabId:y}=e;const{closeGiftModal:G,openGiftInfoModal:Y,resetResaleGifts:w,loadResaleGifts:P,openGiftInMarket:B,closeResaleGiftsMarket:M}=(0,r.ko)(),T=(0,i.li)(),D=(0,i.li)(),U=(0,i.li)(),R=(0,i.li)(),O=Boolean(t),L=(0,d.A)(t),K=c&&(0,n.mO)(c)?c:void 0,V=c&&(0,n.vj)(c)?c:void 0,[E,z]=(0,i.J0)(),[H,J]=(0,i.J0)(!1),[W,_]=(0,i.J0)(!1),[j,Q]=(0,i.J0)(!1),[X,$]=(0,i.J0)("all"),Z=(0,i.li)(),ee=(0,i.Kr)(()=>{if(!b)return;const{shouldDisallowPremiumGifts:e,...t}=b;return!f&&Object.values(t).every(Boolean)},[f,b]),te=!f&&b?.shouldDisallowUnlimitedStarGifts,ae=!f&&b?.shouldDisallowLimitedStarGifts,ie=(0,m.A)(),re=(0,F.A)(),ne=L?.gifts,oe=(0,i.Kr)(()=>ne?.sort((e,t)=>e.months-t.months).filter(e=>1===e.users&&e.currency!==I.OUy),[ne]),se=(0,i.Kr)(()=>{const e=new Map;return oe?(oe.forEach(t=>{const a=ne?.find(e=>e.currency===I.OUy&&e.months===t.months);a&&e.set(t,a)}),e):e},[ne,oe]),le=(0,i.Kr)(()=>oe?.reduce((e,t)=>e.amount<t.amount?e:t),[oe]),{observe:ce}=(0,rt.BL)({rootRef:R,throttleMs:200,isDisabled:!O}),de=Boolean(N)&&!E,ue=Boolean(E),me=de||ue||H,pe=ue?j:W;(0,i.vJ)(()=>{if(N){const e="regularGiftId"in N?N.regularGiftId:N.id;P({giftId:e})}},[N]),(0,i.vJ)(()=>{O||(J(!1),z(void 0),$("all"))},[O,y,M]);const fe=(0,u.A)(e=>{if(ue)return;const t=e.currentTarget;Et(()=>{const{scrollTop:e}=t;if(J(e>150),D.current&&U.current){const{top:e}=U.current.getBoundingClientRect(),{top:t}=D.current.getBoundingClientRect();_(e-t<=0)}})}),he=re("GiftPremiumDescription",{user:(0,k.Yg)(K),link:(0,C.Y)(h.A,{text:re("GiftPremiumDescriptionLinkCaption"),url:re("GiftPremiumDescriptionLink")})},{withNodes:!0}),ge=V?re("StarGiftDescriptionChannel",{peer:(0,n.F9)(re,V)},{withNodes:!0,withMarkdown:!0}):f?re("StarGiftDescriptionSelf",void 0,{withNodes:!0,renderTextFilters:["br"]}):re("StarGiftDescription",{user:(0,k.Yg)(K)},{withNodes:!0,withMarkdown:!0}),Ae=(0,u.A)((e,t)=>{if("resell"===t){if(!("id"in e))return;return de?void Y({gift:e,recipientId:L?.forPeerId}):void B({gift:e,tabId:y})}z(e),Q("id"in e)});const be=(0,u.A)(e=>{$(e)}),ve=(0,u.A)(()=>{z(void 0),w(),G()}),Ne=(0,u.A)(()=>{de?M({tabId:y}):ue?z(void 0):ve()}),Ce=(0,u.A)(()=>{Z.current?.()}),ye=(0,u.A)(e=>{Z.current=e}),Ie=ue||de,ke=(0,s.A)("animated-close-icon",Ie&&"state-back");return(0,C.FD)(A.A,{dialogRef:T,onClose:ve,isOpen:O,isSlim:!0,contentClassName:wt.content,className:(0,s.A)(wt.modalDialog,wt.root),isLowStackPriority:!0,children:[(0,C.Y)(g.A,{className:wt.closeButton,round:!0,color:"translucent",size:"smaller",onClick:Ne,ariaLabel:ie(Ie?"Common.Back":"Common.Close"),children:(0,C.Y)("div",{className:ke})}),(0,C.Y)(q,{className:wt.balance,balance:l,withAddButton:!0}),(0,C.Y)("div",{className:(0,s.A)(wt.header,de&&wt.resaleHeader,!me&&wt.hiddenHeader),children:(0,C.Y)(x.Ay,{name:"slideVerticalFade",activeKey:me?de?1:pe?2:3:0,slideClassName:wt.headerSlide,children:function(){if(me){if(de){const e=v&&!S;return(0,C.FD)("div",{className:wt.resaleHeaderContentContainer,children:[(0,C.Y)("h2",{className:wt.resaleHeaderText,children:N.title}),e&&(0,C.Y)("div",{className:wt.resaleHeaderDescription,children:re("Loading")}),!e&&void 0!==S&&(0,C.Y)("div",{className:wt.resaleHeaderDescription,children:re("HeaderDescriptionResaleGifts",{count:S},{withNodes:!0,withMarkdown:!0,pluralValue:S})}),(0,C.Y)(Ot,{dialogRef:T})]})}return(0,C.Y)("h2",{className:wt.commonHeaderText,children:re(pe?f?"StarsGiftHeaderSelf":"StarsGiftHeader":"GiftPremiumHeader")})}}()})}),(0,C.FD)(x.Ay,{ref:D,className:wt.transition,name:"pushSlide",activeKey:ue?1:de?2:0,children:[!ue&&!de&&(0,C.FD)("div",{ref:R,className:(0,s.A)(wt.main,"custom-scroll"),onScroll:fe,children:[(0,C.FD)("div",{className:wt.avatars,children:[(0,C.Y)(p.A,{className:wt.avatar,size:100,peer:c,onMouseMove:Ce}),(0,C.Y)(Se.A,{className:wt.logoBackground,color:"gold",centerShift:Vt,onRequestAnimation:ye})]}),!f&&!V&&!b?.shouldDisallowPremiumGifts&&(0,C.FD)(C.FK,{children:[(0,C.Y)("h2",{className:(0,s.A)(wt.headerText,wt.center),children:re("GiftPremiumHeader")}),(0,C.Y)("p",{className:(0,s.A)(wt.description,wt.center),children:he}),(0,C.Y)("div",{className:wt.premiumGiftsGallery,children:oe?.map(e=>(0,C.Y)(Nt,{option:e,optionByStars:se.get(e),baseMonthAmount:le?Math.floor(le.amount/le.months):void 0,onClick:Ae}))})]}),!ee&&(0,C.FD)(C.FK,{children:[(0,C.Y)("h2",{ref:U,className:(0,s.A)(wt.headerText,wt.center),children:re(f?"StarsGiftHeaderSelf":"StarsGiftHeader")}),(0,C.Y)("p",{className:(0,s.A)(wt.description,wt.starGiftsDescription,wt.center),children:ge}),(0,C.Y)(Kt,{areLimitedStarGiftsDisallowed:ae,onCategoryChanged:be}),(0,C.Y)(x.Ay,{name:"zoomFade",activeKey:(Ge=X,"all"===Ge?0:"limited"===Ge?1:"resale"===Ge?2:"stock"===Ge?3:Ge+3),className:wt.starGiftsTransition,children:function(){const e=o?.[X]?.filter(e=>{const t=a?.[e];if(!t)return!1;const{isLimited:i,isSoldOut:r,upgradeStars:n}=t;return te&&!ae?i:ae&&!te?!i&&!r:!te||!ae||Boolean(i&&Boolean(n))});return(0,C.Y)("div",{className:wt.starGiftsContainer,children:a&&e?.flatMap(e=>{const t=a[e],i="stock"!==X&&Boolean(t.availabilityResale),r="resale"!==X&&i&&!t.isSoldOut,n=[(0,C.Y)(yt,{gift:t,observeIntersection:ce,isResale:i&&!r,onClick:Ae},e)];return r&&n.push((0,C.Y)(yt,{isResale:!0,gift:t,observeIntersection:ce,onClick:Ae},`resale_${e}`)),n})})}()})]})]}),de&&N&&(0,C.Y)(Pt,{onGiftClick:Ae}),ue&&L?.forPeerId&&(0,C.Y)(gt,{gift:E,giftByStars:se.get(E),peerId:L.forPeerId})]})]});var Ge}));const zt=(0,i.ph)((0,r.EK)(e=>{const{currentUserId:t}=e;return{currentUserId:t,userIds:e.contactList?.userIds}})(e=>{let{modal:t,currentUserId:a,userIds:s}=e;const{closeGiftRecipientPicker:l,openGiftModal:c}=(0,r.ko)(),d=(0,m.A)(),p=t,[f,h]=(0,i.J0)(""),g=(0,i.Kr)(()=>{const e=(0,r.mS)(),t=s?s.concat(a):void 0,i=t?(0,n.PU)({ids:t,query:f}):[];return(0,Y.A)((0,G.Am)(i).filter(t=>(0,o.X2D)(e,t)),void 0,[a])},[a,f,s]),A=(0,u.A)(e=>{c({forUserId:e}),l()});return(0,C.Y)(P.A,{className:"W3JMs1YE",isOpen:p,onClose:l,title:d("GiftTelegramPremiumOrStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,children:(0,C.Y)(w.A,{className:"wOipz1Y_",itemIds:g,filterValue:f,filterPlaceholder:d("Search"),onSelectedIdChange:A,onFilterChange:h,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,forceShowSelf:!0})})}));var Ht=a(79089),Jt=a(18501),Wt=a(25404);const _t={root:"Ef0cKSqQ",giftPreview:"IvuNzslN",backdrop:"dNukis4X",arrow:"oufsMLLF"},jt=4*Dt.$,Qt=3*Dt.$,Xt=(0,i.ph)(e=>{let{peer:t,gift:a}=e;const r=(0,i.Kr)(()=>(0,Q.uc)(a),[a]);if(r)return(0,C.FD)("div",{className:_t.root,children:[(0,C.FD)("div",{className:_t.giftPreview,children:[(0,C.Y)(ee.A,{className:_t.backdrop,backgroundColors:[r.backdrop.centerColor,r.backdrop.edgeColor],patternColor:r.backdrop?.patternColor,patternIcon:r.pattern?.sticker}),(0,C.Y)(Z.A,{className:_t.sticker,size:Qt,sticker:r.model?.sticker})]}),(0,C.Y)(f.A,{name:"next",className:_t.arrow}),(0,C.Y)(p.A,{peer:t,size:jt,className:_t.avatar})]})});var $t=a(94189);const Zt={modal:"nnublcCk",checkBox:"fjE0wGvw",checkBoxDescription:"tepUTe4z",upgradeIcon:"lgyInH5K",header:"p7FTs7_p",title:"pIbzzTir",description:"CCPfr26t",soldOut:"kjWcRp4W",modalContent:"o9rFZ6By",headerSplitButton:"XOMI_4PO",headerButton:"WA0INleU",giftResalePriceContainer:"BN8gf5y6",starAmountIcon:"_5guecUe",giftResalePriceStar:"H_q8o2vY",left:"aOhTHZlf",right:"rJOB1u5Q",footer:"bho0GTYt",footerDescription:"VUylTszM",unknown:"zDauXmpS",giftValue:"w_E4LkUj",uniqueValue:"uAjIRJva",uniqueAttribute:"OJQnkf17",attributeName:"dq7wCHJb",uniqueGift:"I6o_pGAm",modalHeader:"ie9tImaj",modalCloseButton:"p38RBGdC",ownerAddress:"DavMRg4Q",copyIcon:"SLX5tX8C"},ea=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;const i=a?.gift,r=i&&"gift"in i,s=e.currentUserId,l=r&&i.fromId,c=l?(0,o.PVB)(e,l):void 0,d=a?.peerId?(0,o.PVB)(e,a.peerId):void 0,u=d&&(0,n.vj)(d)?d:void 0,m=u&&(0,k.ub)(u,"postMessages"),p=(0,o.mBe)(e,s),f=a?.recipientId&&s!==a.recipientId?(0,o.PVB)(e,a.recipientId):void 0,h=p?.emojiStatus,g=e.collectibleEmojiStatuses?.statuses,A=r?i.gift:i,b="starGiftUnique"===A?.type&&A.releasedByPeerId;return{fromPeer:c,targetPeer:d,releasedByPeer:b?(0,o.PVB)(e,b):void 0,currentUserId:s,starGiftMaxConvertPeriod:e.appConfig.starGiftMaxConvertPeriod,tonExplorerUrl:e.appConfig.tonExplorerUrl,hasAdminRights:m,currentUserEmojiStatus:h,collectibleEmojiStatuses:g,currentUser:p,recipientPeer:f}})(e=>{let{modal:t,fromPeer:a,targetPeer:c,releasedByPeer:A,currentUserId:b,starGiftMaxConvertPeriod:S,hasAdminRights:v,currentUserEmojiStatus:N,collectibleEmojiStatuses:y,tonExplorerUrl:k,currentUser:G,recipientPeer:Y}=e;const{closeGiftInfoModal:w,changeGiftVisibility:P,convertGiftToStars:B,openChatWithInfo:M,focusMessage:T,openGiftUpgradeModal:U,showNotification:R,buyStarGift:x,closeGiftModal:O,openGiftInfoValueModal:L,updateResaleGiftsFilter:V,openGiftInMarket:E}=(0,r.ko)(),[q,J,W]=(0,D.A)(),_=(0,F.A)(),X=(0,m.A)(),[$,ee]=(0,i.J0)(!1),[te,ae]=(0,i.J0)(!1),ie=(0,i.li)(),re=(0,i.li)(),ne=(0,i.li)(),{isContextMenuOpen:oe,contextMenuAnchor:se,handleContextMenu:le,handleContextMenuClose:ce,handleContextMenuHide:de}=(0,Bt.A)(ie),ue=(0,u.A)(()=>{Be&&at?.pattern&&(E({gift:Be}),V({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[],patternAttributes:[{type:"pattern",documentId:at.pattern.sticker.id}]}}))}),pe=(0,u.A)(()=>{Be&&at?.backdrop&&(E({gift:Be}),V({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[{type:"backdrop",backdropId:at.backdrop.backdropId}],patternAttributes:[]}}))}),fe=(0,u.A)(()=>{Be&&at?.model&&(E({gift:Be}),V({filter:{sortType:"byDate",modelAttributes:[{type:"model",documentId:at.model.sticker.id}],backdropAttributes:[],patternAttributes:[]}}))}),he=Boolean(t),ge=(0,d.A)(t),Ae=(0,d.A)(a),Se=(0,d.A)(c),Ne=Se&&(0,n.vj)(Se),{gift:Ce}=ge||{},ye=Ce&&"gift"in Ce,ke=ye?Ce:void 0,Ge=ke?.fromId===b,Ye=ke&&S&&ke.date+S-(0,Ie.Fm)()||0,we=Math.ceil(Ye/60/60/24),Be=ye?Ce.gift:Ce,Me=Be&&(0,Q.yQ)(Be),Te=Ye>0&&Boolean(ke?.starsToConvert),De=Be&&"starGiftUnique"===Be.type,Fe=De?Be:void 0,Ue=(0,i.Kr)(()=>{if(Be&&"starGiftUnique"===Be.type){if(A){const e=`@${(0,Ht.Kl)(A)}`||(0,n.F9)(_,A),t=(0,n.mO)(A)?_("ActionFallbackUser"):_("ActionFallbackChannel");return _("GiftInfoCollectibleBy",{number:Be.number,owner:e||t},{withNodes:!0,withMarkdown:!0})}return _("GiftInfoCollectible",{number:Be.number})}},[Be,A,_]),Re="starGiftUnique"===Be?.type?Be.slug:void 0,xe=(0,i.Kr)(()=>{if(Re)return y?.find(e=>"collectible"===e.type&&e.slug===Re)},[Re,y]),Oe=Boolean(xe),Le=Boolean(ke?.upgradeMsgId),Ve=!Le&&ke?.inputGift&&(Ne?v:"starGift"===Be?.type?Se?.id===b:Be?.ownerId===b||Oe);function Ee(e){if(!De)return;const t=Be.resellPrice;return t?Be?.resaleTonOnly||e?t.find(e=>e.currency===I.ykW):t.find(e=>e.currency===I.OUy):void 0}const qe=Ee(),ze=Ee(te),He=!Oe&&"starGiftUnique"===Be?.type&&Be.ownerId!==b&&Boolean(qe),Je=(()=>{if(!De)return;const{ownerName:e,ownerId:t}=Be,a=(0,r.mS)(),i=t?(0,o.PVB)(a,t):void 0;return i?(0,n.F9)(_,i):e})(),We=(0,u.A)(()=>{w()}),_e=(0,u.A)(()=>{const e=Ge?Se:Ae;if(!ke?.upgradeMsgId||!e)return;const{upgradeMsgId:t}=ke;T({chatId:e.id,messageId:t}),We()}),je=(0,u.A)(()=>{const{inputGift:e,isUnsaved:t}=ke;P({gift:e,shouldUnsave:!t}),We()}),Qe=(0,u.A)(()=>{const{inputGift:e}=ke;B({gift:e}),W(),We()}),Xe=(0,u.A)(()=>{ke&&U({giftId:ke.gift.id,gift:ke})}),$e=(0,u.A)(()=>{"starGiftUnique"===Be?.type&&Ee()&&ee(!0)}),Ze=(0,u.A)(()=>{ee(!1)}),et=(0,u.A)(()=>{const e=Y||G,t=Ee(te);e&&t&&"starGiftUnique"===Be?.type&&(Ze(),O(),x({peerId:e.id,slug:Be.slug,price:t}))}),tt=(0,u.A)(()=>{Be&&"starGiftUnique"===Be.type&&L({gift:Be})}),at=(0,i.Kr)(()=>Be&&(0,Q.uc)(Be),[Be]),it=(0,i.Kr)(()=>(0,C.Y)("div",{className:(0,s.A)(Zt.headerButton,Zt.left),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":_("AriaMoreButton"),onContextMenu:le,onClick:le,children:(0,C.Y)(f.A,{name:"more",className:Zt.icon})}),[_,le]),rt=(0,u.A)(()=>He?(0,C.Y)(g.A,{noForcedUpperCase:!0,onClick:$e,children:_("ButtonBuyGift",{stars:qe?.currency===I.ykW?(0,me.Ms)(_,qe.amount,{shouldConvertFromNanos:!0}):(0,me.U2)(_,qe?.amount,{asFont:!0})},{withNodes:!0})}):Le?(0,C.Y)(g.A,{onClick:_e,children:_("GiftInfoViewUpgraded")}):Ve&&ke?.alreadyPaidUpgradeStars&&!ke.upgradeMsgId?(0,C.FD)(g.A,{isShiny:!0,onClick:Xe,children:[_("GiftInfoUpgradeForFree"),(0,C.Y)(f.A,{name:"arrow-down-circle",className:Zt.upgradeIcon})]}):Ve&&ke?.canUpgrade&&!ke.upgradeMsgId?(0,C.FD)(g.A,{isShiny:!0,onClick:Xe,children:[_("GiftInfoUpgrade"),(0,C.Y)(f.A,{name:"arrow-down-circle",className:Zt.upgradeIcon})]}):(0,C.Y)(g.A,{onClick:We,children:_("OK")})),nt=(0,i.Kr)(()=>{if(!Be)return;let e="";return"starGift"===Be.type&&(Be.firstSaleDate&&(e+=`${_("GiftInfoFirstSale")} ${(0,z.L2)(1e3*Be.firstSaleDate,_.code,!0)}`),Be.lastSaleDate&&(e+="\n",e+=`${_("GiftInfoLastSale")} ${(0,z.L2)(1e3*Be.lastSaleDate,_.code,!0)}`)),e},[Be,_]),ot=(0,i.Kr)(()=>{if(!Ce||!Be)return;const{fromId:e,isNameHidden:t,starsToConvert:a,isUnsaved:i,isConverted:c,upgradeMsgId:d}=ke||{},u=Te&&Boolean(a),m=t&&Se,g=(()=>{if(!ke)return _("GiftInfoSoldOutDescription");if(!Ne){if(ke.upgradeMsgId)return _("GiftInfoDescriptionUpgraded");if(Ve&&ke.canUpgrade&&ke.alreadyPaidUpgradeStars&&!ke.upgradeMsgId)return _("GiftInfoDescriptionUpgrade2");if(ke.canUpgrade&&Ve)return Ve?_("GiftInfoDescriptionFreeUpgrade"):_("GiftInfoPeerDescriptionFreeUpgradeOut",{peer:(0,n.F9)(_,Se)});if(Ve||Ge)return c&&u?Ve?_("GiftInfoDescriptionConverted",{amount:a},{pluralValue:a,withNodes:!0,withMarkdown:!0}):_("GiftInfoPeerDescriptionOutConverted",{amount:a,peer:(0,n.F9)(_,Se)},{pluralValue:a,withNodes:!0,withMarkdown:!0}):ke.canUpgrade&&Ve?u?_("GiftInfoDescriptionUpgrade",{amount:a},{pluralValue:a,withNodes:!0,withMarkdown:!0}):_("GiftInfoDescriptionUpgradeRegular"):Ve?u?_("GiftInfoDescription",{amount:a},{withNodes:!0,withMarkdown:!0,pluralValue:a}):_("GiftInfoDescriptionRegular"):u?_("GiftInfoPeerDescriptionOut",{amount:a,peer:(0,n.F9)(_,Se)},{withNodes:!0,withMarkdown:!0,pluralValue:a}):_("GiftInfoPeerDescriptionOutRegular",{peer:(0,n.F9)(_,Se)})}})(),b=(0,C.FD)("div",{className:Zt.modalHeader,children:[Boolean(qe?.amount)&&(0,C.Y)("div",{className:Zt.giftResalePriceContainer,children:qe.currency===I.ykW?(0,me.Ms)(_,qe.amount,{className:Zt.giftResalePriceStar,shouldConvertFromNanos:!0}):(0,me.U2)(_,qe.amount,{asFont:!0,className:Zt.giftResalePriceStar})}),(0,C.FD)("div",{className:Zt.headerSplitButton,ref:ie,children:[it,(0,C.Y)("div",{className:(0,s.A)(Zt.headerButton,Zt.right),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":_("Close"),onClick:We,children:(0,C.Y)(f.A,{name:"close",className:(0,s.A)(Zt.icon,Zt.moreIcon)})})]})]}),S=De&&(0,C.Y)("div",{ref:ne,className:(0,s.A)(Zt.header,Zt.uniqueGift),children:(0,C.Y)(Pe,{backdropAttribute:at.backdrop,patternAttribute:at.pattern,modelAttribute:at.model,title:Be.title,subtitle:Ue,subtitlePeer:A,showManageButtons:Ve,savedGift:ke})}),v=(0,C.FD)("div",{className:Zt.header,children:[(0,C.Y)(Z.A,{className:Zt.giftSticker,sticker:Me,size:120}),(0,C.Y)("h1",{className:Zt.title,children:De?Be.title:_(ke?Ve?"GiftInfoReceived":"GiftInfoTitle":"GiftInfoSoldOutTitle")}),Boolean(g)&&(0,C.Y)("p",{className:(0,s.A)(Zt.description,!ke&&"starGift"===Be?.type&&Zt.soldOut),children:g})]}),N=[];if("starGift"===Be.type){(e||t)&&N.push([_("GiftInfoFrom"),e?{chatId:e}:(0,C.FD)(C.FK,{children:[(0,C.Y)(p.A,{size:"small",peer:j.I5}),(0,C.Y)("span",{className:Zt.unknown,children:X(j.I5.titleKey)})]})]),ke?.date&&N.push([_("GiftInfoDate"),(0,C.Y)("span",{title:nt,children:(0,z.L2)(1e3*ke.date,_.code,!0)})]),Be.firstSaleDate&&!ke&&N.push([_("GiftInfoFirstSale"),(0,z.L2)(1e3*Be.firstSaleDate,_.code,!0)]),Be.lastSaleDate&&!ke&&N.push([_("GiftInfoLastSale"),(0,z.L2)(1e3*Be.lastSaleDate,_.code,!0)]);const i=Be.stars+(ke?.alreadyPaidUpgradeStars||0);N.push([_("GiftInfoValue"),(0,C.FD)("div",{className:Zt.giftValue,children:[(0,me.U2)(_,i,{className:Zt.starAmountIcon}),Ve&&Te&&Boolean(a)&&(0,C.Y)(K.A,{onClick:J,children:_("GiftInfoConvert",{amount:a},{pluralValue:a})})]})]),Be.availabilityTotal&&N.push([_("GiftInfoAvailability"),_("GiftInfoAvailabilityValue",{count:Be.availabilityRemains||0,total:Be.availabilityTotal},{pluralValue:Be.availabilityRemains||0})]),Be.upgradeStars&&!d&&N.push([_("GiftInfoStatus"),(0,C.Y)("div",{className:Zt.giftValue,children:_("GiftInfoStatusNonUnique")})]),ke?.message&&N.push([void 0,(0,Jt.fd)(ke.message)])}if(De){const{ownerName:e,ownerAddress:t,ownerId:a}=Be,i=a?(0,o.PVB)((0,r.mS)(),a):void 0,{model:s,backdrop:c,pattern:d,originalDetails:u}=at||{};if(t?N.push([_("GiftInfoOwner"),(0,C.FD)("span",{className:Zt.ownerAddress,onClick:()=>{(0,be.eM)(t),R({message:{key:"WalletAddressCopied"},icon:"copy"})},children:[t,(0,C.Y)(f.A,{className:Zt.copyIcon,name:"copy"})]})]):(i||e)&&N.push([_("GiftInfoOwner"),a?{chatId:a,withEmojiStatus:!0}:e||""]),s&&N.push([_("GiftAttributeModel"),(0,C.FD)("span",{className:Zt.uniqueAttribute,children:[(0,C.Y)("span",{className:Zt.attributeName,onClick:fe,children:s.name}),(0,C.Y)(K.A,{children:(0,H.l9)(s.rarityPercent)})]})]),c&&N.push([_("GiftAttributeBackdrop"),(0,C.FD)("span",{className:Zt.uniqueAttribute,children:[(0,C.Y)("span",{className:Zt.attributeName,onClick:pe,children:c.name}),(0,C.Y)(K.A,{children:(0,H.l9)(c.rarityPercent)})]})]),d&&N.push([_("GiftAttributeSymbol"),(0,C.FD)("span",{className:Zt.uniqueAttribute,children:[(0,C.Y)("span",{className:Zt.attributeName,onClick:ue,children:d.name}),(0,C.Y)(K.A,{children:(0,H.l9)(d.rarityPercent)})]})]),N.push([_("GiftInfoAvailability"),_("GiftInfoIssued",{issued:Be.issuedCount,total:Be.totalCount})]),Be.valueAmount&&Be.valueCurrency&&N.push([_("GiftInfoValue"),(0,C.FD)("span",{className:Zt.uniqueValue,children:["~"," ",(0,l.Ad)(Be.valueAmount,Be.valueCurrency,_.code),(0,C.Y)(K.A,{onClick:tt,children:_("GiftInfoValueLinkMore")})]})]),u){const{date:e,recipientId:t,message:a,senderId:i}=u,s=(0,r.mS)(),l=e=>{M({id:e}),w()},c=(0,o.PVB)(s,t),d=i?(0,o.PVB)(s,i):void 0,m=(0,z.L2)(1e3*e,_.code,!0),p=(0,C.Y)(ct.A,{onClick:()=>l(t),isPrimary:!0,children:(0,n.F9)(_,c)});let f;if(d&&i!==t){const e=(0,C.Y)(ct.A,{onClick:()=>l(d.id),isPrimary:!0,children:(0,n.F9)(_,d)});f=a?_("GiftInfoPeerOriginalInfoTextSender",{peer:p,sender:e,text:(0,Jt.fd)(a),date:m},{withNodes:!0}):_("GiftInfoPeerOriginalInfoSender",{peer:p,date:m,sender:e},{withNodes:!0})}else f=a?_("GiftInfoPeerOriginalInfoText",{peer:p,text:(0,Jt.fd)(a),date:m},{withNodes:!0}):_("GiftInfoPeerOriginalInfo",{peer:p,date:m},{withNodes:!0});N.push([void 0,(0,C.Y)("span",{children:f})])}}const y=k&&De&&Be.giftAddress&&`${k}${Be.giftAddress}`,G=(0,C.FD)("div",{className:Zt.footer,children:[(Ve||y||He)&&(0,C.FD)("div",{className:Zt.footerDescription,children:[y&&(0,C.Y)("div",{children:_("GiftInfoTonText",{link:(0,C.Y)(h.A,{url:y,shouldSkipModal:!0,text:_("GiftInfoTonLinkText")})},{withNodes:!0})}),Ve&&(0,C.Y)("div",{children:_(`GiftInfo${Ne?"Channel":""}${i?"Hidden":"Saved"}`,{link:(0,C.Y)(ct.A,{isPrimary:!0,onClick:je,children:_("GiftInfoSaved"+(i?"Show":"Hide"))})},{withNodes:!0})}),!He&&m&&(0,C.Y)("div",{children:_("GiftInfoSenderHidden")}),He&&Je&&(0,C.Y)("div",{children:_("GiftInfoBuyGift",{user:Je},{withNodes:!0})})]}),rt()]});return{modalHeader:De?b:void 0,header:De?S:v,tableData:N,footer:G}},[Ce,ke,Se,Me,_,Ve,Te,Ge,X,k,Be,at,rt,Ne,it,De,nt,He,Je,qe,Ue,A,ue,pe,fe]),st=(0,u.A)(()=>ne.current),lt=(0,u.A)(()=>ie.current),dt=(0,u.A)(()=>re.current),ut=(0,u.A)(()=>({withPortal:!0})),mt=se&&Ce&&(0,C.Y)(Mt.A,{ref:re,isOpen:oe,anchor:se,className:"gift-context-menu with-menu-transitions",autoClose:!0,withPortal:!0,onClose:ce,onCloseAnimationEnd:de,positionX:"right",getTriggerElement:lt,getRootElement:st,getMenuElement:dt,getLayout:ut,children:(0,C.Y)(Wt.A,{peerId:ge.peerId,gift:Ce,canManage:Ve,collectibleEmojiStatuses:y,currentUserEmojiStatus:N})});return(0,C.FD)(C.FK,{children:[(0,C.Y)(ve.A,{isOpen:he,modalHeader:ot?.modalHeader,header:ot?.header,hasBackdrop:De,tableData:ot?.tableData,footer:ot?.footer,className:Zt.modal,contentClassName:Zt.modalContent,onClose:We,withBalanceBar:Boolean(He),currencyInBalanceBar:ze?.currency,isLowStackPriority:!0}),mt,Fe&&G&&Boolean(ze)&&(0,C.FD)($t.A,{isOpen:$,noDefaultTitle:!0,onClose:Ze,confirmLabel:_("ButtonBuyGift",{stars:ze?.currency===I.ykW?(0,me.Ms)(_,ze.amount,{shouldConvertFromNanos:!0}):(0,me.U2)(_,ze.amount,{asFont:!0})},{withNodes:!0}),confirmHandler:et,children:[(0,C.Y)(Xt,{peer:Y||G,gift:Fe}),!Y&&(0,C.Y)("p",{children:_("GiftBuyConfirmDescription",{gift:_("GiftUnique",{title:Fe.title,number:Fe.number}),stars:ze?.currency===I.ykW?(0,me.QH)(_,ze.amount,!0):(0,me.Kk)(_,ze.amount)},{withNodes:!0,withMarkdown:!0})}),Y&&(0,C.Y)("p",{children:_("GiftBuyForPeerConfirmDescription",{gift:_("GiftUnique",{title:Fe.title,number:Fe.number}),stars:ze?.currency===I.ykW?(0,me.QH)(_,ze.amount,!0):(0,me.Kk)(_,ze.amount),peer:(0,n.F9)(_,Y)},{withNodes:!0,withMarkdown:!0})}),!Fe.resaleTonOnly&&(0,C.FD)(C.FK,{children:[(0,C.Y)(Ke.A,{className:Zt.checkBox,label:_("LabelPayInTON"),checked:te,onCheck:ae}),(0,C.Y)("div",{className:Zt.checkBoxDescription,children:_("DescriptionPayInTON")})]})]}),ke&&(0,C.FD)($t.A,{isOpen:q,onClose:W,confirmHandler:Qe,title:_("GiftInfoConvertTitle"),children:[(0,C.Y)("div",{children:_("GiftInfoPeerConvertDescription",{amount:(0,me.Kk)(_,ke.starsToConvert),peer:(0,n.F9)(_,Ae)},{withNodes:!0,withMarkdown:!0})}),Te&&(0,C.Y)("div",{children:_("GiftInfoConvertDescriptionPeriod",{count:we},{withNodes:!0,withMarkdown:!0,pluralValue:we})}),(0,C.Y)("div",{children:_("GiftInfoConvertDescription2")})]})]})})),ta="hspYTy7V",aa=(0,i.ph)(e=>{let{modal:t}=e;const{closeGiftInfoValueModal:a,openUrl:n,openGiftInMarket:o}=(0,r.ko)(),s=(0,F.A)(),c=Boolean(t),m=(0,d.A)(t),p=(0,u.A)(()=>{t?.valueInfo.fragmentListedUrl&&n({url:t.valueInfo.fragmentListedUrl})}),f=(0,u.A)(()=>{t?.gift&&o({gift:t.gift})}),h=(0,i.Kr)(()=>{if(!m)return;const{gift:e,valueInfo:t}=m,a=(0,Q.uc)(e);if(!a)return;const i=(0,C.FD)("div",{className:"v4GJBsdC",children:[(0,C.Y)(Z.A,{className:"lJodRD0R",sticker:a.model.sticker,size:120}),(0,C.Y)(g.A,{pill:!0,size:"tiny",fluid:!0,nonInteractive:!0,children:(0,l.Ad)(t.value,t.currency,s.code)}),(0,C.Y)("div",{className:"VjWaO8un",children:s("GiftValueDescription",{giftName:e.title},{withMarkdown:!0,withNodes:!0})})]}),r=[];r.push([s("GiftValueTitleInitialSale"),(0,z.A)(1e3*t.initialSaleDate,s.code)]),r.push([s("GiftValueTitleInitialPrice"),(0,C.FD)("span",{className:"K7zsAhVt",children:[(0,me.U2)(s,t.initialSaleStars,{className:"Xw91xwpe"})," (~ ",(0,l.Ad)(t.initialSalePrice,t.currency,s.code),")"]})]),t.lastSaleDate&&r.push([s("GiftValueTitleLastSale"),(0,z.A)(1e3*t.lastSaleDate,s.code)]),t.lastSalePrice&&r.push([s("GiftValueTitleLastPrice"),(0,l.Ad)(t.lastSalePrice,t.currency,s.code)]),t.floorPrice&&r.push([s("GiftValueTitleMinimumPrice"),(0,l.Ad)(t.floorPrice,t.currency,s.code)]),t.averagePrice&&r.push([s("GiftValueTitleAveragePrice"),(0,l.Ad)(t.averagePrice,t.currency,s.code)]);const n=Boolean(t.fragmentListedUrl&&t.fragmentListedCount),o=Boolean(t.listedCount&&t.listedCount);return{header:i,tableData:r,footer:(n||o)&&(0,C.FD)("div",{className:"OJDo2xUd",children:[n&&(0,C.FD)(g.A,{isText:!0,onClick:p,noForcedUpperCase:!0,size:"tiny",children:[s.number(t.fragmentListedCount),(0,C.Y)(Z.A,{className:ta,sticker:a.model.sticker,size:24}),s("GiftValueForSaleOnFragment")]}),o&&(0,C.FD)(g.A,{isText:!0,noForcedUpperCase:!0,size:"tiny",onClick:f,children:[s.number(t.listedCount),(0,C.Y)(Z.A,{className:ta,sticker:a.model.sticker,size:24}),s("GiftValueForSaleOnTelegram")]})]})}},[s,m,p,f]);if(h)return(0,C.Y)(ve.A,{isOpen:c,onClose:a,header:h.header,tableData:h.tableData,footer:h.footer})});var ia=a(40664);const ra=(0,i.ph)((0,r.EK)(e=>{const t=e.appConfig.starsStargiftResaleCommissionPermille,a=t?t/1e3:void 0,i=e.appConfig.starsStargiftResaleAmountMin||0,r=e.appConfig.starsStargiftResaleAmountMax,n=e.appConfig.starsUsdWithdrawRateX1000,o=n?n/1e3:1,s=e.appConfig.tonStargiftResaleCommissionPermille,c=s?s/1e3:0,d=(0,l.wD)(e.appConfig.tonStargiftResaleAmountMin||0),u=e.appConfig.tonStargiftResaleAmountMax;return{starsStargiftResaleCommissionPermille:a,starsStargiftResaleAmountMin:i,starsStargiftResaleAmountMax:r,starsUsdWithdrawRate:o,tonStargiftResaleCommissionPermille:c,tonStargiftResaleAmountMin:d,tonStargiftResaleAmountMax:u&&(0,l.wD)(u),tonUsdRate:e.appConfig.tonUsdRate}})(e=>{let{modal:t,starsStargiftResaleCommissionPermille:a,starsStargiftResaleAmountMin:n,starsStargiftResaleAmountMax:o,starsUsdWithdrawRate:s,tonStargiftResaleCommissionPermille:c,tonStargiftResaleAmountMin:m,tonStargiftResaleAmountMax:p,tonUsdRate:f}=e;const{closeGiftResalePriceComposerModal:h,closeGiftInfoModal:b,updateStarGiftPrice:S,showNotification:v}=(0,r.ko)(),N=Boolean(t),[y,I]=(0,i.J0)(void 0),[k,G]=(0,i.J0)(!1),Y=(0,d.A)(t),{gift:w}=Y||{},P=w&&"gift"in w?w:void 0,B=Boolean(y),M=(0,F.A)(),T=(0,u.A)(e=>{const t=e.target.value,a=parseFloat(t),i=k?p:o,r=""===t||Number.isNaN(a)?void 0:i?Math.min(a,i):a;I(r)}),D=(0,u.A)(()=>{h()}),U=(0,u.A)(()=>{P&&"starGiftUnique"===P.gift.type&&P.inputGift&&y&&(h(),b(),S({gift:P.inputGift,price:{currency:k?"TON":"XTR",amount:k?(0,l.tT)(y):y,nanos:0}}),v({icon:"sell-outline",message:{key:"NotificationGiftIsSale",variables:{gift:M("GiftUnique",{title:P.gift.title,number:P.gift.number})}}}))}),R=k?c:a,x=k?m:n,O=B&&y>=x;return(0,C.FD)(A.A,{isOpen:N,title:M(k?"PriceInTON":"PriceInStars"),hasCloseButton:!0,isSlim:!0,onClose:D,children:[(0,C.Y)("div",{className:"ElDo1Bru",children:(0,C.Y)(ia.A,{label:M(k?"EnterPriceInTon":"EnterPriceInStars"),onChange:T,value:y?.toString(),inputMode:"numeric",tabIndex:0,teactExperimentControlled:!k})}),(0,C.FD)("div",{className:"SGFmA4kL",children:[(0,C.FD)("span",{children:[!O&&Boolean(R)&&M("DescriptionComposerGiftMinimumPrice",{stars:k?(0,me.QH)(M,x):(0,me.Kk)(M,x)},{withMarkdown:!0,withNodes:!0}),O&&(()=>{const e=R?Number((y*R).toFixed()):y;return M("DescriptionComposerGiftResalePrice",{stars:k?(0,me.QH)(M,e):(0,me.Kk)(M,e)},{withMarkdown:!0,withNodes:!0})})()]}),O&&Boolean(k?f:s)&&(0,C.Y)("span",{className:"r9R0VR_w",children:`≈ ${(0,l.Ad)(k?(0,l.C)(y,f):y*s,"USD",M.code)}`})]}),(0,C.Y)(Ke.A,{className:"yt_nODdj",label:M("OnlyAcceptTON"),checked:k,onCheck:G}),(0,C.Y)("div",{className:"pWjQiY4m",children:M("OnlyAcceptTONDescription")}),(0,C.FD)(g.A,{noForcedUpperCase:!0,disabled:!O,onClick:U,children:[O&&M("ButtonSellGift",{stars:k?(0,me.Ms)(M,y):(0,me.U2)(M,y,{asFont:!0})},{withNodes:!0}),!O&&M("Sell")]})]})}));var na=a(58554),oa=a(32625),sa=a(5463);const la="_Dt6RSQV",ca=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;const i=a?.recipientId;return{recipient:i?(0,o.PVB)(e,i):void 0}})(e=>{let{modal:t,recipient:a}=e;const{closeGiftUpgradeModal:o,upgradeGift:s}=(0,r.ko)(),l=Boolean(t),c=(0,d.A)(t),m=(0,d.A)(a),[p,f]=(0,i.J0)(!1),[h,A]=(0,i.J0)(),b=(0,F.A)(),S=(0,u.A)(()=>o()),v=(0,u.A)(()=>{const e=c?.gift;e?.inputGift&&(s({gift:e.inputGift,shouldKeepOriginalDetails:p,upgradeStars:e.alreadyPaidUpgradeStars?void 0:e.gift.upgradeStars}),S())}),N=(0,u.A)(()=>{c?.sampleAttributes&&A(function(e,t){const a=e.filter(e=>"model"===e.type&&e.name!==t?.model.name),i=e.filter(e=>"pattern"===e.type&&e.name!==t?.pattern.name),r=e.filter(e=>"backdrop"===e.type&&e.name!==t?.backdrop.name);return{model:a[Math.floor(Math.random()*a.length)],pattern:i[Math.floor(Math.random()*i.length)],backdrop:r[Math.floor(Math.random()*r.length)]}}(c.sampleAttributes,h))});(0,oa.A)(N,l?3e3:void 0,!0),(0,i.vJ)(()=>{l&&c?.sampleAttributes&&N()},[l,c?.sampleAttributes]),(0,i.vJ)(()=>{const e=c?.sampleAttributes;e&&[...e.filter(e=>"pattern"===e.type).map(e=>e.sticker),...e.filter(e=>"model"===e.type).map(e=>e.sticker)].map(e=>(0,k.Mw)(e,"full")).forEach(e=>{(0,na.hd)(e,nt.qZ.BlobUrl)})},[c?.sampleAttributes]);const y=(0,i.Kr)(()=>{if(!h||!l)return;const e=c?.gift,t=[["diamond",b("GiftUpgradeUniqueTitle"),b("GiftUpgradeUniqueDescription")],["trade",b("GiftUpgradeTransferableTitle"),b("GiftUpgradeTransferableDescription")],["auction",b("GiftUpgradeTradeableTitle"),b("GiftUpgradeTradeableDescription")]],a=m?b("GiftPeerUpgradeText",{peer:(0,n.F9)(b,m)}):b("GiftUpgradeTextOwn");return{listItemData:t,header:(0,C.Y)(Pe,{modelAttribute:h.model,backdropAttribute:h.backdrop,patternAttribute:h.pattern,title:b("GiftUpgradeTitle"),subtitle:a}),footer:(0,C.FD)("div",{className:"EWaVCxY4",children:[!e&&(0,C.Y)(g.A,{className:la,onClick:S,children:b("OK")}),e&&(0,C.FD)(C.FK,{children:[(0,C.Y)(Ke.A,{label:b("GiftUpgradeKeepDetails"),onCheck:f,checked:p}),(0,C.Y)(g.A,{className:la,isShiny:!0,onClick:v,children:e.alreadyPaidUpgradeStars?b("GeneralConfirm"):b("GiftUpgradeButton",{amount:(0,me.U2)(b,e.gift.upgradeStars,{asFont:!0})},{withNodes:!0})})]})]})}},[h,l,b,m,c?.gift,p]);return(0,C.Y)(sa.A,{isOpen:l,header:y?.header,footer:y?.footer,listItemData:y?.listItemData,hasBackdrop:!0,onClose:S})}));var da=a(47483);const ua=(0,i.ph)((0,r.EK)(e=>({currentUser:(0,o.mBe)(e,e.currentUserId),isCurrentUserPremium:(0,o.g29)(e)}))(e=>{let{modal:t,currentUser:a,isCurrentUserPremium:n}=e;const{closeGiftStatusInfoModal:o,setEmojiStatus:l}=(0,r.ko)(),c=(0,F.A)(),m=Boolean(t),h=(0,d.A)(t),{emojiStatus:A}=h||{},b=A?.textColor,S=(0,da.A)(A?.patternDocumentId),v=(0,u.A)(()=>{o()}),N=(0,u.A)(()=>{A&&l({emojiStatus:A}),o()}),y=(0,i.Kr)(()=>{if(!A||!m)return;const e=[A.centerColor,A.edgeColor],t=A.patternColor;return(0,C.Y)(ee.A,{className:"_1RfhkfB",backgroundColors:e,patternColor:t,patternIcon:S.customEmoji})},[A,m,S]),I=(0,i.Kr)(()=>({...a,emojiStatus:A}),[a,A]),k=(0,i.Kr)(()=>(0,C.FD)("div",{className:"qL0cHbwS",children:[(0,C.FD)("div",{className:(0,s.A)("t18QCmAb"),style:(0,Ce.A)(b&&`color: ${b}`),children:[y,(0,C.Y)(p.A,{peer:I,size:"jumbo",className:"JK2zOWA7"}),(0,C.Y)(Le.A,{peer:I,className:"lxxbgNCl",withEmojiStatus:!0,noFake:!0,noVerified:!0,statusSparklesColor:b}),(0,C.Y)("p",{className:"MLMdxkUg",style:(0,Ce.A)(b&&`color: ${b}`),children:c("Online")})]}),(0,C.FD)("div",{className:"q8w7tnmR",children:[(0,C.Y)("div",{className:"wxg_5ou_",children:c("UniqueStatusWearTitle",{gift:I?.emojiStatus?.title})}),(0,C.Y)("div",{className:"KSCLIMZm",children:c("UniqueStatusBenefitsDescription")})]})]}),[b,y,I,c]),G=[["radial-badge",c("UniqueStatusBadgeBenefitTitle"),c("UniqueStatusBadgeDescription")],["unique-profile",c("UniqueStatusProfileDesignBenefitTitle"),c("UniqueStatusProfileDesignDescription")],["proof-of-ownership",c("UniqueStatusProofOfOwnershipBenefitTitle"),c("UniqueStatusProofOfOwnershipDescription")]],Y=(0,i.Kr)(()=>{if(m)return(0,C.Y)("div",{className:"VDrvalBo",children:(0,C.FD)(g.A,{onClick:N,children:[c("UniqueStatusWearButton"),!n&&(0,C.Y)(f.A,{name:"lock-badge",className:"jiPObOWv"})]})})},[c,n,m]);return(0,C.Y)(sa.A,{isOpen:m,header:k,listItemData:G,footer:Y,hasBackdrop:!0,onClose:v})}));var ma=a(21309),pa=a(15535);const fa={header:"LQgz8Nlx",giftPreview:"hgs0ts_O",backdrop:"OnBhMaBw",description:"HBxB4QPY",arrow:"kXTOUpfb",noPassword:"BnqLhoKr"},ha={isCustomPeer:!0,avatarIcon:"fragment",title:"",customPeerAvatarColor:"#000000"},ga=4.5*Dt.$,Aa=(0,i.ph)((0,r.EK)(e=>{const{settings:{byKey:{hasPassword:t}},twoFaSettings:{hint:a}}=e;return{hasPassword:t,passwordHint:a}})(e=>{let{modal:t,hasPassword:a,passwordHint:n}=e;const{closeGiftWithdrawModal:o,clearGiftWithdrawError:s,closeGiftInfoModal:l,processStarGiftWithdrawal:c,openSettingsScreen:m}=(0,r.ko)(),h=Boolean(t),[b,S]=(0,i.J0)(!1),v=(0,F.A)(),N=(0,d.A)(t),y=N?.gift?.gift,I=y&&(0,Q.uc)(y),k=N?.gift?.canExportAt?Math.max(N.gift.canExportAt-(0,Ie.Fm)(),0):void 0,G=(0,u.A)(()=>{o()}),Y=(0,u.A)(e=>{c({gift:N.gift.inputGift,password:e})}),w=(0,u.A)(()=>{m({screen:Ae.VS.TwoFaDisabled}),o(),l()});return(0,C.FD)(A.A,{isOpen:h,title:v("GiftWithdrawTitle"),hasCloseButton:!0,isSlim:!0,onClose:G,children:[I&&(0,C.FD)(C.FK,{children:[(0,C.FD)("div",{className:fa.header,children:[(0,C.FD)("div",{className:fa.giftPreview,children:[(0,C.Y)(ee.A,{className:fa.backdrop,backgroundColors:[I.backdrop.centerColor,I.backdrop.edgeColor],patternColor:I.backdrop?.patternColor,patternIcon:I.pattern?.sticker}),(0,C.Y)(Z.A,{className:fa.sticker,size:ga,sticker:I.model?.sticker})]}),(0,C.Y)(f.A,{name:"next",className:fa.arrow}),(0,C.Y)(p.A,{peer:ha,size:"giant",className:fa.avatar})]}),(0,C.Y)("p",{className:fa.description,children:v("GiftWithdrawDescription",{gift:`${y.title} #${y.number}`},{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]})})]}),Boolean(k)&&(0,C.Y)("p",{className:fa.exportHint,children:v("GiftWithdrawWait",{days:(0,ma._k)(k)},{pluralValue:(0,ma._k)(k)})}),!a&&(0,C.FD)(C.FK,{children:[(0,C.Y)("span",{className:fa.noPassword,children:v("ErrorPasswordMissing")}),(0,C.Y)(g.A,{className:"mt-2",onClick:w,children:v("SetUp2FA")})]}),a&&!k&&(0,C.Y)(pa.A,{shouldShowSubmit:!0,placeholder:v("CheckPasswordPlaceholder"),error:N?.errorKey&&v.withRegular(N?.errorKey),description:v("CheckPasswordDescription"),onClearError:s,isLoading:N?.isLoading,hint:n,isPasswordVisible:b,shouldResetValue:h,onChangePasswordVisibility:S,submitLabel:v("GiftWithdrawSubmit"),onSubmit:Y})]})}));var ba=a(79824),Sa=a(74984),va=a(4875),Na=a(56863),Ca=a(30857),ya=a(84080),Ia=a(56133),ka=a(35297);function Ga(){}const Ya=300;async function wa(e){const t=await(0,va.px)("searchChats",{query:e});if(t)return[...t.accountResultIds,...t.globalResultIds]}const Pa=(0,i.ph)((0,r.EK)(e=>{const{contactList:t,currentUserId:a}=e;return{contactIds:t?.userIds,currentUserId:a}})(e=>{let{modal:t,contactIds:a,currentUserId:s}=e;const{closeGiftTransferModal:l,openGiftWithdrawModal:c,transferGift:m}=(0,r.ko)(),p=Boolean(t),f=(0,F.A)(),[h,g]=(0,i.J0)(""),A=(0,d.A)(t),b=A?.gift?.gift,S=b&&(0,Q.uc)(b),[v,N]=(0,i.J0)(),y=(0,d.A)(v),k=(0,i.Kr)(()=>{const e=(0,r.mS)();return y?(0,o.PVB)(e,y):void 0},[y]),B=(0,Sa.Rh)(I.DSF),M=(0,i.Kr)(()=>(0,G.Am)([...a||[],...B||[]]),[a,B]),{result:T,currentResultsQuery:D}=function(e){let{query:t,queryFn:a=wa,defaultValue:r,debounceTimeout:n=Ya,isDisabled:o}=e;const s=function(e,t,a){const[r,n]=(0,i.J0)(),{isFrozen:o,updateWhenUnfrozen:s}=function(){const e=(0,i.li)(!1),t=(0,i.hb)(()=>{e.current=!0},[]),a=(0,Ca.A)(),r=(0,i.hb)(()=>{e.current&&(e.current=!1,a())},[a]);return(0,ya.Ay)(Ga,r),{isFrozen:(0,i.OV)(),updateWhenUnfrozen:t}}(),l=(0,Ia.A)(t,!0);return(0,ka.A)(()=>{o?s():l(()=>{n(e())})},[...a,o]),r}(()=>t,n,[t]),[l,c]=(0,i.J0)(""),d=t?s:t,m=(0,u.A)(a);return{...(0,Na.A)(async()=>{if(!d||o)return c(""),Promise.resolve(r);const e=await m(d);return c(d),e},[d,r,m,o],r),currentResultsQuery:l}}({query:h,defaultValue:M}),U=D!==h,R=(0,i.Kr)(()=>D?ba.p:[{type:"withdraw",isCustomPeer:!0,avatarIcon:"toncoin",peerColorId:5,title:f("GiftTransferTON")}],[f,D]),x=(0,u.A)(e=>{"withdraw"===e&&(c({gift:A.gift}),l())}),O=(0,i.Kr)(()=>{if(U)return ba.p;const e=(0,r.mS)();return(0,Y.A)((T||[]).filter(t=>t!==s&&(0,o.X2D)(e,t)),!1)},[U,T,s]),L=(0,u.A)(()=>{N(void 0)});(0,i.vJ)(()=>{p||N(void 0)},[p]);const K=(0,u.A)(()=>{A?.gift.inputGift&&(m({gift:A.gift.inputGift,recipientId:y,transferStars:A.gift.transferStars}),L(),l())});return(0,C.FD)(P.A,{isOpen:p,onClose:l,title:f("GiftTransferTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,ignoreFreeze:!0,children:[(0,C.Y)(w.A,{itemIds:O,categories:R,onSelectedCategoryChange:x,withDefaultPadding:!0,withPeerUsernames:!0,isSearchable:!0,noScrollRestore:!0,isLoading:U,filterValue:h,filterPlaceholder:f("Search"),onFilterChange:g,onSelectedIdChange:N}),S&&(0,C.FD)($t.A,{isOpen:Boolean(v),noDefaultTitle:!0,onClose:L,confirmLabel:A?.gift.transferStars?f("GiftTransferConfirmButton",{amount:(0,me.U2)(f,A.gift.transferStars,{asFont:!0})},{withNodes:!0}):f("GiftTransferConfirmButtonFree"),confirmHandler:K,children:[k&&(0,C.Y)(Xt,{peer:k,gift:b}),(0,C.Y)("p",{children:A?.gift.transferStars?f("GiftTransferConfirmDescription",{gift:f("GiftUnique",{title:b.title,number:b.number}),amount:(0,me.Kk)(f,A.gift.transferStars),peer:(0,n.F9)(f,k)},{withNodes:!0,withMarkdown:!0}):f("GiftTransferConfirmDescriptionFree",{gift:f("GiftUnique",{title:b.title,number:b.number}),peer:(0,n.F9)(f,k)},{withNodes:!0,withMarkdown:!0})})]})]})})),Ba=(0,i.ph)((0,r.EK)((e,t)=>{let{modal:a}=t;return{user:a?.userId?(0,o.mBe)(e,a.userId):void 0}})(e=>{let{modal:t,user:a}=e;const{closeChatRefundModal:o,toggleNoPaidMessagesException:s}=(0,r.ko)(),[l,c]=(0,i.J0)(!1),m=(0,d.A)(t),p=(0,d.A)(a),{starsToRefund:f,userId:h}=m||{},g=(0,F.A)(),A=Boolean(t),b=(0,u.A)(()=>{o(),h&&s({userId:h,shouldRefundCharged:l})});return(0,C.FD)($t.A,{isOpen:A,onClose:o,title:g("RemoveFeeTitle"),confirmLabel:g("ConfirmRemoveMessageFee"),confirmHandler:b,children:[g("ConfirmDialogMessageRemoveFee",{peer:p&&(0,n.F9)(g,p)},{withMarkdown:!0,withNodes:!0}),Boolean(f)&&(0,C.Y)(Ke.A,{className:"dialog-checkbox",label:g("ConfirmDialogRemoveFeeRefundStars",{amount:(0,me.Kk)(g,f)},{withMarkdown:!0,withNodes:!0}),checked:l,onCheck:c})]})}));var Ma=a(14487);const Ta=(0,i.ph)((0,r.EK)(e=>{const t=e.stars?.balance,a=e.ton?.balance?.amount;return{starBalance:t,tonBalance:a}})(e=>{let{modal:t,starBalance:a,tonBalance:n}=e;const o=(0,r.ko)(),s=(0,F.A)(),c=(0,i.hb)(()=>{if(!t?.directInfo)return void o.closePriceConfirmModal();const{currency:e,newAmount:i}=t,r="TON"===e,s=r?n:a?.amount;if(void 0!==s){if(s<i)return o.openStarsBalanceModal({currency:r?"TON":"XTR",tabId:(0,Ma.g0)()}),void o.closePriceConfirmModal();o.sendStarPaymentForm({directInfo:t.directInfo,tabId:(0,Ma.g0)()}),o.closePriceConfirmModal()}else o.closePriceConfirmModal()},[t,a,n,o]),d=(0,i.hb)(()=>{o.closePriceConfirmModal()},[o]);if(!t)return;const{originalAmount:u,newAmount:m,currency:p}=t;let f,h;return"TON"===p?(f=(0,me.QH)(s,(0,l.wD)(u)),h=(0,me.QH)(s,(0,l.wD)(m))):(f=(0,me.Kk)(s,u),h=(0,me.Kk)(s,m)),(0,C.Y)($t.A,{isOpen:Boolean(t),onClose:d,title:s("PriceChanged"),confirmHandler:c,confirmLabel:s("PayNewPrice"),children:(0,C.Y)("p",{children:s("PriceChangedText",{originalAmount:f,newAmount:h},{withMarkdown:!0,withNodes:!0})})})}))}}]);
//# sourceMappingURL=6930.84e636b92ff150e5e6f5.js.map