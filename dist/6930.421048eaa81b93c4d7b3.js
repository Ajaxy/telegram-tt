"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[6930],{25404:(e,t,i)=>{i.d(t,{A:()=>p});var a=i(84051),n=i(13439),r=i(31481),o=i(85982),s=i(17663),l=i(80140),c=i(39351),d=i(17712),u=i(59030),m=i(24433),f=i(20021);const p=(0,a.ph)(({peerId:e,canManage:t,gift:i,currentUserEmojiStatus:p,collectibleEmojiStatuses:h})=>{const{showNotification:A,openChatWithDraft:g,openGiftTransferModal:b,openGiftResalePriceComposerModal:v,openGiftStatusInfoModal:N,setEmojiStatus:S,toggleSavedGiftPinned:G,changeGiftVisibility:C,updateStarGiftPrice:I,closeGiftInfoModal:y}=(0,n.ko)(),k=(0,c.A)(),Y=(0,u.A)(),B=i&&"gift"in i,D=B?i:void 0,P=B?i.gift:i,w="starGiftUnique"===P?.type?P.slug:void 0,T=(0,a.Kr)(()=>{if(w)return`${r.jsp}nft/${w}`},[w]),M=(0,a.Kr)(()=>{if(w)return h?.find(e=>"collectible"===e.type&&e.slug===w)},[w,h]),F="collectible"===p?.type?p.slug:void 0,U=P&&"starGiftUnique"===P.type,R=U&&F===P.slug,x=M&&!R,L=U?P.resellPrice:void 0,K=t&&D&&!D.isUnsaved&&U,O=(0,d.A)(()=>{const{inputGift:e,isUnsaved:t}=D;C({gift:e,shouldUnsave:!t})}),V=(0,d.A)(()=>{T&&((0,o.eM)(T),A({message:k("LinkCopied")}))}),E=(0,d.A)(()=>{T&&g({text:{text:T}})}),q=(0,d.A)(()=>{D&&"starGiftUnique"===D?.gift.type&&(D.canTransferAt&&D.canTransferAt>(0,l.Fm)()?A({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,s.U)(Y,1e3*D.canTransferAt)}}}):b({gift:D}))}),H=(0,d.A)(()=>{D&&(D.canResellAt&&D.canResellAt>(0,l.Fm)()?A({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,s.U)(Y,1e3*D.canResellAt)}}}):v({peerId:e,gift:D}))}),z=(0,d.A)(()=>{D&&"starGiftUnique"===D.gift.type&&D.inputGift&&(y(),I({gift:D.inputGift,price:{currency:r.OUy,amount:0,nanos:0}}),A({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:k("GiftUnique",{title:D.gift.title,number:D.gift.number})}}}))}),J=(0,d.A)(()=>{"starGiftUnique"===P?.type&&M&&N({emojiStatus:M})}),W=(0,d.A)(()=>{R&&S({emojiStatus:{type:"regular",documentId:r.zNY}})}),j=(0,d.A)(()=>{G({peerId:e,gift:D})});return(0,f.FD)(f.FK,{children:[K&&(0,f.Y)(m.A,{icon:D.isPinned?"unpin":"pin",onClick:j,children:k(D.isPinned?"ChatListUnpinFromTop":"ChatListPinToTop")}),(0,f.Y)(m.A,{icon:"link-badge",onClick:V,children:k("CopyLink")}),(0,f.Y)(m.A,{icon:"forward",onClick:E,children:k("Share")}),t&&U&&(0,f.Y)(m.A,{icon:"diamond",onClick:q,children:k("GiftInfoTransfer")}),t&&U&&!L&&(0,f.Y)(m.A,{icon:"sell-outline",onClick:H,children:k("Sell")}),t&&U&&Boolean(L)&&(0,f.Y)(m.A,{icon:"unlist-outline",onClick:z,children:k("GiftInfoUnlist")}),t&&D&&(0,f.Y)(m.A,{icon:D.isUnsaved?"eye-outline":"eye-crossed-outline",onClick:O,children:k(D.isUnsaved?"GiftActionShow":"GiftActionHide")}),x&&(0,f.Y)(m.A,{icon:"crown-wear-outline",onClick:J,children:k("GiftInfoWear")}),R&&(0,f.Y)(m.A,{icon:"crown-take-off-outline",onClick:W,children:k("GiftInfoTakeOff")})]})})},80356:(e,t,i)=>{i.r(t),i.d(t,{AboutStarGiftModal:()=>Li,ChatRefundModal:()=>oa,GiftAuctionAcquiredModal:()=>Mi,GiftAuctionBidModal:()=>Bi,GiftAuctionChangeRecipientModal:()=>Ui,GiftAuctionInfoModal:()=>Di,GiftAuctionModal:()=>ki,GiftDescriptionRemoveModal:()=>ra,GiftInfoModal:()=>fi,GiftInfoValueModal:()=>hi,GiftLockedModal:()=>Ai,GiftModal:()=>ti,GiftRecipientPicker:()=>ii,GiftResalePriceComposerModal:()=>bi,GiftStatusInfoModal:()=>Vi,GiftTransferConfirmModal:()=>na,GiftTransferModal:()=>aa,GiftUpgradeModal:()=>Gi,GiftWithdrawModal:()=>Ji,PaidReactionModal:()=>ut,PriceConfirmModal:()=>la,StarGiftPriceDecreaseInfoModal:()=>Ri,StarPaymentModal:()=>be,StarsBalanceModal:()=>fe,StarsGiftModal:()=>S,StarsGiftingPickerModal:()=>B,StarsSubscriptionModal:()=>Ve,StarsTransactionInfoModal:()=>Le});var a=i(84051),n=i(13439),r=i(70636),o=i(91048),s=i(87357),l=i(17142),c=i(4961),d=i(14),u=i(17712),m=i(59030),f=i(21849),p=i(84685),h=i(22337),A=i(1526);const g={modalDialog:"MFXAwnxJ",content:"Sl6xVf1R",main:"bTN9Jeph",headerInfo:"c6MiyJgW",logo:"StGLWvzb",logoBackground:"SyTXSfml",description:"kFe3mIZo",section:"BgfHkWd2",header:"zMtAGfXs",starHeaderText:"q3v8orGj",hiddenHeader:"bq3FnXT0",closeButton:"bDsDTkbe",avatar:"jK36xUj4",center:"v1PckUQn",secondaryInfo:"TDWSRfP9"},b=i.p+"GoldStar.fb6812e915ddfe27f504.svg",v=i.p+"stars-bg.dee4c4b73c7d21c2ec73.png";var N=i(20021);const S=(0,a.ph)((0,n.EK)((e,{modal:t})=>({user:t?.forUserId?(0,o.mBe)(e,t.forUserId):void 0}))(({modal:e,user:t})=>{const{closeStarsGiftModal:i,openInvoice:o,requestConfetti:S}=(0,n.ko)(),G=(0,a.li)(),C=Boolean(e?.isOpen),I=(0,d.A)(e),y=(0,m.A)(),[k,Y]=(0,a.J0)(),[B,D]=(0,a.J0)(!0);(0,a.vJ)(()=>{C||D(!0)},[C]);const P=(0,u.A)(()=>{const e=G.current;if(e&&C){const{top:t,left:i,width:a,height:n}=e.querySelector(".modal-content").getBoundingClientRect();S({top:t,left:i,width:a,height:n,withStars:!0})}});(0,a.vJ)(()=>{I?.isCompleted&&P()},[I,P]);const w=(0,u.A)(e=>{I&&(Y(e),o(t?{type:"starsgift",userId:t.id,stars:e.stars,currency:e.currency,amount:e.amount}:{type:"stars",stars:e.stars,currency:e.currency,amount:e.amount}))}),T=(0,u.A)(()=>{i()}),M=(0,a.Kr)(()=>{const e=y("lng_credits_summary_options_about").split("{link}");return[e[0],(0,N.Y)(p.A,{url:y("StarsTOSLink"),text:y("lng_credits_summary_options_about_link")}),e[1]]},[y]);return(0,N.Y)(h.A,{className:(0,s.A)(g.modalDialog),contentClassName:g.content,dialogRef:G,isSlim:!0,onClose:T,isOpen:C,hasAbsoluteCloseButton:!0,children:(0,N.FD)("div",{className:(0,s.A)(g.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;D(t<=150)},children:[(0,N.Y)("div",{className:(0,s.A)(g.header,B&&g.hiddenHeader),children:(0,N.Y)("h2",{className:g.starHeaderText,children:y(t?"GiftStarsTitle":"Star.List.GetStars")})}),(0,N.Y)("div",{className:g.headerInfo,children:t?(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:100,peer:t,className:g.avatar}),(0,N.Y)("img",{className:g.logoBackground,src:v,alt:"",draggable:!1})]}):(0,N.FD)(N.FK,{children:[(0,N.Y)("img",{className:g.logo,src:b,alt:"",draggable:!1}),(0,N.Y)("img",{className:g.logoBackground,src:v,alt:"",draggable:!1})]})}),(0,N.Y)("h2",{className:(0,s.A)(g.headerText,g.center),children:I?.isCompleted?t?(0,c.A)(y("Notification.StarsGift.SentYou",(0,l.Ad)(k.amount,k.currency,y.code)),["simple_markdown"]):(0,c.A)(y("StarsAcquiredInfo",k?.stars),["simple_markdown"]):y(t?"GiftStarsTitle":"Star.List.GetStars")}),(0,N.Y)("p",{className:g.description,children:t?(0,c.A)(y("ActionGiftStarsSubtitle",(0,r.F9)(y,t)),["simple_markdown"]):y("Stars.Purchase.GetStarsInfo")}),(0,N.FD)("div",{className:g.section,children:[(0,N.Y)(A.A,{options:I?.starsGiftOptions,onClick:w}),(0,N.Y)("div",{className:g.secondaryInfo,children:M})]})]})})}));var G=i(31481),C=i(90709),I=i(87894),y=i(79582),k=i(54960),Y=i(34642);const B=(0,a.ph)((0,n.EK)(e=>{const{chats:{listIds:t},currentUserId:i}=e;return{userIds:e.contactList?.userIds,activeListIds:t.active,archivedListIds:t.archived,currentUserId:i}})(({isOpen:e,currentUserId:t,activeListIds:i,archivedListIds:o,userIds:s})=>{const{closeStarsGiftingPickerModal:l,openStarsGiftModal:c}=(0,n.ko)(),d=(0,m.A)(),[f,p]=(0,a.J0)(""),h=(0,a.Kr)(()=>{const e=(0,n.mS)().users.byId,a=(0,I.Am)([...s||[],...i||[],...o||[]]),l=(0,r.PU)({ids:a,query:f,type:"user"});return(0,y.A)(l.filter(i=>{const a=e[i];return!(!a||a.isSupport||(0,C.tv)(a)||(0,C.PL)(a)||i===t||i===G.zv8)}))},[t,f,s,i,o]),A=(0,u.A)(e=>{e?.length&&(c({forUserId:e}),l())});return(0,N.Y)(Y.A,{className:"s3k01dTm",isOpen:e,onClose:l,title:d("GiftStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Continue"),onEnter:l,children:(0,N.Y)(k.A,{className:"cuI2eDIY",itemIds:h,filterValue:f,filterPlaceholder:d("Search"),onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,onSelectedIdChange:A})})}));var D=i(30708),P=i(31460),w=i(76023),T=i(37661),M=i(39351),F=i(18276),U=i(64493),R=i(46222),x=i(24680),L=i(41036),K=i(38777),O=i(86046),V=i(81949),E=i(9267);const q={root:"TtE8LQNJ",minimal:"nkV4JXHc",transition:"nXQS4E59",main:"JuWZY1ds",container:"mnhBs1uK",section:"lYkNd_gb",lastSection:"f749AI4g",sectionTitle:"FF8gm7MP",tos:"Vu6blJk9",hint:"Rs8WXoOz",topUpButton:"dc_DZoVF",tonBalanceContainer:"lorbW9II",tonBalance:"h2Fs3tOv",tonIconBalance:"Ut6GidJP",tonInUsd:"FdcdsB4l",tonIconLogo:"_hCjjyEv",description:"teXilLxe",header:"fnhXotO2",starHeaderText:"iUwego5s",botItem:"AhxcrKWn",hiddenHeader:"DZk6d6hF",noSeparator:"UwUaTrab",closeButton:"piD1PXHW",addStarsButton:"dqnGL2uh",addStarsIcon:"w9Db2eiK",balanceBlock:"Yk0OQBKC",balanceInfo:"p2dW9NOV",smallerText:"rUnPcfmE",balanceBottom:"F5BTkZ9G",modalBalance:"t8tMrx3y",starButton:"oOt4VBD2",paymentContent:"OReEUNTV",paymentImages:"oKorQYTC",paymentPhoto:"HGTrEtUF",avatarStar:"Wu10dXoa",paymentImageBackground:"os8jb_qv",paymentButton:"VzR5cibf",paymentButtonStar:"Uhg7yWxK",transactions:"Qvc0fTTH",subscriptions:"IX5BhCUF",tabs:"KZVEyKOX",disclaimer:"bpVifdwH",amountBadge:"BPM7LKwo",loadMore:"TKmZjMyd",loadMoreIcon:"buepwtN1"},H=(0,a.ph)(({balance:e,className:t,withAddButton:i})=>{const a=(0,M.A)(),{openStarsBalanceModal:r}=(0,n.ko)();return(0,N.Y)("div",{className:(0,s.A)(q.balanceBlock,t),children:(0,N.FD)("div",{className:q.balanceInfo,children:[(0,N.Y)("span",{className:q.smallerText,children:a("StarsBalance")}),(0,N.Y)("div",{className:q.balanceBottom,children:e?.currency===G.ykW?(0,N.FD)(N.FK,{children:[(0,N.Y)(F.A,{name:"toncoin"}),void 0!==e?(0,l.UL)(e.amount,e.currency):"…"]}):(0,N.FD)(N.FK,{children:[(0,N.Y)(E.A,{type:"gold",size:"middle"}),void 0!==e&&e.currency===G.OUy?(0,O.ZF)(a,e):"…",i&&(0,N.Y)(V.A,{className:q.addStarsButton,onClick:()=>r({}),children:(0,N.Y)(F.A,{className:q.addStarsIcon,name:"add"})})]})})]})})});var z=i(17663),J=i(14242),W=i(63527);const j={root:"ZXnbeQxP",info:"zLaaDX3c",status:"HbF2qTB2",statusPricing:"AveGvpdV",amount:"_CBiOQcv",title:"k9ZIv5Pd",description:"FlRlxMx2",subtitle:"YN2J8dw6",statusPeriod:"MRrP7Oew",statusEnded:"pRHwfr8m",preview:"t6Syyhzd",subscriptionStar:"ftlbevPm"},_=(0,a.ph)(({subscription:e})=>{const{openStarsSubscriptionModal:t}=(0,n.ko)(),{peerId:i,pricing:a,until:s,isCancelled:l,title:d,photo:p}=e,h=(0,m.A)(),A=(0,W.A)(function(e){return t=>(0,o.PVB)(t,e)}(i)),g=(0,u.A)(()=>{t({subscription:e})});if(!A)return;const b=s<Date.now()/1e3,v=(0,z.A)(1e3*s,h.code,!0,"long");return(0,N.FD)("div",{className:j.root,onClick:g,children:[(0,N.FD)("div",{className:j.preview,children:[(0,N.Y)(f.A,{size:"medium",peer:A}),(0,N.Y)(E.A,{className:j.subscriptionStar,type:"gold",size:"small"})]}),(0,N.FD)("div",{className:j.info,children:[(0,N.Y)("h3",{className:j.title,children:(0,c.A)((0,r.F9)(h,A)||"")}),d&&(0,N.FD)("p",{className:j.subtitle,children:[p&&(0,N.Y)(f.A,{webPhoto:p,size:"micro"}),(0,c.A)(d)]}),(0,N.Y)("p",{className:j.description,children:h(b?"StarsSubscriptionExpired":l?"StarsSubscriptionExpires":"StarsSubscriptionRenews",v)})]}),(0,N.Y)("div",{className:j.status,children:l||b?(0,N.Y)("div",{className:j.statusEnded,children:h(b?"StarsSubscriptionStatusExpired":"StarsSubscriptionStatusCancelled")}):(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{className:j.statusPricing,children:[(0,N.Y)(E.A,{className:j.star,type:"gold",size:"adaptive"}),(0,N.Y)("span",{className:j.amount,children:(0,J.Sm)(a.amount)})]}),(0,N.Y)("div",{className:j.statusPeriod,children:h("StarsParticipantSubscriptionPerMonth")})]})})]})});var Q=i(58968),X=i(66833);function $(e,t,i){if(i.paidMessages)return t("PaidMessageTransaction",{count:i.paidMessages},{withNodes:!0,pluralValue:i.paidMessages});if(i.isGiftResale)return Z(i.amount)?t("StarGiftSaleTransaction"):t("StarGiftPurchaseTransaction");if(i.isPostsSearch)return t("PostsSearchTransaction");if(i.isDropOriginalDetails)return t("DropOriginalDetailsTransaction");if(i.isPrepaidUpgrade)return t("GiftPrepaidUpgradeTransactionTitle");if(i.isStarGiftAuctionBid)return Z(i.amount)?t("StarGiftAuctionBidTransaction"):t("StarGiftAuctionBidRefundedTransaction");if(i.starRefCommision)return e("StarTransactionCommission",(0,J.l9)(i.starRefCommision));if(i.isGiftUpgrade)return e("Gift2TransactionUpgraded");if(i.extendedMedia)return e("StarMediaPurchase");if(i.subscriptionPeriod)return i.title||e("StarSubscriptionPurchase");if(i.isReaction)return e("StarsReactionsSent");if(i.giveawayPostId)return e("StarsGiveawayPrizeReceived");if(i.isMyGift)return e("StarsGiftSent");if(i.isGift)return i.amount.currency===G.ykW?t("TonGiftReceived"):e("StarsGiftReceived");if(i.starGift)return Z(i.amount)?e("Gift2TransactionSent"):e("Gift2ConvertedTitle");const a=i.peer&&(0,O.MA)(i)&&(0,O.Pc)(i)||void 0;return a?a.title||e(a.titleKey):i.title}function Z(e){return e.currency===G.OUy?e.amount?e.amount<0:e.nanos<0:e.amount<0}var ee=i(79577),te=i(40558),ie=i(62587),ae=i(27860);const ne={root:"jQkp75Gb",preview:"OYGSN3PF",count:"KX1yz2Jy",thumb:"EvinKr5k",noOutline:"KSAAsUDv",itemCount1:"GxDajfX_",itemCount2:"jXuZoxq8",itemCount3:"TPn3XGHJ",blurry:"hWZuxLS8",full:"w56QPFhl",fadeIn:"ds43W8Wq"};function re({boughtMedia:e,index:t,className:i}){const a=e.video||e.photo,n=(0,C.VO)(a,"pictogram"),r=(0,C.VD)(a),o=(0,ie.A)(n);return(0,N.FD)("div",{className:(0,s.A)(ne.thumb,void 0!==t&&`stars-transaction-media-${t}`,i),children:[r&&(0,N.Y)("img",{className:ne.blurry,src:r,alt:""}),o&&(0,N.Y)("img",{className:ne.full,src:o,alt:""})]})}const oe=(0,a.ph)(({media:e,className:t,isTransactionPreview:i,onClick:a})=>{const n=Math.min(e.length,i?2:3),r="mediaType"in e[0];return(0,N.FD)("div",{className:(0,s.A)(ne.root,ne[`itemCount${n}`],i&&ne.preview,t),dir:"rtl",onClick:a,children:[e.slice(0,n).reverse().map((e,t,a)=>{const n=a.length-t-1;return"mediaType"in e?(0,N.Y)(ae.A,{className:ne.thumb,isVisible:!0,width:e.width,height:e.height,thumbDataUri:e.thumbnail?.dataUri}):(0,N.Y)(re,{className:(0,s.A)(i&&n>0&&ne.noOutline),boughtMedia:e,index:n})}),r&&(0,N.FD)("div",{className:ne.count,children:[(0,N.Y)(F.A,{name:"stars-lock"}),e.length>1?e.length:""]})]})}),se={root:"aHAxv_Jg",info:"oyYrn3II",stars:"K5lc75ku",amount:"QLQPuLAr",title:"e0pK8CJ_",description:"xbERdDMQ",date:"l6CwQ0Ev",positive:"P_42_ZWR",negative:"TGjnLJfH",preview:"cnjGihOT",subscriptionStar:"z43YvnDX",uniqueGiftBackground:"eNvzMw2p",giftSticker:"U3dqmnM4"},le=(0,a.ph)(({transaction:e,className:t})=>{const{openStarsTransactionModal:i}=(0,n.ko)(),{date:l,amount:d,photo:p,peer:h,extendedMedia:A,subscriptionPeriod:g}=e,b=(0,M.A)(),v=(0,m.A)(),S="peer"===h.type?h.id:void 0,C=(0,W.A)(function(e){return t=>e?(0,o.PVB)(t,e):void 0}(S)),I=e.starGift,y="starGiftUnique"===I?.type,k=I&&(0,X.yQ)(I),Y=(0,a.Kr)(()=>{let t,i,a,n=$(v,b,e);if((0,O.MA)(e)){const i=(0,O.Pc)(e);n=i.title||v(i.titleKey),t=v(i.subtitleKey),a=i}else t=C&&(0,r.F9)(v,C),a=C||Q.lw;return(e.isGiftUpgrade||e.isDropOriginalDetails)&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isGiftResale&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isPostsSearch&&(n=$(v,b,e),t=void 0),e.photo&&(a=void 0),e.isRefund&&(i=v("StarsRefunded")),e.hasFailed&&(i=v("StarsFailed")),e.isPending&&(i=v("StarsPending")),{title:n,description:t,avatarPeer:a,status:i}},[v,b,C,e]),B=(0,a.Kr)(()=>{if(y){const{backdrop:e}=(0,X.uc)(I),t=[e.centerColor,e.edgeColor];return(0,N.FD)(N.FK,{children:[(0,N.Y)(te.A,{className:se.uniqueGiftBackground,backgroundColors:t}),(0,N.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1})]})}return k?(0,N.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1}):A?(0,N.Y)(oe,{media:A,isTransactionPreview:!0}):(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:"medium",webPhoto:p,peer:Y.avatarPeer}),Boolean(g)&&(0,N.Y)(E.A,{className:se.subscriptionStar,type:"gold",size:"small"})]})},[y,A,p,Y.avatarPeer,g,I,k]),D=(0,u.A)(()=>{i({transaction:e})}),P=Z(d)?se.negative:se.positive;return(0,N.FD)("div",{className:(0,s.A)(se.root,t),onClick:D,children:[(0,N.Y)("div",{className:se.preview,children:B}),(0,N.FD)("div",{className:se.info,children:[(0,N.Y)("h3",{className:se.title,children:Y.title}),Y.description&&(0,N.Y)("p",{className:se.description,children:(0,c.A)(Y.description)}),(0,N.FD)("p",{className:se.date,children:[(0,z.L2)(1e3*l,v.code,!0),Y.status&&` — (${Y.status})`]})]}),(0,N.FD)("div",{className:se.stars,children:[(0,N.Y)("span",{className:(0,s.A)(se.amount,P),children:(0,O.hk)(b,d)}),d.currency===G.OUy&&(0,N.Y)(E.A,{className:se.star,type:"gold",size:"adaptive"}),d.currency===G.ykW&&(0,N.Y)(F.A,{name:"toncoin",className:P})]})]})}),ce=3.5*w.$,de=["all","inbound","outbound"],ue=["StarsTransactionsAll","StarsTransactionsIncoming","StarsTransactionsOutgoing"],me="StarsTransactionItem",fe=(0,a.ph)((0,n.EK)((e,{modal:t})=>({shouldForceHeight:t?.currency===G.ykW?Boolean(e.ton?.history?.all?.transactions.length):Boolean(e.stars?.history?.all?.transactions.length),starsBalanceState:e.stars,tonBalanceState:e.ton,canBuyPremium:!(0,o.n_C)(e),tonUsdRate:e.appConfig.tonUsdRate,tonTopupUrl:e.appConfig.tonTopupUrl,animationLevel:(0,D.lS)(e).animationLevel}))(({modal:e,starsBalanceState:t,tonBalanceState:i,canBuyPremium:d,shouldForceHeight:f,tonUsdRate:g,tonTopupUrl:b,animationLevel:v})=>{const{closeStarsBalanceModal:S,loadStarsTransactions:I,loadStarsSubscriptions:y,openStarsGiftingPickerModal:k,openInvoice:Y,openUrl:B}=(0,n.ko)(),D=e?.currency||G.OUy,w=D===G.ykW?i:t,{balance:O,history:V}=w||{},{subscriptions:E}=D===G.OUy&&t||{},z=(0,m.A)(),J=(0,M.A)(),[W,j]=(0,a.J0)(!0),[Q,X,$]=(0,T.A)(!1),[Z,ee]=(0,a.J0)(0),[te,ie,ae]=(0,T.A)(),ne=(0,a.li)(),re=Boolean(e&&(t||i)),{originStarsPayment:oe,originReaction:se,originGift:fe,topup:pe}=e||{},he=oe||se||fe||pe,Ae=oe?.form?.invoice?.totalAmount||oe?.subscriptionInfo?.subscriptionPricing?.amount||se?.amount||fe?.gift.stars||pe?.balanceNeeded,ge=Ae?Ae-(O?.amount||0):void 0,be=(0,a.Kr)(()=>{const e=(0,n.mS)();if(se){const t=(0,o.hds)(e,se.chatId);if(!t)return;return z("StarsNeededTextReactions",(0,C.Js)(z,t))}if(oe){const t=oe.form?.botId?(0,o.mBe)(e,oe.form.botId):void 0;if(!t)return;return z("StarsNeededText",(0,C.Yg)(t))}if(fe){const t=(0,o.mBe)(e,fe.peerId);if(!t)return;return z("StarsNeededTextGift",(0,r.F9)(J,t))}return"subs"===pe?.purpose?z("StarsNeededTextLink"):pe?.purpose===G.D3m?J("StarsNeededTextSendPaidMessages",void 0,{withMarkdown:!0,withNodes:!0}):void 0},[se,oe,fe,pe?.purpose,J,z]),ve=Boolean(V?.all?.transactions.length&&!he),Ne=!he,Se=(0,a.Kr)(()=>{const e=V?.all?.transactions.length||0;return 1===e?"35.5rem":2===e?"39.25rem":3===e?"43rem":"45rem"},[V?.all?.transactions.length]),Ge=(0,a.Kr)(()=>ue.map(e=>({title:J(e)})),[J]);(0,a.vJ)(()=>{re||(j(!0),ee(0),ae(),$())},[re]),(0,a.vJ)(()=>{he?ie():ae()},[he]);const Ce=(0,a.Kr)(()=>{if(!re)return;const e=z("lng_credits_summary_options_about").split("{link}");return[e[0],(0,N.Y)(p.A,{url:z("StarsTOSLink"),text:z("lng_credits_summary_options_about_link")}),e[1]]},[re,z]),Ie=(0,u.A)(()=>{I({type:de[Z],isTon:D===G.ykW})}),ye=(0,u.A)(()=>{y()}),ke=(0,u.A)(()=>{k({})}),Ye=(0,u.A)(e=>{const t=oe?.inputInvoice;let i;switch(t?.type){case"message":i=t.chatId;break;case"slug":{const e=oe?.form;i=e?.botId;break}}se&&(i=se.chatId),Y({type:"stars",stars:e.stars,currency:e.currency,amount:e.amount,spendPurposePeerId:i})}),Be=(0,u.A)(()=>{B({url:b})});return(0,N.Y)(h.A,{className:(0,s.A)(q.root,!f&&!te&&q.minimal),isOpen:re,onClose:S,dialogStyle:`--modal-height: ${Se}`,hasAbsoluteCloseButton:!0,children:(0,N.FD)("div",{className:(0,s.A)(q.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;if(j(t<=150),ne.current){const{top:t}=ne.current.getBoundingClientRect(),{top:i}=e.currentTarget.getBoundingClientRect();t-i<=ce?X():$()}},children:[D!==G.ykW&&(0,N.Y)(H,{balance:O,className:q.modalBalance}),(0,N.Y)("div",{className:(0,s.A)(q.header,W&&q.hiddenHeader,Q&&q.noSeparator),children:(0,N.Y)("h2",{className:q.starHeaderText,children:z("TelegramStars")})}),(0,N.Y)("div",{className:q.section,children:D===G.ykW?(()=>{const e=(0,l.UL)(O?.amount||0,G.ykW);return(0,N.FD)(N.FK,{children:[(0,N.Y)(K.A,{model:"speeding-diamond",color:"blue",title:J("CurrencyTon"),description:J("DescriptionAboutTon"),isDisabled:!re}),(0,N.FD)("div",{className:q.tonBalanceContainer,children:[(0,N.FD)("div",{className:q.tonBalance,children:[(0,N.Y)(F.A,{name:"toncoin",className:q.tonIconBalance}),e]}),Boolean(g)&&(0,N.Y)("span",{className:q.tonInUsd,children:`≈ ${(0,l.Ad)((0,l.C)(O?.amount||0,g,!0),"USD",J.code)}`})]}),(0,N.Y)(U.A,{className:q.topUpButton,onClick:Be,fluid:!0,children:J("ButtonTopUpViaFragment")}),D===G.ykW&&(0,N.Y)("div",{className:q.hint,children:J("TonModalHint")})]})})():(0,N.FD)(N.FK,{children:[(0,N.Y)(K.A,{model:"swaying-star",color:"gold",title:ge?z("StarsNeededTitle",Ae):z("TelegramStars"),description:(0,c.A)(be||z("TelegramStarsInfo"),["simple_markdown","emoji"]),isDisabled:!re}),d&&!te&&(0,N.Y)(U.A,{className:q.starButton,onClick:ie,fluid:!0,children:z("Star.List.BuyMoreStars")}),d&&!te&&Ne&&(0,N.Y)(U.A,{isText:!0,noForcedUpperCase:!0,className:q.starButton,fluid:!0,onClick:ke,children:z("TelegramStarsGift")}),te&&t?.topupOptions&&(0,N.Y)(A.A,{starsNeeded:ge,options:t.topupOptions,onClick:Ye})]})}),te&&(0,N.Y)("div",{className:q.tos,children:Ce}),ve&&Boolean(E?.list.length)&&(0,N.FD)("div",{className:q.section,children:[(0,N.Y)("h3",{className:q.sectionTitle,children:z("StarMySubscriptions")}),(0,N.FD)("div",{className:q.subscriptions,children:[E?.list.map(e=>(0,N.Y)(_,{subscription:e},e.id)),E?.nextOffset&&(0,N.FD)(U.A,{isText:!0,disabled:E.isLoading,size:"smaller",noForcedUpperCase:!0,className:q.loadMore,onClick:ye,children:[(0,N.Y)(F.A,{name:"down",className:q.loadMoreIcon}),z("StarMySubscriptionsExpand")]})]})]}),ve&&(0,N.FD)("div",{className:q.container,children:[(0,N.Y)("div",{className:q.lastSection,children:(0,N.Y)(L.Ay,{name:(0,P.P)("slideOptimized",v,void 0,J.isRtl),activeKey:Z,renderCount:ue.length,shouldRestoreHeight:!0,className:q.transition,children:(0,N.Y)(R.A,{onLoadMore:Ie,items:V?.[de[Z]]?.transactions,scrollContainerClosest:`.${q.main}`,itemSelector:`.${me}`,className:q.transactions,noFastList:!0,noScrollRestoreOnTop:!0,children:V?.[de[Z]]?.transactions.map(e=>(0,N.Y)(le,{transaction:e,className:me},`${e.id}-${e.isRefund}`))})})}),(0,N.Y)(x.A,{ref:ne,className:q.tabs,tabClassName:q.tab,activeTab:Z,tabs:Ge,onSwitchTab:ee})]})]})})}));var pe=i(48775),he=i(29886),Ae=i(84991),ge=i(10187);const be=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.form?.botId?(0,o.mBe)(e,t.form.botId):void 0,a="message"===t?.inputInvoice?.type?t.inputInvoice:void 0,n=a?(0,o.O5q)(e,a.chatId,a.messageId):void 0,r=a?(0,o.hds)(e,a.chatId):void 0,s=n?.content.paidMedia;return{bot:i,starsBalanceState:e.stars,paidMediaMessage:s?n:void 0,paidMediaChat:s?r:void 0}})(({modal:e,bot:t,starsBalanceState:i,paidMediaMessage:r,paidMediaChat:o})=>{const{closeStarsPaymentModal:l,openStarsBalanceModal:d,sendStarPaymentForm:A}=(0,n.ko)(),[g,b,S]=(0,T.A)(),G=Boolean(e?.inputInvoice&&i),I=(0,he.A)(e),y=e||I,{form:k,subscriptionInfo:Y}=y||{},B=k?.invoice?.totalAmount||Y?.subscriptionPricing?.amount,D=Boolean(k?.invoice.subscriptionPeriod),P=!Y?.subscriptionPricing,w=k?.photo,F=(0,m.A)(),R=(0,M.A)();(0,a.vJ)(()=>{G||S()},[G]);const x=(0,a.Kr)(()=>{if(!y?.inputInvoice)return"";const e=(0,C.Yg)(t),i=F("Stars.Intro.PurchasedText.Stars",B);if(r){const e=r.content.paidMedia.extendedMedia,t=e.every(e=>!e.duration),a=e.every(e=>Boolean(e.duration)),n=F(t?"Stars.Transfer.Photos":a?"Stars.Transfer.Videos":"Media",e.length),s=(0,C.Js)(F,o);return F("Stars.Transfer.UnlockInfo",[n,s,i])}return Y?R("StarsSubscribeText",{chat:Y.title,amount:B},{withNodes:!0,withMarkdown:!0,pluralValue:B}):D?R("StarsSubscribeBotText",{name:k.title,amount:B,bot:e},{pluralValue:B}):F("Stars.Transfer.Info",[k.title,e,i])},[y?.inputInvoice,t,F,B,r,Y,D,k,o,R]),L=(0,a.Kr)(()=>{if(Y)return R("StarsSubscribeInfo",{link:(0,N.Y)(p.A,{url:R("StarsSubscribeInfoLink"),text:R("StarsSubscribeInfoLinkText")})},{withNodes:!0})},[Y,R]),K=(0,a.Kr)(()=>{if(Y)return(0,C.nr)(Y)},[Y]),O=(0,u.A)(()=>{const t=i?.balance;void 0!==B&&void 0!==t&&(B>t.amount?d({originStarsPayment:e}):(A({}),b()))});return(0,N.FD)(h.A,{contentClassName:q.paymentContent,isOpen:G,hasAbsoluteCloseButton:!0,isSlim:!0,onClose:l,children:[(0,N.Y)(H,{balance:i?.balance,className:q.modalBalance}),(0,N.FD)("div",{className:q.paymentImages,dir:R.isRtl?"ltr":"rtl",children:[r?(0,N.Y)(oe,{media:r.content.paidMedia.extendedMedia}):K?(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{className:q.paymentPhoto,peer:K,size:"giant"}),(0,N.Y)(E.A,{type:"gold",size:"adaptive",className:q.avatarStar})]}):(0,N.Y)(Ae.A,{peer:w?void 0:t,avatarWebPhoto:w,avatarSize:"giant",badgeIcon:"star",badgeText:(0,J.Sm)(B),badgeClassName:q.amountBadge,className:q.paymentPhoto}),(0,N.Y)("img",{className:q.paymentImageBackground,src:v,alt:"",draggable:!1})]}),(0,N.Y)("h2",{className:q.headerText,children:F(K?"StarsSubscribeTitle":"StarsConfirmPurchaseTitle")}),P&&(0,N.Y)(ge.A,{className:q.botItem,peerId:k?.botId}),(0,N.Y)("div",{className:q.description,children:(0,c.A)(x,["simple_markdown","emoji"])}),(0,N.Y)(U.A,{className:q.paymentButton,onClick:O,isLoading:g,children:R(D?"StarsSubscribeBotButtonMonth":"StarsPay",{amount:(0,pe.U2)(R,B,{asFont:!0})},{withNodes:!0})}),Boolean(L)&&(0,N.Y)("div",{className:(0,s.A)(q.disclaimer,q.smallerText),children:L})]})}));var ve=i(89925),Ne=i(85982),Se=i(97040),Ge=i(70046),Ce=i(96454),Ie=i(95807),ye=i(537),ke=i(43874),Ye=i(80140);const Be="biAUzmLA",De="hsDNs5hG",Pe="APNjRx1K",we=(0,a.ph)((0,n.EK)(e=>{const{currentUserId:t}=e,i=t?(0,o.mBe)(e,t):void 0,a=i?.emojiStatus,n=e.collectibleEmojiStatuses?.statuses;return{currentUserEmojiStatus:a,collectibleEmojiStatuses:n}})(({savedGift:e,currentUserEmojiStatus:t,collectibleEmojiStatuses:i})=>{const{openGiftTransferModal:r,openGiftResalePriceComposerModal:s,openGiftStatusInfoModal:l,setEmojiStatus:c,updateStarGiftPrice:d,showNotification:f,closeGiftInfoModal:p}=(0,n.ko)(),h=(0,M.A)(),A=(0,m.A)(),g=e?.gift,b="starGiftUnique"===g?.type?g.resellPrice:void 0,v=(0,n.mS)(),S=(0,o.nTw)(v).giftInfoModal,C=S?.peerId,I="starGiftUnique"===g?.type?g.slug:void 0,y=(0,a.Kr)(()=>{if(I)return i?.find(e=>"collectible"===e.type&&e.slug===I)},[I,i]),k="collectible"===t?.type?t.slug:void 0,Y=void 0!==I&&k===I,B=Boolean(y)&&!Y,D=(0,u.A)(()=>{e&&"starGiftUnique"===e?.gift.type&&(e.canTransferAt&&e.canTransferAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,z.U)(A,1e3*e.canTransferAt)}}}):r({gift:e}))}),P=(0,u.A)(()=>{Y?c({emojiStatus:{type:"regular",documentId:G.zNY}}):y&&l({emojiStatus:y})}),w=(0,u.A)(()=>{e&&C&&(e.canResellAt&&e.canResellAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,z.U)(A,1e3*e.canResellAt)}}}):s({peerId:C,gift:e}))}),T=(0,u.A)(()=>{e&&"starGiftUnique"===e.gift.type&&e.inputGift&&(p(),d({gift:e.inputGift,price:{currency:G.OUy,amount:0,nanos:0}}),f({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:h("GiftUnique",{title:e.gift.title,number:e.gift.number})}}}))});return(0,N.FD)("div",{className:"feHNN0j8",children:[(0,N.Y)(U.A,{color:"transparentBlured",iconName:"gift-transfer-inline",iconAlignment:"top",iconClassName:Pe,onClick:D,ariaLabel:h("GiftInfoTransfer"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:De,children:h("GiftInfoTransfer")})}),(B||!Y)&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:Y?"crown-take-off":"crown-wear",iconAlignment:"top",iconClassName:Pe,onClick:B||Y?P:void 0,disabled:!B&&!Y,ariaLabel:h(Y?"GiftInfoTakeOff":"GiftInfoWear"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:De,children:h(Y?"GiftInfoTakeOff":"GiftInfoWear")})}),!b&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:"sell",iconAlignment:"top",iconClassName:Pe,onClick:w,ariaLabel:h("Sell"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:De,children:h("Sell")})}),Boolean(b)&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:"unlist",iconAlignment:"top",iconClassName:Pe,onClick:T,ariaLabel:h("GiftInfoUnlist"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:De,children:h("GiftInfoUnlist")})})]})})),Te={root:"irv1C8bo",withManageButtons:"QcTw5OSp",sticker:"a1ASgPwu",withBadge:"OFWOLtAH",subtitleBadge:"V7kDVPLm",badge:"PAmbIL6y",radialPattern:"UvhsGZLf",amount:"zTVWZg63",transition:"Tu6_OHoq",transitionSlide:"iUTKLzTN",title:"ECTvfOda",subtitle:"S6JwvHWD"},Me=(0,a.ph)(({modelAttribute:e,backdropAttribute:t,patternAttribute:i,title:r,badge:o,subtitle:l,subtitlePeer:c,className:d,resellPrice:u,showManageButtons:m,savedGift:f})=>{const{openChat:p}=(0,n.ko)(),{isMobile:h}=(0,ke.Ay)(),A=(0,M.A)(),[g,b,v]=(0,T.A)(!1),S=(0,ye.A)([e,t,i]),G=t?.textColor,C=(0,a.Kr)(()=>{const e=[t.centerColor,t.edgeColor];return(0,N.Y)(te.A,{className:Te.radialPattern,canvasClassName:Te.radialPatternCanvas,backgroundColors:e,patternIcon:i.sticker,yPosition:7.5*w.$,maxRadius:.26,patternSize:h?14:16,ovalFactor:1.2})},[t,i,h]);return(0,N.FD)("div",{className:(0,s.A)(Te.root,"interactive-gift",m&&Te.withManageButtons,o&&Te.withBadge,d),children:[(0,N.FD)(L.Ay,{className:Te.transition,slideClassName:(0,s.A)(Te.transitionSlide),activeKey:S,direction:1,name:"zoomBounceSemiFade",children:[C,(0,N.Y)(ee.A,{className:Te.sticker,sticker:e.sticker,size:120,noLoop:!g,onMouseEnter:Ce.TF?void 0:b,onMouseLeave:Ce.TF?void 0:v})]}),Boolean(o)&&(0,N.Y)("div",{className:Te.badge,children:o}),r&&(0,N.Y)("h1",{className:Te.title,children:r}),Boolean(l)&&(0,N.Y)("div",{className:(0,s.A)(Te.subtitle,c&&Te.subtitleBadge),style:(0,Ie.A)(G&&`color: ${G}`),onClick:()=>{c&&p({id:c.id})},children:l}),f&&m&&(0,N.Y)(we,{savedGift:f}),u&&(0,N.FD)("p",{className:Te.amount,children:[(0,N.Y)("span",{children:(0,O.hk)(A,u)}),"XTR"===u.currency&&(0,N.Y)(E.A,{type:"gold",size:"middle"}),"TON"===u.currency&&(0,N.Y)(F.A,{name:"toncoin"})]})]})}),Fe="qBOIq6Jn",Ue="sso9uZM6",Re="NuWOY7ED",xe=[0,-50],Le=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i="peer"===t?.transaction?.peer?.type&&t.transaction.peer.id,a=i?(0,o.PVB)(e,i):void 0,n=e.appConfig.starsPaidMessageCommissionPermille,r=t?.transaction.amount,s=t?.transaction.isGift?r?.currency===G.OUy?(0,o.WLj)(e,r?.amount):(0,o.OD9)(e,r?.amount):void 0;return{peer:a,canPlayAnimatedEmojis:(0,o.BWX)(e),topSticker:s,paidMessageCommission:n}})(({modal:e,peer:t,canPlayAnimatedEmojis:i,topSticker:r,paidMessageCommission:o})=>{const{showNotification:l,openMediaViewer:c,closeStarsTransactionModal:d}=(0,n.ko)(),h=(0,M.A)(),A=(0,m.A)(),{transaction:g}=e||{},b=(0,a.li)(),v=(0,u.A)(()=>{const e=g?.extendedMedia;e&&c({origin:ve.TQ.StarsTransaction,standaloneMedia:e.flatMap(e=>Object.values(e))})}),S=(0,u.A)(()=>{b.current?.()}),I=(0,u.A)(e=>{b.current=e}),y=(0,a.Kr)(()=>{if(!g)return;const{giveawayPostId:e,photo:a,amount:n,isGiftUpgrade:c,isDropOriginalDetails:d,starGift:u,isGiftResale:m,starRefCommision:b}=g,y=g?.starGift,k="starGiftUnique"===y?.type,Y=g?.starGift?(0,X.yQ)(g.starGift):r,B=k?(0,X.uc)(y):void 0,D=g.peer&&(0,O.MA)(g)&&(0,O.Pc)(g)||void 0,P="peer"===g.peer?.type?g.peer.id:void 0,w=g.peer&&A(function(e){switch(e.type){case"appStore":return"AppStore";case"playMarket":return"PlayMarket";case"fragment":return"Fragment";case"premiumBot":return"StarsTransactionBot";case"ads":return"StarsTransactionAds";case"api":return"Stars.Intro.Transaction.TelegramBotApi.Subtitle";default:return"Stars.Transaction.Unsupported.Title"}}(g.peer)),T=$(A,h,g),M=t&&g.messageId&&!c&&!d?(0,C.yt)(t,void 0,g.messageId):void 0,U=t&&e?(0,C.yt)(t,void 0,e):void 0,R=g.extendedMedia,x=R?.length||0,L=R?.every(e=>!e.video),K=R?.every(e=>!e.photo),V=A(L?"Stars.Transfer.Photos":K?"Stars.Transfer.Videos":"Media",x),q=g.description||((c||d)&&"starGiftUnique"===u?.type?u.title:void 0)||(R?V:void 0),H=!R&&!Y&&!g.isPostsSearch,W=a?void 0:!(0,O.MA)(g)&&t||D,j=k&&(0,N.Y)("div",{className:(0,s.A)(Fe,"ApoQz22o"),children:(0,N.Y)(Me,{backdropAttribute:B.backdrop,patternAttribute:B.pattern,modelAttribute:B.model,title:y.title,subtitle:h("GiftInfoCollectible",{number:y.number}),resellPrice:g.amount})}),_=Z(n)?"xDyq9cc0":"jvBZSrpd",Q=(0,N.FD)("div",{className:Fe,children:[R&&(0,N.Y)(oe,{className:(0,s.A)("C5r59yiV","transaction-media-preview"),media:R,onClick:v}),!R&&Y&&(0,N.Y)(ee.A,{sticker:Y,play:i,noLoop:!0},g.id),H&&(0,N.Y)(f.A,{className:"hcrszlpT",peer:W,webPhoto:a,size:"giant",onMouseMove:S}),!Y&&!g.isPostsSearch&&(0,N.Y)(Se.A,{className:(0,s.A)("nML8IQqX"),color:"gold",onRequestAnimation:I,centerShift:xe}),Boolean(T)&&(0,N.Y)("h1",{className:"ZZAj3hj7",children:T}),(0,N.Y)("p",{className:Re,children:q}),(0,N.FD)("p",{className:Ue,children:[(0,N.Y)("span",{className:(0,s.A)(Ue,_),children:(0,O.hk)(h,n)}),n.currency===G.OUy&&(0,N.Y)(E.A,{type:"gold",size:"middle"}),"TON"===n.currency&&(0,N.Y)(F.A,{name:"toncoin",className:_}),g.isRefund&&(0,N.Y)("p",{className:"sxWAwxTd",children:h("Refunded")})]}),Boolean(g.paidMessages&&g.starRefCommision&&o)&&(0,N.Y)("p",{className:Re,children:h("PaidMessageTransactionDescription",{percent:(0,J.l9)(o/10)},{withNodes:!0,withMarkdown:!0})})]}),te=[];let ie;g&&b&&!g.paidMessages&&!m&&te.push([A("StarsTransaction.StarRefReason.Title"),A("StarsTransaction.StarRefReason.Program")]),c&&te.push([A("StarGiftReason"),A("StarGiftReasonUpgrade")]),d&&te.push([A("StarGiftReason"),h("StarGiftReasonDropOriginalDetails")]),m&&te.push([A("StarGiftReason"),Z(g.amount)?h("StarGiftSaleTransaction"):h("StarGiftPurchaseTransaction")]),ie=c?A("Stars.Transaction.GiftFrom"):Z(n)||g.isMyGift?A("Stars.Transaction.To"):!g.starRefCommision||g.paidMessages||m?A(P?"Star.Transaction.From":"Stars.Transaction.Via"):A("StarsTransaction.StarRefReason.Miniapp"),g.isPostsSearch||d||g.isStarGiftAuctionBid||te.push([ie,P?{chatId:P}:w||""]),g.starRefCommision&&g.paidMessages&&te.push([h("PaidMessageTransactionTotal"),(0,pe.U2)(h,g.amount.amount/((100-g.starRefCommision)/100),{asFont:!1,className:"cU5QlvwL",containerClassName:"Z2YALGgl"})]),M&&te.push([A("Stars.Transaction.Reaction.Post"),(0,N.Y)(p.A,{url:M,text:M})]),U&&g.amount.currency===G.OUy&&(te.push([A("BoostReason"),(0,N.Y)(p.A,{url:U,text:A("Giveaway")})]),te.push([A("Gift"),A("Stars",g.amount,"i")])),g.id&&te.push([A("Stars.Transaction.Id"),(0,N.FD)(N.FK,{children:[(0,N.Y)("div",{className:"tMF8VIOM",onClick:()=>{(0,Ne.eM)(g.id),l({message:A("StarsTransactionIDCopied")})},children:g.id}),(0,N.Y)(F.A,{className:"voCttFzS",name:"copy"})]})]),te.push([A("Stars.Transaction.Date"),(0,z.L2)(1e3*g.date,A.code,!0)]),g.isStarGiftAuctionBid&&"starGift"===y?.type&&y.availabilityTotal&&te.push([h("GiftInfoAvailability"),h("GiftInfoAvailabilityValue",{count:y.availabilityRemains||0,total:y.availabilityTotal},{pluralValue:y.availabilityRemains||0})]);const ae=A("lng_credits_box_out_about").split("{link}");return{header:k?j:Q,tableData:te,footer:(0,N.FD)("span",{className:"KgzPpgS6",children:[ae[0],(0,N.Y)(p.A,{url:A("StarsTOSLink"),text:A("lng_credits_summary_options_about_link")}),ae[1]]})}},[g,A,h,t,i,r,o,I]),k=(0,he.A)(y)||y;return(0,N.Y)(Ge.A,{isOpen:Boolean(g),className:"IzhfRIWu",hasBackdrop:"starGiftUnique"===g?.starGift?.type,header:k?.header,tableData:k?.tableData,footer:k?.footer,buttonText:A("OK"),onClose:d})})),Ke="oBLHWBtJ",Oe=[0,-50],Ve=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.subscription.peerId;return{peer:i?(0,o.PVB)(e,i):void 0}})(({modal:e,peer:t})=>{const{closeStarsSubscriptionModal:i,fulfillStarsSubscription:o,changeStarsSubscription:l,checkChatInvite:c,loadStarStatus:d,openInvoice:h}=(0,n.ko)(),A=(0,m.A)(),g=(0,M.A)(),{subscription:b}=e||{},v=(0,a.li)(),S=(0,u.A)(()=>{v.current?.()}),C=(0,u.A)(e=>{v.current=e}),I=(0,a.Kr)(()=>{if(!b)return"hidden";if(b.canRefulfill)return"refulfill";const e=b.until>Date.now()/1e3;if(e&&!b.isCancelled)return"cancel";if(e&&b.isCancelled)return"renew";const t=b.chatInviteHash||b.invoiceSlug;return!e&&t?"restart":"ok"},[b]),y=(0,u.A)(()=>{if(b){switch(I){case"refulfill":o({id:b.id});break;case"restart":b.chatInviteHash?c({hash:b.chatInviteHash}):b.invoiceSlug&&h({type:"slug",slug:b.invoiceSlug}),d();break;case"renew":l({id:b.id,isCancelled:!1});break;case"cancel":l({id:b.id,isCancelled:!0})}i()}}),k=(0,a.Kr)(()=>{if(!b||!t)return;const{pricing:e,until:i,isCancelled:a,canRefulfill:n,photo:o,title:l,hasBotCancelled:c}=b,d=(0,r.mO)(t),u=(0,N.FD)("div",{className:"E3R22yAI",children:[(0,N.FD)("div",{className:"wuTMXDP9",children:[(0,N.Y)(f.A,{peer:o?void 0:t,webPhoto:o,size:"giant",onMouseMove:S}),(0,N.Y)(E.A,{className:"enRetSny",type:"gold",size:"adaptive"})]}),(0,N.Y)(Se.A,{className:(0,s.A)("zGCayu45"),color:"gold",onRequestAnimation:C,centerShift:Oe}),(0,N.Y)("h1",{className:"qdydQHgc",children:l||A("StarsSubscriptionTitle")}),(0,N.Y)("p",{className:"FI6rEJlK",children:g("StarsPerMonth",{amount:e.amount},{withNodes:!0,specialReplacement:{[G.Cyx]:(0,N.Y)(E.A,{className:"J8HIcN6k",size:"adaptive",type:"gold"})}})})]}),m=[];m.push([A(d?"StarsSubscriptionBot":"StarsSubscriptionChannel"),{chatId:t.id}]),l&&m.push([A("StarsSubscriptionBotProduct"),l]);const h=i<Date.now()/1e3;m.push([A(h?"StarsSubscriptionUntilExpired":a?"StarsSubscriptionUntilExpires":"StarsSubscriptionUntilRenews"),(0,z.L2)(1e3*i,A.code,!0)]);const v=g("StarsTransactionTOS",{link:(0,N.Y)(p.A,{url:g("StarsTransactionTOSLink"),text:g("StarsTransactionTOSLinkText")})},{withNodes:!0});return{header:u,tableData:m,footer:(0,N.FD)("span",{className:"GMWMuWCr",children:[(0,N.Y)("p",{className:Ke,children:v}),a&&(0,N.Y)("p",{className:"nkwiG25Q",children:A(c?"StarsSubscriptionBotCancelledText":"StarsSubscriptionCancelledText")}),n&&(0,N.Y)("p",{className:Ke,children:A("StarsSubscriptionRefulfillInfo",(0,z.L2)(1e3*i,A.code,!0))}),!a&&!n&&h&&(0,N.Y)("p",{className:Ke,children:A("StarsSubscriptionExpiredInfo",(0,z.L2)(1e3*i,A.code,!0))}),!a&&!n&&!h&&(0,N.Y)("p",{className:Ke,children:A("StarsSubscriptionCancelInfo",(0,z.L2)(1e3*i,A.code,!0))}),"hidden"!==I&&(0,N.Y)(U.A,{color:"cancel"===I?"danger":"primary",isText:"cancel"===I,onClick:y,children:A("cancel"===I?"StarsSubscriptionCancel":"refulfill"===I?"StarsSubscriptionRefulfill":"restart"===I?"StarsSubscriptionAgain":"renew"===I?"StarsSubscriptionRenew":"OK")})]})}},[I,g,A,t,b]),Y=(0,he.A)(k)||k;return(0,N.Y)(Ge.A,{isOpen:Boolean(b),className:"eR_RZfGB",header:Y?.header,tableData:Y?.tableData,footer:Y?.footer,onClose:i})}));var Ee=i(34431),qe=i(19806),He=i(22699),ze=i(24433),Je=i(32581),We=i(93545),je=i(68292),_e=i(85118);const Qe={root:"CuBAw2yg",dragging:"LbDNXOOQ",progress:"kwK0cNPX",floatingBadgeWrapper:"uvlMoXj0",floatingBadgeText:"qqQan8uF",floatingBadgeTriangle:"mIdJOmsB",slider:"euOOAbZi",sparkles:"_L1YQTIP",dynamicColor:"uIYIwZpx",floatingBadge:"BGSDWAYc",clickable:"JwkM7nwU",noTransition:"cG6CiHRL",floatingBadgeSparkles:"JCciTRtu",floatingBadgeContent:"f1UPSN27",withDescription:"WsptdVHe",floatingBadgeTitle:"HkY6dR8D",floatingBadgeDescription:"mR3ddE5s",floatingBadgeTrianglePath:"IW9YhMAx",customValueIcon:"Td8Tc1MH"},Xe=[50,100,500,1e3,2e3,5e3,1e4],$e=1e4,Ze=1.875*w.$,et=2*w.$,tt=1.5*w.$,it=.125*w.$;let at;const nt=["#955CDB","#955CDB","#46A3EB","#40A920","#E29A09","#ED771E","#E14741","#5B6676"];function rt(e,t){const i=[];for(let a=0;a<Xe.length;a++)if(!(Xe[a]<=e)&&(Xe[a]<t&&i.push(Xe[a]),Xe[a]>=t))return i.push(t),i;const a=Xe[Xe.length-1],n=Math.ceil((e-a)/$e);let r=a+Math.max(1,n)*$e;for(;r<t;)i.push(r),r+=$e;return i.push(t),i}function ot(e,t,i){const a=e.findIndex(e=>t<=e),n=e[a-1]||i,r=e[a]||e[e.length-1];return r===n?a:a+(t-n)/(r-n)}function st(e,t,i){const a=Math.floor(t),n=e[a-1]||i,r=n+((e[a]||e[e.length-1])-n)*(t-a);return Math.round(r)}const lt=(0,a.ph)(({maxValue:e,defaultValue:t,minValue:i,minAllowedValue:n,minAllowedProgress:r,className:o,floatingBadgeDescription:l,shouldUseDynamicColor:c,shouldAllowCustomValue:d,onChange:m,onBadgeClick:f,onCustomValueClick:p})=>{const h=(0,a.li)(),A=(0,a.li)(),g=(0,M.A)(),b=i??1,v=(0,a.Kr)(()=>{if(!r||!n||n<=b)return b;let t=b,i=n;for(;t<i;){const a=Math.floor((t+i)/2),o=rt(a,e);ot(o,n,a)/o.length<r?i=a:t=a+1}return Math.max(b,t)},[b,n,r,e]),S=(0,a.Kr)(()=>rt(v,e),[e,v]),[G,C]=(0,a.J0)(0),[I,y]=(0,a.J0)(0),[k,Y]=(0,a.J0)(0),[B,D]=(0,a.J0)(!1),P=(0,a.li)(),T=(0,he.A)(k),U=g.number(st(S,G,v)),R=void 0!==n?ot(S,n,v):0;(0,a.vJ)(()=>{C(ot(S,t,v))},[t,S,v]),(0,a.vJ)(()=>{if(!A.current)return;const e=A.current.querySelector(`.${Qe.floatingBadgeTitle}`);if(!e)return;const t=getComputedStyle(e),i=`${t.fontWeight} ${t.fontSize} ${t.fontFamily}`,a=function(e,t){at||(at=document.createElement("canvas"));const i=at.getContext("2d");return i.font=t,i.measureText(e).width}(U,i),n=tt+it+a,r=A.current.querySelector(`.${Qe.floatingBadgeDescription}`),o=r?.scrollWidth||0,s=Math.max(n,o)+et;Y(e=>Math.abs(s-e)<6?e:s)},[U,l]);const x=(0,u.A)(e=>{y(e.contentRect.width)});(0,We.A)(h,x);const L=G/S.length,{minBadgeX:K,maxBadgeX:O,beakOffset:V,beakTipOffset:E,beakWidth:q}=(0,a.Kr)(()=>function(e,t,i){const a=t/2,n=a-22,r=e-Ze,o=i*r,s=r-o,l=o<s,c=l?o:s,d=l?-1:1;let u=0,m=0,f=52;const p=a-Ze/2;if(c<p)if(c>10)u=d*((p-c)/(p-10))*n;else if(c>0){u=d*n;const e=(10-c)/10;f=52-8*(1-(1-e)*(1-e)*(1-e)),m=d*e*(f/2)}else u=d*n,f=44,m=d*(f/2);const h=f/2-2-1;return{minBadgeX:a,maxBadgeX:e-a,beakOffset:u,beakTipOffset:Math.max(-h,Math.min(h,m)),beakWidth:f}}(I,k,L),[I,k,L]),H=(0,a.Kr)(()=>function(e,t){const i=e/2+t;return`M 0 0 L ${e} 0 L ${i+2} 30 Q ${i} 32 ${i-2} 30 Z`}(q,E),[q,E]),z=(0,u.A)(e=>{const t=Number(e.currentTarget.value),i=Math.max(t,R);C(i);const a=st(S,i,v);m(a)}),J=(0,u.A)(e=>{P.current=e.clientX,D(!1)}),W=(0,u.A)(e=>{void 0!==P.current&&Math.abs(e.clientX-P.current)>=5&&D(!0)}),j=(0,u.A)(e=>{if(P.current=void 0,!B&&p&&h.current){const t=h.current.getBoundingClientRect(),i=1.875*w.$;e.clientX>=t.right-i&&e.clientX<=t.right&&p()}D(!1)}),_=c?function(e){const t=Math.floor(e*nt.length);return nt[Math.min(t,nt.length-1)]}(L):void 0,Q=(0,Ie.A)(Boolean(k)&&`width: ${k}px`),X=(0,Ie.A)(`--progress: ${L}`,`--min-badge-x: ${K}px`,`--max-badge-x: ${O}px`,_&&`--dynamic-color: ${_}`);return(0,N.FD)("div",{ref:h,className:(0,s.A)(Qe.root,B&&Qe.dragging,o),style:X,children:[(0,N.Y)("div",{className:Qe.floatingBadgeWrapper,children:(0,N.FD)("div",{className:(0,s.A)(Qe.floatingBadge,f&&Qe.clickable),onClick:f,children:[(0,N.FD)("div",{className:(0,s.A)(Qe.floatingBadgeText,c&&Qe.dynamicColor,(!T||0===T)&&Qe.noTransition),style:Q,children:[(0,N.Y)(_e.A,{preset:"button",className:Qe.floatingBadgeSparkles}),(0,N.FD)("div",{ref:A,className:(0,s.A)(Qe.floatingBadgeContent,l&&Qe.withDescription),children:[(0,N.FD)("div",{className:Qe.floatingBadgeTitle,children:[(0,N.Y)(F.A,{name:"star",className:Qe.floatingBadgeIcon}),(0,N.Y)(je.A,{text:U})]}),(0,N.Y)("div",{className:Qe.floatingBadgeDescription,children:l})]})]}),(0,N.FD)("svg",{className:Qe.floatingBadgeTriangle,width:q,height:32,viewBox:`0 0 ${q} 32`,fill:"none","aria-hidden":"true",role:"presentation",style:`transform: translate(calc(-50% + ${V}px), 33%)`,children:[!c&&(0,N.Y)("defs",{children:(0,N.FD)("linearGradient",{id:"StarBadgeTriangle",x1:"0",x2:"1",y1:"0",y2:"0",children:[(0,N.Y)("stop",{offset:"-50%","stop-color":"#FFAA00"}),(0,N.Y)("stop",{offset:"150%","stop-color":"#FFCD3A"})]})}),(0,N.Y)("path",{className:Qe.floatingBadgeTrianglePath,d:H,fill:_||"url(#StarBadgeTriangle)"})]})]})}),(0,N.Y)("div",{className:(0,s.A)(Qe.progress,c&&Qe.dynamicColor),children:(0,N.Y)(_e.A,{preset:"progress",className:Qe.sparkles})}),(0,N.Y)("input",{className:Qe.slider,type:"range",min:0,max:S.length,defaultValue:ot(S,t,v),step:"any",onChange:z,onPointerDown:J,onPointerMove:W,onPointerUp:j}),d&&(0,N.Y)(F.A,{name:"add",className:Qe.customValueIcon})]})}),ct={content:"RdhRpsCn",title:"yzbjj73U",slider:"xePPMXOI",description:"BlpfdOtK",itemInfo:"nS9V516D",itemTitle:"sH5Nukjy",itemSubtitle:"dHlNODTI",itemIcon:"H_iHihXU",sendAsPeerButtonAvatar:"_mjvLELm",sendAsPeerMenuButton:"zxsRaWYV",buttonDownIcon:"zrwUUELS",sendAsPeerMenuBubble:"X1PB6mhQ",sendAsPeerMenu:"Px1MDij9",sendAsPeersMenuContainer:"Al1nfhHJ",headerControlPanel:"vu90kSL_",separator:"uhQLUjmo",checkBox:"Mc3bVeF0",topLabel:"bnou4CpV",top:"QludQDKR",topBadge:"JBF9pTUK",buttonStar:"NJJFuym9",topPeer:"Ty4Ud_Rd",disclaimer:"KRvkHeo1"},dt={avatarIcon:"author-hidden",customPeerAvatarColor:"#9eaab5",isCustomPeer:!0,titleKey:"StarsReactionAnonymous"},ut=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t&&(0,o.hds)(e,t.chatId),a=t&&(0,o.O5q)(e,t.chatId,t.messageId),n=e.stars?.balance,r=e.appConfig.paidReactionMaxAmount||2500,s=e.settings.paidReactionPrivacy,l=i?.sendPaidReactionsAsPeerIds,c=e.currentUserId;return{chat:i,message:a,starBalance:n,maxAmount:r,defaultPrivacy:s,sendPaidReactionsAsPeerIds:l,currentUserId:c,currentUser:(0,o.mBe)(e,c)}})(({modal:e,chat:t,message:i,maxAmount:l,starBalance:d,defaultPrivacy:A,sendPaidReactionsAsPeerIds:g,currentUserId:b,currentUser:v})=>{const{closePaidReactionModal:S,addLocalPaidReaction:C,loadSendPaidReactionsAs:I}=(0,n.ko)(),[y,k]=(0,a.J0)(50),[Y,B,D]=(0,T.A)(),[P,w]=(0,a.J0)(!0),[R,x]=(0,a.J0)(b),L=t?.id,K=R?(0,o.PVB)((0,n.mS)(),R):v,O=(0,m.A)(),{isMobile:V}=(0,ke.Ay)(),E=(0,M.A)(),q=(0,u.A)(e=>{w(!e.target.checked)}),z=(0,u.A)(e=>{k(e),B()});(0,a.vJ)(()=>{L&&!g&&I({chatId:L})},[L,g]);const W=(0,a.Kr)(()=>{const e=g?.map(e=>e.id).filter(e=>e!==L);return e?.unshift(b),e},[g,L,b]),j=W&&W.length>1;(0,a.vJ)(()=>{e||D()},[e]),(0,a.vJ)(()=>{const e=i?.reactions?.topReactors?.find(e=>e.isMy);if(e)return w(Boolean(e.isAnonymous)),void(e.peerId&&x(e.peerId));w("anonymous"===A?.type||!1),"peer"===A?.type&&W?.includes(A.peerId)?x(A.peerId):x(b)},[A,i?.reactions?.topReactors,W,b]);const _=(0,u.A)(()=>{e&&(C({chatId:e.chatId,messageId:e.messageId,count:y,isPrivate:P,peerId:P||R===b?void 0:R,shouldIgnoreDefaultPrivacy:!0}),S())}),Q=(0,u.A)(e=>{w(!1),x(e)}),X=(0,u.A)(e=>{const t=(0,o.PVB)((0,n.mS)(),e),i=R===e&&!P;if(t)return(0,N.FD)(ze.A,{onClick:()=>Q(e),children:[(0,N.Y)(f.A,{size:"small",peer:t}),(0,N.FD)("div",{className:(0,s.A)(ct.itemInfo),children:[(0,N.Y)(Ee.A,{className:ct.itemTitle,peer:t,noFake:!0,noVerified:!0}),(0,N.Y)("span",{className:ct.itemSubtitle,children:(0,r.mO)(t)?E("PeerPersonalAccount"):E("PeerChannel")})]}),(0,N.Y)(F.A,{className:ct.itemIcon,name:i?"check":"placeholder"})]})}),$=(0,a.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,N.FD)(U.A,{ripple:!V,size:"smaller",color:"translucent",className:(0,s.A)(ct.sendAsPeerMenuButton,t?"active":""),onClick:e,ariaLabel:E("AriaLabelOpenMenu"),children:[(0,N.Y)(f.A,{className:ct.sendAsPeerButtonAvatar,size:"mini",peer:P?dt:K}),(0,N.Y)(F.A,{name:"down",className:ct.buttonDownIcon})]}),[V,E,K,P]),Z=(0,a.Kr)(()=>{if(j)return(0,N.Y)(He.A,{className:(0,s.A)(ct.sendAsPeerMenu,"with-menu-transitions"),bubbleClassName:ct.sendAsPeerMenuBubble,trigger:$,positionX:"right",autoClose:!0,children:W.map(e=>X(e))})},[$,W,j]),ee=(0,a.Kr)(()=>{const e=(0,n.mS)(),t=i?.reactions?.topReactors;if(!t)return;const a=[];let r=!1,s=0;if(t.forEach(t=>{const i=t.peerId?(0,o.PVB)(e,t.peerId):void 0;if(!i&&!t.isAnonymous&&!t.isMy)return;if(t.isMy&&(s=t.count),t.isMy&&(t.peerId!==R||t.isAnonymous&&!P))return;const n=R===t.peerId||P&&t.isAnonymous;n&&(r=!0),a.push({amount:t.count,localAmount:n&&Y?y:0,isMy:t.isMy,isAnonymous:t.isAnonymous,user:i})}),!r){const t=(0,o.PVB)(e,R);a.push({amount:s,localAmount:Y?y:0,isMy:!0,user:t})}return a.sort((e,t)=>t.amount+t.localAmount-(e.amount+e.localAmount)),a.slice(0,3)},[Y,i?.reactions?.topReactors,y,R,P]),te=t&&(0,r.F9)(O,t);return(0,N.FD)(h.A,{isOpen:Boolean(e),onClose:S,isSlim:!0,hasAbsoluteCloseButton:!0,contentClassName:ct.content,isLowStackPriority:!0,children:[(0,N.Y)("div",{className:ct.sendAsPeersMenuContainer,children:Z}),(0,N.Y)("div",{className:ct.headerControlPanel,children:(0,N.Y)(H,{balance:d,className:ct.modalBalance,withAddButton:!0})}),(0,N.Y)(lt,{className:ct.slider,defaultValue:50,maxValue:l,onChange:z}),(0,N.Y)("h3",{className:ct.title,children:O("StarsReactionTitle")}),(0,N.Y)("div",{className:ct.description,children:(0,c.A)(O("StarsReactionText",te),["simple_markdown","emoji"])}),(0,N.Y)(Je.A,{children:ee&&(0,N.Y)("div",{className:ct.topLabel,children:O("StarsReactionTopSenders")})}),ee&&(0,N.Y)("div",{className:ct.top,children:ee.map(e=>{const t=(0,J.Sm)(e.amount+e.localAmount),i=e.isAnonymous||!e.user||e.isMy&&P?dt:e.user,a="isCustomPeer"in i?O(i.titleKey):i&&(0,r.F9)(O,i);return(0,N.Y)(Ae.A,{className:ct.topPeer,peer:i,badgeText:t,badgeIcon:"star",badgeClassName:ct.topBadge,text:a},`${e.user?.id||"anonymous"}-${t}`)})}),ee&&(0,N.Y)(Je.A,{className:ct.separator}),(0,N.Y)(qe.A,{className:(0,s.A)(ct.checkBox,"dialog-checkbox"),checked:!P,onChange:q,label:O("StarsReactionShowMeInTopSenders")}),(0,N.Y)(U.A,{onClick:_,children:E("SendPaidReaction",{amount:y},{withNodes:!0,specialReplacement:{[G.Cyx]:(0,N.Y)(F.A,{className:ct.buttonStar,name:"star"})}})}),(0,N.Y)("p",{className:ct.disclaimer,children:E("StarsReactionTerms",{link:(0,N.Y)(p.A,{text:E("StarsReactionLinkText"),url:E("StarsReactionLink")})},{withNodes:!0})})]})}));var mt=i(37836),ft=i(5912),pt=i(23174),ht=i(21309),At=i(65632),gt=i(20333),bt=i(36143),vt=i(96530),Nt=i(22720),St=i(63152),Gt=i(94079),Ct=i(61361);const It="zZUpGRSI",yt="zAee80Dv",kt="nTPAv1ci",Yt=48*ht.dp,Bt=(0,a.ph)((0,n.EK)((e,{peerId:t,gift:i})=>{const a=(0,o.SJA)(e),{stars:n}=e,{isBlurred:r,patternColor:s,background:l,backgroundColor:c}=(0,o.Gyz)(e,a)||{},d=(0,o.PVB)(e,t),u=(0,o.WA9)(e,t),m=(0,o.vGo)(e,t),f=e.currentUserId===t,p=!f&&m?.disallowedGifts?.shouldDisallowUniqueStarGifts,h=!f&&m?.disallowedGifts?.shouldDisallowLimitedStarGifts,A=(0,o.nTw)(e),g="id"in i&&"starGift"===i.type&&i.isAuction?i.id:void 0,b=g?e.giftAuctionByGiftId?.[g]:void 0;return{starBalance:n?.balance,peer:d,theme:a,isBackgroundBlurred:r,patternColor:s,customBackground:l,backgroundColor:c,captionLimit:e.appConfig.starGiftMaxMessageLength,currentUserId:e.currentUserId,isPaymentFormLoading:A.isPaymentFormLoading,paidMessagesStars:u,areUniqueStarGiftsDisallowed:p,shouldDisallowLimitedStarGifts:h,giftAuction:b}})(function({gift:e,giftByStars:t,peerId:i,peer:o,captionLimit:c,theme:d,isBackgroundBlurred:m,patternColor:f,backgroundColor:p,customBackground:h,currentUserId:A,isPaymentFormLoading:g,starBalance:b,paidMessagesStars:v,areUniqueStarGiftsDisallowed:S,shouldDisallowLimitedStarGifts:G,giftAuction:C}){const{sendStarGift:I,sendPremiumGiftByStars:y,openInvoice:k,openGiftUpgradeModal:Y,openStarsBalanceModal:B,openGiftAuctionBidModal:D,openGiftAuctionInfoModal:P,openGiftAuctionChangeRecipientModal:w}=(0,n.ko)(),T=(0,M.A)(),[F,R]=(0,a.J0)(""),[x,L]=(0,a.J0)(!1),[K,O]=(0,a.J0)(!1),[V,E]=(0,a.J0)(!1),q=(0,At.A)(d,h);(0,a.vJ)(()=>{G&&O(!0)},[G,K]);const H="id"in e&&"starGift"===e.type,J="months"in e,W=t&&"amount"in t,j=o&&(0,r.mO)(o),_=i===A,Q=(0,a.Kr)(()=>{if(J){const i=V&&W?t:e;return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"giftPremium",amount:i.amount,currency:i.currency,days:30*e.months,message:F?{text:F}:void 0}}}}if(H)return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"starGift",message:F?.length?{text:F}:void 0,isNameHidden:x||void 0,starsToConvert:e.starsToConvert,canUpgrade:K||void 0,alreadyPaidUpgradeStars:K?e.upgradeStars:void 0,gift:e,peerId:i,fromId:A}}}},[A,e,F,H,x,K,i,V,W,t,J]),X=(0,u.A)(e=>{R(e.target.value)}),$=(0,u.A)(()=>{L(!x)}),Z=(0,u.A)(()=>{O(!K)}),ee=(0,u.A)(()=>{W&&E(!V)}),te=(0,u.A)(()=>{H&&Y({giftId:e.id,peerId:i})}),ie=(0,u.A)(()=>{B({})}),ae=(0,u.A)(()=>{C&&P({auctionGiftId:C.gift.id})}),ne=(0,u.A)(()=>{if(C){const e=C.userState.bidPeerId;return e&&e!==i?void w({auctionGiftId:C.gift.id,oldPeerId:e,newPeerId:i,message:F||void 0,shouldHideName:x||void 0}):void D({auctionGiftId:C.gift.id,peerId:i,message:F||void 0,shouldHideName:x||void 0})}H?I({peerId:i,shouldHideName:x,gift:e,message:F?{text:F}:void 0,shouldUpgrade:K}):V&&W?y({userId:i,months:t.months,amount:t.amount,message:F?{text:F}:void 0}):J&&k({type:"giftcode",userIds:[i],currency:e.currency,amount:e.amount,option:e,message:F?{text:F}:void 0})}),re=W&&b&&b.amount>t.amount,oe=(0,s.A)("ZORVRSG3","soDpW2YR",h&&"Eny_G3JI",p&&"TkJZPU2u",h&&m&&"M6k91TdM");if((H||J)&&Q)return(0,N.FD)("div",{className:(0,s.A)("jKOG0It6","custom-scroll"),children:[(0,N.FD)("div",{className:(0,s.A)("CB1mxsgp","MessageList"),inert:!0,style:(0,Ie.A)(`--pattern-color: ${f}`,p&&`--theme-background-color: ${p}`),children:[(0,N.Y)("div",{className:oe,style:q?`--custom-background: ${q}`:void 0}),(0,N.Y)(bt.A,{message:Q,threadId:pt.l3,appearanceOrder:0},H?e.id:J?e.months:void 0)]}),function(){const i=c?c-F.length:void 0,a=(0,r.F9)(T,o);return(0,N.FD)("div",{className:"Y68CEIKn",children:[!v&&(0,N.Y)(Gt.A,{className:"o5r2IPoA",onChange:X,value:F,label:T("GiftMessagePlaceholder"),maxLength:c,maxLengthIndicator:i&&i<50?i.toString():void 0}),re&&(0,N.FD)(Nt.A,{className:It,narrow:!0,ripple:!0,onClick:ee,children:[(0,N.Y)("span",{children:T("GiftPremiumPayWithStars",{stars:(0,pe.U2)(T,t.amount,{className:yt})},{withNodes:!0})}),(0,N.Y)(St.A,{checked:V,onChange:ee,label:T("GiftPremiumPayWithStarsAcc")})]}),W&&b&&(0,N.Y)("div",{className:kt,children:T("GiftPremiumDescriptionYourBalance",{stars:(0,pe.U2)(T,b.amount,{className:yt}),link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:ie,children:T("GetMoreStarsLinkText")})},{withNodes:!0,withMarkdown:!0})}),H&&Boolean(e.upgradeStars)&&!S&&(0,N.FD)(Nt.A,{className:It,narrow:!0,ripple:!0,onClick:Z,disabled:G,children:[(0,N.Y)("span",{children:T("GiftMakeUnique",{stars:(0,pe.U2)(T,e.upgradeStars,{className:yt})},{withNodes:!0})}),(0,N.Y)(St.A,{checked:K,onChange:Z,label:T("GiftMakeUniqueAcc")})]}),H&&Boolean(e.upgradeStars)&&!S&&(0,N.Y)("div",{className:kt,children:j?T("GiftMakeUniqueDescription",{user:a,link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:te,children:T("GiftMakeUniqueLink")})},{withNodes:!0}):T("GiftMakeUniqueDescriptionChannel",{peer:a,link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:te,children:T("GiftMakeUniqueLink")})},{withNodes:!0})}),H&&(0,N.FD)(Nt.A,{className:It,narrow:!0,ripple:!0,onClick:$,children:[(0,N.Y)("span",{children:T("GiftHideMyName")}),(0,N.Y)(St.A,{checked:x,onChange:$,label:T("GiftHideMyName")})]}),H&&(0,N.Y)("div",{className:kt,children:_?T("GiftHideNameDescriptionSelf"):j?T("GiftHideNameDescription",{receiver:a}):T("GiftHideNameDescriptionChannel")})]})}(),(0,N.Y)("div",{className:"ATowWJ60"}),function(){const i=V&&W?(0,pe.U2)(T,t.amount,{asFont:!0}):H?(0,pe.U2)(T,e.stars+(K?e.upgradeStars:0),{asFont:!0}):J?(0,l.vv)(T,e.amount,e.currency):void 0,a=C?.gift.giftsPerRound,n=C?.state.endDate,r=n?n-(0,Ye.Fm)():void 0,o=void 0!==r&&r>0&&r<Yt;return(0,N.FD)("div",{className:"jxWZSvet",children:[H&&Boolean(e.availabilityRemains)&&(0,N.Y)(gt.A,{isPrimary:!0,progress:e.availabilityRemains/e.availabilityTotal,rightText:T("GiftSoldCount",{count:e.availabilityTotal-e.availabilityRemains}),leftText:T("GiftLeftCount",{count:e.availabilityRemains}),className:"mWzLu0c0"}),C&&Boolean(a)&&(0,N.Y)("div",{className:"j4s8T1dQ",children:T("GiftAuctionDescription",{count:a,link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:ae,children:T("GiftAuctionLearnMore")})},{pluralValue:a,withNodes:!0})}),(0,N.Y)(U.A,{className:"IDuhjrne",size:r?void 0:"smaller",onClick:ne,isLoading:g,noForcedUpperCase:!0,children:C?(0,N.FD)("div",{children:[(0,N.Y)("div",{children:T("GiftAuctionPlaceBid")}),void 0!==r&&r>0&&(0,N.Y)("div",{className:"pB6hqcvA",children:T("GiftAuctionTimeLeft",{time:o?(0,N.Y)(Ct.A,{endsAt:n}):(0,z.zt)(T,r)},{withNodes:!0})})]}):T("GiftSend",{amount:i},{withNodes:!0})})]})}()]})}));var Dt=i(87049);const Pt="G1mBmzxs",wt="a8no5WH0",Tt="DvJLTVFU",Mt=(0,a.ph)((0,n.EK)((e,{option:t})=>({sticker:(0,o.t0O)(e,t.months),canPlayAnimatedEmojis:(0,o.BWX)(e)}))(function({sticker:e,canPlayAnimatedEmojis:t,baseMonthAmount:i,option:a,optionByStars:n,onClick:r}){const{months:o,amount:s,currency:c}=a,d=(0,M.A)(),m=(0,u.A)(()=>{r(a)}),f=Math.floor(s/o),p=i&&i>f?Math.ceil(100-f/(i/100)):void 0;return(0,N.FD)("div",{className:Pt,tabIndex:0,role:"button",onClick:m,children:[(0,N.Y)(ee.A,{sticker:e,play:t,noLoop:!0,nonInteractive:!0,size:86}),function(){const e=12===o?d("Years",{count:1},{pluralValue:1}):d("Months",{count:o},{pluralValue:o});return(0,N.Y)("div",{className:"rn9aWFNA",children:e})}(),(0,N.Y)("div",{className:"q4_ydkAx",children:d("PremiumGiftDescription")}),(0,N.Y)(U.A,{className:wt,color:"adaptive",nonInteractive:!0,size:"tiny",pill:!0,fluid:!0,children:(0,l.Ad)(s,c)}),n&&(0,N.Y)("div",{className:"QB5SI7ta",children:d("GiftPremiumStarsPrice",{stars:(0,pe.U2)(d,n.amount,{className:"jgnEfoeM"})},{withNodes:!0,withMarkdown:!0})}),Boolean(p)&&(0,N.Y)(Dt.A,{color:"purple",text:d("GiftDiscount",{percent:p})})]})}));var Ft=i(82855);const Ut=(0,a.ph)((0,n.EK)(e=>({isCurrentUserPremium:(0,o.g29)(e)}))(function({gift:e,isResale:t,isCurrentUserPremium:i,withTransferBadge:r,hideBadge:o,noClickable:l,observeIntersection:c,onClick:d}){const{openGiftInfoModal:m,openPremiumModal:f,showNotification:p,checkCanSendGift:h,openGiftAuctionModal:A}=(0,n.ko)(),g=(0,a.li)(),b=(0,a.li)(),v=(0,M.A)(),[S,C]=(0,a.J0)(!1),[I,y,k]=(0,T.A)(),Y=(0,X.yQ)(e),B="starGiftUnique"===e.type,D=B?e:void 0,P=B?void 0:e,w=B?function(t){if(!t)return{amount:0,currency:G.OUy};if("starGiftUnique"===e.type&&e.resaleTonOnly){const e=t.find(e=>e.currency===G.ykW);if(e)return e}return t.find(e=>e.currency===G.OUy)}(D?.resellPrice):{amount:P?.stars||0,currency:G.OUy},R=w?.currency||G.OUy,x=P?.resellMinStars,L=!B&&t&&x?v.number(x)+"+":w?.amount||0,K=!B&&Boolean(P?.isLimited),O=!B&&Boolean(P?.isSoldOut),V=!B&&!t&&Boolean(P?.isAuction),E=Boolean(e?.requirePremium),q=Boolean(P?.limitedPerUser&&!P?.perUserRemains),H=P?.perUserTotal,z=(0,u.A)(()=>{V?A({gift:e}):!O||t?q?p({message:v("NotificationGiftsLimit2",{count:H},{pluralValue:H,withMarkdown:!0,withNodes:!0})}):!E||i?j?h({gift:e,onSuccess:()=>d?.(e,t?"resell":"original")}):d?.(e,t?"resell":"original"):f({gift:e}):m({gift:e})}),J=(0,a.Kr)(()=>{const{backdrop:t,pattern:i}=(0,X.uc)(e)||{};if(!t||!i)return;const a=[t.centerColor,t.edgeColor];return(0,N.Y)(te.A,{className:"Nkotr8Q4",backgroundColors:a,patternIcon:i.sticker,ringsCount:1,ovalFactor:1})},[e]),W=B?e.number:0,j=Boolean("starGift"===e.type&&e.lockedUntilDate),_=(0,a.Kr)(()=>{if(B){const{backdrop:t}=(0,X.uc)(e)||{};if(!t)return;return(0,N.Y)(Dt.A,{color:[t.centerColor,t.edgeColor],text:v("GiftSavedNumber",{number:W})})}return t?(0,N.Y)(Dt.A,{color:"green",text:v("GiftRibbonResale")}):O?(0,N.Y)(Dt.A,{color:"red",text:v("GiftSoldOut")}):V?(0,N.Y)(Dt.A,{color:"orange",text:v("GiftRibbonAuction")}):E?(0,N.Y)(Dt.A,{color:"orange",text:v("GiftRibbonPremium")}):K?(0,N.Y)(Dt.A,{color:"blue",text:v("GiftLimited")}):void 0},[B,t,e,O,K,v,W,E,V]);(0,ft.mv)(g,c,e=>{const t=e.isIntersecting;C(t)});const Q=(0,a.Kr)(()=>r?v("GiftTransferTitle"):V?v("GiftAuctionJoin"):R===G.ykW?(0,pe.Ms)(v,L||0,{shouldConvertFromNanos:!0,className:Tt}):(0,pe.U2)(v,L||0,{asFont:!0,className:Tt}),[r,R,L,V,v]);return(0,N.FD)("div",{ref:g,className:(0,s.A)("interactive-gift",Pt,"f5ArEO1S","starGiftItem",E&&"NBYIITte",V&&"WqBCC4Ce",l&&"pcLi3lcD"),tabIndex:l?void 0:0,role:l?void 0:"button",onClick:l?void 0:z,onMouseEnter:Ce.TF||l?void 0:y,onMouseLeave:Ce.TF||l?void 0:k,children:[J,(0,N.Y)("div",{ref:b,className:"rUSoeQXb",style:"width: 90px; height: 90px",children:Y&&(0,N.Y)(Ft.A,{observeIntersectionForPlaying:c,observeIntersectionForLoading:c,containerRef:b,sticker:Y,size:90,shouldLoop:I,shouldPreloadPreview:!0})}),!o&&(0,N.Y)(U.A,{className:(0,s.A)(wt,r&&"nqN62arv"),nonInteractive:!0,size:"tiny",color:B?"bluredStarsBadge":"stars",withSparkleEffect:S&&!r,pill:!0,fluid:!0,children:Q}),_,j&&(0,N.Y)(F.A,{name:"lock-badge",className:"kwuipwV7"})]})}));var Rt=i(13235),xt=i(36175),Lt=i(96374),Kt=i(64489);const Ot={root:"tJK1W0pJ",transition:"pP8TxefR",content:"o3V1HqbL",resaleScreenRoot:"Vce_TsJO",main:"cVXqeu9P",giftSection:"v4eKefwN",section:"EqfarEYb",resaleStarGiftsContainer:"RSFcSNGL",starGiftsContainer:"OQX3GZl5",premiumGiftsGallery:"n40m3BK2",header:"iqqoyRgW",noBorder:"cuvdjW2y",resaleHeader:"cJRBgg9B",resaleHeaderContentContainer:"OXYQmfGK",headerSlide:"BTWhJUQB",headerText:"lLRmbpIu",hiddenHeader:"XgGzn1cQ",resaleHeaderText:"bp_KPx8I",commonHeaderText:"ybZo03if",resaleHeaderDescription:"XefHUFm1",closeButton:"r_Y5uG1T",balance:"soqAknia",avatars:"N_7tYJKr",avatar:"_3hY4vIep",logoBackground:"ieK4TzSb",center:"Ey5gX40t",description:"ZioU5h_k",starGiftsDescription:"gFgzS8pV",boostIcon:"Qi2YR6Dz",optionBottom:"RTbClMKE",secondaryInfo:"g0R9GSNq",footer:"J3Gju3bv",starGiftsTransition:"kB6IyXqS",notFoundGiftsRoot:"UqnRlJ1n",notFoundGiftsDescription:"g0VbwIG_",notFoundGiftsLink:"j2zPEQr8"},Vt=(0,a.ph)((0,n.EK)(e=>{const{starGifts:t}=e,{resaleGifts:i}=(0,o.nTw)(e),a=i?.giftId?t?.byId[i.giftId]:void 0,n=i.filter,r=i.isAllLoaded,s=i.isLoading,l=i.updateIteration;return{resellGifts:i.gifts,gift:a,filter:n,areGiftsAllLoaded:r,areGiftsLoading:s,updateIteration:l}})(({resellGifts:e,gift:t,filter:i,areGiftsAllLoaded:r,areGiftsLoading:o,updateIteration:l,onGiftClick:c})=>{const{loadResaleGifts:d,updateResaleGiftsFilter:m}=(0,n.ko)(),f=(0,a.li)(),p=(0,M.A)(),h=(0,a.Kr)(()=>e?.map(e=>e.id),[e]),A=Boolean(i?.modelAttributes?.length||i?.patternAttributes?.length||i?.backdropAttributes?.length),g=(0,u.A)(()=>{if(t){const e="regularGiftId"in t?t.regularGiftId:t.id;d({giftId:e})}}),b=Boolean(!e||0===e.length),[v,S]=(0,Lt.A)(g,h,!t,Rt.bc),{observe:G}=(0,ft.BL)({rootRef:f,throttleMs:200}),C=(0,u.A)(()=>{m({filter:{...i,modelAttributes:[],backdropAttributes:[],patternAttributes:[]}})});return(0,N.Y)("div",{ref:f,className:(0,s.A)(Ot.resaleScreenRoot,"custom-scroll"),children:(0,N.FD)(L.Ay,{name:"zoomFade",activeKey:l,children:[b&&r&&(0,N.FD)("div",{className:Ot.notFoundGiftsRoot,children:[(0,N.Y)(Kt.A,{size:160,tgsUrl:xt.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,N.Y)("div",{className:Ot.notFoundGiftsDescription,children:p("ResellGiftsNoFound")}),A&&(0,N.Y)(vt.A,{className:Ot.notFoundGiftsLink,onClick:C,children:p("ResellGiftsClearFilters")})]}),(0,N.Y)(R.A,{className:(0,s.A)(Ot.resaleStarGiftsContainer),items:v,onLoadMore:S,itemSelector:".starGiftItem",noFastList:!0,preloadBackwards:Rt.bc,scrollContainerClosest:`.${Ot.resaleScreenRoot}`,children:e?.map(e=>(0,N.Y)(Ut,{gift:e,observeIntersection:G,isResale:!0,onClick:c},e.id))})]})})}));var Et=i(10722),qt=i(71429),Ht=i(36393),zt=i(87094);const Jt=1.5*w.$,Wt=(0,a.ph)((0,n.EK)(e=>({theme:(0,o.SJA)(e)}))(({className:e,type:t,sticker:i,observeIntersectionForLoading:n,observeIntersectionForPlaying:r,theme:o})=>{const l=(0,a.li)(),c=(0,zt.A)(l,void 0,"pattern"!==t);return(0,N.Y)("div",{ref:l,className:(0,s.A)("KLFLR9ji",e),style:`width: ${Jt}px; height: ${Jt}px`,children:(0,N.Y)(Ft.A,{containerRef:l,sticker:i,size:Jt,shouldPreloadPreview:!0,observeIntersectionForLoading:n,observeIntersectionForPlaying:r,thumbClassName:"fCL5rY2D",customColor:c})})})),jt={root:"_VgmQnUg",buttonsContainer:"IDlp6U6g",itemIcon:"yuctLnuR",sticker:"VT562JS0",backdropAttributeMenuItemText:"D50wFfRL",menuItemStickerText:"THcGWXSA",menuItemText:"L6EVE2Ux",backdrop:"A29QNxKb",menuItemIcon:"GL4rVsev",item:"qiYcBOYc",menuContentContainer:"EDsBn29z",menu:"ISaNdBwd",left:"e4Kkh_MR",right:"Kz_nCGC3"},_t=(0,a.ph)((0,n.EK)(e=>{const{resaleGifts:t}=(0,o.nTw)(e);return{attributes:t.attributes,counters:t.counters,filter:t.filter}})(({attributes:e,counters:t,filter:i,dialogRef:r})=>{const o=(0,M.A)(),{updateResaleGiftsFilter:l}=(0,n.ko)(),[c,d]=(0,a.J0)(""),[m,f]=(0,a.J0)(""),[p,h]=(0,a.J0)(""),A=(0,a.Kr)(()=>{const i={model:[],pattern:[],backdrop:[]};for(const a of t??[]){const{attribute:t}=a;if(!a.count)continue;const n=e?.find(e=>"backdrop"===e.type&&"backdrop"===t.type?e.backdropId===t.backdropId:("model"===e.type&&"model"===t.type||"pattern"===e.type&&"pattern"===t.type)&&e.sticker.id===t.documentId);"backdrop"===n?.type&&i.backdrop.push(n),"model"===n?.type&&i.model.push(n),"pattern"===n?.type&&i.pattern.push(n)}return i},[e,t]),g=(0,a.Kr)(()=>{const e=(e,t)=>t.trim()?e.filter(e=>Boolean(e.name?.toLowerCase().includes(t.toLowerCase()))):e;return{model:e(A.model,c),pattern:e(A.pattern,p),backdrop:e(A.backdrop,m)}},[A,c,m,p]),b=(0,a.li)(),{isContextMenuOpen:v,contextMenuAnchor:S,handleContextMenu:G,handleContextMenuClose:C,handleContextMenuHide:I}=(0,Et.A)(r),y=(0,u.A)(()=>b.current),k=(0,a.li)(),{isContextMenuOpen:Y,contextMenuAnchor:B,handleContextMenu:D,handleContextMenuClose:P,handleContextMenuHide:w}=(0,Et.A)(r),T=(0,u.A)(()=>k.current),U=(0,a.li)(),{isContextMenuOpen:R,contextMenuAnchor:x,handleContextMenu:L,handleContextMenuClose:K,handleContextMenuHide:O}=(0,Et.A)(r),V=(0,u.A)(()=>U.current),E=(0,a.li)(),{isContextMenuOpen:q,contextMenuAnchor:H,handleContextMenu:z,handleContextMenuClose:J,handleContextMenuHide:W}=(0,Et.A)(r),j=(0,u.A)(()=>E.current),_=(0,a.Kr)(()=>{const e=i.sortType;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:["byDate"===e&&o("ValueGiftSortByDate"),"byNumber"===e&&o("ValueGiftSortByNumber"),"byPrice"===e&&o("ValueGiftSortByPrice"),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),Q=(0,a.Kr)(()=>{const e=i?.modelAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:[0===e&&o("GiftAttributeModel"),e>0&&o("GiftAttributeModelPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),X=(0,a.Kr)(()=>{const e=i?.backdropAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:[0===e&&o("GiftAttributeBackdrop"),e>0&&o("GiftAttributeBackdropPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),$=(0,a.Kr)(()=>{const e=i?.patternAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:[0===e&&o("GiftAttributeSymbol"),e>0&&o("GiftAttributeSymbolPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),Z=(0,u.A)(e=>{l({filter:{...i,sortType:e}})}),ee=(0,u.A)(()=>{l({filter:{...i,modelAttributes:[]}})}),ie=(0,u.A)(()=>{l({filter:{...i,patternAttributes:[]}})}),ae=(0,u.A)(()=>{l({filter:{...i,backdropAttributes:[]}})}),ne=(0,u.A)(e=>{if(!t)return;const a=i.modelAttributes||[],n=t.find(t=>"model"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!n)return;const r=a.some(e=>e.documentId===n.documentId)?a.filter(e=>e.documentId!==n.documentId):[...a,n];l({filter:{...i,modelAttributes:r}})}),re=(0,u.A)(e=>{if(!t)return;const a=i.patternAttributes||[],n=t.find(t=>"pattern"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!n)return;const r=a.some(e=>e.documentId===n.documentId)?a.filter(e=>e.documentId!==n.documentId):[...a,n];l({filter:{...i,patternAttributes:r}})}),oe=(0,u.A)(e=>{if(!t)return;const a=i.backdropAttributes||[],n=t.find(t=>"backdrop"===t.attribute.type&&t.attribute.backdropId===e.backdropId)?.attribute;if(!n)return;const r=a.some(e=>e.backdropId===n.backdropId)?a.filter(e=>e.backdropId!==n.backdropId):[...a,n];l({filter:{...i,backdropAttributes:r}})}),se=(0,a.hb)(()=>{d("")},[]),le=(0,a.hb)(()=>{f("")},[]),ce=(0,a.hb)(()=>{h("")},[]),de=(0,u.A)(e=>{e.stopPropagation(),e.preventDefault()}),ue=(0,a.li)(),{observe:me}=(0,ft.BL)({rootRef:ue,isDisabled:!B});return(0,N.FD)("div",{className:jt.root,children:[Boolean(S)&&(0,N.Y)(qt.A,{isOpen:v,anchor:S,ref:b,className:(0,s.A)(jt.menu,jt.left,"with-menu-transitions"),getMenuElement:y,autoClose:!0,onClose:C,onCloseAnimationEnd:I,positionX:"left",children:(0,N.FD)(N.FK,{children:[(0,N.FD)(ze.A,{icon:"sort-by-price",onClick:()=>{Z("byPrice")},children:[(0,N.Y)("div",{className:jt.menuItemText,children:o("GiftSortByPrice")}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:"byPrice"===i?.sortType?"check":"placeholder"})]}),(0,N.FD)(ze.A,{icon:"sort-by-date",onClick:()=>{Z("byDate")},children:[(0,N.Y)("div",{className:jt.menuItemText,children:o("GiftSortByDate")}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:"byDate"===i?.sortType?"check":"placeholder"})]}),(0,N.FD)(ze.A,{icon:"sort-by-number",onClick:()=>{Z("byNumber")},children:[(0,N.Y)("div",{className:jt.menuItemText,children:o("GiftSortByNumber")}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:"byNumber"===i?.sortType?"check":"placeholder"})]})]})}),Boolean(B)&&(0,N.Y)(qt.A,{isOpen:Y,anchor:B,ref:k,className:(0,s.A)(jt.menu,jt.left,"with-menu-transitions"),getMenuElement:T,autoClose:!0,onClose:P,onCloseAnimationEnd:w,children:function(){const e=g.model,t=i.modelAttributes??[],a=0===t.length;return(0,N.FD)("div",{className:jt.menuContentContainer,ref:ue,children:[(0,N.Y)(Ht.A,{onClick:de,className:jt.search,value:c,onChange:d,onReset:se,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ee,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,N.FD)(ze.A,{onClick:()=>{ne(e)},children:[(0,N.Y)(Wt,{className:jt.sticker,sticker:e.sticker,type:"model",observeIntersectionForLoading:me,observeIntersectionForPlaying:me}),(0,N.Y)("div",{className:jt.menuItemStickerText,children:e.name}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(x)&&(0,N.Y)(qt.A,{isOpen:R,anchor:x,ref:U,className:(0,s.A)(jt.menu,jt.right,"with-menu-transitions"),getMenuElement:V,autoClose:!0,onClose:K,onCloseAnimationEnd:O,positionX:"right",children:function(){const e=g.backdrop,t=i.backdropAttributes??[],a=0===t.length;return(0,N.FD)("div",{className:jt.menuContentContainer,children:[(0,N.Y)(Ht.A,{onClick:de,className:jt.search,value:m,onChange:f,onReset:le,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ae,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.backdropId===e.backdropId);return(0,N.FD)(ze.A,{onClick:()=>{oe(e)},children:[(0,N.Y)(te.A,{className:jt.backdrop,backgroundColors:[e.centerColor,e.edgeColor]}),(0,N.Y)("div",{className:jt.backdropAttributeMenuItemText,children:e.name}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(H)&&(0,N.Y)(qt.A,{isOpen:q,anchor:H,ref:E,className:(0,s.A)(jt.menu,jt.right,"with-menu-transitions"),getMenuElement:j,autoClose:!0,onClose:J,onCloseAnimationEnd:W,children:function(){const e=g.pattern,t=i.patternAttributes??[],a=0===t.length;return(0,N.FD)("div",{className:jt.menuContentContainer,children:[(0,N.Y)(Ht.A,{onClick:de,className:jt.search,value:p,onChange:h,onReset:ce,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ie,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,N.FD)(ze.A,{onClick:()=>{re(e)},children:[(0,N.Y)(Wt,{className:jt.sticker,sticker:e.sticker,type:"pattern"}),(0,N.Y)("div",{className:jt.menuItemStickerText,children:e.name}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),(0,N.FD)("div",{className:jt.buttonsContainer,children:[(0,N.Y)(_,{onTrigger:G,isOpen:v}),(0,N.Y)(Q,{onTrigger:D,isOpen:Y}),(0,N.Y)(X,{onTrigger:L,isOpen:R}),(0,N.Y)($,{onTrigger:z,isOpen:q})]})]})}));var Qt=i(36838);const Xt=(0,a.ph)((0,n.EK)(e=>{const{starGifts:t}=e;return{idsByCategory:t?.idsByCategory}})(({ref:e,idsByCategory:t,onCategoryChanged:i,areUniqueStarGiftsDisallowed:n,areLimitedStarGiftsDisallowed:r,isSelf:o,hasMyUnique:l,isPinned:c})=>{let d=(0,a.li)();e&&(d=e);const u=(0,M.A)(),m=Boolean(t?.collectible?.length),[f,p]=(0,a.J0)("all");function h(e){return"all"===e?u("AllGiftsCategory"):"myUnique"===e?u("GiftCategoryMyGifts"):"collectible"===e?u("GiftCategoryCollectibles"):e}function A(e){return(0,N.Y)("div",{className:(0,s.A)("dO7FKYY4",f===e&&"B2lEJk1v"),onClick:()=>function(e){p(e),i(e)}(e),children:h(e)})}return(0,Qt.A)(d,void 0,!0),(0,N.FD)("div",{ref:d,className:(0,s.A)("cUjwvN00",c&&"NhJABU3M","no-scrollbar"),children:[A("all"),!n&&!o&&l&&A("myUnique"),(!n||!r)&&m&&A("collectible")]})})),$t=[0,-50],Zt=3.5*w.$,ei=(0,mt.nF)(e=>e(),200,!0),ti=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const{starGifts:i,stars:a,currentUserId:n}=e,r=t?.forPeerId?(0,o.PVB)(e,t.forPeerId):void 0,s=Boolean(n&&t?.forPeerId===n),l=r?(0,o.vGo)(e,r?.id):void 0,{resaleGifts:c}=(0,o.nTw)(e),d=c.count,u=!1!==c.isLoading,m=t?.selectedResaleGift;return{boostPerSentGift:e.appConfig.boostsPerSentGift,starGiftsById:i?.byId,starGiftIdsByCategory:i?.idsByCategory,myUniqueGiftsById:e.myUniqueGifts?.byId,myUniqueGiftIds:e.myUniqueGifts?.ids,starBalance:a?.balance,peer:r,isSelf:s,disallowedGifts:l?.disallowedGifts,resaleGiftsCount:d,areResaleGiftsLoading:u,selectedResaleGift:m,tabId:(0,o.nTw)(e).id}})(({modal:e,starGiftsById:t,starGiftIdsByCategory:i,myUniqueGiftsById:o,myUniqueGiftIds:l,starBalance:c,peer:A,isSelf:g,disallowedGifts:b,resaleGiftsCount:v,areResaleGiftsLoading:S,selectedResaleGift:I,tabId:y})=>{const{closeGiftModal:k,openGiftInfoModal:Y,resetResaleGifts:B,loadResaleGifts:D,openGiftInMarket:P,closeResaleGiftsMarket:w,loadMyUniqueGifts:F,openGiftTransferConfirmModal:x,setGiftModalSelectedGift:K}=(0,n.ko)(),O=(0,a.li)(),V=(0,a.li)(),E=(0,a.li)(),q=(0,a.li)(),z=(0,a.li)(),J=Boolean(e),W=(0,d.A)(e),j=A&&(0,r.mO)(A)?A:void 0,_=A&&(0,r.vj)(A)?A:void 0,Q=W?.selectedGift,[X,$]=(0,a.J0)(!1),[Z,ee]=(0,a.J0)(!1),[te,ie]=(0,a.J0)(!1),[ae,ne]=(0,a.J0)("all"),[re,oe,se]=(0,T.A)(!1),le=(0,a.li)(),ce=(0,a.Kr)(()=>{if(!b)return;const{shouldDisallowPremiumGifts:e,...t}=b;return!g&&Object.values(t).every(Boolean)},[g,b]),de=!g&&b?.shouldDisallowUnlimitedStarGifts,ue=!g&&b?.shouldDisallowLimitedStarGifts,me=!g&&b?.shouldDisallowUniqueStarGifts,fe=(0,m.A)(),pe=(0,M.A)(),he=W?.gifts,Ae=(0,a.Kr)(()=>he?.sort((e,t)=>e.months-t.months).filter(e=>1===e.users&&e.currency!==G.OUy),[he]),ge=(0,a.Kr)(()=>{const e=new Map;return Ae?(Ae.forEach(t=>{const i=he?.find(e=>e.currency===G.OUy&&e.months===t.months);i&&e.set(t,i)}),e):e},[he,Ae]),be=(0,a.Kr)(()=>Ae?.reduce((e,t)=>e.amount<t.amount?e:t),[Ae]),{observe:ve}=(0,ft.BL)({rootRef:z,throttleMs:200,isDisabled:!J}),Ne=Boolean(I)&&!Q,Ge=Boolean(Q),Ce=Ne||Ge||X,Ie=Ge?te:Z;(0,a.vJ)(()=>{if(I){const e="regularGiftId"in I?I.regularGiftId:I.id;D({giftId:e})}},[I]),(0,a.vJ)(()=>{J||($(!1),K({gift:void 0}),ne("all"))},[J]),(0,a.vJ)(()=>{ie(Boolean(Q&&"id"in Q))},[Q]);const ye=(0,u.A)(e=>{if(Ge)return;const t=e.currentTarget;ei(()=>{const{scrollTop:e}=t;if($(e>150),V.current&&E.current){const{top:e}=E.current.getBoundingClientRect(),{top:t}=V.current.getBoundingClientRect();ee(e-t<=0)}if(q.current&&z.current){const{top:e}=q.current.getBoundingClientRect(),{top:t}=z.current.getBoundingClientRect();e-t<=Zt?oe():se()}})}),ke=pe("GiftPremiumDescription",{user:(0,C.Yg)(j),link:(0,N.Y)(p.A,{text:pe("GiftPremiumDescriptionLinkCaption"),url:pe("GiftPremiumDescriptionLink")})},{withNodes:!0}),Ye=(0,a.Kr)(()=>_?pe("StarGiftDescriptionChannel",{peer:(0,r.F9)(pe,_)},{withNodes:!0,withMarkdown:!0}):g?pe("StarGiftDescriptionSelf",void 0,{withNodes:!0,renderTextFilters:["br"]}):"collectible"===ae?pe("StarGiftDescriptionCollectibles"):pe("StarGiftDescription",{user:(0,C.Yg)(j)},{withNodes:!0,withMarkdown:!0}),[_,g,ae,j,pe]),Be=(0,u.A)((e,t)=>{if("resell"===t){if(!("id"in e))return;return Ne?void Y({gift:e,recipientId:W?.forPeerId}):void P({gift:e,tabId:y})}K({gift:e})}),De=(0,u.A)(e=>{if("starGift"===e.type||!o||!A?.id)return;const t=o[e.id];x({gift:t,recipientId:A.id})}),Pe=(0,u.A)(()=>{"myUnique"===ae&&F()});const we=(0,u.A)(e=>{ne(e)}),Te=(0,u.A)(()=>{K({gift:void 0}),B(),k()}),Me=(0,u.A)(()=>{Ne?w({tabId:y}):Ge?K({gift:void 0}):Te()}),Fe=(0,u.A)(()=>{le.current?.()}),Ue=(0,u.A)(e=>{le.current=e}),Re=Ge||Ne,xe=(0,s.A)("animated-close-icon",Re&&"state-back");return(0,N.FD)(h.A,{dialogRef:O,onClose:Te,isOpen:J,isSlim:!0,contentClassName:Ot.content,className:(0,s.A)(Ot.modalDialog,Ot.root),isLowStackPriority:!0,children:[(0,N.Y)(U.A,{className:Ot.closeButton,round:!0,color:"translucent",size:"tiny",onClick:Me,ariaLabel:fe(Re?"Common.Back":"Common.Close"),children:(0,N.Y)("div",{className:xe})}),(0,N.Y)(H,{className:Ot.balance,balance:c,withAddButton:!0}),(0,N.Y)("div",{className:(0,s.A)(Ot.header,Ne&&Ot.resaleHeader,!Ce&&Ot.hiddenHeader,re&&Ot.noBorder),children:(0,N.Y)(L.Ay,{name:"slideVerticalFade",activeKey:Ce?Ne?1:Ie?2:3:0,slideClassName:Ot.headerSlide,children:function(){if(Ce){if(Ne){const e=S&&!v;return(0,N.FD)("div",{className:Ot.resaleHeaderContentContainer,children:[(0,N.Y)("h2",{className:Ot.resaleHeaderText,children:I.title}),e&&(0,N.Y)("div",{className:Ot.resaleHeaderDescription,children:pe("Loading")}),!e&&void 0!==v&&(0,N.Y)("div",{className:Ot.resaleHeaderDescription,children:pe("HeaderDescriptionResaleGifts",{count:v},{withNodes:!0,withMarkdown:!0,pluralValue:v})}),(0,N.Y)(_t,{dialogRef:O})]})}return(0,N.Y)("h2",{className:Ot.commonHeaderText,children:pe(Ie?g?"StarsGiftHeaderSelf":"StarsGiftHeader":"GiftPremiumHeader")})}}()})}),(0,N.FD)(L.Ay,{ref:V,className:Ot.transition,name:"pushSlide",activeKey:Ge?1:Ne?2:0,children:[!Ge&&!Ne&&(0,N.FD)("div",{ref:z,className:(0,s.A)(Ot.main,"custom-scroll"),onScroll:ye,children:[(0,N.FD)("div",{className:Ot.avatars,children:[(0,N.Y)(f.A,{className:Ot.avatar,size:100,peer:A,onMouseMove:Fe}),(0,N.Y)(Se.A,{className:Ot.logoBackground,color:"gold",centerShift:$t,onRequestAnimation:Ue})]}),!g&&!_&&!b?.shouldDisallowPremiumGifts&&(0,N.FD)(N.FK,{children:[(0,N.Y)("h2",{className:(0,s.A)(Ot.headerText,Ot.center),children:pe("GiftPremiumHeader")}),(0,N.Y)("p",{className:(0,s.A)(Ot.description,Ot.center),children:ke}),(0,N.Y)("div",{className:Ot.premiumGiftsGallery,children:Ae?.map(e=>(0,N.Y)(Mt,{option:e,optionByStars:ge.get(e),baseMonthAmount:be?Math.floor(be.amount/be.months):void 0,onClick:Be}))})]}),!ce&&(0,N.FD)(N.FK,{children:[(0,N.Y)("h2",{ref:E,className:(0,s.A)(Ot.headerText,Ot.center),children:pe(g?"StarsGiftHeaderSelf":"StarsGiftHeader")}),(0,N.Y)("p",{className:(0,s.A)(Ot.description,Ot.starGiftsDescription,Ot.center),children:Ye}),(0,N.Y)(Xt,{ref:q,areUniqueStarGiftsDisallowed:me,areLimitedStarGiftsDisallowed:ue,isSelf:g,hasMyUnique:Boolean(l?.length),isPinned:re,onCategoryChanged:we}),(0,N.Y)(L.Ay,{name:"zoomFade",activeKey:(Le=ae,"all"===Le?0:"myUnique"===Le?1:2),className:Ot.starGiftsTransition,children:function(){if("myUnique"===ae)return(0,N.Y)(R.A,{className:Ot.starGiftsContainer,items:l,onLoadMore:Pe,scrollContainerClosest:`.${Ot.main}`,itemSelector:".starGiftItem",children:o&&l?.map(e=>{const t=o[e];if(t)return(0,N.Y)(Ut,{gift:t.gift,observeIntersection:ve,onClick:De,withTransferBadge:!0},e)})});const e=i?.[ae]?.filter(e=>{const i=t?.[e];if(!i)return!1;const{isLimited:a,availabilityResale:n}=i;return ue&&a?!me&&n:!(de&&!a)});return(0,N.Y)("div",{className:Ot.starGiftsContainer,children:t&&e?.flatMap(e=>{const i=t[e],a=Boolean(i.availabilityResale)&&!me,n=a&&!i.isSoldOut&&!ue,r=[(0,N.Y)(Ut,{gift:i,observeIntersection:ve,isResale:a&&!n,onClick:Be},e)];return n&&r.push((0,N.Y)(Ut,{isResale:!0,gift:i,observeIntersection:ve,onClick:Be},`resale_${e}`)),r})})}()})]})]}),Ne&&I&&(0,N.Y)(Vt,{onGiftClick:Be}),Ge&&W?.forPeerId&&(0,N.Y)(Bt,{gift:Q,giftByStars:ge.get(Q),peerId:W.forPeerId})]})]});var Le}));const ii=(0,a.ph)((0,n.EK)(e=>{const{currentUserId:t}=e;return{currentUserId:t,userIds:e.contactList?.userIds}})(({modal:e,currentUserId:t,userIds:i})=>{const{closeGiftRecipientPicker:s,openGiftModal:l}=(0,n.ko)(),c=(0,m.A)(),d=e,[f,p]=(0,a.J0)(""),h=(0,a.Kr)(()=>{const e=(0,n.mS)(),a=i?i.concat(t):void 0,s=a?(0,r.PU)({ids:a,query:f}):[];return(0,y.A)((0,I.Am)(s).filter(t=>(0,o.X2D)(e,t)),void 0,[t])},[t,f,i]),A=(0,u.A)(e=>{l({forUserId:e}),s()});return(0,N.Y)(Y.A,{className:"W3JMs1YE",isOpen:d,onClose:s,title:c("GiftTelegramPremiumOrStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,children:(0,N.Y)(k.A,{className:"wOipz1Y_",itemIds:h,filterValue:f,filterPlaceholder:c("Search"),onSelectedIdChange:A,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,forceShowSelf:!0})})}));var ai=i(79089),ni=i(18501);function ri({originalDetails:e,recipient:t,sender:i,onOpenChat:a,lang:n}){const{recipientId:o,senderId:s,date:l,message:c}=e,d=(0,z.L2)(1e3*l,n.code,!0),u=(0,N.Y)(vt.A,{onClick:()=>a(o),isPrimary:!0,children:(0,r.F9)(n,t)});if(!i||s===o)return c?n("GiftInfoPeerOriginalInfoText",{peer:u,text:(0,ni.fd)(c),date:d},{withNodes:!0}):n("GiftInfoPeerOriginalInfo",{peer:u,date:d},{withNodes:!0});const m=(0,N.Y)(vt.A,{onClick:()=>a(i.id),isPrimary:!0,children:(0,r.F9)(n,i)});return c?n("GiftInfoPeerOriginalInfoTextSender",{peer:u,sender:m,text:(0,ni.fd)(c),date:d},{withNodes:!0}):n("GiftInfoPeerOriginalInfoSender",{peer:u,date:d,sender:m},{withNodes:!0})}var oi=i(25404);const si={root:"Ef0cKSqQ",giftPreview:"IvuNzslN",backdrop:"dNukis4X",arrow:"oufsMLLF"},li=4*w.$,ci=3*w.$,di=(0,a.ph)(({peer:e,gift:t})=>{const i=(0,a.Kr)(()=>(0,X.uc)(t),[t]);if(i)return(0,N.FD)("div",{className:si.root,children:[(0,N.FD)("div",{className:si.giftPreview,children:[(0,N.Y)(te.A,{className:si.backdrop,backgroundColors:[i.backdrop.centerColor,i.backdrop.edgeColor],patternIcon:i.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,N.Y)(ee.A,{className:si.sticker,size:ci,sticker:i.model?.sticker})]}),(0,N.Y)(F.A,{name:"next",className:si.arrow}),(0,N.Y)(f.A,{peer:e,size:li,className:si.avatar})]})});var ui=i(94189);const mi={modal:"nnublcCk",checkBox:"fjE0wGvw",checkBoxDescription:"tepUTe4z",upgradeIcon:"lgyInH5K",descriptionConfirm:"BJh2Tufh",titleConfirm:"gA102W1G",header:"p7FTs7_p",title:"pIbzzTir",description:"CCPfr26t",warningDescription:"eEsRJVa1",modalContent:"o9rFZ6By",moreMenuButton:"EMwExRMy",closeButton:"jQv0ZSEW",giftResalePriceContainer:"BN8gf5y6",starAmountIcon:"_5guecUe",giftResalePriceStar:"H_q8o2vY",headerButton:"WA0INleU",left:"aOhTHZlf",right:"rJOB1u5Q",footer:"bho0GTYt",footerDescription:"VUylTszM",footerHint:"mxS8kDnA",buyButton:"i1MmnrPG",unknown:"zDauXmpS",giftValue:"w_E4LkUj",uniqueValue:"uAjIRJva",uniqueAttribute:"OJQnkf17",attributeName:"dq7wCHJb",uniqueGift:"I6o_pGAm",modalHeader:"ie9tImaj",modalCloseButton:"p38RBGdC",ownerAddress:"DavMRg4Q",copyIcon:"SLX5tX8C",messageContainer:"oW5T3mkV",removeMessageButton:"TrW2LVm5"},fi=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.gift,a=i&&"gift"in i,n=e.currentUserId,s=a&&i.fromId,l=s?(0,o.PVB)(e,s):void 0,c=t?.peerId?(0,o.PVB)(e,t.peerId):void 0,d=c&&(0,r.vj)(c)?c:void 0,u=d&&(0,C.ub)(d,"postMessages"),m=(0,o.mBe)(e,n),f=t?.recipientId&&n!==t.recipientId?(0,o.PVB)(e,t.recipientId):void 0,p=m?.emojiStatus,h=e.collectibleEmojiStatuses?.statuses,A=a?i.gift:i,g="starGiftUnique"===A?.type&&A.releasedByPeerId;return{fromPeer:l,targetPeer:c,releasedByPeer:g?(0,o.PVB)(e,g):void 0,currentUserId:n,starGiftMaxConvertPeriod:e.appConfig.starGiftMaxConvertPeriod,tonExplorerUrl:e.appConfig.tonExplorerUrl,hasAdminRights:u,currentUserEmojiStatus:p,collectibleEmojiStatuses:h,currentUser:m,recipientPeer:f}})(({modal:e,fromPeer:t,targetPeer:i,releasedByPeer:c,currentUserId:h,starGiftMaxConvertPeriod:A,hasAdminRights:g,currentUserEmojiStatus:b,collectibleEmojiStatuses:v,tonExplorerUrl:S,currentUser:C,recipientPeer:I})=>{const{closeGiftInfoModal:y,changeGiftVisibility:k,convertGiftToStars:Y,openChatWithInfo:B,focusMessage:D,openGiftUpgradeModal:P,showNotification:w,buyStarGift:R,closeGiftModal:x,openGiftInfoValueModal:L,updateResaleGiftsFilter:K,openGiftInMarket:O,openGiftDescriptionRemoveModal:E}=(0,n.ko)(),[q,H,W]=(0,T.A)(),j=(0,M.A)(),_=(0,m.A)(),[$,Z]=(0,a.J0)(!1),[te,ie]=(0,a.J0)(!1),ae=(0,a.li)(),ne=(0,u.A)(()=>{ve&&Xe?.pattern&&(O({gift:ve}),K({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[],patternAttributes:[{type:"pattern",documentId:Xe.pattern.sticker.id}]}}))}),re=(0,u.A)(()=>{ve&&Xe?.backdrop&&(O({gift:ve}),K({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[{type:"backdrop",backdropId:Xe.backdrop.backdropId}],patternAttributes:[]}}))}),oe=(0,u.A)(()=>{ve&&Xe?.model&&(O({gift:ve}),K({filter:{sortType:"byDate",modelAttributes:[{type:"model",documentId:Xe.model.sticker.id}],backdropAttributes:[],patternAttributes:[]}}))}),se=Boolean(e),le=(0,d.A)(e),ce=(0,d.A)(t),de=(0,d.A)(i),ue=de&&(0,r.vj)(de),{gift:me}=le||{},fe=me&&"gift"in me,he=fe?me:void 0,Ae=he?.fromId===h,ge=he&&A&&he.date+A-(0,Ye.Fm)()||0,be=Math.ceil(ge/60/60/24),ve=fe?me.gift:me,Se=ve&&(0,X.yQ)(ve),Ce=ge>0&&Boolean(he?.starsToConvert),Ie=ve&&"starGiftUnique"===ve.type,ye=Ie?ve:void 0,ke=(0,a.Kr)(()=>{if(ve&&"starGiftUnique"===ve.type){if(c){const e=`@${(0,ai.Kl)(c)}`||(0,r.F9)(j,c),t=(0,r.mO)(c)?j("ActionFallbackUser"):j("ActionFallbackChannel");return j("GiftInfoCollectibleBy",{number:ve.number,owner:e||t},{withNodes:!0,withMarkdown:!0})}return j("GiftInfoCollectible",{number:ve.number})}},[ve,c,j]),Be="starGiftUnique"===ve?.type?ve.slug:void 0,De=(0,a.Kr)(()=>{if(Be)return v?.find(e=>"collectible"===e.type&&e.slug===Be)},[Be,v]),Pe=Boolean(De),we=Boolean(he?.upgradeMsgId),Te=!we&&he?.inputGift&&(ue?g:"starGift"===ve?.type?de?.id===h:ve?.ownerId===h||Pe);function Fe(e){if(!Ie)return;const t=ve.resellPrice;return t?ve?.resaleTonOnly||e?t.find(e=>e.currency===G.ykW):t.find(e=>e.currency===G.OUy):void 0}const Ue=Fe(),Re=Fe(te),xe=Ue?.currency===G.ykW&&Ie?ve.resellPrice?.find(e=>e.currency===G.OUy):void 0,Le=!Pe&&"starGiftUnique"===ve?.type&&ve.ownerId!==h&&Boolean(Ue),Ke=(()=>{if(!Ie)return;const{ownerName:e,ownerId:t}=ve,i=(0,n.mS)(),a=t?(0,o.PVB)(i,t):void 0;return a?(0,r.F9)(j,a):e})(),Oe=(0,u.A)(()=>{y()}),Ve=(0,u.A)(()=>{const e=Ae?de:ce;if(!he?.upgradeMsgId||!e)return;const{upgradeMsgId:t}=he;D({chatId:e.id,messageId:t}),Oe()}),Ee=(0,u.A)(()=>{const{inputGift:e,isUnsaved:t}=he;k({gift:e,shouldUnsave:!t}),Oe()}),He=(0,u.A)(()=>{const{inputGift:e}=he;Y({gift:e}),W(),Oe()}),ze=(0,u.A)(()=>{if(!(he?.inputGift&&he.dropOriginalDetailsStars&&ve&&Xe))return;const{originalDetails:e}=Xe;e&&E({gift:he,price:he.dropOriginalDetailsStars,details:e})}),Je=(0,u.A)(()=>{if(!he)return;const e=de?.id;P({giftId:he.gift.id,gift:he,peerId:e})}),We=(0,u.A)(()=>{"starGiftUnique"===ve?.type&&Fe()&&Z(!0)}),je=(0,u.A)(()=>{Z(!1)}),_e=(0,u.A)(()=>{const e=I||C,t=Fe(te);e&&t&&"starGiftUnique"===ve?.type&&(je(),x(),R({peerId:e.id,slug:ve.slug,price:t}))}),Qe=(0,u.A)(()=>{ve&&"starGiftUnique"===ve.type&&L({gift:ve})}),Xe=(0,a.Kr)(()=>ve&&(0,X.uc)(ve),[ve]),$e=(0,u.A)(()=>Le?(0,N.FD)(U.A,{className:mi.buyButton,onClick:We,children:[(0,N.Y)("div",{children:j("ButtonBuyGift",{stars:Ue?.currency===G.ykW?(0,pe.Ms)(j,Ue.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ue?.amount,{asFont:!0})},{withNodes:!0})}),Ue?.currency===G.ykW&&Boolean(xe)&&(0,N.Y)("div",{className:mi.footerHint,children:j("GiftBuyEqualsTo",{stars:(0,pe.U2)(j,xe.amount,{asFont:!0})},{withNodes:!0})})]}):we?(0,N.Y)(U.A,{onClick:Ve,children:j("GiftInfoViewUpgraded")}):Te&&he?.alreadyPaidUpgradeStars&&!he.upgradeMsgId?(0,N.Y)(U.A,{isShiny:!0,onClick:Je,iconName:"arrow-down-circle",iconClassName:mi.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgradeForFree")}):Te&&he?.canUpgrade&&!he.upgradeMsgId?(0,N.Y)(U.A,{isShiny:!0,onClick:Je,iconName:"arrow-down-circle",iconClassName:mi.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgrade")}):he?.prepaidUpgradeHash?(0,N.Y)(U.A,{isShiny:!0,onClick:Je,iconName:"arrow-down-circle",iconClassName:mi.upgradeIcon,iconAlignment:"end",children:j("GiftAnUpgradeButton")}):(0,N.Y)(U.A,{onClick:Oe,children:j("OK")})),Ze=(0,a.Kr)(()=>{if(!ve)return;let e="";return"starGift"===ve.type&&(ve.firstSaleDate&&(e+=`${j("GiftInfoFirstSale")} ${(0,z.L2)(1e3*ve.firstSaleDate,j.code,!0)}`),ve.lastSaleDate&&(e+="\n",e+=`${j("GiftInfoLastSale")} ${(0,z.L2)(1e3*ve.lastSaleDate,j.code,!0)}`)),e},[ve,j]),et=(0,a.Kr)(()=>{if(!me||!ve)return;const{fromId:e,isNameHidden:t,starsToConvert:i,isUnsaved:a,isConverted:d,upgradeMsgId:u}=he||{},m=Ce&&Boolean(i),h=t&&de,A=he?.isRefunded||!he&&"starGift"===ve?.type,g=(()=>{if(!he)return j("GiftInfoSoldOutDescription");if(!ue){if(he.isRefunded)return j("GiftInfoDescriptionRefunded");if(he.upgradeMsgId)return j("GiftInfoDescriptionUpgraded");if(Te&&he.canUpgrade&&he.alreadyPaidUpgradeStars&&!he.upgradeMsgId)return j("GiftInfoDescriptionUpgrade2");if(he.canUpgrade&&Te)return Te?j("GiftInfoDescriptionFreeUpgrade"):j("GiftInfoPeerDescriptionFreeUpgradeOut",{peer:(0,r.F9)(j,de)});if(Te||Ae)return d&&m?Te?j("GiftInfoDescriptionConverted",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoPeerDescriptionOutConverted",{amount:i,peer:(0,r.F9)(j,de)},{pluralValue:i,withNodes:!0,withMarkdown:!0}):he.canUpgrade&&Te?m?j("GiftInfoDescriptionUpgrade",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoDescriptionUpgradeRegular"):Te?m?j("GiftInfoDescription",{amount:i},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoDescriptionRegular"):m?j("GiftInfoPeerDescriptionOut",{amount:i,peer:(0,r.F9)(j,de)},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoPeerDescriptionOutRegular",{peer:(0,r.F9)(j,de)})}})(),b=(0,N.FD)("div",{className:mi.modalHeader,children:[(0,N.Y)(U.A,{className:mi.closeButton,round:!0,color:"translucent-white",size:"tiny",iconName:"close",ariaLabel:j("Close"),onClick:Oe}),Boolean(Ue?.amount)&&(0,N.Y)("div",{className:mi.giftResalePriceContainer,children:Ue.currency===G.ykW?(0,pe.Ms)(j,Ue.amount,{className:mi.giftResalePriceStar,shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ue.amount,{asFont:!0,className:mi.giftResalePriceStar})})]}),v=Ie&&(0,N.Y)("div",{ref:ae,className:(0,s.A)(mi.header,mi.uniqueGift),children:(0,N.Y)(Me,{backdropAttribute:Xe.backdrop,patternAttribute:Xe.pattern,modelAttribute:Xe.model,title:ve.title,subtitle:ke,subtitlePeer:c,showManageButtons:Te,savedGift:he})}),C=(0,N.FD)("div",{className:mi.header,children:[(0,N.Y)(ee.A,{className:mi.giftSticker,sticker:Se,size:120}),(0,N.Y)("h1",{className:mi.title,children:Ie?ve.title:j(he?Te?"GiftInfoReceived":"GiftInfoTitle":"GiftInfoSoldOutTitle")}),Boolean(g)&&(0,N.Y)("p",{className:(0,s.A)(mi.description,A&&mi.warningDescription),children:g})]}),I=[];if("starGift"===ve.type){(e||t)&&I.push([j("GiftInfoFrom"),e?{chatId:e}:(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:"small",peer:Q.I5}),(0,N.Y)("span",{className:mi.unknown,children:_(Q.I5.titleKey)})]})]),he?.date&&I.push([j("GiftInfoDate"),(0,N.Y)("span",{title:Ze,children:(0,z.L2)(1e3*he.date,j.code,!0)})]),ve.firstSaleDate&&!he&&I.push([j("GiftInfoFirstSale"),(0,z.L2)(1e3*ve.firstSaleDate,j.code,!0)]),ve.lastSaleDate&&!he&&I.push([j("GiftInfoLastSale"),(0,z.L2)(1e3*ve.lastSaleDate,j.code,!0)]);const a=ve.stars+(he?.alreadyPaidUpgradeStars||0);I.push([j("GiftInfoValue"),(0,N.FD)("div",{className:mi.giftValue,children:[(0,pe.U2)(j,a,{className:mi.starAmountIcon}),Te&&Ce&&Boolean(i)&&(0,N.Y)(V.A,{onClick:H,children:j("GiftInfoConvert",{amount:i},{pluralValue:i})})]})]),ve.availabilityTotal&&I.push([j("GiftInfoAvailability"),j("GiftInfoAvailabilityValue",{count:ve.availabilityRemains||0,total:ve.availabilityTotal},{pluralValue:ve.availabilityRemains||0})]),ve.upgradeStars&&!u&&I.push([j("GiftInfoStatus"),(0,N.Y)("div",{className:mi.giftValue,children:j("GiftInfoStatusNonUnique")})]),he?.message&&I.push([void 0,(0,ni.fd)(he.message)])}if(Ie){const{ownerName:e,ownerAddress:t,ownerId:i}=ve,a=i?(0,o.PVB)((0,n.mS)(),i):void 0,{model:r,backdrop:s,pattern:c,originalDetails:d}=Xe||{};if(t?I.push([j("GiftInfoOwner"),(0,N.FD)("span",{className:mi.ownerAddress,onClick:()=>{(0,Ne.eM)(t),w({message:{key:"WalletAddressCopied"},icon:"copy"})},children:[t,(0,N.Y)(F.A,{className:mi.copyIcon,name:"copy"})]})]):(a||e)&&I.push([j("GiftInfoOwner"),i?{chatId:i,withEmojiStatus:!0}:e||""]),r&&I.push([j("GiftAttributeModel"),(0,N.FD)("span",{className:mi.uniqueAttribute,children:[(0,N.Y)("span",{className:mi.attributeName,onClick:oe,children:r.name}),(0,N.Y)(V.A,{children:(0,J.l9)(r.rarityPercent)})]})]),s&&I.push([j("GiftAttributeBackdrop"),(0,N.FD)("span",{className:mi.uniqueAttribute,children:[(0,N.Y)("span",{className:mi.attributeName,onClick:re,children:s.name}),(0,N.Y)(V.A,{children:(0,J.l9)(s.rarityPercent)})]})]),c&&I.push([j("GiftAttributeSymbol"),(0,N.FD)("span",{className:mi.uniqueAttribute,children:[(0,N.Y)("span",{className:mi.attributeName,onClick:ne,children:c.name}),(0,N.Y)(V.A,{children:(0,J.l9)(c.rarityPercent)})]})]),I.push([j("GiftInfoAvailability"),j("GiftInfoIssued",{issued:ve.issuedCount,total:ve.totalCount})]),ve.valueAmount&&ve.valueCurrency&&I.push([j("GiftInfoValue"),(0,N.FD)("span",{className:mi.uniqueValue,children:["~"," ",(0,l.Ad)(ve.valueAmount,ve.valueCurrency,j.code),(0,N.Y)(V.A,{onClick:Qe,children:j("GiftInfoValueLinkMore")})]})]),d){const{recipientId:e,senderId:t}=d,i=(0,n.mS)(),a=e=>{B({id:e}),y()},r=ri({originalDetails:d,recipient:(0,o.PVB)(i,e),sender:t?(0,o.PVB)(i,t):void 0,onOpenChat:a,lang:j});I.push([void 0,(0,N.FD)("div",{className:mi.messageContainer,children:[(0,N.Y)("div",{children:r}),Boolean(he?.dropOriginalDetailsStars)&&(0,N.Y)(U.A,{round:!0,className:mi.removeMessageButton,size:"smaller",color:"translucent",ariaLabel:"Delete original details",onClick:ze,iconName:"delete"})]})])}}const k=S&&Ie&&ve.giftAddress&&`${S}${ve.giftAddress}`,Y=(0,N.FD)("div",{className:mi.footer,children:[(Te||k||Le)&&(0,N.FD)("div",{className:mi.footerDescription,children:[k&&(0,N.Y)("div",{children:j("GiftInfoTonText",{link:(0,N.Y)(p.A,{url:k,shouldSkipModal:!0,text:j("GiftInfoTonLinkText")})},{withNodes:!0})}),Te&&(0,N.Y)("div",{children:j(`GiftInfo${ue?"Channel":""}${a?"Hidden":"Saved"}`,{link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:Ee,children:j("GiftInfoSaved"+(a?"Show":"Hide"))})},{withNodes:!0})}),!Le&&h&&(0,N.Y)("div",{children:j("GiftInfoSenderHidden")}),Le&&Ke&&(0,N.Y)("div",{children:j("GiftInfoBuyGift",{user:Ke},{withNodes:!0})})]}),$e()]});return{modalHeader:Ie?b:void 0,header:Ie?v:C,tableData:I,footer:Y}},[me,he,de,Se,j,Te,Ce,Ae,_,S,ve,Xe,$e,ue,Ie,Ze,Le,Ke,Ue,ke,c,ne,re,oe]),tt=me&&(0,N.Y)(oi.A,{peerId:le.peerId,gift:me,canManage:Te,collectibleEmojiStatuses:v,currentUserEmojiStatus:b});return(0,N.FD)(N.FK,{children:[(0,N.Y)(Ge.A,{isOpen:se,modalHeader:et?.modalHeader,header:et?.header,hasBackdrop:Ie,tableData:et?.tableData,footer:et?.footer,className:mi.modal,contentClassName:mi.modalContent,closeButtonColor:Ie?"translucent-white":void 0,moreMenuItems:tt,onClose:Oe,withBalanceBar:Boolean(Le),currencyInBalanceBar:Re?.currency,isLowStackPriority:!0}),ye&&C&&Boolean(Re)&&(0,N.FD)(ui.A,{isOpen:$,noDefaultTitle:!0,onClose:je,confirmLabel:j("ButtonBuyGift",{stars:Re?.currency===G.ykW?(0,pe.Ms)(j,Re.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,Re.amount,{asFont:!0})},{withNodes:!0}),confirmHandler:_e,children:[ye.resaleTonOnly&&(0,N.Y)("div",{className:mi.descriptionConfirm,children:j("ConfirmBuyGiftForTonDescription")}),(0,N.Y)(di,{peer:I||C,gift:ye}),(0,N.Y)("div",{className:mi.titleConfirm,children:j("TitleConfirmPayment")}),!I&&(0,N.Y)("p",{children:j("GiftBuyConfirmDescription",{gift:j("GiftUnique",{title:ye.title,number:ye.number}),stars:Re?.currency===G.ykW?(0,pe.QH)(j,Re.amount,!0):(0,pe.Kk)(j,Re.amount)},{withNodes:!0,withMarkdown:!0})}),I&&(0,N.Y)("p",{children:j("GiftBuyForPeerConfirmDescription",{gift:j("GiftUnique",{title:ye.title,number:ye.number}),stars:Re?.currency===G.ykW?(0,pe.QH)(j,Re.amount,!0):(0,pe.Kk)(j,Re.amount),peer:(0,r.F9)(j,I)},{withNodes:!0,withMarkdown:!0})}),!ye.resaleTonOnly&&(0,N.FD)(N.FK,{children:[(0,N.Y)(qe.A,{className:mi.checkBox,label:j("LabelPayInTON"),checked:te,onCheck:ie}),(0,N.Y)("div",{className:mi.checkBoxDescription,children:j("DescriptionPayInTON")})]})]}),he&&(0,N.FD)(ui.A,{isOpen:q,onClose:W,confirmHandler:He,title:j("GiftInfoConvertTitle"),children:[(0,N.Y)("div",{children:j("GiftInfoPeerConvertDescription",{amount:(0,pe.Kk)(j,he.starsToConvert),peer:(0,r.F9)(j,ce)},{withNodes:!0,withMarkdown:!0})}),Ce&&(0,N.Y)("div",{children:j("GiftInfoConvertDescriptionPeriod",{count:be},{withNodes:!0,withMarkdown:!0,pluralValue:be})}),(0,N.Y)("div",{children:j("GiftInfoConvertDescription2")})]})]})})),pi="hspYTy7V",hi=(0,a.ph)(({modal:e})=>{const{closeGiftInfoValueModal:t,openUrl:i,openGiftInMarket:r}=(0,n.ko)(),o=(0,M.A)(),s=Boolean(e),c=(0,d.A)(e),m=(0,u.A)(()=>{e?.valueInfo.fragmentListedUrl&&i({url:e.valueInfo.fragmentListedUrl})}),f=(0,u.A)(()=>{e?.gift&&r({gift:e.gift})}),p=(0,a.Kr)(()=>{if(!c)return;const{gift:e,valueInfo:t}=c,i=(0,X.uc)(e);if(!i)return;const a=(0,N.FD)("div",{className:"v4GJBsdC",children:[(0,N.Y)(ee.A,{className:"lJodRD0R",sticker:i.model.sticker,size:120}),(0,N.Y)(U.A,{pill:!0,size:"tiny",fluid:!0,nonInteractive:!0,children:(0,l.Ad)(t.value,t.currency,o.code)}),(0,N.Y)("div",{className:"VjWaO8un",children:o("GiftValueDescription",{giftName:e.title},{withMarkdown:!0,withNodes:!0})})]}),n=[];n.push([o("GiftValueTitleInitialSale"),(0,z.A)(1e3*t.initialSaleDate,o.code)]),n.push([o("GiftValueTitleInitialPrice"),(0,N.FD)("span",{className:"K7zsAhVt",children:[(0,pe.U2)(o,t.initialSaleStars,{className:"Xw91xwpe"})," (~ ",(0,l.Ad)(t.initialSalePrice,t.currency,o.code),")"]})]),t.lastSaleDate&&n.push([o("GiftValueTitleLastSale"),(0,z.A)(1e3*t.lastSaleDate,o.code)]),t.lastSalePrice&&n.push([o("GiftValueTitleLastPrice"),(0,l.Ad)(t.lastSalePrice,t.currency,o.code)]),t.floorPrice&&n.push([o("GiftValueTitleMinimumPrice"),(0,l.Ad)(t.floorPrice,t.currency,o.code)]),t.averagePrice&&n.push([o("GiftValueTitleAveragePrice"),(0,l.Ad)(t.averagePrice,t.currency,o.code)]);const r=Boolean(t.fragmentListedUrl&&t.fragmentListedCount),s=Boolean(t.listedCount&&t.listedCount);return{header:a,tableData:n,footer:(r||s)&&(0,N.FD)("div",{className:"OJDo2xUd",children:[r&&(0,N.FD)(U.A,{isText:!0,onClick:m,noForcedUpperCase:!0,size:"tiny",children:[o.number(t.fragmentListedCount),(0,N.Y)(ee.A,{className:pi,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnFragment")]}),s&&(0,N.FD)(U.A,{isText:!0,noForcedUpperCase:!0,size:"tiny",onClick:f,children:[o.number(t.listedCount),(0,N.Y)(ee.A,{className:pi,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnTelegram")]})]})}},[o,c,m,f]);if(p)return(0,N.Y)(Ge.A,{isOpen:s,onClose:t,header:p.header,tableData:p.tableData,footer:p.footer})}),Ai=(0,a.ph)(({modal:e})=>{const{closeLockedGiftModal:t}=(0,n.ko)(),i=(0,M.A)(),r=(0,u.A)(()=>{t()}),o=(0,a.hb)(()=>{if(!e)return"";if(e.untilDate){const t=e.untilDate?e.untilDate-(0,Ye.Fm)():0;return i("GiftLockedMessage",{relativeDate:(0,z.A$)(i,t)},{withNodes:!0,withMarkdown:!0})}return e.reason?(0,ni.fd)(e.reason):i("TitleGiftLocked")},[e,i]);return(0,N.FD)(h.A,{isOpen:Boolean(e),className:"narrow",onClose:r,title:i("TitleGiftLocked"),headerClassName:"AqB1qB8W",children:[(0,N.Y)("p",{className:"pA8Bz4TW",children:o()}),(0,N.Y)(U.A,{onClick:r,children:i("OK")})]})});var gi=i(40664);const bi=(0,a.ph)((0,n.EK)(e=>{const t=e.appConfig.starsStargiftResaleCommissionPermille,i=t?t/1e3:void 0,a=e.appConfig.starsStargiftResaleAmountMin||0,n=e.appConfig.starsStargiftResaleAmountMax,r=e.appConfig.starsUsdWithdrawRateX1000,o=r?r/1e3:1,s=e.appConfig.tonStargiftResaleCommissionPermille,c=s?s/1e3:0,d=(0,l.wD)(e.appConfig.tonStargiftResaleAmountMin||0),u=e.appConfig.tonStargiftResaleAmountMax;return{starsStargiftResaleCommissionPermille:i,starsStargiftResaleAmountMin:a,starsStargiftResaleAmountMax:n,starsUsdWithdrawRate:o,tonStargiftResaleCommissionPermille:c,tonStargiftResaleAmountMin:d,tonStargiftResaleAmountMax:u&&(0,l.wD)(u),tonUsdRate:e.appConfig.tonUsdRate}})(({modal:e,starsStargiftResaleCommissionPermille:t,starsStargiftResaleAmountMin:i,starsStargiftResaleAmountMax:r,starsUsdWithdrawRate:o,tonStargiftResaleCommissionPermille:s,tonStargiftResaleAmountMin:c,tonStargiftResaleAmountMax:m,tonUsdRate:f})=>{const{closeGiftResalePriceComposerModal:p,closeGiftInfoModal:A,updateStarGiftPrice:g,showNotification:b}=(0,n.ko)(),v=Boolean(e),[S,G]=(0,a.J0)(void 0),[C,I]=(0,a.J0)(!1),y=(0,d.A)(e),{gift:k}=y||{},Y=k&&"gift"in k?k:void 0,B=Boolean(S),D=(0,M.A)(),P=(0,u.A)(e=>{const t=e.target.value,i=parseFloat(t),a=C?m:r,n=""===t||Number.isNaN(i)?void 0:a?Math.min(i,a):i;G(n)}),w=(0,u.A)(()=>{p()}),T=(0,u.A)(()=>{Y&&"starGiftUnique"===Y.gift.type&&Y.inputGift&&S&&(p(),A(),g({gift:Y.inputGift,price:{currency:C?"TON":"XTR",amount:C?(0,l.tT)(S):S,nanos:0}}),b({icon:"sell-outline",message:{key:"NotificationGiftIsSale",variables:{gift:D("GiftUnique",{title:Y.gift.title,number:Y.gift.number})}}}))}),F=C?s:t,R=C?c:i,x=B&&S>=R;return(0,N.FD)(h.A,{isOpen:v,title:D(C?"PriceInTON":"PriceInStars"),hasCloseButton:!0,isSlim:!0,onClose:w,children:[(0,N.Y)("div",{className:"ElDo1Bru",children:(0,N.Y)(gi.A,{label:D(C?"EnterPriceInTon":"EnterPriceInStars"),onChange:P,value:S?.toString(),inputMode:"numeric",tabIndex:0,teactExperimentControlled:!C})}),(0,N.FD)("div",{className:"SGFmA4kL",children:[(0,N.FD)("span",{children:[!x&&Boolean(F)&&D("DescriptionComposerGiftMinimumPrice",{stars:C?(0,pe.QH)(D,R):(0,pe.Kk)(D,R)},{withMarkdown:!0,withNodes:!0}),x&&(()=>{const e=F?Number((S*F).toFixed()):S;return D("DescriptionComposerGiftResalePrice",{stars:C?(0,pe.QH)(D,e):(0,pe.Kk)(D,e)},{withMarkdown:!0,withNodes:!0})})()]}),x&&Boolean(C?f:o)&&(0,N.Y)("span",{className:"r9R0VR_w",children:`≈ ${(0,l.Ad)(C?(0,l.C)(S,f):S*o,"USD",D.code)}`})]}),(0,N.Y)(qe.A,{className:"yt_nODdj",label:D("OnlyAcceptTON"),checked:C,onCheck:I}),(0,N.Y)("div",{className:"pWjQiY4m",children:D("OnlyAcceptTONDescription")}),(0,N.FD)(U.A,{noForcedUpperCase:!0,disabled:!x,onClick:T,children:[x&&D("ButtonSellGift",{stars:C?(0,pe.Ms)(D,S):(0,pe.U2)(D,S,{asFont:!0})},{withNodes:!0}),!x&&D("Sell")]})]})}));var vi=i(32625),Ni=i(5463);const Si={footer:"EWaVCxY4",footerButton:"_Dt6RSQV",link:"Xu0TqkRj",priceDecreaseTimer:"ryB8xKvy"},Gi=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.recipientId;return{recipient:i?(0,o.PVB)(e,i):void 0}})(({modal:e,recipient:t})=>{const{closeGiftUpgradeModal:i,closeGiftInfoModal:o,upgradeGift:s,upgradePrepaidGift:l,openStarGiftPriceDecreaseInfoModal:c,shiftGiftUpgradeNextPrice:m}=(0,n.ko)(),f=Boolean(e),p=(0,d.A)(e),h=(0,d.A)(t),[A,g]=(0,a.J0)(!1),b=Boolean(p?.gift?.prepaidUpgradeHash),[v,S]=(0,a.J0)(),G=(0,M.A)(),C=(0,u.A)(()=>i()),I=(0,u.A)(()=>{m()}),y=p?.nextPrices?.[0],k=y?.date,Y=p?.currentUpgradeStars,B=(0,u.A)(()=>{const e=p?.gift;if(e){if(b&&e.prepaidUpgradeHash&&h){if(!Y)return;return l({peerId:h.id,hash:e.prepaidUpgradeHash,stars:Y}),C(),void o()}e?.inputGift&&(s({gift:e.inputGift,shouldKeepOriginalDetails:A,upgradeStars:e.alreadyPaidUpgradeStars?void 0:Y}),C())}}),D=(0,u.A)(()=>{p?.sampleAttributes&&S((0,X.HM)(p.sampleAttributes,v))}),P=(0,u.A)(()=>{p?.prices&&c({prices:p.prices,currentPrice:Y||0,minPrice:p.minPrice||0,maxPrice:p.maxPrice||0})});(0,vi.A)(D,f?3e3:void 0,!0),(0,a.vJ)(()=>{f&&p?.sampleAttributes&&D()},[f,p?.sampleAttributes]),(0,a.vJ)(()=>{const e=p?.sampleAttributes;e&&(0,X.y8)(e)},[p?.sampleAttributes]);const w=(0,a.Kr)(()=>Y?(0,N.FD)("span",{children:[(0,N.Y)(F.A,{name:"star",className:"star-amount-icon"}),(0,N.Y)(je.A,{text:G.number(Y)})]}):void 0,[G,Y]),T=(0,a.Kr)(()=>{if(!v||!f)return;const e=p?.gift,t=h?(0,r.F9)(G,h):G("ActionFallbackUser"),i=h?[["diamond",G("GiftUpgradeUniqueTitle"),G("GiftPeerUpgradeUniqueDescription",{user:t})],["trade",G("GiftUpgradeTransferableTitle"),G("GiftPeerUpgradeTransferableDescription",{user:t})],["auction",G("GiftUpgradeTradeableTitle"),G("GiftPeerUpgradeTradeableDescription",{user:t})]]:[["diamond",G("GiftUpgradeUniqueTitle"),G("GiftUpgradeUniqueDescription")],["trade",G("GiftUpgradeTransferableTitle"),G("GiftUpgradeTransferableDescription")],["auction",G("GiftUpgradeTradeableTitle"),G("GiftUpgradeTradeableDescription")]],a=h?G("GiftPeerUpgradeText",{peer:(0,r.F9)(G,h)}):G("GiftUpgradeTextOwn"),n=Boolean(k)&&Boolean(p?.prices?.length)&&!e?.alreadyPaidUpgradeStars;return{listItemData:i,header:(0,N.Y)(Me,{modelAttribute:v.model,backdropAttribute:v.backdrop,patternAttribute:v.pattern,title:G("GiftUpgradeTitle"),subtitle:a}),footer:(0,N.FD)("div",{className:Si.footer,children:[!e&&(0,N.Y)(U.A,{className:Si.footerButton,onClick:C,children:G("OK")}),e&&(0,N.FD)(N.FK,{children:[!b&&(0,N.Y)(qe.A,{label:G("GiftUpgradeKeepDetails"),onCheck:g,checked:A}),(0,N.Y)(U.A,{className:Si.footerButton,isShiny:!0,onClick:B,children:(0,N.FD)("div",{className:Si.buttonContent,children:[(0,N.Y)("div",{children:e.alreadyPaidUpgradeStars?G("GeneralConfirm"):G(b?"GiftPayForUpgradeButton":"GiftUpgradeButton",{amount:w},{withNodes:!0})}),n&&(0,N.Y)("div",{className:Si.priceDecreaseTimer,children:G("StarGiftPriceDecreaseTimer",{timer:(0,N.Y)(Ct.A,{endsAt:k,onEnd:I})},{withNodes:!0})})]})}),n&&(0,N.Y)(vt.A,{className:Si.link,isPrimary:!0,onClick:P,children:G("StarGiftPriceDecreaseInfoLink")})]})]})}},[v,f,G,h,p?.gift,A,b,p?.prices?.length,k,w]);return(0,N.Y)(Ni.A,{isOpen:f,header:T?.header,footer:T?.footer,listItemData:T?.listItemData,hasBackdrop:!0,onClose:C})})),Ci="GwhTY_Uw",Ii="H4JSQGvw",yi=48*ht.dp,ki=(0,a.ph)((0,n.EK)(e=>{const{giftAuctionModal:t}=(0,o.nTw)(e),i=t?.auctionGiftId;return{auctionState:i?e.giftAuctionByGiftId?.[i]:void 0}})(({modal:e,auctionState:t})=>{const{closeGiftAuctionModal:i,setGiftModalSelectedGift:r,openGiftAuctionInfoModal:o,openGiftAuctionAcquiredModal:s,openAboutStarGiftModal:l,showNotification:c,openChatWithDraft:m,openUrl:f,openGiftInMarket:p}=(0,n.ko)(),h=Boolean(e),A=(0,d.A)(e),g=(0,d.A)(t),b=g?.gift,v=g?.state,S=g?.userState,C="finished"===v?.type,[I,y]=(0,a.J0)(),k=Boolean(b&&v&&I),Y=(0,a.li)(),B=(0,M.A)(),D=(0,u.A)(()=>{A?.sampleAttributes&&y((0,X.HM)(A.sampleAttributes,I))});(0,vi.A)(D,h?3e3:void 0,!0),(0,a.vJ)(()=>{h&&(A?.sampleAttributes?D():y(void 0))},[h,A?.sampleAttributes]),(0,a.vJ)(()=>{const e=A?.sampleAttributes;e&&(0,X.y8)(e)},[A?.sampleAttributes]);const P=(0,u.A)(()=>i()),w=(0,u.A)(()=>{b&&o({auctionGiftId:b.id})}),T=(0,u.A)(()=>{l({})}),F=(0,u.A)(()=>{if(!b)return;const e=(0,X.yQ)(b);s({giftId:b.id,giftTitle:b.title,giftSticker:e})}),R=(0,u.A)(()=>{b&&(i({shouldKeepAuction:!0}),r({gift:b}))}),x=(0,a.Kr)(()=>{if(b?.auctionSlug)return`${G.jsp}auction/${b.auctionSlug}`},[b]),L=(0,u.A)(()=>{x&&((0,Ne.eM)(x),c({message:B("LinkCopied")}))}),K=(0,u.A)(()=>{x&&m({text:{text:x}})}),O=(0,u.A)(()=>{"finished"===v?.type&&v.fragmentListedUrl&&f({url:v.fragmentListedUrl})}),V=(0,u.A)(()=>{b&&(P(),p({gift:b}))}),E=(0,a.Kr)(()=>{if(!k)return;const e=b.title||B("StarGift"),t=B(C?"GiftAuctionEnded":"GiftAuctionInfoTitle"),i=(0,N.Y)(vt.A,{className:"xv_0WTej",isPrimary:!0,onClick:T,children:B("GiftAuctionLearnMoreAboutGifts")});return(0,N.Y)("div",{ref:Y,children:(0,N.Y)(Me,{modelAttribute:I.model,backdropAttribute:I.backdrop,patternAttribute:I.pattern,title:e,badge:t,subtitle:i})})},[k,b,C,B,I,T]),q=(0,a.Kr)(()=>{if(!b||!v||k)return;const e=b.title||B("StarGift"),t=b.giftsPerRound||0;return(0,N.FD)("div",{className:"lTDjKYuV",children:[(0,N.Y)(Ut,{gift:b,hideBadge:!0,noClickable:!0}),(0,N.Y)("h1",{className:"_tvAimMQ",children:e}),C?(0,N.Y)("span",{className:"pC_V4Juh",children:B("GiftAuctionEnded")}):(0,N.Y)("p",{className:"X88e7g62",children:B("GiftAuctionTopBidders",{count:t,gift:(0,N.Y)("span",{className:"AwBqE6Vc",children:e}),link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:w,children:B("GiftAuctionLearnMore")})},{pluralValue:t,withNodes:!0,withMarkdown:!0})})]})},[b,v,k,C,B,w]),H=E||q,J=(0,a.Kr)(()=>{if(!b||!v||!S)return;const e=[];e.push([B("GiftAuctionStarted"),(0,z.L2)(1e3*v.startDate,B.code,!0)]),e.push([B("GiftAuctionEnds"),(0,z.L2)(1e3*v.endDate,B.code,!0)]),b.availabilityTotal&&e.push([B("GiftInfoAvailability"),B("GiftInfoAvailabilityValue",{count:b.availabilityRemains||0,total:B.number(b.availabilityTotal)},{pluralValue:b.availabilityRemains||0})]),"active"===v.type&&e.push([B("GiftAuctionCurrentRound"),B("GiftAuctionRoundValue",{current:B.number(v.currentRound),total:B.number(v.totalRounds)})]),C&&e.push([B("GiftAuctionAveragePrice"),(0,pe.U2)(B,v.averagePrice,{className:"Ui25Ac3P"})]);const t=S.acquiredCount,i=(0,X.yQ)(b),a=v.endDate-(0,Ye.Fm)(),n=a>0&&a<yi,r="finished"===v.type&&Boolean(v.fragmentListedUrl&&v.fragmentListedCount),o="finished"===v.type&&Boolean(v.listedCount);return{tableData:e,footer:(0,N.FD)("div",{className:"kVyu9ZRp",children:[t>0&&(0,N.Y)(vt.A,{className:Ci,isPrimary:!0,onClick:F,children:B("GiftAuctionItemsBought",{count:t,gift:i&&(0,N.Y)(ee.A,{className:Ii,sticker:i,size:20,play:!1})},{pluralValue:t,withNodes:!0})}),r&&(0,N.Y)(vt.A,{className:Ci,isPrimary:!0,onClick:O,children:B("GiftAuctionForSaleOnFragment",{count:i?(0,N.FD)(N.FK,{children:[B.number(v.fragmentListedCount),(0,N.Y)(ee.A,{className:Ii,sticker:i,size:20,play:!1})]}):B.number(v.fragmentListedCount)},{withNodes:!0})}),o&&(0,N.Y)(vt.A,{className:Ci,isPrimary:!0,onClick:V,children:B("GiftAuctionForSaleOnTelegram",{count:i?(0,N.FD)(N.FK,{children:[B.number(v.listedCount),(0,N.Y)(ee.A,{className:Ii,sticker:i,size:20,play:!1})]}):B.number(v.listedCount)},{withNodes:!0})}),(0,N.Y)(U.A,{noForcedUpperCase:!0,className:"QgTA5Tm_",onClick:C?P:R,children:C?B("OK"):(0,N.FD)("div",{children:[(0,N.Y)("div",{children:B("GiftAuctionJoin")}),a>0&&(0,N.Y)("div",{className:"XV66UlTa",children:B("GiftAuctionTimeLeft",{time:n?(0,N.Y)(Ct.A,{endsAt:v.endDate}):(0,z.zt)(B,a)},{withNodes:!0})})]})})]})}},[b,v,S,C,B,R,F,P,O,V]),W=(0,a.Kr)(()=>{if(k)return(0,N.FD)(N.FK,{children:[(0,N.Y)(ze.A,{icon:"info",onClick:w,children:B("GiftAuctionLearnMoreMenuItem")}),(0,N.Y)(ze.A,{icon:"link-badge",onClick:L,children:B("CopyLink")}),(0,N.Y)(ze.A,{icon:"forward",onClick:K,children:B("Share")})]})},[k,B,w,L,K]);return(0,N.Y)(Ge.A,{isOpen:h,header:H,footer:J?.footer,tableData:J?.tableData,className:"rCVinZx6",contentClassName:"MAEILhFp",closeButtonColor:k?"translucent-white":void 0,moreMenuItems:W,onClose:P})})),Yi={content:"FbamIaWM",headerControlPanel:"oKcR_Gxv",slider:"lpcp8Oip",title:"jNHNh7KT",subtitle:"HlVun4XF",infoCards:"K9fWcZP0",infoCard:"QBcr61z8",infoCardValue:"S9vK5Tny",infoCardLabel:"UzCztm_V",separator:"eCFcDThE",winningStatus:"IENM5upL",bidderInfoSlide:"VvFvniw8",winningText:"mHlgX1Lm",winningBadge:"yWQ_64QE",section:"VfdOWkWu",sectionTitle:"aJxJv1Tj",sectionTitleTransition:"I344VxP8",bidderRow:"_6493YZ5",bidderPosition:"bjYqFB3Y",bidderInfo:"MSwHwQYX",bidderName:"StE9kpcQ",topBidderRow:"Q0o2Mlnj",topBidderPosition:"mQa4yF_w",bidderAmount:"jTHhbapk",buttonStar:"eY_4yHis",giftSticker:"ETmmzDXX",customBidInput:"KRqfUs0J",customBidInputIcon:"m1O8A6wT"},Bi=(0,a.ph)((0,n.EK)(e=>{const{stars:t,currentUserId:i}=e,{giftAuctionBidModal:a}=(0,o.nTw)(e),n=a?.auctionGiftId,r=n?e.giftAuctionByGiftId?.[n]:void 0,s=i?(0,o.PVB)(e,i):void 0,l="active"===r?.state.type?r.state.topBidders:void 0;return{auctionState:r,starBalance:t?.balance,currentUserPeer:s,topBidderIds:l}})(({modal:e,auctionState:t,starBalance:i,currentUserPeer:r,topBidderIds:s})=>{const{closeGiftAuctionBidModal:l,sendStarGiftAuctionBid:m,loadGiftAuction:p}=(0,n.ko)(),A=Boolean(e),g=(0,d.A)(t),b=(0,d.A)(s),v=(0,a.Kr)(()=>{if(!b)return;const e=(0,n.mS)();return b.map(t=>(0,o.PVB)(e,t)).filter(Boolean)},[b]),[S,G,C]=v||[],I=(0,ye.A)([S?.id||"0"]),y=(0,ye.A)([G?.id||"0"]),k=(0,ye.A)([C?.id||"0"]),Y=g?.gift.giftsPerRound||0,B=(0,M.A)(),D="active"===g?.state.type?g.state:void 0,P=g?.userState,[w,F]=(0,a.J0)(50),[R,x,K]=(0,T.A)(),[O,V]=(0,a.J0)(""),q=D?.minBidAmount||50,z=P?.minBidAmount||q,J=1e4*Math.ceil(z/1e4)+5e4;(0,a.vJ)(()=>{F(z)},[z]);const W=D?.nextRoundAt,j=P?.bidAmount?w-P.bidAmount:0,_=w>=J,Q=(0,a.Kr)(()=>_?B("GiftAuctionTapToBidMore"):j<=0?void 0:(0,N.FD)(N.FK,{children:["+",(0,N.Y)(je.A,{text:B.number(j)})]}),[j,_,B]),X=(0,u.A)(e=>{F(e)}),$=(0,u.A)(()=>{e?.auctionGiftId&&A&&p({giftId:e.auctionGiftId})}),Z=(0,u.A)(()=>{x()}),te=(0,u.A)(()=>{_&&Z()}),ie=(0,u.A)(e=>{const t=e.target.value.replace(/\D/g,"");Number(t)>1e9||V(t)}),ae=(0,u.A)(()=>{if(!g?.gift.id||!e)return;const t=Number(O);if(t<z)return;F(t),K(),V("");const{peerId:i,message:a,shouldHideName:n}=e,r=Boolean(P?.bidAmount);m({giftId:g.gift.id,bidAmount:t,peerId:i,message:a?{text:a}:void 0,shouldHideName:n,isUpdateBid:r})}),ne=(0,u.A)(()=>{if(!g?.gift.id||!e)return;const{peerId:t,message:i,shouldHideName:a}=e,n=Boolean(P?.bidAmount);m({giftId:g.gift.id,bidAmount:w,peerId:t,message:i?{text:i}:void 0,shouldHideName:a,isUpdateBid:n})}),re=(0,a.Kr)(()=>{if(!w||!D?.bidLevels?.length)return;const{bidLevels:e}=D,t=P?.bidDate||Number.MAX_SAFE_INTEGER;for(const i of e)if(i.amount<w||i.amount===w&&i.date>=t)return i.pos;return e[e.length-1].pos+1},[w,D,P?.bidDate]),oe=Boolean(P?.bidAmount&&re&&re<=Y);function se(e,t,i,a,n){return(0,N.FD)("div",{className:Yi.topBidderRow,children:[(0,N.Y)("div",{className:Yi.topBidderPosition,children:(0,c.A)(t,["emoji"])}),(0,N.Y)(L.Ay,{name:"fade",activeKey:n,className:Yi.bidderInfo,slideClassName:Yi.bidderInfoSlide,children:i&&(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{peer:i,size:"small"}),(0,N.Y)(Ee.A,{peer:i,className:Yi.bidderName})]})}),void 0!==a&&(0,N.FD)("div",{className:Yi.bidderAmount,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(a)]})]},e)}return(0,N.FD)(h.A,{isOpen:A,hasAbsoluteCloseButton:!0,isSlim:!0,contentClassName:Yi.content,onClose:l,isLowStackPriority:!0,children:[(0,N.Y)("div",{className:Yi.headerControlPanel,children:(0,N.Y)(H,{balance:i,className:Yi.modalBalance,withAddButton:!0})}),(0,N.Y)(lt,{className:Yi.slider,defaultValue:z,minValue:q,minAllowedValue:z,minAllowedProgress:.25,maxValue:J,floatingBadgeDescription:Q,onChange:X,onBadgeClick:te,onCustomValueClick:Z,shouldUseDynamicColor:!0,shouldAllowCustomValue:!0}),(0,N.Y)("h3",{className:Yi.title,children:B("GiftAuctionPlaceBid")}),(0,N.FD)("div",{className:Yi.infoCards,children:[(0,N.FD)("div",{className:Yi.infoCard,children:[(0,N.FD)("div",{className:Yi.infoCardValue,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(z)]}),(0,N.Y)("div",{className:Yi.infoCardLabel,children:B("GiftAuctionMinimumBid")})]}),(0,N.FD)("div",{className:Yi.infoCard,children:[(0,N.Y)("div",{className:Yi.infoCardValue,children:(0,N.Y)(Ct.A,{endsAt:W||0,shouldShowZeroOnEnd:!0,onEnd:$})}),(0,N.Y)("div",{className:Yi.infoCardLabel,children:B("GiftAuctionUntilNextRound")})]}),(0,N.FD)("div",{className:Yi.infoCard,children:[(0,N.FD)("div",{className:Yi.infoCardValue,children:[(0,N.Y)(ee.A,{noLoop:!1,className:Yi.giftSticker,sticker:g?.gift.sticker,size:24}),B.number(D?.giftsLeft||0)]}),(0,N.Y)("div",{className:Yi.infoCardLabel,children:B("GiftAuctionLeft")})]})]}),(0,N.FD)("div",{className:Yi.section,children:[function(){const e=g?.gift.title||B("StarGift"),t=re&&re<=100?(D?.lastGiftNum||0)+re:void 0;return(0,N.Y)(L.Ay,{name:"fade",activeKey:oe?0:1,className:Yi.sectionTitleTransition,slideClassName:Yi.bidderInfoSlide,children:oe?(0,N.FD)("div",{className:Yi.winningStatus,children:[(0,N.Y)("span",{className:Yi.winningText,children:B("GiftAuctionYoureWinning")}),(0,N.Y)("span",{className:Yi.winningBadge,children:B("GiftUnique",{title:e,number:t?B.number(t):void 0})})]}):(0,N.Y)("div",{className:Yi.sectionTitle,children:B("GiftAuctionYourBidWillBe")})})}(),(0,N.FD)("div",{className:Yi.bidderRow,children:[(0,N.Y)("div",{className:Yi.bidderPosition,children:re&&re>100?`${re}+`:re||1}),(0,N.FD)("div",{className:Yi.bidderInfo,children:[r&&(0,N.Y)(f.A,{peer:r,size:"small"}),r&&(0,N.Y)(Ee.A,{peer:r,className:Yi.bidderName})]}),(0,N.FD)("div",{className:Yi.bidderAmount,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(w)]})]})]}),function(){const e=D?.bidLevels;return(0,N.FD)("div",{className:Yi.section,children:[(0,N.Y)("div",{className:Yi.sectionTitle,children:B("GiftAuctionTopWinners",{count:3},{pluralValue:3})}),se(0,"🥇",S,e?.[0]?.amount,I),se(1,"🥈",G,e?.[1]?.amount,y),se(2,"🥉",C,e?.[2]?.amount,k)]})}(),(0,N.Y)(U.A,{noForcedUpperCase:!0,onClick:ne,children:B(P?.bidAmount?"GiftAuctionAddToBid":"GiftAuctionPlaceBidButton",{amount:(0,pe.U2)(B,P?.bidAmount?w-P.bidAmount:w,{asFont:!0,className:Yi.buttonStar})},{withNodes:!0})}),(0,N.FD)(ui.A,{isOpen:R,title:B("GiftAuctionCustomBidTitle"),confirmLabel:B("GiftAuctionCustomBidButton"),isConfirmDisabled:!O||Number(O)<z,confirmHandler:ae,onClose:K,children:[(0,N.Y)("p",{children:B("GiftAuctionCustomBidDescription",{count:g?.gift.giftsPerRound})}),(0,N.FD)("div",{className:Yi.customBidInput,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive",className:Yi.customBidInputIcon}),(0,N.Y)(gi.A,{value:O,onChange:ie,placeholder:B("GiftAuctionCustomBidPlaceholder"),inputMode:"numeric",teactExperimentControlled:!0})]})]})]})})),Di=(0,a.ph)((0,n.EK)(e=>{const{giftAuctionInfoModal:t}=(0,o.nTw)(e),i=t?.auctionGiftId;return{giftAuction:i?e.giftAuctionByGiftId?.[i]:void 0}})(({modal:e,giftAuction:t})=>{const{closeGiftAuctionInfoModal:i}=(0,n.ko)(),r=(0,M.A)(),o=Boolean(e&&t),s=(0,u.A)(()=>{i()}),l=(0,a.Kr)(()=>(0,N.FD)("div",{className:"BYvGxmfu",children:[(0,N.Y)("div",{className:"X5HEn2ho",children:(0,N.Y)(F.A,{name:"auction-filled",className:"aiSlk9Zw"})}),(0,N.Y)("div",{className:"obG607lY",children:r("GiftAuctionInfoTitle")}),(0,N.Y)("div",{className:"wKo4cuID",children:r("GiftAuctionInfoSubtitle")})]}),[r]),c=(0,a.Kr)(()=>{if(o)return(0,N.Y)("div",{className:"M_SnCV2j",children:(0,N.Y)(U.A,{iconName:"understood",iconClassName:"OQCwJP3j",onClick:s,children:r("ButtonUnderstood")})})},[r,o,s]),d=(0,a.Kr)(()=>{const e=t?.gift.giftsPerRound||0;return[["auction-drop",r("GiftAuctionInfoTopBiddersTitle",{count:e},{pluralValue:e}),r("GiftAuctionInfoTopBiddersSubtitle",{count:e},{pluralValue:e})],["auction-next-round",r("GiftAuctionInfoBidCarryoverTitle"),r("GiftAuctionInfoBidCarryoverSubtitle",{count:e})],["stars-refund",r("GiftAuctionInfoMissedBiddersTitle"),r("GiftAuctionInfoMissedBiddersSubtitle")]]},[r,t]);return(0,N.Y)(Ni.A,{isOpen:o,header:l,listItemData:d,footer:c,onClose:s})}));var Pi=i(60406),wi=i(96802);const Ti={modal:"Pz3wJVwI",content:"vBYqMeRD",giftsListContainer:"Ly9mKtg2",giftsList:"lla9jO09",giftHeader:"TuVkgxwZ",bidValue:"zdUvUfOO",badge:"btuWuz25",starIcon:"GRggVFef",okButton:"kIsP2W0m"},Mi=(0,a.ph)((0,n.EK)(e=>{const{giftAuctionAcquiredModal:t}=(0,o.nTw)(e);return{acquiredGifts:t?.acquiredGifts,giftTitle:t?.giftTitle,giftSticker:t?.giftSticker}})(({modal:e,acquiredGifts:t,giftTitle:i,giftSticker:r})=>{const{closeGiftAuctionAcquiredModal:o}=(0,n.ko)(),s=(0,a.li)(),l=(0,M.A)(),c=Boolean(e?.giftId),m=(0,d.A)(t),f=(0,d.A)(i),p=(0,d.A)(r),A=(0,u.A)(()=>{o()}),g=(0,a.Kr)(()=>{if(m?.length)return m.map(e=>{const t=l("GiftAuctionBoughtGiftHeader",{gift:f||l("StarGift"),giftNumber:e.giftNumber?l.number(e.giftNumber):"",round:l.number(e.round)});return{tableData:[[void 0,(0,N.FD)("span",{className:Ti.giftHeader,children:[p&&(0,N.Y)(ee.A,{className:Ti.giftSticker,sticker:p,size:20,play:!1}),(0,N.Y)("span",{children:t})]})],[l("GiftAuctionRecipient"),{chatId:e.peerId}],[l("GiftAuctionDate"),(0,z.L2)(1e3*e.date,l.code,!0)],[l("GiftAuctionAcceptedBid"),(0,N.FD)("span",{className:Ti.bidValue,children:[(0,pe.U2)(l,e.bidAmount,{className:Ti.starIcon}),(0,N.Y)(V.A,{className:Ti.badge,children:l("GiftAuctionTopPosition",{position:e.position})})]})]],key:`${e.round}-${e.giftNumber}`}})},[m,f,p,l]),b=m?.length||0;return(0,Pi.A)({containerRef:s,selector:`.${Ti.giftsList}`,isBottomNotch:!0},[g]),(0,N.FD)(h.A,{isOpen:c,hasCloseButton:!0,title:l("GiftAuctionBoughtGiftsTitle",{count:b},{pluralValue:b}),className:Ti.modal,contentClassName:Ti.content,onClose:A,isCondensedHeader:!0,isSlim:!0,children:[(0,N.Y)("div",{className:Ti.giftsListContainer,ref:s,children:(0,N.Y)("div",{className:Ti.giftsList,children:g?.map(e=>(0,N.Y)(wi.A,{tableData:e.tableData},e.key))})}),(0,N.Y)(U.A,{className:Ti.okButton,onClick:A,children:l("OK")})]})})),Fi=4*w.$,Ui=(0,a.ph)((0,n.EK)((e,{modal:t})=>({oldPeer:t?.oldPeerId?(0,o.PVB)(e,t.oldPeerId):void 0,newPeer:t?.newPeerId?(0,o.PVB)(e,t.newPeerId):void 0}))(({modal:e,oldPeer:t,newPeer:i})=>{const{closeGiftAuctionChangeRecipientModal:a,openGiftAuctionBidModal:o}=(0,n.ko)(),s=(0,M.A)(),l=Boolean(e),c=(0,d.A)(t),m=(0,d.A)(i),p=(0,d.A)(e),h=(0,u.A)(()=>{p?.auctionGiftId&&(a(),o({auctionGiftId:p.auctionGiftId,peerId:p.newPeerId,message:p.message,shouldHideName:p.shouldHideName}))});if(c&&m)return(0,N.FD)(ui.A,{isOpen:l,title:s("GiftAuctionChangeRecipientTitle"),onClose:a,confirmLabel:s("Continue"),confirmHandler:h,children:[(0,N.FD)("div",{className:"GiX7PhEa",children:[(0,N.Y)(f.A,{peer:c,size:Fi}),(0,N.Y)(F.A,{name:"next",className:"rkG87LNM"}),(0,N.Y)(f.A,{peer:m,size:Fi})]}),(0,N.Y)("p",{children:s("GiftAuctionChangeRecipientDescription",{oldPeer:(0,r.F9)(s,c),newPeer:(0,r.F9)(s,m)},{withNodes:!0,withMarkdown:!0})})]})})),Ri=(0,a.ph)(({modal:e})=>{const{closeStarGiftPriceDecreaseInfoModal:t}=(0,n.ko)(),i=(0,M.A)(),r=Boolean(e),o=(0,d.A)(e),l=(0,u.A)(()=>{t()}),c=(0,a.Kr)(()=>{if(!o)return;const{prices:e}=o;return e.map(e=>[(0,z.L2)(1e3*e.date,i.code,!0,void 0,!0),(0,pe.U2)(i,e.upgradeStars,{containerClassName:"NEElQBO6"})])},[i,o]),m=(0,a.Kr)(()=>{if(r)return(0,N.FD)("div",{className:"OXLUuiYb",children:[(0,N.Y)("p",{className:"TWuxZcHO",children:i("UpgradeCostDrops")}),(0,N.Y)(U.A,{onClick:l,iconName:"understood",iconClassName:"QJryEH9W",children:i("ButtonUnderstood")})]})},[i,r,l]);if(!c||!o)return;const{currentPrice:f,minPrice:p,maxPrice:h}=o,A=h!==p?(f-p)/(h-p):0,g=(0,N.FD)("div",{className:"ETFjTQkC",children:[(0,N.Y)(gt.A,{leftText:(0,pe.Kk)(i,h),rightText:(0,pe.Kk)(i,p),floatingBadgeText:(0,pe.Kk)(i,f),floatingBadgeIcon:"star",progress:A,isInverted:!0,shouldSkipGradient:!0,className:"DJPf4ekd"}),(0,N.Y)("p",{className:"JKYZ8cFl",children:i("StarGiftUpgradeCostModalTitle")}),(0,N.Y)("p",{className:"wHxufgix",children:i("StarGiftUpgradeCostHint")})]});return(0,N.Y)(Ge.A,{isOpen:r,onClose:l,header:g,tableData:c,tableClassName:(0,s.A)("WuL_UIYd","custom-scroll"),footer:m})});var xi=i(83240);const Li=(0,a.ph)(({modal:e})=>{const{closeAboutStarGiftModal:t}=(0,n.ko)(),i=(0,M.A)(),r=Boolean(e),o=(0,d.A)(e),s=(0,u.A)(()=>{t()}),l=(0,a.Kr)(()=>(0,N.FD)("div",{className:"kSwGxZvD",children:[(0,N.FD)("div",{className:"e4SGnYtk",children:[(0,N.Y)(_e.A,{preset:"progress",className:"wYp9XwdI"}),(0,N.Y)(xi.A,{videoId:o?.videoId,videoThumbnail:o?.videoThumbnail,isActive:r,isDown:!0})]}),(0,N.Y)("div",{className:"CMt0et4C",children:i("StarGiftInfoTitle")}),(0,N.Y)("div",{className:"exd4nt_X",children:i("StarGiftInfoSubtitle")})]}),[i,o,r]),c=(0,a.Kr)(()=>{if(r)return(0,N.Y)("div",{className:"hx2wl4Ar",children:(0,N.Y)(U.A,{iconName:"understood",iconClassName:"qegJKhEH",onClick:s,children:i("ButtonUnderstood")})})},[i,r,s]),m=(0,a.Kr)(()=>[["diamond",i("StarGiftInfoUniqueTitle"),i("StarGiftInfoUniqueSubtitle")],["auction",i("StarGiftInfoTradableTitle"),i("StarGiftInfoTradableSubtitle")],["crown-wear-outline",i("StarGiftInfoWearableTitle"),i("StarGiftInfoWearableSubtitle")]],[i]);return(0,N.Y)(Ni.A,{isOpen:r,contentClassName:"rGPBNoZR",header:l,listItemData:m,footer:c,hasBackdrop:Boolean(o?.videoId),absoluteCloseButtonColor:"translucent-white",onClose:s})});var Ki=i(45294);const Oi=7*w.$,Vi=(0,a.ph)((0,n.EK)(e=>({currentUser:(0,o.mBe)(e,e.currentUserId),isCurrentUserPremium:(0,o.g29)(e)}))(({modal:e,currentUser:t,isCurrentUserPremium:i})=>{const{closeGiftStatusInfoModal:r,setEmojiStatus:o}=(0,n.ko)(),l=(0,M.A)(),{isMobile:c}=(0,ke.Ay)(),m=Boolean(e),p=(0,d.A)(e),{emojiStatus:h}=p||{},A=h?.textColor,g=(0,Ki.A)(h?.patternDocumentId),b=(0,u.A)(()=>{r()}),v=(0,u.A)(()=>{h&&o({emojiStatus:h}),r()}),S=(0,a.Kr)(()=>{if(!h||!m)return;const e=[h.centerColor,h.edgeColor];return(0,N.Y)(te.A,{className:"_1RfhkfB",backgroundColors:e,patternIcon:g.customEmoji,yPosition:6.875*w.$,maxRadius:.31,patternSize:c?13:15,ovalFactor:1})},[h,m,c,g]),G=(0,a.Kr)(()=>({...t,emojiStatus:h}),[t,h]),C=(0,a.Kr)(()=>(0,N.FD)("div",{className:"qL0cHbwS",children:[(0,N.FD)("div",{className:(0,s.A)("t18QCmAb"),style:(0,Ie.A)(A&&`color: ${A}`),children:[S,(0,N.Y)(f.A,{peer:G,size:Oi,className:"JK2zOWA7"}),(0,N.Y)(Ee.A,{peer:G,className:"lxxbgNCl",withEmojiStatus:!0,noFake:!0,noVerified:!0}),(0,N.Y)("p",{className:"MLMdxkUg",style:(0,Ie.A)(A&&`color: ${A}`),children:l("Online")})]}),(0,N.Y)("div",{className:"wxg_5ou_",children:l("UniqueStatusWearTitle",{gift:G?.emojiStatus?.title})}),(0,N.Y)("div",{className:"KSCLIMZm",children:l("UniqueStatusBenefitsDescription")})]}),[A,S,G,l]),I=[["radial-badge",l("UniqueStatusBadgeBenefitTitle"),l("UniqueStatusBadgeDescription")],["unique-profile",l("UniqueStatusProfileDesignBenefitTitle"),l("UniqueStatusProfileDesignDescription")],["proof-of-ownership",l("UniqueStatusProofOfOwnershipBenefitTitle"),l("UniqueStatusProofOfOwnershipDescription")]],y=(0,a.Kr)(()=>{if(m)return(0,N.Y)("div",{className:"VDrvalBo",children:(0,N.FD)(U.A,{onClick:v,children:[l("UniqueStatusWearButton"),!i&&(0,N.Y)(F.A,{name:"lock-badge",className:"jiPObOWv"})]})})},[l,i,m]);return(0,N.Y)(Ni.A,{isOpen:m,header:C,listItemData:I,footer:y,hasBackdrop:!0,onClose:b})}));var Ei=i(15535);const qi={header:"LQgz8Nlx",giftPreview:"hgs0ts_O",backdrop:"OnBhMaBw",description:"HBxB4QPY",arrow:"kXTOUpfb",noPassword:"BnqLhoKr"},Hi={isCustomPeer:!0,avatarIcon:"fragment",title:"",customPeerAvatarColor:"#000000"},zi=4.5*w.$,Ji=(0,a.ph)((0,n.EK)(e=>{const{settings:{byKey:{hasPassword:t}},twoFaSettings:{hint:i}}=e;return{hasPassword:t,passwordHint:i}})(({modal:e,hasPassword:t,passwordHint:i})=>{const{closeGiftWithdrawModal:r,clearGiftWithdrawError:o,closeGiftInfoModal:s,processStarGiftWithdrawal:l,openSettingsScreen:c}=(0,n.ko)(),m=Boolean(e),[p,A]=(0,a.J0)(!1),g=(0,M.A)(),b=(0,d.A)(e),v=b?.gift?.gift,S=v&&(0,X.uc)(v),G=b?.gift?.canExportAt?Math.max(b.gift.canExportAt-(0,Ye.Fm)(),0):void 0,C=(0,u.A)(()=>{r()}),I=(0,u.A)(e=>{l({gift:b.gift.inputGift,password:e})}),y=(0,u.A)(()=>{c({screen:ve.VS.TwoFaDisabled}),r(),s()});return(0,N.FD)(h.A,{isOpen:m,title:g("GiftWithdrawTitle"),isCondensedHeader:!0,hasCloseButton:!0,isSlim:!0,onClose:C,children:[S&&(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{className:qi.header,children:[(0,N.FD)("div",{className:qi.giftPreview,children:[(0,N.Y)(te.A,{className:qi.backdrop,backgroundColors:[S.backdrop.centerColor,S.backdrop.edgeColor],patternIcon:S.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,N.Y)(ee.A,{className:qi.sticker,size:zi,sticker:S.model?.sticker})]}),(0,N.Y)(F.A,{name:"next",className:qi.arrow}),(0,N.Y)(f.A,{peer:Hi,size:"giant",className:qi.avatar})]}),(0,N.Y)("p",{className:qi.description,children:g("GiftWithdrawDescription",{gift:`${v.title} #${v.number}`},{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]})})]}),Boolean(G)&&(0,N.Y)("p",{className:qi.exportHint,children:g("GiftWithdrawWait",{days:(0,ht._k)(G)},{pluralValue:(0,ht._k)(G)})}),!t&&(0,N.FD)(N.FK,{children:[(0,N.Y)("span",{className:qi.noPassword,children:g("ErrorPasswordMissing")}),(0,N.Y)(U.A,{className:"mt-2",onClick:y,children:g("SetUp2FA")})]}),t&&!G&&(0,N.Y)(Ei.A,{shouldShowSubmit:!0,placeholder:g("CheckPasswordPlaceholder"),error:b?.errorKey&&g.withRegular(b?.errorKey),description:g("CheckPasswordDescription"),onClearError:o,isLoading:b?.isLoading,hint:i,isPasswordVisible:p,shouldResetValue:m,onChangePasswordVisibility:A,submitLabel:g("GiftWithdrawSubmit"),onSubmit:I})]})}));var Wi=i(79824),ji=i(74984),_i=i(4875),Qi=i(56863),Xi=i(30857),$i=i(84080),Zi=i(56133),ea=i(35297);function ta(){}async function ia(e){const t=await(0,_i.px)("searchChats",{query:e});if(t)return[...t.accountResultIds,...t.globalResultIds]}const aa=(0,a.ph)((0,n.EK)(e=>{const{contactList:t,currentUserId:i}=e;return{contactIds:t?.userIds,currentUserId:i}})(({modal:e,contactIds:t,currentUserId:i})=>{const{closeGiftTransferModal:r,openGiftWithdrawModal:s,openGiftTransferConfirmModal:l}=(0,n.ko)(),c=Boolean(e),m=(0,M.A)(),[f,p]=(0,a.J0)(""),h=(0,d.A)(e),A=(0,ji.Rh)(G.DSF),g=(0,a.Kr)(()=>(0,I.Am)([...t||[],...A||[]]),[t,A]),{result:b,currentResultsQuery:v}=function({query:e,queryFn:t=ia,defaultValue:i,debounceTimeout:n=300,isDisabled:r}){const o=function(e,t,i){const[n,r]=(0,a.J0)(),{isFrozen:o,updateWhenUnfrozen:s}=function(){const e=(0,a.li)(!1),t=(0,a.hb)(()=>{e.current=!0},[]),i=(0,Xi.A)(),n=(0,a.hb)(()=>{e.current&&(e.current=!1,i())},[i]);return(0,$i.Ay)(ta,n),{isFrozen:(0,a.OV)(),updateWhenUnfrozen:t}}(),l=(0,Zi.A)(t,!0);return(0,ea.A)(()=>{o?s():l(()=>{r(e())})},[...i,o]),n}(()=>e,n,[e]),[s,l]=(0,a.J0)(""),c=e?o:e,d=(0,u.A)(t);return{...(0,Qi.A)(async()=>{if(!c||r)return l(""),Promise.resolve(i);const e=await d(c);return l(c),e},[c,i,d,r],i),currentResultsQuery:s}}({query:f,defaultValue:g}),S=v!==f,C=(0,a.Kr)(()=>v?Wi.p:[{type:"withdraw",isCustomPeer:!0,avatarIcon:"toncoin",peerColorId:5,title:m("GiftTransferTON")}],[m,v]),B=(0,u.A)(e=>{"withdraw"===e&&(s({gift:h.gift}),r())}),D=(0,a.Kr)(()=>{if(S)return Wi.p;const e=(0,n.mS)();return(0,y.A)((b||[]).filter(t=>t!==i&&(0,o.X2D)(e,t)),!1)},[S,b,i]),P=(0,u.A)(e=>{h?.gift&&l({gift:h.gift,recipientId:e})});return(0,N.Y)(Y.A,{isOpen:c,onClose:r,title:m("GiftTransferTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,ignoreFreeze:!0,children:(0,N.Y)(k.A,{itemIds:D,categories:C,onSelectedCategoryChange:B,withDefaultPadding:!0,withPeerUsernames:!0,isSearchable:!0,noScrollRestore:!0,isLoading:S,filterValue:f,filterPlaceholder:m("Search"),onFilterChange:p,onSelectedIdChange:P})})})),na=(0,a.ph)((0,n.EK)((e,{modal:t})=>({selectedPeer:t?.recipientId?(0,o.PVB)(e,t.recipientId):void 0}))(({modal:e,selectedPeer:t})=>{const{closeGiftTransferConfirmModal:i,transferGift:a,openChat:o,closeGiftModal:s,closeGiftTransferModal:l}=(0,n.ko)(),c=(0,M.A)(),m=Boolean(e),f=(0,d.A)(e),p=(0,d.A)(t),h=(0,u.A)(()=>{f?.gift.inputGift&&f.recipientId&&(a({gift:f.gift.inputGift,recipientId:f.recipientId,transferStars:f.gift.transferStars}),i(),o({id:f.recipientId}),s(),l())});if(!f)return;const{gift:A}=f,g="starGiftUnique"===A.gift.type?A.gift:void 0;return g?(0,N.FD)(ui.A,{isOpen:m,noDefaultTitle:!0,onClose:i,confirmLabel:A.transferStars?c("GiftTransferConfirmButton",{amount:(0,pe.U2)(c,A.transferStars,{asFont:!0})},{withNodes:!0}):c("GiftTransferConfirmButtonFree"),confirmHandler:h,children:[p&&(0,N.Y)(di,{peer:p,gift:g}),(0,N.Y)("p",{children:A.transferStars?c("GiftTransferConfirmDescription",{gift:c("GiftUnique",{title:g.title,number:g.number}),amount:(0,pe.Kk)(c,A.transferStars),peer:(0,r.F9)(c,p)},{withNodes:!0,withMarkdown:!0}):c("GiftTransferConfirmDescriptionFree",{gift:c("GiftUnique",{title:g.title,number:g.number}),peer:(0,r.F9)(c,p)},{withNodes:!0,withMarkdown:!0})})]}):void 0})),ra=(0,a.ph)((0,n.EK)((e,{modal:t})=>({senderPeer:t?.details.senderId?(0,o.PVB)(e,t.details.senderId):void 0,recipientPeer:t?.details.recipientId?(0,o.PVB)(e,t.details.recipientId):void 0}))(({modal:e,senderPeer:t,recipientPeer:i})=>{const{closeGiftDescriptionRemoveModal:a,removeGiftDescription:r,openChat:o}=(0,n.ko)(),s=(0,M.A)(),l=Boolean(e),c=(0,d.A)(e),m=(0,d.A)(t),f=(0,d.A)(i),p=(0,u.A)(e=>{a(),o({id:e})}),h=(0,u.A)(()=>{c?.gift.inputGift&&c.price&&r({gift:c.gift.inputGift,price:c.price})});if(!c||!f)return;const{price:A,details:g}=c,b=ri({originalDetails:g,recipient:f,sender:m,onOpenChat:p,lang:s});return(0,N.FD)(ui.A,{isOpen:l,title:s("RemoveGiftDescriptionTitle"),onClose:a,confirmLabel:s("RemoveGiftDescriptionButton",{amount:(0,pe.U2)(s,A,{asFont:!0})},{withNodes:!0}),confirmHandler:h,children:[(0,N.Y)("div",{className:"LVOpBXUW",children:s("RemoveGiftDescriptionConfirmText")}),Boolean(b)&&(0,N.Y)("div",{className:"FA1_yVBY",children:b})]})})),oa=(0,a.ph)((0,n.EK)((e,{modal:t})=>({user:t?.userId?(0,o.mBe)(e,t.userId):void 0}))(({modal:e,user:t})=>{const{closeChatRefundModal:i,toggleNoPaidMessagesException:o}=(0,n.ko)(),[s,l]=(0,a.J0)(!1),c=(0,d.A)(e),m=(0,d.A)(t),{starsToRefund:f,userId:p}=c||{},h=(0,M.A)(),A=Boolean(e),g=(0,u.A)(()=>{i(),p&&o({userId:p,shouldRefundCharged:s})});return(0,N.FD)(ui.A,{isOpen:A,onClose:i,title:h("RemoveFeeTitle"),confirmLabel:h("ConfirmRemoveMessageFee"),confirmHandler:g,children:[h("ConfirmDialogMessageRemoveFee",{peer:m&&(0,r.F9)(h,m)},{withMarkdown:!0,withNodes:!0}),Boolean(f)&&(0,N.Y)(qe.A,{className:"dialog-checkbox",label:h("ConfirmDialogRemoveFeeRefundStars",{amount:(0,pe.Kk)(h,f)},{withMarkdown:!0,withNodes:!0}),checked:s,onCheck:l})]})}));var sa=i(14487);const la=(0,a.ph)((0,n.EK)(e=>{const t=e.stars?.balance,i=e.ton?.balance?.amount;return{starBalance:t,tonBalance:i}})(({modal:e,starBalance:t,tonBalance:i})=>{const r=(0,n.ko)(),o=(0,M.A)(),s=(0,a.hb)(()=>{if(!e?.directInfo)return void r.closePriceConfirmModal();const{currency:a,newAmount:n}=e,o="TON"===a,s=o?i:t?.amount;if(void 0!==s){if(s<n)return r.openStarsBalanceModal({currency:o?"TON":"XTR",tabId:(0,sa.g0)()}),void r.closePriceConfirmModal();r.sendStarPaymentForm({directInfo:e.directInfo,tabId:(0,sa.g0)()}),r.closePriceConfirmModal()}else r.closePriceConfirmModal()},[e,t,i,r]),c=(0,a.hb)(()=>{r.closePriceConfirmModal()},[r]);if(!e)return;const{originalAmount:d,newAmount:u,currency:m}=e;let f,p;return"TON"===m?(f=(0,pe.QH)(o,(0,l.wD)(d)),p=(0,pe.QH)(o,(0,l.wD)(u))):(f=(0,pe.Kk)(o,d),p=(0,pe.Kk)(o,u)),(0,N.Y)(ui.A,{isOpen:Boolean(e),onClose:c,title:o("PriceChanged"),confirmHandler:s,confirmLabel:o("PayNewPrice"),children:(0,N.Y)("p",{children:o("PriceChangedText",{originalAmount:f,newAmount:p},{withMarkdown:!0,withNodes:!0})})})}))}}]);
//# sourceMappingURL=6930.421048eaa81b93c4d7b3.js.map