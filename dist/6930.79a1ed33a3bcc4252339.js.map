{"version":3,"file":"6930.79a1ed33a3bcc4252339.js","mappings":"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","sources":["webpack://telegram-t/./src/components/common/gift/GiftMenuItems.tsx","webpack://telegram-t/./src/components/modals/stars/gift/StarsGiftModal.module.scss?069e","webpack://telegram-t/./src/components/modals/stars/gift/StarsGiftModal.tsx","webpack://telegram-t/./src/components/main/premium/StarsGiftingPickerModal.module.scss?3156","webpack://telegram-t/./src/components/main/premium/StarsGiftingPickerModal.tsx","webpack://telegram-t/./src/components/modals/stars/StarsBalanceModal.module.scss?bbd4","webpack://telegram-t/./src/components/modals/stars/BalanceBlock.tsx","webpack://telegram-t/./src/components/modals/stars/subscription/StarsSubscriptionItem.module.scss?74b5","webpack://telegram-t/./src/components/modals/stars/subscription/StarsSubscriptionItem.tsx","webpack://telegram-t/./src/components/modals/stars/helpers/transaction.ts","webpack://telegram-t/./src/components/modals/stars/transaction/PaidMediaThumb.module.scss?605d","webpack://telegram-t/./src/components/modals/stars/transaction/PaidMediaThumb.tsx","webpack://telegram-t/./src/components/modals/stars/transaction/StarsTransactionItem.module.scss?b947","webpack://telegram-t/./src/components/modals/stars/transaction/StarsTransactionItem.tsx","webpack://telegram-t/./src/components/modals/stars/StarsBalanceModal.tsx","webpack://telegram-t/./src/components/modals/stars/StarsPaymentModal.tsx","webpack://telegram-t/./src/components/modals/gift/UniqueGiftManageButtons.module.scss?f41d","webpack://telegram-t/./src/components/modals/gift/UniqueGiftManageButtons.tsx","webpack://telegram-t/./src/components/modals/gift/UniqueGiftHeader.tsx","webpack://telegram-t/./src/components/modals/gift/UniqueGiftHeader.module.scss?2bf6","webpack://telegram-t/./src/components/modals/stars/transaction/StarsTransactionModal.module.scss?a215","webpack://telegram-t/./src/components/modals/stars/transaction/StarsTransactionModal.tsx","webpack://telegram-t/./src/components/modals/stars/subscription/StarsSubscriptionModal.module.scss?5025","webpack://telegram-t/./src/components/modals/stars/subscription/StarsSubscriptionModal.tsx","webpack://telegram-t/./src/components/modals/paidReaction/StarSlider.module.scss?b8f3","webpack://telegram-t/./src/components/modals/paidReaction/StarSlider.tsx","webpack://telegram-t/./src/components/modals/paidReaction/PaidReactionModal.module.scss?80b2","webpack://telegram-t/./src/components/modals/paidReaction/PaidReactionModal.tsx","webpack://telegram-t/./src/components/modals/gift/GiftComposer.module.scss?dac8","webpack://telegram-t/./src/components/modals/gift/GiftComposer.tsx","webpack://telegram-t/./src/components/modals/gift/GiftItem.module.scss?c564","webpack://telegram-t/./src/components/modals/gift/GiftItemPremium.tsx","webpack://telegram-t/./src/components/modals/gift/GiftItemStar.tsx","webpack://telegram-t/./src/components/modals/gift/GiftModal.module.scss?fd13","webpack://telegram-t/./src/components/modals/gift/GiftModalResaleScreen.tsx","webpack://telegram-t/./src/components/modals/gift/ResaleGiftMenuAttributeSticker.module.scss?8276","webpack://telegram-t/./src/components/modals/gift/ResaleGiftMenuAttributeSticker.tsx","webpack://telegram-t/./src/components/modals/gift/GiftResaleFilters.module.scss?c5a8","webpack://telegram-t/./src/components/modals/gift/GiftResaleFilters.tsx","webpack://telegram-t/./src/components/modals/gift/StarGiftCategoryList.module.scss?7d19","webpack://telegram-t/./src/components/modals/gift/StarGiftCategoryList.tsx","webpack://telegram-t/./src/components/modals/gift/GiftModal.tsx","webpack://telegram-t/./src/components/modals/gift/recipient/GiftRecipientPicker.module.scss?b7e9","webpack://telegram-t/./src/components/modals/gift/recipient/GiftRecipientPicker.tsx","webpack://telegram-t/./src/components/common/helpers/giftOriginalInfo.tsx","webpack://telegram-t/./src/components/common/gift/GiftTransferPreview.module.scss?0f0d","webpack://telegram-t/./src/components/common/gift/GiftTransferPreview.tsx","webpack://telegram-t/./src/components/modals/gift/info/GiftInfoModal.module.scss?4f0e","webpack://telegram-t/./src/components/modals/gift/info/GiftInfoModal.tsx","webpack://telegram-t/./src/components/modals/gift/value/GiftInfoValueModal.module.scss?3884","webpack://telegram-t/./src/components/modals/gift/value/GiftInfoValueModal.tsx","webpack://telegram-t/./src/components/modals/gift/locked/GiftLockedModal.tsx","webpack://telegram-t/./src/components/modals/gift/locked/GiftLockedModal.module.scss?1055","webpack://telegram-t/./src/components/modals/gift/resale/GiftResalePriceComposerModal.module.scss?6666","webpack://telegram-t/./src/components/modals/gift/resale/GiftResalePriceComposerModal.tsx","webpack://telegram-t/./src/components/modals/gift/upgrade/GiftUpgradeModal.module.scss?ae9e","webpack://telegram-t/./src/components/modals/gift/upgrade/GiftUpgradeModal.tsx","webpack://telegram-t/./src/components/modals/gift/status/GiftStatusInfoModal.module.scss?3366","webpack://telegram-t/./src/components/modals/gift/status/GiftStatusInfoModal.tsx","webpack://telegram-t/./src/components/modals/gift/withdraw/GiftWithdrawModal.module.scss?287b","webpack://telegram-t/./src/components/modals/gift/withdraw/GiftWithdrawModal.tsx","webpack://telegram-t/./src/hooks/useDebouncedMemo.ts","webpack://telegram-t/./src/hooks/usePeerSearch.ts","webpack://telegram-t/./src/components/modals/gift/transfer/GiftTransferModal.tsx","webpack://telegram-t/./src/components/modals/gift/transfer/GiftTransferConfirmModal.tsx","webpack://telegram-t/./src/components/modals/gift/message/GiftDescriptionRemoveModal.tsx","webpack://telegram-t/./src/components/modals/gift/message/GiftDescriptionRemoveModal.module.scss?7493","webpack://telegram-t/./src/components/modals/stars/chatRefund/ChatRefundModal.tsx","webpack://telegram-t/./src/components/modals/priceConfirm/PriceConfirmModal.tsx"],"sourcesContent":["import { memo, useMemo } from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport type {\n  ApiEmojiStatusCollectible, ApiEmojiStatusType, ApiSavedStarGift, ApiStarGift,\n} from '../../../api/types';\n\nimport { DEFAULT_STATUS_ICON_ID, TME_LINK_PREFIX } from '../../../config';\nimport { STARS_CURRENCY_CODE } from '../../../config';\nimport { copyTextToClipboard } from '../../../util/clipboard';\nimport { formatDateAtTime } from '../../../util/dates/dateFormat';\nimport { getServerTime } from '../../../util/serverTime';\n\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport MenuItem from '../../ui/MenuItem';\n\ntype OwnProps = {\n  peerId: string;\n  canManage?: boolean;\n  gift: ApiSavedStarGift | ApiStarGift;\n  currentUserEmojiStatus?: ApiEmojiStatusType;\n  collectibleEmojiStatuses?: ApiEmojiStatusType[];\n};\n\nconst GiftMenuItems = ({\n  peerId,\n  canManage,\n  gift: typeGift,\n  currentUserEmojiStatus,\n  collectibleEmojiStatuses,\n}: OwnProps) => {\n  const {\n    showNotification,\n    openChatWithDraft,\n    openGiftTransferModal,\n    openGiftResalePriceComposerModal,\n    openGiftStatusInfoModal,\n    setEmojiStatus,\n    toggleSavedGiftPinned,\n    changeGiftVisibility,\n    updateStarGiftPrice,\n    closeGiftInfoModal,\n  } = getActions();\n\n  const lang = useLang();\n  const oldLang = useOldLang();\n\n  const isSavedGift = typeGift && 'gift' in typeGift;\n  const savedGift = isSavedGift ? typeGift : undefined;\n  const gift = isSavedGift ? typeGift.gift : typeGift;\n\n  const starGiftUniqueSlug = gift?.type === 'starGiftUnique' ? gift.slug : undefined;\n  const starGiftUniqueLink = useMemo(() => {\n    if (!starGiftUniqueSlug) return undefined;\n    return `${TME_LINK_PREFIX}nft/${starGiftUniqueSlug}`;\n  }, [starGiftUniqueSlug]);\n  const userCollectibleStatus = useMemo(() => {\n    if (!starGiftUniqueSlug) return undefined;\n    return collectibleEmojiStatuses?.find((\n      status,\n    ) => status.type === 'collectible' && status.slug === starGiftUniqueSlug) as ApiEmojiStatusCollectible | undefined;\n  }, [starGiftUniqueSlug, collectibleEmojiStatuses]);\n\n  const currenUniqueEmojiStatusSlug = currentUserEmojiStatus?.type === 'collectible'\n    ? currentUserEmojiStatus.slug : undefined;\n\n  const isGiftUnique = gift && gift.type === 'starGiftUnique';\n  const canTakeOff = isGiftUnique && currenUniqueEmojiStatusSlug === gift.slug;\n  const canWear = userCollectibleStatus && !canTakeOff;\n  const giftResalePrice = isGiftUnique ? gift.resellPrice : undefined;\n\n  const hasPinOptions = canManage && savedGift && !savedGift.isUnsaved && isGiftUnique;\n\n  const handleTriggerVisibility = useLastCallback(() => {\n    const { inputGift, isUnsaved } = savedGift!;\n    changeGiftVisibility({ gift: inputGift!, shouldUnsave: !isUnsaved });\n  });\n\n  const handleCopyLink = useLastCallback(() => {\n    if (!starGiftUniqueLink) return;\n    copyTextToClipboard(starGiftUniqueLink);\n    showNotification({\n      message: lang('LinkCopied'),\n    });\n  });\n\n  const handleLinkShare = useLastCallback(() => {\n    if (!starGiftUniqueLink) return;\n    openChatWithDraft({ text: { text: starGiftUniqueLink } });\n  });\n\n  const handleTransfer = useLastCallback(() => {\n    if (!savedGift || savedGift?.gift.type !== 'starGiftUnique') return;\n\n    if (savedGift.canTransferAt && savedGift.canTransferAt > getServerTime()) {\n      showNotification({\n        message: {\n          key: 'NotificationGiftCanTransferAt',\n          variables: { date: formatDateAtTime(oldLang, savedGift.canTransferAt * 1000) },\n        },\n      });\n      return;\n    }\n\n    openGiftTransferModal({ gift: savedGift });\n  });\n\n  const handleSell = useLastCallback(() => {\n    if (!savedGift) return;\n    if (savedGift.canResellAt && savedGift.canResellAt > getServerTime()) {\n      showNotification({\n        message: {\n          key: 'NotificationGiftCanResellAt',\n          variables: { date: formatDateAtTime(oldLang, savedGift.canResellAt * 1000) },\n        },\n      });\n      return;\n    }\n    openGiftResalePriceComposerModal({ peerId, gift: savedGift });\n  });\n\n  const handleUnsell = useLastCallback(() => {\n    if (!savedGift || savedGift.gift.type !== 'starGiftUnique' || !savedGift.inputGift) return;\n    closeGiftInfoModal();\n    updateStarGiftPrice({ gift: savedGift.inputGift, price: {\n      currency: STARS_CURRENCY_CODE, amount: 0, nanos: 0,\n    } });\n    showNotification({\n      icon: 'unlist-outline',\n      message: {\n        key: 'NotificationGiftIsUnlist',\n        variables: { gift: lang('GiftUnique', { title: savedGift.gift.title, number: savedGift.gift.number }) },\n      },\n    });\n  });\n\n  const handleWear = useLastCallback(() => {\n    if (gift?.type !== 'starGiftUnique' || !userCollectibleStatus) return;\n    openGiftStatusInfoModal({ emojiStatus: userCollectibleStatus });\n  });\n\n  const handleTakeOff = useLastCallback(() => {\n    if (canTakeOff) {\n      setEmojiStatus({\n        emojiStatus: { type: 'regular', documentId: DEFAULT_STATUS_ICON_ID },\n      });\n    }\n  });\n\n  const handleTogglePin = useLastCallback(() => {\n    toggleSavedGiftPinned({ peerId, gift: savedGift! });\n  });\n\n  return (\n    <>\n      {hasPinOptions && (\n        <MenuItem icon={savedGift.isPinned ? 'unpin' : 'pin'} onClick={handleTogglePin}>\n          {lang(savedGift.isPinned ? 'ChatListUnpinFromTop' : 'ChatListPinToTop')}\n        </MenuItem>\n      )}\n      <MenuItem icon=\"link-badge\" onClick={handleCopyLink}>\n        {lang('CopyLink')}\n      </MenuItem>\n      <MenuItem icon=\"forward\" onClick={handleLinkShare}>\n        {lang('Share')}\n      </MenuItem>\n      {canManage && isGiftUnique && (\n        <MenuItem icon=\"diamond\" onClick={handleTransfer}>\n          {lang('GiftInfoTransfer')}\n        </MenuItem>\n      )}\n      {canManage && isGiftUnique && !giftResalePrice && (\n        <MenuItem icon=\"sell-outline\" onClick={handleSell}>\n          {lang('Sell')}\n        </MenuItem>\n      )}\n      {canManage && isGiftUnique && Boolean(giftResalePrice) && (\n        <MenuItem icon=\"unlist-outline\" onClick={handleUnsell}>\n          {lang('GiftInfoUnlist')}\n        </MenuItem>\n      )}\n      {canManage && savedGift && (\n        <MenuItem icon={savedGift.isUnsaved ? 'eye-outline' : 'eye-crossed-outline'} onClick={handleTriggerVisibility}>\n          {lang(savedGift.isUnsaved ? 'GiftActionShow' : 'GiftActionHide')}\n        </MenuItem>\n      )}\n      {canWear && (\n        <MenuItem icon=\"crown-wear-outline\" onClick={handleWear}>\n          {lang('GiftInfoWear')}\n        </MenuItem>\n      )}\n      {canTakeOff && (\n        <MenuItem icon=\"crown-take-off-outline\" onClick={handleTakeOff}>\n          {lang('GiftInfoTakeOff')}\n        </MenuItem>\n      )}\n    </>\n  );\n};\n\nexport default memo(GiftMenuItems);\n","// extracted by mini-css-extract-plugin\nexport default {\"modalDialog\":\"MFXAwnxJ\",\"content\":\"Sl6xVf1R\",\"main\":\"bTN9Jeph\",\"headerInfo\":\"c6MiyJgW\",\"logo\":\"StGLWvzb\",\"logoBackground\":\"SyTXSfml\",\"description\":\"kFe3mIZo\",\"section\":\"BgfHkWd2\",\"header\":\"zMtAGfXs\",\"starHeaderText\":\"q3v8orGj\",\"hiddenHeader\":\"bq3FnXT0\",\"closeButton\":\"bDsDTkbe\",\"avatar\":\"jK36xUj4\",\"center\":\"v1PckUQn\",\"secondaryInfo\":\"TDWSRfP9\"};","import type { FC } from '../../../../lib/teact/teact';\nimport type React from '../../../../lib/teact/teact';\nimport {\n  memo, useEffect, useMemo, useRef,\n  useState,\n} from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type {\n  ApiStarTopupOption, ApiUser,\n} from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\n\nimport { getPeerTitle } from '../../../../global/helpers/peers';\nimport {\n  selectUser,\n} from '../../../../global/selectors';\nimport buildClassName from '../../../../util/buildClassName';\nimport { formatCurrencyAsString } from '../../../../util/formatCurrency';\nimport renderText from '../../../common/helpers/renderText';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useOldLang from '../../../../hooks/useOldLang';\n\nimport Avatar from '../../../common/Avatar';\nimport Icon from '../../../common/icons/Icon';\nimport SafeLink from '../../../common/SafeLink';\nimport Button from '../../../ui/Button';\nimport Modal from '../../../ui/Modal';\nimport StarTopupOptionList from '../StarTopupOptionList';\n\nimport styles from './StarsGiftModal.module.scss';\n\nimport StarLogo from '../../../../assets/icons/GoldStar.svg';\nimport StarsBackground from '../../../../assets/stars-bg.png';\n\nexport type OwnProps = {\n  modal: TabState['starsGiftModal'];\n};\n\ntype StateProps = {\n  user?: ApiUser;\n};\n\nconst AVATAR_SIZE = 100;\n\nconst StarsGiftModal: FC<OwnProps & StateProps> = ({\n  modal,\n  user,\n}) => {\n  const {\n    closeStarsGiftModal, openInvoice, requestConfetti,\n  } = getActions();\n  const dialogRef = useRef<HTMLDivElement>();\n\n  const isOpen = Boolean(modal?.isOpen);\n\n  const renderingModal = useCurrentOrPrev(modal);\n\n  const oldLang = useOldLang();\n\n  const [selectedOption, setSelectedOption] = useState<ApiStarTopupOption | undefined>();\n  const [isHeaderHidden, setHeaderHidden] = useState(true);\n\n  useEffect(() => {\n    if (!isOpen) {\n      setHeaderHidden(true);\n    }\n  }, [isOpen]);\n\n  const showConfetti = useLastCallback(() => {\n    const dialog = dialogRef.current;\n    if (!dialog) return;\n    if (isOpen) {\n      const {\n        top, left, width, height,\n      } = dialog.querySelector('.modal-content')!.getBoundingClientRect();\n      requestConfetti({\n        top,\n        left,\n        width,\n        height,\n        withStars: true,\n      });\n    }\n  });\n\n  useEffect(() => {\n    if (renderingModal?.isCompleted) {\n      showConfetti();\n    }\n  }, [renderingModal, showConfetti]);\n\n  const handleClick = useLastCallback((option: ApiStarTopupOption) => {\n    if (!renderingModal) return;\n\n    setSelectedOption(option);\n    if (user) {\n      openInvoice({\n        type: 'starsgift',\n        userId: user.id,\n        stars: option.stars,\n        currency: option.currency,\n        amount: option.amount,\n      });\n    } else {\n      openInvoice({\n        type: 'stars',\n        stars: option.stars,\n        currency: option.currency,\n        amount: option.amount,\n      });\n    }\n  });\n\n  function handleScroll(e: React.UIEvent<HTMLDivElement>) {\n    const { scrollTop } = e.currentTarget;\n\n    setHeaderHidden(scrollTop <= 150);\n  }\n\n  const handleClose = useLastCallback(() => {\n    closeStarsGiftModal();\n  });\n\n  function renderGiftTitle() {\n    if (renderingModal?.isCompleted) {\n      return user ? renderText(oldLang('Notification.StarsGift.SentYou',\n        formatCurrencyAsString(selectedOption!.amount, selectedOption!.currency, oldLang.code)), ['simple_markdown'])\n        : renderText(oldLang('StarsAcquiredInfo', selectedOption?.stars), ['simple_markdown']);\n    }\n\n    return user ? oldLang('GiftStarsTitle') : oldLang('Star.List.GetStars');\n  }\n\n  const bottomText = useMemo(() => {\n    const text = oldLang('lng_credits_summary_options_about');\n    const parts = text.split('{link}');\n    return [\n      parts[0],\n      <SafeLink\n        url={oldLang('StarsTOSLink')}\n        text={oldLang('lng_credits_summary_options_about_link')}\n      />,\n      parts[1],\n    ];\n  }, [oldLang]);\n\n  return (\n    <Modal\n      className={buildClassName(styles.modalDialog)}\n      contentClassName={styles.content}\n      dialogRef={dialogRef}\n      isSlim\n      onClose={handleClose}\n      isOpen={isOpen}\n    >\n      <div className={buildClassName(styles.main, 'custom-scroll')} onScroll={handleScroll}>\n        <Button\n          round\n          size=\"smaller\"\n          className={styles.closeButton}\n          color=\"translucent\"\n\n          onClick={() => closeStarsGiftModal()}\n          ariaLabel={oldLang('Close')}\n        >\n          <Icon name=\"close\" />\n        </Button>\n        <div className={buildClassName(styles.header, isHeaderHidden && styles.hiddenHeader)}>\n          <h2 className={styles.starHeaderText}>\n            {user ? oldLang('GiftStarsTitle') : oldLang('Star.List.GetStars')}\n          </h2>\n        </div>\n        <div className={styles.headerInfo}>\n          {user ? (\n            <>\n              <Avatar\n                size={AVATAR_SIZE}\n                peer={user}\n                className={styles.avatar}\n              />\n              <img className={styles.logoBackground} src={StarsBackground} alt=\"\" draggable={false} />\n            </>\n          ) : (\n            <>\n              <img className={styles.logo} src={StarLogo} alt=\"\" draggable={false} />\n              <img className={styles.logoBackground} src={StarsBackground} alt=\"\" draggable={false} />\n            </>\n          )}\n        </div>\n        <h2 className={buildClassName(styles.headerText, styles.center)}>\n          {renderGiftTitle()}\n        </h2>\n        <p className={styles.description}>\n          {user ? renderText(\n            oldLang('ActionGiftStarsSubtitle', getPeerTitle(oldLang, user)), ['simple_markdown'],\n          ) : oldLang('Stars.Purchase.GetStarsInfo')}\n        </p>\n        <div className={styles.section}>\n          <StarTopupOptionList\n            options={renderingModal?.starsGiftOptions}\n            onClick={handleClick}\n          />\n          <div className={styles.secondaryInfo}>\n            {bottomText}\n          </div>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global, { modal }): Complete<StateProps> => {\n  const user = modal?.forUserId ? selectUser(global, modal.forUserId) : undefined;\n\n  return {\n    user,\n  };\n})(StarsGiftModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"s3k01dTm\",\"transition\":\"BNA0_b5j\",\"main\":\"Oadi16vt\",\"filter\":\"z84KbvhX\",\"title\":\"Jnsrau29\",\"buttons\":\"NnVyYB32\",\"picker\":\"cuI2eDIY\",\"avatars\":\"ILtw_aNL\",\"center\":\"eIfMzHv5\",\"description\":\"FlNJWZ5P\",\"premiumFeatures\":\"xIv0Yaur\",\"options\":\"eNJRXn6P\",\"button\":\"KDNKXBp5\"};","import type { FC } from '../../../lib/teact/teact';\nimport {\n  memo, useMemo,\n  useState,\n} from '../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../global';\n\nimport { SERVICE_NOTIFICATIONS_USER_ID } from '../../../config';\nimport {\n  isDeletedUser, isUserBot,\n} from '../../../global/helpers';\nimport { filterPeersByQuery } from '../../../global/helpers/peers';\nimport { unique } from '../../../util/iteratees';\nimport sortChatIds from '../../common/helpers/sortChatIds';\n\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport PeerPicker from '../../common/pickers/PeerPicker';\nimport PickerModal from '../../common/pickers/PickerModal';\n\nimport styles from './StarsGiftingPickerModal.module.scss';\n\nexport type OwnProps = {\n  isOpen?: boolean;\n};\n\ninterface StateProps {\n  currentUserId?: string;\n  userIds?: string[];\n  activeListIds?: string[];\n  archivedListIds?: string[];\n}\n\nconst StarsGiftingPickerModal: FC<OwnProps & StateProps> = ({\n  isOpen,\n  currentUserId,\n  activeListIds,\n  archivedListIds,\n  userIds,\n}) => {\n  const { closeStarsGiftingPickerModal, openStarsGiftModal } = getActions();\n\n  const oldLang = useOldLang();\n\n  const [searchQuery, setSearchQuery] = useState<string>('');\n\n  const displayedUserIds = useMemo(() => {\n    const usersById = getGlobal().users.byId;\n    const combinedIds = unique([\n      ...(userIds || []),\n      ...(activeListIds || []),\n      ...(archivedListIds || []),\n    ]);\n\n    const filteredUserIds = filterPeersByQuery({\n      ids: combinedIds, query: searchQuery, type: 'user',\n    });\n\n    return sortChatIds(filteredUserIds.filter((id) => {\n      const user = usersById[id];\n\n      if (!user) {\n        return false;\n      }\n\n      return !user.isSupport\n        && !isUserBot(user) && !isDeletedUser(user)\n        && id !== currentUserId && id !== SERVICE_NOTIFICATIONS_USER_ID;\n    }));\n  }, [currentUserId, searchQuery, userIds, activeListIds, archivedListIds]);\n\n  const handleSelectedUserIdsChange = useLastCallback((newSelectedId?: string) => {\n    if (newSelectedId?.length) {\n      openStarsGiftModal({ forUserId: newSelectedId });\n      closeStarsGiftingPickerModal();\n    }\n  });\n\n  return (\n    <PickerModal\n      className={styles.root}\n      isOpen={isOpen}\n      onClose={closeStarsGiftingPickerModal}\n      title={oldLang('GiftStarsTitle')}\n      hasCloseButton\n      shouldAdaptToSearch\n      withFixedHeight\n      confirmButtonText={oldLang('Continue')}\n      onEnter={closeStarsGiftingPickerModal}\n    >\n      <PeerPicker\n        className={styles.picker}\n        itemIds={displayedUserIds}\n        filterValue={searchQuery}\n        filterPlaceholder={oldLang('Search')}\n        onFilterChange={setSearchQuery}\n        isSearchable\n        withDefaultPadding\n        withStatus\n        onSelectedIdChange={handleSelectedUserIdsChange}\n      />\n    </PickerModal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global): Complete<StateProps> => {\n  const {\n    chats: {\n      listIds,\n    },\n    currentUserId,\n  } = global;\n\n  return {\n    userIds: global.contactList?.userIds,\n    activeListIds: listIds.active,\n    archivedListIds: listIds.archived,\n    currentUserId,\n  };\n})(StarsGiftingPickerModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"TtE8LQNJ\",\"minimal\":\"nkV4JXHc\",\"transition\":\"nXQS4E59\",\"main\":\"JuWZY1ds\",\"container\":\"mnhBs1uK\",\"section\":\"lYkNd_gb\",\"lastSection\":\"f749AI4g\",\"sectionTitle\":\"FF8gm7MP\",\"hint\":\"Rs8WXoOz\",\"tos\":\"Vu6blJk9\",\"topUpButton\":\"dc_DZoVF\",\"tonBalanceContainer\":\"lorbW9II\",\"tonBalance\":\"h2Fs3tOv\",\"tonIconBalance\":\"Ut6GidJP\",\"tonInUsd\":\"FdcdsB4l\",\"tonIconLogo\":\"_hCjjyEv\",\"description\":\"teXilLxe\",\"header\":\"fnhXotO2\",\"starHeaderText\":\"iUwego5s\",\"botItem\":\"AhxcrKWn\",\"hiddenHeader\":\"DZk6d6hF\",\"closeButton\":\"piD1PXHW\",\"addStarsButton\":\"dqnGL2uh\",\"addStarsIcon\":\"w9Db2eiK\",\"balanceBlock\":\"Yk0OQBKC\",\"balanceInfo\":\"p2dW9NOV\",\"smallerText\":\"rUnPcfmE\",\"balanceBottom\":\"F5BTkZ9G\",\"modalBalance\":\"t8tMrx3y\",\"starButton\":\"oOt4VBD2\",\"paymentContent\":\"OReEUNTV\",\"paymentImages\":\"oKorQYTC\",\"paymentPhoto\":\"HGTrEtUF\",\"avatarStar\":\"Wu10dXoa\",\"paymentImageBackground\":\"os8jb_qv\",\"paymentButton\":\"VzR5cibf\",\"paymentButtonStar\":\"Uhg7yWxK\",\"transactions\":\"Qvc0fTTH\",\"subscriptions\":\"IX5BhCUF\",\"tabs\":\"KZVEyKOX\",\"disclaimer\":\"bpVifdwH\",\"amountBadge\":\"BPM7LKwo\",\"loadMore\":\"TKmZjMyd\",\"loadMoreIcon\":\"buepwtN1\"};","import { memo } from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport type { ApiTypeCurrencyAmount } from '../../../api/types';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../../../config';\nimport { formatStarsAmount } from '../../../global/helpers/payments';\nimport buildClassName from '../../../util/buildClassName';\nimport { convertCurrencyFromBaseUnit } from '../../../util/formatCurrency';\n\nimport useLang from '../../../hooks/useLang';\n\nimport BadgeButton from '../../common/BadgeButton';\nimport Icon from '../../common/icons/Icon';\nimport StarIcon from '../../common/icons/StarIcon';\n\nimport styles from './StarsBalanceModal.module.scss';\n\ntype OwnProps = {\n  balance?: ApiTypeCurrencyAmount;\n  withAddButton?: boolean;\n  className?: string;\n};\n\nconst BalanceBlock = ({ balance, className, withAddButton }: OwnProps) => {\n  const lang = useLang();\n\n  const {\n    openStarsBalanceModal,\n  } = getActions();\n\n  const renderStarsAmount = () => {\n    return (\n      <>\n        <StarIcon type=\"gold\" size=\"middle\" />\n        {balance !== undefined && balance.currency === STARS_CURRENCY_CODE\n          ? formatStarsAmount(lang, balance) : ''}\n        {withAddButton && (\n          <BadgeButton\n            className={styles.addStarsButton}\n            onClick={() => openStarsBalanceModal({})}\n          >\n            <Icon\n              className={styles.addStarsIcon}\n              name=\"add\"\n            />\n          </BadgeButton>\n        )}\n      </>\n    );\n  };\n\n  const renderTonAmount = () => {\n    return (\n      <>\n        <Icon name=\"toncoin\" />\n        {balance !== undefined ? convertCurrencyFromBaseUnit(balance.amount, balance.currency) : ''}\n      </>\n    );\n  };\n\n  return (\n    <div className={buildClassName(styles.balanceBlock, className)}>\n      <div className={styles.balanceInfo}>\n        <span className={styles.smallerText}>{lang('StarsBalance')}</span>\n        <div className={styles.balanceBottom}>\n          {balance?.currency === TON_CURRENCY_CODE ? renderTonAmount() : renderStarsAmount()}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(BalanceBlock);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"ZXnbeQxP\",\"info\":\"zLaaDX3c\",\"status\":\"HbF2qTB2\",\"statusPricing\":\"AveGvpdV\",\"amount\":\"_CBiOQcv\",\"title\":\"k9ZIv5Pd\",\"description\":\"FlRlxMx2\",\"subtitle\":\"YN2J8dw6\",\"statusPeriod\":\"MRrP7Oew\",\"statusEnded\":\"pRHwfr8m\",\"preview\":\"t6Syyhzd\",\"subscriptionStar\":\"ftlbevPm\"};","import { memo } from '../../../../lib/teact/teact';\nimport { getActions } from '../../../../global';\n\nimport type {\n  ApiStarsSubscription,\n} from '../../../../api/types';\nimport type { GlobalState } from '../../../../global/types';\n\nimport { getPeerTitle } from '../../../../global/helpers/peers';\nimport { selectPeer } from '../../../../global/selectors';\nimport { formatDateToString } from '../../../../util/dates/dateFormat';\nimport { formatInteger } from '../../../../util/textFormat';\nimport renderText from '../../../common/helpers/renderText';\n\nimport useSelector from '../../../../hooks/data/useSelector';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useOldLang from '../../../../hooks/useOldLang';\n\nimport Avatar from '../../../common/Avatar';\nimport StarIcon from '../../../common/icons/StarIcon';\n\nimport styles from './StarsSubscriptionItem.module.scss';\n\ntype OwnProps = {\n  subscription: ApiStarsSubscription;\n};\n\nfunction selectProvidedPeer(peerId: string) {\n  return (global: GlobalState) => (\n    selectPeer(global, peerId)\n  );\n}\n\nconst StarsSubscriptionItem = ({ subscription }: OwnProps) => {\n  const { openStarsSubscriptionModal } = getActions();\n  const {\n    peerId, pricing, until, isCancelled, title, photo,\n  } = subscription;\n  const lang = useOldLang();\n\n  const peer = useSelector(selectProvidedPeer(peerId))!;\n\n  const handleClick = useLastCallback(() => {\n    openStarsSubscriptionModal({ subscription });\n  });\n\n  if (!peer) {\n    return undefined;\n  }\n\n  const hasExpired = until < Date.now() / 1000;\n  const formattedDate = formatDateToString(until * 1000, lang.code, true, 'long');\n\n  return (\n    <div className={styles.root} onClick={handleClick}>\n      <div className={styles.preview}>\n        <Avatar size=\"medium\" peer={peer} />\n        <StarIcon className={styles.subscriptionStar} type=\"gold\" size=\"small\" />\n      </div>\n      <div className={styles.info}>\n        <h3 className={styles.title}>{renderText(getPeerTitle(lang, peer) || '')}</h3>\n        {title && (\n          <p className={styles.subtitle}>\n            {photo && <Avatar webPhoto={photo} size=\"micro\" />}\n            {renderText(title)}\n          </p>\n        )}\n        <p className={styles.description}>\n          {lang(\n            hasExpired ? 'StarsSubscriptionExpired'\n              : isCancelled ? 'StarsSubscriptionExpires' : 'StarsSubscriptionRenews',\n            formattedDate,\n          )}\n        </p>\n      </div>\n      <div className={styles.status}>\n        {(isCancelled || hasExpired) ? (\n          <div className={styles.statusEnded}>\n            {lang(hasExpired ? 'StarsSubscriptionStatusExpired' : 'StarsSubscriptionStatusCancelled')}\n          </div>\n        ) : (\n          <>\n            <div className={styles.statusPricing}>\n              <StarIcon className={styles.star} type=\"gold\" size=\"adaptive\" />\n              <span className={styles.amount}>\n                {formatInteger(pricing.amount)}\n              </span>\n            </div>\n            <div className={styles.statusPeriod}>{lang('StarsParticipantSubscriptionPerMonth')}</div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(StarsSubscriptionItem);\n","import type { ApiStarsAmount, ApiStarsTransaction, ApiTypeCurrencyAmount } from '../../../../api/types';\nimport type { OldLangFn } from '../../../../hooks/useOldLang';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../../../../config';\nimport { buildStarsTransactionCustomPeer, shouldUseCustomPeer } from '../../../../global/helpers/payments';\nimport {\n  type LangFn,\n} from '../../../../util/localization';\nimport { formatPercent } from '../../../../util/textFormat';\n\nexport function getTransactionTitle(oldLang: OldLangFn, lang: LangFn, transaction: ApiStarsTransaction) {\n  if (transaction.paidMessages) {\n    return lang(\n      'PaidMessageTransaction',\n      { count: transaction.paidMessages },\n      {\n        withNodes: true,\n        pluralValue: transaction.paidMessages,\n      },\n    );\n  }\n\n  if (transaction.isGiftResale) {\n    return isNegativeAmount(transaction.amount)\n      ? lang('StarGiftSaleTransaction')\n      : lang('StarGiftPurchaseTransaction');\n  }\n  if (transaction.isPostsSearch) {\n    return lang('PostsSearchTransaction');\n  }\n\n  if (transaction.isDropOriginalDetails) {\n    return lang('DropOriginalDetailsTransaction');\n  }\n\n  if (transaction.isPrepaidUpgrade) {\n    return lang('GiftPrepaidUpgradeTransactionTitle');\n  }\n\n  if (transaction.starRefCommision) {\n    return oldLang('StarTransactionCommission', formatPercent(transaction.starRefCommision));\n  }\n  if (transaction.isGiftUpgrade) return oldLang('Gift2TransactionUpgraded');\n  if (transaction.extendedMedia) return oldLang('StarMediaPurchase');\n  if (transaction.subscriptionPeriod) return transaction.title || oldLang('StarSubscriptionPurchase');\n  if (transaction.isReaction) return oldLang('StarsReactionsSent');\n  if (transaction.giveawayPostId) return oldLang('StarsGiveawayPrizeReceived');\n  if (transaction.isMyGift) return oldLang('StarsGiftSent');\n  if (transaction.isGift) {\n    if (transaction.amount.currency === TON_CURRENCY_CODE) {\n      return lang('TonGiftReceived');\n    }\n    return oldLang('StarsGiftReceived');\n  }\n  if (transaction.starGift) {\n    return isNegativeAmount(transaction.amount) ? oldLang('Gift2TransactionSent') : oldLang('Gift2ConvertedTitle');\n  }\n\n  const customPeer = (transaction.peer && shouldUseCustomPeer(transaction)\n    && buildStarsTransactionCustomPeer(transaction)) || undefined;\n\n  if (customPeer) return customPeer.title || oldLang(customPeer.titleKey!);\n\n  return transaction.title;\n}\n\nexport function isNegativeStarsAmount(starsAmount: ApiStarsAmount) {\n  if (starsAmount.amount) return starsAmount.amount < 0;\n  return starsAmount.nanos < 0;\n}\n\nexport function isNegativeAmount(currencyAmount: ApiTypeCurrencyAmount) {\n  if (currencyAmount.currency === STARS_CURRENCY_CODE) {\n    return isNegativeStarsAmount(currencyAmount);\n  }\n  return currencyAmount.amount < 0;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"jQkp75Gb\",\"preview\":\"OYGSN3PF\",\"count\":\"KX1yz2Jy\",\"thumb\":\"EvinKr5k\",\"noOutline\":\"KSAAsUDv\",\"itemCount1\":\"GxDajfX_\",\"itemCount2\":\"jXuZoxq8\",\"itemCount3\":\"TPn3XGHJ\",\"blurry\":\"hWZuxLS8\",\"full\":\"w56QPFhl\",\"fadeIn\":\"ds43W8Wq\"};","import { memo } from '../../../../lib/teact/teact';\n\nimport type { ApiMediaExtendedPreview, BoughtPaidMedia } from '../../../../api/types';\n\nimport { getMediaHash, getMediaThumbUri } from '../../../../global/helpers';\nimport buildClassName from '../../../../util/buildClassName';\n\nimport useMedia from '../../../../hooks/useMedia';\n\nimport Icon from '../../../common/icons/Icon';\nimport MediaSpoiler from '../../../common/MediaSpoiler';\n\nimport styles from './PaidMediaThumb.module.scss';\n\ntype OwnProps = {\n  className?: string;\n  media: ApiMediaExtendedPreview[] | BoughtPaidMedia[];\n  isTransactionPreview?: boolean;\n  onClick?: NoneToVoidFunction;\n};\n\nconst THUMB_LIMIT = 3;\nconst PREVIEW_THUMB_LIMIT = 2;\n\nconst PaidMediaThumb = ({\n  media, className, isTransactionPreview, onClick,\n}: OwnProps) => {\n  const count = Math.min(media.length, isTransactionPreview ? PREVIEW_THUMB_LIMIT : THUMB_LIMIT);\n  const isLocked = 'mediaType' in media[0];\n  return (\n    <div\n      className={buildClassName(\n        styles.root,\n        styles[`itemCount${count}`],\n        isTransactionPreview && styles.preview,\n        className,\n      )}\n      dir=\"rtl\"\n      onClick={onClick}\n    >\n      {media.slice(0, count).reverse().map((item, i, arr) => {\n        const realIndex = arr.length - i - 1;\n        return 'mediaType' in item ? (\n          <MediaSpoiler\n            className={styles.thumb}\n            isVisible\n            width={item.width}\n            height={item.height}\n            thumbDataUri={item.thumbnail?.dataUri}\n          />\n        ) : (\n          <SingleMediaThumb\n            className={buildClassName(isTransactionPreview && realIndex > 0 && styles.noOutline)}\n            boughtMedia={item}\n            index={realIndex}\n          />\n        );\n      })}\n      {isLocked && (\n        <div className={styles.count}>\n          <Icon name=\"stars-lock\" />\n          {media.length > 1 ? media.length : ''}\n        </div>\n      )}\n    </div>\n  );\n};\n\nfunction SingleMediaThumb({\n  boughtMedia,\n  index,\n  className,\n}: {\n  boughtMedia: BoughtPaidMedia;\n  index?: number;\n  className?: string;\n}) {\n  const media = (boughtMedia.video || boughtMedia.photo)!;\n  const mediaHash = getMediaHash(media, 'pictogram');\n  const thumb = getMediaThumbUri(media);\n\n  const mediaBlob = useMedia(mediaHash);\n\n  return (\n    <div className={buildClassName(styles.thumb, index !== undefined && `stars-transaction-media-${index}`, className)}>\n      {thumb && <img className={styles.blurry} src={thumb} alt=\"\" />}\n      {mediaBlob && <img className={styles.full} src={mediaBlob} alt=\"\" />}\n    </div>\n  );\n}\n\nexport default memo(PaidMediaThumb);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"aHAxv_Jg\",\"info\":\"oyYrn3II\",\"stars\":\"K5lc75ku\",\"amount\":\"QLQPuLAr\",\"title\":\"e0pK8CJ_\",\"description\":\"xbERdDMQ\",\"date\":\"l6CwQ0Ev\",\"positive\":\"P_42_ZWR\",\"negative\":\"TGjnLJfH\",\"preview\":\"cnjGihOT\",\"subscriptionStar\":\"z43YvnDX\",\"uniqueGiftBackground\":\"eNvzMw2p\",\"giftSticker\":\"U3dqmnM4\"};","import { memo, useMemo } from '../../../../lib/teact/teact';\nimport { getActions } from '../../../../global';\n\nimport type {\n  ApiPeer,\n  ApiStarsTransaction,\n} from '../../../../api/types';\nimport type { GlobalState } from '../../../../global/types';\nimport type { CustomPeer } from '../../../../types';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../../../../config';\nimport { buildStarsTransactionCustomPeer,\n  formatStarsTransactionAmount,\n  shouldUseCustomPeer } from '../../../../global/helpers/payments';\nimport { getPeerTitle } from '../../../../global/helpers/peers';\nimport { selectPeer } from '../../../../global/selectors';\nimport buildClassName from '../../../../util/buildClassName';\nimport { formatDateTimeToString } from '../../../../util/dates/dateFormat';\nimport { CUSTOM_PEER_PREMIUM } from '../../../../util/objects/customPeer';\nimport { getGiftAttributes, getStickerFromGift } from '../../../common/helpers/gifts';\nimport renderText from '../../../common/helpers/renderText';\nimport { getTransactionTitle, isNegativeAmount } from '../helpers/transaction';\n\nimport useSelector from '../../../../hooks/data/useSelector';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useOldLang from '../../../../hooks/useOldLang';\n\nimport AnimatedIconFromSticker from '../../../common/AnimatedIconFromSticker';\nimport Avatar from '../../../common/Avatar';\nimport Icon from '../../../common/icons/Icon';\nimport StarIcon from '../../../common/icons/StarIcon';\nimport RadialPatternBackground from '../../../common/profile/RadialPatternBackground';\nimport PaidMediaThumb from './PaidMediaThumb';\n\nimport styles from './StarsTransactionItem.module.scss';\n\ntype OwnProps = {\n  transaction: ApiStarsTransaction;\n  className?: string;\n};\n\nconst GIFT_STICKER_SIZE = 36;\n\nfunction selectOptionalPeer(peerId?: string) {\n  return (global: GlobalState) => (\n    peerId ? selectPeer(global, peerId) : undefined\n  );\n}\n\nconst StarsTransactionItem = ({ transaction, className }: OwnProps) => {\n  const { openStarsTransactionModal } = getActions();\n  const {\n    date,\n    amount,\n    photo,\n    peer: transactionPeer,\n    extendedMedia,\n    subscriptionPeriod,\n  } = transaction;\n  const lang = useLang();\n  const oldLang = useOldLang();\n\n  const peerId = transactionPeer.type === 'peer' ? transactionPeer.id : undefined;\n  const peer = useSelector(selectOptionalPeer(peerId));\n  const starGift = transaction.starGift;\n  const isUniqueGift = starGift?.type === 'starGiftUnique';\n  const giftSticker = starGift && getStickerFromGift(starGift);\n\n  const data = useMemo(() => {\n    let title = getTransactionTitle(oldLang, lang, transaction);\n    let description;\n    let status: string | undefined;\n    let avatarPeer: ApiPeer | CustomPeer | undefined;\n\n    if (!shouldUseCustomPeer(transaction)) {\n      description = peer && getPeerTitle(oldLang, peer);\n      avatarPeer = peer || CUSTOM_PEER_PREMIUM;\n    } else {\n      const customPeer = buildStarsTransactionCustomPeer(transaction);\n      title = customPeer.title || oldLang(customPeer.titleKey!);\n      description = oldLang(customPeer.subtitleKey!);\n      avatarPeer = customPeer;\n    }\n\n    if ((transaction.isGiftUpgrade || transaction.isDropOriginalDetails)\n      && transaction.starGift?.type === 'starGiftUnique') {\n      description = lang('GiftUnique', { title: transaction.starGift.title, number: transaction.starGift.number });\n    }\n\n    if (transaction.isGiftResale && transaction.starGift?.type === 'starGiftUnique') {\n      description = lang('GiftUnique', { title: transaction.starGift.title, number: transaction.starGift.number });\n    }\n\n    if (transaction.isPostsSearch) {\n      title = getTransactionTitle(oldLang, lang, transaction);\n      description = undefined;\n    }\n\n    if (transaction.photo) {\n      avatarPeer = undefined;\n    }\n\n    if (transaction.isRefund) {\n      status = oldLang('StarsRefunded');\n    }\n\n    if (transaction.hasFailed) {\n      status = oldLang('StarsFailed');\n    }\n\n    if (transaction.isPending) {\n      status = oldLang('StarsPending');\n    }\n\n    return {\n      title,\n      description,\n      avatarPeer,\n      status,\n    };\n  }, [oldLang, lang, peer, transaction]);\n\n  const previewContent = useMemo(() => {\n    if (isUniqueGift) {\n      const { backdrop } = getGiftAttributes(starGift)!;\n      const backgroundColors = [backdrop!.centerColor, backdrop!.edgeColor];\n\n      return (\n        <>\n          <RadialPatternBackground\n            className={styles.uniqueGiftBackground}\n            backgroundColors={backgroundColors}\n          />\n          <AnimatedIconFromSticker\n            className={styles.giftSticker}\n            sticker={giftSticker}\n            size={GIFT_STICKER_SIZE}\n            play={false}\n          />\n        </>\n      );\n    }\n\n    if (giftSticker) {\n      return (\n        <AnimatedIconFromSticker\n          className={styles.giftSticker}\n          sticker={giftSticker}\n          size={GIFT_STICKER_SIZE}\n          play={false}\n        />\n      );\n    }\n\n    if (extendedMedia) {\n      return <PaidMediaThumb media={extendedMedia} isTransactionPreview />;\n    }\n\n    return (\n      <>\n        <Avatar size=\"medium\" webPhoto={photo} peer={data.avatarPeer} />\n        {Boolean(subscriptionPeriod) && (\n          <StarIcon className={styles.subscriptionStar} type=\"gold\" size=\"small\" />\n        )}\n      </>\n    );\n  }, [isUniqueGift, extendedMedia, photo, data.avatarPeer, subscriptionPeriod, starGift, giftSticker]);\n\n  const handleClick = useLastCallback(() => {\n    openStarsTransactionModal({ transaction });\n  });\n\n  const amountColorClass = isNegativeAmount(amount) ? styles.negative : styles.positive;\n\n  return (\n    <div className={buildClassName(styles.root, className)} onClick={handleClick}>\n      <div className={styles.preview}>\n        {previewContent}\n      </div>\n      <div className={styles.info}>\n        <h3 className={styles.title}>{data.title}</h3>\n        {data.description && (\n          <p className={styles.description}>{renderText(data.description)}</p>\n        )}\n        <p className={styles.date}>\n          {formatDateTimeToString(date * 1000, oldLang.code, true)}\n          {data.status && `  (${data.status})`}\n        </p>\n      </div>\n      <div className={styles.stars}>\n        <span\n          className={buildClassName(styles.amount, amountColorClass)}\n        >\n          {formatStarsTransactionAmount(lang, amount)}\n        </span>\n        {amount.currency === STARS_CURRENCY_CODE && <StarIcon className={styles.star} type=\"gold\" size=\"adaptive\" />}\n        {amount.currency === TON_CURRENCY_CODE && <Icon name=\"toncoin\" className={amountColorClass} />}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(StarsTransactionItem);\n","import { memo, useEffect, useMemo, useState } from '@teact';\nimport { getActions, getGlobal, withGlobal } from '../../../global';\n\nimport type { ApiStarTopupOption } from '../../../api/types';\nimport type { GlobalState, TabState } from '../../../global/types';\nimport type { AnimationLevel } from '../../../types';\nimport type { RegularLangKey } from '../../../types/language';\n\nimport {\n  PAID_MESSAGES_PURPOSE,\n  STARS_CURRENCY_CODE,\n  TON_CURRENCY_CODE,\n} from '../../../config';\nimport { getChatTitle, getUserFullName } from '../../../global/helpers';\nimport { getPeerTitle } from '../../../global/helpers/peers';\nimport { selectChat, selectIsPremiumPurchaseBlocked, selectUser } from '../../../global/selectors';\nimport { selectSharedSettings } from '../../../global/selectors/sharedState.ts';\nimport buildClassName from '../../../util/buildClassName';\nimport { convertCurrencyFromBaseUnit, convertTonToUsd, formatCurrencyAsString } from '../../../util/formatCurrency';\nimport { resolveTransitionName } from '../../../util/resolveTransitionName.ts';\nimport renderText from '../../common/helpers/renderText';\n\nimport useFlag from '../../../hooks/useFlag';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Icon from '../../common/icons/Icon';\nimport SafeLink from '../../common/SafeLink';\nimport Button from '../../ui/Button';\nimport InfiniteScroll from '../../ui/InfiniteScroll';\nimport Modal from '../../ui/Modal';\nimport TabList, { type TabWithProperties } from '../../ui/TabList';\nimport Transition from '../../ui/Transition';\nimport ParticlesHeader from '../common/ParticlesHeader.tsx';\nimport BalanceBlock from './BalanceBlock';\nimport StarTopupOptionList from './StarTopupOptionList';\nimport StarsSubscriptionItem from './subscription/StarsSubscriptionItem';\nimport StarsTransactionItem from './transaction/StarsTransactionItem';\n\nimport styles from './StarsBalanceModal.module.scss';\n\nconst TRANSACTION_TYPES = ['all', 'inbound', 'outbound'] as const;\nconst TRANSACTION_TABS_KEYS: RegularLangKey[] = [\n  'StarsTransactionsAll',\n  'StarsTransactionsIncoming',\n  'StarsTransactionsOutgoing',\n];\nconst TRANSACTION_ITEM_CLASS = 'StarsTransactionItem';\nconst SUBSCRIPTION_PURPOSE = 'subs';\n\nexport type OwnProps = {\n  modal: TabState['starsBalanceModal'];\n};\n\ntype StateProps = {\n  starsBalanceState?: GlobalState['stars'];\n  tonBalanceState?: GlobalState['ton'];\n  canBuyPremium?: boolean;\n  shouldForceHeight?: boolean;\n  tonUsdRate?: number;\n  tonTopupUrl: string;\n  animationLevel: AnimationLevel;\n};\n\nconst StarsBalanceModal = ({\n  modal, starsBalanceState, tonBalanceState, canBuyPremium, shouldForceHeight, tonUsdRate, tonTopupUrl, animationLevel,\n}: OwnProps & StateProps) => {\n  const {\n    closeStarsBalanceModal, loadStarsTransactions, loadStarsSubscriptions, openStarsGiftingPickerModal, openInvoice,\n    openUrl,\n  } = getActions();\n\n  const currency = modal?.currency || STARS_CURRENCY_CODE;\n  const currentState = currency === TON_CURRENCY_CODE ? tonBalanceState : starsBalanceState;\n  const { balance, history } = currentState || {};\n  const { subscriptions } = (currency === STARS_CURRENCY_CODE && starsBalanceState) || {};\n\n  const oldLang = useOldLang();\n  const lang = useLang();\n\n  const [isHeaderHidden, setHeaderHidden] = useState(true);\n  const [selectedTabIndex, setSelectedTabIndex] = useState(0);\n  const [areBuyOptionsShown, showBuyOptions, hideBuyOptions] = useFlag();\n\n  const isOpen = Boolean(modal && (starsBalanceState || tonBalanceState));\n\n  const {\n    originStarsPayment, originReaction, originGift, topup,\n  } = modal || {};\n\n  const shouldOpenOnBuy = originStarsPayment || originReaction || originGift || topup;\n\n  const ongoingTransactionAmount = originStarsPayment?.form?.invoice?.totalAmount\n    || originStarsPayment?.subscriptionInfo?.subscriptionPricing?.amount\n    || originReaction?.amount\n    || originGift?.gift.stars\n    || topup?.balanceNeeded;\n  const starsNeeded = ongoingTransactionAmount ? ongoingTransactionAmount - (balance?.amount || 0) : undefined;\n  const starsNeededText = useMemo(() => {\n    const global = getGlobal();\n\n    if (originReaction) {\n      const channel = selectChat(global, originReaction.chatId);\n      if (!channel) return undefined;\n      return oldLang('StarsNeededTextReactions', getChatTitle(oldLang, channel));\n    }\n\n    if (originStarsPayment) {\n      const bot = originStarsPayment.form?.botId ? selectUser(global, originStarsPayment.form.botId) : undefined;\n      if (!bot) return undefined;\n      return oldLang('StarsNeededText', getUserFullName(bot));\n    }\n\n    if (originGift) {\n      const peer = selectUser(global, originGift.peerId);\n      if (!peer) return undefined;\n      return oldLang('StarsNeededTextGift', getPeerTitle(lang, peer));\n    }\n\n    if (topup?.purpose === SUBSCRIPTION_PURPOSE) {\n      return oldLang('StarsNeededTextLink');\n    }\n\n    if (topup?.purpose === PAID_MESSAGES_PURPOSE) {\n      return lang('StarsNeededTextSendPaidMessages', undefined, {\n        withMarkdown: true,\n        withNodes: true,\n      });\n    }\n\n    return undefined;\n  }, [originReaction, originStarsPayment, originGift, topup?.purpose, lang, oldLang]);\n\n  const shouldShowItems = Boolean(history?.all?.transactions.length && !shouldOpenOnBuy);\n  const shouldSuggestGifting = !shouldOpenOnBuy;\n\n  const modalHeight = useMemo(() => {\n    const transactionCount = history?.all?.transactions.length || 0;\n    if (transactionCount === 1) {\n      return '35.5rem';\n    }\n    if (transactionCount === 2) {\n      return '39.25rem';\n    }\n    if (transactionCount === 3) {\n      return '43rem';\n    }\n    return '45rem';\n  }, [history?.all?.transactions.length]);\n\n  const transactionTabs: TabWithProperties[] = useMemo(() => {\n    return TRANSACTION_TABS_KEYS.map((key) => ({\n      title: lang(key),\n    }));\n  }, [lang]);\n\n  useEffect(() => {\n    if (!isOpen) {\n      setHeaderHidden(true);\n      setSelectedTabIndex(0);\n      hideBuyOptions();\n    }\n  }, [isOpen]);\n\n  useEffect(() => {\n    if (shouldOpenOnBuy) {\n      showBuyOptions();\n      return;\n    }\n\n    hideBuyOptions();\n  }, [shouldOpenOnBuy]);\n\n  const tosText = useMemo(() => {\n    if (!isOpen) return undefined;\n\n    const text = oldLang('lng_credits_summary_options_about');\n    const parts = text.split('{link}');\n    return [\n      parts[0],\n      <SafeLink url={oldLang('StarsTOSLink')} text={oldLang('lng_credits_summary_options_about_link')} />,\n      parts[1],\n    ];\n  }, [isOpen, oldLang]);\n\n  const renderStarsHeaderSection = () => {\n    return (\n      <>\n        <ParticlesHeader\n          model=\"swaying-star\"\n          color=\"gold\"\n          title={starsNeeded ? oldLang('StarsNeededTitle', ongoingTransactionAmount) : oldLang('TelegramStars')}\n          description={renderText(\n            starsNeededText || oldLang('TelegramStarsInfo'),\n            ['simple_markdown', 'emoji'],\n          )}\n          isDisabled={!isOpen}\n        />\n        {canBuyPremium && !areBuyOptionsShown && (\n          <Button\n            className={styles.starButton}\n            onClick={showBuyOptions}\n            fluid\n          >\n            {oldLang('Star.List.BuyMoreStars')}\n          </Button>\n        )}\n        {canBuyPremium && !areBuyOptionsShown && shouldSuggestGifting && (\n          <Button\n            isText\n            noForcedUpperCase\n            className={styles.starButton}\n            fluid\n            onClick={openStarsGiftingPickerModalHandler}\n          >\n            {oldLang('TelegramStarsGift')}\n          </Button>\n        )}\n        {areBuyOptionsShown && starsBalanceState?.topupOptions && (\n          <StarTopupOptionList\n            starsNeeded={starsNeeded}\n            options={starsBalanceState.topupOptions}\n            onClick={handleBuyStars}\n          />\n        )}\n      </>\n    );\n  };\n\n  const renderTonHeaderSection = () => {\n    const tonAmount = convertCurrencyFromBaseUnit(balance?.amount || 0, TON_CURRENCY_CODE);\n    return (\n      <>\n        <ParticlesHeader\n          model=\"speeding-diamond\"\n          color=\"blue\"\n          title={lang('CurrencyTon')}\n          description={lang('DescriptionAboutTon')}\n          isDisabled={!isOpen}\n        />\n        <div className={styles.tonBalanceContainer}>\n          <div className={styles.tonBalance}>\n            <Icon name=\"toncoin\" className={styles.tonIconBalance} />\n            {tonAmount}\n          </div>\n          {Boolean(tonUsdRate) && (\n            <span className={styles.tonInUsd}>\n              {` ${formatCurrencyAsString(\n                convertTonToUsd(balance?.amount || 0, tonUsdRate, true),\n                'USD',\n                lang.code,\n              )}`}\n            </span>\n          )}\n        </div>\n        <Button\n          className={styles.topUpButton}\n          onClick={handleTonTopUp}\n          fluid\n        >\n          {lang('ButtonTopUpViaFragment')}\n        </Button>\n      </>\n    );\n  };\n\n  function handleScroll(e: React.UIEvent<HTMLDivElement>) {\n    const { scrollTop } = e.currentTarget;\n\n    setHeaderHidden(scrollTop <= 150);\n  }\n\n  const handleLoadMoreTransactions = useLastCallback(() => {\n    loadStarsTransactions({\n      type: TRANSACTION_TYPES[selectedTabIndex],\n      isTon: currency === TON_CURRENCY_CODE,\n    });\n  });\n\n  const handleLoadMoreSubscriptions = useLastCallback(() => {\n    loadStarsSubscriptions();\n  });\n\n  const openStarsGiftingPickerModalHandler = useLastCallback(() => {\n    openStarsGiftingPickerModal({});\n  });\n\n  const handleBuyStars = useLastCallback((option: ApiStarTopupOption) => {\n    openInvoice({\n      type: 'stars',\n      stars: option.stars,\n      currency: option.currency,\n      amount: option.amount,\n    });\n  });\n\n  const handleTonTopUp = useLastCallback(() => {\n    openUrl({ url: tonTopupUrl });\n  });\n\n  return (\n    <Modal\n      className={buildClassName(styles.root, !shouldForceHeight && !areBuyOptionsShown && styles.minimal)}\n      isOpen={isOpen}\n      onClose={closeStarsBalanceModal}\n      dialogStyle={`--modal-height: ${modalHeight}`}\n    >\n      <div className={buildClassName(styles.main, 'custom-scroll')} onScroll={handleScroll}>\n        <Button\n          round\n          size=\"smaller\"\n          className={styles.closeButton}\n          color=\"translucent\"\n\n          onClick={() => closeStarsBalanceModal()}\n          ariaLabel={lang('Close')}\n        >\n          <Icon name=\"close\" />\n        </Button>\n        {currency !== TON_CURRENCY_CODE && <BalanceBlock balance={balance} className={styles.modalBalance} />}\n        <div className={buildClassName(styles.header, isHeaderHidden && styles.hiddenHeader)}>\n          <h2 className={styles.starHeaderText}>\n            {oldLang('TelegramStars')}\n          </h2>\n        </div>\n        <div className={styles.section}>\n          {currency === TON_CURRENCY_CODE ? renderTonHeaderSection() : renderStarsHeaderSection()}\n        </div>\n        {areBuyOptionsShown && (\n          <div className={styles.tos}>\n            {tosText}\n          </div>\n        )}\n        {currency === TON_CURRENCY_CODE && (\n          <div className={styles.hint}>\n            {lang('TonModalHint')}\n          </div>\n        )}\n        {shouldShowItems && Boolean(subscriptions?.list.length) && (\n          <div className={styles.section}>\n            <h3 className={styles.sectionTitle}>{oldLang('StarMySubscriptions')}</h3>\n            <div className={styles.subscriptions}>\n              {subscriptions?.list.map((subscription) => (\n                <StarsSubscriptionItem\n                  key={subscription.id}\n                  subscription={subscription}\n                />\n              ))}\n              {subscriptions?.nextOffset && (\n                <Button\n                  isText\n                  disabled={subscriptions.isLoading}\n                  size=\"smaller\"\n                  noForcedUpperCase\n                  className={styles.loadMore}\n                  onClick={handleLoadMoreSubscriptions}\n                >\n                  <Icon name=\"down\" className={styles.loadMoreIcon} />\n                  {oldLang('StarMySubscriptionsExpand')}\n                </Button>\n              )}\n            </div>\n          </div>\n        )}\n        {shouldShowItems && (\n          <div className={styles.container}>\n            <div className={styles.lastSection}>\n              <Transition\n                name={resolveTransitionName('slideOptimized', animationLevel, undefined, lang.isRtl)}\n                activeKey={selectedTabIndex}\n                renderCount={TRANSACTION_TABS_KEYS.length}\n                shouldRestoreHeight\n                className={styles.transition}\n              >\n                <InfiniteScroll\n                  onLoadMore={handleLoadMoreTransactions}\n                  items={history?.[TRANSACTION_TYPES[selectedTabIndex]]?.transactions}\n                  scrollContainerClosest={`.${styles.main}`}\n                  itemSelector={`.${TRANSACTION_ITEM_CLASS}`}\n                  className={styles.transactions}\n                  noFastList\n                  noScrollRestoreOnTop\n                >\n                  {history?.[TRANSACTION_TYPES[selectedTabIndex]]?.transactions.map((transaction) => (\n                    <StarsTransactionItem\n                      key={`${transaction.id}-${transaction.isRefund}`}\n                      transaction={transaction}\n                      className={TRANSACTION_ITEM_CLASS}\n                    />\n                  ))}\n                </InfiniteScroll>\n              </Transition>\n            </div>\n            <TabList\n              className={styles.tabs}\n              tabClassName={styles.tab}\n              activeTab={selectedTabIndex}\n              tabs={transactionTabs}\n              onSwitchTab={setSelectedTabIndex}\n            />\n          </div>\n        )}\n      </div>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { modal }): Complete<StateProps> => {\n    const shouldForceHeight = modal?.currency === TON_CURRENCY_CODE\n      ? Boolean(global.ton?.history?.all?.transactions.length)\n      : Boolean(global.stars?.history?.all?.transactions.length);\n\n    return {\n      shouldForceHeight,\n      starsBalanceState: global.stars,\n      tonBalanceState: global.ton,\n      canBuyPremium: !selectIsPremiumPurchaseBlocked(global),\n      tonUsdRate: global.appConfig.tonUsdRate,\n      tonTopupUrl: global.appConfig.tonTopupUrl,\n      animationLevel: selectSharedSettings(global).animationLevel,\n    };\n  },\n)(StarsBalanceModal));\n","import { memo, useEffect, useMemo } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type {\n  ApiChat, ApiMediaExtendedPreview, ApiMessage, ApiUser,\n} from '../../../api/types';\nimport type { GlobalState, TabState } from '../../../global/types';\n\nimport { getChatTitle, getCustomPeerFromInvite, getUserFullName } from '../../../global/helpers';\nimport {\n  selectChat, selectChatMessage, selectUser,\n} from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport { formatStarsAsIcon } from '../../../util/localization/format';\nimport { formatInteger } from '../../../util/textFormat';\nimport renderText from '../../common/helpers/renderText';\n\nimport useFlag from '../../../hooks/useFlag';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\nimport usePrevious from '../../../hooks/usePrevious';\n\nimport Avatar from '../../common/Avatar';\nimport StarIcon from '../../common/icons/StarIcon';\nimport PeerBadge from '../../common/PeerBadge';\nimport PeerChip from '../../common/PeerChip';\nimport SafeLink from '../../common/SafeLink';\nimport Button from '../../ui/Button';\nimport Modal from '../../ui/Modal';\nimport BalanceBlock from './BalanceBlock';\nimport PaidMediaThumb from './transaction/PaidMediaThumb';\n\nimport styles from './StarsBalanceModal.module.scss';\n\nimport StarsBackground from '../../../assets/stars-bg.png';\n\nexport type OwnProps = {\n  modal: TabState['starsPayment'];\n};\n\ntype StateProps = {\n  starsBalanceState?: GlobalState['stars'];\n  bot?: ApiUser;\n  paidMediaMessage?: ApiMessage;\n  paidMediaChat?: ApiChat;\n};\n\nconst StarPaymentModal = ({\n  modal,\n  bot,\n  starsBalanceState,\n  paidMediaMessage,\n  paidMediaChat,\n}: OwnProps & StateProps) => {\n  const { closeStarsPaymentModal, openStarsBalanceModal, sendStarPaymentForm } = getActions();\n  const [isLoading, markLoading, unmarkLoading] = useFlag();\n  const isOpen = Boolean(modal?.inputInvoice && starsBalanceState);\n\n  const prevModal = usePrevious(modal);\n  const renderingModal = modal || prevModal;\n\n  const { form, subscriptionInfo } = renderingModal || {};\n  const amount = form?.invoice?.totalAmount || subscriptionInfo?.subscriptionPricing?.amount;\n  const isBotSubscription = Boolean(form?.invoice.subscriptionPeriod);\n  const canShowPeerItem = !subscriptionInfo?.subscriptionPricing;\n\n  const photo = form?.photo;\n\n  const oldLang = useOldLang();\n  const lang = useLang();\n\n  useEffect(() => {\n    if (!isOpen) {\n      unmarkLoading();\n    }\n  }, [isOpen]);\n\n  const descriptionText = useMemo(() => {\n    if (!renderingModal?.inputInvoice) {\n      return '';\n    }\n\n    const botName = getUserFullName(bot);\n    const starsText = oldLang('Stars.Intro.PurchasedText.Stars', amount);\n\n    if (paidMediaMessage) {\n      const extendedMedia = paidMediaMessage.content.paidMedia!.extendedMedia as ApiMediaExtendedPreview[];\n      const areAllPhotos = extendedMedia.every((media) => !media.duration);\n      const areAllVideos = extendedMedia.every((media) => Boolean(media.duration));\n\n      const mediaText = areAllPhotos ? oldLang('Stars.Transfer.Photos', extendedMedia.length)\n        : areAllVideos ? oldLang('Stars.Transfer.Videos', extendedMedia.length)\n          : oldLang('Media', extendedMedia.length);\n\n      const channelTitle = getChatTitle(oldLang, paidMediaChat!);\n      return oldLang('Stars.Transfer.UnlockInfo', [mediaText, channelTitle, starsText]);\n    }\n\n    if (subscriptionInfo) {\n      return lang('StarsSubscribeText', {\n        chat: subscriptionInfo.title,\n        amount,\n      }, {\n        withNodes: true,\n        withMarkdown: true,\n        pluralValue: amount!,\n      });\n    }\n\n    if (isBotSubscription) {\n      return lang('StarsSubscribeBotText', {\n        name: form.title,\n        amount,\n        bot: botName,\n      }, {\n        pluralValue: amount!,\n      });\n    }\n\n    return oldLang('Stars.Transfer.Info', [form!.title, botName, starsText]);\n  }, [\n    renderingModal?.inputInvoice, bot, oldLang, amount, paidMediaMessage, subscriptionInfo, isBotSubscription, form,\n    paidMediaChat, lang,\n  ]);\n\n  const disclaimerText = useMemo(() => {\n    if (subscriptionInfo) {\n      return lang('StarsSubscribeInfo', {\n        link: <SafeLink url={lang('StarsSubscribeInfoLink')} text={lang('StarsSubscribeInfoLinkText')} />,\n      }, {\n        withNodes: true,\n      });\n    }\n\n    return undefined;\n  }, [subscriptionInfo, lang]);\n\n  const inviteCustomPeer = useMemo(() => {\n    if (!subscriptionInfo) {\n      return undefined;\n    }\n\n    return getCustomPeerFromInvite(subscriptionInfo);\n  }, [subscriptionInfo]);\n\n  const handlePayment = useLastCallback(() => {\n    const balance = starsBalanceState?.balance;\n    if (amount === undefined || balance === undefined) {\n      return;\n    }\n\n    if (amount > balance.amount) {\n      openStarsBalanceModal({\n        originStarsPayment: modal,\n      });\n      return;\n    }\n\n    sendStarPaymentForm({});\n    markLoading();\n  });\n\n  return (\n    <Modal\n      contentClassName={styles.paymentContent}\n      isOpen={isOpen}\n      hasAbsoluteCloseButton\n      isSlim\n      onClose={closeStarsPaymentModal}\n    >\n      <BalanceBlock balance={starsBalanceState?.balance} className={styles.modalBalance} />\n      <div className={styles.paymentImages} dir={lang.isRtl ? 'ltr' : 'rtl'}>\n        {paidMediaMessage ? (\n          <PaidMediaThumb media={paidMediaMessage.content.paidMedia!.extendedMedia} />\n        ) : inviteCustomPeer ? (\n          <>\n            <Avatar className={styles.paymentPhoto} peer={inviteCustomPeer} size=\"giant\" />\n            <StarIcon type=\"gold\" size=\"adaptive\" className={styles.avatarStar} />\n          </>\n        ) : (\n          <PeerBadge\n            peer={!photo ? bot : undefined}\n            avatarWebPhoto={photo}\n            avatarSize=\"giant\"\n            badgeIcon=\"star\"\n            badgeText={formatInteger(amount!)}\n            badgeClassName={styles.amountBadge}\n            className={styles.paymentPhoto}\n          />\n        )}\n        <img className={styles.paymentImageBackground} src={StarsBackground} alt=\"\" draggable={false} />\n      </div>\n      <h2 className={styles.headerText}>\n        {inviteCustomPeer ? oldLang('StarsSubscribeTitle') : oldLang('StarsConfirmPurchaseTitle')}\n      </h2>\n      {canShowPeerItem && <PeerChip className={styles.botItem} peerId={form?.botId} />}\n      <div className={styles.description}>\n        {renderText(descriptionText, ['simple_markdown', 'emoji'])}\n      </div>\n      <Button className={styles.paymentButton} onClick={handlePayment} isLoading={isLoading}>\n        {lang(isBotSubscription ? 'StarsSubscribeBotButtonMonth' : 'StarsPay', {\n          amount: formatStarsAsIcon(lang, amount!, { asFont: true }),\n        }, {\n          withNodes: true,\n        })}\n      </Button>\n      {Boolean(disclaimerText) && (\n        <div className={buildClassName(styles.disclaimer, styles.smallerText)}>\n          {disclaimerText}\n        </div>\n      )}\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { modal }): Complete<StateProps> => {\n    const bot = modal?.form?.botId ? selectUser(global, modal.form.botId) : undefined;\n\n    const messageInputInvoice = modal?.inputInvoice?.type === 'message' ? modal.inputInvoice : undefined;\n    const message = messageInputInvoice\n      ? selectChatMessage(global, messageInputInvoice.chatId, messageInputInvoice.messageId) : undefined;\n    const chat = messageInputInvoice ? selectChat(global, messageInputInvoice.chatId) : undefined;\n    const isPaidMedia = message?.content.paidMedia;\n\n    return {\n      bot,\n      starsBalanceState: global.stars,\n      paidMediaMessage: isPaidMedia ? message : undefined,\n      paidMediaChat: isPaidMedia ? chat : undefined,\n    };\n  },\n)(StarPaymentModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"manageButtons\":\"feHNN0j8\",\"manageButton\":\"biAUzmLA\",\"text\":\"hsDNs5hG\",\"icon\":\"APNjRx1K\"};","import { memo, useMemo } from '../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../global';\n\nimport type {\n  ApiEmojiStatusCollectible,\n  ApiEmojiStatusType,\n  ApiSavedStarGift,\n} from '../../../api/types';\n\nimport { DEFAULT_STATUS_ICON_ID } from '../../../config';\nimport { STARS_CURRENCY_CODE } from '../../../config';\nimport { selectTabState, selectUser } from '../../../global/selectors';\nimport { formatDateAtTime } from '../../../util/dates/dateFormat';\nimport { getServerTime } from '../../../util/serverTime';\n\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Button from '../../ui/Button';\n\nimport styles from './UniqueGiftManageButtons.module.scss';\n\ntype OwnProps = {\n  savedGift?: ApiSavedStarGift;\n};\n\ntype StateProps = {\n  currentUserEmojiStatus?: ApiEmojiStatusType;\n  collectibleEmojiStatuses?: ApiEmojiStatusType[];\n};\n\nconst UniqueGiftManageButtons = ({\n  savedGift,\n  currentUserEmojiStatus,\n  collectibleEmojiStatuses,\n}: OwnProps & StateProps) => {\n  const {\n    openGiftTransferModal,\n    openGiftResalePriceComposerModal,\n    openGiftStatusInfoModal,\n    setEmojiStatus,\n    updateStarGiftPrice,\n    showNotification,\n    closeGiftInfoModal,\n  } = getActions();\n\n  const lang = useLang();\n  const oldLang = useOldLang();\n\n  const gift = savedGift?.gift;\n  const isGiftUnique = gift?.type === 'starGiftUnique';\n  const giftResalePrice = isGiftUnique ? gift.resellPrice : undefined;\n\n  const global = getGlobal();\n  const modal = selectTabState(global).giftInfoModal;\n  const peerId = modal?.peerId;\n\n  const starGiftUniqueSlug = gift?.type === 'starGiftUnique' ? gift.slug : undefined;\n  const userCollectibleStatus = useMemo(() => {\n    if (!starGiftUniqueSlug) return undefined;\n    return collectibleEmojiStatuses?.find((status) =>\n      status.type === 'collectible' && status.slug === starGiftUniqueSlug,\n    ) as ApiEmojiStatusCollectible | undefined;\n  }, [starGiftUniqueSlug, collectibleEmojiStatuses]);\n\n  const currentUniqueEmojiStatusSlug = currentUserEmojiStatus?.type === 'collectible'\n    ? currentUserEmojiStatus.slug : undefined;\n  const canTakeOff = starGiftUniqueSlug !== undefined && currentUniqueEmojiStatusSlug === starGiftUniqueSlug;\n  const canWear = Boolean(userCollectibleStatus) && !canTakeOff;\n\n  const handleTransfer = useLastCallback(() => {\n    if (!savedGift || savedGift?.gift.type !== 'starGiftUnique') return;\n\n    if (savedGift.canTransferAt && savedGift.canTransferAt > getServerTime()) {\n      showNotification({\n        message: {\n          key: 'NotificationGiftCanTransferAt',\n          variables: { date: formatDateAtTime(oldLang, savedGift.canTransferAt * 1000) },\n        },\n      });\n      return;\n    }\n\n    openGiftTransferModal({ gift: savedGift });\n  });\n\n  const handleWear = useLastCallback(() => {\n    if (canTakeOff) {\n      setEmojiStatus({\n        emojiStatus: { type: 'regular', documentId: DEFAULT_STATUS_ICON_ID },\n      });\n    } else if (userCollectibleStatus) {\n      openGiftStatusInfoModal({ emojiStatus: userCollectibleStatus });\n    }\n  });\n\n  const handleSell = useLastCallback(() => {\n    if (!savedGift || !peerId) return;\n    if (savedGift.canResellAt && savedGift.canResellAt > getServerTime()) {\n      showNotification({\n        message: {\n          key: 'NotificationGiftCanResellAt',\n          variables: { date: formatDateAtTime(oldLang, savedGift.canResellAt * 1000) },\n        },\n      });\n      return;\n    }\n    openGiftResalePriceComposerModal({ peerId, gift: savedGift });\n  });\n\n  const handleUnlist = useLastCallback(() => {\n    if (!savedGift || savedGift.gift.type !== 'starGiftUnique' || !savedGift.inputGift) return;\n    closeGiftInfoModal();\n    updateStarGiftPrice({ gift: savedGift.inputGift, price: {\n      currency: STARS_CURRENCY_CODE, amount: 0, nanos: 0,\n    } });\n    showNotification({\n      icon: 'unlist-outline',\n      message: {\n        key: 'NotificationGiftIsUnlist',\n        variables: { gift: lang('GiftUnique', { title: savedGift.gift.title, number: savedGift.gift.number }) },\n      },\n    });\n  });\n\n  return (\n    <div className={styles.manageButtons}>\n      <Button\n        color=\"transparentBlured\"\n        iconName=\"gift-transfer-inline\"\n        iconAlignment=\"top\"\n        iconClassName={styles.icon}\n        onClick={handleTransfer}\n        ariaLabel={lang('GiftInfoTransfer')}\n        noForcedUpperCase\n        fluid\n        className={styles.manageButton}\n      >\n        <span className={styles.text}>\n          {lang('GiftInfoTransfer')}\n        </span>\n      </Button>\n      {(canWear || !canTakeOff) && (\n        <Button\n          color=\"transparentBlured\"\n          iconName={canTakeOff ? 'crown-take-off' : 'crown-wear'}\n          iconAlignment=\"top\"\n          iconClassName={styles.icon}\n          onClick={canWear || canTakeOff ? handleWear : undefined}\n          disabled={!canWear && !canTakeOff}\n          ariaLabel={lang(canTakeOff ? 'GiftInfoTakeOff' : 'GiftInfoWear')}\n          noForcedUpperCase\n          fluid\n          className={styles.manageButton}\n        >\n          <span className={styles.text}>\n            {lang(canTakeOff ? 'GiftInfoTakeOff' : 'GiftInfoWear')}\n          </span>\n        </Button>\n      )}\n      {!giftResalePrice && (\n        <Button\n          color=\"transparentBlured\"\n          iconName=\"sell\"\n          iconAlignment=\"top\"\n          iconClassName={styles.icon}\n          onClick={handleSell}\n          ariaLabel={lang('Sell')}\n          noForcedUpperCase\n          fluid\n          className={styles.manageButton}\n        >\n          <span className={styles.text}>\n            {lang('Sell')}\n          </span>\n        </Button>\n      )}\n      {Boolean(giftResalePrice) && (\n        <Button\n          color=\"transparentBlured\"\n          iconName=\"unlist\"\n          iconAlignment=\"top\"\n          iconClassName={styles.icon}\n          onClick={handleUnlist}\n          ariaLabel={lang('GiftInfoUnlist')}\n          noForcedUpperCase\n          fluid\n          className={styles.manageButton}\n        >\n          <span className={styles.text}>\n            {lang('GiftInfoUnlist')}\n          </span>\n        </Button>\n      )}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const { currentUserId } = global;\n    const currentUser = currentUserId ? selectUser(global, currentUserId) : undefined;\n    const currentUserEmojiStatus = currentUser?.emojiStatus;\n    const collectibleEmojiStatuses = global.collectibleEmojiStatuses?.statuses;\n\n    return {\n      currentUserEmojiStatus,\n      collectibleEmojiStatuses,\n    };\n  },\n)(UniqueGiftManageButtons));\n","import type { TeactNode } from '@teact';\nimport { memo, useMemo } from '@teact';\nimport { getActions } from '../../../global';\n\nimport type {\n  ApiPeer,\n  ApiSavedStarGift,\n  ApiStarGiftAttributeBackdrop, ApiStarGiftAttributeModel, ApiStarGiftAttributePattern,\n  ApiTypeCurrencyAmount } from '../../../api/types';\n\nimport {\n  formatStarsTransactionAmount,\n} from '../../../global/helpers/payments';\nimport { IS_TOUCH_ENV } from '../../../util/browser/windowEnvironment.ts';\nimport buildClassName from '../../../util/buildClassName';\nimport buildStyle from '../../../util/buildStyle';\nimport { REM } from '../../common/helpers/mediaDimensions.ts';\n\nimport { useTransitionActiveKey } from '../../../hooks/animations/useTransitionActiveKey';\nimport useFlag from '../../../hooks/useFlag';\nimport useLang from '../../../hooks/useLang';\n\nimport AnimatedIconFromSticker from '../../common/AnimatedIconFromSticker';\nimport Icon from '../../common/icons/Icon';\nimport StarIcon from '../../common/icons/StarIcon';\nimport RadialPatternBackground from '../../common/profile/RadialPatternBackground';\nimport Transition from '../../ui/Transition';\nimport UniqueGiftManageButtons from './UniqueGiftManageButtons';\n\nimport styles from './UniqueGiftHeader.module.scss';\n\ntype OwnProps = {\n  modelAttribute: ApiStarGiftAttributeModel;\n  backdropAttribute: ApiStarGiftAttributeBackdrop;\n  patternAttribute: ApiStarGiftAttributePattern;\n  title?: string;\n  subtitle?: TeactNode;\n  subtitlePeer?: ApiPeer;\n  className?: string;\n  resellPrice?: ApiTypeCurrencyAmount;\n  showManageButtons?: boolean;\n  savedGift?: ApiSavedStarGift;\n};\n\nconst STICKER_SIZE = 120;\n\nconst UniqueGiftHeader = ({\n  modelAttribute,\n  backdropAttribute,\n  patternAttribute,\n  title,\n  subtitle,\n  subtitlePeer,\n  className,\n  resellPrice,\n  showManageButtons,\n  savedGift,\n}: OwnProps) => {\n  const {\n    openChat,\n  } = getActions();\n\n  const lang = useLang();\n  const [isGiftHover, markGiftHover, unmarkGiftHover] = useFlag(false);\n  const activeKey = useTransitionActiveKey([modelAttribute, backdropAttribute, patternAttribute]);\n  const subtitleColor = backdropAttribute?.textColor;\n\n  const radialPatternBackdrop = useMemo(() => {\n    const backdropColors = [backdropAttribute.centerColor, backdropAttribute.edgeColor];\n\n    return (\n      <RadialPatternBackground\n        className={styles.radialPattern}\n        backgroundColors={backdropColors}\n        patternIcon={patternAttribute.sticker}\n        yPosition={6.5 * REM}\n      />\n    );\n  }, [backdropAttribute, patternAttribute]);\n\n  return (\n    <div className={buildClassName(styles.root,\n      isGiftHover && 'interactive-gift',\n      showManageButtons && styles.withManageButtons,\n      className)}\n    >\n      <Transition\n        className={styles.transition}\n        slideClassName={buildClassName(styles.transitionSlide)}\n        activeKey={activeKey}\n        direction={1}\n        name=\"zoomBounceSemiFade\"\n      >\n        {radialPatternBackdrop}\n        <AnimatedIconFromSticker\n          className={styles.sticker}\n          sticker={modelAttribute.sticker}\n          size={STICKER_SIZE}\n          noLoop={!isGiftHover}\n          onMouseEnter={!IS_TOUCH_ENV ? markGiftHover : undefined}\n          onMouseLeave={!IS_TOUCH_ENV ? unmarkGiftHover : undefined}\n        />\n      </Transition>\n      {title && <h1 className={styles.title}>{title}</h1>}\n      {Boolean(subtitle) && (\n        <div\n          className={buildClassName(styles.subtitle, subtitlePeer && styles.subtitleBadge)}\n          style={buildStyle(subtitleColor && `color: ${subtitleColor}`)}\n          onClick={() => {\n            if (subtitlePeer) {\n              openChat({ id: subtitlePeer.id });\n            }\n          }}\n        >\n          {subtitle}\n        </div>\n      )}\n      {savedGift && showManageButtons && (\n        <UniqueGiftManageButtons\n          savedGift={savedGift}\n        />\n      )}\n      {resellPrice && (\n        <p className={styles.amount}>\n          <span>\n            {formatStarsTransactionAmount(lang, resellPrice)}\n          </span>\n          {resellPrice.currency === 'XTR' && <StarIcon type=\"gold\" size=\"middle\" />}\n          {resellPrice.currency === 'TON' && <Icon name=\"toncoin\" />}\n        </p>\n      )}\n    </div>\n  );\n};\n\nexport default memo(UniqueGiftHeader);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"irv1C8bo\",\"withManageButtons\":\"QcTw5OSp\",\"sticker\":\"a1ASgPwu\",\"subtitleBadge\":\"V7kDVPLm\",\"radialPattern\":\"UvhsGZLf\",\"amount\":\"zTVWZg63\",\"transition\":\"Tu6_OHoq\",\"transitionSlide\":\"iUTKLzTN\",\"title\":\"ECTvfOda\",\"subtitle\":\"S6JwvHWD\"};","// extracted by mini-css-extract-plugin\nexport default {\"modal\":\"IzhfRIWu\",\"positive\":\"jvBZSrpd\",\"negative\":\"xDyq9cc0\",\"header\":\"qBOIq6Jn\",\"uniqueGift\":\"ApoQz22o\",\"amount\":\"sso9uZM6\",\"title\":\"ZZAj3hj7\",\"description\":\"NuWOY7ED\",\"tid\":\"tMF8VIOM\",\"refunded\":\"sxWAwxTd\",\"totalStars\":\"Z2YALGgl\",\"starIcon\":\"cU5QlvwL\",\"footer\":\"KgzPpgS6\",\"starsBackground\":\"nML8IQqX\",\"copyIcon\":\"voCttFzS\",\"mediaPreview\":\"C5r59yiV\",\"subtitle\":\"mFYcIYMJ\",\"starGiftSticker\":\"j3akHdtm\",\"avatar\":\"hcrszlpT\"};","import type { FC } from '../../../../lib/teact/teact';\nimport { memo, useMemo, useRef } from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type {\n  ApiPeer,\n  ApiStarsTransactionPeer, ApiSticker,\n} from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\nimport { MediaViewerOrigin } from '../../../../types';\n\nimport { STARS_CURRENCY_CODE } from '../../../../config';\nimport { getMessageLink } from '../../../../global/helpers';\nimport {\n  buildStarsTransactionCustomPeer,\n  formatStarsTransactionAmount,\n  shouldUseCustomPeer,\n} from '../../../../global/helpers/payments';\nimport {\n  selectCanPlayAnimatedEmojis,\n  selectGiftStickerForStars,\n  selectGiftStickerForTon,\n  selectPeer,\n} from '../../../../global/selectors';\nimport buildClassName from '../../../../util/buildClassName';\nimport { copyTextToClipboard } from '../../../../util/clipboard';\nimport { formatDateTimeToString } from '../../../../util/dates/dateFormat';\nimport { formatStarsAsIcon } from '../../../../util/localization/format';\nimport { formatPercent } from '../../../../util/textFormat';\nimport { getGiftAttributes, getStickerFromGift } from '../../../common/helpers/gifts';\nimport { getTransactionTitle, isNegativeAmount } from '../helpers/transaction';\n\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useOldLang from '../../../../hooks/useOldLang';\nimport usePrevious from '../../../../hooks/usePrevious';\n\nimport AnimatedIconFromSticker from '../../../common/AnimatedIconFromSticker';\nimport Avatar from '../../../common/Avatar';\nimport Icon from '../../../common/icons/Icon';\nimport StarIcon from '../../../common/icons/StarIcon';\nimport InteractiveSparkles from '../../../common/InteractiveSparkles';\nimport SafeLink from '../../../common/SafeLink';\nimport TableInfoModal, { type TableData } from '../../common/TableInfoModal';\nimport UniqueGiftHeader from '../../gift/UniqueGiftHeader';\nimport PaidMediaThumb from './PaidMediaThumb';\n\nimport styles from './StarsTransactionModal.module.scss';\n\nconst AVATAR_SPARKLES_CENTER_SHIFT = [0, -50] as const;\n\nexport type OwnProps = {\n  modal: TabState['starsTransactionModal'];\n};\n\ntype StateProps = {\n  peer?: ApiPeer;\n  canPlayAnimatedEmojis?: boolean;\n  topSticker?: ApiSticker;\n  paidMessageCommission?: number;\n};\n\nconst StarsTransactionModal: FC<OwnProps & StateProps> = ({\n  modal,\n  peer,\n  canPlayAnimatedEmojis,\n  topSticker,\n  paidMessageCommission,\n}) => {\n  const { showNotification, openMediaViewer, closeStarsTransactionModal } = getActions();\n\n  const lang = useLang();\n  const oldLang = useOldLang();\n  const { transaction } = modal || {};\n  const triggerSparklesRef = useRef<(() => void) | undefined>();\n\n  const handleOpenMedia = useLastCallback(() => {\n    const media = transaction?.extendedMedia;\n    if (!media) return;\n\n    openMediaViewer({\n      origin: MediaViewerOrigin.StarsTransaction,\n      standaloneMedia: media.flatMap((item) => Object.values(item)),\n    });\n  });\n\n  const handleAvatarMouseMove = useLastCallback(() => {\n    triggerSparklesRef.current?.();\n  });\n\n  const handleRequestAnimation = useLastCallback((animate: NoneToVoidFunction) => {\n    triggerSparklesRef.current = animate;\n  });\n\n  const starModalData = useMemo(() => {\n    if (!transaction) {\n      return undefined;\n    }\n\n    const {\n      giveawayPostId, photo, amount, isGiftUpgrade, isDropOriginalDetails, starGift, isGiftResale,\n      starRefCommision,\n    } = transaction;\n\n    const gift = transaction?.starGift;\n    const isUniqueGift = gift?.type === 'starGiftUnique';\n    const sticker = transaction?.starGift ? getStickerFromGift(transaction.starGift) : topSticker;\n\n    const giftAttributes = isUniqueGift ? getGiftAttributes(gift) : undefined;\n\n    const customPeer = (transaction.peer && shouldUseCustomPeer(transaction)\n      && buildStarsTransactionCustomPeer(transaction)) || undefined;\n\n    const peerId = transaction.peer?.type === 'peer' ? transaction.peer.id : undefined;\n    const toName = transaction.peer && oldLang(getStarsPeerTitleKey(transaction.peer));\n\n    const title = getTransactionTitle(oldLang, lang, transaction);\n\n    const messageLink = peer && transaction.messageId && !isGiftUpgrade && !isDropOriginalDetails\n      ? getMessageLink(peer, undefined, transaction.messageId) : undefined;\n    const giveawayMessageLink = peer && giveawayPostId ? getMessageLink(peer, undefined, giveawayPostId) : undefined;\n\n    const media = transaction.extendedMedia;\n\n    const mediaAmount = media?.length || 0;\n    const areAllPhotos = media?.every((m) => !m.video);\n    const areAllVideos = media?.every((m) => !m.photo);\n\n    const mediaText = areAllPhotos ? oldLang('Stars.Transfer.Photos', mediaAmount)\n      : areAllVideos ? oldLang('Stars.Transfer.Videos', mediaAmount)\n        : oldLang('Media', mediaAmount);\n\n    const description = transaction.description\n      || ((isGiftUpgrade || isDropOriginalDetails) && starGift?.type === 'starGiftUnique' ? starGift.title : undefined)\n      || (media ? mediaText : undefined);\n\n    const shouldDisplayAvatar = !media && !sticker && !transaction.isPostsSearch;\n    const avatarPeer = !photo ? ((!shouldUseCustomPeer(transaction) && peer) || customPeer) : undefined;\n\n    const uniqueGiftHeader = isUniqueGift && (\n      <div className={buildClassName(styles.header, styles.uniqueGift)}>\n        <UniqueGiftHeader\n          backdropAttribute={giftAttributes!.backdrop!}\n          patternAttribute={giftAttributes!.pattern!}\n          modelAttribute={giftAttributes!.model!}\n          title={gift.title}\n          subtitle={lang('GiftInfoCollectible', { number: gift.number })}\n          resellPrice={transaction.amount}\n        />\n      </div>\n    );\n\n    const amountColorClass = isNegativeAmount(amount) ? styles.negative : styles.positive;\n\n    const regularHeader = (\n      <div className={styles.header}>\n        {media && (\n          <PaidMediaThumb\n            className={buildClassName(styles.mediaPreview, 'transaction-media-preview')}\n            media={media}\n            onClick={handleOpenMedia}\n          />\n        )}\n        {!media && sticker && (\n          <AnimatedIconFromSticker\n            key={transaction.id}\n            sticker={sticker}\n            play={canPlayAnimatedEmojis}\n            noLoop\n          />\n        )}\n        {shouldDisplayAvatar && (\n          <Avatar\n            className={styles.avatar}\n            peer={avatarPeer}\n            webPhoto={photo}\n            size=\"giant\"\n            onMouseMove={handleAvatarMouseMove}\n          />\n        )}\n        {!sticker && !transaction.isPostsSearch && (\n          <InteractiveSparkles\n            className={buildClassName(styles.starsBackground)}\n            color=\"gold\"\n            onRequestAnimation={handleRequestAnimation}\n            centerShift={AVATAR_SPARKLES_CENTER_SHIFT}\n          />\n        )}\n        {Boolean(title) && <h1 className={styles.title}>{title}</h1>}\n        <p className={styles.description}>{description}</p>\n        <p className={styles.amount}>\n          <span\n            className={buildClassName(styles.amount, amountColorClass)}\n          >\n            {formatStarsTransactionAmount(lang, amount)}\n          </span>\n          {amount.currency === STARS_CURRENCY_CODE && <StarIcon type=\"gold\" size=\"middle\" />}\n          {amount.currency === 'TON' && <Icon name=\"toncoin\" className={amountColorClass} />}\n          {transaction.isRefund && (\n            <p className={styles.refunded}>{lang('Refunded')}</p>\n          )}\n        </p>\n        {Boolean(transaction.paidMessages && transaction.starRefCommision && paidMessageCommission) && (\n          <p className={styles.description}>\n            {lang(\n              'PaidMessageTransactionDescription',\n              { percent: formatPercent(paidMessageCommission! / 10) },\n              {\n                withNodes: true,\n                withMarkdown: true,\n              },\n            )}\n          </p>\n        )}\n      </div>\n    );\n\n    const tableData: TableData = [];\n\n    if (transaction && starRefCommision && !transaction.paidMessages && !isGiftResale) {\n      tableData.push([\n        oldLang('StarsTransaction.StarRefReason.Title'),\n        oldLang('StarsTransaction.StarRefReason.Program'),\n      ]);\n    }\n\n    if (isGiftUpgrade) {\n      tableData.push([\n        oldLang('StarGiftReason'),\n        oldLang('StarGiftReasonUpgrade'),\n      ]);\n    }\n\n    if (isDropOriginalDetails) {\n      tableData.push([\n        oldLang('StarGiftReason'),\n        lang('StarGiftReasonDropOriginalDetails'),\n      ]);\n    }\n\n    if (isGiftResale) {\n      tableData.push([\n        oldLang('StarGiftReason'),\n        isNegativeAmount(transaction.amount)\n          ? lang('StarGiftSaleTransaction')\n          : lang('StarGiftPurchaseTransaction'),\n      ]);\n    }\n\n    let peerLabel;\n    if (isGiftUpgrade) {\n      peerLabel = oldLang('Stars.Transaction.GiftFrom');\n    } else if (isNegativeAmount(amount) || transaction.isMyGift) {\n      peerLabel = oldLang('Stars.Transaction.To');\n    } else if (transaction.starRefCommision && !transaction.paidMessages && !isGiftResale) {\n      peerLabel = oldLang('StarsTransaction.StarRefReason.Miniapp');\n    } else if (peerId) {\n      peerLabel = oldLang('Star.Transaction.From');\n    } else {\n      peerLabel = oldLang('Stars.Transaction.Via');\n    }\n\n    if (!transaction.isPostsSearch && !isDropOriginalDetails) {\n      tableData.push([\n        peerLabel,\n        peerId ? { chatId: peerId } : toName || '',\n      ]);\n    }\n\n    if (transaction.starRefCommision && transaction.paidMessages) {\n      tableData.push([\n        lang('PaidMessageTransactionTotal'),\n        formatStarsAsIcon(lang,\n          transaction.amount.amount / ((100 - transaction.starRefCommision) / 100),\n          { asFont: false, className: styles.starIcon, containerClassName: styles.totalStars }),\n      ]);\n    }\n\n    if (messageLink) {\n      tableData.push([oldLang('Stars.Transaction.Reaction.Post'), <SafeLink url={messageLink} text={messageLink} />]);\n    }\n\n    if (giveawayMessageLink && transaction.amount.currency === STARS_CURRENCY_CODE) {\n      tableData.push([oldLang('BoostReason'), <SafeLink url={giveawayMessageLink} text={oldLang('Giveaway')} />]);\n      tableData.push([oldLang('Gift'), oldLang('Stars', transaction.amount, 'i')]);\n    }\n\n    if (transaction.id) {\n      tableData.push([\n        oldLang('Stars.Transaction.Id'),\n        (\n          <>\n            <div\n              className={styles.tid}\n              onClick={() => {\n                copyTextToClipboard(transaction.id!);\n                showNotification({\n                  message: oldLang('StarsTransactionIDCopied'),\n                });\n              }}\n            >\n              {transaction.id}\n            </div>\n            <Icon className={styles.copyIcon} name=\"copy\" />\n          </>\n        ),\n      ]);\n    }\n\n    tableData.push([\n      oldLang('Stars.Transaction.Date'),\n      formatDateTimeToString(transaction.date * 1000, oldLang.code, true),\n    ]);\n\n    const footerText = oldLang('lng_credits_box_out_about');\n    const footerTextParts = footerText.split('{link}');\n\n    const footer = (\n      <span className={styles.footer}>\n        {footerTextParts[0]}\n        <SafeLink url={oldLang('StarsTOSLink')} text={oldLang('lng_credits_summary_options_about_link')} />\n        {footerTextParts[1]}\n      </span>\n    );\n\n    return {\n      header: isUniqueGift ? uniqueGiftHeader : regularHeader,\n      tableData,\n      footer,\n    };\n  }, [transaction, oldLang, lang, peer, canPlayAnimatedEmojis, topSticker,\n    paidMessageCommission, handleRequestAnimation]);\n\n  const prevModalData = usePrevious(starModalData);\n  const renderingModalData = prevModalData || starModalData;\n\n  return (\n    <TableInfoModal\n      isOpen={Boolean(transaction)}\n      className={styles.modal}\n      hasBackdrop={transaction?.starGift?.type === 'starGiftUnique'}\n      header={renderingModalData?.header}\n      tableData={renderingModalData?.tableData}\n      footer={renderingModalData?.footer}\n      buttonText={oldLang('OK')}\n      onClose={closeStarsTransactionModal}\n    />\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { modal }): Complete<StateProps> => {\n    const peerId = modal?.transaction?.peer?.type === 'peer' && modal.transaction.peer.id;\n    const peer = peerId ? selectPeer(global, peerId) : undefined;\n    const paidMessageCommission = global.appConfig.starsPaidMessageCommissionPermille;\n\n    const currencyAmount = modal?.transaction.amount;\n    const starsGiftSticker = modal?.transaction.isGift\n      ? (currencyAmount?.currency === STARS_CURRENCY_CODE ? selectGiftStickerForStars(global, currencyAmount?.amount)\n        : selectGiftStickerForTon(global, currencyAmount?.amount)) : undefined;\n\n    return {\n      peer,\n      canPlayAnimatedEmojis: selectCanPlayAnimatedEmojis(global),\n      topSticker: starsGiftSticker,\n      paidMessageCommission,\n    };\n  },\n)(StarsTransactionModal));\n\nfunction getStarsPeerTitleKey(peer: ApiStarsTransactionPeer) {\n  switch (peer.type) {\n    case 'appStore':\n      return 'AppStore';\n    case 'playMarket':\n      return 'PlayMarket';\n    case 'fragment':\n      return 'Fragment';\n    case 'premiumBot':\n      return 'StarsTransactionBot';\n    case 'ads':\n      return 'StarsTransactionAds';\n    case 'api':\n      return 'Stars.Intro.Transaction.TelegramBotApi.Subtitle';\n    default:\n      return 'Stars.Transaction.Unsupported.Title';\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"modal\":\"eR_RZfGB\",\"header\":\"E3R22yAI\",\"title\":\"qdydQHgc\",\"amount\":\"FI6rEJlK\",\"footer\":\"GMWMuWCr\",\"starsBackground\":\"zGCayu45\",\"subscriptionStar\":\"enRetSny\",\"amountStar\":\"J8HIcN6k\",\"secondary\":\"oBLHWBtJ\",\"danger\":\"nkwiG25Q\",\"avatarWrapper\":\"wuTMXDP9\"};","import type { FC } from '../../../../lib/teact/teact';\nimport { memo, useMemo, useRef } from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type {\n  ApiPeer,\n} from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\n\nimport { STARS_ICON_PLACEHOLDER } from '../../../../config';\nimport { isApiPeerUser } from '../../../../global/helpers/peers';\nimport {\n  selectPeer,\n} from '../../../../global/selectors';\nimport buildClassName from '../../../../util/buildClassName';\nimport { formatDateTimeToString } from '../../../../util/dates/dateFormat';\n\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useOldLang from '../../../../hooks/useOldLang';\nimport usePrevious from '../../../../hooks/usePrevious';\n\nimport Avatar from '../../../common/Avatar';\nimport StarIcon from '../../../common/icons/StarIcon';\nimport InteractiveSparkles from '../../../common/InteractiveSparkles';\nimport SafeLink from '../../../common/SafeLink';\nimport Button from '../../../ui/Button';\nimport TableInfoModal, { type TableData } from '../../common/TableInfoModal';\n\nimport styles from './StarsSubscriptionModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['starsSubscriptionModal'];\n};\n\ntype StateProps = {\n  peer?: ApiPeer;\n};\n\nconst AVATAR_SPARKLES_CENTER_SHIFT = [0, -50] as const;\n\nconst StarsSubscriptionModal: FC<OwnProps & StateProps> = ({\n  modal, peer,\n}) => {\n  const {\n    closeStarsSubscriptionModal,\n    fulfillStarsSubscription,\n    changeStarsSubscription,\n    checkChatInvite,\n    loadStarStatus,\n    openInvoice,\n  } = getActions();\n  const oldLang = useOldLang();\n  const lang = useLang();\n  const { subscription } = modal || {};\n  const triggerSparklesRef = useRef<(() => void) | undefined>();\n\n  const handleAvatarMouseMove = useLastCallback(() => {\n    triggerSparklesRef.current?.();\n  });\n\n  const handleRequestAnimation = useLastCallback((animate: NoneToVoidFunction) => {\n    triggerSparklesRef.current = animate;\n  });\n\n  const buttonState = useMemo(() => {\n    if (!subscription) {\n      return 'hidden';\n    }\n\n    if (subscription.canRefulfill) {\n      return 'refulfill';\n    }\n\n    const isActive = subscription.until > Date.now() / 1000;\n    if (isActive && !subscription.isCancelled) {\n      return 'cancel';\n    }\n\n    if (isActive && subscription.isCancelled) {\n      return 'renew';\n    }\n\n    const canRestart = subscription.chatInviteHash || subscription.invoiceSlug;\n    if (!isActive && canRestart) {\n      return 'restart';\n    }\n\n    return 'ok';\n  }, [subscription]);\n\n  const handleButtonClick = useLastCallback(() => {\n    if (!subscription) {\n      return;\n    }\n\n    switch (buttonState) {\n      case 'refulfill': {\n        fulfillStarsSubscription({ id: subscription.id });\n        break;\n      }\n      case 'restart': {\n        if (subscription.chatInviteHash) {\n          checkChatInvite({ hash: subscription.chatInviteHash });\n        } else if (subscription.invoiceSlug) {\n          openInvoice({\n            type: 'slug',\n            slug: subscription.invoiceSlug,\n          });\n        }\n        loadStarStatus();\n        break;\n      }\n      case 'renew': {\n        changeStarsSubscription({ id: subscription.id, isCancelled: false });\n        break;\n      }\n      case 'cancel': {\n        changeStarsSubscription({ id: subscription.id, isCancelled: true });\n        break;\n      }\n    }\n    closeStarsSubscriptionModal();\n  });\n\n  const starModalData = useMemo(() => {\n    if (!subscription || !peer) {\n      return undefined;\n    }\n\n    const {\n      pricing, until, isCancelled, canRefulfill, photo, title, hasBotCancelled,\n    } = subscription;\n\n    const isBotSubscription = isApiPeerUser(peer);\n\n    const header = (\n      <div className={styles.header}>\n        <div className={styles.avatarWrapper}>\n          <Avatar\n            peer={!photo ? peer : undefined}\n            webPhoto={photo}\n            size=\"giant\"\n            onMouseMove={handleAvatarMouseMove}\n          />\n          <StarIcon className={styles.subscriptionStar} type=\"gold\" size=\"adaptive\" />\n        </div>\n        <InteractiveSparkles\n          className={buildClassName(styles.starsBackground)}\n          color=\"gold\"\n          onRequestAnimation={handleRequestAnimation}\n          centerShift={AVATAR_SPARKLES_CENTER_SHIFT}\n        />\n        <h1 className={styles.title}>{title || oldLang('StarsSubscriptionTitle')}</h1>\n        <p className={styles.amount}>\n          {lang('StarsPerMonth', {\n            amount: pricing.amount,\n          }, {\n            withNodes: true,\n            specialReplacement: {\n              [STARS_ICON_PLACEHOLDER]: <StarIcon className={styles.amountStar} size=\"adaptive\" type=\"gold\" />,\n            },\n          })}\n        </p>\n      </div>\n    );\n\n    const tableData: TableData = [];\n\n    tableData.push([\n      oldLang(isBotSubscription ? 'StarsSubscriptionBot' : 'StarsSubscriptionChannel'),\n      { chatId: peer.id },\n    ]);\n\n    if (title) {\n      tableData.push([\n        oldLang('StarsSubscriptionBotProduct'),\n        title,\n      ]);\n    }\n\n    const hasExpired = until < Date.now() / 1000;\n    tableData.push([\n      oldLang(hasExpired ? 'StarsSubscriptionUntilExpired'\n        : isCancelled ? 'StarsSubscriptionUntilExpires' : 'StarsSubscriptionUntilRenews'),\n      formatDateTimeToString(until * 1000, oldLang.code, true),\n    ]);\n\n    const footerTos = lang('StarsTransactionTOS', {\n      link: <SafeLink url={lang('StarsTransactionTOSLink')} text={lang('StarsTransactionTOSLinkText')} />,\n    }, {\n      withNodes: true,\n    });\n\n    const footer = (\n      <span className={styles.footer}>\n        <p className={styles.secondary}>{footerTos}</p>\n        {isCancelled && (\n          <p className={styles.danger}>\n            {oldLang(hasBotCancelled ? 'StarsSubscriptionBotCancelledText' : 'StarsSubscriptionCancelledText')}\n          </p>\n        )}\n        {canRefulfill && (\n          <p className={styles.secondary}>\n            {oldLang('StarsSubscriptionRefulfillInfo', formatDateTimeToString(until * 1000, oldLang.code, true))}\n          </p>\n        )}\n        {!isCancelled && !canRefulfill && hasExpired && (\n          <p className={styles.secondary}>\n            {oldLang('StarsSubscriptionExpiredInfo', formatDateTimeToString(until * 1000, oldLang.code, true))}\n          </p>\n        )}\n        {!isCancelled && !canRefulfill && !hasExpired && (\n          <p className={styles.secondary}>\n            {oldLang('StarsSubscriptionCancelInfo', formatDateTimeToString(until * 1000, oldLang.code, true))}\n          </p>\n        )}\n        {buttonState !== 'hidden' && (\n          <Button\n            color={buttonState === 'cancel' ? 'danger' : 'primary'}\n            isText={buttonState === 'cancel'}\n            onClick={handleButtonClick}\n          >\n            {oldLang(\n              buttonState === 'cancel' ? 'StarsSubscriptionCancel'\n                : buttonState === 'refulfill' ? 'StarsSubscriptionRefulfill'\n                  : buttonState === 'restart' ? 'StarsSubscriptionAgain'\n                    : buttonState === 'renew' ? 'StarsSubscriptionRenew' : 'OK',\n            )}\n          </Button>\n        )}\n      </span>\n    );\n\n    return {\n      header,\n      tableData,\n      footer,\n    };\n  }, [buttonState, lang, oldLang, peer, subscription]);\n\n  const prevModalData = usePrevious(starModalData);\n  const renderingModalData = prevModalData || starModalData;\n\n  return (\n    <TableInfoModal\n      isOpen={Boolean(subscription)}\n      className={styles.modal}\n      header={renderingModalData?.header}\n      tableData={renderingModalData?.tableData}\n      footer={renderingModalData?.footer}\n      onClose={closeStarsSubscriptionModal}\n    />\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { modal }): Complete<StateProps> => {\n    const peerId = modal?.subscription.peerId;\n    const peer = peerId ? selectPeer(global, peerId) : undefined;\n\n    return {\n      peer,\n    };\n  },\n)(StarsSubscriptionModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"CuBAw2yg\",\"slider\":\"euOOAbZi\",\"sparkles\":\"_L1YQTIP\",\"progress\":\"kwK0cNPX\",\"floatingBadgeWrapper\":\"uvlMoXj0\",\"floatingBadge\":\"BGSDWAYc\",\"floatingBadgeText\":\"qqQan8uF\",\"floatingBadgeTriangle\":\"mIdJOmsB\"};","import type React from '../../../lib/teact/teact';\nimport {\n  memo, useMemo, useRef, useState,\n} from '../../../lib/teact/teact';\n\nimport { requestMeasure, requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport buildClassName from '../../../util/buildClassName';\nimport { formatInteger } from '../../../util/textFormat';\n\nimport useEffectOnce from '../../../hooks/useEffectOnce';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useResizeObserver from '../../../hooks/useResizeObserver';\n\nimport AnimatedCounter from '../../common/AnimatedCounter';\nimport Icon from '../../common/icons/Icon';\nimport Sparkles from '../../common/Sparkles';\n\nimport styles from './StarSlider.module.scss';\n\ntype OwnProps = {\n  maxValue: number;\n  defaultValue: number;\n  className?: string;\n  onChange: (value: number) => void;\n};\n\nconst DEFAULT_POINTS = [50, 100, 500, 1000, 2000, 5000, 10000];\n\nconst StarSlider = ({\n  maxValue,\n  defaultValue,\n  className,\n  onChange,\n}: OwnProps) => {\n  const floatingBadgeRef = useRef<HTMLDivElement>();\n\n  const points = useMemo(() => {\n    const result = [];\n    for (let i = 0; i < DEFAULT_POINTS.length; i++) {\n      if (DEFAULT_POINTS[i] < maxValue) {\n        result.push(DEFAULT_POINTS[i]);\n      }\n\n      if (DEFAULT_POINTS[i] >= maxValue) {\n        result.push(maxValue);\n        break;\n      }\n    }\n\n    return result;\n  }, [maxValue]);\n\n  const [value, setValue] = useState(0);\n\n  useEffectOnce(() => {\n    setValue(getProgress(points, defaultValue));\n  });\n\n  const updateSafeBadgePosition = useLastCallback(() => {\n    const badge = floatingBadgeRef.current;\n    if (!badge) return;\n    const parent = badge.parentElement!;\n\n    requestMeasure(() => {\n      const safeMinX = parent.offsetLeft + badge.offsetWidth / 2;\n      const safeMaxX = parent.offsetLeft + parent.offsetWidth - badge.offsetWidth / 2;\n\n      requestMutation(() => {\n        parent.style.setProperty('--_min-x', `${safeMinX}px`);\n        parent.style.setProperty('--_max-x', `${safeMaxX}px`);\n      });\n    });\n  });\n\n  useResizeObserver(floatingBadgeRef, updateSafeBadgePosition);\n\n  const handleChange = useLastCallback((event: React.ChangeEvent<HTMLInputElement>) => {\n    const newValue = Number(event.currentTarget.value);\n    setValue(newValue);\n\n    onChange(getValue(points, newValue));\n  });\n\n  return (\n    <div className={buildClassName(styles.root, className)} style={`--progress: ${value / points.length}`}>\n      <div className={styles.floatingBadgeWrapper}>\n        <div className={styles.floatingBadge} ref={floatingBadgeRef}>\n          <div className={styles.floatingBadgeText}>\n            <Icon name=\"star\" className={styles.floatingBadgeIcon} />\n            <AnimatedCounter text={formatInteger(getValue(points, value))} />\n          </div>\n          <svg className={styles.floatingBadgeTriangle} width=\"28\" height=\"28\" viewBox=\"0 0 28 28\" fill=\"none\">\n            <defs>\n              <linearGradient id=\"StarBadgeTriangle\" x1=\"0\" x2=\"1\" y1=\"0\" y2=\"0\">\n                <stop offset=\"-50%\" stop-color=\"#FFAA00\" />\n                <stop offset=\"150%\" stop-color=\"#FFCD3A\" />\n              </linearGradient>\n            </defs>\n            <path d=\"m 28,4 v 9 c 0.0089,7.283278 -3.302215,5.319646 -6.750951,8.589815 l -5.8284,5.82843 c -0.781,0.78105 -2.0474,0.78104 -2.8284,0 L 6.7638083,21.589815 C 2.8288652,17.959047 0.04527024,20.332086 0,13 V 4 C 0,4 0.00150581,0.97697493 3,1 5.3786658,1.018266 22.594519,0.9142007 25,1 c 2.992326,0.1067311 3,3 3,3 z\" fill=\"url(#StarBadgeTriangle)\" />\n          </svg>\n        </div>\n      </div>\n      <div className={styles.progress}>\n        <Sparkles preset=\"progress\" className={styles.sparkles} />\n      </div>\n      <input\n        className={styles.slider}\n        type=\"range\"\n        min={0}\n        max={points.length}\n        defaultValue={getProgress(points, defaultValue)}\n        step=\"any\"\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nfunction getProgress(points: number[], value: number) {\n  const pointIndex = points.findIndex((point) => value <= point);\n  const prevPoint = points[pointIndex - 1] || 1;\n  const nextPoint = points[pointIndex] || points[points.length - 1];\n  const progress = (value - prevPoint) / (nextPoint - prevPoint);\n  return pointIndex + progress;\n}\n\nfunction getValue(points: number[], progress: number) {\n  const pointIndex = Math.floor(progress);\n  const prevPoint = points[pointIndex - 1] || 1;\n  const nextPoint = points[pointIndex] || points[points.length - 1];\n  const value = prevPoint + (nextPoint - prevPoint) * (progress - pointIndex);\n  return Math.round(value);\n}\n\nexport default memo(StarSlider);\n","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"RdhRpsCn\",\"title\":\"yzbjj73U\",\"slider\":\"xePPMXOI\",\"description\":\"BlpfdOtK\",\"itemInfo\":\"nS9V516D\",\"itemTitle\":\"sH5Nukjy\",\"itemSubtitle\":\"dHlNODTI\",\"itemIcon\":\"H_iHihXU\",\"sendAsPeerButtonAvatar\":\"_mjvLELm\",\"sendAsPeerMenuButton\":\"zxsRaWYV\",\"buttonDownIcon\":\"zrwUUELS\",\"sendAsPeerMenuBubble\":\"X1PB6mhQ\",\"sendAsPeerMenu\":\"Px1MDij9\",\"sendAsPeersMenuContainer\":\"Al1nfhHJ\",\"headerControlPanel\":\"vu90kSL_\",\"separator\":\"uhQLUjmo\",\"checkBox\":\"Mc3bVeF0\",\"topLabel\":\"bnou4CpV\",\"top\":\"QludQDKR\",\"topBadge\":\"JBF9pTUK\",\"buttonStar\":\"NJJFuym9\",\"topPeer\":\"Ty4Ud_Rd\",\"disclaimer\":\"KRvkHeo1\"};","import type { FC } from '../../../lib/teact/teact';\nimport type React from '../../../lib/teact/teact';\nimport {\n  memo, useEffect, useMemo, useState,\n} from '../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../global';\n\nimport type {\n  ApiChat, ApiMessage, ApiPaidReactionPrivacyType,\n  ApiPeer,\n  ApiSendAsPeerId,\n  ApiStarsAmount, ApiUser,\n} from '../../../api/types';\nimport type { TabState } from '../../../global/types';\nimport type { CustomPeer } from '../../../types';\n\nimport { STARS_ICON_PLACEHOLDER } from '../../../config';\nimport { getPeerTitle, isApiPeerUser } from '../../../global/helpers/peers';\nimport {\n  selectChat, selectChatMessage, selectPeer, selectUser,\n} from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport { formatInteger } from '../../../util/textFormat';\nimport renderText from '../../common/helpers/renderText';\n\nimport useAppLayout from '../../../hooks/useAppLayout';\nimport useFlag from '../../../hooks/useFlag';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Avatar from '../../common/Avatar';\nimport FullNameTitle from '../../common/FullNameTitle';\nimport Icon from '../../common/icons/Icon';\nimport PeerBadge from '../../common/PeerBadge';\nimport SafeLink from '../../common/SafeLink';\nimport Button from '../../ui/Button';\nimport Checkbox from '../../ui/Checkbox';\nimport DropdownMenu from '../../ui/DropdownMenu';\nimport MenuItem from '../../ui/MenuItem';\nimport Modal from '../../ui/Modal';\nimport Separator from '../../ui/Separator';\nimport BalanceBlock from '../stars/BalanceBlock';\nimport StarSlider from './StarSlider';\n\nimport styles from './PaidReactionModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['paidReactionModal'];\n};\n\ntype StateProps = {\n  message?: ApiMessage;\n  chat?: ApiChat;\n  maxAmount: number;\n  starBalance?: ApiStarsAmount;\n  defaultPrivacy?: ApiPaidReactionPrivacyType;\n  sendPaidReactionsAsPeerIds?: ApiSendAsPeerId[];\n  currentUserId: string;\n  currentUser: ApiUser;\n};\n\ntype ReactorData = {\n  amount: number;\n  localAmount: number;\n  isMy?: boolean;\n  isAnonymous?: boolean;\n  user?: ApiPeer;\n};\n\nconst MAX_TOP_REACTORS = 3;\nconst DEFAULT_STARS_AMOUNT = 50;\nconst MAX_REACTION_AMOUNT = 2500;\nconst ANONYMOUS_PEER: CustomPeer = {\n  avatarIcon: 'author-hidden',\n  customPeerAvatarColor: '#9eaab5',\n  isCustomPeer: true,\n  titleKey: 'StarsReactionAnonymous',\n};\n\nconst PaidReactionModal = ({\n  modal,\n  chat,\n  message,\n  maxAmount,\n  starBalance,\n  defaultPrivacy,\n  sendPaidReactionsAsPeerIds,\n  currentUserId,\n  currentUser,\n}: OwnProps & StateProps) => {\n  const { closePaidReactionModal, addLocalPaidReaction, loadSendPaidReactionsAs } = getActions();\n\n  const [starsAmount, setStarsAmount] = useState(DEFAULT_STARS_AMOUNT);\n  const [isTouched, markTouched, unmarkTouched] = useFlag();\n  const [shouldSendAsAnonymous, setShouldSendAsAnonymous] = useState(true);\n  const [sendAsPeerId, setSendAsPeerId] = useState(currentUserId);\n\n  const chatId = chat?.id;\n\n  const senderPeer = sendAsPeerId ? (selectPeer(getGlobal(), sendAsPeerId)) : currentUser;\n\n  const oldLang = useOldLang();\n  const { isMobile } = useAppLayout();\n  const lang = useLang();\n\n  const handleShowInTopSendersChange = useLastCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    setShouldSendAsAnonymous(!e.target.checked);\n  });\n\n  const handleAmountChange = useLastCallback((value: number) => {\n    setStarsAmount(value);\n    markTouched();\n  });\n\n  useEffect(() => {\n    if (chatId && !sendPaidReactionsAsPeerIds) {\n      loadSendPaidReactionsAs({ chatId });\n    }\n  }, [chatId, sendPaidReactionsAsPeerIds]);\n\n  const filteredMyReactorIds = useMemo(() => {\n    const result = sendPaidReactionsAsPeerIds?.map((peer) => peer.id)\n      .filter((id) => id !== chatId);\n    result?.unshift(currentUserId);\n    return result;\n  }, [sendPaidReactionsAsPeerIds, chatId, currentUserId]);\n\n  const canChangeSendAsPeer = filteredMyReactorIds && filteredMyReactorIds.length > 1;\n\n  useEffect(() => {\n    if (!modal) {\n      unmarkTouched();\n    }\n  }, [modal]);\n\n  useEffect(() => {\n    const currentReactor = message?.reactions?.topReactors?.find((reactor) => reactor.isMy);\n    if (currentReactor) {\n      setShouldSendAsAnonymous(Boolean(currentReactor.isAnonymous));\n      if (currentReactor.peerId) {\n        setSendAsPeerId(currentReactor.peerId);\n      }\n      return;\n    }\n\n    setShouldSendAsAnonymous(defaultPrivacy?.type === 'anonymous' || false);\n    if (defaultPrivacy?.type === 'peer' && filteredMyReactorIds?.includes(defaultPrivacy.peerId)) {\n      setSendAsPeerId(defaultPrivacy.peerId);\n      return;\n    }\n\n    setSendAsPeerId(currentUserId);\n  }, [defaultPrivacy, message?.reactions?.topReactors, filteredMyReactorIds, currentUserId]);\n\n  const handleSend = useLastCallback(() => {\n    if (!modal) return;\n\n    addLocalPaidReaction({\n      chatId: modal.chatId,\n      messageId: modal.messageId,\n      count: starsAmount,\n      isPrivate: shouldSendAsAnonymous,\n      peerId: shouldSendAsAnonymous || sendAsPeerId === currentUserId ? undefined : sendAsPeerId,\n      shouldIgnoreDefaultPrivacy: true,\n    });\n    closePaidReactionModal();\n  });\n\n  const handleSendAsPeerChange = useLastCallback((peerId: string) => {\n    setShouldSendAsAnonymous(false);\n    setSendAsPeerId(peerId);\n  });\n\n  const renderMenuItem = useLastCallback((peerId: string) => {\n    const peer = selectPeer(getGlobal(), peerId);\n    const isSelected = sendAsPeerId === peerId && !shouldSendAsAnonymous;\n    if (!peer) return undefined;\n\n    return (\n      <MenuItem\n\n        onClick={() => handleSendAsPeerChange(peerId)}\n      >\n        <Avatar\n          size=\"small\"\n          peer={peer}\n        />\n        <div className={buildClassName(styles.itemInfo)}>\n          <FullNameTitle className={styles.itemTitle} peer={peer} noFake noVerified />\n          <span className={styles.itemSubtitle}>\n            {isApiPeerUser(peer) ? lang('PeerPersonalAccount') : lang('PeerChannel')}\n          </span>\n        </div>\n        <Icon\n          className={styles.itemIcon}\n          name={isSelected ? 'check' : 'placeholder'}\n        />\n      </MenuItem>\n    );\n  });\n\n  const SendAsPeerMenuButton: FC<{ onTrigger: () => void; isOpen?: boolean }> = useMemo(() => {\n    return ({ onTrigger, isOpen }) => (\n      <Button\n        ripple={!isMobile}\n        size=\"smaller\"\n        color=\"translucent\"\n        className={buildClassName(styles.sendAsPeerMenuButton, isOpen ? 'active' : '')}\n        onClick={onTrigger}\n        ariaLabel={lang('AccDescrOpenMenu2')}\n      >\n        <Avatar\n          className={styles.sendAsPeerButtonAvatar}\n          size=\"mini\"\n          peer={shouldSendAsAnonymous ? ANONYMOUS_PEER : senderPeer}\n        />\n        <Icon\n          name=\"down\"\n          className={styles.buttonDownIcon}\n        />\n      </Button>\n    );\n  }, [isMobile, lang, senderPeer, shouldSendAsAnonymous]);\n\n  const sendAsPeersMenu = useMemo(() => {\n    if (!canChangeSendAsPeer) return undefined;\n    return (\n      <DropdownMenu\n        className={buildClassName(styles.sendAsPeerMenu, 'with-menu-transitions')}\n        bubbleClassName={styles.sendAsPeerMenuBubble}\n        trigger={SendAsPeerMenuButton}\n        positionX=\"right\"\n        autoClose\n      >\n        {filteredMyReactorIds.map((id) => (\n          renderMenuItem(id)\n        ))}\n      </DropdownMenu>\n    );\n  }, [SendAsPeerMenuButton, filteredMyReactorIds, canChangeSendAsPeer]);\n\n  const topReactors = useMemo(() => {\n    const global = getGlobal();\n    const all = message?.reactions?.topReactors;\n    if (!all) {\n      return undefined;\n    }\n\n    const result: ReactorData[] = [];\n    let hasCurrentSender = false;\n    let myReactorAmount = 0;\n\n    all.forEach((reactor) => {\n      const peer = reactor.peerId ? selectPeer(global, reactor.peerId) : undefined;\n      if (!peer && !reactor.isAnonymous && !reactor.isMy) return;\n      if (reactor.isMy) {\n        myReactorAmount = reactor.count;\n      }\n\n      if (reactor.isMy && (reactor.peerId !== sendAsPeerId || (reactor.isAnonymous && !shouldSendAsAnonymous))) return;\n\n      const isCurrentReactor = sendAsPeerId === reactor.peerId || (shouldSendAsAnonymous && reactor.isAnonymous);\n\n      if (isCurrentReactor) {\n        hasCurrentSender = true;\n      }\n\n      result.push({\n        amount: reactor.count,\n        localAmount: isCurrentReactor && isTouched ? starsAmount : 0,\n        isMy: reactor.isMy,\n        isAnonymous: reactor.isAnonymous,\n        user: peer,\n      });\n    });\n\n    if (!hasCurrentSender) {\n      const sender = selectPeer(global, sendAsPeerId);\n      result.push({\n        amount: myReactorAmount,\n        localAmount: isTouched ? starsAmount : 0,\n        isMy: true,\n        user: sender,\n      });\n    }\n\n    result.sort((a, b) => (b.amount + b.localAmount) - (a.amount + a.localAmount));\n\n    return result.slice(0, MAX_TOP_REACTORS);\n  }, [isTouched, message?.reactions?.topReactors, starsAmount, sendAsPeerId, shouldSendAsAnonymous]);\n\n  const chatTitle = chat && getPeerTitle(oldLang, chat);\n\n  return (\n    <Modal\n      isOpen={Boolean(modal)}\n      onClose={closePaidReactionModal}\n      isSlim\n      hasAbsoluteCloseButton\n      contentClassName={styles.content}\n      isLowStackPriority\n    >\n      <div className={styles.sendAsPeersMenuContainer}>\n        {sendAsPeersMenu}\n      </div>\n      <div className={styles.headerControlPanel}>\n        <BalanceBlock balance={starBalance} className={styles.modalBalance} withAddButton />\n      </div>\n\n      <StarSlider\n        className={styles.slider}\n        defaultValue={DEFAULT_STARS_AMOUNT}\n        maxValue={maxAmount}\n        onChange={handleAmountChange}\n      />\n      <h3 className={styles.title}>{oldLang('StarsReactionTitle')}</h3>\n      <div className={styles.description}>\n        {renderText(oldLang('StarsReactionText', chatTitle), ['simple_markdown', 'emoji'])}\n      </div>\n      <Separator>\n        {topReactors && <div className={styles.topLabel}>{oldLang('StarsReactionTopSenders')}</div>}\n      </Separator>\n      {topReactors && (\n        <div className={styles.top}>\n          {topReactors.map((reactor) => {\n            const countText = formatInteger(reactor.amount + reactor.localAmount);\n            const peer = (reactor.isAnonymous || !reactor.user || (reactor.isMy && shouldSendAsAnonymous))\n              ? ANONYMOUS_PEER : reactor.user;\n            const text = 'isCustomPeer' in peer ? oldLang(peer.titleKey)\n              : peer && getPeerTitle(oldLang, peer);\n            return (\n              <PeerBadge\n                className={styles.topPeer}\n                key={`${reactor.user?.id || 'anonymous'}-${countText}`}\n                peer={peer}\n                badgeText={countText}\n                badgeIcon=\"star\"\n                badgeClassName={styles.topBadge}\n                text={text}\n              />\n            );\n          })}\n        </div>\n      )}\n      {topReactors && (<Separator className={styles.separator} />)}\n      <Checkbox\n        className={buildClassName(styles.checkBox, 'dialog-checkbox')}\n        checked={!shouldSendAsAnonymous}\n        onChange={handleShowInTopSendersChange}\n        label={oldLang('StarsReactionShowMeInTopSenders')}\n      />\n      <Button\n        onClick={handleSend}\n      >\n        {lang('SendPaidReaction', { amount: starsAmount }, {\n          withNodes: true,\n          specialReplacement: {\n            [STARS_ICON_PLACEHOLDER]: <Icon className={styles.buttonStar} name=\"star\" />,\n          },\n        })}\n      </Button>\n      <p className={styles.disclaimer}>\n        {lang('StarsReactionTerms', {\n          link: <SafeLink text={lang('StarsReactionLinkText')} url={lang('StarsReactionLink')} />,\n        }, {\n          withNodes: true,\n        })}\n      </p>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { modal }): Complete<StateProps> => {\n    const chat = modal && selectChat(global, modal.chatId);\n    const message = modal && selectChatMessage(global, modal.chatId, modal.messageId);\n    const starBalance = global.stars?.balance;\n    const maxAmount = global.appConfig.paidReactionMaxAmount || MAX_REACTION_AMOUNT;\n    const defaultPrivacy = global.settings.paidReactionPrivacy;\n    const sendPaidReactionsAsPeerIds = chat?.sendPaidReactionsAsPeerIds;\n    const currentUserId = global.currentUserId!;\n    const currentUser = selectUser(global, currentUserId)!;\n\n    return {\n      chat,\n      message,\n      starBalance,\n      maxAmount,\n      defaultPrivacy,\n      sendPaidReactionsAsPeerIds,\n      currentUserId,\n      currentUser,\n    };\n  },\n)(PaidReactionModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"jKOG0It6\",\"header\":\"A_fX4EXY\",\"spacer\":\"ATowWJ60\",\"title\":\"gDNtv9oz\",\"balance-container\":\"eAKZVhOT\",\"balanceContainer\":\"eAKZVhOT\",\"balance-caption\":\"vbwprYel\",\"balanceCaption\":\"vbwprYel\",\"star-balance\":\"lXuIlbVK\",\"starBalance\":\"lXuIlbVK\",\"balance\":\"dIEx_Iqi\",\"optionsSection\":\"Y68CEIKn\",\"checkboxTitle\":\"H4taXei_\",\"actionMessageView\":\"CB1mxsgp\",\"messageInput\":\"o5r2IPoA\",\"limited\":\"mWzLu0c0\",\"footer\":\"jxWZSvet\",\"switcher\":\"zZUpGRSI\",\"switcherStarIcon\":\"zAee80Dv\",\"description\":\"nTPAv1ci\",\"main-button\":\"IDuhjrne\",\"mainButton\":\"IDuhjrne\",\"star\":\"Q4NlMT0o\",\"background\":\"ZORVRSG3\",\"customBgImage\":\"Eny_G3JI\",\"customBgColor\":\"TkJZPU2u\",\"withTransition\":\"soDpW2YR\",\"blurred\":\"M6k91TdM\",\"withRightColumn\":\"FBcNO8hj\"};","import type { ChangeEvent } from 'react';\nimport {\n  memo, useEffect, useMemo, useState,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { ThemeKey } from '../../../types';\nimport type { GiftOption } from './GiftModal';\nimport {\n  type ApiMessage, type ApiPeer, type ApiStarsAmount, MAIN_THREAD_ID,\n} from '../../../api/types';\n\nimport { getPeerTitle, isApiPeerUser } from '../../../global/helpers/peers';\nimport {\n  selectPeer, selectPeerPaidMessagesStars, selectTabState, selectTheme, selectThemeValues, selectUserFullInfo,\n} from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport buildStyle from '../../../util/buildStyle';\nimport { formatCurrency } from '../../../util/formatCurrency';\nimport { formatStarsAsIcon } from '../../../util/localization/format';\n\nimport useCustomBackground from '../../../hooks/useCustomBackground';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport PremiumProgress from '../../common/PremiumProgress';\nimport ActionMessage from '../../middle/message/ActionMessage';\nimport Button from '../../ui/Button';\nimport Link from '../../ui/Link';\nimport ListItem from '../../ui/ListItem';\nimport Switcher from '../../ui/Switcher';\nimport TextArea from '../../ui/TextArea';\n\nimport styles from './GiftComposer.module.scss';\n\nexport type OwnProps = {\n  gift: GiftOption;\n  giftByStars?: GiftOption;\n  peerId: string;\n};\n\nexport type StateProps = {\n  captionLimit?: number;\n  theme: ThemeKey;\n  isBackgroundBlurred?: boolean;\n  patternColor?: string;\n  customBackground?: string;\n  backgroundColor?: string;\n  peer?: ApiPeer;\n  currentUserId?: string;\n  isPaymentFormLoading?: boolean;\n  starBalance?: ApiStarsAmount;\n  paidMessagesStars?: number;\n  areUniqueStarGiftsDisallowed?: boolean;\n  shouldDisallowLimitedStarGifts?: boolean;\n};\n\nconst LIMIT_DISPLAY_THRESHOLD = 50;\n\nfunction GiftComposer({\n  gift,\n  giftByStars,\n  peerId,\n  peer,\n  captionLimit,\n  theme,\n  isBackgroundBlurred,\n  patternColor,\n  backgroundColor,\n  customBackground,\n  currentUserId,\n  isPaymentFormLoading,\n  starBalance,\n  paidMessagesStars,\n  areUniqueStarGiftsDisallowed,\n  shouldDisallowLimitedStarGifts,\n}: OwnProps & StateProps) {\n  const {\n    sendStarGift, sendPremiumGiftByStars, openInvoice, openGiftUpgradeModal, openStarsBalanceModal,\n  } = getActions();\n\n  const lang = useLang();\n\n  const [giftMessage, setGiftMessage] = useState<string>('');\n  const [shouldHideName, setShouldHideName] = useState<boolean>(false);\n  const [shouldPayForUpgrade, setShouldPayForUpgrade] = useState<boolean>(false);\n  const [shouldPayByStars, setShouldPayByStars] = useState<boolean>(false);\n\n  const customBackgroundValue = useCustomBackground(theme, customBackground);\n\n  useEffect(() => {\n    if (shouldDisallowLimitedStarGifts) {\n      setShouldPayForUpgrade(true);\n    }\n  }, [shouldDisallowLimitedStarGifts, shouldPayForUpgrade]);\n\n  const isStarGift = 'id' in gift && gift.type === 'starGift';\n  const isPremiumGift = 'months' in gift;\n  const hasPremiumByStars = giftByStars && 'amount' in giftByStars;\n  const isPeerUser = peer && isApiPeerUser(peer);\n  const isSelf = peerId === currentUserId;\n\n  const localMessage = useMemo(() => {\n    if (isPremiumGift) {\n      const currentGift = shouldPayByStars && hasPremiumByStars ? giftByStars : gift;\n      return {\n        id: -1,\n        chatId: '0',\n        isOutgoing: false,\n        senderId: currentUserId,\n        date: Math.floor(Date.now() / 1000),\n        content: {\n          action: {\n            mediaType: 'action',\n            type: 'giftPremium',\n            amount: currentGift.amount,\n            currency: currentGift.currency,\n            months: gift.months,\n            message: giftMessage ? { text: giftMessage } : undefined,\n          },\n        },\n      } satisfies ApiMessage;\n    }\n\n    if (isStarGift) {\n      return {\n        id: -1,\n        chatId: '0',\n        isOutgoing: false,\n        senderId: currentUserId,\n        date: Math.floor(Date.now() / 1000),\n        content: {\n          action: {\n            mediaType: 'action',\n            type: 'starGift',\n            message: giftMessage?.length ? {\n              text: giftMessage,\n            } : undefined,\n            isNameHidden: shouldHideName || undefined,\n            starsToConvert: gift.starsToConvert,\n            canUpgrade: shouldPayForUpgrade || undefined,\n            alreadyPaidUpgradeStars: shouldPayForUpgrade ? gift.upgradeStars : undefined,\n            gift,\n            peerId,\n            fromId: currentUserId,\n          },\n        },\n      } satisfies ApiMessage;\n    }\n    return undefined;\n  }, [currentUserId, gift, giftMessage, isStarGift,\n    shouldHideName, shouldPayForUpgrade, peerId,\n    shouldPayByStars, hasPremiumByStars, giftByStars, isPremiumGift]);\n\n  const handleGiftMessageChange = useLastCallback((e: ChangeEvent<HTMLTextAreaElement>) => {\n    setGiftMessage(e.target.value);\n  });\n\n  const handleShouldHideNameChange = useLastCallback(() => {\n    setShouldHideName(!shouldHideName);\n  });\n\n  const handleShouldPayForUpgradeChange = useLastCallback(() => {\n    setShouldPayForUpgrade(!shouldPayForUpgrade);\n  });\n\n  const toggleShouldPayByStars = useLastCallback(() => {\n    if (hasPremiumByStars) setShouldPayByStars(!shouldPayByStars);\n  });\n\n  const handleOpenUpgradePreview = useLastCallback(() => {\n    if (!isStarGift) return;\n    openGiftUpgradeModal({\n      giftId: gift.id,\n      peerId,\n    });\n  });\n\n  const handleGetMoreStars = useLastCallback(() => {\n    openStarsBalanceModal({});\n  });\n\n  const handleMainButtonClick = useLastCallback(() => {\n    if (isStarGift) {\n      sendStarGift({\n        peerId,\n        shouldHideName,\n        gift,\n        message: giftMessage ? { text: giftMessage } : undefined,\n        shouldUpgrade: shouldPayForUpgrade,\n      });\n      return;\n    }\n\n    if (shouldPayByStars && hasPremiumByStars) {\n      sendPremiumGiftByStars({\n        userId: peerId,\n        months: giftByStars.months,\n        amount: giftByStars.amount,\n        message: giftMessage ? { text: giftMessage } : undefined,\n      });\n      return;\n    }\n\n    if (isPremiumGift) {\n      openInvoice({\n        type: 'giftcode',\n        userIds: [peerId],\n        currency: gift.currency,\n        amount: gift.amount,\n        option: gift,\n        message: giftMessage ? { text: giftMessage } : undefined,\n      });\n    }\n  });\n\n  const canUseStarsPayment = hasPremiumByStars && starBalance && (starBalance.amount > giftByStars.amount);\n  function renderOptionsSection() {\n    const symbolsLeft = captionLimit ? captionLimit - giftMessage.length : undefined;\n\n    const title = getPeerTitle(lang, peer!)!;\n    return (\n      <div className={styles.optionsSection}>\n\n        {!paidMessagesStars && (\n          <TextArea\n            className={styles.messageInput}\n            onChange={handleGiftMessageChange}\n            value={giftMessage}\n            label={lang('GiftMessagePlaceholder')}\n            maxLength={captionLimit}\n            maxLengthIndicator={\n              symbolsLeft && symbolsLeft < LIMIT_DISPLAY_THRESHOLD ? symbolsLeft.toString() : undefined\n            }\n          />\n        )}\n\n        {canUseStarsPayment && (\n          <ListItem className={styles.switcher} narrow ripple onClick={toggleShouldPayByStars}>\n            <span>\n              {lang('GiftPremiumPayWithStars', {\n                stars: formatStarsAsIcon(lang, giftByStars.amount, { className: styles.switcherStarIcon }),\n              }, { withNodes: true })}\n            </span>\n            <Switcher\n              checked={shouldPayByStars}\n              onChange={toggleShouldPayByStars}\n              label={lang('GiftPremiumPayWithStarsAcc')}\n            />\n          </ListItem>\n        )}\n\n        {hasPremiumByStars && starBalance && (\n          <div className={styles.description}>\n            {lang('GiftPremiumDescriptionYourBalance', {\n              stars: formatStarsAsIcon(lang, starBalance.amount, { className: styles.switcherStarIcon }),\n              link: <Link isPrimary onClick={handleGetMoreStars}>{lang('GetMoreStarsLinkText')}</Link>,\n            }, {\n              withNodes: true,\n              withMarkdown: true,\n            })}\n          </div>\n        )}\n\n        {isStarGift && Boolean(gift.upgradeStars) && !areUniqueStarGiftsDisallowed && (\n          <ListItem\n            className={styles.switcher}\n            narrow\n            ripple\n            onClick={handleShouldPayForUpgradeChange}\n            disabled={shouldDisallowLimitedStarGifts}\n          >\n            <span>\n              {lang('GiftMakeUnique', {\n                stars: formatStarsAsIcon(lang, gift.upgradeStars, { className: styles.switcherStarIcon }),\n              }, { withNodes: true })}\n            </span>\n            <Switcher\n              checked={shouldPayForUpgrade}\n              onChange={handleShouldPayForUpgradeChange}\n              label={lang('GiftMakeUniqueAcc')}\n            />\n          </ListItem>\n        )}\n        {isStarGift && Boolean(gift.upgradeStars) && !areUniqueStarGiftsDisallowed && (\n          <div className={styles.description}>\n            {isPeerUser\n              ? lang('GiftMakeUniqueDescription', {\n                user: title,\n                link: <Link isPrimary onClick={handleOpenUpgradePreview}>{lang('GiftMakeUniqueLink')}</Link>,\n              }, {\n                withNodes: true,\n              })\n              : lang('GiftMakeUniqueDescriptionChannel', {\n                peer: title,\n                link: <Link isPrimary onClick={handleOpenUpgradePreview}>{lang('GiftMakeUniqueLink')}</Link>,\n              }, {\n                withNodes: true,\n              })}\n          </div>\n        )}\n\n        {isStarGift && (\n          <ListItem className={styles.switcher} narrow ripple onClick={handleShouldHideNameChange}>\n            <span>{lang('GiftHideMyName')}</span>\n            <Switcher\n              checked={shouldHideName}\n              onChange={handleShouldHideNameChange}\n              label={lang('GiftHideMyName')}\n            />\n          </ListItem>\n        )}\n        {isStarGift && (\n          <div className={styles.description}>\n            {isSelf ? lang('GiftHideNameDescriptionSelf')\n              : isPeerUser ? lang('GiftHideNameDescription', { receiver: title })\n                : lang('GiftHideNameDescriptionChannel')}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  function renderFooter() {\n    const amount = shouldPayByStars && hasPremiumByStars\n      ? formatStarsAsIcon(lang, giftByStars.amount, { asFont: true })\n      : isStarGift\n        ? formatStarsAsIcon(lang, gift.stars + (shouldPayForUpgrade ? gift.upgradeStars! : 0), { asFont: true })\n        : isPremiumGift ? formatCurrency(lang, gift.amount, gift.currency) : undefined;\n\n    return (\n      <div className={styles.footer}>\n        {isStarGift && Boolean(gift.availabilityRemains) && (\n          <PremiumProgress\n            isPrimary\n            progress={gift.availabilityRemains / gift.availabilityTotal!}\n            rightText={lang('GiftSoldCount', {\n              count: gift.availabilityTotal! - gift.availabilityRemains,\n            })}\n            leftText={lang('GiftLeftCount', { count: gift.availabilityRemains })}\n            className={styles.limited}\n          />\n        )}\n        <Button\n          className={styles.mainButton}\n          size=\"smaller\"\n          onClick={handleMainButtonClick}\n          isLoading={isPaymentFormLoading}\n        >\n          {lang('GiftSend', {\n            amount,\n          }, {\n            withNodes: true,\n          })}\n        </Button>\n      </div>\n    );\n  }\n\n  const bgClassName = buildClassName(\n    styles.background,\n    styles.withTransition,\n    customBackground && styles.customBgImage,\n    backgroundColor && styles.customBgColor,\n    customBackground && isBackgroundBlurred && styles.blurred,\n  );\n\n  if ((!isStarGift && !isPremiumGift) || !localMessage) return;\n\n  return (\n    <div className={buildClassName(styles.root, 'custom-scroll')}>\n      <div\n        className={buildClassName(styles.actionMessageView, 'MessageList')}\n        // @ts-ignore -- FIXME: Find a way to disable interactions but keep a11y\n        inert\n        style={buildStyle(\n          `--pattern-color: ${patternColor}`,\n          backgroundColor && `--theme-background-color: ${backgroundColor}`,\n        )}\n      >\n        <div\n          className={bgClassName}\n          style={customBackgroundValue ? `--custom-background: ${customBackgroundValue}` : undefined}\n        />\n        <ActionMessage\n          key={isStarGift ? gift.id : isPremiumGift ? gift.months : undefined}\n          message={localMessage}\n          threadId={MAIN_THREAD_ID}\n          appearanceOrder={0}\n        />\n      </div>\n      {renderOptionsSection()}\n      <div className={styles.spacer} />\n      {renderFooter()}\n    </div>\n  );\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { peerId }): Complete<StateProps> => {\n    const theme = selectTheme(global);\n    const {\n      stars,\n    } = global;\n    const {\n      isBlurred: isBackgroundBlurred,\n      patternColor,\n      background: customBackground,\n      backgroundColor,\n    } = selectThemeValues(global, theme) || {};\n    const peer = selectPeer(global, peerId);\n    const paidMessagesStars = selectPeerPaidMessagesStars(global, peerId);\n    const userFullInfo = selectUserFullInfo(global, peerId);\n    const currentUserId = global.currentUserId;\n    const isGiftForSelf = currentUserId === peerId;\n    const areUniqueStarGiftsDisallowed = !isGiftForSelf\n      && userFullInfo?.disallowedGifts?.shouldDisallowUniqueStarGifts;\n    const shouldDisallowLimitedStarGifts = !isGiftForSelf\n      && userFullInfo?.disallowedGifts?.shouldDisallowLimitedStarGifts;\n\n    const tabState = selectTabState(global);\n\n    return {\n      starBalance: stars?.balance,\n      peer,\n      theme,\n      isBackgroundBlurred,\n      patternColor,\n      customBackground,\n      backgroundColor,\n      captionLimit: global.appConfig.starGiftMaxMessageLength,\n      currentUserId: global.currentUserId,\n      isPaymentFormLoading: tabState.isPaymentFormLoading,\n      paidMessagesStars,\n      areUniqueStarGiftsDisallowed,\n      shouldDisallowLimitedStarGifts,\n    };\n  },\n)(GiftComposer));\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"G1mBmzxs\",\"starGift\":\"f5ArEO1S\",\"monthsDescription\":\"rn9aWFNA\",\"description\":\"q4_ydkAx\",\"buy\":\"a8no5WH0\",\"transferBadge\":\"nqN62arv\",\"star\":\"DvJLTVFU\",\"premiumRequired\":\"NBYIITte\",\"amount\":\"sbo2dMcH\",\"starsPriceBlock\":\"QB5SI7ta\",\"starsPriceIcon\":\"jgnEfoeM\",\"radialPattern\":\"Nkotr8Q4\",\"stickerWrapper\":\"rUSoeQXb\",\"lockIcon\":\"kwuipwV7\"};","import { memo } from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type {\n  ApiPremiumGiftCodeOption,\n  ApiSticker,\n} from '../../../api/types';\n\nimport {\n  selectCanPlayAnimatedEmojis,\n  selectGiftStickerForDuration,\n} from '../../../global/selectors';\nimport { formatCurrencyAsString } from '../../../util/formatCurrency';\nimport { formatStarsAsIcon } from '../../../util/localization/format';\n\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport AnimatedIconFromSticker from '../../common/AnimatedIconFromSticker';\nimport GiftRibbon from '../../common/gift/GiftRibbon';\nimport Button from '../../ui/Button';\n\nimport styles from './GiftItem.module.scss';\n\nexport type OwnProps = {\n  option: ApiPremiumGiftCodeOption;\n  optionByStars?: ApiPremiumGiftCodeOption;\n  baseMonthAmount?: number;\n  onClick: (gift: ApiPremiumGiftCodeOption) => void;\n};\n\nexport type StateProps = {\n  sticker?: ApiSticker;\n  canPlayAnimatedEmojis?: boolean;\n};\n\nconst GIFT_STICKER_SIZE = 86;\n\nfunction GiftItemPremium({\n  sticker, canPlayAnimatedEmojis, baseMonthAmount, option, optionByStars, onClick,\n}: OwnProps & StateProps) {\n  const {\n    months, amount, currency,\n  } = option;\n  const lang = useLang();\n\n  const handleGiftClick = useLastCallback(() => {\n    onClick(option);\n  });\n\n  const perMonth = Math.floor(amount / months);\n  const discount = baseMonthAmount && baseMonthAmount > perMonth\n    ? Math.ceil(100 - perMonth / (baseMonthAmount / 100))\n    : undefined;\n\n  function renderMonths() {\n    const caption = months === 12\n      ? lang('Years', { count: 1 }, { pluralValue: 1 })\n      : lang('Months', { count: months }, { pluralValue: months });\n    return (\n      <div className={styles.monthsDescription}>\n        {caption}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className={styles.container}\n      tabIndex={0}\n      role=\"button\"\n      onClick={handleGiftClick}\n    >\n      <AnimatedIconFromSticker\n        sticker={sticker}\n        play={canPlayAnimatedEmojis}\n        noLoop\n        nonInteractive\n        size={GIFT_STICKER_SIZE}\n      />\n\n      {renderMonths()}\n      <div className={styles.description}>\n        {lang('PremiumGiftDescription')}\n      </div>\n      <Button className={styles.buy} nonInteractive size=\"tiny\" pill fluid>\n        {formatCurrencyAsString(amount, currency)}\n      </Button>\n      {optionByStars && (\n        <div className={styles.starsPriceBlock}>\n          {lang('GiftPremiumStarsPrice', {\n            stars: (formatStarsAsIcon(lang, optionByStars.amount, { className: styles.starsPriceIcon })),\n          }, { withNodes: true, withMarkdown: true })}\n        </div>\n      )}\n      {Boolean(discount) && (\n        <GiftRibbon color=\"purple\" text={lang('GiftDiscount', { percent: discount })} />\n      )}\n    </div>\n  );\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { option }): Complete<StateProps> => {\n    const sticker = selectGiftStickerForDuration(global, option.months);\n    const canPlayAnimatedEmojis = selectCanPlayAnimatedEmojis(global);\n\n    return {\n      sticker,\n      canPlayAnimatedEmojis,\n    };\n  },\n)(GiftItemPremium));\n","import { memo, useMemo, useRef, useState } from '@teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { ApiStarGift, ApiTypeCurrencyAmount } from '../../../api/types';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../../../config';\nimport { selectIsCurrentUserPremium } from '../../../global/selectors';\nimport { IS_TOUCH_ENV } from '../../../util/browser/windowEnvironment.ts';\nimport buildClassName from '../../../util/buildClassName';\nimport { formatStarsAsIcon, formatTonAsIcon } from '../../../util/localization/format';\n\nimport Icon from '../../common/icons/Icon'; ;\nimport { getGiftAttributes, getStickerFromGift } from '../../common/helpers/gifts';\n\nimport useFlag from '../../../hooks/useFlag.ts';\nimport { type ObserveFn, useOnIntersect } from '../../../hooks/useIntersectionObserver';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport GiftRibbon from '../../common/gift/GiftRibbon';\nimport RadialPatternBackground from '../../common/profile/RadialPatternBackground';\nimport StickerView from '../../common/StickerView';\nimport Button from '../../ui/Button';\n\nimport styles from './GiftItem.module.scss';\n\nexport type OwnProps = {\n  gift: ApiStarGift;\n  isResale?: boolean;\n  withTransferBadge?: boolean;\n  observeIntersection?: ObserveFn;\n  onClick: (gift: ApiStarGift, target: 'original' | 'resell') => void;\n};\n\ntype StateProps = {\n  isCurrentUserPremium?: boolean;\n};\n\nconst GIFT_STICKER_SIZE = 90;\n\nfunction GiftItemStar({\n  gift, isResale, isCurrentUserPremium, withTransferBadge, observeIntersection, onClick,\n}: OwnProps & StateProps) {\n  const { openGiftInfoModal, openPremiumModal, showNotification, checkCanSendGift } = getActions();\n\n  const ref = useRef<HTMLDivElement>();\n  const stickerRef = useRef<HTMLDivElement>();\n\n  function getPriceAmount(amounts?: ApiTypeCurrencyAmount[]) {\n    if (!amounts) return { amount: 0, currency: STARS_CURRENCY_CODE };\n\n    if (gift.type === 'starGiftUnique' && gift.resaleTonOnly) {\n      const tonAmount = amounts.find((amount) => amount.currency === TON_CURRENCY_CODE);\n      if (tonAmount) return tonAmount;\n    }\n\n    const starsAmount = amounts.find((amount) => amount.currency === STARS_CURRENCY_CODE);\n    return starsAmount;\n  }\n\n  const lang = useLang();\n\n  const [isVisible, setIsVisible] = useState(false);\n  const [isHover, markHover, unmarkHover] = useFlag();\n\n  const sticker = getStickerFromGift(gift);\n  const isGiftUnique = gift.type === 'starGiftUnique';\n  const uniqueGift = isGiftUnique ? gift : undefined;\n  const regularGift = !isGiftUnique ? gift : undefined;\n\n  const priceInfo = !isGiftUnique\n    ? { amount: regularGift?.stars || 0, currency: STARS_CURRENCY_CODE }\n    : getPriceAmount(uniqueGift?.resellPrice);\n  const priceCurrency = priceInfo?.currency || STARS_CURRENCY_CODE;\n  const resellMinStars = regularGift?.resellMinStars;\n  const formattedPrice = !isGiftUnique && isResale && resellMinStars\n    ? lang.number(resellMinStars) + '+' : priceInfo?.amount || 0;\n  const isLimited = !isGiftUnique && Boolean(regularGift?.isLimited);\n  const isSoldOut = !isGiftUnique && Boolean(regularGift?.isSoldOut);\n  const isPremiumRequired = Boolean(gift?.requirePremium);\n  const isUserLimitReached = Boolean(regularGift?.limitedPerUser && !regularGift?.perUserRemains);\n  const perUserTotal = regularGift?.perUserTotal;\n\n  const handleGiftClick = useLastCallback(() => {\n    if (isSoldOut && !isResale) {\n      openGiftInfoModal({ gift });\n      return;\n    }\n\n    if (isUserLimitReached) {\n      showNotification({\n        message: lang('NotificationGiftsLimit2', {\n          count: perUserTotal,\n        }, {\n          pluralValue: perUserTotal!,\n          withMarkdown: true,\n          withNodes: true,\n        }),\n      });\n      return;\n    }\n\n    if (isPremiumRequired && !isCurrentUserPremium) {\n      openPremiumModal({\n        gift,\n      });\n      return;\n    }\n\n    if (isLocked) {\n      checkCanSendGift({\n        gift,\n        onSuccess: () => onClick(gift, isResale ? 'resell' : 'original'),\n      });\n      return;\n    }\n\n    onClick(gift, isResale ? 'resell' : 'original');\n  });\n\n  const radialPatternBackdrop = useMemo(() => {\n    const { backdrop, pattern } = getGiftAttributes(gift) || {};\n\n    if (!backdrop || !pattern) {\n      return undefined;\n    }\n\n    const backdropColors = [backdrop.centerColor, backdrop.edgeColor];\n\n    return (\n      <RadialPatternBackground\n        className={styles.radialPattern}\n        backgroundColors={backdropColors}\n        patternIcon={pattern.sticker}\n        ringsCount={1}\n        ovalFactor={1}\n      />\n    );\n  }, [gift]);\n\n  const giftNumber = isGiftUnique ? gift.number : 0;\n  const isLocked = Boolean(gift.type === 'starGift' && gift.lockedUntilDate);\n\n  const giftRibbon = useMemo(() => {\n    if (isGiftUnique) {\n      const { backdrop } = getGiftAttributes(gift) || {};\n      if (!backdrop) {\n        return undefined;\n      }\n      return (\n        <GiftRibbon\n          color={[backdrop.centerColor, backdrop.edgeColor]}\n          text={\n            lang('GiftSavedNumber', { number: giftNumber })\n          }\n        />\n      );\n    }\n    if (isResale) {\n      return <GiftRibbon color=\"green\" text={lang('GiftRibbonResale')} />;\n    }\n    if (isSoldOut) {\n      return <GiftRibbon color=\"red\" text={lang('GiftSoldOut')} />;\n    }\n    if (isPremiumRequired) {\n      return <GiftRibbon color=\"orange\" text={lang('LimitPremium')} />;\n    }\n    if (isLimited) {\n      return <GiftRibbon color=\"blue\" text={lang('GiftLimited')} />;\n    }\n    return undefined;\n  }, [isGiftUnique, isResale, gift, isSoldOut, isLimited, lang, giftNumber, isPremiumRequired]);\n\n  useOnIntersect(ref, observeIntersection, (entry) => {\n    const visible = entry.isIntersecting;\n    setIsVisible(visible);\n  });\n\n  const badgeContent = useMemo(() => {\n    if (withTransferBadge) {\n      return lang('GiftTransferTitle');\n    }\n\n    if (priceCurrency === TON_CURRENCY_CODE) {\n      return formatTonAsIcon(lang, formattedPrice || 0, {\n        shouldConvertFromNanos: true,\n        className: styles.star,\n      });\n    }\n\n    return formatStarsAsIcon(lang, formattedPrice || 0, {\n      asFont: true,\n      className: styles.star,\n    });\n  }, [withTransferBadge, priceCurrency, formattedPrice, lang]);\n\n  return (\n    <div\n      ref={ref}\n      className={buildClassName(\n        'interactive-gift',\n        styles.container,\n        styles.starGift,\n        'starGiftItem',\n        isPremiumRequired && styles.premiumRequired,\n      )}\n      tabIndex={0}\n      role=\"button\"\n      onClick={handleGiftClick}\n      onMouseEnter={!IS_TOUCH_ENV ? markHover : undefined}\n      onMouseLeave={!IS_TOUCH_ENV ? unmarkHover : undefined}\n    >\n      {radialPatternBackdrop}\n\n      <div\n        ref={stickerRef}\n        className={styles.stickerWrapper}\n        style={`width: ${GIFT_STICKER_SIZE}px; height: ${GIFT_STICKER_SIZE}px`}\n      >\n        {sticker && (\n          <StickerView\n            observeIntersectionForPlaying={observeIntersection}\n            observeIntersectionForLoading={observeIntersection}\n            containerRef={stickerRef}\n            sticker={sticker}\n            size={GIFT_STICKER_SIZE}\n            shouldLoop={isHover}\n            shouldPreloadPreview\n          />\n        )}\n\n      </div>\n      <Button\n        className={buildClassName(\n          styles.buy,\n          withTransferBadge && styles.transferBadge,\n        )}\n        nonInteractive\n        size=\"tiny\"\n        color={isGiftUnique ? 'bluredStarsBadge' : 'stars'}\n        withSparkleEffect={isVisible && !withTransferBadge}\n        pill\n        fluid\n      >\n        {badgeContent}\n      </Button>\n      {giftRibbon}\n      {isLocked && <Icon name=\"lock-badge\" className={styles.lockIcon} />}\n    </div>\n  );\n}\n\nexport default memo(\n  withGlobal<OwnProps>((global): Complete<StateProps> => {\n    const isCurrentUserPremium = selectIsCurrentUserPremium(global);\n\n    return {\n      isCurrentUserPremium,\n    };\n  })(GiftItemStar),\n);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"tJK1W0pJ\",\"transition\":\"pP8TxefR\",\"content\":\"o3V1HqbL\",\"resaleScreenRoot\":\"Vce_TsJO\",\"main\":\"cVXqeu9P\",\"giftSection\":\"v4eKefwN\",\"section\":\"EqfarEYb\",\"resaleStarGiftsContainer\":\"RSFcSNGL\",\"starGiftsContainer\":\"OQX3GZl5\",\"premiumGiftsGallery\":\"n40m3BK2\",\"header\":\"iqqoyRgW\",\"resaleHeader\":\"cJRBgg9B\",\"resaleHeaderContentContainer\":\"OXYQmfGK\",\"headerSlide\":\"BTWhJUQB\",\"headerText\":\"lLRmbpIu\",\"hiddenHeader\":\"XgGzn1cQ\",\"resaleHeaderText\":\"bp_KPx8I\",\"commonHeaderText\":\"ybZo03if\",\"resaleHeaderDescription\":\"XefHUFm1\",\"closeButton\":\"r_Y5uG1T\",\"balance\":\"soqAknia\",\"avatars\":\"N_7tYJKr\",\"avatar\":\"_3hY4vIep\",\"logoBackground\":\"ieK4TzSb\",\"center\":\"Ey5gX40t\",\"description\":\"ZioU5h_k\",\"starGiftsDescription\":\"gFgzS8pV\",\"boostIcon\":\"Qi2YR6Dz\",\"optionBottom\":\"RTbClMKE\",\"secondaryInfo\":\"g0R9GSNq\",\"footer\":\"J3Gju3bv\",\"starGiftsTransition\":\"kB6IyXqS\",\"notFoundGiftsRoot\":\"UqnRlJ1n\",\"notFoundGiftsDescription\":\"g0VbwIG_\",\"notFoundGiftsLink\":\"j2zPEQr8\"};","import type { FC } from '../../../lib/teact/teact';\nimport {\n  memo,\n  useMemo,\n  useRef } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type {\n  ApiStarGift,\n} from '../../../api/types';\nimport type { ResaleGiftsFilterOptions } from '../../../types';\n\nimport { selectTabState,\n} from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport { RESALE_GIFTS_LIMIT } from '../../../limits';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\n\nimport useInfiniteScroll from '../../../hooks/useInfiniteScroll';\nimport { useIntersectionObserver } from '../../../hooks/useIntersectionObserver';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport AnimatedIconWithPreview from '../../common/AnimatedIconWithPreview';\nimport InfiniteScroll from '../../ui/InfiniteScroll';\nimport Link from '../../ui/Link';\nimport Transition from '../../ui/Transition';\nimport GiftItemStar from './GiftItemStar';\n\nimport styles from './GiftModal.module.scss';\n\nexport type OwnProps = {\n  onGiftClick: (gift: ApiStarGift) => void;\n};\n\ntype StateProps = {\n  gift?: ApiStarGift;\n  resellGifts?: ApiStarGift[];\n  filter: ResaleGiftsFilterOptions;\n  areGiftsAllLoaded?: boolean;\n  areGiftsLoading?: boolean;\n  updateIteration: number;\n};\n\nconst INTERSECTION_THROTTLE = 200;\n\nconst GiftModalResaleScreen: FC<OwnProps & StateProps> = ({\n  resellGifts,\n  gift,\n  filter,\n  areGiftsAllLoaded,\n  areGiftsLoading,\n  updateIteration,\n  onGiftClick,\n}) => {\n  const {\n    loadResaleGifts,\n    updateResaleGiftsFilter,\n  } = getActions();\n  const scrollerRef = useRef<HTMLDivElement>();\n\n  const lang = useLang();\n  const resellGiftsIds = useMemo(() => {\n    return resellGifts?.map((g) => g.id);\n  }, [resellGifts]);\n\n  const hasFilter = Boolean(filter?.modelAttributes?.length\n    || filter?.patternAttributes?.length || filter?.backdropAttributes?.length);\n\n  const handleLoadMoreResellGifts = useLastCallback(() => {\n    if (gift) {\n      const giftId = 'regularGiftId' in gift\n        ? gift.regularGiftId\n        : gift.id;\n      loadResaleGifts({ giftId });\n    }\n  });\n\n  const isGiftsEmpty = Boolean(!resellGifts || resellGifts.length === 0);\n\n  const [viewportIds, onLoadMore] = useInfiniteScroll(\n    handleLoadMoreResellGifts,\n    resellGiftsIds,\n    !gift,\n    RESALE_GIFTS_LIMIT,\n  );\n\n  const { observe } = useIntersectionObserver({ rootRef: scrollerRef, throttleMs: INTERSECTION_THROTTLE });\n\n  const handleResetGiftsFilter = useLastCallback(() => {\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      modelAttributes: [],\n      backdropAttributes: [],\n      patternAttributes: [],\n    } });\n  });\n\n  function renderNothingFoundGiftsWithFilter() {\n    return (\n      <div className={styles.notFoundGiftsRoot}>\n        <AnimatedIconWithPreview\n          size={160}\n          tgsUrl={LOCAL_TGS_URLS.SearchingDuck}\n          nonInteractive\n          noLoop\n        />\n        <div className={styles.notFoundGiftsDescription}>\n          {lang('ResellGiftsNoFound')}\n        </div>\n        {hasFilter && (\n          <Link\n            className={styles.notFoundGiftsLink}\n            onClick={handleResetGiftsFilter}\n          >\n            {lang('ResellGiftsClearFilters')}\n          </Link>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div ref={scrollerRef} className={buildClassName(styles.resaleScreenRoot, 'custom-scroll')}>\n      <Transition\n        name=\"zoomFade\"\n        activeKey={updateIteration}\n      >\n        {isGiftsEmpty && areGiftsAllLoaded && renderNothingFoundGiftsWithFilter()}\n        <InfiniteScroll\n          className={buildClassName(styles.resaleStarGiftsContainer)}\n          items={viewportIds}\n          onLoadMore={onLoadMore}\n          itemSelector=\".starGiftItem\"\n          noFastList\n          preloadBackwards={RESALE_GIFTS_LIMIT}\n          scrollContainerClosest={`.${styles.resaleScreenRoot}`}\n        >\n          {resellGifts?.map((g) => (\n            <GiftItemStar\n              key={g.id}\n              gift={g}\n              observeIntersection={observe}\n              isResale\n              onClick={onGiftClick}\n            />\n          ))}\n        </InfiniteScroll>\n      </Transition>\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global): Complete<StateProps> => {\n  const {\n    starGifts,\n  } = global;\n\n  const { resaleGifts } = selectTabState(global);\n  const gift = resaleGifts?.giftId ? starGifts?.byId[resaleGifts.giftId] : undefined;\n  const filter = resaleGifts.filter;\n  const areGiftsAllLoaded = resaleGifts.isAllLoaded;\n  const areGiftsLoading = resaleGifts.isLoading;\n  const updateIteration = resaleGifts.updateIteration;\n\n  return {\n    resellGifts: resaleGifts.gifts,\n    gift,\n    filter,\n    areGiftsAllLoaded,\n    areGiftsLoading,\n    updateIteration,\n  };\n})(GiftModalResaleScreen));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"KLFLR9ji\",\"thumb\":\"fCL5rY2D\"};","import type { FC } from '../../../lib/teact/teact';\nimport { memo, useRef } from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type { ApiSticker } from '../../../api/types';\nimport type { ThemeKey } from '../../../types';\n\nimport { selectTheme } from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport { REM } from '../../common/helpers/mediaDimensions';\n\nimport useDynamicColorListener from '../../../hooks/stickers/useDynamicColorListener';\nimport { type ObserveFn } from '../../../hooks/useIntersectionObserver';\n\nimport StickerView from '../../common/StickerView';\n\nimport styles from './ResaleGiftMenuAttributeSticker.module.scss';\n\ntype OwnProps = {\n  className?: string;\n  type: 'model' | 'pattern';\n  sticker: ApiSticker;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n};\n\ntype StateProps = {\n  theme: ThemeKey;\n};\n\nconst ATTRIBUTE_STICKER_SIZE = 1.5 * REM;\n\nconst ResaleGiftMenuAttributeSticker: FC<StateProps & OwnProps> = ({\n  className,\n  type,\n  sticker,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  theme,\n}) => {\n  const stickerRef = useRef<HTMLDivElement>();\n\n  const customColor = useDynamicColorListener(stickerRef, undefined, type !== 'pattern');\n\n  return (\n    <div\n      ref={stickerRef}\n      className={buildClassName(styles.root, className)}\n      style={`width: ${ATTRIBUTE_STICKER_SIZE}px; height: ${ATTRIBUTE_STICKER_SIZE}px`}\n    >\n      <StickerView\n        containerRef={stickerRef}\n        sticker={sticker}\n        size={ATTRIBUTE_STICKER_SIZE}\n        shouldPreloadPreview\n        observeIntersectionForLoading={observeIntersectionForLoading}\n        observeIntersectionForPlaying={observeIntersectionForPlaying}\n        thumbClassName={styles.thumb}\n        customColor={customColor}\n      />\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global): Complete<StateProps> => {\n  return {\n    theme: selectTheme(global),\n  };\n})(ResaleGiftMenuAttributeSticker));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_VgmQnUg\",\"buttonsContainer\":\"IDlp6U6g\",\"itemIcon\":\"yuctLnuR\",\"sticker\":\"VT562JS0\",\"backdropAttributeMenuItemText\":\"D50wFfRL\",\"menuItemStickerText\":\"THcGWXSA\",\"menuItemText\":\"L6EVE2Ux\",\"backdrop\":\"A29QNxKb\",\"menuItemIcon\":\"GL4rVsev\",\"item\":\"qiYcBOYc\",\"menuContentContainer\":\"EDsBn29z\",\"menu\":\"ISaNdBwd\",\"left\":\"e4Kkh_MR\",\"right\":\"Kz_nCGC3\"};","import { type MouseEvent as ReactMouseEvent } from 'react';\nimport type { ElementRef, FC } from '../../../lib/teact/teact';\nimport type React from '../../../lib/teact/teact';\nimport {\n  memo,\n  useCallback,\n  useMemo,\n  useRef,\n  useState } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type {\n  ApiStarGiftAttribute,\n  ApiStarGiftAttributeBackdrop,\n  ApiStarGiftAttributeCounter,\n  ApiStarGiftAttributeIdBackdrop,\n  ApiStarGiftAttributeIdPattern,\n  ApiStarGiftAttributeModel,\n  ApiStarGiftAttributePattern,\n  StarGiftAttributeIdModel,\n} from '../../../api/types';\nimport type { ResaleGiftsFilterOptions, ResaleGiftsSortType } from '../../../types';\n\nimport { selectTabState,\n} from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\n\nimport useContextMenuHandlers from '../../../hooks/useContextMenuHandlers';\nimport { useIntersectionObserver } from '../../../hooks/useIntersectionObserver';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport Icon from '../../common/icons/Icon';\nimport RadialPatternBackground from '../../common/profile/RadialPatternBackground';\nimport Menu from '../../ui/Menu';\nimport MenuItem from '../../ui/MenuItem';\nimport SearchInput from '../../ui/SearchInput';\nimport ResaleGiftMenuAttributeSticker from './ResaleGiftMenuAttributeSticker';\n\nimport styles from './GiftResaleFilters.module.scss';\n\ntype OwnProps = {\n  dialogRef: ElementRef<HTMLDivElement>;\n};\ntype StateProps = {\n  filter: ResaleGiftsFilterOptions;\n  attributes?: ApiStarGiftAttribute[];\n  counters?: ApiStarGiftAttributeCounter[];\n};\n\nconst GiftResaleFilters: FC<StateProps & OwnProps> = ({\n  attributes,\n  counters,\n  filter,\n  dialogRef,\n}) => {\n  const lang = useLang();\n  const {\n    updateResaleGiftsFilter,\n  } = getActions();\n\n  const [searchModelQuery, setSearchModelQuery] = useState('');\n  const [searchBackdropQuery, setSearchBackdropQuery] = useState('');\n  const [searchPatternQuery, setSearchPatternQuery] = useState('');\n  const filteredAttributes = useMemo(() => {\n    const map: {\n      model: ApiStarGiftAttributeModel[];\n      pattern: ApiStarGiftAttributePattern[];\n      backdrop: ApiStarGiftAttributeBackdrop[];\n    } = {\n      model: [],\n      pattern: [],\n      backdrop: [],\n    };\n\n    for (const counter of counters ?? []) {\n      const { attribute } = counter;\n\n      if (!counter.count) {\n        continue;\n      }\n\n      const found = attributes?.find((attr) => {\n        if (attr.type === 'backdrop' && attribute.type === 'backdrop') {\n          return attr.backdropId === attribute.backdropId;\n        }\n\n        if (attr.type === 'model' && attribute.type === 'model') {\n          return attr.sticker.id === attribute.documentId;\n        }\n\n        if (attr.type === 'pattern' && attribute.type === 'pattern') {\n          return attr.sticker.id === attribute.documentId;\n        }\n\n        return false;\n      });\n\n      if (found?.type === 'backdrop') {\n        map.backdrop.push(found);\n      }\n      if (found?.type === 'model') {\n        map.model.push(found);\n      }\n      if (found?.type === 'pattern') {\n        map.pattern.push(found);\n      }\n    }\n\n    return map;\n  }, [attributes, counters]);\n\n  const filteredAndSearchedAttributes = useMemo(() => {\n    const filterBySearch = <T extends { name?: string }>(items: T[], query: string): T[] => {\n      if (!query.trim()) return items;\n\n      return items.filter(\n        (item): item is T => Boolean(item.name?.toLowerCase().includes(query.toLowerCase())),\n      );\n    };\n\n    return {\n      model: filterBySearch(filteredAttributes.model, searchModelQuery),\n      pattern: filterBySearch(filteredAttributes.pattern, searchPatternQuery),\n      backdrop: filterBySearch(filteredAttributes.backdrop, searchBackdropQuery),\n    };\n  }, [filteredAttributes, searchModelQuery, searchBackdropQuery, searchPatternQuery]);\n\n  // Sort Menu\n  const sortMenuRef = useRef<HTMLDivElement>();\n  const {\n    isContextMenuOpen: isSortContextMenuOpen,\n    contextMenuAnchor: sortContextMenuAnchor,\n    handleContextMenu: handleSortContextMenu,\n    handleContextMenuClose: handleSortContextMenuClose,\n    handleContextMenuHide: handleSortContextMenuHide,\n  } = useContextMenuHandlers(dialogRef);\n  const getSortMenuElement = useLastCallback(() => sortMenuRef.current!);\n\n  // Model Menu\n  const modelMenuRef = useRef<HTMLDivElement>();\n  const {\n    isContextMenuOpen: isModelContextMenuOpen,\n    contextMenuAnchor: modelContextMenuAnchor,\n    handleContextMenu: handleModelContextMenu,\n    handleContextMenuClose: handleModelContextMenuClose,\n    handleContextMenuHide: handleModelContextMenuHide,\n  } = useContextMenuHandlers(dialogRef);\n  const getModelMenuElement = useLastCallback(\n    () => modelMenuRef.current!,\n  );\n\n  // Backdrop Menu\n  const backdropMenuRef = useRef<HTMLDivElement>();\n  const {\n    isContextMenuOpen: isBackdropContextMenuOpen,\n    contextMenuAnchor: backdropContextMenuAnchor,\n    handleContextMenu: handleBackdropContextMenu,\n    handleContextMenuClose: handleBackdropContextMenuClose,\n    handleContextMenuHide: handleBackdropContextMenuHide,\n  } = useContextMenuHandlers(dialogRef);\n  const getBackdropMenuElement = useLastCallback(() => backdropMenuRef.current!);\n\n  // Pattern Menu\n  const patternMenuRef = useRef<HTMLDivElement>();\n  const {\n    isContextMenuOpen: isPatternContextMenuOpen,\n    contextMenuAnchor: patternContextMenuAnchor,\n    handleContextMenu: handlePatternContextMenu,\n    handleContextMenuClose: handlePatternContextMenuClose,\n    handleContextMenuHide: handlePatternContextMenuHide,\n  } = useContextMenuHandlers(dialogRef);\n  const getPatternMenuElement = useLastCallback(() => patternMenuRef.current!);\n\n  const SortMenuButton: FC<{ onTrigger: (e: ReactMouseEvent<HTMLDivElement, MouseEvent>) => void; isOpen?: boolean }>\n    = useMemo(() => {\n      const sortType = filter.sortType;\n      return ({ onTrigger, isOpen: isMenuOpen }) => (\n        <div\n          className={styles.item}\n          onClick={onTrigger}\n        >\n          {sortType === 'byDate' && lang('ValueGiftSortByDate')}\n          {sortType === 'byNumber' && lang('ValueGiftSortByNumber')}\n          {sortType === 'byPrice' && lang('ValueGiftSortByPrice')}\n          <Icon\n            name=\"dropdown-arrows\"\n            className={styles.itemIcon}\n          />\n        </div>\n      );\n    }, [lang, filter]);\n\n  const ModelMenuButton:\n  FC<{ onTrigger: (e: ReactMouseEvent<HTMLDivElement, MouseEvent>) => void; isOpen?: boolean }>\n    = useMemo(() => {\n      const attributesCount = filter?.modelAttributes?.length || 0;\n      return ({ onTrigger, isOpen: isMenuOpen }) => (\n        <div\n          className={styles.item}\n          onClick={onTrigger}\n        >\n          {attributesCount === 0 && lang('GiftAttributeModel')}\n          {attributesCount > 0\n            && lang('GiftAttributeModelPlural', { count: attributesCount }, { pluralValue: attributesCount })}\n          <Icon\n            name=\"dropdown-arrows\"\n            className={styles.itemIcon}\n          />\n        </div>\n      );\n    }, [lang, filter]);\n  const BackdropMenuButton:\n  FC<{ onTrigger: (e: ReactMouseEvent<HTMLDivElement, MouseEvent>) => void; isOpen?: boolean }>\n    = useMemo(() => {\n      const attributesCount = filter?.backdropAttributes?.length || 0;\n      return ({ onTrigger, isOpen: isMenuOpen }) => (\n        <div\n          className={styles.item}\n          onClick={onTrigger}\n        >\n          {attributesCount === 0 && lang('GiftAttributeBackdrop')}\n          {attributesCount > 0\n            && lang('GiftAttributeBackdropPlural', { count: attributesCount }, { pluralValue: attributesCount })}\n          <Icon\n            name=\"dropdown-arrows\"\n            className={styles.itemIcon}\n          />\n        </div>\n      );\n    }, [lang, filter]);\n  const PatternMenuButton: FC<{ onTrigger: (e: ReactMouseEvent<HTMLDivElement, MouseEvent>) => void; isOpen?: boolean }>\n    = useMemo(() => {\n      const attributesCount = filter?.patternAttributes?.length || 0;\n      return ({ onTrigger, isOpen: isMenuOpen }) => (\n        <div\n          className={styles.item}\n          onClick={onTrigger}\n        >\n          {attributesCount === 0 && lang('GiftAttributeSymbol')}\n          {attributesCount > 0\n            && lang('GiftAttributeSymbolPlural', { count: attributesCount }, { pluralValue: attributesCount })}\n          <Icon\n            name=\"dropdown-arrows\"\n            className={styles.itemIcon}\n          />\n        </div>\n      );\n    }, [lang, filter]);\n\n  const handleSortMenuItemClick = useLastCallback((type: ResaleGiftsSortType) => {\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      sortType: type,\n    } });\n  });\n\n  const handleSelectedAllModelsClick = useLastCallback(() => {\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      modelAttributes: [],\n    } });\n  });\n  const handleSelectedAllPatternsClick = useLastCallback(() => {\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      patternAttributes: [],\n    } });\n  });\n  const handleSelectedAllBackdropsClick = useLastCallback(() => {\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      backdropAttributes: [],\n    } });\n  });\n\n  const handleModelMenuItemClick = useLastCallback((attribute: ApiStarGiftAttributeModel) => {\n    if (!counters) return;\n    const modelAttributes = filter.modelAttributes || [];\n    const modelAttribute\n      = counters.find((counter): counter is ApiStarGiftAttributeCounter<StarGiftAttributeIdModel> =>\n        counter.attribute.type === 'model' && counter.attribute.documentId === attribute.sticker.id,\n      )?.attribute;\n\n    if (!modelAttribute) return;\n\n    const isActive = modelAttributes.some((item) => item.documentId === modelAttribute.documentId);\n    const updatedAttributes = isActive\n      ? modelAttributes.filter((item) => item.documentId !== modelAttribute.documentId)\n      : [...modelAttributes, modelAttribute];\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      modelAttributes: updatedAttributes,\n    } });\n  });\n\n  const handlePatternMenuItemClick = useLastCallback((attribute: ApiStarGiftAttributePattern) => {\n    if (!counters) return;\n    const patternAttributes = filter.patternAttributes || [];\n    const patternAttribute = counters.find(\n      (counter): counter is ApiStarGiftAttributeCounter<ApiStarGiftAttributeIdPattern> =>\n        counter.attribute.type === 'pattern' && counter.attribute.documentId === attribute.sticker.id,\n    )?.attribute;\n\n    if (!patternAttribute) return;\n\n    const isActive = patternAttributes.some((item) => item.documentId === patternAttribute.documentId);\n    const updatedAttributes = isActive\n      ? patternAttributes.filter((item) => item.documentId !== patternAttribute.documentId)\n      : [...patternAttributes, patternAttribute];\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      patternAttributes: updatedAttributes,\n    } });\n  });\n\n  const handleBackdropMenuItemClick = useLastCallback((attribute: ApiStarGiftAttributeBackdrop) => {\n    if (!counters) return;\n    const backdropAttributes = filter.backdropAttributes || [];\n    const backdropAttribute = counters.find(\n      (counter): counter is ApiStarGiftAttributeCounter<ApiStarGiftAttributeIdBackdrop> =>\n        counter.attribute.type === 'backdrop' && counter.attribute.backdropId === attribute.backdropId,\n    )?.attribute;\n\n    if (!backdropAttribute) return;\n\n    const isActive = backdropAttributes.some((item) => item.backdropId === backdropAttribute.backdropId);\n    const updatedAttributes = isActive\n      ? backdropAttributes.filter((item) => item.backdropId !== backdropAttribute.backdropId)\n      : [...backdropAttributes, backdropAttribute];\n    updateResaleGiftsFilter({ filter: {\n      ...filter,\n      backdropAttributes: updatedAttributes,\n    } });\n  });\n\n  function renderSortMenuItems() {\n    return (\n      <>\n        <MenuItem icon=\"sort-by-price\" onClick={() => { handleSortMenuItemClick('byPrice'); }}>\n          <div className={styles.menuItemText}>\n            {lang('GiftSortByPrice')}\n          </div>\n          <Icon\n            className={styles.menuItemIcon}\n            name={filter?.sortType === 'byPrice' ? 'check' : 'placeholder'}\n          />\n        </MenuItem>\n        <MenuItem icon=\"sort-by-date\" onClick={() => { handleSortMenuItemClick('byDate'); }}>\n          <div className={styles.menuItemText}>\n            {lang('GiftSortByDate')}\n          </div>\n          <Icon\n            className={styles.menuItemIcon}\n            name={filter?.sortType === 'byDate' ? 'check' : 'placeholder'}\n          />\n\n        </MenuItem>\n        <MenuItem icon=\"sort-by-number\"onClick={() => { handleSortMenuItemClick('byNumber'); }}>\n          <div className={styles.menuItemText}>\n            {lang('GiftSortByNumber')}\n          </div>\n          <Icon\n            className={styles.menuItemIcon}\n            name={filter?.sortType === 'byNumber' ? 'check' : 'placeholder'}\n          />\n        </MenuItem>\n      </>\n    );\n  }\n\n  function renderSortMenu() {\n    return (\n      <Menu\n        isOpen={isSortContextMenuOpen}\n        anchor={sortContextMenuAnchor}\n        ref={sortMenuRef}\n        className={buildClassName(\n          styles.menu,\n          styles.left,\n          'with-menu-transitions',\n        )}\n        getMenuElement={getSortMenuElement}\n        autoClose\n        onClose={handleSortContextMenuClose}\n        onCloseAnimationEnd={handleSortContextMenuHide}\n        positionX=\"left\"\n      >\n        {renderSortMenuItems()}\n      </Menu>\n    );\n  }\n\n  const handleSearchModelInputReset = useCallback(() => {\n    setSearchModelQuery('');\n  }, []);\n  const handleSearchBackdropInputReset = useCallback(() => {\n    setSearchBackdropQuery('');\n  }, []);\n  const handleSearchPatternInputReset = useCallback(() => {\n    setSearchPatternQuery('');\n  }, []);\n  const handleSearchInputClick = useLastCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n    e.preventDefault();\n  });\n\n  const modelMenuItemsContainerRef = useRef<HTMLDivElement>();\n  const { observe } = useIntersectionObserver({\n    rootRef: modelMenuItemsContainerRef,\n    isDisabled: !modelContextMenuAnchor,\n  });\n\n  function renderModelMenuItems() {\n    const models = filteredAndSearchedAttributes.model;\n    const selectedAttributes = filter.modelAttributes ?? [];\n    const isSelectedAll = selectedAttributes.length === 0;\n    return (\n      <div className={styles.menuContentContainer} ref={modelMenuItemsContainerRef}>\n        <SearchInput\n          onClick={handleSearchInputClick}\n          className={styles.search}\n          value={searchModelQuery}\n          onChange={setSearchModelQuery}\n          onReset={handleSearchModelInputReset}\n          placeholder={lang('Search')}\n        />\n        <MenuItem icon=\"select\" onClick={handleSelectedAllModelsClick} disabled={isSelectedAll}>\n          {lang('ContextMenuItemSelectAll')}\n        </MenuItem>\n        {models.map((model) => {\n          const isSelected = isSelectedAll\n            || selectedAttributes.some((attr) => attr.documentId === model.sticker.id);\n          return (\n            <MenuItem\n              key={model.name}\n              onClick={() => {\n                handleModelMenuItemClick(model);\n              }}\n            >\n              <ResaleGiftMenuAttributeSticker\n                className={styles.sticker}\n                sticker={model.sticker}\n                type=\"model\"\n                observeIntersectionForLoading={observe}\n                observeIntersectionForPlaying={observe}\n              />\n              <div className={styles.menuItemStickerText}>\n                {model.name}\n              </div>\n              <Icon\n                className={styles.menuItemIcon}\n                name={isSelected ? 'check' : 'placeholder'}\n              />\n            </MenuItem>\n          );\n        })}\n      </div>\n    );\n  }\n\n  function renderModelMenu() {\n    return (\n      <Menu\n        isOpen={isModelContextMenuOpen}\n        anchor={modelContextMenuAnchor}\n        ref={modelMenuRef}\n        className={buildClassName(\n          styles.menu,\n          styles.left,\n          'with-menu-transitions',\n        )}\n        getMenuElement={getModelMenuElement}\n        autoClose\n        onClose={handleModelContextMenuClose}\n        onCloseAnimationEnd={handleModelContextMenuHide}\n      >\n        {renderModelMenuItems()}\n      </Menu>\n    );\n  }\n\n  function renderBackdropMenuItems() {\n    const backdrops = filteredAndSearchedAttributes.backdrop;\n    const selectedAttributes = filter.backdropAttributes ?? [];\n    const isSelectedAll = selectedAttributes.length === 0;\n\n    return (\n      <div className={styles.menuContentContainer}>\n        <SearchInput\n          onClick={handleSearchInputClick}\n          className={styles.search}\n          value={searchBackdropQuery}\n          onChange={setSearchBackdropQuery}\n          onReset={handleSearchBackdropInputReset}\n          placeholder={lang('Search')}\n        />\n        <MenuItem icon=\"select\" onClick={handleSelectedAllBackdropsClick} disabled={isSelectedAll}>\n          {lang('ContextMenuItemSelectAll')}\n        </MenuItem>\n        {backdrops.map((backdrop) => {\n          const isSelected = isSelectedAll\n            || selectedAttributes.some((attr) => attr.backdropId === backdrop.backdropId);\n\n          return (\n            <MenuItem\n              key={backdrop.name}\n              onClick={() => {\n                handleBackdropMenuItemClick(backdrop);\n              }}\n            >\n              <RadialPatternBackground\n                className={styles.backdrop}\n                backgroundColors={[backdrop.centerColor, backdrop.edgeColor]}\n              />\n              <div className={styles.backdropAttributeMenuItemText}>\n                {backdrop.name}\n              </div>\n              <Icon\n                className={styles.menuItemIcon}\n                name={isSelected ? 'check' : 'placeholder'}\n              />\n            </MenuItem>\n          );\n        })}\n      </div>\n    );\n  }\n\n  function renderBackdropMenu() {\n    return (\n      <Menu\n        isOpen={isBackdropContextMenuOpen}\n        anchor={backdropContextMenuAnchor}\n        ref={backdropMenuRef}\n        className={buildClassName(styles.menu, styles.right, 'with-menu-transitions')}\n        getMenuElement={getBackdropMenuElement}\n        autoClose\n        onClose={handleBackdropContextMenuClose}\n        onCloseAnimationEnd={handleBackdropContextMenuHide}\n        positionX=\"right\"\n      >\n        {renderBackdropMenuItems()}\n      </Menu>\n    );\n  }\n\n  function renderPatternMenuItems() {\n    const patterns = filteredAndSearchedAttributes.pattern;\n    const selectedAttributes = filter.patternAttributes ?? [];\n    const isSelectedAll = selectedAttributes.length === 0;\n\n    return (\n      <div className={styles.menuContentContainer}>\n        <SearchInput\n          onClick={handleSearchInputClick}\n          className={styles.search}\n          value={searchPatternQuery}\n          onChange={setSearchPatternQuery}\n          onReset={handleSearchPatternInputReset}\n          placeholder={lang('Search')}\n        />\n        <MenuItem icon=\"select\" onClick={handleSelectedAllPatternsClick} disabled={isSelectedAll}>\n          {lang('ContextMenuItemSelectAll')}\n        </MenuItem>\n        {patterns.map((pattern) => {\n          const isSelected = isSelectedAll\n            || selectedAttributes.some((attr) => attr.documentId === pattern.sticker.id);\n\n          return (\n            <MenuItem\n              key={pattern.name}\n              onClick={() => {\n                handlePatternMenuItemClick(pattern);\n              }}\n            >\n\n              <ResaleGiftMenuAttributeSticker\n                className={styles.sticker}\n                sticker={pattern.sticker}\n                type=\"pattern\"\n              />\n\n              <div className={styles.menuItemStickerText}>\n                {pattern.name}\n              </div>\n              <Icon\n                className={styles.menuItemIcon}\n                name={isSelected ? 'check' : 'placeholder'}\n              />\n            </MenuItem>\n          );\n        })}\n      </div>\n    );\n  }\n\n  function renderPatternMenu() {\n    return (\n      <Menu\n        isOpen={isPatternContextMenuOpen}\n        anchor={patternContextMenuAnchor}\n        ref={patternMenuRef}\n        className={buildClassName(styles.menu, styles.right, 'with-menu-transitions')}\n        getMenuElement={getPatternMenuElement}\n        autoClose\n        onClose={handlePatternContextMenuClose}\n        onCloseAnimationEnd={handlePatternContextMenuHide}\n      >\n        {renderPatternMenuItems()}\n      </Menu>\n    );\n  }\n\n  return (\n    <div className={styles.root}>\n      {Boolean(sortContextMenuAnchor) && renderSortMenu()}\n      {Boolean(modelContextMenuAnchor) && renderModelMenu()}\n      {Boolean(backdropContextMenuAnchor) && renderBackdropMenu()}\n      {Boolean(patternContextMenuAnchor) && renderPatternMenu()}\n      <div className={styles.buttonsContainer}>\n        <SortMenuButton\n          onTrigger={handleSortContextMenu}\n          isOpen={isSortContextMenuOpen}\n        />\n        <ModelMenuButton\n          onTrigger={handleModelContextMenu}\n          isOpen={isModelContextMenuOpen}\n        />\n        <BackdropMenuButton\n          onTrigger={handleBackdropContextMenu}\n          isOpen={isBackdropContextMenuOpen}\n        />\n        <PatternMenuButton\n          onTrigger={handlePatternContextMenu}\n          isOpen={isPatternContextMenuOpen}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default memo(withGlobal((global): Complete<StateProps> => {\n  const { resaleGifts } = selectTabState(global);\n\n  const attributes = resaleGifts.attributes;\n  const counters = resaleGifts.counters;\n  const filter = resaleGifts.filter;\n\n  return {\n    attributes,\n    counters,\n    filter,\n  };\n})(GiftResaleFilters));\n","// extracted by mini-css-extract-plugin\nexport default {\"list\":\"cUjwvN00\",\"item-selected\":\"medfcJpd\",\"itemSelected\":\"medfcJpd\",\"item\":\"dO7FKYY4\",\"selected-item\":\"B2lEJk1v\",\"selectedItem\":\"B2lEJk1v\",\"star\":\"Pb7AU805\"};","import {\n  memo, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type { StarGiftCategory } from '../../../types';\n\nimport buildClassName from '../../../util/buildClassName';\n\nimport useHorizontalScroll from '../../../hooks/useHorizontalScroll';\nimport useLang from '../../../hooks/useLang';\n\nimport styles from './StarGiftCategoryList.module.scss';\n\ntype OwnProps = {\n  areUniqueStarGiftsDisallowed?: boolean;\n  areLimitedStarGiftsDisallowed?: boolean;\n  isSelf?: boolean;\n  hasMyUnique?: boolean;\n  onCategoryChanged: (category: StarGiftCategory) => void;\n};\n\ntype StateProps = {\n  idsByCategory?: Record<StarGiftCategory, string[]>;\n};\n\nconst StarGiftCategoryList = ({\n  idsByCategory,\n  onCategoryChanged,\n  areUniqueStarGiftsDisallowed,\n  areLimitedStarGiftsDisallowed,\n  isSelf,\n  hasMyUnique,\n}: StateProps & OwnProps) => {\n  const ref = useRef<HTMLDivElement>();\n\n  const lang = useLang();\n\n  const hasCollectible = Boolean(idsByCategory?.collectible?.length);\n\n  const [selectedCategory, setSelectedCategory] = useState<StarGiftCategory>('all');\n\n  function handleItemClick(category: StarGiftCategory) {\n    setSelectedCategory(category);\n    onCategoryChanged(\n      category,\n    );\n  }\n\n  function renderCategoryName(category: StarGiftCategory) {\n    if (category === 'all') return lang('AllGiftsCategory');\n    if (category === 'myUnique') return lang('GiftCategoryMyGifts');\n    if (category === 'collectible') return lang('GiftCategoryCollectibles');\n    return category;\n  }\n\n  function renderCategoryItem(category: StarGiftCategory) {\n    return (\n      <div\n        className={buildClassName(\n          styles.item,\n          selectedCategory === category && styles.selectedItem,\n        )}\n        onClick={() => handleItemClick(category)}\n      >\n        {renderCategoryName(category)}\n      </div>\n    );\n  }\n\n  useHorizontalScroll(ref, undefined, true);\n\n  return (\n    <div ref={ref} className={buildClassName(styles.list, 'no-scrollbar')}>\n      {renderCategoryItem('all')}\n      {!areUniqueStarGiftsDisallowed && !isSelf && hasMyUnique && renderCategoryItem('myUnique')}\n      {(!areUniqueStarGiftsDisallowed || !areLimitedStarGiftsDisallowed)\n        && hasCollectible && renderCategoryItem('collectible')}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const { starGifts } = global;\n\n    return {\n      idsByCategory: starGifts?.idsByCategory,\n    };\n  },\n)(StarGiftCategoryList));\n","import type { FC } from '@teact';\nimport {\n  memo, useEffect, useMemo, useRef, useState,\n} from '@teact';\nimport type React from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type {\n  ApiDisallowedGifts,\n  ApiPeer,\n  ApiPremiumGiftCodeOption,\n  ApiSavedStarGift,\n  ApiStarGift,\n  ApiStarGiftRegular,\n  ApiStarsAmount,\n} from '../../../api/types';\nimport type { TabState } from '../../../global/types';\nimport type { StarGiftCategory } from '../../../types';\n\nimport { STARS_CURRENCY_CODE } from '../../../config';\nimport { getUserFullName } from '../../../global/helpers';\nimport { getPeerTitle, isApiPeerChat, isApiPeerUser } from '../../../global/helpers/peers';\nimport { selectTabState } from '../../../global/selectors';\nimport { selectPeer, selectUserFullInfo } from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport { throttle } from '../../../util/schedulers';\n\nimport useCurrentOrPrev from '../../../hooks/useCurrentOrPrev';\nimport { useIntersectionObserver } from '../../../hooks/useIntersectionObserver';\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Avatar from '../../common/Avatar';\nimport InteractiveSparkles from '../../common/InteractiveSparkles';\nimport SafeLink from '../../common/SafeLink';\nimport Button from '../../ui/Button';\nimport InfiniteScroll from '../../ui/InfiniteScroll';\nimport Modal from '../../ui/Modal';\nimport Transition from '../../ui/Transition';\nimport BalanceBlock from '../stars/BalanceBlock';\nimport GiftSendingOptions from './GiftComposer';\nimport GiftItemPremium from './GiftItemPremium';\nimport GiftItemStar from './GiftItemStar';\nimport GiftModalResaleScreen from './GiftModalResaleScreen';\nimport GiftResaleFilters from './GiftResaleFilters';\nimport StarGiftCategoryList from './StarGiftCategoryList';\n\nimport styles from './GiftModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftModal'];\n};\n\nexport type GiftOption = ApiPremiumGiftCodeOption | ApiStarGift;\n\ntype StateProps = {\n  boostPerSentGift?: number;\n  starGiftsById?: Record<string, ApiStarGiftRegular>;\n  starGiftIdsByCategory?: Record<StarGiftCategory, string[]>;\n  myUniqueGiftsById?: Record<string, ApiSavedStarGift>;\n  myUniqueGiftIds?: string[];\n  starBalance?: ApiStarsAmount;\n  peer?: ApiPeer;\n  isSelf?: boolean;\n  disallowedGifts?: ApiDisallowedGifts;\n  resaleGiftsCount?: number;\n  areResaleGiftsLoading?: boolean;\n  selectedResaleGift?: ApiStarGift;\n  tabId: number;\n};\n\nconst AVATAR_SIZE = 100;\nconst INTERSECTION_THROTTLE = 200;\nconst SCROLL_THROTTLE = 200;\nconst AVATAR_SPARKLES_CENTER_SHIFT = [0, -50] as const;\n\nconst runThrottledForScroll = throttle((cb) => cb(), SCROLL_THROTTLE, true);\n\nconst GiftModal: FC<OwnProps & StateProps> = ({\n  modal,\n  starGiftsById,\n  starGiftIdsByCategory,\n  myUniqueGiftsById,\n  myUniqueGiftIds,\n  starBalance,\n  peer,\n  isSelf,\n  disallowedGifts,\n  resaleGiftsCount,\n  areResaleGiftsLoading,\n  selectedResaleGift,\n  tabId,\n}) => {\n  const {\n    closeGiftModal,\n    openGiftInfoModal,\n    resetResaleGifts,\n    loadResaleGifts,\n    openGiftInMarket,\n    closeResaleGiftsMarket,\n    loadMyUniqueGifts,\n    openGiftTransferConfirmModal,\n  } = getActions();\n  const dialogRef = useRef<HTMLDivElement>();\n  const transitionRef = useRef<HTMLDivElement>();\n  const giftHeaderRef = useRef<HTMLHeadingElement>();\n\n  const scrollerRef = useRef<HTMLDivElement>();\n\n  const isOpen = Boolean(modal);\n  const renderingModal = useCurrentOrPrev(modal);\n\n  const user = peer && isApiPeerUser(peer) ? peer : undefined;\n  const chat = peer && isApiPeerChat(peer) ? peer : undefined;\n\n  const [selectedGift, setSelectedGift] = useState<GiftOption | undefined>();\n  const [shouldShowMainScreenHeader, setShouldShowMainScreenHeader] = useState(false);\n  const [isMainScreenHeaderForStarGifts, setIsMainScreenHeaderForStarGifts] = useState(false);\n  const [isGiftScreenHeaderForStarGifts, setIsGiftScreenHeaderForStarGifts] = useState(false);\n\n  const [selectedCategory, setSelectedCategory] = useState<StarGiftCategory>('all');\n  const triggerSparklesRef = useRef<(() => void) | undefined>();\n\n  const areAllGiftsDisallowed = useMemo(() => {\n    if (!disallowedGifts) {\n      return undefined;\n    }\n    const {\n      shouldDisallowPremiumGifts,\n      ...disallowedGiftTypes\n    } = disallowedGifts;\n    return !isSelf && Object.values(disallowedGiftTypes).every(Boolean);\n  }, [isSelf, disallowedGifts]);\n\n  const areUnlimitedStarGiftsDisallowed = !isSelf && disallowedGifts?.shouldDisallowUnlimitedStarGifts;\n  const areLimitedStarGiftsDisallowed = !isSelf && disallowedGifts?.shouldDisallowLimitedStarGifts;\n  const areUniqueStarGiftsDisallowed = !isSelf && disallowedGifts?.shouldDisallowUniqueStarGifts;\n\n  const oldLang = useOldLang();\n  const lang = useLang();\n  const allGifts = renderingModal?.gifts;\n  const filteredGifts = useMemo(() => {\n    return allGifts?.sort((prevGift, gift) => prevGift.months - gift.months)\n      .filter((gift) => gift.users === 1 && gift.currency !== STARS_CURRENCY_CODE);\n  }, [allGifts]);\n\n  const giftsByStars = useMemo(() => {\n    const mapGifts = new Map();\n\n    if (!filteredGifts) return mapGifts;\n\n    filteredGifts.forEach((gift) => {\n      const giftByStars = allGifts?.find(\n        (starsGift) => starsGift.currency === STARS_CURRENCY_CODE\n          && starsGift.months === gift.months,\n      );\n      if (giftByStars) {\n        mapGifts.set(gift, giftByStars);\n      }\n    });\n\n    return mapGifts;\n  }, [allGifts, filteredGifts]);\n\n  const baseGift = useMemo(() => {\n    return filteredGifts?.reduce((prev, gift) => (prev.amount < gift.amount ? prev : gift));\n  }, [filteredGifts]);\n\n  const {\n    observe: observeIntersection,\n  } = useIntersectionObserver({ rootRef: scrollerRef, throttleMs: INTERSECTION_THROTTLE, isDisabled: !isOpen });\n\n  const isResaleScreen = Boolean(selectedResaleGift) && !selectedGift;\n  const isGiftScreen = Boolean(selectedGift);\n  const shouldShowHeader = isResaleScreen || isGiftScreen || shouldShowMainScreenHeader;\n  const isHeaderForStarGifts = isGiftScreen ? isGiftScreenHeaderForStarGifts : isMainScreenHeaderForStarGifts;\n\n  useEffect(() => {\n    if (selectedResaleGift) {\n      const giftId = 'regularGiftId' in selectedResaleGift\n        ? selectedResaleGift.regularGiftId\n        : selectedResaleGift.id;\n      loadResaleGifts({ giftId });\n    }\n  }, [selectedResaleGift]);\n\n  useEffect(() => {\n    if (!isOpen) {\n      setShouldShowMainScreenHeader(false);\n      setSelectedGift(undefined);\n      setSelectedCategory('all');\n    }\n  }, [isOpen, tabId, closeResaleGiftsMarket]);\n\n  const handleScroll = useLastCallback((e: React.UIEvent<HTMLDivElement>) => {\n    if (isGiftScreen) return;\n    const currentTarget = e.currentTarget;\n\n    runThrottledForScroll(() => {\n      const { scrollTop } = currentTarget;\n\n      setShouldShowMainScreenHeader(scrollTop > 150);\n\n      if (transitionRef.current && giftHeaderRef.current) {\n        const { top: headerTop } = giftHeaderRef.current.getBoundingClientRect();\n        const { top: transitionTop } = transitionRef.current.getBoundingClientRect();\n        setIsMainScreenHeaderForStarGifts(headerTop - transitionTop <= 0);\n      }\n    });\n  });\n\n  const giftPremiumDescription = lang('GiftPremiumDescription', {\n    user: getUserFullName(user)!,\n    link: (\n      <SafeLink\n        text={lang('GiftPremiumDescriptionLinkCaption')}\n        url={lang('GiftPremiumDescriptionLink')}\n      />\n    ),\n  }, { withNodes: true });\n\n  const starGiftDescription = useMemo(() => {\n    if (chat) {\n      return lang('StarGiftDescriptionChannel', { peer: getPeerTitle(lang, chat) }, {\n        withNodes: true,\n        withMarkdown: true,\n      });\n    }\n\n    if (isSelf) {\n      return lang('StarGiftDescriptionSelf', undefined, {\n        withNodes: true,\n        renderTextFilters: ['br'],\n      });\n    }\n\n    if (selectedCategory === 'collectible') {\n      return lang('StarGiftDescriptionCollectibles');\n    }\n\n    return lang('StarGiftDescription', {\n      user: getUserFullName(user)!,\n    }, { withNodes: true, withMarkdown: true });\n  }, [chat, isSelf, selectedCategory, user, lang]);\n\n  function renderGiftPremiumHeader() {\n    return (\n      <h2 className={buildClassName(styles.headerText, styles.center)}>\n        {lang('GiftPremiumHeader')}\n      </h2>\n    );\n  }\n\n  function renderGiftPremiumDescription() {\n    return (\n      <p className={buildClassName(styles.description, styles.center)}>\n        {giftPremiumDescription}\n      </p>\n    );\n  }\n\n  function renderStarGiftsHeader() {\n    return (\n      <h2 ref={giftHeaderRef} className={buildClassName(styles.headerText, styles.center)}>\n        {lang(isSelf ? 'StarsGiftHeaderSelf' : 'StarsGiftHeader')}\n      </h2>\n    );\n  }\n\n  function renderStarGiftsDescription() {\n    return (\n      <p className={buildClassName(styles.description, styles.starGiftsDescription, styles.center)}>\n        {starGiftDescription}\n      </p>\n    );\n  }\n\n  const handleGiftClick = useLastCallback((gift: GiftOption, target?: 'resell' | 'original') => {\n    if (target === 'resell') {\n      if (!('id' in gift)) {\n        return;\n      }\n      if (isResaleScreen) {\n        openGiftInfoModal({ gift, recipientId: renderingModal?.forPeerId });\n        return;\n      }\n      openGiftInMarket({ gift, tabId });\n      return;\n    }\n    setSelectedGift(gift);\n    setIsGiftScreenHeaderForStarGifts('id' in gift);\n  });\n\n  const handleMyGiftClick = useLastCallback((gift: ApiStarGift) => {\n    if (gift.type === 'starGift' || !myUniqueGiftsById || !peer?.id) return;\n    const savedGift = myUniqueGiftsById[gift.id];\n\n    openGiftTransferConfirmModal({\n      gift: savedGift,\n      recipientId: peer.id,\n    });\n  });\n\n  const handleLoadMore = useLastCallback(() => {\n    if (selectedCategory === 'myUnique') {\n      loadMyUniqueGifts();\n    }\n  });\n\n  function renderStarGifts() {\n    if (selectedCategory === 'myUnique') {\n      return (\n        <InfiniteScroll\n          className={styles.starGiftsContainer}\n          items={myUniqueGiftIds}\n          onLoadMore={handleLoadMore}\n          scrollContainerClosest={`.${styles.main}`}\n          itemSelector=\".starGiftItem\"\n        >\n          {myUniqueGiftsById && myUniqueGiftIds?.map((giftId) => {\n            const savedGift = myUniqueGiftsById[giftId];\n            if (!savedGift) return undefined;\n\n            return (\n              <GiftItemStar\n                key={giftId}\n                gift={savedGift.gift}\n                observeIntersection={observeIntersection}\n                onClick={handleMyGiftClick}\n                withTransferBadge\n              />\n            );\n          })}\n        </InfiniteScroll>\n      );\n    }\n\n    const filteredGiftIds = starGiftIdsByCategory?.[selectedCategory]?.filter((giftId) => {\n      const gift = starGiftsById?.[giftId];\n      if (!gift) return false;\n\n      const { isLimited, availabilityResale } = gift;\n\n      if (areLimitedStarGiftsDisallowed && isLimited) {\n        return !areUniqueStarGiftsDisallowed ? availabilityResale : false;\n      }\n\n      if (areUnlimitedStarGiftsDisallowed && !isLimited) return false;\n\n      return true;\n    });\n\n    return (\n      <div className={styles.starGiftsContainer}>\n        {starGiftsById && filteredGiftIds?.flatMap((giftId) => {\n          const gift = starGiftsById[giftId];\n          const shouldShowResale = Boolean(gift.availabilityResale) && !areUniqueStarGiftsDisallowed;\n          const shouldDuplicateAsResale = shouldShowResale && !gift.isSoldOut && !areLimitedStarGiftsDisallowed;\n\n          const elements = [\n            <GiftItemStar\n              key={giftId}\n              gift={gift}\n              observeIntersection={observeIntersection}\n              isResale={shouldShowResale && !shouldDuplicateAsResale}\n              onClick={handleGiftClick}\n            />,\n          ];\n\n          if (shouldDuplicateAsResale) {\n            elements.push(\n              <GiftItemStar\n                key={`resale_${giftId}`}\n                isResale\n                gift={gift}\n                observeIntersection={observeIntersection}\n                onClick={handleGiftClick}\n              />,\n            );\n          }\n\n          return elements;\n        })}\n      </div>\n    );\n  }\n\n  function renderPremiumGifts() {\n    return (\n      <div className={styles.premiumGiftsGallery}>\n        {filteredGifts?.map((gift) => {\n          return (\n            <GiftItemPremium\n              option={gift}\n              optionByStars={giftsByStars.get(gift)}\n              baseMonthAmount={baseGift ? Math.floor(baseGift.amount / baseGift.months) : undefined}\n              onClick={handleGiftClick}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n\n  const onCategoryChanged = useLastCallback((category: StarGiftCategory) => {\n    setSelectedCategory(category);\n  });\n\n  const handleCloseModal = useLastCallback(() => {\n    setSelectedGift(undefined);\n    resetResaleGifts();\n    closeGiftModal();\n  });\n\n  const handleCloseButtonClick = useLastCallback(() => {\n    if (isResaleScreen) {\n      closeResaleGiftsMarket({ tabId });\n      return;\n    }\n    if (isGiftScreen) {\n      setSelectedGift(undefined);\n      return;\n    }\n    handleCloseModal();\n  });\n\n  const handleAvatarMouseMove = useLastCallback(() => {\n    triggerSparklesRef.current?.();\n  });\n\n  const handleRequestAnimation = useLastCallback((animate: NoneToVoidFunction) => {\n    triggerSparklesRef.current = animate;\n  });\n\n  function renderMainScreen() {\n    return (\n      <div ref={scrollerRef} className={buildClassName(styles.main, 'custom-scroll')} onScroll={handleScroll}>\n        <div className={styles.avatars}>\n          <Avatar\n            className={styles.avatar}\n            size={AVATAR_SIZE}\n            peer={peer}\n            onMouseMove={handleAvatarMouseMove}\n          />\n          <InteractiveSparkles\n            className={styles.logoBackground}\n            color=\"gold\"\n            centerShift={AVATAR_SPARKLES_CENTER_SHIFT}\n            onRequestAnimation={handleRequestAnimation}\n          />\n        </div>\n        {!isSelf && !chat && !disallowedGifts?.shouldDisallowPremiumGifts && (\n          <>\n            {renderGiftPremiumHeader()}\n            {renderGiftPremiumDescription()}\n            {renderPremiumGifts()}\n          </>\n        )}\n\n        {!areAllGiftsDisallowed && (\n          <>\n            {renderStarGiftsHeader()}\n            {renderStarGiftsDescription()}\n            <StarGiftCategoryList\n              areUniqueStarGiftsDisallowed={areUniqueStarGiftsDisallowed}\n              areLimitedStarGiftsDisallowed={areLimitedStarGiftsDisallowed}\n              isSelf={isSelf}\n              hasMyUnique={Boolean(myUniqueGiftIds?.length)}\n              onCategoryChanged={onCategoryChanged}\n            />\n            <Transition\n              name=\"zoomFade\"\n              activeKey={getCategoryKey(selectedCategory)}\n              className={styles.starGiftsTransition}\n            >\n              {renderStarGifts()}\n            </Transition>\n          </>\n        )}\n      </div>\n    );\n  }\n\n  const isBackButton = isGiftScreen || isResaleScreen;\n\n  const buttonClassName = buildClassName(\n    'animated-close-icon',\n    isBackButton && 'state-back',\n  );\n\n  function renderHeader() {\n    if (!shouldShowHeader) return undefined;\n    if (isResaleScreen) {\n      const isFirstLoading = areResaleGiftsLoading && !resaleGiftsCount;\n      return (\n        <div className={styles.resaleHeaderContentContainer}>\n          <h2 className={styles.resaleHeaderText}>\n            {selectedResaleGift.title}\n          </h2>\n          {isFirstLoading\n            && (\n              <div className={styles.resaleHeaderDescription}>\n                {lang('Loading')}\n              </div>\n            )}\n          {!isFirstLoading && resaleGiftsCount !== undefined\n            && (\n              <div className={styles.resaleHeaderDescription}>\n                {lang('HeaderDescriptionResaleGifts', {\n                  count: resaleGiftsCount,\n                }, { withNodes: true, withMarkdown: true, pluralValue: resaleGiftsCount })}\n              </div>\n            )}\n          <GiftResaleFilters dialogRef={dialogRef} />\n        </div>\n      );\n    }\n    return (\n      <h2 className={styles.commonHeaderText}>\n        {lang(isHeaderForStarGifts ? (isSelf ? 'StarsGiftHeaderSelf' : 'StarsGiftHeader') : 'GiftPremiumHeader')}\n      </h2>\n    );\n  }\n\n  return (\n    <Modal\n      dialogRef={dialogRef}\n      onClose={handleCloseModal}\n      isOpen={isOpen}\n      isSlim\n      contentClassName={styles.content}\n      className={buildClassName(styles.modalDialog, styles.root)}\n      isLowStackPriority\n    >\n      <Button\n        className={styles.closeButton}\n        round\n        color=\"translucent\"\n        size=\"smaller\"\n        onClick={handleCloseButtonClick}\n        ariaLabel={isBackButton ? oldLang('Common.Back') : oldLang('Common.Close')}\n      >\n        <div className={buttonClassName} />\n      </Button>\n      <BalanceBlock className={styles.balance} balance={starBalance} withAddButton />\n      <div className={buildClassName(\n        styles.header,\n        isResaleScreen && styles.resaleHeader,\n        !shouldShowHeader && styles.hiddenHeader)}\n      >\n        <Transition\n          name=\"slideVerticalFade\"\n          activeKey={!shouldShowHeader ? 0 : isResaleScreen ? 1 : isHeaderForStarGifts ? 2 : 3}\n          slideClassName={styles.headerSlide}\n        >\n          {renderHeader()}\n        </Transition>\n      </div>\n      <Transition\n        ref={transitionRef}\n        className={styles.transition}\n        name=\"pushSlide\"\n        activeKey={isGiftScreen ? 1 : isResaleScreen ? 2 : 0}\n      >\n        {!isGiftScreen && !isResaleScreen && renderMainScreen()}\n        {isResaleScreen && selectedResaleGift\n          && (\n            <GiftModalResaleScreen\n              onGiftClick={handleGiftClick}\n            />\n          )}\n        {isGiftScreen && renderingModal?.forPeerId && (\n          <GiftSendingOptions\n            gift={selectedGift}\n            giftByStars={giftsByStars.get(selectedGift)}\n            peerId={renderingModal.forPeerId}\n          />\n        )}\n      </Transition>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global, { modal }): Complete<StateProps> => {\n  const {\n    starGifts,\n    stars,\n    currentUserId,\n  } = global;\n\n  const peer = modal?.forPeerId ? selectPeer(global, modal.forPeerId) : undefined;\n  const isSelf = Boolean(currentUserId && modal?.forPeerId === currentUserId);\n  const userFullInfo = peer ? selectUserFullInfo(global, peer?.id) : undefined;\n\n  const { resaleGifts } = selectTabState(global);\n  const resaleGiftsCount = resaleGifts.count;\n  const areResaleGiftsLoading = resaleGifts.isLoading !== false;\n  const selectedResaleGift = modal?.selectedResaleGift;\n\n  return {\n    boostPerSentGift: global.appConfig.boostsPerSentGift,\n    starGiftsById: starGifts?.byId,\n    starGiftIdsByCategory: starGifts?.idsByCategory,\n    myUniqueGiftsById: global.myUniqueGifts?.byId,\n    myUniqueGiftIds: global.myUniqueGifts?.ids,\n    starBalance: stars?.balance,\n    peer,\n    isSelf,\n    disallowedGifts: userFullInfo?.disallowedGifts,\n    resaleGiftsCount,\n    areResaleGiftsLoading,\n    selectedResaleGift,\n    tabId: selectTabState(global).id,\n  };\n})(GiftModal));\n\nfunction getCategoryKey(category: StarGiftCategory) {\n  if (category === 'all') return 0;\n  if (category === 'myUnique') return 1;\n  return 2;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"W3JMs1YE\",\"picker\":\"wOipz1Y_\"};","import {\n  memo, useMemo, useState,\n} from '../../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../../global';\n\nimport { filterPeersByQuery } from '../../../../global/helpers/peers';\nimport { selectCanGift } from '../../../../global/selectors';\nimport { unique } from '../../../../util/iteratees';\nimport sortChatIds from '../../../common/helpers/sortChatIds';\n\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useOldLang from '../../../../hooks/useOldLang';\n\nimport PeerPicker from '../../../common/pickers/PeerPicker';\nimport PickerModal from '../../../common/pickers/PickerModal';\n\nimport styles from './GiftRecipientPicker.module.scss';\n\nexport type OwnProps = {\n  modal?: boolean;\n};\n\ninterface StateProps {\n  currentUserId?: string;\n  userIds?: string[];\n}\n\nconst GiftRecipientPicker = ({\n  modal,\n  currentUserId,\n  userIds,\n}: OwnProps & StateProps) => {\n  const { closeGiftRecipientPicker, openGiftModal } = getActions();\n\n  const oldLang = useOldLang();\n  const isOpen = modal;\n\n  const [searchQuery, setSearchQuery] = useState<string>('');\n\n  const displayedUserIds = useMemo(() => {\n    const global = getGlobal();\n    const idsWithSelf = userIds ? userIds.concat(currentUserId!) : undefined;\n    const filteredPeerIds = idsWithSelf ? filterPeersByQuery({ ids: idsWithSelf, query: searchQuery }) : [];\n\n    return sortChatIds(unique(filteredPeerIds).filter((peerId) => {\n      return selectCanGift(global, peerId);\n    }), undefined, [currentUserId!]);\n  }, [currentUserId, searchQuery, userIds]);\n\n  const handleSelectedUserIdsChange = useLastCallback((selectedId: string) => {\n    openGiftModal({ forUserId: selectedId });\n    closeGiftRecipientPicker();\n  });\n\n  return (\n    <PickerModal\n      className={styles.root}\n      isOpen={isOpen}\n      onClose={closeGiftRecipientPicker}\n      title={oldLang('GiftTelegramPremiumOrStarsTitle')}\n      hasCloseButton\n      shouldAdaptToSearch\n      withFixedHeight\n    >\n      <PeerPicker\n        className={styles.picker}\n        itemIds={displayedUserIds}\n        filterValue={searchQuery}\n        filterPlaceholder={oldLang('Search')}\n        onSelectedIdChange={handleSelectedUserIdsChange}\n        onFilterChange={setSearchQuery}\n        isSearchable\n        withDefaultPadding\n        withStatus\n        forceShowSelf\n      />\n    </PickerModal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global): Complete<StateProps> => {\n  const { currentUserId } = global;\n\n  return {\n    currentUserId,\n    userIds: global.contactList?.userIds,\n  };\n})(GiftRecipientPicker));\n","import type { TeactNode } from '../../../lib/teact/teact';\n\nimport type { ApiPeer, ApiStarGiftAttributeOriginalDetails } from '../../../api/types';\n\nimport { getPeerTitle } from '../../../global/helpers/peers';\nimport { formatDateTimeToString } from '../../../util/dates/dateFormat';\nimport { type LangFn } from '../../../util/localization';\nimport { renderTextWithEntities } from './renderTextWithEntities';\n\nimport Link from '../../ui/Link';\n\ntype GiftOriginalInfoOptions = {\n  originalDetails: ApiStarGiftAttributeOriginalDetails;\n  recipient: ApiPeer;\n  sender?: ApiPeer;\n  onOpenChat: (peerId: string) => void;\n  lang: LangFn;\n};\n\nexport function renderGiftOriginalInfo({\n  originalDetails,\n  recipient,\n  sender,\n  onOpenChat,\n  lang,\n}: GiftOriginalInfoOptions): TeactNode | undefined {\n  const { recipientId, senderId, date, message } = originalDetails;\n\n  const formattedDate = formatDateTimeToString(date * 1000, lang.code, true);\n  const recipientLink = (\n    <Link onClick={() => onOpenChat(recipientId)} isPrimary>\n      {getPeerTitle(lang, recipient)}\n    </Link>\n  );\n\n  if (!sender || senderId === recipientId) {\n    return message\n      ? lang('GiftInfoPeerOriginalInfoText', {\n        peer: recipientLink,\n        text: renderTextWithEntities(message),\n        date: formattedDate,\n      }, {\n        withNodes: true,\n      })\n      : lang('GiftInfoPeerOriginalInfo', {\n        peer: recipientLink,\n        date: formattedDate,\n      }, {\n        withNodes: true,\n      });\n  }\n\n  const senderLink = (\n    <Link onClick={() => onOpenChat(sender.id)} isPrimary>\n      {getPeerTitle(lang, sender)}\n    </Link>\n  );\n\n  return message\n    ? lang('GiftInfoPeerOriginalInfoTextSender', {\n      peer: recipientLink,\n      sender: senderLink,\n      text: renderTextWithEntities(message),\n      date: formattedDate,\n    }, {\n      withNodes: true,\n    })\n    : lang('GiftInfoPeerOriginalInfoSender', {\n      peer: recipientLink,\n      date: formattedDate,\n      sender: senderLink,\n    }, {\n      withNodes: true,\n    });\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"Ef0cKSqQ\",\"giftPreview\":\"IvuNzslN\",\"backdrop\":\"dNukis4X\",\"arrow\":\"oufsMLLF\"};","import { memo, useMemo } from '../../../lib/teact/teact';\n\nimport type {\n  ApiPeer, ApiStarGiftUnique,\n} from '../../../api/types';\n\nimport { getGiftAttributes } from '../helpers/gifts';\nimport { REM } from '../helpers/mediaDimensions';\n\nimport AnimatedIconFromSticker from '../AnimatedIconFromSticker';\nimport Avatar from '../Avatar';\nimport Icon from '../icons/Icon';\nimport RadialPatternBackground from '../profile/RadialPatternBackground';\n\nimport styles from './GiftTransferPreview.module.scss';\n\ntype OwnProps = {\n  peer: ApiPeer;\n  gift: ApiStarGiftUnique;\n};\n\nconst AVATAR_SIZE = 4 * REM;\nconst GIFT_STICKER_SIZE = 3 * REM;\n\nconst GiftTransferPreview = ({\n  peer,\n  gift,\n}: OwnProps) => {\n  const giftAttributes = useMemo(() => {\n    return getGiftAttributes(gift);\n  }, [gift]);\n\n  if (!giftAttributes) return undefined;\n\n  return (\n    <div className={styles.root}>\n      <div className={styles.giftPreview}>\n        <RadialPatternBackground\n          className={styles.backdrop}\n          backgroundColors={[giftAttributes.backdrop!.centerColor, giftAttributes.backdrop!.edgeColor]}\n          patternIcon={giftAttributes.pattern?.sticker}\n          ringsCount={1}\n          ovalFactor={1}\n          patternSize={12}\n        />\n        <AnimatedIconFromSticker\n          className={styles.sticker}\n          size={GIFT_STICKER_SIZE}\n          sticker={giftAttributes.model?.sticker}\n        />\n      </div>\n      <Icon name=\"next\" className={styles.arrow} />\n      <Avatar\n        peer={peer}\n        size={AVATAR_SIZE}\n        className={styles.avatar}\n      />\n    </div>\n  );\n};\n\nexport default memo(GiftTransferPreview);\n","// extracted by mini-css-extract-plugin\nexport default {\"modal\":\"nnublcCk\",\"checkBox\":\"fjE0wGvw\",\"checkBoxDescription\":\"tepUTe4z\",\"upgradeIcon\":\"lgyInH5K\",\"descriptionConfirm\":\"BJh2Tufh\",\"titleConfirm\":\"gA102W1G\",\"header\":\"p7FTs7_p\",\"title\":\"pIbzzTir\",\"description\":\"CCPfr26t\",\"soldOut\":\"kjWcRp4W\",\"modalContent\":\"o9rFZ6By\",\"headerSplitButton\":\"XOMI_4PO\",\"headerButton\":\"WA0INleU\",\"giftResalePriceContainer\":\"BN8gf5y6\",\"starAmountIcon\":\"_5guecUe\",\"giftResalePriceStar\":\"H_q8o2vY\",\"left\":\"aOhTHZlf\",\"right\":\"rJOB1u5Q\",\"footer\":\"bho0GTYt\",\"footerDescription\":\"VUylTszM\",\"unknown\":\"zDauXmpS\",\"giftValue\":\"w_E4LkUj\",\"uniqueValue\":\"uAjIRJva\",\"uniqueAttribute\":\"OJQnkf17\",\"attributeName\":\"dq7wCHJb\",\"uniqueGift\":\"I6o_pGAm\",\"modalHeader\":\"ie9tImaj\",\"modalCloseButton\":\"p38RBGdC\",\"ownerAddress\":\"DavMRg4Q\",\"copyIcon\":\"SLX5tX8C\",\"messageContainer\":\"oW5T3mkV\",\"removeMessageButton\":\"TrW2LVm5\"};","import { memo, useMemo, useRef, useState } from '../../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../../global';\n\nimport type {\n  ApiEmojiStatusType,\n  ApiPeer,\n  ApiUser,\n} from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../../../../config';\nimport { getHasAdminRight } from '../../../../global/helpers';\nimport { getPeerTitle, isApiPeerChat, isApiPeerUser } from '../../../../global/helpers/peers';\nimport { getMainUsername } from '../../../../global/helpers/users';\nimport { selectPeer, selectUser } from '../../../../global/selectors';\nimport buildClassName from '../../../../util/buildClassName';\nimport { copyTextToClipboard } from '../../../../util/clipboard';\nimport { formatDateTimeToString } from '../../../../util/dates/dateFormat';\nimport { formatCurrencyAsString } from '../../../../util/formatCurrency';\nimport {\n  formatStarsAsIcon, formatStarsAsText, formatTonAsIcon, formatTonAsText,\n} from '../../../../util/localization/format';\nimport { CUSTOM_PEER_HIDDEN } from '../../../../util/objects/customPeer';\nimport { getServerTime } from '../../../../util/serverTime';\nimport { formatPercent } from '../../../../util/textFormat';\nimport { renderGiftOriginalInfo } from '../../../common/helpers/giftOriginalInfo';\nimport { getGiftAttributes, getStickerFromGift } from '../../../common/helpers/gifts';\nimport { renderTextWithEntities } from '../../../common/helpers/renderTextWithEntities';\n\nimport useContextMenuHandlers from '../../../../hooks/useContextMenuHandlers';\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useFlag from '../../../../hooks/useFlag';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useOldLang from '../../../../hooks/useOldLang';\n\nimport AnimatedIconFromSticker from '../../../common/AnimatedIconFromSticker';\nimport Avatar from '../../../common/Avatar';\nimport BadgeButton from '../../../common/BadgeButton';\nimport GiftMenuItems from '../../../common/gift/GiftMenuItems';\nimport GiftTransferPreview from '../../../common/gift/GiftTransferPreview';\nimport Icon from '../../../common/icons/Icon';\nimport SafeLink from '../../../common/SafeLink';\nimport Button from '../../../ui/Button';\nimport Checkbox from '../../../ui/Checkbox';\nimport ConfirmDialog from '../../../ui/ConfirmDialog';\nimport Link from '../../../ui/Link';\nimport Menu from '../../../ui/Menu';\nimport TableInfoModal, { type TableData } from '../../common/TableInfoModal';\nimport UniqueGiftHeader from '../UniqueGiftHeader';\n\nimport styles from './GiftInfoModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftInfoModal'];\n};\n\ntype StateProps = {\n  fromPeer?: ApiPeer;\n  targetPeer?: ApiPeer;\n  releasedByPeer?: ApiPeer;\n  currentUserId?: string;\n  starGiftMaxConvertPeriod?: number;\n  hasAdminRights?: boolean;\n  currentUserEmojiStatus?: ApiEmojiStatusType;\n  collectibleEmojiStatuses?: ApiEmojiStatusType[];\n  tonExplorerUrl?: string;\n  currentUser?: ApiUser;\n  recipientPeer?: ApiPeer;\n};\n\nconst STICKER_SIZE = 120;\n\nconst GiftInfoModal = ({\n  modal,\n  fromPeer,\n  targetPeer,\n  releasedByPeer,\n  currentUserId,\n  starGiftMaxConvertPeriod,\n  hasAdminRights,\n  currentUserEmojiStatus,\n  collectibleEmojiStatuses,\n  tonExplorerUrl,\n  currentUser,\n  recipientPeer,\n}: OwnProps & StateProps) => {\n  const {\n    closeGiftInfoModal,\n    changeGiftVisibility,\n    convertGiftToStars,\n    openChatWithInfo,\n    focusMessage,\n    openGiftUpgradeModal,\n    showNotification,\n    buyStarGift,\n    closeGiftModal,\n    openGiftInfoValueModal,\n    updateResaleGiftsFilter,\n    openGiftInMarket,\n    openGiftDescriptionRemoveModal,\n  } = getActions();\n\n  const [isConvertConfirmOpen, openConvertConfirm, closeConvertConfirm] = useFlag();\n\n  const lang = useLang();\n  const oldLang = useOldLang();\n  const [isConfirmModalOpen, setIsConfirmModalOpen] = useState<boolean>(false);\n  const [shouldPayInTon, setShouldPayInTon] = useState<boolean>(false);\n\n  const splitButtonRef = useRef<HTMLDivElement>();\n  const menuRef = useRef<HTMLDivElement>();\n  const uniqueGiftHeaderRef = useRef<HTMLDivElement>();\n  const {\n    isContextMenuOpen,\n    contextMenuAnchor,\n    handleContextMenu,\n    handleContextMenuClose,\n    handleContextMenuHide,\n  } = useContextMenuHandlers(splitButtonRef);\n\n  const handleSymbolClick = useLastCallback(() => {\n    if (!gift || !giftAttributes?.pattern) return;\n\n    openGiftInMarket({ gift });\n    updateResaleGiftsFilter({\n      filter: {\n        sortType: 'byDate',\n        modelAttributes: [],\n        backdropAttributes: [],\n        patternAttributes: [{\n          type: 'pattern',\n          documentId: giftAttributes.pattern.sticker.id,\n        }],\n      },\n    });\n  });\n\n  const handleBackdropClick = useLastCallback(() => {\n    if (!gift || !giftAttributes?.backdrop) return;\n\n    openGiftInMarket({ gift });\n    updateResaleGiftsFilter({\n      filter: {\n        sortType: 'byDate',\n        modelAttributes: [],\n        backdropAttributes: [{\n          type: 'backdrop',\n          backdropId: giftAttributes.backdrop.backdropId,\n        }],\n        patternAttributes: [],\n      },\n    });\n  });\n\n  const handleModelClick = useLastCallback(() => {\n    if (!gift || !giftAttributes?.model) return;\n\n    openGiftInMarket({ gift });\n    updateResaleGiftsFilter({\n      filter: {\n        sortType: 'byDate',\n        modelAttributes: [{\n          type: 'model',\n          documentId: giftAttributes.model.sticker.id,\n        }],\n        backdropAttributes: [],\n        patternAttributes: [],\n      },\n    });\n  });\n\n  const isOpen = Boolean(modal);\n  const renderingModal = useCurrentOrPrev(modal);\n  const renderingFromPeer = useCurrentOrPrev(fromPeer);\n  const renderingTargetPeer = useCurrentOrPrev(targetPeer);\n\n  const isTargetChat = renderingTargetPeer && isApiPeerChat(renderingTargetPeer);\n\n  const { gift: typeGift } = renderingModal || {};\n  const isSavedGift = typeGift && 'gift' in typeGift;\n  const savedGift = isSavedGift ? typeGift : undefined;\n  const isSender = savedGift?.fromId === currentUserId;\n  const canConvertDifference = (savedGift && starGiftMaxConvertPeriod && (\n    savedGift.date + starGiftMaxConvertPeriod - getServerTime()\n  )) || 0;\n  const conversionLeft = Math.ceil(canConvertDifference / 60 / 60 / 24);\n\n  const gift = isSavedGift ? typeGift.gift : typeGift;\n  const giftSticker = gift && getStickerFromGift(gift);\n  const hasConvertOption = canConvertDifference > 0 && Boolean(savedGift?.starsToConvert);\n\n  const isGiftUnique = gift && gift.type === 'starGiftUnique';\n  const uniqueGift = isGiftUnique ? gift : undefined;\n\n  const giftSubtitle = useMemo(() => {\n    if (!gift || gift.type !== 'starGiftUnique') return undefined;\n\n    if (releasedByPeer) {\n      const releasedByUsername = `@${getMainUsername(releasedByPeer)}`;\n      const ownerTitle = releasedByUsername || getPeerTitle(lang, releasedByPeer);\n      const fallbackText = isApiPeerUser(releasedByPeer)\n        ? lang('ActionFallbackUser')\n        : lang('ActionFallbackChannel');\n\n      return lang('GiftInfoCollectibleBy', {\n        number: gift.number, owner: ownerTitle || fallbackText }, {\n        withNodes: true,\n        withMarkdown: true,\n      });\n    }\n\n    return lang('GiftInfoCollectible', { number: gift.number });\n  }, [gift, releasedByPeer, lang]);\n\n  const starGiftUniqueSlug = gift?.type === 'starGiftUnique' ? gift.slug : undefined;\n\n  const selfCollectibleStatus = useMemo(() => {\n    if (!starGiftUniqueSlug) return undefined;\n    return collectibleEmojiStatuses?.find((status) =>\n      status.type === 'collectible' && status.slug === starGiftUniqueSlug);\n  }, [starGiftUniqueSlug, collectibleEmojiStatuses]);\n\n  const isSelfUnique = Boolean(selfCollectibleStatus);\n  const canFocusUpgrade = Boolean(savedGift?.upgradeMsgId);\n\n  const canManage = !canFocusUpgrade && savedGift?.inputGift && (\n    isTargetChat ? hasAdminRights\n      : gift?.type === 'starGift'\n        ? renderingTargetPeer?.id === currentUserId\n        : gift?.ownerId === currentUserId || isSelfUnique\n  );\n\n  function getResalePrice(isInTon?: boolean) {\n    if (!isGiftUnique) return undefined;\n    const amounts = gift.resellPrice;\n    if (!amounts) return undefined;\n\n    if (gift?.resaleTonOnly || isInTon) {\n      return amounts.find((amount) => amount.currency === TON_CURRENCY_CODE);\n    }\n\n    return amounts.find((amount) => amount.currency === STARS_CURRENCY_CODE);\n  }\n\n  const resellPrice = getResalePrice();\n  const confirmPrice = getResalePrice(shouldPayInTon);\n  const canBuyGift = !isSelfUnique && gift?.type === 'starGiftUnique'\n    && gift.ownerId !== currentUserId && Boolean(resellPrice);\n\n  const giftOwnerTitle = (() => {\n    if (!isGiftUnique) return undefined;\n    const { ownerName, ownerId } = gift;\n    const global = getGlobal(); // Peer titles do not need to be reactive\n    const owner = ownerId ? selectPeer(global, ownerId) : undefined;\n    return owner ? getPeerTitle(lang, owner) : ownerName;\n  })();\n\n  const handleClose = useLastCallback(() => {\n    closeGiftInfoModal();\n  });\n\n  const handleFocusUpgraded = useLastCallback(() => {\n    const giftChat = isSender ? renderingTargetPeer : renderingFromPeer;\n    if (!savedGift?.upgradeMsgId || !giftChat) return;\n    const { upgradeMsgId } = savedGift;\n    focusMessage({ chatId: giftChat.id, messageId: upgradeMsgId });\n    handleClose();\n  });\n\n  const handleTriggerVisibility = useLastCallback(() => {\n    const { inputGift, isUnsaved } = savedGift!;\n    changeGiftVisibility({ gift: inputGift!, shouldUnsave: !isUnsaved });\n    handleClose();\n  });\n\n  const handleConvertToStars = useLastCallback(() => {\n    const { inputGift } = savedGift!;\n    convertGiftToStars({ gift: inputGift! });\n    closeConvertConfirm();\n    handleClose();\n  });\n\n  const handleRemoveMessage = useLastCallback(() => {\n    if (!savedGift?.inputGift || !savedGift.dropOriginalDetailsStars || !gift || !giftAttributes) return;\n\n    const { originalDetails } = giftAttributes;\n    if (!originalDetails) return;\n\n    openGiftDescriptionRemoveModal({\n      gift: savedGift,\n      price: savedGift.dropOriginalDetailsStars,\n      details: originalDetails,\n    });\n  });\n\n  const handleOpenUpgradeModal = useLastCallback(() => {\n    if (!savedGift) return;\n    const giftOwnerId = renderingTargetPeer?.id;\n    openGiftUpgradeModal({ giftId: savedGift.gift.id, gift: savedGift, peerId: giftOwnerId });\n  });\n\n  const handleBuyGift = useLastCallback(() => {\n    if (gift?.type !== 'starGiftUnique' || !getResalePrice()) return;\n    setIsConfirmModalOpen(true);\n  });\n\n  const closeConfirmModal = useLastCallback(() => {\n    setIsConfirmModalOpen(false);\n  });\n\n  const handleConfirmBuyGift = useLastCallback(() => {\n    const peer = recipientPeer || currentUser;\n    const price = getResalePrice(shouldPayInTon);\n    if (!peer || !price || gift?.type !== 'starGiftUnique') return;\n    closeConfirmModal();\n    closeGiftModal();\n    buyStarGift({ peerId: peer.id, slug: gift.slug, price });\n  });\n\n  const handleOpenValueModal = useLastCallback(() => {\n    if (!gift || gift.type !== 'starGiftUnique') return;\n\n    openGiftInfoValueModal({\n      gift,\n    });\n  });\n\n  const giftAttributes = useMemo(() => {\n    return gift && getGiftAttributes(gift);\n  }, [gift]);\n\n  const SettingsMenuButton = useMemo(() => {\n    return (\n      <div\n        className={buildClassName(\n          styles.headerButton,\n          styles.left,\n        )}\n        tabIndex={0}\n        role=\"button\"\n        aria-haspopup=\"menu\"\n        aria-label={lang('AriaMoreButton')}\n        onContextMenu={handleContextMenu}\n        onClick={handleContextMenu}\n      >\n        <Icon\n          name=\"more\"\n          className={styles.icon}\n        />\n      </div>\n    );\n  }, [lang, handleContextMenu]);\n\n  const renderFooterButton = useLastCallback(() => {\n    if (canBuyGift) {\n      return (\n        <Button noForcedUpperCase onClick={handleBuyGift}>\n          {lang('ButtonBuyGift', {\n            stars: resellPrice?.currency === TON_CURRENCY_CODE\n              ? formatTonAsIcon(lang, resellPrice.amount, { shouldConvertFromNanos: true })\n              : formatStarsAsIcon(lang, resellPrice?.amount, { asFont: true }),\n          }, { withNodes: true })}\n        </Button>\n      );\n    }\n\n    if (canFocusUpgrade) {\n      return (\n        <Button onClick={handleFocusUpgraded}>\n          {lang('GiftInfoViewUpgraded')}\n        </Button>\n      );\n    }\n\n    if (canManage && savedGift?.alreadyPaidUpgradeStars && !savedGift.upgradeMsgId) {\n      return (\n        <Button isShiny onClick={handleOpenUpgradeModal}>\n          {lang('GiftInfoUpgradeForFree')}\n          <Icon name=\"arrow-down-circle\" className={styles.upgradeIcon} />\n        </Button>\n      );\n    }\n\n    if (canManage && savedGift?.canUpgrade && !savedGift.upgradeMsgId) {\n      return (\n        <Button isShiny onClick={handleOpenUpgradeModal}>\n          {lang('GiftInfoUpgrade')}\n          <Icon name=\"arrow-down-circle\" className={styles.upgradeIcon} />\n        </Button>\n      );\n    }\n\n    if (savedGift?.prepaidUpgradeHash) {\n      return (\n        <Button isShiny onClick={handleOpenUpgradeModal}>\n          {lang('GiftAnUpgradeButton')}\n          <Icon name=\"arrow-down-circle\" className={styles.upgradeIcon} />\n        </Button>\n      );\n    }\n\n    return (\n      <Button onClick={handleClose}>\n        {lang('OK')}\n      </Button>\n    );\n  });\n\n  const saleDateInfo = useMemo(() => {\n    if (!gift) return undefined;\n    let text = '';\n    if (gift.type === 'starGift') {\n      if (gift.firstSaleDate) {\n        text += `${lang('GiftInfoFirstSale')} ${formatDateTimeToString(gift.firstSaleDate * 1000, lang.code, true)}`;\n      }\n      if (gift.lastSaleDate) {\n        text += '\\n';\n        text += `${lang('GiftInfoLastSale')} ${formatDateTimeToString(gift.lastSaleDate * 1000, lang.code, true)}`;\n      }\n    }\n\n    return text;\n  }, [gift, lang]);\n\n  const modalData = useMemo(() => {\n    if (!typeGift || !gift) {\n      return undefined;\n    }\n\n    const {\n      fromId, isNameHidden, starsToConvert, isUnsaved, isConverted, upgradeMsgId,\n    } = savedGift || {};\n    const canConvert = hasConvertOption && Boolean(starsToConvert);\n\n    const isVisibleForMe = isNameHidden && renderingTargetPeer;\n\n    const description = (() => {\n      if (!savedGift) return lang('GiftInfoSoldOutDescription');\n      if (isTargetChat) return undefined;\n\n      if (savedGift.upgradeMsgId) return lang('GiftInfoDescriptionUpgraded');\n      if (canManage && savedGift.canUpgrade && savedGift.alreadyPaidUpgradeStars && !savedGift.upgradeMsgId) {\n        return lang('GiftInfoDescriptionUpgrade2');\n      }\n      if (savedGift.canUpgrade && canManage) {\n        return canManage\n          ? lang('GiftInfoDescriptionFreeUpgrade')\n          : lang('GiftInfoPeerDescriptionFreeUpgradeOut', { peer: getPeerTitle(lang, renderingTargetPeer!)! });\n      }\n      if (!canManage && !isSender) return undefined;\n      if (isConverted && canConvert) {\n        return canManage\n          ? lang('GiftInfoDescriptionConverted', {\n            amount: starsToConvert,\n          }, {\n            pluralValue: starsToConvert,\n            withNodes: true,\n            withMarkdown: true,\n          })\n          : lang('GiftInfoPeerDescriptionOutConverted', {\n            amount: starsToConvert,\n            peer: getPeerTitle(lang, renderingTargetPeer!)!,\n          }, {\n            pluralValue: starsToConvert,\n            withNodes: true,\n            withMarkdown: true,\n          });\n      }\n\n      if (savedGift.canUpgrade && canManage) {\n        if (canConvert) {\n          return lang('GiftInfoDescriptionUpgrade', {\n            amount: starsToConvert,\n          }, {\n            pluralValue: starsToConvert,\n            withNodes: true,\n            withMarkdown: true,\n          });\n        }\n\n        return lang('GiftInfoDescriptionUpgradeRegular');\n      }\n\n      if (canManage) {\n        if (canConvert) {\n          return lang('GiftInfoDescription', {\n            amount: starsToConvert,\n          }, {\n            withNodes: true,\n            withMarkdown: true,\n            pluralValue: starsToConvert,\n          });\n        }\n\n        return lang('GiftInfoDescriptionRegular');\n      }\n\n      if (canConvert) {\n        return lang('GiftInfoPeerDescriptionOut', {\n          amount: starsToConvert,\n          peer: getPeerTitle(lang, renderingTargetPeer!)!,\n        }, {\n          withNodes: true,\n          withMarkdown: true,\n          pluralValue: starsToConvert,\n        });\n      }\n\n      return lang('GiftInfoPeerDescriptionOutRegular', { peer: getPeerTitle(lang, renderingTargetPeer!)! });\n    })();\n\n    function getTitle() {\n      if (isGiftUnique) return gift.title;\n      if (!savedGift) return lang('GiftInfoSoldOutTitle');\n\n      return canManage ? lang('GiftInfoReceived') : lang('GiftInfoTitle');\n    }\n\n    const uniqueGiftModalHeader = (\n      <div\n        className={styles.modalHeader}\n      >\n        {Boolean(resellPrice?.amount) && (\n          <div className={styles.giftResalePriceContainer}>\n            {resellPrice.currency === TON_CURRENCY_CODE\n              ? formatTonAsIcon(lang, resellPrice.amount, {\n                className: styles.giftResalePriceStar,\n                shouldConvertFromNanos: true,\n              })\n              : formatStarsAsIcon(lang, resellPrice.amount, {\n                asFont: true,\n                className: styles.giftResalePriceStar,\n              })}\n          </div>\n        )}\n        <div className={styles.headerSplitButton} ref={splitButtonRef}>\n          {SettingsMenuButton}\n          <div\n            className={buildClassName(\n              styles.headerButton,\n              styles.right,\n            )}\n            tabIndex={0}\n            role=\"button\"\n            aria-haspopup=\"menu\"\n            aria-label={lang('Close')}\n            onClick={handleClose}\n          >\n            <Icon\n              name=\"close\"\n              className={buildClassName(\n                styles.icon,\n                styles.moreIcon,\n              )}\n            />\n          </div>\n        </div>\n      </div>\n    );\n\n    const uniqueGiftHeader = isGiftUnique && (\n      <div ref={uniqueGiftHeaderRef} className={buildClassName(styles.header, styles.uniqueGift)}>\n        <UniqueGiftHeader\n          backdropAttribute={giftAttributes!.backdrop!}\n          patternAttribute={giftAttributes!.pattern!}\n          modelAttribute={giftAttributes!.model!}\n          title={gift.title}\n          subtitle={giftSubtitle}\n          subtitlePeer={releasedByPeer}\n          showManageButtons={canManage}\n          savedGift={savedGift}\n        />\n      </div>\n    );\n\n    const regularHeader = (\n      <div className={styles.header}>\n        <AnimatedIconFromSticker\n          className={styles.giftSticker}\n          sticker={giftSticker}\n          size={STICKER_SIZE}\n        />\n        <h1 className={styles.title}>\n          {getTitle()}\n        </h1>\n        {Boolean(description) && (\n          <p className={buildClassName(styles.description, !savedGift && gift?.type === 'starGift' && styles.soldOut)}>\n            {description}\n          </p>\n        )}\n      </div>\n    );\n\n    const tableData: TableData = [];\n    if (gift.type === 'starGift') {\n      const hasFrom = fromId || isNameHidden;\n\n      if (hasFrom) {\n        tableData.push([\n          lang('GiftInfoFrom'),\n          !fromId ? (\n            <>\n              <Avatar size=\"small\" peer={CUSTOM_PEER_HIDDEN} />\n              <span className={styles.unknown}>{oldLang(CUSTOM_PEER_HIDDEN.titleKey!)}</span>\n            </>\n          ) : { chatId: fromId },\n        ]);\n      }\n\n      if (savedGift?.date) {\n        tableData.push([\n          lang('GiftInfoDate'),\n          <span title={saleDateInfo}>{formatDateTimeToString(savedGift.date * 1000, lang.code, true)}</span>,\n        ]);\n      }\n\n      if (gift.firstSaleDate && !savedGift) {\n        tableData.push([\n          lang('GiftInfoFirstSale'),\n          formatDateTimeToString(gift.firstSaleDate * 1000, lang.code, true),\n        ]);\n      }\n\n      if (gift.lastSaleDate && !savedGift) {\n        tableData.push([\n          lang('GiftInfoLastSale'),\n          formatDateTimeToString(gift.lastSaleDate * 1000, lang.code, true),\n        ]);\n      }\n\n      const starsValue = gift.stars + (savedGift?.alreadyPaidUpgradeStars || 0);\n\n      tableData.push([\n        lang('GiftInfoValue'),\n        <div className={styles.giftValue}>\n          {formatStarsAsIcon(lang, starsValue, { className: styles.starAmountIcon })}\n          {canManage && hasConvertOption && Boolean(starsToConvert) && (\n            <BadgeButton onClick={openConvertConfirm}>\n              {lang('GiftInfoConvert', { amount: starsToConvert }, { pluralValue: starsToConvert })}\n            </BadgeButton>\n          )}\n        </div>,\n      ]);\n\n      if (gift.availabilityTotal) {\n        tableData.push([\n          lang('GiftInfoAvailability'),\n          lang('GiftInfoAvailabilityValue', {\n            count: gift.availabilityRemains || 0,\n            total: gift.availabilityTotal,\n          }, {\n            pluralValue: gift.availabilityRemains || 0,\n          }),\n        ]);\n      }\n\n      if (gift.upgradeStars && !upgradeMsgId) {\n        tableData.push([\n          lang('GiftInfoStatus'),\n          <div className={styles.giftValue}>\n            {lang('GiftInfoStatusNonUnique')}\n          </div>,\n        ]);\n      }\n\n      if (savedGift?.message) {\n        tableData.push([\n          undefined,\n          renderTextWithEntities(savedGift.message),\n        ]);\n      }\n    }\n\n    if (isGiftUnique) {\n      const { ownerName, ownerAddress, ownerId } = gift;\n      const ownerPeer = ownerId ? selectPeer(getGlobal(), ownerId) : undefined;\n      const {\n        model, backdrop, pattern, originalDetails,\n      } = giftAttributes || {};\n\n      if (ownerAddress) {\n        tableData.push([\n          lang('GiftInfoOwner'),\n          <span\n            className={styles.ownerAddress}\n            onClick={() => {\n              copyTextToClipboard(ownerAddress);\n              showNotification({\n                message: { key: 'WalletAddressCopied' },\n                icon: 'copy',\n              });\n            }}\n          >\n            {ownerAddress}\n            <Icon className={styles.copyIcon} name=\"copy\" />\n          </span>,\n        ]);\n      } else if (ownerPeer || ownerName) {\n        tableData.push([\n          lang('GiftInfoOwner'),\n          ownerId ? { chatId: ownerId, withEmojiStatus: true } : ownerName || '',\n        ]);\n      }\n\n      if (model) {\n        tableData.push([\n          lang('GiftAttributeModel'),\n          <span className={styles.uniqueAttribute}>\n            <span\n              className={styles.attributeName}\n              onClick={handleModelClick}\n            >\n              {model.name}\n            </span>\n            <BadgeButton>{formatPercent(model.rarityPercent)}</BadgeButton>\n          </span>,\n        ]);\n      }\n\n      if (backdrop) {\n        tableData.push([\n          lang('GiftAttributeBackdrop'),\n          <span className={styles.uniqueAttribute}>\n            <span\n              className={styles.attributeName}\n              onClick={handleBackdropClick}\n            >\n              {backdrop.name}\n            </span>\n            <BadgeButton>{formatPercent(backdrop.rarityPercent)}</BadgeButton>\n          </span>,\n        ]);\n      }\n\n      if (pattern) {\n        tableData.push([\n          lang('GiftAttributeSymbol'),\n          <span className={styles.uniqueAttribute}>\n            <span\n              className={styles.attributeName}\n              onClick={handleSymbolClick}\n            >\n              {pattern.name}\n            </span>\n            <BadgeButton>{formatPercent(pattern.rarityPercent)}</BadgeButton>\n          </span>,\n        ]);\n      }\n\n      tableData.push([\n        lang('GiftInfoAvailability'),\n        lang('GiftInfoIssued', {\n          issued: gift.issuedCount,\n          total: gift.totalCount,\n        }),\n      ]);\n\n      if (gift.valueAmount && gift.valueCurrency) {\n        tableData.push([\n          lang('GiftInfoValue'),\n          <span className={styles.uniqueValue}>\n            ~\n            {' '}\n            {formatCurrencyAsString(\n              gift.valueAmount,\n              gift.valueCurrency,\n              lang.code,\n            )}\n            <BadgeButton onClick={handleOpenValueModal}>\n              {lang('GiftInfoValueLinkMore')}\n            </BadgeButton>\n          </span>,\n        ]);\n      }\n\n      if (originalDetails) {\n        const { recipientId, senderId } = originalDetails;\n        const global = getGlobal(); // Peer titles do not need to be reactive\n\n        const openChat = (id: string) => {\n          openChatWithInfo({ id });\n          closeGiftInfoModal();\n        };\n\n        const recipient = selectPeer(global, recipientId)!;\n        const sender = senderId ? selectPeer(global, senderId) : undefined;\n\n        const text = renderGiftOriginalInfo({\n          originalDetails, recipient, sender, onOpenChat: openChat, lang,\n        });\n\n        tableData.push([\n          undefined,\n          <div className={styles.messageContainer}>\n            <div>\n              {text}\n            </div>\n            {Boolean(savedGift?.dropOriginalDetailsStars) && (\n              <Button\n                round\n                className={styles.removeMessageButton}\n                size=\"smaller\"\n                color=\"translucent\"\n                ariaLabel=\"Delete original details\"\n                onClick={handleRemoveMessage}\n              >\n                <Icon name=\"delete\" />\n              </Button>\n            )}\n          </div>,\n        ]);\n      }\n    }\n\n    const tonLink = tonExplorerUrl && isGiftUnique && gift.giftAddress && (\n      `${tonExplorerUrl}${gift.giftAddress}`\n    );\n\n    const footer = (\n      <div className={styles.footer}>\n        {(canManage || tonLink || canBuyGift) && (\n          <div className={styles.footerDescription}>\n            {tonLink && (\n              <div>\n                {lang('GiftInfoTonText', {\n                  link: <SafeLink url={tonLink} shouldSkipModal text={lang('GiftInfoTonLinkText')} />,\n                }, { withNodes: true })}\n              </div>\n            )}\n            {canManage && (\n              <div>\n                {lang(`GiftInfo${isTargetChat ? 'Channel' : ''}${isUnsaved ? 'Hidden' : 'Saved'}`, {\n                  link: (\n                    <Link isPrimary onClick={handleTriggerVisibility}>\n                      {lang(`GiftInfoSaved${isUnsaved ? 'Show' : 'Hide'}`)}\n                    </Link>\n                  ),\n                }, {\n                  withNodes: true,\n                })}\n              </div>\n            )}\n            {!canBuyGift && isVisibleForMe && (\n              <div>\n                {lang('GiftInfoSenderHidden')}\n              </div>\n            )}\n            {canBuyGift && giftOwnerTitle && (\n              <div>\n                {lang('GiftInfoBuyGift', {\n                  user: giftOwnerTitle,\n                }, { withNodes: true })}\n              </div>\n            )}\n          </div>\n        )}\n        {renderFooterButton()}\n      </div>\n    );\n\n    return {\n      modalHeader: isGiftUnique ? uniqueGiftModalHeader : undefined,\n      header: isGiftUnique ? uniqueGiftHeader : regularHeader,\n      tableData,\n      footer,\n    };\n  }, [\n    typeGift, savedGift, renderingTargetPeer, giftSticker, lang,\n    canManage, hasConvertOption, isSender, oldLang, tonExplorerUrl,\n    gift, giftAttributes, renderFooterButton, isTargetChat,\n    SettingsMenuButton, isGiftUnique, saleDateInfo,\n    canBuyGift, giftOwnerTitle, resellPrice, giftSubtitle,\n    releasedByPeer, handleSymbolClick, handleBackdropClick, handleModelClick,\n  ]);\n\n  const getRootElement = useLastCallback(() => uniqueGiftHeaderRef.current);\n  const getTriggerElement = useLastCallback(() => splitButtonRef.current);\n  const getMenuElement = useLastCallback(() => menuRef.current);\n  const getLayout = useLastCallback(() => ({ withPortal: true }));\n\n  const uniqueGiftContextMenu = contextMenuAnchor && typeGift && (\n    <Menu\n      ref={menuRef}\n      isOpen={isContextMenuOpen}\n      anchor={contextMenuAnchor}\n      className=\"gift-context-menu with-menu-transitions\"\n      autoClose\n      withPortal\n      onClose={handleContextMenuClose}\n      onCloseAnimationEnd={handleContextMenuHide}\n      positionX=\"right\"\n      getTriggerElement={getTriggerElement}\n      getRootElement={getRootElement}\n      getMenuElement={getMenuElement}\n      getLayout={getLayout}\n    >\n      <GiftMenuItems\n        peerId={renderingModal!.peerId!}\n        gift={typeGift}\n        canManage={canManage}\n        collectibleEmojiStatuses={collectibleEmojiStatuses}\n        currentUserEmojiStatus={currentUserEmojiStatus}\n      />\n    </Menu>\n  );\n\n  return (\n    <>\n      <TableInfoModal\n        isOpen={isOpen}\n        modalHeader={modalData?.modalHeader}\n        header={modalData?.header}\n        hasBackdrop={isGiftUnique}\n        tableData={modalData?.tableData}\n        footer={modalData?.footer}\n        className={styles.modal}\n        contentClassName={styles.modalContent}\n        onClose={handleClose}\n        withBalanceBar={Boolean(canBuyGift)}\n        currencyInBalanceBar={confirmPrice?.currency}\n        isLowStackPriority\n      />\n      {uniqueGiftContextMenu}\n      {uniqueGift && currentUser && Boolean(confirmPrice) && (\n        <ConfirmDialog\n          isOpen={isConfirmModalOpen}\n          noDefaultTitle\n          onClose={closeConfirmModal}\n          confirmLabel={lang('ButtonBuyGift', {\n            stars: confirmPrice?.currency === TON_CURRENCY_CODE\n              ? formatTonAsIcon(lang, confirmPrice.amount, { shouldConvertFromNanos: true })\n              : formatStarsAsIcon(lang, confirmPrice.amount, { asFont: true }),\n          }, { withNodes: true })}\n          confirmHandler={handleConfirmBuyGift}\n        >\n\n          {uniqueGift.resaleTonOnly\n            && (\n              <div className={styles.descriptionConfirm}>\n                {lang('ConfirmBuyGiftForTonDescription')}\n              </div>\n            )}\n          <GiftTransferPreview\n            peer={recipientPeer || currentUser}\n            gift={uniqueGift}\n          />\n          <div className={styles.titleConfirm}>\n            {lang('TitleConfirmPayment')}\n          </div>\n          {!recipientPeer\n            && (\n              <p>\n                {lang('GiftBuyConfirmDescription', {\n                  gift: lang('GiftUnique', { title: uniqueGift.title, number: uniqueGift.number }),\n                  stars: confirmPrice?.currency === TON_CURRENCY_CODE\n                    ? formatTonAsText(lang, confirmPrice.amount, true)\n                    : formatStarsAsText(lang, confirmPrice.amount),\n                }, {\n                  withNodes: true,\n                  withMarkdown: true,\n                })}\n              </p>\n            )}\n          {recipientPeer\n            && (\n              <p>\n                {lang('GiftBuyForPeerConfirmDescription', {\n                  gift: lang('GiftUnique', { title: uniqueGift.title, number: uniqueGift.number }),\n                  stars: confirmPrice?.currency === TON_CURRENCY_CODE\n                    ? formatTonAsText(lang, confirmPrice.amount, true)\n                    : formatStarsAsText(lang, confirmPrice.amount),\n                  peer: getPeerTitle(lang, recipientPeer),\n                }, {\n                  withNodes: true,\n                  withMarkdown: true,\n                })}\n              </p>\n            )}\n          {!uniqueGift.resaleTonOnly && (\n            <>\n              <Checkbox\n                className={styles.checkBox}\n                label={lang('LabelPayInTON')}\n                checked={shouldPayInTon}\n                onCheck={setShouldPayInTon}\n              />\n\n              <div className={styles.checkBoxDescription}>\n                {lang('DescriptionPayInTON')}\n              </div>\n            </>\n          )}\n        </ConfirmDialog>\n      )}\n      {savedGift && (\n        <ConfirmDialog\n          isOpen={isConvertConfirmOpen}\n          onClose={closeConvertConfirm}\n          confirmHandler={handleConvertToStars}\n          title={lang('GiftInfoConvertTitle')}\n        >\n          <div>\n            {lang('GiftInfoPeerConvertDescription', {\n              amount: formatStarsAsText(lang, savedGift.starsToConvert!),\n              peer: getPeerTitle(lang, renderingFromPeer!)!,\n            }, {\n              withNodes: true,\n              withMarkdown: true,\n            })}\n          </div>\n          {hasConvertOption && (\n            <div>\n              {lang('GiftInfoConvertDescriptionPeriod', {\n                count: conversionLeft,\n              }, {\n                withNodes: true,\n                withMarkdown: true,\n                pluralValue: conversionLeft,\n              })}\n            </div>\n          )}\n          <div>{lang('GiftInfoConvertDescription2')}</div>\n        </ConfirmDialog>\n      )}\n    </>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { modal }): Complete<StateProps> => {\n    const typeGift = modal?.gift;\n    const isSavedGift = typeGift && 'gift' in typeGift;\n    const currentUserId = global.currentUserId;\n\n    const fromId = isSavedGift && typeGift.fromId;\n    const fromPeer = fromId ? selectPeer(global, fromId) : undefined;\n    const targetPeer = modal?.peerId ? selectPeer(global, modal.peerId) : undefined;\n    const chat = targetPeer && isApiPeerChat(targetPeer) ? targetPeer : undefined;\n    const hasAdminRights = chat && getHasAdminRight(chat, 'postMessages');\n    const currentUser = selectUser(global, currentUserId!);\n    const recipientPeer = modal?.recipientId && currentUserId !== modal.recipientId\n      ? selectPeer(global, modal.recipientId) : undefined;\n    const currentUserEmojiStatus = currentUser?.emojiStatus;\n    const collectibleEmojiStatuses = global.collectibleEmojiStatuses?.statuses;\n\n    const gift = isSavedGift ? typeGift.gift : typeGift;\n    const releasedByPeerId = gift?.type === 'starGiftUnique' && gift.releasedByPeerId;\n    const releasedByPeer = releasedByPeerId ? selectPeer(global, releasedByPeerId) : undefined;\n\n    return {\n      fromPeer,\n      targetPeer,\n      releasedByPeer,\n      currentUserId,\n      starGiftMaxConvertPeriod: global.appConfig.starGiftMaxConvertPeriod,\n      tonExplorerUrl: global.appConfig.tonExplorerUrl,\n      hasAdminRights,\n      currentUserEmojiStatus,\n      collectibleEmojiStatuses,\n      currentUser,\n      recipientPeer,\n    };\n  },\n)(GiftInfoModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"v4GJBsdC\",\"sticker\":\"lJodRD0R\",\"description\":\"VjWaO8un\",\"initialPrice\":\"K7zsAhVt\",\"starIcon\":\"Xw91xwpe\",\"footer\":\"OJDo2xUd\",\"footerSticker\":\"hspYTy7V\"};","import type { FC } from '../../../../lib/teact/teact';\nimport { memo, useMemo } from '../../../../lib/teact/teact';\nimport { getActions } from '../../../../global';\n\nimport type { TabState } from '../../../../global/types';\n\nimport { formatDateToString } from '../../../../util/dates/dateFormat';\nimport { formatCurrencyAsString } from '../../../../util/formatCurrency';\nimport { formatStarsAsIcon } from '../../../../util/localization/format';\nimport { getGiftAttributes } from '../../../common/helpers/gifts';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport AnimatedIconFromSticker from '../../../common/AnimatedIconFromSticker';\nimport Button from '../../../ui/Button';\nimport TableInfoModal, { type TableData } from '../../common/TableInfoModal';\n\nimport styles from './GiftInfoValueModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftInfoValueModal'];\n};\n\nconst HEADER_STICKER_SIZE = 120;\nconst FOOTER_STICKER_SIZE = 24;\n\nconst GiftInfoValueModal: FC<OwnProps> = ({\n  modal,\n}) => {\n  const { closeGiftInfoValueModal, openUrl, openGiftInMarket } = getActions();\n\n  const lang = useLang();\n\n  const isOpen = Boolean(modal);\n  const renderingModal = useCurrentOrPrev(modal);\n\n  const handleOpenFragment = useLastCallback(() => {\n    if (modal?.valueInfo.fragmentListedUrl) {\n      openUrl({ url: modal.valueInfo.fragmentListedUrl });\n    }\n  });\n\n  const handleOpenTelegramMarket = useLastCallback(() => {\n    if (modal?.gift) {\n      openGiftInMarket({ gift: modal.gift });\n    }\n  });\n\n  const modalData = useMemo(() => {\n    if (!renderingModal) return undefined;\n\n    const { gift, valueInfo } = renderingModal;\n    const giftAttributes = getGiftAttributes(gift);\n\n    if (!giftAttributes) return undefined;\n\n    const header = (\n      <div className={styles.header}>\n        <AnimatedIconFromSticker\n          className={styles.sticker}\n          sticker={giftAttributes.model!.sticker}\n          size={HEADER_STICKER_SIZE}\n        />\n        <Button\n          pill\n          size=\"tiny\"\n          fluid\n          nonInteractive\n        >\n          {formatCurrencyAsString(valueInfo.value, valueInfo.currency, lang.code)}\n        </Button>\n        <div className={styles.description}>\n          {lang('GiftValueDescription', { giftName: gift.title }, {\n            withMarkdown: true,\n            withNodes: true,\n          })}\n        </div>\n      </div>\n    );\n\n    const tableData: TableData = [];\n\n    tableData.push([\n      lang('GiftValueTitleInitialSale'),\n      formatDateToString(valueInfo.initialSaleDate * 1000, lang.code),\n    ]);\n\n    tableData.push([\n      lang('GiftValueTitleInitialPrice'),\n      <span className={styles.initialPrice}>\n        {formatStarsAsIcon(lang, valueInfo.initialSaleStars, { className: styles.starIcon })}\n        {' (~ '}\n        {formatCurrencyAsString(valueInfo.initialSalePrice, valueInfo.currency, lang.code)}\n        )\n      </span>,\n    ]);\n\n    if (valueInfo.lastSaleDate) {\n      tableData.push([\n        lang('GiftValueTitleLastSale'),\n        formatDateToString(valueInfo.lastSaleDate * 1000, lang.code),\n      ]);\n    }\n\n    if (valueInfo.lastSalePrice) {\n      tableData.push([\n        lang('GiftValueTitleLastPrice'),\n        formatCurrencyAsString(valueInfo.lastSalePrice, valueInfo.currency, lang.code),\n      ]);\n    }\n\n    if (valueInfo.floorPrice) {\n      tableData.push([\n        lang('GiftValueTitleMinimumPrice'),\n        formatCurrencyAsString(valueInfo.floorPrice, valueInfo.currency, lang.code),\n      ]);\n    }\n\n    if (valueInfo.averagePrice) {\n      tableData.push([\n        lang('GiftValueTitleAveragePrice'),\n        formatCurrencyAsString(valueInfo.averagePrice, valueInfo.currency, lang.code),\n      ]);\n    }\n\n    const canBuyOnFragment = Boolean(valueInfo.fragmentListedUrl && valueInfo.fragmentListedCount);\n    const canBuyOnTelegram = Boolean(valueInfo.listedCount && valueInfo.listedCount);\n    const hasFooter = canBuyOnFragment || canBuyOnTelegram;\n\n    const footer = hasFooter && (\n      <div className={styles.footer}>\n        {canBuyOnFragment && (\n          <Button\n            isText\n            onClick={handleOpenFragment}\n            noForcedUpperCase\n            size=\"tiny\"\n          >\n            {lang.number(valueInfo.fragmentListedCount!)}\n            <AnimatedIconFromSticker\n              className={styles.footerSticker}\n              sticker={giftAttributes.model!.sticker}\n              size={FOOTER_STICKER_SIZE}\n            />\n            {lang('GiftValueForSaleOnFragment')}\n          </Button>\n        )}\n\n        {canBuyOnTelegram && (\n          <Button\n            isText\n            noForcedUpperCase\n            size=\"tiny\"\n            onClick={handleOpenTelegramMarket}\n          >\n            {lang.number(valueInfo.listedCount!)}\n            <AnimatedIconFromSticker\n              className={styles.footerSticker}\n              sticker={giftAttributes.model!.sticker}\n              size={FOOTER_STICKER_SIZE}\n            />\n            {lang('GiftValueForSaleOnTelegram')}\n          </Button>\n        )}\n      </div>\n    );\n\n    return {\n      header,\n      tableData,\n      footer,\n    };\n  }, [lang, renderingModal, handleOpenFragment, handleOpenTelegramMarket]);\n\n  if (!modalData) return undefined;\n\n  return (\n    <TableInfoModal\n      isOpen={isOpen}\n      onClose={closeGiftInfoValueModal}\n      header={modalData.header}\n      tableData={modalData.tableData}\n      footer={modalData.footer}\n    />\n  );\n};\n\nexport default memo(GiftInfoValueModal);\n","import { memo, useCallback } from '../../../../lib/teact/teact';\nimport { getActions } from '../../../../global';\n\nimport type { TabState } from '../../../../global/types';\n\nimport { formatShortDuration } from '../../../../util/dates/dateFormat';\nimport { getServerTime } from '../../../../util/serverTime';\nimport { renderTextWithEntities } from '../../../common/helpers/renderTextWithEntities';\n\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport Button from '../../../ui/Button';\nimport Modal from '../../../ui/Modal';\n\nimport styles from './GiftLockedModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['lockedGiftModal'];\n};\n\nconst GiftLockedModal = ({\n  modal,\n}: OwnProps) => {\n  const { closeLockedGiftModal } = getActions();\n  const lang = useLang();\n\n  const handleClose = useLastCallback(() => {\n    closeLockedGiftModal();\n  });\n\n  const getMessageText = useCallback(() => {\n    if (!modal) return '';\n\n    if (modal.untilDate) {\n      const timeRemaining = modal.untilDate ? modal.untilDate - getServerTime() : 0;\n      return lang('GiftLockedMessage', {\n        relativeDate: formatShortDuration(lang, timeRemaining),\n      },\n      {\n        withNodes: true,\n        withMarkdown: true,\n      });\n    }\n\n    if (modal.reason) {\n      return renderTextWithEntities(modal.reason);\n    }\n\n    return lang('TitleGiftLocked');\n  }, [modal, lang]);\n\n  return (\n    <Modal\n      isOpen={Boolean(modal)}\n      className=\"narrow\"\n      onClose={handleClose}\n      title={lang('TitleGiftLocked')}\n      headerClassName={styles.header}\n    >\n      <p className={styles.message}>\n        {getMessageText()}\n      </p>\n      <Button\n        onClick={handleClose}\n      >\n        {lang('OK')}\n      </Button>\n    </Modal>\n  );\n};\n\nexport default memo(GiftLockedModal);\n","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"AqB1qB8W\",\"message\":\"pA8Bz4TW\"};","// extracted by mini-css-extract-plugin\nexport default {\"checkBoxDescription\":\"pWjQiY4m\",\"inputPriceDescription\":\"SGFmA4kL\",\"checkBox\":\"yt_nODdj\",\"descriptionPrice\":\"r9R0VR_w\",\"inputPrice\":\"ElDo1Bru\"};","import {\n  memo, useState,\n} from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type { TabState } from '../../../../global/types';\n\nimport { convertTonFromNanos, convertTonToNanos } from '../../../../util/formatCurrency';\nimport { convertTonToUsd, formatCurrencyAsString } from '../../../../util/formatCurrency';\nimport { formatStarsAsIcon, formatStarsAsText, formatTonAsIcon,\n  formatTonAsText } from '../../../../util/localization/format';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport Button from '../../../ui/Button';\nimport Checkbox from '../../../ui/Checkbox';\nimport InputText from '../../../ui/InputText';\nimport Modal from '../../../ui/Modal';\n\nimport styles from './GiftResalePriceComposerModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftResalePriceComposerModal'];\n};\n\nexport type StateProps = {\n  starsStargiftResaleCommissionPermille?: number;\n  starsStargiftResaleAmountMin: number;\n  starsStargiftResaleAmountMax?: number;\n  starsUsdWithdrawRate?: number;\n  tonStargiftResaleCommissionPermille?: number;\n  tonStargiftResaleAmountMin: number;\n  tonStargiftResaleAmountMax?: number;\n  tonUsdRate?: number;\n};\n\nconst GiftResalePriceComposerModal = ({\n  modal, starsStargiftResaleCommissionPermille,\n  starsStargiftResaleAmountMin, starsStargiftResaleAmountMax, starsUsdWithdrawRate,\n  tonStargiftResaleCommissionPermille, tonStargiftResaleAmountMin, tonStargiftResaleAmountMax, tonUsdRate,\n}: OwnProps & StateProps) => {\n  const {\n    closeGiftResalePriceComposerModal,\n    closeGiftInfoModal,\n    updateStarGiftPrice,\n    showNotification,\n  } = getActions();\n  const isOpen = Boolean(modal);\n  const [price, setPrice] = useState<number | undefined>(undefined);\n  const [isPriceInTon, setIsPriceInTon] = useState(false);\n\n  const renderingModal = useCurrentOrPrev(modal);\n  const { gift: typeGift } = renderingModal || {};\n  const isSavedGift = typeGift && 'gift' in typeGift;\n  const savedGift = isSavedGift ? typeGift : undefined;\n  const hasPrice = Boolean(price);\n\n  const lang = useLang();\n\n  const handleChangePrice = useLastCallback((e) => {\n    const value = e.target.value;\n    const number = parseFloat(value);\n    const maxAmount = isPriceInTon ? tonStargiftResaleAmountMax : starsStargiftResaleAmountMax;\n    const result = value === '' || Number.isNaN(number) ? undefined\n      : maxAmount ? Math.min(number, maxAmount) : number;\n    setPrice(result);\n  });\n\n  const handleClose = useLastCallback(() => {\n    closeGiftResalePriceComposerModal();\n  });\n\n  const handleSellGift = useLastCallback(() => {\n    if (!savedGift || savedGift.gift.type !== 'starGiftUnique' || !savedGift.inputGift || !price) return;\n    closeGiftResalePriceComposerModal();\n    closeGiftInfoModal();\n    updateStarGiftPrice(\n      {\n        gift: savedGift.inputGift,\n        price: {\n          currency: isPriceInTon ? 'TON' : 'XTR',\n          amount: isPriceInTon ? convertTonToNanos(price) : price,\n          nanos: 0,\n        },\n      });\n    showNotification({\n      icon: 'sell-outline',\n      message: {\n        key: 'NotificationGiftIsSale',\n        variables: {\n          gift: lang('GiftUnique', { title: savedGift.gift.title, number: savedGift.gift.number }),\n        },\n      },\n    });\n  });\n  const commission = isPriceInTon ? tonStargiftResaleCommissionPermille : starsStargiftResaleCommissionPermille;\n  const minAmount = isPriceInTon ? tonStargiftResaleAmountMin : starsStargiftResaleAmountMin;\n  const isPriceCorrect = hasPrice && price >= minAmount;\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      title={isPriceInTon ? lang('PriceInTON') : lang('PriceInStars')}\n      hasCloseButton\n      isSlim\n      onClose={handleClose}\n    >\n      <div className={styles.inputPrice}>\n        <InputText\n          label={isPriceInTon ? lang('EnterPriceInTon') : lang('EnterPriceInStars')}\n          onChange={handleChangePrice}\n          value={price?.toString()}\n          inputMode=\"numeric\"\n          tabIndex={0}\n          teactExperimentControlled={!isPriceInTon}\n        />\n      </div>\n\n      <div className={styles.inputPriceDescription}>\n        <span>\n          {!isPriceCorrect && Boolean(commission) && lang('DescriptionComposerGiftMinimumPrice', {\n            stars: isPriceInTon ? formatTonAsText(lang, minAmount) : formatStarsAsText(lang, minAmount),\n          }, {\n            withMarkdown: true,\n            withNodes: true,\n          })}\n          {isPriceCorrect && (() => {\n            const priceWithCommission = commission ? Number((price * commission).toFixed()) : price;\n            return lang('DescriptionComposerGiftResalePrice',\n              {\n                stars: isPriceInTon\n                  ? formatTonAsText(lang, priceWithCommission)\n                  : formatStarsAsText(lang, priceWithCommission),\n              },\n              {\n                withMarkdown: true,\n                withNodes: true,\n              });\n          })()}\n        </span>\n\n        {isPriceCorrect && Boolean(isPriceInTon ? tonUsdRate : starsUsdWithdrawRate) && (\n          <span className={styles.descriptionPrice}>\n            {` ${formatCurrencyAsString(\n              isPriceInTon ? convertTonToUsd(price, tonUsdRate!) : price * starsUsdWithdrawRate!,\n              'USD',\n              lang.code,\n            )}`}\n          </span>\n        )}\n      </div>\n\n      <Checkbox\n        className={styles.checkBox}\n        label={lang('OnlyAcceptTON')}\n        checked={isPriceInTon}\n        onCheck={setIsPriceInTon}\n      />\n\n      <div className={styles.checkBoxDescription}>\n        {lang('OnlyAcceptTONDescription')}\n      </div>\n\n      <Button noForcedUpperCase disabled={!isPriceCorrect} onClick={handleSellGift}>\n        {isPriceCorrect && lang('ButtonSellGift', {\n          stars: isPriceInTon ? formatTonAsIcon(lang, price)\n            : formatStarsAsIcon(lang, price, { asFont: true }),\n        }, { withNodes: true })}\n        {!isPriceCorrect && lang('Sell')}\n      </Button>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const configPermille = global.appConfig.starsStargiftResaleCommissionPermille;\n    const starsStargiftResaleCommissionPermille = configPermille ? (configPermille / 1000) : undefined;\n    const starsStargiftResaleAmountMin = global.appConfig.starsStargiftResaleAmountMin || 0;\n    const starsStargiftResaleAmountMax = global.appConfig.starsStargiftResaleAmountMax;\n\n    const starsUsdWithdrawRateX1000 = global.appConfig.starsUsdWithdrawRateX1000;\n    const starsUsdWithdrawRate = starsUsdWithdrawRateX1000 ? starsUsdWithdrawRateX1000 / 1000 : 1;\n\n    const tonConfigPermille = global.appConfig.tonStargiftResaleCommissionPermille;\n    const tonStargiftResaleCommissionPermille = tonConfigPermille ? (tonConfigPermille / 1000) : 0;\n    const tonStargiftResaleAmountMin = convertTonFromNanos(global.appConfig.tonStargiftResaleAmountMin || 0);\n    const maxTonFromConfig = global.appConfig.tonStargiftResaleAmountMax;\n    const tonStargiftResaleAmountMax = maxTonFromConfig && convertTonFromNanos(maxTonFromConfig);\n\n    const tonUsdRate = global.appConfig.tonUsdRate;\n\n    return {\n      starsStargiftResaleCommissionPermille,\n      starsStargiftResaleAmountMin,\n      starsStargiftResaleAmountMax,\n      starsUsdWithdrawRate,\n      tonStargiftResaleCommissionPermille,\n      tonStargiftResaleAmountMin,\n      tonStargiftResaleAmountMax,\n      tonUsdRate,\n    };\n  },\n)(GiftResalePriceComposerModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"footer\":\"EWaVCxY4\",\"footerButton\":\"_Dt6RSQV\"};","import {\n  memo, useEffect, useMemo, useState,\n} from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type {\n  ApiPeer,\n  ApiStarGiftAttribute,\n  ApiStarGiftAttributeBackdrop,\n  ApiStarGiftAttributeModel,\n  ApiStarGiftAttributePattern,\n  ApiStarGiftRegular,\n} from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\nimport { ApiMediaFormat } from '../../../../api/types';\n\nimport { getStickerMediaHash } from '../../../../global/helpers';\nimport { getPeerTitle } from '../../../../global/helpers/peers';\nimport { selectPeer } from '../../../../global/selectors';\nimport { formatStarsAsIcon } from '../../../../util/localization/format';\nimport { fetch } from '../../../../util/mediaLoader';\n\nimport useInterval from '../../../../hooks/schedulers/useInterval';\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport Button from '../../../ui/Button';\nimport Checkbox from '../../../ui/Checkbox';\nimport TableAboutModal, { type TableAboutData } from '../../common/TableAboutModal';\nimport UniqueGiftHeader from '../UniqueGiftHeader';\n\nimport styles from './GiftUpgradeModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftUpgradeModal'];\n};\n\ntype StateProps = {\n  recipient?: ApiPeer;\n};\n\ntype Attributes = {\n  model: ApiStarGiftAttributeModel;\n  pattern: ApiStarGiftAttributePattern;\n  backdrop: ApiStarGiftAttributeBackdrop;\n};\n\nconst PREVIEW_UPDATE_INTERVAL = 3000;\n\nconst GiftUpgradeModal = ({ modal, recipient }: OwnProps & StateProps) => {\n  const { closeGiftUpgradeModal, closeGiftInfoModal, upgradeGift, upgradePrepaidGift } = getActions();\n  const isOpen = Boolean(modal);\n\n  const renderingModal = useCurrentOrPrev(modal);\n  const renderingRecipient = useCurrentOrPrev(recipient);\n  const [shouldKeepOriginalDetails, setShouldKeepOriginalDetails] = useState(false);\n\n  const isPrepaid = Boolean(renderingModal?.gift?.prepaidUpgradeHash);\n\n  const [previewAttributes, setPreviewAttributes] = useState<Attributes | undefined>();\n\n  const lang = useLang();\n\n  const handleClose = useLastCallback(() => closeGiftUpgradeModal());\n\n  const handleUpgrade = useLastCallback(() => {\n    const gift = renderingModal?.gift;\n\n    if (!gift) return;\n\n    const regularGift = gift.gift.type === 'starGift' ? gift.gift : undefined;\n\n    if (isPrepaid && gift.prepaidUpgradeHash && renderingRecipient) {\n      const upgradeStars = regularGift?.upgradeStars;\n      if (!upgradeStars) return;\n\n      upgradePrepaidGift({\n        peerId: renderingRecipient.id,\n        hash: gift.prepaidUpgradeHash,\n        stars: upgradeStars,\n      });\n      handleClose();\n      closeGiftInfoModal();\n      return;\n    }\n\n    if (!gift?.inputGift) return;\n\n    upgradeGift({\n      gift: gift.inputGift,\n      shouldKeepOriginalDetails,\n      upgradeStars: !gift.alreadyPaidUpgradeStars ? regularGift?.upgradeStars : undefined,\n    });\n    handleClose();\n  });\n\n  const updatePreviewAttributes = useLastCallback(() => {\n    if (!renderingModal?.sampleAttributes) return;\n    setPreviewAttributes(getRandomAttributes(renderingModal.sampleAttributes, previewAttributes));\n  });\n\n  useInterval(updatePreviewAttributes, isOpen ? PREVIEW_UPDATE_INTERVAL : undefined, true);\n\n  useEffect(() => {\n    if (isOpen && renderingModal?.sampleAttributes) {\n      updatePreviewAttributes();\n    }\n  }, [isOpen, renderingModal?.sampleAttributes]);\n\n  // Preload stickers and patterns\n  useEffect(() => {\n    const attributes = renderingModal?.sampleAttributes;\n    if (!attributes) return;\n    const patternStickers = attributes.filter((attr): attr is ApiStarGiftAttributeModel => attr.type === 'pattern')\n      .map((attr) => attr.sticker);\n    const modelStickers = attributes.filter((attr): attr is ApiStarGiftAttributeModel => attr.type === 'model')\n      .map((attr) => attr.sticker);\n\n    const mediaHashes = [...patternStickers, ...modelStickers].map((sticker) => getStickerMediaHash(sticker, 'full'));\n    mediaHashes.forEach((hash) => {\n      fetch(hash, ApiMediaFormat.BlobUrl);\n    });\n  }, [renderingModal?.sampleAttributes]);\n\n  const modalData = useMemo(() => {\n    if (!previewAttributes || !isOpen) {\n      return undefined;\n    }\n\n    const gift = renderingModal?.gift;\n\n    const userName = renderingRecipient ? getPeerTitle(lang, renderingRecipient) : lang('ActionFallbackUser');\n\n    const listItemData = (renderingRecipient ? [\n      ['diamond', lang('GiftUpgradeUniqueTitle'), lang('GiftPeerUpgradeUniqueDescription', { user: userName })],\n      ['trade', lang('GiftUpgradeTransferableTitle'),\n        lang('GiftPeerUpgradeTransferableDescription', { user: userName })],\n      ['auction', lang('GiftUpgradeTradeableTitle'), lang('GiftPeerUpgradeTradeableDescription', { user: userName })],\n    ] : [\n      ['diamond', lang('GiftUpgradeUniqueTitle'), lang('GiftUpgradeUniqueDescription')],\n      ['trade', lang('GiftUpgradeTransferableTitle'), lang('GiftUpgradeTransferableDescription')],\n      ['auction', lang('GiftUpgradeTradeableTitle'), lang('GiftUpgradeTradeableDescription')],\n    ]) satisfies TableAboutData;\n\n    const subtitle = renderingRecipient\n      ? lang('GiftPeerUpgradeText', { peer: getPeerTitle(lang, renderingRecipient) })\n      : lang('GiftUpgradeTextOwn');\n\n    const formattedPrice = gift\n      ? formatStarsAsIcon(lang, (gift.gift as ApiStarGiftRegular).upgradeStars!, { asFont: true })\n      : undefined;\n\n    const header = (\n      <UniqueGiftHeader\n        modelAttribute={previewAttributes.model}\n        backdropAttribute={previewAttributes.backdrop}\n        patternAttribute={previewAttributes.pattern}\n        title={lang('GiftUpgradeTitle')}\n        subtitle={subtitle}\n      />\n    );\n\n    const footer = (\n      <div className={styles.footer}>\n        {!gift && (\n          <Button className={styles.footerButton} onClick={handleClose}>\n            {lang('OK')}\n          </Button>\n        )}\n        {gift && (\n          <>\n            {!isPrepaid && (\n              <Checkbox\n                label={lang('GiftUpgradeKeepDetails')}\n                onCheck={setShouldKeepOriginalDetails}\n                checked={shouldKeepOriginalDetails}\n              />\n            )}\n            <Button className={styles.footerButton} isShiny onClick={handleUpgrade}>\n              {gift.alreadyPaidUpgradeStars\n                ? lang('GeneralConfirm')\n                : isPrepaid\n                  ? lang('GiftPayForUpgradeButton', { amount: formattedPrice }, { withNodes: true })\n                  : lang('GiftUpgradeButton', { amount: formattedPrice }, { withNodes: true })}\n            </Button>\n          </>\n        )}\n      </div>\n    );\n\n    return {\n      listItemData,\n      header,\n      footer,\n    };\n  }, [previewAttributes, isOpen, lang,\n    renderingRecipient, renderingModal?.gift,\n    shouldKeepOriginalDetails, isPrepaid]);\n\n  return (\n    <TableAboutModal\n      isOpen={isOpen}\n      header={modalData?.header}\n      footer={modalData?.footer}\n      listItemData={modalData?.listItemData}\n      hasBackdrop\n      onClose={handleClose}\n    />\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { modal }): Complete<StateProps> => {\n    const recipientId = modal?.recipientId;\n    const recipient = recipientId ? selectPeer(global, recipientId) : undefined;\n\n    return {\n      recipient,\n    };\n  },\n)(GiftUpgradeModal));\n\nfunction getRandomAttributes(list: ApiStarGiftAttribute[], previousSelection?: Attributes): Attributes {\n  const models = list.filter((attr): attr is ApiStarGiftAttributeModel => (\n    attr.type === 'model' && attr.name !== previousSelection?.model.name\n  ));\n  const patterns = list.filter((attr): attr is ApiStarGiftAttributePattern => (\n    attr.type === 'pattern' && attr.name !== previousSelection?.pattern.name\n  ));\n  const backdrops = list.filter((attr): attr is ApiStarGiftAttributeBackdrop => (\n    attr.type === 'backdrop' && attr.name !== previousSelection?.backdrop.name\n  ));\n\n  const randomModel = models[Math.floor(Math.random() * models.length)];\n  const randomPattern = patterns[Math.floor(Math.random() * patterns.length)];\n  const randomBackdrop = backdrops[Math.floor(Math.random() * backdrops.length)];\n\n  return {\n    model: randomModel,\n    pattern: randomPattern,\n    backdrop: randomBackdrop,\n  };\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"qL0cHbwS\",\"profileBlock\":\"t18QCmAb\",\"titleContainer\":\"q8w7tnmR\",\"radialPattern\":\"_1RfhkfB\",\"lockIcon\":\"jiPObOWv\",\"avatar\":\"JK2zOWA7\",\"userTitle\":\"lxxbgNCl\",\"status\":\"MLMdxkUg\",\"giftTitle\":\"wxg_5ou_\",\"infoDescription\":\"KSCLIMZm\",\"footer\":\"VDrvalBo\"};","import { memo, useMemo } from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type {\n  ApiUser,\n} from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\n\nimport { selectIsCurrentUserPremium, selectUser } from '../../../../global/selectors';\nimport buildClassName from '../../../../util/buildClassName';\nimport buildStyle from '../../../../util/buildStyle';\nimport { REM } from '../../../common/helpers/mediaDimensions';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport useCustomEmoji from '../../../common/hooks/useCustomEmoji';\n\nimport Avatar from '../../../common/Avatar';\nimport FullNameTitle from '../../../common/FullNameTitle';\nimport Icon from '../../../common/icons/Icon';\nimport RadialPatternBackground from '../../../common/profile/RadialPatternBackground';\nimport Button from '../../../ui/Button';\nimport TableAboutModal, { type TableAboutData } from '../../common/TableAboutModal';\n\nimport styles from './GiftStatusInfoModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftStatusInfoModal'];\n};\n\ntype StateProps = {\n  currentUser: ApiUser;\n  isCurrentUserPremium?: boolean;\n};\n\nconst GiftStatusInfoModal = ({\n  modal,\n  currentUser,\n  isCurrentUserPremium,\n}: OwnProps & StateProps) => {\n  const {\n    closeGiftStatusInfoModal,\n    setEmojiStatus,\n  } = getActions();\n  const lang = useLang();\n  const isOpen = Boolean(modal);\n  const renderingModal = useCurrentOrPrev(modal);\n\n  const { emojiStatus } = renderingModal || {};\n\n  const subtitleColor = emojiStatus?.textColor;\n\n  const patternIcon = useCustomEmoji(emojiStatus?.patternDocumentId);\n\n  const handleClose = useLastCallback(() => {\n    closeGiftStatusInfoModal();\n  });\n\n  const onWearClick = useLastCallback(() => {\n    if (emojiStatus) {\n      setEmojiStatus({ emojiStatus });\n    }\n    closeGiftStatusInfoModal();\n  });\n\n  const radialPatternBackdrop = useMemo(() => {\n    if (!emojiStatus || !isOpen) return undefined;\n\n    const backdropColors = [emojiStatus.centerColor, emojiStatus.edgeColor];\n\n    return (\n      <RadialPatternBackground\n        className={styles.radialPattern}\n        backgroundColors={backdropColors}\n        patternIcon={patternIcon.customEmoji}\n        yPosition={6.5 * REM}\n      />\n    );\n  }, [emojiStatus, isOpen, patternIcon]);\n\n  const mockPeerWithStatus = useMemo(() => {\n    return {\n      ...currentUser,\n      emojiStatus,\n    } satisfies ApiUser;\n  }, [currentUser, emojiStatus]);\n\n  const header = useMemo(() => {\n    return (\n      <div className={styles.header}>\n        <div\n          className={buildClassName(styles.profileBlock)}\n          style={buildStyle(subtitleColor && `color: ${subtitleColor}`)}\n        >\n\n          {radialPatternBackdrop}\n          <Avatar peer={mockPeerWithStatus} size=\"jumbo\" className={styles.avatar} />\n          <FullNameTitle\n            peer={mockPeerWithStatus}\n            className={styles.userTitle}\n            withEmojiStatus\n            noFake\n            noVerified\n          />\n          <p className={styles.status} style={buildStyle(subtitleColor && `color: ${subtitleColor}`)}>\n            {lang('Online')}\n          </p>\n        </div>\n        <div className={styles.titleContainer}>\n          <div className={styles.giftTitle}>\n            {\n              lang('UniqueStatusWearTitle', {\n                gift: mockPeerWithStatus?.emojiStatus?.title,\n              })\n            }\n          </div>\n          <div className={styles.infoDescription}>\n            {\n              lang('UniqueStatusBenefitsDescription')\n            }\n          </div>\n        </div>\n      </div>\n    );\n  }, [subtitleColor, radialPatternBackdrop, mockPeerWithStatus, lang]);\n\n  const listItemData = [\n    ['radial-badge', lang('UniqueStatusBadgeBenefitTitle'), lang('UniqueStatusBadgeDescription')],\n    ['unique-profile', lang('UniqueStatusProfileDesignBenefitTitle'), lang('UniqueStatusProfileDesignDescription')],\n    ['proof-of-ownership', lang('UniqueStatusProofOfOwnershipBenefitTitle'),\n      lang('UniqueStatusProofOfOwnershipDescription')],\n  ] satisfies TableAboutData;\n\n  const footer = useMemo(() => {\n    if (!isOpen) return undefined;\n    return (\n      <div className={styles.footer}>\n        <Button\n          onClick={onWearClick}\n        >\n          {lang('UniqueStatusWearButton')}\n          {!isCurrentUserPremium && <Icon name=\"lock-badge\" className={styles.lockIcon} />}\n        </Button>\n      </div>\n    );\n  }, [lang, isCurrentUserPremium, isOpen]);\n\n  return (\n    <TableAboutModal\n      isOpen={isOpen}\n      header={header}\n      listItemData={listItemData}\n      footer={footer}\n      hasBackdrop\n      onClose={handleClose}\n    />\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const currentUser = selectUser(global, global.currentUserId!)!;\n    const isCurrentUserPremium = selectIsCurrentUserPremium(global);\n\n    return {\n      currentUser,\n      isCurrentUserPremium,\n    };\n  },\n)(GiftStatusInfoModal));\n","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"LQgz8Nlx\",\"giftPreview\":\"hgs0ts_O\",\"backdrop\":\"OnBhMaBw\",\"description\":\"HBxB4QPY\",\"arrow\":\"kXTOUpfb\",\"noPassword\":\"BnqLhoKr\"};","import {\n  memo,\n  useState,\n} from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type { ApiStarGiftUnique } from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\nimport { type CustomPeer, SettingsScreens } from '../../../../types';\n\nimport { getDays } from '../../../../util/dates/units';\nimport { getServerTime } from '../../../../util/serverTime';\nimport { getGiftAttributes } from '../../../common/helpers/gifts';\nimport { REM } from '../../../common/helpers/mediaDimensions';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport AnimatedIconFromSticker from '../../../common/AnimatedIconFromSticker';\nimport Avatar from '../../../common/Avatar';\nimport Icon from '../../../common/icons/Icon';\nimport PasswordForm from '../../../common/PasswordForm';\nimport RadialPatternBackground from '../../../common/profile/RadialPatternBackground';\nimport Button from '../../../ui/Button';\nimport Modal from '../../../ui/Modal';\n\nimport styles from './GiftWithdrawModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftWithdrawModal'];\n};\n\ntype StateProps = {\n  hasPassword?: boolean;\n  passwordHint?: string;\n};\n\nconst FRAGMENT_PEER: CustomPeer = {\n  isCustomPeer: true,\n  avatarIcon: 'fragment',\n  title: '',\n  customPeerAvatarColor: '#000000',\n};\nconst GIFT_STICKER_SIZE = 4.5 * REM;\n\nconst GiftWithdrawModal = ({ modal, hasPassword, passwordHint }: OwnProps & StateProps) => {\n  const {\n    closeGiftWithdrawModal,\n    clearGiftWithdrawError,\n    closeGiftInfoModal,\n    processStarGiftWithdrawal,\n    openSettingsScreen,\n  } = getActions();\n  const isOpen = Boolean(modal);\n\n  const [shouldShowPassword, setShouldShowPassword] = useState(false);\n\n  const lang = useLang();\n\n  const renderingModal = useCurrentOrPrev(modal);\n  const gift = renderingModal?.gift?.gift as ApiStarGiftUnique;\n  const giftAttributes = gift && getGiftAttributes(gift);\n  const exportDelay = renderingModal?.gift?.canExportAt\n    ? Math.max(renderingModal.gift.canExportAt - getServerTime(), 0) : undefined;\n\n  const handleClose = useLastCallback(() => {\n    closeGiftWithdrawModal();\n  });\n\n  const handleSubmit = useLastCallback((password: string) => {\n    processStarGiftWithdrawal({\n      gift: renderingModal!.gift.inputGift!,\n      password,\n    });\n  });\n\n  const handleSetUpPassword = useLastCallback(() => {\n    openSettingsScreen({\n      screen: SettingsScreens.TwoFaDisabled,\n    });\n    closeGiftWithdrawModal();\n    closeGiftInfoModal();\n  });\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      title={lang('GiftWithdrawTitle')}\n      isCondensedHeader\n      hasCloseButton\n      isSlim\n      onClose={handleClose}\n    >\n      {giftAttributes && (\n        <>\n          <div className={styles.header}>\n            <div className={styles.giftPreview}>\n              <RadialPatternBackground\n                className={styles.backdrop}\n                backgroundColors={[giftAttributes.backdrop!.centerColor, giftAttributes.backdrop!.edgeColor]}\n                patternIcon={giftAttributes.pattern?.sticker}\n                ringsCount={1}\n                ovalFactor={1}\n                patternSize={12}\n              />\n              <AnimatedIconFromSticker\n                className={styles.sticker}\n                size={GIFT_STICKER_SIZE}\n                sticker={giftAttributes.model?.sticker}\n              />\n            </div>\n            <Icon name=\"next\" className={styles.arrow} />\n            <Avatar\n              peer={FRAGMENT_PEER}\n              size=\"giant\"\n              className={styles.avatar}\n            />\n          </div>\n          <p className={styles.description}>\n            {lang('GiftWithdrawDescription', {\n              gift: `${gift.title} #${gift.number}`,\n            }, {\n              withNodes: true,\n              withMarkdown: true,\n              renderTextFilters: ['br'],\n            })}\n          </p>\n        </>\n      )}\n      {Boolean(exportDelay) && (\n        <p className={styles.exportHint}>\n          {lang('GiftWithdrawWait', { days: getDays(exportDelay) }, { pluralValue: getDays(exportDelay) })}\n        </p>\n      )}\n      {!hasPassword && (\n        <>\n          <span className={styles.noPassword}>{lang('ErrorPasswordMissing')}</span>\n          <Button className=\"mt-2\" onClick={handleSetUpPassword}>{lang('SetUp2FA')}</Button>\n        </>\n      )}\n      {hasPassword && !exportDelay && (\n        <PasswordForm\n          shouldShowSubmit\n          placeholder={lang('CheckPasswordPlaceholder')}\n          error={renderingModal?.errorKey && lang.withRegular(renderingModal?.errorKey)}\n          description={lang('CheckPasswordDescription')}\n          onClearError={clearGiftWithdrawError}\n          isLoading={renderingModal?.isLoading}\n          hint={passwordHint}\n          isPasswordVisible={shouldShowPassword}\n          shouldResetValue={isOpen}\n          onChangePasswordVisibility={setShouldShowPassword}\n          submitLabel={lang('GiftWithdrawSubmit')}\n          onSubmit={handleSubmit}\n        />\n      )}\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const {\n      settings: {\n        byKey: {\n          hasPassword,\n        },\n      },\n      twoFaSettings: {\n        hint: passwordHint,\n      },\n    } = global;\n\n    return {\n      hasPassword,\n      passwordHint,\n    };\n  },\n)(GiftWithdrawModal));\n","import {\n  getIsHeavyAnimating, useCallback, useRef, useState,\n} from '../lib/teact/teact';\n\nimport useForceUpdate from './useForceUpdate';\nimport useHeavyAnimation from './useHeavyAnimation';\nimport useRunDebounced from './useRunDebounced';\nimport useSyncEffect from './useSyncEffect';\n\nexport default function useDebouncedMemo<R, D extends unknown[]>(\n  resolverFn: () => R, ms: number, dependencies: D,\n): R | undefined {\n  const [value, setValue] = useState<R>();\n  const { isFrozen, updateWhenUnfrozen } = useHeavyAnimationFreeze();\n  const runDebounced = useRunDebounced(ms, true);\n\n  useSyncEffect(() => {\n    if (isFrozen) {\n      updateWhenUnfrozen();\n      return;\n    }\n\n    runDebounced(() => {\n      setValue(resolverFn());\n    });\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, [...dependencies, isFrozen]);\n\n  return value;\n}\n\nfunction useHeavyAnimationFreeze() {\n  const isPending = useRef(false);\n\n  const updateWhenUnfrozen = useCallback(() => {\n    isPending.current = true;\n  }, []);\n\n  const forceUpdate = useForceUpdate();\n  const handleUnfreeze = useCallback(() => {\n    if (!isPending.current) {\n      return;\n    }\n\n    isPending.current = false;\n    forceUpdate();\n  }, [forceUpdate]);\n  useHeavyAnimation(noop, handleUnfreeze);\n\n  return {\n    isFrozen: getIsHeavyAnimating(),\n    updateWhenUnfrozen,\n  };\n}\n\nfunction noop() {\n}\n","import { useState } from '../lib/teact/teact';\n\nimport type { ApiChat } from '../api/types';\n\nimport { callApi } from '../api/gramjs';\nimport useAsync from './useAsync';\nimport useDebouncedMemo from './useDebouncedMemo';\nimport useLastCallback from './useLastCallback';\n\nconst DEBOUNCE_TIMEOUT = 300;\n\nexport async function peerGlobalSearch(query: string) {\n  const searchResult = await callApi('searchChats', { query });\n  if (!searchResult) return undefined;\n\n  const ids = [...searchResult.accountResultIds, ...searchResult.globalResultIds];\n\n  return ids;\n}\n\nexport function prepareChatMemberSearch(chat: ApiChat) {\n  return async (query: string) => {\n    const searchResult = await callApi('fetchMembers', {\n      chat,\n      memberFilter: 'search',\n      query,\n    });\n\n    return searchResult?.members?.map((member) => member.userId) || [];\n  };\n}\n\nexport default function usePeerSearch({\n  query,\n  queryFn = peerGlobalSearch,\n  defaultValue,\n  debounceTimeout = DEBOUNCE_TIMEOUT,\n  isDisabled,\n}: {\n  query: string;\n  queryFn?: (query: string) => Promise<string[] | undefined>;\n  defaultValue?: string[];\n  debounceTimeout?: number;\n  isDisabled?: boolean;\n}) {\n  const debouncedQuery = useDebouncedMemo(() => query, debounceTimeout, [query]);\n  const [currentResultsQuery, setCurrentResultsQuery] = useState<string>('');\n  const searchQuery = !query ? query : debouncedQuery; // Ignore debounce if query is empty\n  const queryCallback = useLastCallback(queryFn);\n\n  const result = useAsync(async () => {\n    if (!searchQuery || isDisabled) {\n      setCurrentResultsQuery('');\n      return Promise.resolve(defaultValue);\n    }\n\n    const answer = await queryCallback(searchQuery);\n    setCurrentResultsQuery(searchQuery);\n    return answer;\n  }, [searchQuery, defaultValue, queryCallback, isDisabled], defaultValue);\n\n  return {\n    ...result,\n    currentResultsQuery,\n  };\n}\n","import {\n  memo, useMemo, useState,\n} from '../../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../../global';\n\nimport type { TabState } from '../../../../global/types';\nimport type { UniqueCustomPeer } from '../../../../types';\n\nimport { ALL_FOLDER_ID } from '../../../../config';\nimport { selectCanGift } from '../../../../global/selectors';\nimport { unique } from '../../../../util/iteratees';\nimport { MEMO_EMPTY_ARRAY } from '../../../../util/memo';\nimport sortChatIds from '../../../common/helpers/sortChatIds';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport { useFolderManagerForOrderedIds } from '../../../../hooks/useFolderManager';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport usePeerSearch from '../../../../hooks/usePeerSearch';\n\nimport PeerPicker from '../../../common/pickers/PeerPicker';\nimport PickerModal from '../../../common/pickers/PickerModal';\n\nexport type OwnProps = {\n  modal: TabState['giftTransferModal'];\n};\n\ntype StateProps = {\n  contactIds?: string[];\n  currentUserId?: string;\n};\n\ntype Categories = 'withdraw';\n\nconst GiftTransferModal = ({\n  modal, contactIds, currentUserId,\n}: OwnProps & StateProps) => {\n  const {\n    closeGiftTransferModal,\n    openGiftWithdrawModal,\n    openGiftTransferConfirmModal,\n  } = getActions();\n  const isOpen = Boolean(modal);\n\n  const lang = useLang();\n\n  const [searchQuery, setSearchQuery] = useState<string>('');\n\n  const renderingModal = useCurrentOrPrev(modal);\n\n  const orderedChatIds = useFolderManagerForOrderedIds(ALL_FOLDER_ID);\n\n  const sortedLocalIds = useMemo(() => {\n    return unique([\n      ...(contactIds || []),\n      ...(orderedChatIds || []),\n    ]);\n  }, [contactIds, orderedChatIds]);\n\n  const { result: foundIds, currentResultsQuery } = usePeerSearch({\n    query: searchQuery,\n    defaultValue: sortedLocalIds,\n  });\n\n  const isLoading = currentResultsQuery !== searchQuery;\n\n  const categories = useMemo(() => {\n    if (currentResultsQuery) return MEMO_EMPTY_ARRAY;\n\n    return [{\n      type: 'withdraw',\n      isCustomPeer: true,\n      avatarIcon: 'toncoin',\n      peerColorId: 5,\n      title: lang('GiftTransferTON'),\n    }] satisfies UniqueCustomPeer<Categories>[];\n  }, [lang, currentResultsQuery]);\n\n  const handleCategoryChange = useLastCallback((category: Categories) => {\n    if (category !== 'withdraw') return;\n\n    openGiftWithdrawModal({\n      gift: renderingModal!.gift,\n    });\n    closeGiftTransferModal();\n  });\n\n  const displayIds = useMemo(() => {\n    if (isLoading) return MEMO_EMPTY_ARRAY;\n    const global = getGlobal();\n\n    return sortChatIds((foundIds || []).filter((peerId) => (\n      peerId !== currentUserId && selectCanGift(global, peerId)\n    )),\n    false);\n  }, [isLoading, foundIds, currentUserId]);\n\n  const handlePeerSelect = useLastCallback((peerId: string) => {\n    if (!renderingModal?.gift) return;\n\n    openGiftTransferConfirmModal({\n      gift: renderingModal.gift,\n      recipientId: peerId,\n    });\n  });\n\n  return (\n    <PickerModal\n      isOpen={isOpen}\n      onClose={closeGiftTransferModal}\n      title={lang('GiftTransferTitle')}\n      hasCloseButton\n      shouldAdaptToSearch\n      withFixedHeight\n      ignoreFreeze\n    >\n      <PeerPicker<Categories>\n        itemIds={displayIds}\n        categories={categories}\n        onSelectedCategoryChange={handleCategoryChange}\n        withDefaultPadding\n        withPeerUsernames\n        isSearchable\n        noScrollRestore\n        isLoading={isLoading}\n        filterValue={searchQuery}\n        filterPlaceholder={lang('Search')}\n        onFilterChange={setSearchQuery}\n        onSelectedIdChange={handlePeerSelect}\n      />\n    </PickerModal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const { contactList, currentUserId } = global;\n\n    return {\n      contactIds: contactList?.userIds,\n      currentUserId,\n    };\n  },\n)(GiftTransferModal));\n","import { memo } from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type { ApiPeer } from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\n\nimport { getPeerTitle } from '../../../../global/helpers/peers';\nimport { selectPeer } from '../../../../global/selectors';\nimport { formatStarsAsIcon, formatStarsAsText } from '../../../../util/localization/format';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport GiftTransferPreview from '../../../common/gift/GiftTransferPreview';\nimport ConfirmDialog from '../../../ui/ConfirmDialog';\n\nexport type OwnProps = {\n  modal: TabState['giftTransferConfirmModal'];\n};\n\ntype StateProps = {\n  selectedPeer?: ApiPeer;\n};\n\nconst GiftTransferConfirmModal = ({ modal, selectedPeer }: OwnProps & StateProps) => {\n  const {\n    closeGiftTransferConfirmModal, transferGift, openChat, closeGiftModal, closeGiftTransferModal,\n  } = getActions();\n  const lang = useLang();\n\n  const isOpen = Boolean(modal);\n  const renderingModal = useCurrentOrPrev(modal);\n  const renderingSelectedPeer = useCurrentOrPrev(selectedPeer);\n\n  const handleConfirm = useLastCallback(() => {\n    if (!renderingModal?.gift.inputGift || !renderingModal.recipientId) return;\n\n    transferGift({\n      gift: renderingModal.gift.inputGift,\n      recipientId: renderingModal.recipientId,\n      transferStars: renderingModal.gift.transferStars,\n    });\n\n    closeGiftTransferConfirmModal();\n    openChat({ id: renderingModal.recipientId });\n\n    closeGiftModal();\n    closeGiftTransferModal();\n  });\n\n  if (!renderingModal) return undefined;\n\n  const { gift } = renderingModal;\n  const uniqueGift = gift.gift.type === 'starGiftUnique' ? gift.gift : undefined;\n\n  if (!uniqueGift) return undefined;\n\n  return (\n    <ConfirmDialog\n      isOpen={isOpen}\n      noDefaultTitle\n      onClose={closeGiftTransferConfirmModal}\n      confirmLabel={gift.transferStars\n        ? lang(\n          'GiftTransferConfirmButton',\n          { amount: formatStarsAsIcon(lang, gift.transferStars, { asFont: true }) },\n          { withNodes: true },\n        ) : lang('GiftTransferConfirmButtonFree')}\n      confirmHandler={handleConfirm}\n    >\n      {renderingSelectedPeer && (\n        <GiftTransferPreview\n          peer={renderingSelectedPeer}\n          gift={uniqueGift}\n        />\n      )}\n      <p>\n        {gift.transferStars\n          ? lang('GiftTransferConfirmDescription', {\n            gift: lang('GiftUnique', { title: uniqueGift.title, number: uniqueGift.number }),\n            amount: formatStarsAsText(lang, gift.transferStars),\n            peer: getPeerTitle(lang, renderingSelectedPeer!),\n          }, {\n            withNodes: true,\n            withMarkdown: true,\n          })\n          : lang('GiftTransferConfirmDescriptionFree', {\n            gift: lang('GiftUnique', { title: uniqueGift.title, number: uniqueGift.number }),\n            peer: getPeerTitle(lang, renderingSelectedPeer!),\n          }, {\n            withNodes: true,\n            withMarkdown: true,\n          })}\n      </p>\n    </ConfirmDialog>\n  );\n};\n\nexport default memo(\n  withGlobal<OwnProps>((global, { modal }): Complete<StateProps> => {\n    const selectedPeer = modal?.recipientId ? selectPeer(global, modal.recipientId) : undefined;\n\n    return {\n      selectedPeer,\n    };\n  })(GiftTransferConfirmModal),\n);\n","import { memo } from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type { ApiPeer } from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\n\nimport { selectPeer } from '../../../../global/selectors';\nimport { formatStarsAsIcon } from '../../../../util/localization/format';\nimport { renderGiftOriginalInfo } from '../../../common/helpers/giftOriginalInfo';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport ConfirmDialog from '../../../ui/ConfirmDialog';\n\nimport styles from './GiftDescriptionRemoveModal.module.scss';\n\nexport type OwnProps = {\n  modal: TabState['giftDescriptionRemoveModal'];\n};\n\ntype StateProps = {\n  senderPeer?: ApiPeer;\n  recipientPeer?: ApiPeer;\n};\n\nconst GiftDescriptionRemoveModal = ({\n  modal, senderPeer, recipientPeer,\n}: OwnProps & StateProps) => {\n  const {\n    closeGiftDescriptionRemoveModal, removeGiftDescription, openChat,\n  } = getActions();\n  const lang = useLang();\n\n  const isOpen = Boolean(modal);\n  const renderingModal = useCurrentOrPrev(modal);\n  const renderingSenderPeer = useCurrentOrPrev(senderPeer);\n  const renderingRecipientPeer = useCurrentOrPrev(recipientPeer);\n\n  const openChatHandler = useLastCallback((id: string) => {\n    closeGiftDescriptionRemoveModal();\n    openChat({ id });\n  });\n\n  const handleConfirm = useLastCallback(() => {\n    if (!renderingModal?.gift.inputGift || !renderingModal.price) return;\n\n    removeGiftDescription({\n      gift: renderingModal.gift.inputGift,\n      price: renderingModal.price,\n    });\n  });\n\n  if (!renderingModal || !renderingRecipientPeer) return undefined;\n\n  const { price, details } = renderingModal;\n\n  const description = renderGiftOriginalInfo({\n    originalDetails: details, recipient: renderingRecipientPeer,\n    sender: renderingSenderPeer, onOpenChat: openChatHandler, lang,\n  });\n\n  return (\n    <ConfirmDialog\n      isOpen={isOpen}\n      title={lang('RemoveGiftDescriptionTitle')}\n      onClose={closeGiftDescriptionRemoveModal}\n      confirmLabel={lang('RemoveGiftDescriptionButton', {\n        amount: formatStarsAsIcon(lang, price, { asFont: true }),\n      }, { withNodes: true })}\n      confirmHandler={handleConfirm}\n    >\n      <div className={styles.confirmText}>{lang('RemoveGiftDescriptionConfirmText')}</div>\n      {Boolean(description) && (\n        <div className={styles.giftDescription}>\n          {description}\n        </div>\n      )}\n    </ConfirmDialog>\n  );\n};\n\nexport default memo(\n  withGlobal<OwnProps>((global, { modal }): Complete<StateProps> => {\n    const senderPeer = modal?.details.senderId ? selectPeer(global, modal.details.senderId) : undefined;\n    const recipientPeer = modal?.details.recipientId ? selectPeer(global, modal.details.recipientId) : undefined;\n\n    return {\n      senderPeer,\n      recipientPeer,\n    };\n  })(GiftDescriptionRemoveModal),\n);\n","// extracted by mini-css-extract-plugin\nexport default {\"confirmText\":\"LVOpBXUW\",\"giftDescription\":\"FA1_yVBY\"};","import { memo, useState } from '../../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../../global';\n\nimport type { ApiUser } from '../../../../api/types';\nimport type { TabState } from '../../../../global/types';\n\nimport { getPeerTitle } from '../../../../global/helpers/peers';\nimport { selectUser } from '../../../../global/selectors';\nimport { formatStarsAsText } from '../../../../util/localization/format';\n\nimport useCurrentOrPrev from '../../../../hooks/useCurrentOrPrev';\nimport useLang from '../../../../hooks/useLang';\nimport useLastCallback from '../../../../hooks/useLastCallback';\n\nimport Checkbox from '../../../ui/Checkbox';\nimport ConfirmDialog from '../../../ui/ConfirmDialog';\n\nexport type OwnProps = {\n  modal: TabState['chatRefundModal'];\n};\n\ntype StateProps = {\n  user?: ApiUser;\n};\n\nconst ChatRefundModal = ({ modal, user }: OwnProps & StateProps) => {\n  const { closeChatRefundModal, toggleNoPaidMessagesException } = getActions();\n\n  const [shouldRefundStars, setShouldRefundStars] = useState(false);\n\n  const renderingModal = useCurrentOrPrev(modal);\n  const renderingUser = useCurrentOrPrev(user);\n\n  const { starsToRefund, userId } = renderingModal || {};\n\n  const lang = useLang();\n\n  const isOpen = Boolean(modal);\n\n  const handleConfirmRemoveFee = useLastCallback(() => {\n    closeChatRefundModal();\n    if (!userId) return;\n\n    toggleNoPaidMessagesException ({ userId, shouldRefundCharged: shouldRefundStars });\n  });\n\n  return (\n    <ConfirmDialog\n      isOpen={isOpen}\n      onClose={closeChatRefundModal}\n      title={lang('RemoveFeeTitle')}\n      confirmLabel={lang('ConfirmRemoveMessageFee')}\n      confirmHandler={handleConfirmRemoveFee}\n    >\n      {lang('ConfirmDialogMessageRemoveFee', {\n        peer: renderingUser && getPeerTitle(lang, renderingUser),\n      }, {\n        withMarkdown: true,\n        withNodes: true,\n      })}\n      {\n        Boolean(starsToRefund) && (\n          <Checkbox\n            className=\"dialog-checkbox\"\n            label={lang('ConfirmDialogRemoveFeeRefundStars', {\n              amount: formatStarsAsText(lang, starsToRefund),\n            }, {\n              withMarkdown: true,\n              withNodes: true,\n            })}\n            checked={shouldRefundStars}\n            onCheck={setShouldRefundStars}\n          />\n        )\n      }\n    </ConfirmDialog>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global, { modal }): Complete<StateProps> => {\n  const user = modal?.userId ? selectUser(global, modal.userId) : undefined;\n\n  return {\n    user,\n  };\n})(ChatRefundModal));\n","import type { FC } from '../../../lib/teact/teact';\nimport { memo, useCallback } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { ApiStarsAmount } from '../../../api/types';\nimport type { TabState } from '../../../global/types';\n\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { convertTonFromNanos } from '../../../util/formatCurrency';\nimport { formatStarsAsText, formatTonAsText } from '../../../util/localization/format';\n\nimport useLang from '../../../hooks/useLang';\n\nimport ConfirmDialog from '../../ui/ConfirmDialog';\n\nexport type OwnProps = {\n  modal: TabState['priceConfirmModal'];\n};\n\ntype StateProps = {\n  starBalance?: ApiStarsAmount;\n  tonBalance?: number;\n};\n\nconst PriceConfirmModal: FC<OwnProps & StateProps> = ({\n  modal,\n  starBalance,\n  tonBalance,\n}) => {\n  const actions = getActions();\n\n  const lang = useLang();\n\n  const handleConfirm = useCallback(() => {\n    if (!modal?.directInfo) {\n      actions.closePriceConfirmModal();\n      return;\n    }\n\n    const { currency, newAmount } = modal;\n    const isTon = currency === 'TON';\n    const currentBalance = isTon ? tonBalance : starBalance?.amount;\n\n    if (currentBalance === undefined) {\n      actions.closePriceConfirmModal();\n      return;\n    }\n\n    if (currentBalance < newAmount!) {\n      actions.openStarsBalanceModal({\n        currency: isTon ? 'TON' : 'XTR',\n        tabId: getCurrentTabId(),\n      });\n      actions.closePriceConfirmModal();\n      return;\n    }\n\n    actions.sendStarPaymentForm({\n      directInfo: modal.directInfo,\n      tabId: getCurrentTabId(),\n    });\n    actions.closePriceConfirmModal();\n  }, [modal, starBalance, tonBalance, actions]);\n\n  const handleClose = useCallback(() => {\n    actions.closePriceConfirmModal();\n  }, [actions]);\n\n  if (!modal) {\n    return undefined;\n  }\n\n  const {\n    originalAmount,\n    newAmount,\n    currency,\n  } = modal;\n\n  const isTon = currency === 'TON';\n\n  let originalAmountText: string;\n  let newAmountText: string;\n\n  if (isTon) {\n    originalAmountText = formatTonAsText(lang, convertTonFromNanos(originalAmount!));\n    newAmountText = formatTonAsText(lang, convertTonFromNanos(newAmount!));\n  } else {\n    originalAmountText = formatStarsAsText(lang, originalAmount!);\n    newAmountText = formatStarsAsText(lang, newAmount!);\n  }\n\n  return (\n    <ConfirmDialog\n      isOpen={Boolean(modal)}\n      onClose={handleClose}\n      title={lang('PriceChanged')}\n      confirmHandler={handleConfirm}\n      confirmLabel={lang('PayNewPrice')}\n    >\n      <p>\n        {lang('PriceChangedText', {\n          originalAmount: originalAmountText,\n          newAmount: newAmountText,\n        }, {\n          withMarkdown: true,\n          withNodes: true,\n        })}\n      </p>\n    </ConfirmDialog>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>((global): Complete<StateProps> => {\n  const starBalance = global.stars?.balance;\n  const tonBalance = global.ton?.balance?.amount;\n\n  return {\n    starBalance,\n    tonBalance,\n  };\n},\n)(PriceConfirmModal));\n"],"names":["memo","GiftMenuItems","peerId","canManage","gift","typeGift","currentUserEmojiStatus","collectibleEmojiStatuses","showNotification","openChatWithDraft","openGiftTransferModal","openGiftResalePriceComposerModal","openGiftStatusInfoModal","setEmojiStatus","toggleSavedGiftPinned","changeGiftVisibility","updateStarGiftPrice","closeGiftInfoModal","getActions","lang","useLang","oldLang","useOldLang","isSavedGift","savedGift","undefined","starGiftUniqueSlug","type","slug","starGiftUniqueLink","useMemo","TME_LINK_PREFIX","userCollectibleStatus","find","status","currenUniqueEmojiStatusSlug","isGiftUnique","canTakeOff","canWear","giftResalePrice","resellPrice","hasPinOptions","isUnsaved","handleTriggerVisibility","useLastCallback","inputGift","shouldUnsave","handleCopyLink","copyTextToClipboard","message","handleLinkShare","text","handleTransfer","canTransferAt","getServerTime","key","variables","date","formatDateAtTime","handleSell","canResellAt","handleUnsell","price","currency","STARS_CURRENCY_CODE","amount","nanos","icon","title","number","handleWear","emojiStatus","handleTakeOff","documentId","DEFAULT_STATUS_ICON_ID","handleTogglePin","_jsxs","_Fragment","children","_jsx","MenuItem","isPinned","onClick","Boolean","withGlobal","global","modal","user","forUserId","selectUser","StarsGiftModal","closeStarsGiftModal","openInvoice","requestConfetti","dialogRef","useRef","isOpen","renderingModal","useCurrentOrPrev","selectedOption","setSelectedOption","useState","isHeaderHidden","setHeaderHidden","useEffect","showConfetti","dialog","current","top","left","width","height","querySelector","getBoundingClientRect","withStars","isCompleted","handleClick","option","userId","id","stars","handleClose","bottomText","parts","split","SafeLink","url","Modal","className","buildClassName","styles","modalDialog","contentClassName","content","isSlim","onClose","main","onScroll","e","scrollTop","currentTarget","Button","round","size","closeButton","color","ariaLabel","Icon","name","header","hiddenHeader","starHeaderText","headerInfo","Avatar","peer","avatar","logoBackground","src","StarsBackground","alt","draggable","logo","StarLogo","headerText","center","renderText","formatCurrencyAsString","code","description","getPeerTitle","section","StarTopupOptionList","options","starsGiftOptions","secondaryInfo","chats","listIds","currentUserId","userIds","contactList","activeListIds","active","archivedListIds","archived","StarsGiftingPickerModal","closeStarsGiftingPickerModal","openStarsGiftModal","searchQuery","setSearchQuery","displayedUserIds","usersById","getGlobal","users","byId","combinedIds","unique","filteredUserIds","filterPeersByQuery","ids","query","sortChatIds","filter","isSupport","isUserBot","isDeletedUser","SERVICE_NOTIFICATIONS_USER_ID","handleSelectedUserIdsChange","newSelectedId","length","PickerModal","hasCloseButton","shouldAdaptToSearch","withFixedHeight","confirmButtonText","onEnter","PeerPicker","itemIds","filterValue","filterPlaceholder","onFilterChange","isSearchable","withDefaultPadding","withStatus","onSelectedIdChange","BalanceBlock","balance","withAddButton","openStarsBalanceModal","balanceBlock","balanceInfo","smallerText","balanceBottom","TON_CURRENCY_CODE","convertCurrencyFromBaseUnit","StarIcon","formatStarsAmount","BadgeButton","addStarsButton","addStarsIcon","StarsSubscriptionItem","subscription","openStarsSubscriptionModal","pricing","until","isCancelled","photo","useSelector","selectPeer","selectProvidedPeer","hasExpired","Date","now","formattedDate","formatDateToString","root","preview","subscriptionStar","info","subtitle","webPhoto","statusEnded","statusPricing","star","formatInteger","statusPeriod","getTransactionTitle","transaction","paidMessages","count","withNodes","pluralValue","isGiftResale","isNegativeAmount","isPostsSearch","isDropOriginalDetails","isPrepaidUpgrade","starRefCommision","formatPercent","isGiftUpgrade","extendedMedia","subscriptionPeriod","isReaction","giveawayPostId","isMyGift","isGift","starGift","customPeer","shouldUseCustomPeer","buildStarsTransactionCustomPeer","titleKey","currencyAmount","starsAmount","SingleMediaThumb","boughtMedia","index","media","video","mediaHash","getMediaHash","thumb","getMediaThumbUri","mediaBlob","useMedia","blurry","full","PaidMediaThumb","isTransactionPreview","Math","min","isLocked","dir","slice","reverse","map","item","i","arr","realIndex","MediaSpoiler","isVisible","thumbDataUri","thumbnail","dataUri","noOutline","StarsTransactionItem","openStarsTransactionModal","transactionPeer","selectOptionalPeer","isUniqueGift","giftSticker","getStickerFromGift","data","avatarPeer","subtitleKey","CUSTOM_PEER_PREMIUM","isRefund","hasFailed","isPending","previewContent","backdrop","getGiftAttributes","backgroundColors","centerColor","edgeColor","RadialPatternBackground","uniqueGiftBackground","AnimatedIconFromSticker","sticker","play","amountColorClass","negative","positive","formatDateTimeToString","formatStarsTransactionAmount","TRANSACTION_TYPES","TRANSACTION_TABS_KEYS","TRANSACTION_ITEM_CLASS","shouldForceHeight","ton","history","all","transactions","starsBalanceState","tonBalanceState","canBuyPremium","selectIsPremiumPurchaseBlocked","tonUsdRate","appConfig","tonTopupUrl","animationLevel","selectSharedSettings","StarsBalanceModal","closeStarsBalanceModal","loadStarsTransactions","loadStarsSubscriptions","openStarsGiftingPickerModal","openUrl","currentState","subscriptions","selectedTabIndex","setSelectedTabIndex","areBuyOptionsShown","showBuyOptions","hideBuyOptions","useFlag","originStarsPayment","originReaction","originGift","topup","shouldOpenOnBuy","ongoingTransactionAmount","form","invoice","totalAmount","subscriptionInfo","subscriptionPricing","balanceNeeded","starsNeeded","starsNeededText","channel","selectChat","chatId","getChatTitle","bot","botId","getUserFullName","purpose","PAID_MESSAGES_PURPOSE","withMarkdown","shouldShowItems","shouldSuggestGifting","modalHeight","transactionCount","transactionTabs","tosText","handleLoadMoreTransactions","isTon","handleLoadMoreSubscriptions","openStarsGiftingPickerModalHandler","handleBuyStars","handleTonTopUp","minimal","dialogStyle","modalBalance","renderTonHeaderSection","tonAmount","ParticlesHeader","model","isDisabled","tonBalanceContainer","tonBalance","tonIconBalance","tonInUsd","convertTonToUsd","topUpButton","fluid","starButton","isText","noForcedUpperCase","topupOptions","tos","hint","list","sectionTitle","nextOffset","disabled","isLoading","loadMore","loadMoreIcon","container","lastSection","Transition","resolveTransitionName","isRtl","activeKey","renderCount","shouldRestoreHeight","transition","InfiniteScroll","onLoadMore","items","scrollContainerClosest","itemSelector","noFastList","noScrollRestoreOnTop","TabList","tabs","tabClassName","tab","activeTab","onSwitchTab","messageInputInvoice","inputInvoice","selectChatMessage","messageId","chat","isPaidMedia","paidMedia","paidMediaMessage","paidMediaChat","StarPaymentModal","closeStarsPaymentModal","sendStarPaymentForm","markLoading","unmarkLoading","prevModal","usePrevious","isBotSubscription","canShowPeerItem","descriptionText","botName","starsText","areAllPhotos","every","duration","areAllVideos","mediaText","channelTitle","disclaimerText","link","inviteCustomPeer","getCustomPeerFromInvite","handlePayment","paymentContent","hasAbsoluteCloseButton","paymentImages","paymentPhoto","avatarStar","PeerBadge","avatarWebPhoto","avatarSize","badgeIcon","badgeText","badgeClassName","amountBadge","paymentImageBackground","PeerChip","botItem","paymentButton","formatStarsAsIcon","asFont","disclaimer","currentUser","statuses","UniqueGiftManageButtons","selectTabState","giftInfoModal","currentUniqueEmojiStatusSlug","handleUnlist","iconName","iconAlignment","iconClassName","UniqueGiftHeader","modelAttribute","backdropAttribute","patternAttribute","subtitlePeer","showManageButtons","openChat","isGiftHover","markGiftHover","unmarkGiftHover","useTransitionActiveKey","subtitleColor","textColor","radialPatternBackdrop","backdropColors","patternIcon","yPosition","REM","slideClassName","direction","noLoop","onMouseEnter","IS_TOUCH_ENV","onMouseLeave","style","buildStyle","AVATAR_SPARKLES_CENTER_SHIFT","paidMessageCommission","starsPaidMessageCommissionPermille","starsGiftSticker","selectGiftStickerForStars","selectGiftStickerForTon","canPlayAnimatedEmojis","selectCanPlayAnimatedEmojis","topSticker","StarsTransactionModal","openMediaViewer","closeStarsTransactionModal","triggerSparklesRef","handleOpenMedia","origin","MediaViewerOrigin","StarsTransaction","standaloneMedia","flatMap","Object","values","handleAvatarMouseMove","handleRequestAnimation","animate","starModalData","giftAttributes","toName","getStarsPeerTitleKey","messageLink","getMessageLink","giveawayMessageLink","mediaAmount","m","shouldDisplayAvatar","uniqueGiftHeader","pattern","regularHeader","onMouseMove","InteractiveSparkles","onRequestAnimation","centerShift","percent","tableData","peerLabel","push","containerClassName","footerTextParts","footer","renderingModalData","TableInfoModal","hasBackdrop","buttonText","StarsSubscriptionModal","closeStarsSubscriptionModal","fulfillStarsSubscription","changeStarsSubscription","checkChatInvite","loadStarStatus","buttonState","canRefulfill","isActive","canRestart","chatInviteHash","invoiceSlug","handleButtonClick","hash","hasBotCancelled","isApiPeerUser","specialReplacement","STARS_ICON_PLACEHOLDER","footerTos","DEFAULT_POINTS","getProgress","points","value","pointIndex","findIndex","point","prevPoint","nextPoint","getValue","progress","floor","StarSlider","maxValue","defaultValue","onChange","floatingBadgeRef","result","setValue","useEffectOnce","updateSafeBadgePosition","badge","parent","parentElement","requestMeasure","safeMinX","offsetLeft","offsetWidth","safeMaxX","requestMutation","setProperty","useResizeObserver","handleChange","event","newValue","Number","floatingBadgeWrapper","floatingBadge","ref","floatingBadgeText","floatingBadgeIcon","AnimatedCounter","floatingBadgeTriangle","viewBox","fill","x1","x2","y1","y2","offset","d","Sparkles","preset","sparkles","slider","max","step","ANONYMOUS_PEER","avatarIcon","customPeerAvatarColor","isCustomPeer","starBalance","maxAmount","paidReactionMaxAmount","defaultPrivacy","settings","paidReactionPrivacy","sendPaidReactionsAsPeerIds","PaidReactionModal","closePaidReactionModal","addLocalPaidReaction","loadSendPaidReactionsAs","setStarsAmount","isTouched","markTouched","unmarkTouched","shouldSendAsAnonymous","setShouldSendAsAnonymous","sendAsPeerId","setSendAsPeerId","senderPeer","isMobile","useAppLayout","handleShowInTopSendersChange","target","checked","handleAmountChange","filteredMyReactorIds","unshift","canChangeSendAsPeer","currentReactor","reactions","topReactors","reactor","isMy","isAnonymous","includes","handleSend","isPrivate","shouldIgnoreDefaultPrivacy","handleSendAsPeerChange","renderMenuItem","isSelected","itemInfo","FullNameTitle","itemTitle","noFake","noVerified","itemSubtitle","itemIcon","SendAsPeerMenuButton","onTrigger","ripple","sendAsPeerMenuButton","sendAsPeerButtonAvatar","buttonDownIcon","sendAsPeersMenu","DropdownMenu","sendAsPeerMenu","bubbleClassName","sendAsPeerMenuBubble","trigger","positionX","autoClose","hasCurrentSender","myReactorAmount","forEach","isCurrentReactor","localAmount","sender","sort","a","b","chatTitle","isLowStackPriority","sendAsPeersMenuContainer","headerControlPanel","Separator","topLabel","countText","topPeer","topBadge","separator","Checkbox","checkBox","label","buttonStar","theme","selectTheme","isBlurred","isBackgroundBlurred","patternColor","background","customBackground","backgroundColor","selectThemeValues","paidMessagesStars","selectPeerPaidMessagesStars","userFullInfo","selectUserFullInfo","isGiftForSelf","areUniqueStarGiftsDisallowed","disallowedGifts","shouldDisallowUniqueStarGifts","shouldDisallowLimitedStarGifts","tabState","captionLimit","starGiftMaxMessageLength","isPaymentFormLoading","giftByStars","sendStarGift","sendPremiumGiftByStars","openGiftUpgradeModal","giftMessage","setGiftMessage","shouldHideName","setShouldHideName","shouldPayForUpgrade","setShouldPayForUpgrade","shouldPayByStars","setShouldPayByStars","customBackgroundValue","useCustomBackground","isStarGift","isPremiumGift","hasPremiumByStars","isPeerUser","isSelf","localMessage","currentGift","isOutgoing","senderId","action","mediaType","months","isNameHidden","starsToConvert","canUpgrade","alreadyPaidUpgradeStars","upgradeStars","fromId","handleGiftMessageChange","handleShouldHideNameChange","handleShouldPayForUpgradeChange","toggleShouldPayByStars","handleOpenUpgradePreview","giftId","handleGetMoreStars","handleMainButtonClick","shouldUpgrade","canUseStarsPayment","bgClassName","inert","ActionMessage","threadId","MAIN_THREAD_ID","appearanceOrder","symbolsLeft","TextArea","maxLength","maxLengthIndicator","toString","ListItem","narrow","Switcher","Link","isPrimary","receiver","renderOptionsSection","formatCurrency","availabilityRemains","PremiumProgress","availabilityTotal","rightText","leftText","renderFooter","selectGiftStickerForDuration","baseMonthAmount","optionByStars","handleGiftClick","perMonth","discount","ceil","tabIndex","role","nonInteractive","caption","renderMonths","pill","GiftRibbon","isCurrentUserPremium","selectIsCurrentUserPremium","isResale","withTransferBadge","observeIntersection","openGiftInfoModal","openPremiumModal","checkCanSendGift","stickerRef","setIsVisible","isHover","markHover","unmarkHover","uniqueGift","regularGift","priceInfo","amounts","resaleTonOnly","getPriceAmount","priceCurrency","resellMinStars","formattedPrice","isLimited","isSoldOut","isPremiumRequired","requirePremium","isUserLimitReached","limitedPerUser","perUserRemains","perUserTotal","onSuccess","ringsCount","ovalFactor","giftNumber","lockedUntilDate","giftRibbon","useOnIntersect","entry","visible","isIntersecting","badgeContent","formatTonAsIcon","shouldConvertFromNanos","StickerView","observeIntersectionForPlaying","observeIntersectionForLoading","containerRef","shouldLoop","shouldPreloadPreview","withSparkleEffect","starGifts","resaleGifts","areGiftsAllLoaded","isAllLoaded","areGiftsLoading","updateIteration","resellGifts","gifts","GiftModalResaleScreen","onGiftClick","loadResaleGifts","updateResaleGiftsFilter","scrollerRef","resellGiftsIds","g","hasFilter","modelAttributes","patternAttributes","backdropAttributes","handleLoadMoreResellGifts","regularGiftId","isGiftsEmpty","viewportIds","useInfiniteScroll","RESALE_GIFTS_LIMIT","observe","useIntersectionObserver","rootRef","throttleMs","handleResetGiftsFilter","resaleScreenRoot","notFoundGiftsRoot","AnimatedIconWithPreview","tgsUrl","LOCAL_TGS_URLS","SearchingDuck","notFoundGiftsDescription","notFoundGiftsLink","resaleStarGiftsContainer","preloadBackwards","GiftItemStar","ATTRIBUTE_STICKER_SIZE","ResaleGiftMenuAttributeSticker","customColor","useDynamicColorListener","thumbClassName","attributes","counters","GiftResaleFilters","searchModelQuery","setSearchModelQuery","searchBackdropQuery","setSearchBackdropQuery","searchPatternQuery","setSearchPatternQuery","filteredAttributes","counter","attribute","found","attr","backdropId","filteredAndSearchedAttributes","filterBySearch","trim","toLowerCase","sortMenuRef","isContextMenuOpen","isSortContextMenuOpen","contextMenuAnchor","sortContextMenuAnchor","handleContextMenu","handleSortContextMenu","handleContextMenuClose","handleSortContextMenuClose","handleContextMenuHide","handleSortContextMenuHide","useContextMenuHandlers","getSortMenuElement","modelMenuRef","isModelContextMenuOpen","modelContextMenuAnchor","handleModelContextMenu","handleModelContextMenuClose","handleModelContextMenuHide","getModelMenuElement","backdropMenuRef","isBackdropContextMenuOpen","backdropContextMenuAnchor","handleBackdropContextMenu","handleBackdropContextMenuClose","handleBackdropContextMenuHide","getBackdropMenuElement","patternMenuRef","isPatternContextMenuOpen","patternContextMenuAnchor","handlePatternContextMenu","handlePatternContextMenuClose","handlePatternContextMenuHide","getPatternMenuElement","SortMenuButton","sortType","isMenuOpen","ModelMenuButton","attributesCount","BackdropMenuButton","PatternMenuButton","handleSortMenuItemClick","handleSelectedAllModelsClick","handleSelectedAllPatternsClick","handleSelectedAllBackdropsClick","handleModelMenuItemClick","updatedAttributes","some","handlePatternMenuItemClick","handleBackdropMenuItemClick","handleSearchModelInputReset","useCallback","handleSearchBackdropInputReset","handleSearchPatternInputReset","handleSearchInputClick","stopPropagation","preventDefault","modelMenuItemsContainerRef","Menu","anchor","menu","getMenuElement","onCloseAnimationEnd","menuItemText","menuItemIcon","models","selectedAttributes","isSelectedAll","menuContentContainer","SearchInput","search","onReset","placeholder","menuItemStickerText","renderModelMenuItems","right","backdrops","backdropAttributeMenuItemText","renderBackdropMenuItems","patterns","renderPatternMenuItems","buttonsContainer","idsByCategory","StarGiftCategoryList","onCategoryChanged","areLimitedStarGiftsDisallowed","hasMyUnique","hasCollectible","collectible","selectedCategory","setSelectedCategory","renderCategoryName","category","renderCategoryItem","handleItemClick","useHorizontalScroll","runThrottledForScroll","throttle","cb","forPeerId","resaleGiftsCount","areResaleGiftsLoading","selectedResaleGift","boostPerSentGift","boostsPerSentGift","starGiftsById","starGiftIdsByCategory","myUniqueGiftsById","myUniqueGifts","myUniqueGiftIds","tabId","GiftModal","closeGiftModal","resetResaleGifts","openGiftInMarket","closeResaleGiftsMarket","loadMyUniqueGifts","openGiftTransferConfirmModal","transitionRef","giftHeaderRef","isApiPeerChat","selectedGift","setSelectedGift","shouldShowMainScreenHeader","setShouldShowMainScreenHeader","isMainScreenHeaderForStarGifts","setIsMainScreenHeaderForStarGifts","isGiftScreenHeaderForStarGifts","setIsGiftScreenHeaderForStarGifts","areAllGiftsDisallowed","shouldDisallowPremiumGifts","disallowedGiftTypes","areUnlimitedStarGiftsDisallowed","shouldDisallowUnlimitedStarGifts","allGifts","filteredGifts","prevGift","giftsByStars","mapGifts","Map","starsGift","set","baseGift","reduce","prev","isResaleScreen","isGiftScreen","shouldShowHeader","isHeaderForStarGifts","handleScroll","headerTop","transitionTop","giftPremiumDescription","starGiftDescription","renderTextFilters","recipientId","handleMyGiftClick","handleLoadMore","handleCloseModal","handleCloseButtonClick","isBackButton","buttonClassName","resaleHeader","headerSlide","isFirstLoading","resaleHeaderContentContainer","resaleHeaderText","resaleHeaderDescription","commonHeaderText","renderHeader","avatars","premiumGiftsGallery","GiftItemPremium","get","starGiftsDescription","starGiftsTransition","starGiftsContainer","filteredGiftIds","availabilityResale","shouldShowResale","shouldDuplicateAsResale","elements","renderStarGifts","GiftSendingOptions","GiftRecipientPicker","closeGiftRecipientPicker","openGiftModal","idsWithSelf","concat","filteredPeerIds","selectCanGift","selectedId","forceShowSelf","renderGiftOriginalInfo","originalDetails","recipient","onOpenChat","recipientLink","renderTextWithEntities","senderLink","AVATAR_SIZE","GIFT_STICKER_SIZE","GiftTransferPreview","giftPreview","patternSize","arrow","fromPeer","targetPeer","hasAdminRights","getHasAdminRight","recipientPeer","releasedByPeerId","releasedByPeer","starGiftMaxConvertPeriod","tonExplorerUrl","GiftInfoModal","convertGiftToStars","openChatWithInfo","focusMessage","buyStarGift","openGiftInfoValueModal","openGiftDescriptionRemoveModal","isConvertConfirmOpen","openConvertConfirm","closeConvertConfirm","isConfirmModalOpen","setIsConfirmModalOpen","shouldPayInTon","setShouldPayInTon","splitButtonRef","menuRef","uniqueGiftHeaderRef","handleSymbolClick","handleBackdropClick","handleModelClick","renderingFromPeer","renderingTargetPeer","isTargetChat","isSender","canConvertDifference","conversionLeft","hasConvertOption","giftSubtitle","ownerTitle","getMainUsername","fallbackText","owner","selfCollectibleStatus","isSelfUnique","canFocusUpgrade","upgradeMsgId","ownerId","getResalePrice","isInTon","confirmPrice","canBuyGift","giftOwnerTitle","ownerName","handleFocusUpgraded","giftChat","handleConvertToStars","handleRemoveMessage","dropOriginalDetailsStars","details","handleOpenUpgradeModal","giftOwnerId","handleBuyGift","closeConfirmModal","handleConfirmBuyGift","handleOpenValueModal","SettingsMenuButton","headerButton","onContextMenu","renderFooterButton","isShiny","upgradeIcon","prepaidUpgradeHash","saleDateInfo","firstSaleDate","lastSaleDate","modalData","isConverted","canConvert","isVisibleForMe","uniqueGiftModalHeader","modalHeader","giftResalePriceContainer","giftResalePriceStar","headerSplitButton","moreIcon","soldOut","CUSTOM_PEER_HIDDEN","unknown","starsValue","giftValue","starAmountIcon","total","ownerAddress","ownerPeer","copyIcon","withEmojiStatus","uniqueAttribute","attributeName","rarityPercent","issued","issuedCount","totalCount","valueAmount","valueCurrency","uniqueValue","messageContainer","removeMessageButton","tonLink","giftAddress","footerDescription","shouldSkipModal","getRootElement","getTriggerElement","getLayout","withPortal","uniqueGiftContextMenu","modalContent","withBalanceBar","currencyInBalanceBar","ConfirmDialog","noDefaultTitle","confirmLabel","confirmHandler","descriptionConfirm","titleConfirm","formatTonAsText","formatStarsAsText","onCheck","checkBoxDescription","GiftInfoValueModal","closeGiftInfoValueModal","handleOpenFragment","valueInfo","fragmentListedUrl","handleOpenTelegramMarket","giftName","initialSaleDate","initialSaleStars","initialSalePrice","lastSalePrice","floorPrice","averagePrice","canBuyOnFragment","fragmentListedCount","canBuyOnTelegram","listedCount","GiftLockedModal","closeLockedGiftModal","getMessageText","untilDate","timeRemaining","relativeDate","formatShortDuration","reason","headerClassName","configPermille","starsStargiftResaleCommissionPermille","starsStargiftResaleAmountMin","starsStargiftResaleAmountMax","starsUsdWithdrawRateX1000","starsUsdWithdrawRate","tonConfigPermille","tonStargiftResaleCommissionPermille","tonStargiftResaleAmountMin","convertTonFromNanos","maxTonFromConfig","tonStargiftResaleAmountMax","GiftResalePriceComposerModal","closeGiftResalePriceComposerModal","setPrice","isPriceInTon","setIsPriceInTon","hasPrice","handleChangePrice","parseFloat","isNaN","handleSellGift","convertTonToNanos","commission","minAmount","isPriceCorrect","InputText","inputMode","teactExperimentControlled","priceWithCommission","toFixed","GiftUpgradeModal","closeGiftUpgradeModal","upgradeGift","upgradePrepaidGift","renderingRecipient","shouldKeepOriginalDetails","setShouldKeepOriginalDetails","isPrepaid","previewAttributes","setPreviewAttributes","handleUpgrade","updatePreviewAttributes","sampleAttributes","previousSelection","random","getRandomAttributes","useInterval","getStickerMediaHash","fetch","ApiMediaFormat","BlobUrl","userName","listItemData","TableAboutModal","GiftStatusInfoModal","closeGiftStatusInfoModal","useCustomEmoji","patternDocumentId","onWearClick","customEmoji","mockPeerWithStatus","FRAGMENT_PEER","byKey","hasPassword","twoFaSettings","passwordHint","GiftWithdrawModal","closeGiftWithdrawModal","clearGiftWithdrawError","processStarGiftWithdrawal","openSettingsScreen","shouldShowPassword","setShouldShowPassword","exportDelay","canExportAt","handleSubmit","password","handleSetUpPassword","screen","SettingsScreens","TwoFaDisabled","isCondensedHeader","exportHint","days","getDays","noPassword","PasswordForm","shouldShowSubmit","error","errorKey","withRegular","onClearError","isPasswordVisible","shouldResetValue","onChangePasswordVisibility","submitLabel","onSubmit","noop","async","peerGlobalSearch","searchResult","callApi","accountResultIds","globalResultIds","contactIds","GiftTransferModal","closeGiftTransferModal","openGiftWithdrawModal","orderedChatIds","useFolderManagerForOrderedIds","ALL_FOLDER_ID","sortedLocalIds","foundIds","currentResultsQuery","queryFn","debounceTimeout","debouncedQuery","resolverFn","ms","dependencies","isFrozen","updateWhenUnfrozen","forceUpdate","useForceUpdate","handleUnfreeze","useHeavyAnimation","getIsHeavyAnimating","useHeavyAnimationFreeze","runDebounced","useRunDebounced","useSyncEffect","useDebouncedMemo","setCurrentResultsQuery","queryCallback","useAsync","Promise","resolve","answer","usePeerSearch","categories","MEMO_EMPTY_ARRAY","peerColorId","handleCategoryChange","displayIds","handlePeerSelect","ignoreFreeze","onSelectedCategoryChange","withPeerUsernames","noScrollRestore","selectedPeer","GiftTransferConfirmModal","closeGiftTransferConfirmModal","transferGift","renderingSelectedPeer","handleConfirm","transferStars","GiftDescriptionRemoveModal","closeGiftDescriptionRemoveModal","removeGiftDescription","renderingSenderPeer","renderingRecipientPeer","openChatHandler","ChatRefundModal","closeChatRefundModal","toggleNoPaidMessagesException","shouldRefundStars","setShouldRefundStars","renderingUser","starsToRefund","handleConfirmRemoveFee","shouldRefundCharged","PriceConfirmModal","actions","directInfo","closePriceConfirmModal","newAmount","currentBalance","getCurrentTabId","originalAmount","originalAmountText","newAmountText"],"sourceRoot":""}