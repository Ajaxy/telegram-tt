"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[6930],{25404:(e,t,i)=>{i.d(t,{A:()=>p});var n=i(84051),a=i(13439),r=i(31481),o=i(85982),s=i(17663),l=i(80140),c=i(39351),d=i(17712),u=i(59030),m=i(24433),f=i(20021);const p=(0,n.ph)(({peerId:e,canManage:t,gift:i,currentUserEmojiStatus:p,collectibleEmojiStatuses:h})=>{const{showNotification:A,openChatWithDraft:g,openGiftTransferModal:b,openGiftResalePriceComposerModal:v,openGiftStatusInfoModal:N,setEmojiStatus:G,toggleSavedGiftPinned:S,changeGiftVisibility:C,updateStarGiftPrice:I,closeGiftInfoModal:y}=(0,a.ko)(),k=(0,c.A)(),Y=(0,u.A)(),B=i&&"gift"in i,w=B?i:void 0,D=B?i.gift:i,P="starGiftUnique"===D?.type?D.slug:void 0,T=(0,n.Kr)(()=>{if(P)return`${r.jsp}nft/${P}`},[P]),M=(0,n.Kr)(()=>{if(P)return h?.find(e=>"collectible"===e.type&&e.slug===P)},[P,h]),F="collectible"===p?.type?p.slug:void 0,U=D&&"starGiftUnique"===D.type,R=U&&F===D.slug,x=M&&!R,L=U?D.resellPrice:void 0,O=t&&w&&!w.isUnsaved&&U,K=(0,d.A)(()=>{const{inputGift:e,isUnsaved:t}=w;C({gift:e,shouldUnsave:!t})}),V=(0,d.A)(()=>{T&&((0,o.eM)(T),A({message:k("LinkCopied")}))}),E=(0,d.A)(()=>{T&&g({text:{text:T}})}),q=(0,d.A)(()=>{w&&"starGiftUnique"===w?.gift.type&&(w.canTransferAt&&w.canTransferAt>(0,l.Fm)()?A({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,s.U)(Y,1e3*w.canTransferAt)}}}):b({gift:w}))}),H=(0,d.A)(()=>{w&&(w.canResellAt&&w.canResellAt>(0,l.Fm)()?A({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,s.U)(Y,1e3*w.canResellAt)}}}):v({peerId:e,gift:w}))}),z=(0,d.A)(()=>{w&&"starGiftUnique"===w.gift.type&&w.inputGift&&(y(),I({gift:w.inputGift,price:{currency:r.OUy,amount:0,nanos:0}}),A({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:k("GiftUnique",{title:w.gift.title,number:w.gift.number})}}}))}),W=(0,d.A)(()=>{"starGiftUnique"===D?.type&&M&&N({emojiStatus:M})}),J=(0,d.A)(()=>{R&&G({emojiStatus:{type:"regular",documentId:r.zNY}})}),j=(0,d.A)(()=>{S({peerId:e,gift:w})});return(0,f.FD)(f.FK,{children:[O&&(0,f.Y)(m.A,{icon:w.isPinned?"unpin":"pin",onClick:j,children:k(w.isPinned?"ChatListUnpinFromTop":"ChatListPinToTop")}),(0,f.Y)(m.A,{icon:"link-badge",onClick:V,children:k("CopyLink")}),(0,f.Y)(m.A,{icon:"forward",onClick:E,children:k("Share")}),t&&U&&(0,f.Y)(m.A,{icon:"diamond",onClick:q,children:k("GiftInfoTransfer")}),t&&U&&!L&&(0,f.Y)(m.A,{icon:"sell-outline",onClick:H,children:k("Sell")}),t&&U&&Boolean(L)&&(0,f.Y)(m.A,{icon:"unlist-outline",onClick:z,children:k("GiftInfoUnlist")}),t&&w&&(0,f.Y)(m.A,{icon:w.isUnsaved?"eye-outline":"eye-crossed-outline",onClick:K,children:k(w.isUnsaved?"GiftActionShow":"GiftActionHide")}),x&&(0,f.Y)(m.A,{icon:"crown-wear-outline",onClick:W,children:k("GiftInfoWear")}),R&&(0,f.Y)(m.A,{icon:"crown-take-off-outline",onClick:J,children:k("GiftInfoTakeOff")})]})})},82138:(e,t,i)=>{i.r(t),i.d(t,{AboutStarGiftModal:()=>Li,ChatRefundModal:()=>nn,GiftAuctionAcquiredModal:()=>Mi,GiftAuctionBidModal:()=>Bi,GiftAuctionChangeRecipientModal:()=>Ui,GiftAuctionInfoModal:()=>wi,GiftAuctionModal:()=>ki,GiftDescriptionRemoveModal:()=>$i,GiftInfoModal:()=>fi,GiftInfoValueModal:()=>hi,GiftLockedModal:()=>Ai,GiftModal:()=>ti,GiftOfferAcceptModal:()=>tn,GiftRecipientPicker:()=>ii,GiftResalePriceComposerModal:()=>bi,GiftStatusInfoModal:()=>Vi,GiftTransferConfirmModal:()=>Xi,GiftTransferModal:()=>Qi,GiftUpgradeModal:()=>Si,GiftWithdrawModal:()=>Wi,PaidReactionModal:()=>ut,PriceConfirmModal:()=>rn,StarGiftPriceDecreaseInfoModal:()=>Ri,StarPaymentModal:()=>be,StarsBalanceModal:()=>fe,StarsGiftModal:()=>G,StarsGiftingPickerModal:()=>B,StarsSubscriptionModal:()=>Ve,StarsTransactionInfoModal:()=>Le});var n=i(84051),a=i(13439),r=i(70636),o=i(91048),s=i(87357),l=i(17142),c=i(4961),d=i(14),u=i(17712),m=i(59030),f=i(21849),p=i(84685),h=i(22337),A=i(1526);const g={modalDialog:"MFXAwnxJ",content:"Sl6xVf1R",main:"bTN9Jeph",headerInfo:"c6MiyJgW",logo:"StGLWvzb",logoBackground:"SyTXSfml",description:"kFe3mIZo",section:"BgfHkWd2",header:"zMtAGfXs",starHeaderText:"q3v8orGj",hiddenHeader:"bq3FnXT0",closeButton:"bDsDTkbe",avatar:"jK36xUj4",center:"v1PckUQn",secondaryInfo:"TDWSRfP9"},b=i.p+"GoldStar.fb6812e915ddfe27f504.svg",v=i.p+"stars-bg.dee4c4b73c7d21c2ec73.png";var N=i(20021);const G=(0,n.ph)((0,a.EK)((e,{modal:t})=>({user:t?.forUserId?(0,o.mBe)(e,t.forUserId):void 0}))(({modal:e,user:t})=>{const{closeStarsGiftModal:i,openInvoice:o,requestConfetti:G}=(0,a.ko)(),S=(0,n.li)(),C=Boolean(e?.isOpen),I=(0,d.A)(e),y=(0,m.A)(),[k,Y]=(0,n.J0)(),[B,w]=(0,n.J0)(!0);(0,n.vJ)(()=>{C||w(!0)},[C]);const D=(0,u.A)(()=>{const e=S.current;if(e&&C){const{top:t,left:i,width:n,height:a}=e.querySelector(".modal-content").getBoundingClientRect();G({top:t,left:i,width:n,height:a,withStars:!0})}});(0,n.vJ)(()=>{I?.isCompleted&&D()},[I,D]);const P=(0,u.A)(e=>{I&&(Y(e),o(t?{type:"starsgift",userId:t.id,stars:e.stars,currency:e.currency,amount:e.amount}:{type:"stars",stars:e.stars,currency:e.currency,amount:e.amount}))}),T=(0,u.A)(()=>{i()}),M=(0,n.Kr)(()=>{const e=y("lng_credits_summary_options_about").split("{link}");return[e[0],(0,N.Y)(p.A,{url:y("StarsTOSLink"),text:y("lng_credits_summary_options_about_link")}),e[1]]},[y]);return(0,N.Y)(h.A,{className:(0,s.A)(g.modalDialog),contentClassName:g.content,dialogRef:S,isSlim:!0,onClose:T,isOpen:C,hasAbsoluteCloseButton:!0,children:(0,N.FD)("div",{className:(0,s.A)(g.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;w(t<=150)},children:[(0,N.Y)("div",{className:(0,s.A)(g.header,B&&g.hiddenHeader),children:(0,N.Y)("h2",{className:g.starHeaderText,children:y(t?"GiftStarsTitle":"Star.List.GetStars")})}),(0,N.Y)("div",{className:g.headerInfo,children:t?(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:100,peer:t,className:g.avatar}),(0,N.Y)("img",{className:g.logoBackground,src:v,alt:"",draggable:!1})]}):(0,N.FD)(N.FK,{children:[(0,N.Y)("img",{className:g.logo,src:b,alt:"",draggable:!1}),(0,N.Y)("img",{className:g.logoBackground,src:v,alt:"",draggable:!1})]})}),(0,N.Y)("h2",{className:(0,s.A)(g.headerText,g.center),children:I?.isCompleted?t?(0,c.A)(y("Notification.StarsGift.SentYou",(0,l.Ad)(k.amount,k.currency,y.code)),["simple_markdown"]):(0,c.A)(y("StarsAcquiredInfo",k?.stars),["simple_markdown"]):y(t?"GiftStarsTitle":"Star.List.GetStars")}),(0,N.Y)("p",{className:g.description,children:t?(0,c.A)(y("ActionGiftStarsSubtitle",(0,r.F9)(y,t)),["simple_markdown"]):y("Stars.Purchase.GetStarsInfo")}),(0,N.FD)("div",{className:g.section,children:[(0,N.Y)(A.A,{options:I?.starsGiftOptions,onClick:P}),(0,N.Y)("div",{className:g.secondaryInfo,children:M})]})]})})}));var S=i(31481),C=i(90709),I=i(87894),y=i(79582),k=i(54960),Y=i(34642);const B=(0,n.ph)((0,a.EK)(e=>{const{chats:{listIds:t},currentUserId:i}=e;return{userIds:e.contactList?.userIds,activeListIds:t.active,archivedListIds:t.archived,currentUserId:i}})(({isOpen:e,currentUserId:t,activeListIds:i,archivedListIds:o,userIds:s})=>{const{closeStarsGiftingPickerModal:l,openStarsGiftModal:c}=(0,a.ko)(),d=(0,m.A)(),[f,p]=(0,n.J0)(""),h=(0,n.Kr)(()=>{const e=(0,a.mS)().users.byId,n=(0,I.Am)([...s||[],...i||[],...o||[]]),l=(0,r.PU)({ids:n,query:f,type:"user"});return(0,y.A)(l.filter(i=>{const n=e[i];return!(!n||n.isSupport||(0,C.tv)(n)||(0,C.PL)(n)||i===t||i===S.zv8)}))},[t,f,s,i,o]),A=(0,u.A)(e=>{e?.length&&(c({forUserId:e}),l())});return(0,N.Y)(Y.A,{className:"s3k01dTm",isOpen:e,onClose:l,title:d("GiftStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Continue"),onEnter:l,children:(0,N.Y)(k.A,{className:"cuI2eDIY",itemIds:h,filterValue:f,filterPlaceholder:d("Search"),onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,onSelectedIdChange:A})})}));var w=i(30708),D=i(31460),P=i(76023),T=i(37661),M=i(39351),F=i(18276),U=i(64493),R=i(46222),x=i(24680),L=i(41036),O=i(38777),K=i(86046),V=i(81949),E=i(9267);const q={root:"TtE8LQNJ",minimal:"nkV4JXHc",transition:"nXQS4E59",main:"JuWZY1ds",container:"mnhBs1uK",section:"lYkNd_gb",lastSection:"f749AI4g",sectionTitle:"FF8gm7MP",tos:"Vu6blJk9",hint:"Rs8WXoOz",topUpButton:"dc_DZoVF",tonBalanceContainer:"lorbW9II",tonBalance:"h2Fs3tOv",tonIconBalance:"Ut6GidJP",tonInUsd:"FdcdsB4l",tonIconLogo:"_hCjjyEv",description:"teXilLxe",header:"fnhXotO2",starHeaderText:"iUwego5s",botItem:"AhxcrKWn",hiddenHeader:"DZk6d6hF",noSeparator:"UwUaTrab",closeButton:"piD1PXHW",addStarsButton:"dqnGL2uh",addStarsIcon:"w9Db2eiK",balanceBlock:"Yk0OQBKC",balanceInfo:"p2dW9NOV",smallerText:"rUnPcfmE",balanceBottom:"F5BTkZ9G",modalBalance:"t8tMrx3y",starButton:"oOt4VBD2",paymentContent:"OReEUNTV",paymentImages:"oKorQYTC",paymentPhoto:"HGTrEtUF",avatarStar:"Wu10dXoa",paymentImageBackground:"os8jb_qv",paymentButton:"VzR5cibf",paymentButtonStar:"Uhg7yWxK",transactions:"Qvc0fTTH",subscriptions:"IX5BhCUF",tabs:"KZVEyKOX",disclaimer:"bpVifdwH",amountBadge:"BPM7LKwo",loadMore:"TKmZjMyd",loadMoreIcon:"buepwtN1"},H=(0,n.ph)(({balance:e,className:t,withAddButton:i})=>{const n=(0,M.A)(),{openStarsBalanceModal:r}=(0,a.ko)();return(0,N.Y)("div",{className:(0,s.A)(q.balanceBlock,t),children:(0,N.FD)("div",{className:q.balanceInfo,children:[(0,N.Y)("span",{className:q.smallerText,children:n("StarsBalance")}),(0,N.Y)("div",{className:q.balanceBottom,children:e?.currency===S.ykW?(0,N.FD)(N.FK,{children:[(0,N.Y)(F.A,{name:"toncoin"}),void 0!==e?(0,l.UL)(e.amount,e.currency):"…"]}):(0,N.FD)(N.FK,{children:[(0,N.Y)(E.A,{type:"gold",size:"middle"}),void 0!==e&&e.currency===S.OUy?(0,K.ZF)(n,e):"…",i&&(0,N.Y)(V.A,{className:q.addStarsButton,onClick:()=>r({}),children:(0,N.Y)(F.A,{className:q.addStarsIcon,name:"add"})})]})})]})})});var z=i(17663),W=i(14242),J=i(63527);const j={root:"ZXnbeQxP",info:"zLaaDX3c",status:"HbF2qTB2",statusPricing:"AveGvpdV",amount:"_CBiOQcv",title:"k9ZIv5Pd",description:"FlRlxMx2",subtitle:"YN2J8dw6",statusPeriod:"MRrP7Oew",statusEnded:"pRHwfr8m",preview:"t6Syyhzd",subscriptionStar:"ftlbevPm"},_=(0,n.ph)(({subscription:e})=>{const{openStarsSubscriptionModal:t}=(0,a.ko)(),{peerId:i,pricing:n,until:s,isCancelled:l,title:d,photo:p}=e,h=(0,m.A)(),A=(0,J.A)(function(e){return t=>(0,o.PVB)(t,e)}(i)),g=(0,u.A)(()=>{t({subscription:e})});if(!A)return;const b=s<Date.now()/1e3,v=(0,z.A)(1e3*s,h.code,!0,"long");return(0,N.FD)("div",{className:j.root,onClick:g,children:[(0,N.FD)("div",{className:j.preview,children:[(0,N.Y)(f.A,{size:"medium",peer:A}),(0,N.Y)(E.A,{className:j.subscriptionStar,type:"gold",size:"small"})]}),(0,N.FD)("div",{className:j.info,children:[(0,N.Y)("h3",{className:j.title,children:(0,c.A)((0,r.F9)(h,A)||"")}),d&&(0,N.FD)("p",{className:j.subtitle,children:[p&&(0,N.Y)(f.A,{webPhoto:p,size:"micro"}),(0,c.A)(d)]}),(0,N.Y)("p",{className:j.description,children:h(b?"StarsSubscriptionExpired":l?"StarsSubscriptionExpires":"StarsSubscriptionRenews",v)})]}),(0,N.Y)("div",{className:j.status,children:l||b?(0,N.Y)("div",{className:j.statusEnded,children:h(b?"StarsSubscriptionStatusExpired":"StarsSubscriptionStatusCancelled")}):(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{className:j.statusPricing,children:[(0,N.Y)(E.A,{className:j.star,type:"gold",size:"adaptive"}),(0,N.Y)("span",{className:j.amount,children:(0,W.Sm)(n.amount)})]}),(0,N.Y)("div",{className:j.statusPeriod,children:h("StarsParticipantSubscriptionPerMonth")})]})})]})});var Q=i(58968),X=i(66833);function $(e,t,i){if(i.paidMessages)return t("PaidMessageTransaction",{count:i.paidMessages},{withNodes:!0,pluralValue:i.paidMessages});if(i.isGiftResale)return Z(i.amount)?t("StarGiftSaleTransaction"):t("StarGiftPurchaseTransaction");if(i.isPostsSearch)return t("PostsSearchTransaction");if(i.isDropOriginalDetails)return t("DropOriginalDetailsTransaction");if(i.isPrepaidUpgrade)return t("GiftPrepaidUpgradeTransactionTitle");if(i.isStarGiftAuctionBid)return Z(i.amount)?t("StarGiftAuctionBidTransaction"):t("StarGiftAuctionBidRefundedTransaction");if(i.starRefCommision)return e("StarTransactionCommission",(0,W.l9)(i.starRefCommision));if(i.isGiftUpgrade)return e("Gift2TransactionUpgraded");if(i.extendedMedia)return e("StarMediaPurchase");if(i.subscriptionPeriod)return i.title||e("StarSubscriptionPurchase");if(i.isReaction)return e("StarsReactionsSent");if(i.giveawayPostId)return e("StarsGiveawayPrizeReceived");if(i.isMyGift)return e("StarsGiftSent");if(i.isGift)return i.amount.currency===S.ykW?t("TonGiftReceived"):e("StarsGiftReceived");if(i.starGift)return Z(i.amount)?e("Gift2TransactionSent"):e("Gift2ConvertedTitle");const n=i.peer&&(0,K.MA)(i)&&(0,K.Pc)(i)||void 0;return n?n.title||e(n.titleKey):i.title}function Z(e){return e.currency===S.OUy?e.amount?e.amount<0:e.nanos<0:e.amount<0}var ee=i(79577),te=i(40558),ie=i(62587),ne=i(27860);const ae={root:"jQkp75Gb",preview:"OYGSN3PF",count:"KX1yz2Jy",thumb:"EvinKr5k",noOutline:"KSAAsUDv",itemCount1:"GxDajfX_",itemCount2:"jXuZoxq8",itemCount3:"TPn3XGHJ",blurry:"hWZuxLS8",full:"w56QPFhl",fadeIn:"ds43W8Wq"};function re({boughtMedia:e,index:t,className:i}){const n=e.video||e.photo,a=(0,C.VO)(n,"pictogram"),r=(0,C.VD)(n),o=(0,ie.A)(a);return(0,N.FD)("div",{className:(0,s.A)(ae.thumb,void 0!==t&&`stars-transaction-media-${t}`,i),children:[r&&(0,N.Y)("img",{className:ae.blurry,src:r,alt:""}),o&&(0,N.Y)("img",{className:ae.full,src:o,alt:""})]})}const oe=(0,n.ph)(({media:e,className:t,isTransactionPreview:i,onClick:n})=>{const a=Math.min(e.length,i?2:3),r="mediaType"in e[0];return(0,N.FD)("div",{className:(0,s.A)(ae.root,ae[`itemCount${a}`],i&&ae.preview,t),dir:"rtl",onClick:n,children:[e.slice(0,a).reverse().map((e,t,n)=>{const a=n.length-t-1;return"mediaType"in e?(0,N.Y)(ne.A,{className:ae.thumb,isVisible:!0,width:e.width,height:e.height,thumbDataUri:e.thumbnail?.dataUri}):(0,N.Y)(re,{className:(0,s.A)(i&&a>0&&ae.noOutline),boughtMedia:e,index:a})}),r&&(0,N.FD)("div",{className:ae.count,children:[(0,N.Y)(F.A,{name:"stars-lock"}),e.length>1?e.length:""]})]})}),se={root:"aHAxv_Jg",info:"oyYrn3II",stars:"K5lc75ku",amount:"QLQPuLAr",title:"e0pK8CJ_",description:"xbERdDMQ",date:"l6CwQ0Ev",positive:"P_42_ZWR",negative:"TGjnLJfH",preview:"cnjGihOT",subscriptionStar:"z43YvnDX",uniqueGiftBackground:"eNvzMw2p",giftSticker:"U3dqmnM4"},le=(0,n.ph)(({transaction:e,className:t})=>{const{openStarsTransactionModal:i}=(0,a.ko)(),{date:l,amount:d,photo:p,peer:h,extendedMedia:A,subscriptionPeriod:g}=e,b=(0,M.A)(),v=(0,m.A)(),G="peer"===h.type?h.id:void 0,C=(0,J.A)(function(e){return t=>e?(0,o.PVB)(t,e):void 0}(G)),I=e.starGift,y="starGiftUnique"===I?.type,k=I&&(0,X.yQ)(I),Y=(0,n.Kr)(()=>{let t,i,n,a=$(v,b,e);if((0,K.MA)(e)){const i=(0,K.Pc)(e);a=i.title||v(i.titleKey),t=v(i.subtitleKey),n=i}else t=C&&(0,r.F9)(v,C),n=C||Q.lw;return(e.isGiftUpgrade||e.isDropOriginalDetails)&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isGiftResale&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isPostsSearch&&(a=$(v,b,e),t=void 0),e.photo&&(n=void 0),e.isRefund&&(i=v("StarsRefunded")),e.hasFailed&&(i=v("StarsFailed")),e.isPending&&(i=v("StarsPending")),{title:a,description:t,avatarPeer:n,status:i}},[v,b,C,e]),B=(0,n.Kr)(()=>{if(y){const{backdrop:e}=(0,X.uc)(I),t=[e.centerColor,e.edgeColor];return(0,N.FD)(N.FK,{children:[(0,N.Y)(te.A,{className:se.uniqueGiftBackground,backgroundColors:t}),(0,N.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1})]})}return k?(0,N.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1}):A?(0,N.Y)(oe,{media:A,isTransactionPreview:!0}):(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:"medium",webPhoto:p,peer:Y.avatarPeer}),Boolean(g)&&(0,N.Y)(E.A,{className:se.subscriptionStar,type:"gold",size:"small"})]})},[y,A,p,Y.avatarPeer,g,I,k]),w=(0,u.A)(()=>{i({transaction:e})}),D=Z(d)?se.negative:se.positive;return(0,N.FD)("div",{className:(0,s.A)(se.root,t),onClick:w,children:[(0,N.Y)("div",{className:se.preview,children:B}),(0,N.FD)("div",{className:se.info,children:[(0,N.Y)("h3",{className:se.title,children:Y.title}),Y.description&&(0,N.Y)("p",{className:se.description,children:(0,c.A)(Y.description)}),(0,N.FD)("p",{className:se.date,children:[(0,z.L2)(1e3*l,v.code,!0),Y.status&&` — (${Y.status})`]})]}),(0,N.FD)("div",{className:se.stars,children:[(0,N.Y)("span",{className:(0,s.A)(se.amount,D),children:(0,K.hk)(b,d)}),d.currency===S.OUy&&(0,N.Y)(E.A,{className:se.star,type:"gold",size:"adaptive"}),d.currency===S.ykW&&(0,N.Y)(F.A,{name:"toncoin",className:D})]})]})}),ce=3.5*P.$,de=["all","inbound","outbound"],ue=["StarsTransactionsAll","StarsTransactionsIncoming","StarsTransactionsOutgoing"],me="StarsTransactionItem",fe=(0,n.ph)((0,a.EK)((e,{modal:t})=>({shouldForceHeight:t?.currency===S.ykW?Boolean(e.ton?.history?.all?.transactions.length):Boolean(e.stars?.history?.all?.transactions.length),starsBalanceState:e.stars,tonBalanceState:e.ton,canBuyPremium:!(0,o.n_C)(e),tonUsdRate:e.appConfig.tonUsdRate,tonTopupUrl:e.appConfig.tonTopupUrl,animationLevel:(0,w.lS)(e).animationLevel}))(({modal:e,starsBalanceState:t,tonBalanceState:i,canBuyPremium:d,shouldForceHeight:f,tonUsdRate:g,tonTopupUrl:b,animationLevel:v})=>{const{closeStarsBalanceModal:G,loadStarsTransactions:I,loadStarsSubscriptions:y,openStarsGiftingPickerModal:k,openInvoice:Y,openUrl:B}=(0,a.ko)(),w=e?.currency||S.OUy,P=w===S.ykW?i:t,{balance:K,history:V}=P||{},{subscriptions:E}=w===S.OUy&&t||{},z=(0,m.A)(),W=(0,M.A)(),[J,j]=(0,n.J0)(!0),[Q,X,$]=(0,T.A)(!1),[Z,ee]=(0,n.J0)(0),[te,ie,ne]=(0,T.A)(),ae=(0,n.li)(),re=Boolean(e&&(t||i)),{originStarsPayment:oe,originReaction:se,originGift:fe,topup:pe}=e||{},he=oe||se||fe||pe,Ae=oe?.form?.invoice?.totalAmount||oe?.subscriptionInfo?.subscriptionPricing?.amount||se?.amount||fe?.gift.stars||pe?.balanceNeeded,ge=Ae?Ae-(K?.amount||0):void 0,be=(0,n.Kr)(()=>{const e=(0,a.mS)();if(se){const t=(0,o.hds)(e,se.chatId);if(!t)return;return z("StarsNeededTextReactions",(0,C.Js)(z,t))}if(oe){const t=oe.form?.botId?(0,o.mBe)(e,oe.form.botId):void 0;if(!t)return;return z("StarsNeededText",(0,C.Yg)(t))}if(fe){const t=(0,o.mBe)(e,fe.peerId);if(!t)return;return z("StarsNeededTextGift",(0,r.F9)(W,t))}return"subs"===pe?.purpose?z("StarsNeededTextLink"):pe?.purpose===S.D3m?W("StarsNeededTextSendPaidMessages",void 0,{withMarkdown:!0,withNodes:!0}):void 0},[se,oe,fe,pe?.purpose,W,z]),ve=Boolean(V?.all?.transactions.length&&!he),Ne=!he,Ge=(0,n.Kr)(()=>{const e=V?.all?.transactions.length||0;return 1===e?"35.5rem":2===e?"39.25rem":3===e?"43rem":"45rem"},[V?.all?.transactions.length]),Se=(0,n.Kr)(()=>ue.map(e=>({title:W(e)})),[W]);(0,n.vJ)(()=>{re||(j(!0),ee(0),ne(),$())},[re]),(0,n.vJ)(()=>{he?ie():ne()},[he]);const Ce=(0,n.Kr)(()=>{if(!re)return;const e=z("lng_credits_summary_options_about").split("{link}");return[e[0],(0,N.Y)(p.A,{url:z("StarsTOSLink"),text:z("lng_credits_summary_options_about_link")}),e[1]]},[re,z]),Ie=(0,u.A)(()=>{I({type:de[Z],isTon:w===S.ykW})}),ye=(0,u.A)(()=>{y()}),ke=(0,u.A)(()=>{k({})}),Ye=(0,u.A)(e=>{const t=oe?.inputInvoice;let i;switch(t?.type){case"message":i=t.chatId;break;case"slug":{const e=oe?.form;i=e?.botId;break}}se&&(i=se.chatId),Y({type:"stars",stars:e.stars,currency:e.currency,amount:e.amount,spendPurposePeerId:i})}),Be=(0,u.A)(()=>{B({url:b})});return(0,N.Y)(h.A,{className:(0,s.A)(q.root,!f&&!te&&q.minimal),isOpen:re,onClose:G,dialogStyle:`--modal-height: ${Ge}`,hasAbsoluteCloseButton:!0,children:(0,N.FD)("div",{className:(0,s.A)(q.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;if(j(t<=150),ae.current){const{top:t}=ae.current.getBoundingClientRect(),{top:i}=e.currentTarget.getBoundingClientRect();t-i<=ce?X():$()}},children:[w!==S.ykW&&(0,N.Y)(H,{balance:K,className:q.modalBalance}),(0,N.Y)("div",{className:(0,s.A)(q.header,J&&q.hiddenHeader,Q&&q.noSeparator),children:(0,N.Y)("h2",{className:q.starHeaderText,children:z("TelegramStars")})}),(0,N.Y)("div",{className:q.section,children:w===S.ykW?(()=>{const e=(0,l.UL)(K?.amount||0,S.ykW);return(0,N.FD)(N.FK,{children:[(0,N.Y)(O.A,{model:"speeding-diamond",color:"blue",title:W("CurrencyTon"),description:W("DescriptionAboutTon"),isDisabled:!re}),(0,N.FD)("div",{className:q.tonBalanceContainer,children:[(0,N.FD)("div",{className:q.tonBalance,children:[(0,N.Y)(F.A,{name:"toncoin",className:q.tonIconBalance}),e]}),Boolean(g)&&(0,N.Y)("span",{className:q.tonInUsd,children:`≈ ${(0,l.Ad)((0,l.C)(K?.amount||0,g,!0),"USD",W.code)}`})]}),(0,N.Y)(U.A,{className:q.topUpButton,onClick:Be,fluid:!0,children:W("ButtonTopUpViaFragment")}),w===S.ykW&&(0,N.Y)("div",{className:q.hint,children:W("TonModalHint")})]})})():(0,N.FD)(N.FK,{children:[(0,N.Y)(O.A,{model:"swaying-star",color:"gold",title:ge?z("StarsNeededTitle",Ae):z("TelegramStars"),description:(0,c.A)(be||z("TelegramStarsInfo"),["simple_markdown","emoji"]),isDisabled:!re}),d&&!te&&(0,N.Y)(U.A,{className:q.starButton,onClick:ie,fluid:!0,children:z("Star.List.BuyMoreStars")}),d&&!te&&Ne&&(0,N.Y)(U.A,{isText:!0,noForcedUpperCase:!0,className:q.starButton,fluid:!0,onClick:ke,children:z("TelegramStarsGift")}),te&&t?.topupOptions&&(0,N.Y)(A.A,{starsNeeded:ge,options:t.topupOptions,onClick:Ye})]})}),te&&(0,N.Y)("div",{className:q.tos,children:Ce}),ve&&Boolean(E?.list.length)&&(0,N.FD)("div",{className:q.section,children:[(0,N.Y)("h3",{className:q.sectionTitle,children:z("StarMySubscriptions")}),(0,N.FD)("div",{className:q.subscriptions,children:[E?.list.map(e=>(0,N.Y)(_,{subscription:e},e.id)),E?.nextOffset&&(0,N.FD)(U.A,{isText:!0,disabled:E.isLoading,size:"smaller",noForcedUpperCase:!0,className:q.loadMore,onClick:ye,children:[(0,N.Y)(F.A,{name:"down",className:q.loadMoreIcon}),z("StarMySubscriptionsExpand")]})]})]}),ve&&(0,N.FD)("div",{className:q.container,children:[(0,N.Y)("div",{className:q.lastSection,children:(0,N.Y)(L.Ay,{name:(0,D.P)("slideOptimized",v,void 0,W.isRtl),activeKey:Z,renderCount:ue.length,shouldRestoreHeight:!0,className:q.transition,children:(0,N.Y)(R.A,{onLoadMore:Ie,items:V?.[de[Z]]?.transactions,scrollContainerClosest:`.${q.main}`,itemSelector:`.${me}`,className:q.transactions,noFastList:!0,noScrollRestoreOnTop:!0,children:V?.[de[Z]]?.transactions.map(e=>(0,N.Y)(le,{transaction:e,className:me},`${e.id}-${e.isRefund}`))})})}),(0,N.Y)(x.A,{ref:ae,className:q.tabs,tabClassName:q.tab,activeTab:Z,tabs:Se,onSwitchTab:ee})]})]})})}));var pe=i(48775),he=i(29886),Ae=i(84991),ge=i(10187);const be=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const i=t?.form?.botId?(0,o.mBe)(e,t.form.botId):void 0,n="message"===t?.inputInvoice?.type?t.inputInvoice:void 0,a=n?(0,o.O5q)(e,n.chatId,n.messageId):void 0,r=n?(0,o.hds)(e,n.chatId):void 0,s=a?.content.paidMedia;return{bot:i,starsBalanceState:e.stars,paidMediaMessage:s?a:void 0,paidMediaChat:s?r:void 0}})(({modal:e,bot:t,starsBalanceState:i,paidMediaMessage:r,paidMediaChat:o})=>{const{closeStarsPaymentModal:l,openStarsBalanceModal:d,sendStarPaymentForm:A}=(0,a.ko)(),[g,b,G]=(0,T.A)(),S=Boolean(e?.inputInvoice&&i),I=(0,he.A)(e),y=e||I,{form:k,subscriptionInfo:Y}=y||{},B=k?.invoice?.totalAmount||Y?.subscriptionPricing?.amount,w=Boolean(k?.invoice.subscriptionPeriod),D=!Y?.subscriptionPricing,P=k?.photo,F=(0,m.A)(),R=(0,M.A)();(0,n.vJ)(()=>{S||G()},[S]);const x=(0,n.Kr)(()=>{if(!y?.inputInvoice)return"";const e=(0,C.Yg)(t),i=F("Stars.Intro.PurchasedText.Stars",B);if(r){const e=r.content.paidMedia.extendedMedia,t=e.every(e=>!e.duration),n=e.every(e=>Boolean(e.duration)),a=F(t?"Stars.Transfer.Photos":n?"Stars.Transfer.Videos":"Media",e.length),s=(0,C.Js)(F,o);return F("Stars.Transfer.UnlockInfo",[a,s,i])}return Y?R("StarsSubscribeText",{chat:Y.title,amount:B},{withNodes:!0,withMarkdown:!0,pluralValue:B}):w?R("StarsSubscribeBotText",{name:k.title,amount:B,bot:e},{pluralValue:B}):F("Stars.Transfer.Info",[k.title,e,i])},[y?.inputInvoice,t,F,B,r,Y,w,k,o,R]),L=(0,n.Kr)(()=>{if(Y)return R("StarsSubscribeInfo",{link:(0,N.Y)(p.A,{url:R("StarsSubscribeInfoLink"),text:R("StarsSubscribeInfoLinkText")})},{withNodes:!0})},[Y,R]),O=(0,n.Kr)(()=>{if(Y)return(0,C.nr)(Y)},[Y]),K=(0,u.A)(()=>{const t=i?.balance;void 0!==B&&void 0!==t&&(B>t.amount?d({originStarsPayment:e}):(A({}),b()))});return(0,N.FD)(h.A,{contentClassName:q.paymentContent,isOpen:S,hasAbsoluteCloseButton:!0,isSlim:!0,onClose:l,children:[(0,N.Y)(H,{balance:i?.balance,className:q.modalBalance}),(0,N.FD)("div",{className:q.paymentImages,dir:R.isRtl?"ltr":"rtl",children:[r?(0,N.Y)(oe,{media:r.content.paidMedia.extendedMedia}):O?(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{className:q.paymentPhoto,peer:O,size:"giant"}),(0,N.Y)(E.A,{type:"gold",size:"adaptive",className:q.avatarStar})]}):(0,N.Y)(Ae.A,{peer:P?void 0:t,avatarWebPhoto:P,avatarSize:"giant",badgeIcon:"star",badgeText:(0,W.Sm)(B),badgeClassName:q.amountBadge,className:q.paymentPhoto}),(0,N.Y)("img",{className:q.paymentImageBackground,src:v,alt:"",draggable:!1})]}),(0,N.Y)("h2",{className:q.headerText,children:F(O?"StarsSubscribeTitle":"StarsConfirmPurchaseTitle")}),D&&(0,N.Y)(ge.A,{className:q.botItem,peerId:k?.botId}),(0,N.Y)("div",{className:q.description,children:(0,c.A)(x,["simple_markdown","emoji"])}),(0,N.Y)(U.A,{className:q.paymentButton,onClick:K,isLoading:g,children:R(w?"StarsSubscribeBotButtonMonth":"StarsPay",{amount:(0,pe.U2)(R,B,{asFont:!0})},{withNodes:!0})}),Boolean(L)&&(0,N.Y)("div",{className:(0,s.A)(q.disclaimer,q.smallerText),children:L})]})}));var ve=i(89925),Ne=i(85982),Ge=i(97040),Se=i(70046),Ce=i(96454),Ie=i(95807),ye=i(537),ke=i(43874),Ye=i(80140);const Be="biAUzmLA",we="hsDNs5hG",De="APNjRx1K",Pe=(0,n.ph)((0,a.EK)(e=>{const{currentUserId:t}=e,i=t?(0,o.mBe)(e,t):void 0,n=i?.emojiStatus,a=e.collectibleEmojiStatuses?.statuses;return{currentUserEmojiStatus:n,collectibleEmojiStatuses:a}})(({savedGift:e,currentUserEmojiStatus:t,collectibleEmojiStatuses:i})=>{const{openGiftTransferModal:r,openGiftResalePriceComposerModal:s,openGiftStatusInfoModal:l,setEmojiStatus:c,updateStarGiftPrice:d,showNotification:f,closeGiftInfoModal:p}=(0,a.ko)(),h=(0,M.A)(),A=(0,m.A)(),g=e?.gift,b="starGiftUnique"===g?.type?g.resellPrice:void 0,v=(0,a.mS)(),G=(0,o.nTw)(v).giftInfoModal,C=G?.peerId,I="starGiftUnique"===g?.type?g.slug:void 0,y=(0,n.Kr)(()=>{if(I)return i?.find(e=>"collectible"===e.type&&e.slug===I)},[I,i]),k="collectible"===t?.type?t.slug:void 0,Y=void 0!==I&&k===I,B=Boolean(y)&&!Y,w=(0,u.A)(()=>{e&&"starGiftUnique"===e?.gift.type&&(e.canTransferAt&&e.canTransferAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,z.U)(A,1e3*e.canTransferAt)}}}):r({gift:e}))}),D=(0,u.A)(()=>{Y?c({emojiStatus:{type:"regular",documentId:S.zNY}}):y&&l({emojiStatus:y})}),P=(0,u.A)(()=>{e&&C&&(e.canResellAt&&e.canResellAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,z.U)(A,1e3*e.canResellAt)}}}):s({peerId:C,gift:e}))}),T=(0,u.A)(()=>{e&&"starGiftUnique"===e.gift.type&&e.inputGift&&(p(),d({gift:e.inputGift,price:{currency:S.OUy,amount:0,nanos:0}}),f({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:h("GiftUnique",{title:e.gift.title,number:e.gift.number})}}}))});return(0,N.FD)("div",{className:"feHNN0j8",children:[(0,N.Y)(U.A,{color:"transparentBlured",iconName:"gift-transfer-inline",iconAlignment:"top",iconClassName:De,onClick:w,ariaLabel:h("GiftInfoTransfer"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:we,children:h("GiftInfoTransfer")})}),(B||!Y)&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:Y?"crown-take-off":"crown-wear",iconAlignment:"top",iconClassName:De,onClick:B||Y?D:void 0,disabled:!B&&!Y,ariaLabel:h(Y?"GiftInfoTakeOff":"GiftInfoWear"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:we,children:h(Y?"GiftInfoTakeOff":"GiftInfoWear")})}),!b&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:"sell",iconAlignment:"top",iconClassName:De,onClick:P,ariaLabel:h("Sell"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:we,children:h("Sell")})}),Boolean(b)&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:"unlist",iconAlignment:"top",iconClassName:De,onClick:T,ariaLabel:h("GiftInfoUnlist"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:we,children:h("GiftInfoUnlist")})})]})})),Te={root:"irv1C8bo",withManageButtons:"QcTw5OSp",sticker:"a1ASgPwu",withBadge:"OFWOLtAH",subtitleBadge:"V7kDVPLm",badge:"PAmbIL6y",radialPattern:"UvhsGZLf",amount:"zTVWZg63",transition:"Tu6_OHoq",transitionSlide:"iUTKLzTN",title:"ECTvfOda",subtitle:"S6JwvHWD"},Me=(0,n.ph)(({modelAttribute:e,backdropAttribute:t,patternAttribute:i,title:r,badge:o,subtitle:l,subtitlePeer:c,className:d,resellPrice:u,showManageButtons:m,savedGift:f})=>{const{openChat:p}=(0,a.ko)(),{isMobile:h}=(0,ke.Ay)(),A=(0,M.A)(),[g,b,v]=(0,T.A)(!1),G=(0,ye.A)([e,t,i]),S=t?.textColor,C=(0,n.Kr)(()=>{const e=[t.centerColor,t.edgeColor];return(0,N.Y)(te.A,{className:Te.radialPattern,canvasClassName:Te.radialPatternCanvas,backgroundColors:e,patternIcon:i.sticker,yPosition:7.5*P.$,maxRadius:.26,patternSize:h?14:16,ovalFactor:1.2})},[t,i,h]);return(0,N.FD)("div",{className:(0,s.A)(Te.root,"interactive-gift",m&&Te.withManageButtons,o&&Te.withBadge,d),children:[(0,N.FD)(L.Ay,{className:Te.transition,slideClassName:(0,s.A)(Te.transitionSlide),activeKey:G,direction:1,name:"zoomBounceSemiFade",children:[C,(0,N.Y)(ee.A,{className:Te.sticker,sticker:e.sticker,size:120,noLoop:!g,onMouseEnter:Ce.TF?void 0:b,onMouseLeave:Ce.TF?void 0:v})]}),Boolean(o)&&(0,N.Y)("div",{className:Te.badge,children:o}),r&&(0,N.Y)("h1",{className:Te.title,children:r}),Boolean(l)&&(0,N.Y)("div",{className:(0,s.A)(Te.subtitle,c&&Te.subtitleBadge),style:(0,Ie.A)(S&&`color: ${S}`),onClick:()=>{c&&p({id:c.id})},children:l}),f&&m&&(0,N.Y)(Pe,{savedGift:f}),u&&(0,N.FD)("p",{className:Te.amount,children:[(0,N.Y)("span",{children:(0,K.hk)(A,u)}),"XTR"===u.currency&&(0,N.Y)(E.A,{type:"gold",size:"middle"}),"TON"===u.currency&&(0,N.Y)(F.A,{name:"toncoin"})]})]})}),Fe="qBOIq6Jn",Ue="sso9uZM6",Re="NuWOY7ED",xe=[0,-50],Le=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const i="peer"===t?.transaction?.peer?.type&&t.transaction.peer.id,n=i?(0,o.PVB)(e,i):void 0,a=e.appConfig.starsPaidMessageCommissionPermille,r=t?.transaction.amount,s=t?.transaction.isGift?r?.currency===S.OUy?(0,o.WLj)(e,r?.amount):(0,o.OD9)(e,r?.amount):void 0;return{peer:n,canPlayAnimatedEmojis:(0,o.BWX)(e),topSticker:s,paidMessageCommission:a}})(({modal:e,peer:t,canPlayAnimatedEmojis:i,topSticker:r,paidMessageCommission:o})=>{const{showNotification:l,openMediaViewer:c,closeStarsTransactionModal:d}=(0,a.ko)(),h=(0,M.A)(),A=(0,m.A)(),{transaction:g}=e||{},b=(0,n.li)(),v=(0,u.A)(()=>{const e=g?.extendedMedia;e&&c({origin:ve.TQ.StarsTransaction,standaloneMedia:e.flatMap(e=>Object.values(e))})}),G=(0,u.A)(()=>{b.current?.()}),I=(0,u.A)(e=>{b.current=e}),y=(0,n.Kr)(()=>{if(!g)return;const{giveawayPostId:e,photo:n,amount:a,isGiftUpgrade:c,isDropOriginalDetails:d,starGift:u,isGiftResale:m,starRefCommision:b}=g,y=g?.starGift,k="starGiftUnique"===y?.type,Y=g?.starGift?(0,X.yQ)(g.starGift):r,B=k?(0,X.uc)(y):void 0,w=g.peer&&(0,K.MA)(g)&&(0,K.Pc)(g)||void 0,D="peer"===g.peer?.type?g.peer.id:void 0,P=g.peer&&A(function(e){switch(e.type){case"appStore":return"AppStore";case"playMarket":return"PlayMarket";case"fragment":return"Fragment";case"premiumBot":return"StarsTransactionBot";case"ads":return"StarsTransactionAds";case"api":return"Stars.Intro.Transaction.TelegramBotApi.Subtitle";default:return"Stars.Transaction.Unsupported.Title"}}(g.peer)),T=$(A,h,g),M=t&&g.messageId&&!c&&!d?(0,C.yt)(t,void 0,g.messageId):void 0,U=t&&e?(0,C.yt)(t,void 0,e):void 0,R=g.extendedMedia,x=R?.length||0,L=R?.every(e=>!e.video),O=R?.every(e=>!e.photo),V=A(L?"Stars.Transfer.Photos":O?"Stars.Transfer.Videos":"Media",x),q=g.description||((c||d)&&"starGiftUnique"===u?.type?u.title:void 0)||(R?V:void 0),H=!R&&!Y&&!g.isPostsSearch,J=n?void 0:!(0,K.MA)(g)&&t||w,j=k&&(0,N.Y)("div",{className:(0,s.A)(Fe,"ApoQz22o"),children:(0,N.Y)(Me,{backdropAttribute:B.backdrop,patternAttribute:B.pattern,modelAttribute:B.model,title:y.title,subtitle:h("GiftInfoCollectible",{number:y.number}),resellPrice:g.amount})}),_=Z(a)?"xDyq9cc0":"jvBZSrpd",Q=(0,N.FD)("div",{className:Fe,children:[R&&(0,N.Y)(oe,{className:(0,s.A)("C5r59yiV","transaction-media-preview"),media:R,onClick:v}),!R&&Y&&(0,N.Y)(ee.A,{sticker:Y,play:i,noLoop:!0},g.id),H&&(0,N.Y)(f.A,{className:"hcrszlpT",peer:J,webPhoto:n,size:"giant",onMouseMove:G}),!Y&&!g.isPostsSearch&&(0,N.Y)(Ge.A,{className:(0,s.A)("nML8IQqX"),color:"gold",onRequestAnimation:I,centerShift:xe}),Boolean(T)&&(0,N.Y)("h1",{className:"ZZAj3hj7",children:T}),(0,N.Y)("p",{className:Re,children:q}),(0,N.FD)("p",{className:Ue,children:[(0,N.Y)("span",{className:(0,s.A)(Ue,_),children:(0,K.hk)(h,a)}),a.currency===S.OUy&&(0,N.Y)(E.A,{type:"gold",size:"middle"}),"TON"===a.currency&&(0,N.Y)(F.A,{name:"toncoin",className:_}),g.isRefund&&(0,N.Y)("p",{className:"sxWAwxTd",children:h("Refunded")})]}),Boolean(g.paidMessages&&g.starRefCommision&&o)&&(0,N.Y)("p",{className:Re,children:h("PaidMessageTransactionDescription",{percent:(0,W.l9)(o/10)},{withNodes:!0,withMarkdown:!0})})]}),te=[];let ie;g&&b&&!g.paidMessages&&!m&&te.push([A("StarsTransaction.StarRefReason.Title"),A("StarsTransaction.StarRefReason.Program")]),c&&te.push([A("StarGiftReason"),A("StarGiftReasonUpgrade")]),d&&te.push([A("StarGiftReason"),h("StarGiftReasonDropOriginalDetails")]),m&&te.push([A("StarGiftReason"),Z(g.amount)?h("StarGiftSaleTransaction"):h("StarGiftPurchaseTransaction")]),ie=c?A("Stars.Transaction.GiftFrom"):Z(a)||g.isMyGift?A("Stars.Transaction.To"):!g.starRefCommision||g.paidMessages||m?A(D?"Star.Transaction.From":"Stars.Transaction.Via"):A("StarsTransaction.StarRefReason.Miniapp"),g.isPostsSearch||d||g.isStarGiftAuctionBid||te.push([ie,D?{chatId:D}:P||""]),g.starRefCommision&&g.paidMessages&&te.push([h("PaidMessageTransactionTotal"),(0,pe.U2)(h,g.amount.amount/((100-g.starRefCommision)/100),{asFont:!1,className:"cU5QlvwL",containerClassName:"Z2YALGgl"})]),M&&te.push([A("Stars.Transaction.Reaction.Post"),(0,N.Y)(p.A,{url:M,text:M})]),U&&g.amount.currency===S.OUy&&(te.push([A("BoostReason"),(0,N.Y)(p.A,{url:U,text:A("Giveaway")})]),te.push([A("Gift"),A("Stars",g.amount,"i")])),g.id&&te.push([A("Stars.Transaction.Id"),(0,N.FD)(N.FK,{children:[(0,N.Y)("div",{className:"tMF8VIOM",onClick:()=>{(0,Ne.eM)(g.id),l({message:A("StarsTransactionIDCopied")})},children:g.id}),(0,N.Y)(F.A,{className:"voCttFzS",name:"copy"})]})]),te.push([A("Stars.Transaction.Date"),(0,z.L2)(1e3*g.date,A.code,!0)]),g.isStarGiftAuctionBid&&"starGift"===y?.type&&y.availabilityTotal&&te.push([h("GiftInfoAvailability"),h("GiftInfoAvailabilityValue",{count:y.availabilityRemains||0,total:y.availabilityTotal},{pluralValue:y.availabilityRemains||0})]);const ne=A("lng_credits_box_out_about").split("{link}");return{header:k?j:Q,tableData:te,footer:(0,N.FD)("span",{className:"KgzPpgS6",children:[ne[0],(0,N.Y)(p.A,{url:A("StarsTOSLink"),text:A("lng_credits_summary_options_about_link")}),ne[1]]})}},[g,A,h,t,i,r,o,I]),k=(0,he.A)(y)||y;return(0,N.Y)(Se.A,{isOpen:Boolean(g),className:"IzhfRIWu",hasBackdrop:"starGiftUnique"===g?.starGift?.type,header:k?.header,tableData:k?.tableData,footer:k?.footer,buttonText:A("OK"),onClose:d})})),Oe="oBLHWBtJ",Ke=[0,-50],Ve=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const i=t?.subscription.peerId;return{peer:i?(0,o.PVB)(e,i):void 0}})(({modal:e,peer:t})=>{const{closeStarsSubscriptionModal:i,fulfillStarsSubscription:o,changeStarsSubscription:l,checkChatInvite:c,loadStarStatus:d,openInvoice:h}=(0,a.ko)(),A=(0,m.A)(),g=(0,M.A)(),{subscription:b}=e||{},v=(0,n.li)(),G=(0,u.A)(()=>{v.current?.()}),C=(0,u.A)(e=>{v.current=e}),I=(0,n.Kr)(()=>{if(!b)return"hidden";if(b.canRefulfill)return"refulfill";const e=b.until>Date.now()/1e3;if(e&&!b.isCancelled)return"cancel";if(e&&b.isCancelled)return"renew";const t=b.chatInviteHash||b.invoiceSlug;return!e&&t?"restart":"ok"},[b]),y=(0,u.A)(()=>{if(b){switch(I){case"refulfill":o({id:b.id});break;case"restart":b.chatInviteHash?c({hash:b.chatInviteHash}):b.invoiceSlug&&h({type:"slug",slug:b.invoiceSlug}),d();break;case"renew":l({id:b.id,isCancelled:!1});break;case"cancel":l({id:b.id,isCancelled:!0})}i()}}),k=(0,n.Kr)(()=>{if(!b||!t)return;const{pricing:e,until:i,isCancelled:n,canRefulfill:a,photo:o,title:l,hasBotCancelled:c}=b,d=(0,r.mO)(t),u=(0,N.FD)("div",{className:"E3R22yAI",children:[(0,N.FD)("div",{className:"wuTMXDP9",children:[(0,N.Y)(f.A,{peer:o?void 0:t,webPhoto:o,size:"giant",onMouseMove:G}),(0,N.Y)(E.A,{className:"enRetSny",type:"gold",size:"adaptive"})]}),(0,N.Y)(Ge.A,{className:(0,s.A)("zGCayu45"),color:"gold",onRequestAnimation:C,centerShift:Ke}),(0,N.Y)("h1",{className:"qdydQHgc",children:l||A("StarsSubscriptionTitle")}),(0,N.Y)("p",{className:"FI6rEJlK",children:g("StarsPerMonth",{amount:e.amount},{withNodes:!0,specialReplacement:{[S.Cyx]:(0,N.Y)(E.A,{className:"J8HIcN6k",size:"adaptive",type:"gold"})}})})]}),m=[];m.push([A(d?"StarsSubscriptionBot":"StarsSubscriptionChannel"),{chatId:t.id}]),l&&m.push([A("StarsSubscriptionBotProduct"),l]);const h=i<Date.now()/1e3;m.push([A(h?"StarsSubscriptionUntilExpired":n?"StarsSubscriptionUntilExpires":"StarsSubscriptionUntilRenews"),(0,z.L2)(1e3*i,A.code,!0)]);const v=g("StarsTransactionTOS",{link:(0,N.Y)(p.A,{url:g("StarsTransactionTOSLink"),text:g("StarsTransactionTOSLinkText")})},{withNodes:!0});return{header:u,tableData:m,footer:(0,N.FD)("span",{className:"GMWMuWCr",children:[(0,N.Y)("p",{className:Oe,children:v}),n&&(0,N.Y)("p",{className:"nkwiG25Q",children:A(c?"StarsSubscriptionBotCancelledText":"StarsSubscriptionCancelledText")}),a&&(0,N.Y)("p",{className:Oe,children:A("StarsSubscriptionRefulfillInfo",(0,z.L2)(1e3*i,A.code,!0))}),!n&&!a&&h&&(0,N.Y)("p",{className:Oe,children:A("StarsSubscriptionExpiredInfo",(0,z.L2)(1e3*i,A.code,!0))}),!n&&!a&&!h&&(0,N.Y)("p",{className:Oe,children:A("StarsSubscriptionCancelInfo",(0,z.L2)(1e3*i,A.code,!0))}),"hidden"!==I&&(0,N.Y)(U.A,{color:"cancel"===I?"danger":"primary",isText:"cancel"===I,onClick:y,children:A("cancel"===I?"StarsSubscriptionCancel":"refulfill"===I?"StarsSubscriptionRefulfill":"restart"===I?"StarsSubscriptionAgain":"renew"===I?"StarsSubscriptionRenew":"OK")})]})}},[I,g,A,t,b]),Y=(0,he.A)(k)||k;return(0,N.Y)(Se.A,{isOpen:Boolean(b),className:"eR_RZfGB",header:Y?.header,tableData:Y?.tableData,footer:Y?.footer,onClose:i})}));var Ee=i(34431),qe=i(19806),He=i(22699),ze=i(24433),We=i(32581),Je=i(93545),je=i(68292),_e=i(85118);const Qe={root:"CuBAw2yg",dragging:"LbDNXOOQ",progress:"kwK0cNPX",floatingBadgeWrapper:"uvlMoXj0",floatingBadgeText:"qqQan8uF",floatingBadgeTriangle:"mIdJOmsB",slider:"euOOAbZi",sparkles:"_L1YQTIP",dynamicColor:"uIYIwZpx",floatingBadge:"BGSDWAYc",clickable:"JwkM7nwU",noTransition:"cG6CiHRL",floatingBadgeSparkles:"JCciTRtu",floatingBadgeContent:"f1UPSN27",withDescription:"WsptdVHe",floatingBadgeTitle:"HkY6dR8D",floatingBadgeDescription:"mR3ddE5s",floatingBadgeTrianglePath:"IW9YhMAx",customValueIcon:"Td8Tc1MH"},Xe=[50,100,500,1e3,2e3,5e3,1e4],$e=1e4,Ze=1.875*P.$,et=2*P.$,tt=1.5*P.$,it=.125*P.$;let nt;const at=["#955CDB","#955CDB","#46A3EB","#40A920","#E29A09","#ED771E","#E14741","#5B6676"];function rt(e,t){const i=[];for(let n=0;n<Xe.length;n++)if(!(Xe[n]<=e)&&(Xe[n]<t&&i.push(Xe[n]),Xe[n]>=t))return i.push(t),i;const n=Xe[Xe.length-1],a=Math.ceil((e-n)/$e);let r=n+Math.max(1,a)*$e;for(;r<t;)i.push(r),r+=$e;return i.push(t),i}function ot(e,t,i){const n=e.findIndex(e=>t<=e),a=e[n-1]||i,r=e[n]||e[e.length-1];return r===a?n:n+(t-a)/(r-a)}function st(e,t,i){const n=Math.floor(t),a=e[n-1]||i,r=a+((e[n]||e[e.length-1])-a)*(t-n);return Math.round(r)}const lt=(0,n.ph)(({maxValue:e,defaultValue:t,minValue:i,minAllowedValue:a,minAllowedProgress:r,className:o,floatingBadgeDescription:l,shouldUseDynamicColor:c,shouldAllowCustomValue:d,onChange:m,onBadgeClick:f,onCustomValueClick:p})=>{const h=(0,n.li)(),A=(0,n.li)(),g=(0,M.A)(),b=i??1,v=(0,n.Kr)(()=>{if(!r||!a||a<=b)return b;let t=b,i=a;for(;t<i;){const n=Math.floor((t+i)/2),o=rt(n,e);ot(o,a,n)/o.length<r?i=n:t=n+1}return Math.max(b,t)},[b,a,r,e]),G=(0,n.Kr)(()=>rt(v,e),[e,v]),[S,C]=(0,n.J0)(0),[I,y]=(0,n.J0)(0),[k,Y]=(0,n.J0)(0),[B,w]=(0,n.J0)(!1),D=(0,n.li)(),T=(0,he.A)(k),U=g.number(st(G,S,v)),R=void 0!==a?ot(G,a,v):0;(0,n.vJ)(()=>{C(ot(G,t,v))},[t,G,v]),(0,n.vJ)(()=>{if(!A.current)return;const e=A.current.querySelector(`.${Qe.floatingBadgeTitle}`);if(!e)return;const t=getComputedStyle(e),i=`${t.fontWeight} ${t.fontSize} ${t.fontFamily}`,n=function(e,t){nt||(nt=document.createElement("canvas"));const i=nt.getContext("2d");return i.font=t,i.measureText(e).width}(U,i),a=tt+it+n,r=A.current.querySelector(`.${Qe.floatingBadgeDescription}`),o=r?.scrollWidth||0,s=Math.max(a,o)+et;Y(e=>Math.abs(s-e)<6?e:s)},[U,l]);const x=(0,u.A)(e=>{y(e.contentRect.width)});(0,Je.A)(h,x);const L=S/G.length,{minBadgeX:O,maxBadgeX:K,beakOffset:V,beakTipOffset:E,beakWidth:q}=(0,n.Kr)(()=>function(e,t,i){const n=t/2,a=n-22,r=e-Ze,o=i*r,s=r-o,l=o<s,c=l?o:s,d=l?-1:1;let u=0,m=0,f=52;const p=n-Ze/2;if(c<p)if(c>10)u=d*((p-c)/(p-10))*a;else if(c>0){u=d*a;const e=(10-c)/10;f=52-8*(1-(1-e)*(1-e)*(1-e)),m=d*e*(f/2)}else u=d*a,f=44,m=d*(f/2);const h=f/2-2-1;return{minBadgeX:n,maxBadgeX:e-n,beakOffset:u,beakTipOffset:Math.max(-h,Math.min(h,m)),beakWidth:f}}(I,k,L),[I,k,L]),H=(0,n.Kr)(()=>function(e,t){const i=e/2+t;return`M 0 0 L ${e} 0 L ${i+2} 30 Q ${i} 32 ${i-2} 30 Z`}(q,E),[q,E]),z=(0,u.A)(e=>{const t=Number(e.currentTarget.value),i=Math.max(t,R);C(i);const n=st(G,i,v);m(n)}),W=(0,u.A)(e=>{D.current=e.clientX,w(!1)}),J=(0,u.A)(e=>{void 0!==D.current&&Math.abs(e.clientX-D.current)>=5&&w(!0)}),j=(0,u.A)(e=>{if(D.current=void 0,!B&&p&&h.current){const t=h.current.getBoundingClientRect(),i=1.875*P.$;e.clientX>=t.right-i&&e.clientX<=t.right&&p()}w(!1)}),_=c?function(e){const t=Math.floor(e*at.length);return at[Math.min(t,at.length-1)]}(L):void 0,Q=(0,Ie.A)(Boolean(k)&&`width: ${k}px`),X=(0,Ie.A)(`--progress: ${L}`,`--min-badge-x: ${O}px`,`--max-badge-x: ${K}px`,_&&`--dynamic-color: ${_}`);return(0,N.FD)("div",{ref:h,className:(0,s.A)(Qe.root,B&&Qe.dragging,o),style:X,children:[(0,N.Y)("div",{className:Qe.floatingBadgeWrapper,children:(0,N.FD)("div",{className:(0,s.A)(Qe.floatingBadge,f&&Qe.clickable),onClick:f,children:[(0,N.FD)("div",{className:(0,s.A)(Qe.floatingBadgeText,c&&Qe.dynamicColor,(!T||0===T)&&Qe.noTransition),style:Q,children:[(0,N.Y)(_e.A,{preset:"button",className:Qe.floatingBadgeSparkles}),(0,N.FD)("div",{ref:A,className:(0,s.A)(Qe.floatingBadgeContent,l&&Qe.withDescription),children:[(0,N.FD)("div",{className:Qe.floatingBadgeTitle,children:[(0,N.Y)(F.A,{name:"star",className:Qe.floatingBadgeIcon}),(0,N.Y)(je.A,{text:U})]}),(0,N.Y)("div",{className:Qe.floatingBadgeDescription,children:l})]})]}),(0,N.FD)("svg",{className:Qe.floatingBadgeTriangle,width:q,height:32,viewBox:`0 0 ${q} 32`,fill:"none","aria-hidden":"true",role:"presentation",style:`transform: translate(calc(-50% + ${V}px), 33%)`,children:[!c&&(0,N.Y)("defs",{children:(0,N.FD)("linearGradient",{id:"StarBadgeTriangle",x1:"0",x2:"1",y1:"0",y2:"0",children:[(0,N.Y)("stop",{offset:"-50%","stop-color":"#FFAA00"}),(0,N.Y)("stop",{offset:"150%","stop-color":"#FFCD3A"})]})}),(0,N.Y)("path",{className:Qe.floatingBadgeTrianglePath,d:H,fill:_||"url(#StarBadgeTriangle)"})]})]})}),(0,N.Y)("div",{className:(0,s.A)(Qe.progress,c&&Qe.dynamicColor),children:(0,N.Y)(_e.A,{preset:"progress",className:Qe.sparkles})}),(0,N.Y)("input",{className:Qe.slider,type:"range",min:0,max:G.length,defaultValue:ot(G,t,v),step:"any",onChange:z,onPointerDown:W,onPointerMove:J,onPointerUp:j}),d&&(0,N.Y)(F.A,{name:"add",className:Qe.customValueIcon})]})}),ct={content:"RdhRpsCn",title:"yzbjj73U",slider:"xePPMXOI",description:"BlpfdOtK",itemInfo:"nS9V516D",itemTitle:"sH5Nukjy",itemSubtitle:"dHlNODTI",itemIcon:"H_iHihXU",sendAsPeerButtonAvatar:"_mjvLELm",sendAsPeerMenuButton:"zxsRaWYV",buttonDownIcon:"zrwUUELS",sendAsPeerMenuBubble:"X1PB6mhQ",sendAsPeerMenu:"Px1MDij9",sendAsPeersMenuContainer:"Al1nfhHJ",headerControlPanel:"vu90kSL_",separator:"uhQLUjmo",checkBox:"Mc3bVeF0",topLabel:"bnou4CpV",top:"QludQDKR",topBadge:"JBF9pTUK",buttonStar:"NJJFuym9",topPeer:"Ty4Ud_Rd",disclaimer:"KRvkHeo1"},dt={avatarIcon:"author-hidden",customPeerAvatarColor:"#9eaab5",isCustomPeer:!0,titleKey:"StarsReactionAnonymous"},ut=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const i=t&&(0,o.hds)(e,t.chatId),n=t&&(0,o.O5q)(e,t.chatId,t.messageId),a=e.stars?.balance,r=e.appConfig.paidReactionMaxAmount||2500,s=e.settings.paidReactionPrivacy,l=i?.sendPaidReactionsAsPeerIds,c=e.currentUserId;return{chat:i,message:n,starBalance:a,maxAmount:r,defaultPrivacy:s,sendPaidReactionsAsPeerIds:l,currentUserId:c,currentUser:(0,o.mBe)(e,c)}})(({modal:e,chat:t,message:i,maxAmount:l,starBalance:d,defaultPrivacy:A,sendPaidReactionsAsPeerIds:g,currentUserId:b,currentUser:v})=>{const{closePaidReactionModal:G,addLocalPaidReaction:C,loadSendPaidReactionsAs:I}=(0,a.ko)(),[y,k]=(0,n.J0)(50),[Y,B,w]=(0,T.A)(),[D,P]=(0,n.J0)(!0),[R,x]=(0,n.J0)(b),L=t?.id,O=R?(0,o.PVB)((0,a.mS)(),R):v,K=(0,m.A)(),{isMobile:V}=(0,ke.Ay)(),E=(0,M.A)(),q=(0,u.A)(e=>{P(!e.target.checked)}),z=(0,u.A)(e=>{k(e),B()});(0,n.vJ)(()=>{L&&!g&&I({chatId:L})},[L,g]);const J=(0,n.Kr)(()=>{const e=g?.map(e=>e.id).filter(e=>e!==L);return e?.unshift(b),e},[g,L,b]),j=J&&J.length>1;(0,n.vJ)(()=>{e||w()},[e]),(0,n.vJ)(()=>{const e=i?.reactions?.topReactors?.find(e=>e.isMy);if(e)return P(Boolean(e.isAnonymous)),void(e.peerId&&x(e.peerId));P("anonymous"===A?.type||!1),"peer"===A?.type&&J?.includes(A.peerId)?x(A.peerId):x(b)},[A,i?.reactions?.topReactors,J,b]);const _=(0,u.A)(()=>{e&&(C({chatId:e.chatId,messageId:e.messageId,count:y,isPrivate:D,peerId:D||R===b?void 0:R,shouldIgnoreDefaultPrivacy:!0}),G())}),Q=(0,u.A)(e=>{P(!1),x(e)}),X=(0,u.A)(e=>{const t=(0,o.PVB)((0,a.mS)(),e),i=R===e&&!D;if(t)return(0,N.FD)(ze.A,{onClick:()=>Q(e),children:[(0,N.Y)(f.A,{size:"small",peer:t}),(0,N.FD)("div",{className:(0,s.A)(ct.itemInfo),children:[(0,N.Y)(Ee.A,{className:ct.itemTitle,peer:t,noFake:!0,noVerified:!0}),(0,N.Y)("span",{className:ct.itemSubtitle,children:(0,r.mO)(t)?E("PeerPersonalAccount"):E("PeerChannel")})]}),(0,N.Y)(F.A,{className:ct.itemIcon,name:i?"check":"placeholder"})]})}),$=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,N.FD)(U.A,{ripple:!V,size:"smaller",color:"translucent",className:(0,s.A)(ct.sendAsPeerMenuButton,t?"active":""),onClick:e,ariaLabel:E("AriaLabelOpenMenu"),children:[(0,N.Y)(f.A,{className:ct.sendAsPeerButtonAvatar,size:"mini",peer:D?dt:O}),(0,N.Y)(F.A,{name:"down",className:ct.buttonDownIcon})]}),[V,E,O,D]),Z=(0,n.Kr)(()=>{if(j)return(0,N.Y)(He.A,{className:(0,s.A)(ct.sendAsPeerMenu,"with-menu-transitions"),bubbleClassName:ct.sendAsPeerMenuBubble,trigger:$,positionX:"right",autoClose:!0,children:J.map(e=>X(e))})},[$,J,j]),ee=(0,n.Kr)(()=>{const e=(0,a.mS)(),t=i?.reactions?.topReactors;if(!t)return;const n=[];let r=!1,s=0;if(t.forEach(t=>{const i=t.peerId?(0,o.PVB)(e,t.peerId):void 0;if(!i&&!t.isAnonymous&&!t.isMy)return;if(t.isMy&&(s=t.count),t.isMy&&(t.peerId!==R||t.isAnonymous&&!D))return;const a=R===t.peerId||D&&t.isAnonymous;a&&(r=!0),n.push({amount:t.count,localAmount:a&&Y?y:0,isMy:t.isMy,isAnonymous:t.isAnonymous,user:i})}),!r){const t=(0,o.PVB)(e,R);n.push({amount:s,localAmount:Y?y:0,isMy:!0,user:t})}return n.sort((e,t)=>t.amount+t.localAmount-(e.amount+e.localAmount)),n.slice(0,3)},[Y,i?.reactions?.topReactors,y,R,D]),te=t&&(0,r.F9)(K,t);return(0,N.FD)(h.A,{isOpen:Boolean(e),onClose:G,isSlim:!0,hasAbsoluteCloseButton:!0,contentClassName:ct.content,isLowStackPriority:!0,children:[(0,N.Y)("div",{className:ct.sendAsPeersMenuContainer,children:Z}),(0,N.Y)("div",{className:ct.headerControlPanel,children:(0,N.Y)(H,{balance:d,className:ct.modalBalance,withAddButton:!0})}),(0,N.Y)(lt,{className:ct.slider,defaultValue:50,maxValue:l,onChange:z}),(0,N.Y)("h3",{className:ct.title,children:K("StarsReactionTitle")}),(0,N.Y)("div",{className:ct.description,children:(0,c.A)(K("StarsReactionText",te),["simple_markdown","emoji"])}),(0,N.Y)(We.A,{children:ee&&(0,N.Y)("div",{className:ct.topLabel,children:K("StarsReactionTopSenders")})}),ee&&(0,N.Y)("div",{className:ct.top,children:ee.map(e=>{const t=(0,W.Sm)(e.amount+e.localAmount),i=e.isAnonymous||!e.user||e.isMy&&D?dt:e.user,n="isCustomPeer"in i?K(i.titleKey):i&&(0,r.F9)(K,i);return(0,N.Y)(Ae.A,{className:ct.topPeer,peer:i,badgeText:t,badgeIcon:"star",badgeClassName:ct.topBadge,text:n},`${e.user?.id||"anonymous"}-${t}`)})}),ee&&(0,N.Y)(We.A,{className:ct.separator}),(0,N.Y)(qe.A,{className:(0,s.A)(ct.checkBox,"dialog-checkbox"),checked:!D,onChange:q,label:K("StarsReactionShowMeInTopSenders")}),(0,N.Y)(U.A,{onClick:_,children:E("SendPaidReaction",{amount:y},{withNodes:!0,specialReplacement:{[S.Cyx]:(0,N.Y)(F.A,{className:ct.buttonStar,name:"star"})}})}),(0,N.Y)("p",{className:ct.disclaimer,children:E("StarsReactionTerms",{link:(0,N.Y)(p.A,{text:E("StarsReactionLinkText"),url:E("StarsReactionLink")})},{withNodes:!0})})]})}));var mt=i(37836),ft=i(5912),pt=i(23174),ht=i(21309),At=i(65632),gt=i(20333),bt=i(59118),vt=i(96530),Nt=i(22720),Gt=i(63152),St=i(94079),Ct=i(61361);const It="zZUpGRSI",yt="zAee80Dv",kt="nTPAv1ci",Yt=48*ht.dp,Bt=(0,n.ph)((0,a.EK)((e,{peerId:t,gift:i})=>{const n=(0,o.SJA)(e),{stars:a}=e,{isBlurred:r,patternColor:s,background:l,backgroundColor:c}=(0,o.Gyz)(e,n)||{},d=(0,o.PVB)(e,t),u=(0,o.WA9)(e,t),m=(0,o.vGo)(e,t),f=e.currentUserId===t,p=!f&&m?.disallowedGifts?.shouldDisallowUniqueStarGifts,h=!f&&m?.disallowedGifts?.shouldDisallowLimitedStarGifts,A=(0,o.nTw)(e),g="id"in i&&"starGift"===i.type&&i.isAuction?i.id:void 0,b=g?e.giftAuctionByGiftId?.[g]:void 0;return{starBalance:a?.balance,peer:d,theme:n,isBackgroundBlurred:r,patternColor:s,customBackground:l,backgroundColor:c,captionLimit:e.appConfig.starGiftMaxMessageLength,currentUserId:e.currentUserId,isPaymentFormLoading:A.isPaymentFormLoading,paidMessagesStars:u,areUniqueStarGiftsDisallowed:p,shouldDisallowLimitedStarGifts:h,giftAuction:b}})(function({gift:e,giftByStars:t,peerId:i,peer:o,captionLimit:c,theme:d,isBackgroundBlurred:m,patternColor:f,backgroundColor:p,customBackground:h,currentUserId:A,isPaymentFormLoading:g,starBalance:b,paidMessagesStars:v,areUniqueStarGiftsDisallowed:G,shouldDisallowLimitedStarGifts:S,giftAuction:C}){const{sendStarGift:I,sendPremiumGiftByStars:y,openInvoice:k,openGiftUpgradeModal:Y,openStarsBalanceModal:B,openGiftAuctionBidModal:w,openGiftAuctionInfoModal:D,openGiftAuctionChangeRecipientModal:P}=(0,a.ko)(),T=(0,M.A)(),[F,R]=(0,n.J0)(""),[x,L]=(0,n.J0)(!1),[O,K]=(0,n.J0)(!1),[V,E]=(0,n.J0)(!1),q=(0,At.A)(d,h);(0,n.vJ)(()=>{S&&K(!0)},[S,O]);const H="id"in e&&"starGift"===e.type,W="months"in e,J=t&&"amount"in t,j=o&&(0,r.mO)(o),_=i===A,Q=(0,n.Kr)(()=>{if(W){const i=V&&J?t:e;return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"giftPremium",amount:i.amount,currency:i.currency,days:30*e.months,message:F?{text:F}:void 0}}}}if(H)return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"starGift",message:F?.length?{text:F}:void 0,isNameHidden:x||void 0,starsToConvert:e.starsToConvert,canUpgrade:O||void 0,alreadyPaidUpgradeStars:O?e.upgradeStars:void 0,gift:e,peerId:i,fromId:A}}}},[A,e,F,H,x,O,i,V,J,t,W]),X=(0,u.A)(e=>{R(e.target.value)}),$=(0,u.A)(()=>{L(!x)}),Z=(0,u.A)(()=>{K(!O)}),ee=(0,u.A)(()=>{J&&E(!V)}),te=(0,u.A)(()=>{H&&Y({giftId:e.id,peerId:i})}),ie=(0,u.A)(()=>{B({})}),ne=(0,u.A)(()=>{C&&D({auctionGiftId:C.gift.id})}),ae=(0,u.A)(()=>{if(C){const e=C.userState.bidPeerId;return e&&e!==i?void P({auctionGiftId:C.gift.id,oldPeerId:e,newPeerId:i,message:F||void 0,shouldHideName:x||void 0}):void w({auctionGiftId:C.gift.id,peerId:i,message:F||void 0,shouldHideName:x||void 0})}H?I({peerId:i,shouldHideName:x,gift:e,message:F?{text:F}:void 0,shouldUpgrade:O}):V&&J?y({userId:i,months:t.months,amount:t.amount,message:F?{text:F}:void 0}):W&&k({type:"giftcode",userIds:[i],currency:e.currency,amount:e.amount,option:e,message:F?{text:F}:void 0})}),re=J&&b&&b.amount>t.amount,oe=(0,s.A)("ZORVRSG3","soDpW2YR",h&&"Eny_G3JI",p&&"TkJZPU2u",h&&m&&"M6k91TdM");if((H||W)&&Q)return(0,N.FD)("div",{className:(0,s.A)("jKOG0It6","custom-scroll"),children:[(0,N.FD)("div",{className:(0,s.A)("CB1mxsgp","MessageList"),inert:!0,style:(0,Ie.A)(`--pattern-color: ${f}`,p&&`--theme-background-color: ${p}`),children:[(0,N.Y)("div",{className:oe,style:q?`--custom-background: ${q}`:void 0}),(0,N.Y)(bt.A,{message:Q,threadId:pt.l3,appearanceOrder:0},H?e.id:W?e.months:void 0)]}),function(){const i=c?c-F.length:void 0,n=(0,r.F9)(T,o);return(0,N.FD)("div",{className:"Y68CEIKn",children:[!v&&(0,N.Y)(St.A,{className:"o5r2IPoA",onChange:X,value:F,label:T("GiftMessagePlaceholder"),maxLength:c,maxLengthIndicator:i&&i<50?i.toString():void 0}),re&&(0,N.FD)(Nt.A,{className:It,narrow:!0,ripple:!0,onClick:ee,children:[(0,N.Y)("span",{children:T("GiftPremiumPayWithStars",{stars:(0,pe.U2)(T,t.amount,{className:yt})},{withNodes:!0})}),(0,N.Y)(Gt.A,{checked:V,onChange:ee,label:T("GiftPremiumPayWithStarsAcc")})]}),J&&b&&(0,N.Y)("div",{className:kt,children:T("GiftPremiumDescriptionYourBalance",{stars:(0,pe.U2)(T,b.amount,{className:yt}),link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:ie,children:T("GetMoreStarsLinkText")})},{withNodes:!0,withMarkdown:!0})}),H&&Boolean(e.upgradeStars)&&!G&&(0,N.FD)(Nt.A,{className:It,narrow:!0,ripple:!0,onClick:Z,disabled:S,children:[(0,N.Y)("span",{children:T("GiftMakeUnique",{stars:(0,pe.U2)(T,e.upgradeStars,{className:yt})},{withNodes:!0})}),(0,N.Y)(Gt.A,{checked:O,onChange:Z,label:T("GiftMakeUniqueAcc")})]}),H&&Boolean(e.upgradeStars)&&!G&&(0,N.Y)("div",{className:kt,children:j?T("GiftMakeUniqueDescription",{user:n,link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:te,children:T("GiftMakeUniqueLink")})},{withNodes:!0}):T("GiftMakeUniqueDescriptionChannel",{peer:n,link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:te,children:T("GiftMakeUniqueLink")})},{withNodes:!0})}),H&&(0,N.FD)(Nt.A,{className:It,narrow:!0,ripple:!0,onClick:$,children:[(0,N.Y)("span",{children:T("GiftHideMyName")}),(0,N.Y)(Gt.A,{checked:x,onChange:$,label:T("GiftHideMyName")})]}),H&&(0,N.Y)("div",{className:kt,children:_?T("GiftHideNameDescriptionSelf"):j?T("GiftHideNameDescription",{receiver:n}):T("GiftHideNameDescriptionChannel")})]})}(),(0,N.Y)("div",{className:"ATowWJ60"}),function(){const i=V&&J?(0,pe.U2)(T,t.amount,{asFont:!0}):H?(0,pe.U2)(T,e.stars+(O?e.upgradeStars:0),{asFont:!0}):W?(0,l.vv)(T,e.amount,e.currency):void 0,n=C?.gift.giftsPerRound,a=C?.state.endDate,r=a?a-(0,Ye.Fm)():void 0,o=void 0!==r&&r>0&&r<Yt;return(0,N.FD)("div",{className:"jxWZSvet",children:[H&&Boolean(e.availabilityRemains)&&(0,N.Y)(gt.A,{isPrimary:!0,progress:e.availabilityRemains/e.availabilityTotal,rightText:T("GiftSoldCount",{count:e.availabilityTotal-e.availabilityRemains}),leftText:T("GiftLeftCount",{count:e.availabilityRemains}),className:"mWzLu0c0"}),C&&Boolean(n)&&(0,N.Y)("div",{className:"j4s8T1dQ",children:T("GiftAuctionDescription",{count:n,link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:ne,children:T("GiftAuctionLearnMore")})},{pluralValue:n,withNodes:!0})}),(0,N.Y)(U.A,{className:"IDuhjrne",size:r?void 0:"smaller",onClick:ae,isLoading:g,noForcedUpperCase:!0,children:C?(0,N.FD)("div",{children:[(0,N.Y)("div",{children:T("GiftAuctionPlaceBid")}),void 0!==r&&r>0&&(0,N.Y)("div",{className:"pB6hqcvA",children:T("GiftAuctionTimeLeft",{time:o?(0,N.Y)(Ct.A,{endsAt:a}):(0,z.zt)(T,r)},{withNodes:!0})})]}):T("GiftSend",{amount:i},{withNodes:!0})})]})}()]})}));var wt=i(87049);const Dt="G1mBmzxs",Pt="a8no5WH0",Tt="DvJLTVFU",Mt=(0,n.ph)((0,a.EK)((e,{option:t})=>({sticker:(0,o.t0O)(e,t.months),canPlayAnimatedEmojis:(0,o.BWX)(e)}))(function({sticker:e,canPlayAnimatedEmojis:t,baseMonthAmount:i,option:n,optionByStars:a,onClick:r}){const{months:o,amount:s,currency:c}=n,d=(0,M.A)(),m=(0,u.A)(()=>{r(n)}),f=Math.floor(s/o),p=i&&i>f?Math.ceil(100-f/(i/100)):void 0;return(0,N.FD)("div",{className:Dt,tabIndex:0,role:"button",onClick:m,children:[(0,N.Y)(ee.A,{sticker:e,play:t,noLoop:!0,nonInteractive:!0,size:86}),function(){const e=12===o?d("Years",{count:1},{pluralValue:1}):d("Months",{count:o},{pluralValue:o});return(0,N.Y)("div",{className:"rn9aWFNA",children:e})}(),(0,N.Y)("div",{className:"q4_ydkAx",children:d("PremiumGiftDescription")}),(0,N.Y)(U.A,{className:Pt,color:"adaptive",nonInteractive:!0,size:"tiny",pill:!0,fluid:!0,children:(0,l.Ad)(s,c)}),a&&(0,N.Y)("div",{className:"QB5SI7ta",children:d("GiftPremiumStarsPrice",{stars:(0,pe.U2)(d,a.amount,{className:"jgnEfoeM"})},{withNodes:!0,withMarkdown:!0})}),Boolean(p)&&(0,N.Y)(wt.A,{color:"purple",text:d("GiftDiscount",{percent:p})})]})}));var Ft=i(82855);const Ut=(0,n.ph)((0,a.EK)(e=>({isCurrentUserPremium:(0,o.g29)(e)}))(function({gift:e,isResale:t,isCurrentUserPremium:i,withTransferBadge:r,hideBadge:o,noClickable:l,observeIntersection:c,onClick:d}){const{openGiftInfoModal:m,openPremiumModal:f,showNotification:p,checkCanSendGift:h,openGiftAuctionModal:A}=(0,a.ko)(),g=(0,n.li)(),b=(0,n.li)(),v=(0,M.A)(),[G,C]=(0,n.J0)(!1),[I,y,k]=(0,T.A)(),Y=(0,X.yQ)(e),B="starGiftUnique"===e.type,w=B?e:void 0,D=B?void 0:e,P=B?function(t){if(!t)return{amount:0,currency:S.OUy};if("starGiftUnique"===e.type&&e.resaleTonOnly){const e=t.find(e=>e.currency===S.ykW);if(e)return e}return t.find(e=>e.currency===S.OUy)}(w?.resellPrice):{amount:D?.stars||0,currency:S.OUy},R=P?.currency||S.OUy,x=D?.resellMinStars,L=!B&&t&&x?v.number(x)+"+":P?.amount||0,O=!B&&Boolean(D?.isLimited),K=!B&&Boolean(D?.isSoldOut),V=!B&&!t&&Boolean(D?.isAuction),E=Boolean(e?.requirePremium),q=Boolean(D?.limitedPerUser&&!D?.perUserRemains),H=D?.perUserTotal,z=(0,u.A)(()=>{V?A({gift:e}):!K||t?q?p({message:{key:"NotificationGiftsLimit2",variables:{count:H},options:{pluralValue:H,withMarkdown:!0,withNodes:!0}}}):!E||i?j?h({gift:e,onSuccess:()=>d?.(e,t?"resell":"original")}):d?.(e,t?"resell":"original"):f({gift:e}):m({gift:e})}),W=(0,n.Kr)(()=>{const{backdrop:t,pattern:i}=(0,X.uc)(e)||{};if(!t||!i)return;const n=[t.centerColor,t.edgeColor];return(0,N.Y)(te.A,{className:"Nkotr8Q4",backgroundColors:n,patternIcon:i.sticker,ringsCount:1,ovalFactor:1})},[e]),J=B?e.number:0,j=Boolean("starGift"===e.type&&e.lockedUntilDate),_=(0,n.Kr)(()=>{if(B){const{backdrop:t}=(0,X.uc)(e)||{};if(!t)return;return(0,N.Y)(wt.A,{color:[t.centerColor,t.edgeColor],text:v("GiftSavedNumber",{number:J})})}return t?(0,N.Y)(wt.A,{color:"green",text:v("GiftRibbonResale")}):K?(0,N.Y)(wt.A,{color:"red",text:v("GiftSoldOut")}):V?(0,N.Y)(wt.A,{color:"orange",text:v("GiftRibbonAuction")}):E?(0,N.Y)(wt.A,{color:"orange",text:v("GiftRibbonPremium")}):O?(0,N.Y)(wt.A,{color:"blue",text:v("GiftLimited")}):void 0},[B,t,e,K,O,v,J,E,V]);(0,ft.mv)(g,c,e=>{const t=e.isIntersecting;C(t)});const Q=(0,n.Kr)(()=>r?v("GiftTransferTitle"):V?v("GiftAuctionJoin"):R===S.ykW?(0,pe.Ms)(v,L||0,{shouldConvertFromNanos:!0,className:Tt}):(0,pe.U2)(v,L||0,{asFont:!0,className:Tt}),[r,R,L,V,v]);return(0,N.FD)("div",{ref:g,className:(0,s.A)("interactive-gift",Dt,"f5ArEO1S","starGiftItem",E&&"NBYIITte",V&&"WqBCC4Ce",l&&"pcLi3lcD"),tabIndex:l?void 0:0,role:l?void 0:"button",onClick:l?void 0:z,onMouseEnter:Ce.TF||l?void 0:y,onMouseLeave:Ce.TF||l?void 0:k,children:[W,(0,N.Y)("div",{ref:b,className:"rUSoeQXb",style:"width: 90px; height: 90px",children:Y&&(0,N.Y)(Ft.A,{observeIntersectionForPlaying:c,observeIntersectionForLoading:c,containerRef:b,sticker:Y,size:90,shouldLoop:I,shouldPreloadPreview:!0})}),!o&&(0,N.Y)(U.A,{className:(0,s.A)(Pt,r&&"nqN62arv"),nonInteractive:!0,size:"tiny",color:B?"bluredStarsBadge":"stars",withSparkleEffect:G&&!r,pill:!0,fluid:!0,children:Q}),_,j&&(0,N.Y)(F.A,{name:"lock-badge",className:"kwuipwV7"})]})}));var Rt=i(13235),xt=i(36175),Lt=i(96374),Ot=i(64489);const Kt={root:"tJK1W0pJ",transition:"pP8TxefR",content:"o3V1HqbL",resaleScreenRoot:"Vce_TsJO",main:"cVXqeu9P",giftSection:"v4eKefwN",section:"EqfarEYb",resaleStarGiftsContainer:"RSFcSNGL",starGiftsContainer:"OQX3GZl5",premiumGiftsGallery:"n40m3BK2",header:"iqqoyRgW",noBorder:"cuvdjW2y",resaleHeader:"cJRBgg9B",resaleHeaderContentContainer:"OXYQmfGK",headerSlide:"BTWhJUQB",headerText:"lLRmbpIu",hiddenHeader:"XgGzn1cQ",resaleHeaderText:"bp_KPx8I",commonHeaderText:"ybZo03if",resaleHeaderDescription:"XefHUFm1",closeButton:"r_Y5uG1T",balance:"soqAknia",avatars:"N_7tYJKr",avatar:"_3hY4vIep",logoBackground:"ieK4TzSb",center:"Ey5gX40t",description:"ZioU5h_k",starGiftsDescription:"gFgzS8pV",boostIcon:"Qi2YR6Dz",optionBottom:"RTbClMKE",secondaryInfo:"g0R9GSNq",footer:"J3Gju3bv",starGiftsTransition:"kB6IyXqS",notFoundGiftsRoot:"UqnRlJ1n",notFoundGiftsDescription:"g0VbwIG_",notFoundGiftsLink:"j2zPEQr8"},Vt=(0,n.ph)((0,a.EK)(e=>{const{starGifts:t}=e,{resaleGifts:i}=(0,o.nTw)(e),n=i?.giftId?t?.byId[i.giftId]:void 0,a=i.filter,r=i.isAllLoaded,s=i.isLoading,l=i.updateIteration;return{resellGifts:i.gifts,gift:n,filter:a,areGiftsAllLoaded:r,areGiftsLoading:s,updateIteration:l}})(({resellGifts:e,gift:t,filter:i,areGiftsAllLoaded:r,areGiftsLoading:o,updateIteration:l,onGiftClick:c})=>{const{loadResaleGifts:d,updateResaleGiftsFilter:m}=(0,a.ko)(),f=(0,n.li)(),p=(0,M.A)(),h=(0,n.Kr)(()=>e?.map(e=>e.id),[e]),A=Boolean(i?.modelAttributes?.length||i?.patternAttributes?.length||i?.backdropAttributes?.length),g=(0,u.A)(()=>{if(t){const e="regularGiftId"in t?t.regularGiftId:t.id;d({giftId:e})}}),b=Boolean(!e||0===e.length),[v,G]=(0,Lt.A)(g,h,!t,Rt.bc),{observe:S}=(0,ft.BL)({rootRef:f,throttleMs:200}),C=(0,u.A)(()=>{m({filter:{...i,modelAttributes:[],backdropAttributes:[],patternAttributes:[]}})});return(0,N.Y)("div",{ref:f,className:(0,s.A)(Kt.resaleScreenRoot,"custom-scroll"),children:(0,N.FD)(L.Ay,{name:"zoomFade",activeKey:l,children:[b&&r&&(0,N.FD)("div",{className:Kt.notFoundGiftsRoot,children:[(0,N.Y)(Ot.A,{size:160,tgsUrl:xt.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,N.Y)("div",{className:Kt.notFoundGiftsDescription,children:p("ResellGiftsNoFound")}),A&&(0,N.Y)(vt.A,{className:Kt.notFoundGiftsLink,onClick:C,children:p("ResellGiftsClearFilters")})]}),(0,N.Y)(R.A,{className:(0,s.A)(Kt.resaleStarGiftsContainer),items:v,onLoadMore:G,itemSelector:".starGiftItem",noFastList:!0,preloadBackwards:Rt.bc,scrollContainerClosest:`.${Kt.resaleScreenRoot}`,children:e?.map(e=>(0,N.Y)(Ut,{gift:e,observeIntersection:S,isResale:!0,onClick:c},e.id))})]})})}));var Et=i(10722),qt=i(71429),Ht=i(36393),zt=i(87094);const Wt=1.5*P.$,Jt=(0,n.ph)((0,a.EK)(e=>({theme:(0,o.SJA)(e)}))(({className:e,type:t,sticker:i,observeIntersectionForLoading:a,observeIntersectionForPlaying:r,theme:o})=>{const l=(0,n.li)(),c=(0,zt.A)(l,void 0,"pattern"!==t);return(0,N.Y)("div",{ref:l,className:(0,s.A)("KLFLR9ji",e),style:`width: ${Wt}px; height: ${Wt}px`,children:(0,N.Y)(Ft.A,{containerRef:l,sticker:i,size:Wt,shouldPreloadPreview:!0,observeIntersectionForLoading:a,observeIntersectionForPlaying:r,thumbClassName:"fCL5rY2D",customColor:c})})})),jt={root:"_VgmQnUg",buttonsContainer:"IDlp6U6g",itemIcon:"yuctLnuR",sticker:"VT562JS0",backdropAttributeMenuItemText:"D50wFfRL",menuItemStickerText:"THcGWXSA",menuItemText:"L6EVE2Ux",backdrop:"A29QNxKb",menuItemIcon:"GL4rVsev",item:"qiYcBOYc",menuContentContainer:"EDsBn29z",menu:"ISaNdBwd",left:"e4Kkh_MR",right:"Kz_nCGC3"},_t=(0,n.ph)((0,a.EK)(e=>{const{resaleGifts:t}=(0,o.nTw)(e);return{attributes:t.attributes,counters:t.counters,filter:t.filter}})(({attributes:e,counters:t,filter:i,dialogRef:r})=>{const o=(0,M.A)(),{updateResaleGiftsFilter:l}=(0,a.ko)(),[c,d]=(0,n.J0)(""),[m,f]=(0,n.J0)(""),[p,h]=(0,n.J0)(""),A=(0,n.Kr)(()=>{const i={model:[],pattern:[],backdrop:[]};for(const n of t??[]){const{attribute:t}=n;if(!n.count)continue;const a=e?.find(e=>"backdrop"===e.type&&"backdrop"===t.type?e.backdropId===t.backdropId:("model"===e.type&&"model"===t.type||"pattern"===e.type&&"pattern"===t.type)&&e.sticker.id===t.documentId);"backdrop"===a?.type&&i.backdrop.push(a),"model"===a?.type&&i.model.push(a),"pattern"===a?.type&&i.pattern.push(a)}return i},[e,t]),g=(0,n.Kr)(()=>{const e=(e,t)=>t.trim()?e.filter(e=>Boolean(e.name?.toLowerCase().includes(t.toLowerCase()))):e;return{model:e(A.model,c),pattern:e(A.pattern,p),backdrop:e(A.backdrop,m)}},[A,c,m,p]),b=(0,n.li)(),{isContextMenuOpen:v,contextMenuAnchor:G,handleContextMenu:S,handleContextMenuClose:C,handleContextMenuHide:I}=(0,Et.A)(r),y=(0,u.A)(()=>b.current),k=(0,n.li)(),{isContextMenuOpen:Y,contextMenuAnchor:B,handleContextMenu:w,handleContextMenuClose:D,handleContextMenuHide:P}=(0,Et.A)(r),T=(0,u.A)(()=>k.current),U=(0,n.li)(),{isContextMenuOpen:R,contextMenuAnchor:x,handleContextMenu:L,handleContextMenuClose:O,handleContextMenuHide:K}=(0,Et.A)(r),V=(0,u.A)(()=>U.current),E=(0,n.li)(),{isContextMenuOpen:q,contextMenuAnchor:H,handleContextMenu:z,handleContextMenuClose:W,handleContextMenuHide:J}=(0,Et.A)(r),j=(0,u.A)(()=>E.current),_=(0,n.Kr)(()=>{const e=i.sortType;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:["byDate"===e&&o("ValueGiftSortByDate"),"byNumber"===e&&o("ValueGiftSortByNumber"),"byPrice"===e&&o("ValueGiftSortByPrice"),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),Q=(0,n.Kr)(()=>{const e=i?.modelAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:[0===e&&o("GiftAttributeModel"),e>0&&o("GiftAttributeModelPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),X=(0,n.Kr)(()=>{const e=i?.backdropAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:[0===e&&o("GiftAttributeBackdrop"),e>0&&o("GiftAttributeBackdropPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),$=(0,n.Kr)(()=>{const e=i?.patternAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:jt.item,onClick:t,children:[0===e&&o("GiftAttributeSymbol"),e>0&&o("GiftAttributeSymbolPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:jt.itemIcon})]})},[o,i]),Z=(0,u.A)(e=>{l({filter:{...i,sortType:e}})}),ee=(0,u.A)(()=>{l({filter:{...i,modelAttributes:[]}})}),ie=(0,u.A)(()=>{l({filter:{...i,patternAttributes:[]}})}),ne=(0,u.A)(()=>{l({filter:{...i,backdropAttributes:[]}})}),ae=(0,u.A)(e=>{if(!t)return;const n=i.modelAttributes||[],a=t.find(t=>"model"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!a)return;const r=n.some(e=>e.documentId===a.documentId)?n.filter(e=>e.documentId!==a.documentId):[...n,a];l({filter:{...i,modelAttributes:r}})}),re=(0,u.A)(e=>{if(!t)return;const n=i.patternAttributes||[],a=t.find(t=>"pattern"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!a)return;const r=n.some(e=>e.documentId===a.documentId)?n.filter(e=>e.documentId!==a.documentId):[...n,a];l({filter:{...i,patternAttributes:r}})}),oe=(0,u.A)(e=>{if(!t)return;const n=i.backdropAttributes||[],a=t.find(t=>"backdrop"===t.attribute.type&&t.attribute.backdropId===e.backdropId)?.attribute;if(!a)return;const r=n.some(e=>e.backdropId===a.backdropId)?n.filter(e=>e.backdropId!==a.backdropId):[...n,a];l({filter:{...i,backdropAttributes:r}})}),se=(0,n.hb)(()=>{d("")},[]),le=(0,n.hb)(()=>{f("")},[]),ce=(0,n.hb)(()=>{h("")},[]),de=(0,u.A)(e=>{e.stopPropagation(),e.preventDefault()}),ue=(0,n.li)(),{observe:me}=(0,ft.BL)({rootRef:ue,isDisabled:!B});return(0,N.FD)("div",{className:jt.root,children:[Boolean(G)&&(0,N.Y)(qt.A,{isOpen:v,anchor:G,ref:b,className:(0,s.A)(jt.menu,jt.left,"with-menu-transitions"),getMenuElement:y,autoClose:!0,onClose:C,onCloseAnimationEnd:I,positionX:"left",children:(0,N.FD)(N.FK,{children:[(0,N.FD)(ze.A,{icon:"sort-by-price",onClick:()=>{Z("byPrice")},children:[(0,N.Y)("div",{className:jt.menuItemText,children:o("GiftSortByPrice")}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:"byPrice"===i?.sortType?"check":"placeholder"})]}),(0,N.FD)(ze.A,{icon:"sort-by-date",onClick:()=>{Z("byDate")},children:[(0,N.Y)("div",{className:jt.menuItemText,children:o("GiftSortByDate")}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:"byDate"===i?.sortType?"check":"placeholder"})]}),(0,N.FD)(ze.A,{icon:"sort-by-number",onClick:()=>{Z("byNumber")},children:[(0,N.Y)("div",{className:jt.menuItemText,children:o("GiftSortByNumber")}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:"byNumber"===i?.sortType?"check":"placeholder"})]})]})}),Boolean(B)&&(0,N.Y)(qt.A,{isOpen:Y,anchor:B,ref:k,className:(0,s.A)(jt.menu,jt.left,"with-menu-transitions"),getMenuElement:T,autoClose:!0,onClose:D,onCloseAnimationEnd:P,children:function(){const e=g.model,t=i.modelAttributes??[],n=0===t.length;return(0,N.FD)("div",{className:jt.menuContentContainer,ref:ue,children:[(0,N.Y)(Ht.A,{onClick:de,className:jt.search,value:c,onChange:d,onReset:se,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ee,disabled:n,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=n||t.some(t=>t.documentId===e.sticker.id);return(0,N.FD)(ze.A,{onClick:()=>{ae(e)},children:[(0,N.Y)(Jt,{className:jt.sticker,sticker:e.sticker,type:"model",observeIntersectionForLoading:me,observeIntersectionForPlaying:me}),(0,N.Y)("div",{className:jt.menuItemStickerText,children:e.name}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(x)&&(0,N.Y)(qt.A,{isOpen:R,anchor:x,ref:U,className:(0,s.A)(jt.menu,jt.right,"with-menu-transitions"),getMenuElement:V,autoClose:!0,onClose:O,onCloseAnimationEnd:K,positionX:"right",children:function(){const e=g.backdrop,t=i.backdropAttributes??[],n=0===t.length;return(0,N.FD)("div",{className:jt.menuContentContainer,children:[(0,N.Y)(Ht.A,{onClick:de,className:jt.search,value:m,onChange:f,onReset:le,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ne,disabled:n,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=n||t.some(t=>t.backdropId===e.backdropId);return(0,N.FD)(ze.A,{onClick:()=>{oe(e)},children:[(0,N.Y)(te.A,{className:jt.backdrop,backgroundColors:[e.centerColor,e.edgeColor]}),(0,N.Y)("div",{className:jt.backdropAttributeMenuItemText,children:e.name}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(H)&&(0,N.Y)(qt.A,{isOpen:q,anchor:H,ref:E,className:(0,s.A)(jt.menu,jt.right,"with-menu-transitions"),getMenuElement:j,autoClose:!0,onClose:W,onCloseAnimationEnd:J,children:function(){const e=g.pattern,t=i.patternAttributes??[],n=0===t.length;return(0,N.FD)("div",{className:jt.menuContentContainer,children:[(0,N.Y)(Ht.A,{onClick:de,className:jt.search,value:p,onChange:h,onReset:ce,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ie,disabled:n,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=n||t.some(t=>t.documentId===e.sticker.id);return(0,N.FD)(ze.A,{onClick:()=>{re(e)},children:[(0,N.Y)(Jt,{className:jt.sticker,sticker:e.sticker,type:"pattern"}),(0,N.Y)("div",{className:jt.menuItemStickerText,children:e.name}),(0,N.Y)(F.A,{className:jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),(0,N.FD)("div",{className:jt.buttonsContainer,children:[(0,N.Y)(_,{onTrigger:S,isOpen:v}),(0,N.Y)(Q,{onTrigger:w,isOpen:Y}),(0,N.Y)(X,{onTrigger:L,isOpen:R}),(0,N.Y)($,{onTrigger:z,isOpen:q})]})]})}));var Qt=i(36838);const Xt=(0,n.ph)((0,a.EK)(e=>{const{starGifts:t}=e;return{idsByCategory:t?.idsByCategory}})(({ref:e,idsByCategory:t,onCategoryChanged:i,areUniqueStarGiftsDisallowed:a,areLimitedStarGiftsDisallowed:r,isSelf:o,hasMyUnique:l,isPinned:c})=>{let d=(0,n.li)();e&&(d=e);const u=(0,M.A)(),m=Boolean(t?.collectible?.length),[f,p]=(0,n.J0)("all");function h(e){return"all"===e?u("AllGiftsCategory"):"myUnique"===e?u("GiftCategoryMyGifts"):"collectible"===e?u("GiftCategoryCollectibles"):e}function A(e){return(0,N.Y)("div",{className:(0,s.A)("dO7FKYY4",f===e&&"B2lEJk1v"),onClick:()=>function(e){p(e),i(e)}(e),children:h(e)})}return(0,Qt.A)(d,void 0,!0),(0,N.FD)("div",{ref:d,className:(0,s.A)("cUjwvN00",c&&"NhJABU3M","no-scrollbar"),children:[A("all"),!a&&!o&&l&&A("myUnique"),(!a||!r)&&m&&A("collectible")]})})),$t=[0,-50],Zt=3.5*P.$,ei=(0,mt.nF)(e=>e(),200,!0),ti=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const{starGifts:i,stars:n,currentUserId:a}=e,r=t?.forPeerId?(0,o.PVB)(e,t.forPeerId):void 0,s=r?(0,o.vGo)(e,r?.id):void 0,{resaleGifts:l}=(0,o.nTw)(e),c=l.count,d=!1!==l.isLoading,u=t?.selectedResaleGift;return{boostPerSentGift:e.appConfig.boostsPerSentGift,starGiftsById:i?.byId,starGiftIdsByCategory:i?.idsByCategory,myUniqueGiftsById:e.myUniqueGifts?.byId,myUniqueGiftIds:e.myUniqueGifts?.ids,starBalance:n?.balance,peer:r,currentUserId:a,disallowedGifts:s?.disallowedGifts,resaleGiftsCount:c,areResaleGiftsLoading:d,selectedResaleGift:u,tabId:(0,o.nTw)(e).id}})(({modal:e,starGiftsById:t,starGiftIdsByCategory:i,myUniqueGiftsById:o,myUniqueGiftIds:l,starBalance:c,peer:A,currentUserId:g,disallowedGifts:b,resaleGiftsCount:v,areResaleGiftsLoading:G,selectedResaleGift:I,tabId:y})=>{const{closeGiftModal:k,openGiftInfoModal:Y,resetResaleGifts:B,loadResaleGifts:w,openGiftInMarket:D,closeResaleGiftsMarket:P,loadMyUniqueGifts:F,openGiftTransferConfirmModal:x,setGiftModalSelectedGift:O}=(0,a.ko)(),K=(0,n.li)(),V=(0,n.li)(),E=(0,n.li)(),q=(0,n.li)(),z=(0,n.li)(),W=Boolean(e),J=(0,d.A)(e),j=(0,d.A)(A),_=j&&(0,r.mO)(j)?j:void 0,Q=j&&(0,r.vj)(j)?j:void 0,X=Boolean(g&&J?.forPeerId===g),$=J?.selectedGift,[Z,ee]=(0,n.J0)(!1),[te,ie]=(0,n.J0)(!1),[ne,ae]=(0,n.J0)(!1),[re,oe]=(0,n.J0)("all"),[se,le,ce]=(0,T.A)(!1),de=(0,n.li)(),ue=(0,n.Kr)(()=>{if(!b)return;const{shouldDisallowPremiumGifts:e,...t}=b;return!X&&Object.values(t).every(Boolean)},[X,b]),me=!X&&b?.shouldDisallowUnlimitedStarGifts,fe=!X&&b?.shouldDisallowLimitedStarGifts,pe=!X&&b?.shouldDisallowUniqueStarGifts,he=(0,m.A)(),Ae=(0,M.A)(),ge=J?.gifts,be=(0,n.Kr)(()=>ge?.sort((e,t)=>e.months-t.months).filter(e=>1===e.users&&e.currency!==S.OUy),[ge]),ve=(0,n.Kr)(()=>{const e=new Map;return be?(be.forEach(t=>{const i=ge?.find(e=>e.currency===S.OUy&&e.months===t.months);i&&e.set(t,i)}),e):e},[ge,be]),Ne=(0,n.Kr)(()=>be?.reduce((e,t)=>e.amount<t.amount?e:t),[be]),{observe:Se}=(0,ft.BL)({rootRef:z,throttleMs:200,isDisabled:!W}),Ce=Boolean(I)&&!$,Ie=Boolean($),ye=Ce||Ie||Z,ke=Ie?ne:te;(0,n.vJ)(()=>{if(I){const e="regularGiftId"in I?I.regularGiftId:I.id;w({giftId:e})}},[I]),(0,n.vJ)(()=>{W||(ee(!1),O({gift:void 0}),oe("all"))},[W]),(0,n.vJ)(()=>{ae(Boolean($&&"id"in $))},[$]);const Ye=(0,u.A)(e=>{if(Ie)return;const t=e.currentTarget;ei(()=>{const{scrollTop:e}=t;if(ee(e>150),V.current&&E.current){const{top:e}=E.current.getBoundingClientRect(),{top:t}=V.current.getBoundingClientRect();ie(e-t<=0)}if(q.current&&z.current){const{top:e}=q.current.getBoundingClientRect(),{top:t}=z.current.getBoundingClientRect();e-t<=Zt?le():ce()}})}),Be=Ae("GiftPremiumDescription",{user:(0,C.Yg)(_),link:(0,N.Y)(p.A,{text:Ae("GiftPremiumDescriptionLinkCaption"),url:Ae("GiftPremiumDescriptionLink")})},{withNodes:!0}),we=(0,n.Kr)(()=>Q?Ae("StarGiftDescriptionChannel",{peer:(0,r.F9)(Ae,Q)},{withNodes:!0,withMarkdown:!0}):X?Ae("StarGiftDescriptionSelf",void 0,{withNodes:!0,renderTextFilters:["br"]}):"collectible"===re?Ae("StarGiftDescriptionCollectibles"):Ae("StarGiftDescription",{user:(0,C.Yg)(_)},{withNodes:!0,withMarkdown:!0}),[Q,X,re,_,Ae]),De=(0,u.A)((e,t)=>{if("resell"===t){if(!("id"in e))return;return Ce?void Y({gift:e,recipientId:J?.forPeerId}):void D({gift:e,tabId:y})}O({gift:e})}),Pe=(0,u.A)(e=>{if("starGift"===e.type||!o||!A?.id)return;const t=o[e.id];x({gift:t,recipientId:A.id})}),Te=(0,u.A)(()=>{"myUnique"===re&&F()});const Me=(0,u.A)(e=>{oe(e)}),Fe=(0,u.A)(()=>{O({gift:void 0}),B(),k()}),Ue=(0,u.A)(()=>{Ce?P({tabId:y}):Ie?O({gift:void 0}):Fe()}),Re=(0,u.A)(()=>{de.current?.()}),xe=(0,u.A)(e=>{de.current=e}),Le=Ie||Ce,Oe=(0,s.A)("animated-close-icon",Le&&"state-back");return(0,N.FD)(h.A,{dialogRef:K,onClose:Fe,isOpen:W,isSlim:!0,contentClassName:Kt.content,className:(0,s.A)(Kt.modalDialog,Kt.root),isLowStackPriority:!0,children:[(0,N.Y)(U.A,{className:Kt.closeButton,round:!0,color:"translucent",size:"tiny",onClick:Ue,ariaLabel:he(Le?"Common.Back":"Common.Close"),children:(0,N.Y)("div",{className:Oe})}),(0,N.Y)(H,{className:Kt.balance,balance:c,withAddButton:!0}),(0,N.Y)("div",{className:(0,s.A)(Kt.header,Ce&&Kt.resaleHeader,!ye&&Kt.hiddenHeader,se&&Kt.noBorder),children:(0,N.Y)(L.Ay,{name:"slideVerticalFade",activeKey:ye?Ce?1:ke?2:3:0,slideClassName:Kt.headerSlide,children:function(){if(ye){if(Ce){const e=G&&!v;return(0,N.FD)("div",{className:Kt.resaleHeaderContentContainer,children:[(0,N.Y)("h2",{className:Kt.resaleHeaderText,children:I.title}),e&&(0,N.Y)("div",{className:Kt.resaleHeaderDescription,children:Ae("Loading")}),!e&&void 0!==v&&(0,N.Y)("div",{className:Kt.resaleHeaderDescription,children:Ae("HeaderDescriptionResaleGifts",{count:v},{withNodes:!0,withMarkdown:!0,pluralValue:v})}),(0,N.Y)(_t,{dialogRef:K})]})}return(0,N.Y)("h2",{className:Kt.commonHeaderText,children:Ae(ke?X?"StarsGiftHeaderSelf":"StarsGiftHeader":"GiftPremiumHeader")})}}()})}),(0,N.FD)(L.Ay,{ref:V,className:Kt.transition,name:"pushSlide",activeKey:Ie?1:Ce?2:0,children:[!Ie&&!Ce&&(0,N.FD)("div",{ref:z,className:(0,s.A)(Kt.main,"custom-scroll"),onScroll:Ye,children:[(0,N.FD)("div",{className:Kt.avatars,children:[(0,N.Y)(f.A,{className:Kt.avatar,size:100,peer:j,onMouseMove:Re}),(0,N.Y)(Ge.A,{className:Kt.logoBackground,color:"gold",centerShift:$t,onRequestAnimation:xe})]}),!X&&!Q&&!b?.shouldDisallowPremiumGifts&&(0,N.FD)(N.FK,{children:[(0,N.Y)("h2",{className:(0,s.A)(Kt.headerText,Kt.center),children:Ae("GiftPremiumHeader")}),(0,N.Y)("p",{className:(0,s.A)(Kt.description,Kt.center),children:Be}),(0,N.Y)("div",{className:Kt.premiumGiftsGallery,children:be?.map(e=>(0,N.Y)(Mt,{option:e,optionByStars:ve.get(e),baseMonthAmount:Ne?Math.floor(Ne.amount/Ne.months):void 0,onClick:De}))})]}),!ue&&(0,N.FD)(N.FK,{children:[(0,N.Y)("h2",{ref:E,className:(0,s.A)(Kt.headerText,Kt.center),children:Ae(X?"StarsGiftHeaderSelf":"StarsGiftHeader")}),(0,N.Y)("p",{className:(0,s.A)(Kt.description,Kt.starGiftsDescription,Kt.center),children:we}),(0,N.Y)(Xt,{ref:q,areUniqueStarGiftsDisallowed:pe,areLimitedStarGiftsDisallowed:fe,isSelf:X,hasMyUnique:Boolean(l?.length),isPinned:se,onCategoryChanged:Me}),(0,N.Y)(L.Ay,{name:"zoomFade",activeKey:(Ke=re,"all"===Ke?0:"myUnique"===Ke?1:2),className:Kt.starGiftsTransition,children:function(){if("myUnique"===re)return(0,N.Y)(R.A,{className:Kt.starGiftsContainer,items:l,onLoadMore:Te,scrollContainerClosest:`.${Kt.main}`,itemSelector:".starGiftItem",children:o&&l?.map(e=>{const t=o[e];if(t)return(0,N.Y)(Ut,{gift:t.gift,observeIntersection:Se,onClick:Pe,withTransferBadge:!0},e)})});const e=i?.[re]?.filter(e=>{const i=t?.[e];if(!i)return!1;const{isLimited:n,availabilityResale:a}=i;return fe&&n?!pe&&a:!(me&&!n)});return(0,N.Y)("div",{className:Kt.starGiftsContainer,children:t&&e?.flatMap(e=>{const i=t[e],n=Boolean(i.availabilityResale)&&!pe,a=n&&!i.isSoldOut&&!fe,r=[(0,N.Y)(Ut,{gift:i,observeIntersection:Se,isResale:n&&!a,onClick:De},e)];return a&&r.push((0,N.Y)(Ut,{isResale:!0,gift:i,observeIntersection:Se,onClick:De},`resale_${e}`)),r})})}()})]})]}),Ce&&I&&(0,N.Y)(Vt,{onGiftClick:De}),Ie&&J?.forPeerId&&(0,N.Y)(Bt,{gift:$,giftByStars:ve.get($),peerId:J.forPeerId})]})]});var Ke}));const ii=(0,n.ph)((0,a.EK)(e=>{const{currentUserId:t}=e;return{currentUserId:t,userIds:e.contactList?.userIds}})(({modal:e,currentUserId:t,userIds:i})=>{const{closeGiftRecipientPicker:s,openGiftModal:l}=(0,a.ko)(),c=(0,m.A)(),d=e,[f,p]=(0,n.J0)(""),h=(0,n.Kr)(()=>{const e=(0,a.mS)(),n=i?i.concat(t):void 0,s=n?(0,r.PU)({ids:n,query:f}):[];return(0,y.A)((0,I.Am)(s).filter(t=>(0,o.X2D)(e,t)),void 0,[t])},[t,f,i]),A=(0,u.A)(e=>{l({forUserId:e}),s()});return(0,N.Y)(Y.A,{className:"W3JMs1YE",isOpen:d,onClose:s,title:c("GiftTelegramPremiumOrStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,children:(0,N.Y)(k.A,{className:"wOipz1Y_",itemIds:h,filterValue:f,filterPlaceholder:c("Search"),onSelectedIdChange:A,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,forceShowSelf:!0})})}));var ni=i(79089),ai=i(18501);function ri({originalDetails:e,recipient:t,sender:i,onOpenChat:n,lang:a}){const{recipientId:o,senderId:s,date:l,message:c}=e,d=(0,z.L2)(1e3*l,a.code,!0),u=(0,N.Y)(vt.A,{onClick:()=>n(o),isPrimary:!0,children:(0,r.F9)(a,t)});if(!i||s===o)return c?a("GiftInfoPeerOriginalInfoText",{peer:u,text:(0,ai.fd)(c),date:d},{withNodes:!0}):a("GiftInfoPeerOriginalInfo",{peer:u,date:d},{withNodes:!0});const m=(0,N.Y)(vt.A,{onClick:()=>n(i.id),isPrimary:!0,children:(0,r.F9)(a,i)});return c?a("GiftInfoPeerOriginalInfoTextSender",{peer:u,sender:m,text:(0,ai.fd)(c),date:d},{withNodes:!0}):a("GiftInfoPeerOriginalInfoSender",{peer:u,date:d,sender:m},{withNodes:!0})}var oi=i(25404);const si={root:"Ef0cKSqQ",giftPreview:"IvuNzslN",backdrop:"dNukis4X",arrow:"oufsMLLF"},li=4*P.$,ci=3*P.$,di=(0,n.ph)(({peer:e,gift:t})=>{const i=(0,n.Kr)(()=>(0,X.uc)(t),[t]);if(i)return(0,N.FD)("div",{className:si.root,children:[(0,N.FD)("div",{className:si.giftPreview,children:[(0,N.Y)(te.A,{className:si.backdrop,backgroundColors:[i.backdrop.centerColor,i.backdrop.edgeColor],patternIcon:i.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,N.Y)(ee.A,{className:si.sticker,size:ci,sticker:i.model?.sticker})]}),(0,N.Y)(F.A,{name:"next",className:si.arrow}),(0,N.Y)(f.A,{peer:e,size:li,className:si.avatar})]})});var ui=i(94189);const mi={modal:"nnublcCk",checkBox:"fjE0wGvw",checkBoxDescription:"tepUTe4z",upgradeIcon:"lgyInH5K",descriptionConfirm:"BJh2Tufh",titleConfirm:"gA102W1G",header:"p7FTs7_p",title:"pIbzzTir",description:"CCPfr26t",warningDescription:"eEsRJVa1",modalContent:"o9rFZ6By",moreMenuButton:"EMwExRMy",closeButton:"jQv0ZSEW",giftResalePriceContainer:"BN8gf5y6",starAmountIcon:"_5guecUe",giftResalePriceStar:"H_q8o2vY",headerButton:"WA0INleU",left:"aOhTHZlf",right:"rJOB1u5Q",footer:"bho0GTYt",footerDescription:"VUylTszM",footerHint:"mxS8kDnA",buyButton:"i1MmnrPG",unknown:"zDauXmpS",giftValue:"w_E4LkUj",uniqueValue:"uAjIRJva",uniqueAttribute:"OJQnkf17",attributeName:"dq7wCHJb",uniqueGift:"I6o_pGAm",modalHeader:"ie9tImaj",modalCloseButton:"p38RBGdC",ownerAddress:"DavMRg4Q",copyIcon:"SLX5tX8C",messageContainer:"oW5T3mkV",removeMessageButton:"TrW2LVm5"},fi=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const i=t?.gift,n=i&&"gift"in i,a=e.currentUserId,s=n&&i.fromId,l=s?(0,o.PVB)(e,s):void 0,c=t?.peerId?(0,o.PVB)(e,t.peerId):void 0,d=c&&(0,r.vj)(c)?c:void 0,u=d&&(0,C.ub)(d,"postMessages"),m=(0,o.mBe)(e,a),f=t?.recipientId&&a!==t.recipientId?(0,o.PVB)(e,t.recipientId):void 0,p=m?.emojiStatus,h=e.collectibleEmojiStatuses?.statuses,A=n?i.gift:i,g="starGiftUnique"===A?.type&&A.releasedByPeerId;return{fromPeer:l,targetPeer:c,releasedByPeer:g?(0,o.PVB)(e,g):void 0,currentUserId:a,starGiftMaxConvertPeriod:e.appConfig.starGiftMaxConvertPeriod,tonExplorerUrl:e.appConfig.tonExplorerUrl,hasAdminRights:u,currentUserEmojiStatus:p,collectibleEmojiStatuses:h,currentUser:m,recipientPeer:f}})(({modal:e,fromPeer:t,targetPeer:i,releasedByPeer:c,currentUserId:h,starGiftMaxConvertPeriod:A,hasAdminRights:g,currentUserEmojiStatus:b,collectibleEmojiStatuses:v,tonExplorerUrl:G,currentUser:C,recipientPeer:I})=>{const{closeGiftInfoModal:y,changeGiftVisibility:k,convertGiftToStars:Y,openChatWithInfo:B,focusMessage:w,openGiftUpgradeModal:D,showNotification:P,buyStarGift:R,closeGiftModal:x,openGiftInfoValueModal:L,updateResaleGiftsFilter:O,openGiftInMarket:K,openGiftDescriptionRemoveModal:E}=(0,a.ko)(),[q,H,J]=(0,T.A)(),j=(0,M.A)(),_=(0,m.A)(),[$,Z]=(0,n.J0)(!1),[te,ie]=(0,n.J0)(!1),ne=(0,n.li)(),ae=(0,u.A)(()=>{ve&&Xe?.pattern&&(K({gift:ve}),O({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[],patternAttributes:[{type:"pattern",documentId:Xe.pattern.sticker.id}]}}))}),re=(0,u.A)(()=>{ve&&Xe?.backdrop&&(K({gift:ve}),O({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[{type:"backdrop",backdropId:Xe.backdrop.backdropId}],patternAttributes:[]}}))}),oe=(0,u.A)(()=>{ve&&Xe?.model&&(K({gift:ve}),O({filter:{sortType:"byDate",modelAttributes:[{type:"model",documentId:Xe.model.sticker.id}],backdropAttributes:[],patternAttributes:[]}}))}),se=Boolean(e),le=(0,d.A)(e),ce=(0,d.A)(t),de=(0,d.A)(i),ue=de&&(0,r.vj)(de),{gift:me}=le||{},fe=me&&"gift"in me,he=fe?me:void 0,Ae=he?.fromId===h,ge=he&&A&&he.date+A-(0,Ye.Fm)()||0,be=Math.ceil(ge/60/60/24),ve=fe?me.gift:me,Ge=ve&&(0,X.yQ)(ve),Ce=ge>0&&Boolean(he?.starsToConvert),Ie=ve&&"starGiftUnique"===ve.type,ye=Ie?ve:void 0,ke=(0,n.Kr)(()=>{if(ve&&"starGiftUnique"===ve.type){if(c){const e=`@${(0,ni.Kl)(c)}`||(0,r.F9)(j,c),t=(0,r.mO)(c)?j("ActionFallbackUser"):j("ActionFallbackChannel");return j("GiftInfoCollectibleBy",{number:ve.number,owner:e||t},{withNodes:!0,withMarkdown:!0})}return j("GiftInfoCollectible",{number:ve.number})}},[ve,c,j]),Be="starGiftUnique"===ve?.type?ve.slug:void 0,we=(0,n.Kr)(()=>{if(Be)return v?.find(e=>"collectible"===e.type&&e.slug===Be)},[Be,v]),De=Boolean(we),Pe=Boolean(he?.upgradeMsgId),Te=!Pe&&he?.inputGift&&(ue?g:"starGift"===ve?.type?de?.id===h:ve?.ownerId===h||De);function Fe(e){if(!Ie)return;const t=ve.resellPrice;return t?ve?.resaleTonOnly||e?t.find(e=>e.currency===S.ykW):t.find(e=>e.currency===S.OUy):void 0}const Ue=Fe(),Re=Fe(te),xe=Ue?.currency===S.ykW&&Ie?ve.resellPrice?.find(e=>e.currency===S.OUy):void 0,Le=!De&&"starGiftUnique"===ve?.type&&ve.ownerId!==h&&Boolean(Ue),Oe=(()=>{if(!Ie)return;const{ownerName:e,ownerId:t}=ve,i=(0,a.mS)(),n=t?(0,o.PVB)(i,t):void 0;return n?(0,r.F9)(j,n):e})(),Ke=(0,u.A)(()=>{y()}),Ve=(0,u.A)(()=>{const e=Ae?de:ce;if(!he?.upgradeMsgId||!e)return;const{upgradeMsgId:t}=he;w({chatId:e.id,messageId:t}),Ke()}),Ee=(0,u.A)(()=>{const{inputGift:e,isUnsaved:t}=he;k({gift:e,shouldUnsave:!t}),Ke()}),He=(0,u.A)(()=>{const{inputGift:e}=he;Y({gift:e}),J(),Ke()}),ze=(0,u.A)(()=>{if(!(he?.inputGift&&he.dropOriginalDetailsStars&&ve&&Xe))return;const{originalDetails:e}=Xe;e&&E({gift:he,price:he.dropOriginalDetailsStars,details:e})}),We=(0,u.A)(()=>{if(!he)return;const e=de?.id;D({giftId:he.gift.id,gift:he,peerId:e})}),Je=(0,u.A)(()=>{"starGiftUnique"===ve?.type&&Fe()&&Z(!0)}),je=(0,u.A)(()=>{Z(!1)}),_e=(0,u.A)(()=>{const e=I||C,t=Fe(te);e&&t&&"starGiftUnique"===ve?.type&&(je(),x(),R({peerId:e.id,slug:ve.slug,price:t}))}),Qe=(0,u.A)(()=>{ve&&"starGiftUnique"===ve.type&&L({gift:ve})}),Xe=(0,n.Kr)(()=>ve&&(0,X.uc)(ve),[ve]),$e=(0,u.A)(()=>Le?(0,N.FD)(U.A,{className:mi.buyButton,onClick:Je,children:[(0,N.Y)("div",{children:j("ButtonBuyGift",{stars:Ue?.currency===S.ykW?(0,pe.Ms)(j,Ue.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ue?.amount,{asFont:!0})},{withNodes:!0})}),Ue?.currency===S.ykW&&Boolean(xe)&&(0,N.Y)("div",{className:mi.footerHint,children:j("GiftBuyEqualsTo",{stars:(0,pe.U2)(j,xe.amount,{asFont:!0})},{withNodes:!0})})]}):Pe?(0,N.Y)(U.A,{onClick:Ve,children:j("GiftInfoViewUpgraded")}):Te&&he?.alreadyPaidUpgradeStars&&!he.upgradeMsgId?(0,N.Y)(U.A,{isShiny:!0,onClick:We,iconName:"arrow-down-circle",iconClassName:mi.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgradeForFree")}):Te&&he?.canUpgrade&&!he.upgradeMsgId?(0,N.Y)(U.A,{isShiny:!0,onClick:We,iconName:"arrow-down-circle",iconClassName:mi.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgrade")}):he?.prepaidUpgradeHash?(0,N.Y)(U.A,{isShiny:!0,onClick:We,iconName:"arrow-down-circle",iconClassName:mi.upgradeIcon,iconAlignment:"end",children:j("GiftAnUpgradeButton")}):(0,N.Y)(U.A,{onClick:Ke,children:j("OK")})),Ze=(0,n.Kr)(()=>{if(!ve)return;let e="";return"starGift"===ve.type&&(ve.firstSaleDate&&(e+=`${j("GiftInfoFirstSale")} ${(0,z.L2)(1e3*ve.firstSaleDate,j.code,!0)}`),ve.lastSaleDate&&(e+="\n",e+=`${j("GiftInfoLastSale")} ${(0,z.L2)(1e3*ve.lastSaleDate,j.code,!0)}`)),e},[ve,j]),et=(0,n.Kr)(()=>{if(!me||!ve)return;const{fromId:e,isNameHidden:t,starsToConvert:i,isUnsaved:n,isConverted:d,upgradeMsgId:u}=he||{},m=Ce&&Boolean(i),h=t&&de,A=he?.isRefunded||!he&&"starGift"===ve?.type,g=(()=>{if(!he)return j("GiftInfoSoldOutDescription");if(!ue){if(he.isRefunded)return j("GiftInfoDescriptionRefunded");if(he.upgradeMsgId)return j("GiftInfoDescriptionUpgraded");if(Te&&he.canUpgrade&&he.alreadyPaidUpgradeStars&&!he.upgradeMsgId)return j("GiftInfoDescriptionUpgrade2");if(he.canUpgrade&&Te)return Te?j("GiftInfoDescriptionFreeUpgrade"):j("GiftInfoPeerDescriptionFreeUpgradeOut",{peer:(0,r.F9)(j,de)});if(Te||Ae)return d&&m?Te?j("GiftInfoDescriptionConverted",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoPeerDescriptionOutConverted",{amount:i,peer:(0,r.F9)(j,de)},{pluralValue:i,withNodes:!0,withMarkdown:!0}):he.canUpgrade&&Te?m?j("GiftInfoDescriptionUpgrade",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoDescriptionUpgradeRegular"):Te?m?j("GiftInfoDescription",{amount:i},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoDescriptionRegular"):m?j("GiftInfoPeerDescriptionOut",{amount:i,peer:(0,r.F9)(j,de)},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoPeerDescriptionOutRegular",{peer:(0,r.F9)(j,de)})}})(),b=(0,N.FD)("div",{className:mi.modalHeader,children:[(0,N.Y)(U.A,{className:mi.closeButton,round:!0,color:"translucent-white",size:"tiny",iconName:"close",ariaLabel:j("Close"),onClick:Ke}),Boolean(Ue?.amount)&&(0,N.Y)("div",{className:mi.giftResalePriceContainer,children:Ue.currency===S.ykW?(0,pe.Ms)(j,Ue.amount,{className:mi.giftResalePriceStar,shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ue.amount,{asFont:!0,className:mi.giftResalePriceStar})})]}),v=Ie&&(0,N.Y)("div",{ref:ne,className:(0,s.A)(mi.header,mi.uniqueGift),children:(0,N.Y)(Me,{backdropAttribute:Xe.backdrop,patternAttribute:Xe.pattern,modelAttribute:Xe.model,title:ve.title,subtitle:ke,subtitlePeer:c,showManageButtons:Te,savedGift:he})}),C=(0,N.FD)("div",{className:mi.header,children:[(0,N.Y)(ee.A,{className:mi.giftSticker,sticker:Ge,size:120}),(0,N.Y)("h1",{className:mi.title,children:Ie?ve.title:j(he?Te?"GiftInfoReceived":"GiftInfoTitle":"GiftInfoSoldOutTitle")}),Boolean(g)&&(0,N.Y)("p",{className:(0,s.A)(mi.description,A&&mi.warningDescription),children:g})]}),I=[];if("starGift"===ve.type){(e||t)&&I.push([j("GiftInfoFrom"),e?{chatId:e}:(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:"small",peer:Q.I5}),(0,N.Y)("span",{className:mi.unknown,children:_(Q.I5.titleKey)})]})]),he?.date&&I.push([j("GiftInfoDate"),(0,N.Y)("span",{title:Ze,children:(0,z.L2)(1e3*he.date,j.code,!0)})]),ve.firstSaleDate&&!he&&I.push([j("GiftInfoFirstSale"),(0,z.L2)(1e3*ve.firstSaleDate,j.code,!0)]),ve.lastSaleDate&&!he&&I.push([j("GiftInfoLastSale"),(0,z.L2)(1e3*ve.lastSaleDate,j.code,!0)]);const n=ve.stars+(he?.alreadyPaidUpgradeStars||0);I.push([j("GiftInfoValue"),(0,N.FD)("div",{className:mi.giftValue,children:[(0,pe.U2)(j,n,{className:mi.starAmountIcon}),Te&&Ce&&Boolean(i)&&(0,N.Y)(V.A,{onClick:H,children:j("GiftInfoConvert",{amount:i},{pluralValue:i})})]})]),ve.availabilityTotal&&I.push([j("GiftInfoAvailability"),j("GiftInfoAvailabilityValue",{count:ve.availabilityRemains||0,total:ve.availabilityTotal},{pluralValue:ve.availabilityRemains||0})]),ve.upgradeStars&&!u&&I.push([j("GiftInfoStatus"),(0,N.Y)("div",{className:mi.giftValue,children:j("GiftInfoStatusNonUnique")})]),he?.message&&I.push([void 0,(0,ai.fd)(he.message)])}if(Ie){const{ownerName:e,ownerAddress:t,ownerId:i}=ve,n=i?(0,o.PVB)((0,a.mS)(),i):void 0,{model:r,backdrop:s,pattern:c,originalDetails:d}=Xe||{};if(t?I.push([j("GiftInfoOwner"),(0,N.FD)("span",{className:mi.ownerAddress,onClick:()=>{(0,Ne.eM)(t),P({message:{key:"WalletAddressCopied"},icon:"copy"})},children:[t,(0,N.Y)(F.A,{className:mi.copyIcon,name:"copy"})]})]):(n||e)&&I.push([j("GiftInfoOwner"),i?{chatId:i,withEmojiStatus:!0}:e||""]),r&&I.push([j("GiftAttributeModel"),(0,N.FD)("span",{className:mi.uniqueAttribute,children:[(0,N.Y)("span",{className:mi.attributeName,onClick:oe,children:r.name}),(0,N.Y)(V.A,{children:(0,W.l9)(r.rarityPercent)})]})]),s&&I.push([j("GiftAttributeBackdrop"),(0,N.FD)("span",{className:mi.uniqueAttribute,children:[(0,N.Y)("span",{className:mi.attributeName,onClick:re,children:s.name}),(0,N.Y)(V.A,{children:(0,W.l9)(s.rarityPercent)})]})]),c&&I.push([j("GiftAttributeSymbol"),(0,N.FD)("span",{className:mi.uniqueAttribute,children:[(0,N.Y)("span",{className:mi.attributeName,onClick:ae,children:c.name}),(0,N.Y)(V.A,{children:(0,W.l9)(c.rarityPercent)})]})]),I.push([j("GiftInfoAvailability"),j("GiftInfoIssued",{issued:ve.issuedCount,total:ve.totalCount})]),ve.valueAmount&&ve.valueCurrency){const e=(0,l.Ad)(ve.valueAmount,ve.valueCurrency,j.code);I.push([j("GiftInfoValue"),(0,N.FD)("span",{className:mi.uniqueValue,children:[j("GiftInfoValueAmount",{amount:e}),(0,N.Y)(V.A,{onClick:Qe,children:j("GiftInfoValueLinkMore")})]})])}if(d){const{recipientId:e,senderId:t}=d,i=(0,a.mS)(),n=e=>{B({id:e}),y()},r=ri({originalDetails:d,recipient:(0,o.PVB)(i,e),sender:t?(0,o.PVB)(i,t):void 0,onOpenChat:n,lang:j});I.push([void 0,(0,N.FD)("div",{className:mi.messageContainer,children:[(0,N.Y)("div",{children:r}),Boolean(he?.dropOriginalDetailsStars)&&(0,N.Y)(U.A,{round:!0,className:mi.removeMessageButton,size:"smaller",color:"translucent",ariaLabel:"Delete original details",onClick:ze,iconName:"delete"})]})])}}const k=G&&Ie&&ve.giftAddress&&`${G}${ve.giftAddress}`,Y=(0,N.FD)("div",{className:mi.footer,children:[(Te||k||Le)&&(0,N.FD)("div",{className:mi.footerDescription,children:[k&&(0,N.Y)("div",{children:j("GiftInfoTonText",{link:(0,N.Y)(p.A,{url:k,shouldSkipModal:!0,text:j("GiftInfoTonLinkText")})},{withNodes:!0})}),Te&&(0,N.Y)("div",{children:j(`GiftInfo${ue?"Channel":""}${n?"Hidden":"Saved"}`,{link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:Ee,children:j("GiftInfoSaved"+(n?"Show":"Hide"))})},{withNodes:!0})}),!Le&&h&&(0,N.Y)("div",{children:j("GiftInfoSenderHidden")}),Le&&Oe&&(0,N.Y)("div",{children:j("GiftInfoBuyGift",{user:Oe},{withNodes:!0})})]}),$e()]});return{modalHeader:Ie?b:void 0,header:Ie?v:C,tableData:I,footer:Y}},[me,he,de,Ge,j,Te,Ce,Ae,_,G,ve,Xe,$e,ue,Ie,Ze,Le,Oe,Ue,ke,c,ae,re,oe]),tt=me&&(0,N.Y)(oi.A,{peerId:le.peerId,gift:me,canManage:Te,collectibleEmojiStatuses:v,currentUserEmojiStatus:b});return(0,N.FD)(N.FK,{children:[(0,N.Y)(Se.A,{isOpen:se,modalHeader:et?.modalHeader,header:et?.header,hasBackdrop:Ie,tableData:et?.tableData,footer:et?.footer,className:mi.modal,contentClassName:mi.modalContent,closeButtonColor:Ie?"translucent-white":void 0,moreMenuItems:tt,onClose:Ke,withBalanceBar:Boolean(Le),currencyInBalanceBar:Re?.currency,isLowStackPriority:!0}),ye&&C&&Boolean(Re)&&(0,N.FD)(ui.A,{isOpen:$,noDefaultTitle:!0,onClose:je,confirmLabel:j("ButtonBuyGift",{stars:Re?.currency===S.ykW?(0,pe.Ms)(j,Re.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,Re.amount,{asFont:!0})},{withNodes:!0}),confirmHandler:_e,children:[ye.resaleTonOnly&&(0,N.Y)("div",{className:mi.descriptionConfirm,children:j("ConfirmBuyGiftForTonDescription")}),(0,N.Y)(di,{peer:I||C,gift:ye}),(0,N.Y)("div",{className:mi.titleConfirm,children:j("TitleConfirmPayment")}),!I&&(0,N.Y)("p",{children:j("GiftBuyConfirmDescription",{gift:j("GiftUnique",{title:ye.title,number:ye.number}),stars:Re?.currency===S.ykW?(0,pe.QH)(j,Re.amount,!0):(0,pe.Kk)(j,Re.amount)},{withNodes:!0,withMarkdown:!0})}),I&&(0,N.Y)("p",{children:j("GiftBuyForPeerConfirmDescription",{gift:j("GiftUnique",{title:ye.title,number:ye.number}),stars:Re?.currency===S.ykW?(0,pe.QH)(j,Re.amount,!0):(0,pe.Kk)(j,Re.amount),peer:(0,r.F9)(j,I)},{withNodes:!0,withMarkdown:!0})}),!ye.resaleTonOnly&&(0,N.FD)(N.FK,{children:[(0,N.Y)(qe.A,{className:mi.checkBox,label:j("LabelPayInTON"),checked:te,onCheck:ie}),(0,N.Y)("div",{className:mi.checkBoxDescription,children:j("DescriptionPayInTON")})]})]}),he&&(0,N.FD)(ui.A,{isOpen:q,onClose:J,confirmHandler:He,title:j("GiftInfoConvertTitle"),children:[(0,N.Y)("div",{children:j("GiftInfoPeerConvertDescription",{amount:(0,pe.Kk)(j,he.starsToConvert),peer:(0,r.F9)(j,ce)},{withNodes:!0,withMarkdown:!0})}),Ce&&(0,N.Y)("div",{children:j("GiftInfoConvertDescriptionPeriod",{count:be},{withNodes:!0,withMarkdown:!0,pluralValue:be})}),(0,N.Y)("div",{children:j("GiftInfoConvertDescription2")})]})]})})),pi="hspYTy7V",hi=(0,n.ph)(({modal:e})=>{const{closeGiftInfoValueModal:t,openUrl:i,openGiftInMarket:r}=(0,a.ko)(),o=(0,M.A)(),s=Boolean(e),c=(0,d.A)(e),m=(0,u.A)(()=>{e?.valueInfo.fragmentListedUrl&&i({url:e.valueInfo.fragmentListedUrl})}),f=(0,u.A)(()=>{e?.gift&&r({gift:e.gift})}),p=(0,n.Kr)(()=>{if(!c)return;const{gift:e,valueInfo:t}=c,i=(0,X.uc)(e);if(!i)return;const n=(0,N.FD)("div",{className:"v4GJBsdC",children:[(0,N.Y)(ee.A,{className:"lJodRD0R",sticker:i.model.sticker,size:120}),(0,N.Y)(U.A,{pill:!0,size:"tiny",fluid:!0,nonInteractive:!0,children:(0,l.Ad)(t.value,t.currency,o.code)}),(0,N.Y)("div",{className:"VjWaO8un",children:o("GiftValueDescription",{giftName:e.title},{withMarkdown:!0,withNodes:!0})})]}),a=[];a.push([o("GiftValueTitleInitialSale"),(0,z.A)(1e3*t.initialSaleDate,o.code)]),a.push([o("GiftValueTitleInitialPrice"),(0,N.FD)("span",{className:"K7zsAhVt",children:[(0,pe.U2)(o,t.initialSaleStars,{className:"Xw91xwpe"})," (~ ",(0,l.Ad)(t.initialSalePrice,t.currency,o.code),")"]})]),t.lastSaleDate&&a.push([o("GiftValueTitleLastSale"),(0,z.A)(1e3*t.lastSaleDate,o.code)]),t.lastSalePrice&&a.push([o("GiftValueTitleLastPrice"),(0,l.Ad)(t.lastSalePrice,t.currency,o.code)]),t.floorPrice&&a.push([o("GiftValueTitleMinimumPrice"),(0,l.Ad)(t.floorPrice,t.currency,o.code)]),t.averagePrice&&a.push([o("GiftValueTitleAveragePrice"),(0,l.Ad)(t.averagePrice,t.currency,o.code)]);const r=Boolean(t.fragmentListedUrl&&t.fragmentListedCount),s=Boolean(t.listedCount&&t.listedCount);return{header:n,tableData:a,footer:(r||s)&&(0,N.FD)("div",{className:"OJDo2xUd",children:[r&&(0,N.FD)(U.A,{isText:!0,onClick:m,noForcedUpperCase:!0,size:"tiny",children:[o.number(t.fragmentListedCount),(0,N.Y)(ee.A,{className:pi,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnFragment")]}),s&&(0,N.FD)(U.A,{isText:!0,noForcedUpperCase:!0,size:"tiny",onClick:f,children:[o.number(t.listedCount),(0,N.Y)(ee.A,{className:pi,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnTelegram")]})]})}},[o,c,m,f]);if(p)return(0,N.Y)(Se.A,{isOpen:s,onClose:t,header:p.header,tableData:p.tableData,footer:p.footer})}),Ai=(0,n.ph)(({modal:e})=>{const{closeLockedGiftModal:t}=(0,a.ko)(),i=(0,M.A)(),r=(0,u.A)(()=>{t()}),o=(0,n.hb)(()=>{if(!e)return"";if(e.untilDate){const t=e.untilDate?e.untilDate-(0,Ye.Fm)():0;return i("GiftLockedMessage",{relativeDate:(0,z.A$)(i,t)},{withNodes:!0,withMarkdown:!0})}return e.reason?(0,ai.fd)(e.reason):i("TitleGiftLocked")},[e,i]);return(0,N.FD)(h.A,{isOpen:Boolean(e),className:"narrow",onClose:r,title:i("TitleGiftLocked"),headerClassName:"AqB1qB8W",children:[(0,N.Y)("p",{className:"pA8Bz4TW",children:o()}),(0,N.Y)(U.A,{onClick:r,children:i("OK")})]})});var gi=i(40664);const bi=(0,n.ph)((0,a.EK)(e=>{const t=(0,o.h9Q)(e),i=e.appConfig.starsStargiftResaleAmountMin||0,n=e.appConfig.starsStargiftResaleAmountMax,a=e.appConfig.starsUsdWithdrawRateX1000,r=a?a/1e3:1,s=(0,o.Bde)(e),c=(0,l.wD)(e.appConfig.tonStargiftResaleAmountMin||0),d=e.appConfig.tonStargiftResaleAmountMax;return{starsCommission:t,starsResaleAmountMin:i,starsResaleAmountMax:n,starsUsdWithdrawRate:r,tonCommission:s,tonResaleAmountMin:c,tonResaleAmountMax:d?(0,l.wD)(d):void 0,tonUsdRate:e.appConfig.tonUsdRate}})(({modal:e,starsCommission:t,starsResaleAmountMin:i,starsResaleAmountMax:r,starsUsdWithdrawRate:o,tonCommission:s,tonResaleAmountMin:c,tonResaleAmountMax:m,tonUsdRate:f})=>{const{closeGiftResalePriceComposerModal:p,closeGiftInfoModal:A,updateStarGiftPrice:g,showNotification:b}=(0,a.ko)(),v=Boolean(e),[G,S]=(0,n.J0)(void 0),[C,I]=(0,n.J0)(!1),y=(0,d.A)(e),{gift:k}=y||{},Y=k&&"gift"in k?k:void 0,B=Boolean(G),w=(0,M.A)(),D=(0,u.A)(e=>{const t=e.target.value,i=parseFloat(t),n=C?m:r,a=""===t||Number.isNaN(i)?void 0:n?Math.min(i,n):i;S(a)}),P=(0,u.A)(()=>{p()}),T=(0,u.A)(()=>{Y&&"starGiftUnique"===Y.gift.type&&Y.inputGift&&G&&(p(),A(),g({gift:Y.inputGift,price:{currency:C?"TON":"XTR",amount:C?(0,l.tT)(G):G,nanos:0}}),b({icon:"sell-outline",message:{key:"NotificationGiftIsSale",variables:{gift:w("GiftUnique",{title:Y.gift.title,number:Y.gift.number})}}}))}),F=C?s:t,R=C?c:i,x=B&&G>=R;return(0,N.FD)(h.A,{isOpen:v,title:w(C?"PriceInTON":"PriceInStars"),hasCloseButton:!0,isSlim:!0,onClose:P,children:[(0,N.Y)("div",{className:"ElDo1Bru",children:(0,N.Y)(gi.A,{label:w(C?"EnterPriceInTon":"EnterPriceInStars"),onChange:D,value:G?.toString(),inputMode:"numeric",tabIndex:0,teactExperimentControlled:!C})}),(0,N.FD)("div",{className:"SGFmA4kL",children:[(0,N.FD)("span",{children:[!x&&Boolean(F)&&w("DescriptionComposerGiftMinimumPrice",{stars:C?(0,pe.QH)(w,R):(0,pe.Kk)(w,R)},{withMarkdown:!0,withNodes:!0}),x&&(()=>{const e=F?Number((G*F).toFixed()):G;return w("DescriptionComposerGiftResalePrice",{stars:C?(0,pe.QH)(w,e):(0,pe.Kk)(w,e)},{withMarkdown:!0,withNodes:!0})})()]}),x&&Boolean(C?f:o)&&(0,N.Y)("span",{className:"r9R0VR_w",children:`≈ ${(0,l.Ad)(C?(0,l.C)(G,f):G*o,"USD",w.code)}`})]}),(0,N.Y)(qe.A,{className:"yt_nODdj",label:w("OnlyAcceptTON"),checked:C,onCheck:I}),(0,N.Y)("div",{className:"pWjQiY4m",children:w("OnlyAcceptTONDescription")}),(0,N.FD)(U.A,{noForcedUpperCase:!0,disabled:!x,onClick:T,children:[x&&w("ButtonSellGift",{stars:C?(0,pe.Ms)(w,G):(0,pe.U2)(w,G,{asFont:!0})},{withNodes:!0}),!x&&w("Sell")]})]})}));var vi=i(32625),Ni=i(5463);const Gi={footer:"EWaVCxY4",footerButton:"_Dt6RSQV",link:"Xu0TqkRj",priceDecreaseTimer:"ryB8xKvy"},Si=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const i=t?.recipientId;return{recipient:i?(0,o.PVB)(e,i):void 0}})(({modal:e,recipient:t})=>{const{closeGiftUpgradeModal:i,closeGiftInfoModal:o,upgradeGift:s,upgradePrepaidGift:l,openStarGiftPriceDecreaseInfoModal:c,shiftGiftUpgradeNextPrice:m}=(0,a.ko)(),f=Boolean(e),p=(0,d.A)(e),h=(0,d.A)(t),[A,g]=(0,n.J0)(!1),b=Boolean(p?.gift?.prepaidUpgradeHash),[v,G]=(0,n.J0)(),S=(0,M.A)(),C=(0,u.A)(()=>i()),I=(0,u.A)(()=>{m()}),y=p?.nextPrices?.[0],k=y?.date,Y=p?.currentUpgradeStars,B=(0,u.A)(()=>{const e=p?.gift;if(e){if(b&&e.prepaidUpgradeHash&&h){if(!Y)return;return l({peerId:h.id,hash:e.prepaidUpgradeHash,stars:Y}),C(),void o()}e?.inputGift&&(s({gift:e.inputGift,shouldKeepOriginalDetails:A,upgradeStars:e.alreadyPaidUpgradeStars?void 0:Y}),C())}}),w=(0,u.A)(()=>{p?.sampleAttributes&&G((0,X.HM)(p.sampleAttributes,v))}),D=(0,u.A)(()=>{p?.prices&&c({prices:p.prices,currentPrice:Y||0,minPrice:p.minPrice||0,maxPrice:p.maxPrice||0})});(0,vi.A)(w,f?3e3:void 0,!0),(0,n.vJ)(()=>{f&&p?.sampleAttributes&&w()},[f,p?.sampleAttributes]),(0,n.vJ)(()=>{const e=p?.sampleAttributes;e&&(0,X.y8)(e)},[p?.sampleAttributes]);const P=(0,n.Kr)(()=>Y?(0,N.FD)("span",{children:[(0,N.Y)(F.A,{name:"star",className:"star-amount-icon"}),(0,N.Y)(je.A,{text:S.number(Y)})]}):void 0,[S,Y]),T=(0,n.Kr)(()=>{if(!v||!f)return;const e=p?.gift,t=h?(0,r.F9)(S,h):S("ActionFallbackUser"),i=h?[["diamond",S("GiftUpgradeUniqueTitle"),S("GiftPeerUpgradeUniqueDescription",{user:t})],["trade",S("GiftUpgradeTransferableTitle"),S("GiftPeerUpgradeTransferableDescription",{user:t})],["auction",S("GiftUpgradeTradeableTitle"),S("GiftPeerUpgradeTradeableDescription",{user:t})]]:[["diamond",S("GiftUpgradeUniqueTitle"),S("GiftUpgradeUniqueDescription")],["trade",S("GiftUpgradeTransferableTitle"),S("GiftUpgradeTransferableDescription")],["auction",S("GiftUpgradeTradeableTitle"),S("GiftUpgradeTradeableDescription")]],n=h?S("GiftPeerUpgradeText",{peer:(0,r.F9)(S,h)}):S("GiftUpgradeTextOwn"),a=Boolean(k)&&Boolean(p?.prices?.length)&&!e?.alreadyPaidUpgradeStars;return{listItemData:i,header:(0,N.Y)(Me,{modelAttribute:v.model,backdropAttribute:v.backdrop,patternAttribute:v.pattern,title:S("GiftUpgradeTitle"),subtitle:n}),footer:(0,N.FD)("div",{className:Gi.footer,children:[!e&&(0,N.Y)(U.A,{className:Gi.footerButton,onClick:C,children:S("OK")}),e&&(0,N.FD)(N.FK,{children:[!b&&(0,N.Y)(qe.A,{label:S("GiftUpgradeKeepDetails"),onCheck:g,checked:A}),(0,N.Y)(U.A,{className:Gi.footerButton,isShiny:!0,onClick:B,children:(0,N.FD)("div",{className:Gi.buttonContent,children:[(0,N.Y)("div",{children:e.alreadyPaidUpgradeStars?S("GeneralConfirm"):S(b?"GiftPayForUpgradeButton":"GiftUpgradeButton",{amount:P},{withNodes:!0})}),a&&(0,N.Y)("div",{className:Gi.priceDecreaseTimer,children:S("StarGiftPriceDecreaseTimer",{timer:(0,N.Y)(Ct.A,{endsAt:k,onEnd:I})},{withNodes:!0})})]})}),a&&(0,N.Y)(vt.A,{className:Gi.link,isPrimary:!0,onClick:D,children:S("StarGiftPriceDecreaseInfoLink")})]})]})}},[v,f,S,h,p?.gift,A,b,p?.prices?.length,k,P]);return(0,N.Y)(Ni.A,{isOpen:f,header:T?.header,footer:T?.footer,listItemData:T?.listItemData,hasBackdrop:!0,onClose:C})})),Ci="GwhTY_Uw",Ii="H4JSQGvw",yi=48*ht.dp,ki=(0,n.ph)((0,a.EK)(e=>{const{giftAuctionModal:t}=(0,o.nTw)(e),i=t?.auctionGiftId;return{auctionState:i?e.giftAuctionByGiftId?.[i]:void 0}})(({modal:e,auctionState:t})=>{const{closeGiftAuctionModal:i,setGiftModalSelectedGift:r,openGiftAuctionInfoModal:o,openGiftAuctionAcquiredModal:s,openAboutStarGiftModal:l,showNotification:c,openChatWithDraft:m,openUrl:f,openGiftInMarket:p}=(0,a.ko)(),h=Boolean(e),A=(0,d.A)(e),g=(0,d.A)(t),b=g?.gift,v=g?.state,G=g?.userState,C="finished"===v?.type,[I,y]=(0,n.J0)(),k=Boolean(b&&v&&I),Y=(0,n.li)(),B=(0,M.A)(),w=(0,u.A)(()=>{A?.sampleAttributes&&y((0,X.HM)(A.sampleAttributes,I))});(0,vi.A)(w,h?3e3:void 0,!0),(0,n.vJ)(()=>{h&&(A?.sampleAttributes?w():y(void 0))},[h,A?.sampleAttributes]),(0,n.vJ)(()=>{const e=A?.sampleAttributes;e&&(0,X.y8)(e)},[A?.sampleAttributes]);const D=(0,u.A)(()=>i()),P=(0,u.A)(()=>{b&&o({auctionGiftId:b.id})}),T=(0,u.A)(()=>{l({})}),F=(0,u.A)(()=>{if(!b)return;const e=(0,X.yQ)(b);s({giftId:b.id,giftTitle:b.title,giftSticker:e})}),R=(0,u.A)(()=>{b&&(i({shouldKeepAuction:!0}),r({gift:b}))}),x=(0,n.Kr)(()=>{if(b?.auctionSlug)return`${S.jsp}auction/${b.auctionSlug}`},[b]),L=(0,u.A)(()=>{x&&((0,Ne.eM)(x),c({message:B("LinkCopied")}))}),O=(0,u.A)(()=>{x&&m({text:{text:x}})}),K=(0,u.A)(()=>{"finished"===v?.type&&v.fragmentListedUrl&&f({url:v.fragmentListedUrl})}),V=(0,u.A)(()=>{b&&(D(),p({gift:b}))}),E=(0,n.Kr)(()=>{if(!k)return;const e=b.title||B("StarGift"),t=B(C?"GiftAuctionEnded":"GiftAuctionInfoTitle"),i=(0,N.Y)(vt.A,{className:"xv_0WTej",isPrimary:!0,onClick:T,children:B("GiftAuctionLearnMoreAboutGifts")});return(0,N.Y)("div",{ref:Y,children:(0,N.Y)(Me,{modelAttribute:I.model,backdropAttribute:I.backdrop,patternAttribute:I.pattern,title:e,badge:t,subtitle:i})})},[k,b,C,B,I,T]),q=(0,n.Kr)(()=>{if(!b||!v||k)return;const e=b.title||B("StarGift"),t=b.giftsPerRound||0;return(0,N.FD)("div",{className:"lTDjKYuV",children:[(0,N.Y)(Ut,{gift:b,hideBadge:!0,noClickable:!0}),(0,N.Y)("h1",{className:"_tvAimMQ",children:e}),C?(0,N.Y)("span",{className:"pC_V4Juh",children:B("GiftAuctionEnded")}):(0,N.Y)("p",{className:"X88e7g62",children:B("GiftAuctionTopBidders",{count:t,gift:(0,N.Y)("span",{className:"AwBqE6Vc",children:e}),link:(0,N.Y)(vt.A,{isPrimary:!0,onClick:P,children:B("GiftAuctionLearnMore")})},{pluralValue:t,withNodes:!0,withMarkdown:!0})})]})},[b,v,k,C,B,P]),H=E||q,W=(0,n.Kr)(()=>{if(!b||!v||!G)return;const e=[];e.push([B("GiftAuctionStarted"),(0,z.L2)(1e3*v.startDate,B.code,!0)]),e.push([B("GiftAuctionEnds"),(0,z.L2)(1e3*v.endDate,B.code,!0)]),b.availabilityTotal&&e.push([B("GiftInfoAvailability"),B("GiftInfoAvailabilityValue",{count:b.availabilityRemains||0,total:B.number(b.availabilityTotal)},{pluralValue:b.availabilityRemains||0})]),"active"===v.type&&e.push([B("GiftAuctionCurrentRound"),B("GiftAuctionRoundValue",{current:B.number(v.currentRound),total:B.number(v.totalRounds)})]),C&&e.push([B("GiftAuctionAveragePrice"),(0,pe.U2)(B,v.averagePrice,{className:"Ui25Ac3P"})]);const t=G.acquiredCount,i=(0,X.yQ)(b),n=v.endDate-(0,Ye.Fm)(),a=n>0&&n<yi,r="finished"===v.type&&Boolean(v.fragmentListedUrl&&v.fragmentListedCount),o="finished"===v.type&&Boolean(v.listedCount);return{tableData:e,footer:(0,N.FD)("div",{className:"kVyu9ZRp",children:[t>0&&(0,N.Y)(vt.A,{className:Ci,isPrimary:!0,onClick:F,children:B("GiftAuctionItemsBought",{count:t,gift:i&&(0,N.Y)(ee.A,{className:Ii,sticker:i,size:20,play:!1})},{pluralValue:t,withNodes:!0})}),r&&(0,N.Y)(vt.A,{className:Ci,isPrimary:!0,onClick:K,children:B("GiftAuctionForSaleOnFragment",{count:i?(0,N.FD)(N.FK,{children:[B.number(v.fragmentListedCount),(0,N.Y)(ee.A,{className:Ii,sticker:i,size:20,play:!1})]}):B.number(v.fragmentListedCount)},{withNodes:!0})}),o&&(0,N.Y)(vt.A,{className:Ci,isPrimary:!0,onClick:V,children:B("GiftAuctionForSaleOnTelegram",{count:i?(0,N.FD)(N.FK,{children:[B.number(v.listedCount),(0,N.Y)(ee.A,{className:Ii,sticker:i,size:20,play:!1})]}):B.number(v.listedCount)},{withNodes:!0})}),(0,N.Y)(U.A,{noForcedUpperCase:!0,className:"QgTA5Tm_",onClick:C?D:R,children:C?B("OK"):(0,N.FD)("div",{children:[(0,N.Y)("div",{children:B("GiftAuctionJoin")}),n>0&&(0,N.Y)("div",{className:"XV66UlTa",children:B("GiftAuctionTimeLeft",{time:a?(0,N.Y)(Ct.A,{endsAt:v.endDate}):(0,z.zt)(B,n)},{withNodes:!0})})]})})]})}},[b,v,G,C,B,R,F,D,K,V]),J=(0,n.Kr)(()=>{if(k)return(0,N.FD)(N.FK,{children:[(0,N.Y)(ze.A,{icon:"info",onClick:P,children:B("GiftAuctionLearnMoreMenuItem")}),(0,N.Y)(ze.A,{icon:"link-badge",onClick:L,children:B("CopyLink")}),(0,N.Y)(ze.A,{icon:"forward",onClick:O,children:B("Share")})]})},[k,B,P,L,O]);return(0,N.Y)(Se.A,{isOpen:h,header:H,footer:W?.footer,tableData:W?.tableData,className:"rCVinZx6",contentClassName:"MAEILhFp",closeButtonColor:k?"translucent-white":void 0,moreMenuItems:J,onClose:D})})),Yi={content:"FbamIaWM",headerControlPanel:"oKcR_Gxv",slider:"lpcp8Oip",title:"jNHNh7KT",subtitle:"HlVun4XF",infoCards:"K9fWcZP0",infoCard:"QBcr61z8",infoCardValue:"S9vK5Tny",infoCardLabel:"UzCztm_V",separator:"eCFcDThE",winningStatus:"IENM5upL",bidderInfoSlide:"VvFvniw8",winningText:"mHlgX1Lm",winningBadge:"yWQ_64QE",section:"VfdOWkWu",sectionTitle:"aJxJv1Tj",sectionTitleTransition:"I344VxP8",bidderRow:"_6493YZ5",bidderPosition:"bjYqFB3Y",bidderInfo:"MSwHwQYX",bidderName:"StE9kpcQ",topBidderRow:"Q0o2Mlnj",topBidderPosition:"mQa4yF_w",bidderAmount:"jTHhbapk",buttonStar:"eY_4yHis",giftSticker:"ETmmzDXX",customBidInput:"KRqfUs0J",customBidInputIcon:"m1O8A6wT"},Bi=(0,n.ph)((0,a.EK)(e=>{const{stars:t,currentUserId:i}=e,{giftAuctionBidModal:n}=(0,o.nTw)(e),a=n?.auctionGiftId,r=a?e.giftAuctionByGiftId?.[a]:void 0,s=i?(0,o.PVB)(e,i):void 0,l="active"===r?.state.type?r.state.topBidders:void 0;return{auctionState:r,starBalance:t?.balance,currentUserPeer:s,topBidderIds:l}})(({modal:e,auctionState:t,starBalance:i,currentUserPeer:r,topBidderIds:s})=>{const{closeGiftAuctionBidModal:l,sendStarGiftAuctionBid:m,loadGiftAuction:p}=(0,a.ko)(),A=Boolean(e),g=(0,d.A)(t),b=(0,d.A)(s),v=(0,n.Kr)(()=>{if(!b)return;const e=(0,a.mS)();return b.map(t=>(0,o.PVB)(e,t)).filter(Boolean)},[b]),[G,S,C]=v||[],I=(0,ye.A)([G?.id||"0"]),y=(0,ye.A)([S?.id||"0"]),k=(0,ye.A)([C?.id||"0"]),Y=g?.gift.giftsPerRound||0,B=(0,M.A)(),w="active"===g?.state.type?g.state:void 0,D=g?.userState,[P,F]=(0,n.J0)(50),[R,x,O]=(0,T.A)(),[K,V]=(0,n.J0)(""),q=w?.minBidAmount||50,z=D?.minBidAmount||q,W=1e4*Math.ceil(z/1e4)+5e4;(0,n.vJ)(()=>{F(z)},[z]);const J=w?.nextRoundAt,j=D?.bidAmount?P-D.bidAmount:0,_=P>=W,Q=(0,n.Kr)(()=>_?B("GiftAuctionTapToBidMore"):j<=0?void 0:(0,N.FD)(N.FK,{children:["+",(0,N.Y)(je.A,{text:B.number(j)})]}),[j,_,B]),X=(0,u.A)(e=>{F(e)}),$=(0,u.A)(()=>{e?.auctionGiftId&&A&&p({giftId:e.auctionGiftId})}),Z=(0,u.A)(()=>{x()}),te=(0,u.A)(()=>{_&&Z()}),ie=(0,u.A)(e=>{const t=e.target.value.replace(/\D/g,"");Number(t)>1e9||V(t)}),ne=(0,u.A)(()=>{if(!g?.gift.id||!e)return;const t=Number(K);if(t<z)return;F(t),O(),V("");const{peerId:i,message:n,shouldHideName:a}=e,r=Boolean(D?.bidAmount);m({giftId:g.gift.id,bidAmount:t,peerId:i,message:n?{text:n}:void 0,shouldHideName:a,isUpdateBid:r})}),ae=(0,u.A)(()=>{if(!g?.gift.id||!e)return;const{peerId:t,message:i,shouldHideName:n}=e,a=Boolean(D?.bidAmount);m({giftId:g.gift.id,bidAmount:P,peerId:t,message:i?{text:i}:void 0,shouldHideName:n,isUpdateBid:a})}),re=(0,n.Kr)(()=>{if(!P||!w?.bidLevels?.length)return;const{bidLevels:e}=w,t=D?.bidDate||Number.MAX_SAFE_INTEGER;for(const i of e)if(i.amount<P||i.amount===P&&i.date>=t)return i.pos;return e[e.length-1].pos+1},[P,w,D?.bidDate]),oe=Boolean(D?.bidAmount&&re&&re<=Y);function se(e,t,i,n,a){return(0,N.FD)("div",{className:Yi.topBidderRow,children:[(0,N.Y)("div",{className:Yi.topBidderPosition,children:(0,c.A)(t,["emoji"])}),(0,N.Y)(L.Ay,{name:"fade",activeKey:a,className:Yi.bidderInfo,slideClassName:Yi.bidderInfoSlide,children:i&&(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{peer:i,size:"small"}),(0,N.Y)(Ee.A,{peer:i,className:Yi.bidderName})]})}),void 0!==n&&(0,N.FD)("div",{className:Yi.bidderAmount,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(n)]})]},e)}return(0,N.FD)(h.A,{isOpen:A,hasAbsoluteCloseButton:!0,isSlim:!0,contentClassName:Yi.content,onClose:l,isLowStackPriority:!0,children:[(0,N.Y)("div",{className:Yi.headerControlPanel,children:(0,N.Y)(H,{balance:i,className:Yi.modalBalance,withAddButton:!0})}),(0,N.Y)(lt,{className:Yi.slider,defaultValue:z,minValue:q,minAllowedValue:z,minAllowedProgress:.25,maxValue:W,floatingBadgeDescription:Q,onChange:X,onBadgeClick:te,onCustomValueClick:Z,shouldUseDynamicColor:!0,shouldAllowCustomValue:!0}),(0,N.Y)("h3",{className:Yi.title,children:B("GiftAuctionPlaceBid")}),(0,N.FD)("div",{className:Yi.infoCards,children:[(0,N.FD)("div",{className:Yi.infoCard,children:[(0,N.FD)("div",{className:Yi.infoCardValue,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(z)]}),(0,N.Y)("div",{className:Yi.infoCardLabel,children:B("GiftAuctionMinimumBid")})]}),(0,N.FD)("div",{className:Yi.infoCard,children:[(0,N.Y)("div",{className:Yi.infoCardValue,children:(0,N.Y)(Ct.A,{endsAt:J||0,shouldShowZeroOnEnd:!0,onEnd:$})}),(0,N.Y)("div",{className:Yi.infoCardLabel,children:B("GiftAuctionUntilNextRound")})]}),(0,N.FD)("div",{className:Yi.infoCard,children:[(0,N.FD)("div",{className:Yi.infoCardValue,children:[(0,N.Y)(ee.A,{noLoop:!1,className:Yi.giftSticker,sticker:g?.gift.sticker,size:24}),B.number(w?.giftsLeft||0)]}),(0,N.Y)("div",{className:Yi.infoCardLabel,children:B("GiftAuctionLeft")})]})]}),(0,N.FD)("div",{className:Yi.section,children:[function(){const e=g?.gift.title||B("StarGift"),t=re&&re<=100?(w?.lastGiftNum||0)+re:void 0;return(0,N.Y)(L.Ay,{name:"fade",activeKey:oe?0:1,className:Yi.sectionTitleTransition,slideClassName:Yi.bidderInfoSlide,children:oe?(0,N.FD)("div",{className:Yi.winningStatus,children:[(0,N.Y)("span",{className:Yi.winningText,children:B("GiftAuctionYoureWinning")}),(0,N.Y)("span",{className:Yi.winningBadge,children:B("GiftUnique",{title:e,number:t?B.number(t):void 0})})]}):(0,N.Y)("div",{className:Yi.sectionTitle,children:B("GiftAuctionYourBidWillBe")})})}(),(0,N.FD)("div",{className:Yi.bidderRow,children:[(0,N.Y)("div",{className:Yi.bidderPosition,children:re&&re>100?`${re}+`:re||1}),(0,N.FD)("div",{className:Yi.bidderInfo,children:[r&&(0,N.Y)(f.A,{peer:r,size:"small"}),r&&(0,N.Y)(Ee.A,{peer:r,className:Yi.bidderName})]}),(0,N.FD)("div",{className:Yi.bidderAmount,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(P)]})]})]}),function(){const e=w?.bidLevels;return(0,N.FD)("div",{className:Yi.section,children:[(0,N.Y)("div",{className:Yi.sectionTitle,children:B("GiftAuctionTopWinners",{count:3},{pluralValue:3})}),se(0,"🥇",G,e?.[0]?.amount,I),se(1,"🥈",S,e?.[1]?.amount,y),se(2,"🥉",C,e?.[2]?.amount,k)]})}(),(0,N.Y)(U.A,{noForcedUpperCase:!0,onClick:ae,children:B(D?.bidAmount?"GiftAuctionAddToBid":"GiftAuctionPlaceBidButton",{amount:(0,pe.U2)(B,D?.bidAmount?P-D.bidAmount:P,{asFont:!0,className:Yi.buttonStar})},{withNodes:!0})}),(0,N.FD)(ui.A,{isOpen:R,title:B("GiftAuctionCustomBidTitle"),confirmLabel:B("GiftAuctionCustomBidButton"),isConfirmDisabled:!K||Number(K)<z,confirmHandler:ne,onClose:O,children:[(0,N.Y)("p",{children:B("GiftAuctionCustomBidDescription",{count:g?.gift.giftsPerRound})}),(0,N.FD)("div",{className:Yi.customBidInput,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive",className:Yi.customBidInputIcon}),(0,N.Y)(gi.A,{value:K,onChange:ie,placeholder:B("GiftAuctionCustomBidPlaceholder"),inputMode:"numeric",teactExperimentControlled:!0})]})]})]})})),wi=(0,n.ph)((0,a.EK)(e=>{const{giftAuctionInfoModal:t}=(0,o.nTw)(e),i=t?.auctionGiftId;return{giftAuction:i?e.giftAuctionByGiftId?.[i]:void 0}})(({modal:e,giftAuction:t})=>{const{closeGiftAuctionInfoModal:i}=(0,a.ko)(),r=(0,M.A)(),o=Boolean(e&&t),s=(0,u.A)(()=>{i()}),l=(0,n.Kr)(()=>(0,N.FD)("div",{className:"BYvGxmfu",children:[(0,N.Y)("div",{className:"X5HEn2ho",children:(0,N.Y)(F.A,{name:"auction-filled",className:"aiSlk9Zw"})}),(0,N.Y)("div",{className:"obG607lY",children:r("GiftAuctionInfoTitle")}),(0,N.Y)("div",{className:"wKo4cuID",children:r("GiftAuctionInfoSubtitle")})]}),[r]),c=(0,n.Kr)(()=>{if(o)return(0,N.Y)("div",{className:"M_SnCV2j",children:(0,N.Y)(U.A,{iconName:"understood",iconClassName:"OQCwJP3j",onClick:s,children:r("ButtonUnderstood")})})},[r,o,s]),d=(0,n.Kr)(()=>{const e=t?.gift.giftsPerRound||0;return[["auction-drop",r("GiftAuctionInfoTopBiddersTitle",{count:e},{pluralValue:e}),r("GiftAuctionInfoTopBiddersSubtitle",{count:e},{pluralValue:e})],["auction-next-round",r("GiftAuctionInfoBidCarryoverTitle"),r("GiftAuctionInfoBidCarryoverSubtitle",{count:e})],["stars-refund",r("GiftAuctionInfoMissedBiddersTitle"),r("GiftAuctionInfoMissedBiddersSubtitle")]]},[r,t]);return(0,N.Y)(Ni.A,{isOpen:o,header:l,listItemData:d,footer:c,onClose:s})}));var Di=i(60406),Pi=i(96802);const Ti={modal:"Pz3wJVwI",content:"vBYqMeRD",giftsListContainer:"Ly9mKtg2",giftsList:"lla9jO09",giftHeader:"TuVkgxwZ",bidValue:"zdUvUfOO",badge:"btuWuz25",starIcon:"GRggVFef",okButton:"kIsP2W0m"},Mi=(0,n.ph)((0,a.EK)(e=>{const{giftAuctionAcquiredModal:t}=(0,o.nTw)(e);return{acquiredGifts:t?.acquiredGifts,giftTitle:t?.giftTitle,giftSticker:t?.giftSticker}})(({modal:e,acquiredGifts:t,giftTitle:i,giftSticker:r})=>{const{closeGiftAuctionAcquiredModal:o}=(0,a.ko)(),s=(0,n.li)(),l=(0,M.A)(),c=Boolean(e?.giftId),m=(0,d.A)(t),f=(0,d.A)(i),p=(0,d.A)(r),A=(0,u.A)(()=>{o()}),g=(0,n.Kr)(()=>{if(m?.length)return m.map(e=>{const t=l("GiftAuctionBoughtGiftHeader",{gift:f||l("StarGift"),giftNumber:e.giftNumber?l.number(e.giftNumber):"",round:l.number(e.round)});return{tableData:[[void 0,(0,N.FD)("span",{className:Ti.giftHeader,children:[p&&(0,N.Y)(ee.A,{className:Ti.giftSticker,sticker:p,size:20,play:!1}),(0,N.Y)("span",{children:t})]})],[l("GiftAuctionRecipient"),{chatId:e.peerId}],[l("GiftAuctionDate"),(0,z.L2)(1e3*e.date,l.code,!0)],[l("GiftAuctionAcceptedBid"),(0,N.FD)("span",{className:Ti.bidValue,children:[(0,pe.U2)(l,e.bidAmount,{className:Ti.starIcon}),(0,N.Y)(V.A,{className:Ti.badge,children:l("GiftAuctionTopPosition",{position:e.position})})]})]],key:`${e.round}-${e.giftNumber}`}})},[m,f,p,l]),b=m?.length||0;return(0,Di.A)({containerRef:s,selector:`.${Ti.giftsList}`,isBottomNotch:!0},[g]),(0,N.FD)(h.A,{isOpen:c,hasCloseButton:!0,title:l("GiftAuctionBoughtGiftsTitle",{count:b},{pluralValue:b}),className:Ti.modal,contentClassName:Ti.content,onClose:A,isCondensedHeader:!0,isSlim:!0,children:[(0,N.Y)("div",{className:Ti.giftsListContainer,ref:s,children:(0,N.Y)("div",{className:Ti.giftsList,children:g?.map(e=>(0,N.Y)(Pi.A,{tableData:e.tableData},e.key))})}),(0,N.Y)(U.A,{className:Ti.okButton,onClick:A,children:l("OK")})]})})),Fi=4*P.$,Ui=(0,n.ph)((0,a.EK)((e,{modal:t})=>({oldPeer:t?.oldPeerId?(0,o.PVB)(e,t.oldPeerId):void 0,newPeer:t?.newPeerId?(0,o.PVB)(e,t.newPeerId):void 0}))(({modal:e,oldPeer:t,newPeer:i})=>{const{closeGiftAuctionChangeRecipientModal:n,openGiftAuctionBidModal:o}=(0,a.ko)(),s=(0,M.A)(),l=Boolean(e),c=(0,d.A)(t),m=(0,d.A)(i),p=(0,d.A)(e),h=(0,u.A)(()=>{p?.auctionGiftId&&(n(),o({auctionGiftId:p.auctionGiftId,peerId:p.newPeerId,message:p.message,shouldHideName:p.shouldHideName}))});if(c&&m)return(0,N.FD)(ui.A,{isOpen:l,title:s("GiftAuctionChangeRecipientTitle"),onClose:n,confirmLabel:s("Continue"),confirmHandler:h,children:[(0,N.FD)("div",{className:"GiX7PhEa",children:[(0,N.Y)(f.A,{peer:c,size:Fi}),(0,N.Y)(F.A,{name:"next",className:"rkG87LNM"}),(0,N.Y)(f.A,{peer:m,size:Fi})]}),(0,N.Y)("p",{children:s("GiftAuctionChangeRecipientDescription",{oldPeer:(0,r.F9)(s,c),newPeer:(0,r.F9)(s,m)},{withNodes:!0,withMarkdown:!0})})]})})),Ri=(0,n.ph)(({modal:e})=>{const{closeStarGiftPriceDecreaseInfoModal:t}=(0,a.ko)(),i=(0,M.A)(),r=Boolean(e),o=(0,d.A)(e),l=(0,u.A)(()=>{t()}),c=(0,n.Kr)(()=>{if(!o)return;const{prices:e}=o;return e.map(e=>[(0,z.L2)(1e3*e.date,i.code,!0,void 0,!0),(0,pe.U2)(i,e.upgradeStars,{containerClassName:"NEElQBO6"})])},[i,o]),m=(0,n.Kr)(()=>{if(r)return(0,N.FD)("div",{className:"OXLUuiYb",children:[(0,N.Y)("p",{className:"TWuxZcHO",children:i("UpgradeCostDrops")}),(0,N.Y)(U.A,{onClick:l,iconName:"understood",iconClassName:"QJryEH9W",children:i("ButtonUnderstood")})]})},[i,r,l]);if(!c||!o)return;const{currentPrice:f,minPrice:p,maxPrice:h}=o,A=h!==p?(f-p)/(h-p):0,g=(0,N.FD)("div",{className:"ETFjTQkC",children:[(0,N.Y)(gt.A,{leftText:(0,pe.Kk)(i,h),rightText:(0,pe.Kk)(i,p),floatingBadgeText:(0,pe.Kk)(i,f),floatingBadgeIcon:"star",progress:A,isInverted:!0,shouldSkipGradient:!0,className:"DJPf4ekd"}),(0,N.Y)("p",{className:"JKYZ8cFl",children:i("StarGiftUpgradeCostModalTitle")}),(0,N.Y)("p",{className:"wHxufgix",children:i("StarGiftUpgradeCostHint")})]});return(0,N.Y)(Se.A,{isOpen:r,onClose:l,header:g,tableData:c,tableClassName:(0,s.A)("WuL_UIYd","custom-scroll"),footer:m})});var xi=i(83240);const Li=(0,n.ph)(({modal:e})=>{const{closeAboutStarGiftModal:t}=(0,a.ko)(),i=(0,M.A)(),r=Boolean(e),o=(0,d.A)(e),s=(0,u.A)(()=>{t()}),l=(0,n.Kr)(()=>(0,N.FD)("div",{className:"kSwGxZvD",children:[(0,N.FD)("div",{className:"e4SGnYtk",children:[(0,N.Y)(_e.A,{preset:"progress",className:"wYp9XwdI"}),(0,N.Y)(xi.A,{videoId:o?.videoId,videoThumbnail:o?.videoThumbnail,isActive:r,isDown:!0})]}),(0,N.Y)("div",{className:"CMt0et4C",children:i("StarGiftInfoTitle")}),(0,N.Y)("div",{className:"exd4nt_X",children:i("StarGiftInfoSubtitle")})]}),[i,o,r]),c=(0,n.Kr)(()=>{if(r)return(0,N.Y)("div",{className:"hx2wl4Ar",children:(0,N.Y)(U.A,{iconName:"understood",iconClassName:"qegJKhEH",onClick:s,children:i("ButtonUnderstood")})})},[i,r,s]),m=(0,n.Kr)(()=>[["diamond",i("StarGiftInfoUniqueTitle"),i("StarGiftInfoUniqueSubtitle")],["auction",i("StarGiftInfoTradableTitle"),i("StarGiftInfoTradableSubtitle")],["crown-wear-outline",i("StarGiftInfoWearableTitle"),i("StarGiftInfoWearableSubtitle")]],[i]);return(0,N.Y)(Ni.A,{isOpen:r,contentClassName:"rGPBNoZR",header:l,listItemData:m,footer:c,hasBackdrop:Boolean(o?.videoId),absoluteCloseButtonColor:"translucent-white",onClose:s})});var Oi=i(45294);const Ki=7*P.$,Vi=(0,n.ph)((0,a.EK)(e=>({currentUser:(0,o.mBe)(e,e.currentUserId),isCurrentUserPremium:(0,o.g29)(e)}))(({modal:e,currentUser:t,isCurrentUserPremium:i})=>{const{closeGiftStatusInfoModal:r,setEmojiStatus:o}=(0,a.ko)(),l=(0,M.A)(),{isMobile:c}=(0,ke.Ay)(),m=Boolean(e),p=(0,d.A)(e),{emojiStatus:h}=p||{},A=h?.textColor,g=(0,Oi.A)(h?.patternDocumentId),b=(0,u.A)(()=>{r()}),v=(0,u.A)(()=>{h&&o({emojiStatus:h}),r()}),G=(0,n.Kr)(()=>{if(!h||!m)return;const e=[h.centerColor,h.edgeColor];return(0,N.Y)(te.A,{className:"_1RfhkfB",backgroundColors:e,patternIcon:g.customEmoji,yPosition:6.875*P.$,maxRadius:.31,patternSize:c?13:15,ovalFactor:1})},[h,m,c,g]),S=(0,n.Kr)(()=>({...t,emojiStatus:h}),[t,h]),C=(0,n.Kr)(()=>(0,N.FD)("div",{className:"qL0cHbwS",children:[(0,N.FD)("div",{className:(0,s.A)("t18QCmAb"),style:(0,Ie.A)(A&&`color: ${A}`),children:[G,(0,N.Y)(f.A,{peer:S,size:Ki,className:"JK2zOWA7"}),(0,N.Y)(Ee.A,{peer:S,className:"lxxbgNCl",withEmojiStatus:!0,noFake:!0,noVerified:!0}),(0,N.Y)("p",{className:"MLMdxkUg",style:(0,Ie.A)(A&&`color: ${A}`),children:l("Online")})]}),(0,N.Y)("div",{className:"wxg_5ou_",children:l("UniqueStatusWearTitle",{gift:S?.emojiStatus?.title})}),(0,N.Y)("div",{className:"KSCLIMZm",children:l("UniqueStatusBenefitsDescription")})]}),[A,G,S,l]),I=[["radial-badge",l("UniqueStatusBadgeBenefitTitle"),l("UniqueStatusBadgeDescription")],["unique-profile",l("UniqueStatusProfileDesignBenefitTitle"),l("UniqueStatusProfileDesignDescription")],["proof-of-ownership",l("UniqueStatusProofOfOwnershipBenefitTitle"),l("UniqueStatusProofOfOwnershipDescription")]],y=(0,n.Kr)(()=>{if(m)return(0,N.Y)("div",{className:"VDrvalBo",children:(0,N.FD)(U.A,{onClick:v,children:[l("UniqueStatusWearButton"),!i&&(0,N.Y)(F.A,{name:"lock-badge",className:"jiPObOWv"})]})})},[l,i,m]);return(0,N.Y)(Ni.A,{isOpen:m,header:C,listItemData:I,footer:y,hasBackdrop:!0,onClose:b})}));var Ei=i(15535);const qi={header:"LQgz8Nlx",giftPreview:"hgs0ts_O",backdrop:"OnBhMaBw",description:"HBxB4QPY",arrow:"kXTOUpfb",noPassword:"BnqLhoKr"},Hi={isCustomPeer:!0,avatarIcon:"fragment",title:"",customPeerAvatarColor:"#000000"},zi=4.5*P.$,Wi=(0,n.ph)((0,a.EK)(e=>{const{settings:{byKey:{hasPassword:t}},twoFaSettings:{hint:i}}=e;return{hasPassword:t,passwordHint:i}})(({modal:e,hasPassword:t,passwordHint:i})=>{const{closeGiftWithdrawModal:r,clearGiftWithdrawError:o,closeGiftInfoModal:s,processStarGiftWithdrawal:l,openSettingsScreen:c}=(0,a.ko)(),m=Boolean(e),[p,A]=(0,n.J0)(!1),g=(0,M.A)(),b=(0,d.A)(e),v=b?.gift?.gift,G=v&&(0,X.uc)(v),S=b?.gift?.canExportAt?Math.max(b.gift.canExportAt-(0,Ye.Fm)(),0):void 0,C=(0,u.A)(()=>{r()}),I=(0,u.A)(e=>{l({gift:b.gift.inputGift,password:e})}),y=(0,u.A)(()=>{c({screen:ve.VS.TwoFaDisabled}),r(),s()});return(0,N.FD)(h.A,{isOpen:m,title:g("GiftWithdrawTitle"),isCondensedHeader:!0,hasCloseButton:!0,isSlim:!0,onClose:C,children:[G&&(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{className:qi.header,children:[(0,N.FD)("div",{className:qi.giftPreview,children:[(0,N.Y)(te.A,{className:qi.backdrop,backgroundColors:[G.backdrop.centerColor,G.backdrop.edgeColor],patternIcon:G.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,N.Y)(ee.A,{className:qi.sticker,size:zi,sticker:G.model?.sticker})]}),(0,N.Y)(F.A,{name:"next",className:qi.arrow}),(0,N.Y)(f.A,{peer:Hi,size:"giant",className:qi.avatar})]}),(0,N.Y)("p",{className:qi.description,children:g("GiftWithdrawDescription",{gift:`${v.title} #${v.number}`},{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]})})]}),Boolean(S)&&(0,N.Y)("p",{className:qi.exportHint,children:g("GiftWithdrawWait",{days:(0,ht._k)(S)},{pluralValue:(0,ht._k)(S)})}),!t&&(0,N.FD)(N.FK,{children:[(0,N.Y)("span",{className:qi.noPassword,children:g("ErrorPasswordMissing")}),(0,N.Y)(U.A,{className:"mt-2",onClick:y,children:g("SetUp2FA")})]}),t&&!S&&(0,N.Y)(Ei.A,{shouldShowSubmit:!0,placeholder:g("CheckPasswordPlaceholder"),error:b?.errorKey&&g.withRegular(b?.errorKey),description:g("CheckPasswordDescription"),onClearError:o,isLoading:b?.isLoading,hint:i,isPasswordVisible:p,shouldResetValue:m,onChangePasswordVisibility:A,submitLabel:g("GiftWithdrawSubmit"),onSubmit:I})]})}));var Ji=i(79824),ji=i(74984),_i=i(87306);const Qi=(0,n.ph)((0,a.EK)(e=>{const{contactList:t,currentUserId:i}=e;return{contactIds:t?.userIds,currentUserId:i}})(({modal:e,contactIds:t,currentUserId:i})=>{const{closeGiftTransferModal:r,openGiftWithdrawModal:s,openGiftTransferConfirmModal:l}=(0,a.ko)(),c=Boolean(e),m=(0,M.A)(),[f,p]=(0,n.J0)(""),h=(0,d.A)(e),A=(0,ji.Rh)(S.DSF),g=(0,n.Kr)(()=>(0,I.Am)([...t||[],...A||[]]),[t,A]),{result:b,currentResultsQuery:v}=(0,_i.Ay)({query:f,defaultValue:g}),G=v!==f,C=(0,n.Kr)(()=>v?Ji.p:[{type:"withdraw",isCustomPeer:!0,avatarIcon:"toncoin",peerColorId:5,title:m("GiftTransferTON")}],[m,v]),B=(0,u.A)(e=>{"withdraw"===e&&(s({gift:h.gift}),r())}),w=(0,n.Kr)(()=>{if(G)return Ji.p;const e=(0,a.mS)();return(0,y.A)((b||[]).filter(t=>t!==i&&(0,o.X2D)(e,t)),!1)},[G,b,i]),D=(0,u.A)(e=>{h?.gift&&l({gift:h.gift,recipientId:e})});return(0,N.Y)(Y.A,{isOpen:c,onClose:r,title:m("GiftTransferTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,ignoreFreeze:!0,children:(0,N.Y)(k.A,{itemIds:w,categories:C,onSelectedCategoryChange:B,withDefaultPadding:!0,withPeerUsernames:!0,isSearchable:!0,noScrollRestore:!0,isLoading:G,filterValue:f,filterPlaceholder:m("Search"),onFilterChange:p,onSelectedIdChange:D})})})),Xi=(0,n.ph)((0,a.EK)((e,{modal:t})=>({selectedPeer:t?.recipientId?(0,o.PVB)(e,t.recipientId):void 0}))(({modal:e,selectedPeer:t})=>{const{closeGiftTransferConfirmModal:i,transferGift:n,openChat:o,closeGiftModal:s,closeGiftTransferModal:l}=(0,a.ko)(),c=(0,M.A)(),m=Boolean(e),f=(0,d.A)(e),p=(0,d.A)(t),h=(0,u.A)(()=>{f?.gift.inputGift&&f.recipientId&&(n({gift:f.gift.inputGift,recipientId:f.recipientId,transferStars:f.gift.transferStars}),i(),o({id:f.recipientId}),s(),l())});if(!f)return;const{gift:A}=f,g="starGiftUnique"===A.gift.type?A.gift:void 0;return g?(0,N.FD)(ui.A,{isOpen:m,noDefaultTitle:!0,onClose:i,confirmLabel:A.transferStars?c("GiftTransferConfirmButton",{amount:(0,pe.U2)(c,A.transferStars,{asFont:!0})},{withNodes:!0}):c("GiftTransferConfirmButtonFree"),confirmHandler:h,children:[p&&(0,N.Y)(di,{peer:p,gift:g}),(0,N.Y)("p",{children:A.transferStars?c("GiftTransferConfirmDescription",{gift:c("GiftUnique",{title:g.title,number:g.number}),amount:(0,pe.Kk)(c,A.transferStars),peer:(0,r.F9)(c,p)},{withNodes:!0,withMarkdown:!0}):c("GiftTransferConfirmDescriptionFree",{gift:c("GiftUnique",{title:g.title,number:g.number}),peer:(0,r.F9)(c,p)},{withNodes:!0,withMarkdown:!0})})]}):void 0})),$i=(0,n.ph)((0,a.EK)((e,{modal:t})=>({senderPeer:t?.details.senderId?(0,o.PVB)(e,t.details.senderId):void 0,recipientPeer:t?.details.recipientId?(0,o.PVB)(e,t.details.recipientId):void 0}))(({modal:e,senderPeer:t,recipientPeer:i})=>{const{closeGiftDescriptionRemoveModal:n,removeGiftDescription:r,openChat:o}=(0,a.ko)(),s=(0,M.A)(),l=Boolean(e),c=(0,d.A)(e),m=(0,d.A)(t),f=(0,d.A)(i),p=(0,u.A)(e=>{n(),o({id:e})}),h=(0,u.A)(()=>{c?.gift.inputGift&&c.price&&r({gift:c.gift.inputGift,price:c.price})});if(!c||!f)return;const{price:A,details:g}=c,b=ri({originalDetails:g,recipient:f,sender:m,onOpenChat:p,lang:s});return(0,N.FD)(ui.A,{isOpen:l,title:s("RemoveGiftDescriptionTitle"),onClose:n,confirmLabel:s("RemoveGiftDescriptionButton",{amount:(0,pe.U2)(s,A,{asFont:!0})},{withNodes:!0}),confirmHandler:h,children:[(0,N.Y)("div",{className:"LVOpBXUW",children:s("RemoveGiftDescriptionConfirmText")}),Boolean(b)&&(0,N.Y)("div",{className:"FA1_yVBY",children:b})]})}));var Zi=i(43336);const en="fqgphS0b",tn=(0,n.ph)((0,a.EK)((e,{modal:t})=>{const i=t?.peerId?(0,o.PVB)(e,t.peerId):void 0,n=(0,o.h9Q)(e),a=(0,o.Bde)(e),r=e.appConfig?.starsUsdSellRateX1000,s=r?r/1e3:void 0,l=e.appConfig?.tonUsdRate;return{recipientPeer:i,starsCommission:n,tonCommission:a,starsUsdRate:s,tonUsdRate:l}})(({modal:e,recipientPeer:t,starsCommission:i,tonCommission:o,starsUsdRate:s,tonUsdRate:c})=>{const{closeGiftOfferAcceptModal:m,acceptStarGiftOffer:f}=(0,a.ko)(),p=(0,M.A)(),h=Boolean(e),A=(0,d.A)(e),g=(0,d.A)(t),b=(0,u.A)(()=>{A&&(f({messageId:A.messageId}),m())}),v=(0,n.Kr)(()=>A?.gift&&(0,X.uc)(A.gift),[A?.gift]),G=A?.price.currency===S.ykW,C=G?o:i,I=A?.price.amount||0,y=C?(0,Zi.LI)(I*C,G?2:0):I,k=(0,n.Kr)(()=>{if(!v)return[];const{model:e,backdrop:t,pattern:i}=v,n=[];e&&n.push([p("GiftAttributeModel"),(0,N.FD)("span",{className:en,children:[(0,N.Y)("span",{children:e.name}),(0,N.Y)(V.A,{children:(0,W.l9)(e.rarityPercent)})]})]),t&&n.push([p("GiftAttributeBackdrop"),(0,N.FD)("span",{className:en,children:[(0,N.Y)("span",{children:t.name}),(0,N.Y)(V.A,{children:(0,W.l9)(t.rarityPercent)})]})]),i&&n.push([p("GiftAttributeSymbol"),(0,N.FD)("span",{className:en,children:[(0,N.Y)("span",{children:i.name}),(0,N.Y)(V.A,{children:(0,W.l9)(i.rarityPercent)})]})]);const a=A?.gift;if(a?.valueAmount&&a.valueCurrency){const e=(0,l.Ad)(a.valueAmount,a.valueCurrency,p.code);n.push([p("GiftInfoValue"),p("GiftInfoValueAmount",{amount:e})])}return n},[v,p,A?.gift]),Y=(0,n.Kr)(()=>{if(!A)return;const{gift:e}=A,{valueUsdAmount:t}=e;if(!t||t<=0||y<=0)return;const i=t/100;let n;if(G){if(!c)return;n=(0,l.C)(y,c,!0)/100}else{if(!s)return;n=y*s/100}const a=i>=n,r=a?100*(1-n/i):100*(n/i-1);return r<=10?void 0:{percent:r,isLow:a}},[A,y,G,c,s]);if(!A||!g)return;const{gift:B,price:w}=A,D=p("GiftUnique",{title:B.title,number:B.number}),P=(0,r.F9)(p,g),T=(0,pe.Qi)(p,w),F=G?(0,pe.QH)(p,y,!0):(0,pe.Kk)(p,y),U=G?(0,pe.Ms)(p,y,{shouldConvertFromNanos:!0}):(0,pe.U2)(p,y,{asFont:!0});return(0,N.FD)(ui.A,{isOpen:h,title:p("GiftOfferAcceptTitle"),onClose:m,confirmLabel:p("GiftOfferAcceptButton",{amount:U},{withNodes:!0}),confirmHandler:b,children:[(0,N.Y)(di,{peer:g,gift:B}),(0,N.Y)("p",{className:"IHwFZk68",children:p("GiftOfferAcceptText",{gift:D,user:P,price:T},{withNodes:!0,withMarkdown:!0})}),(0,N.Y)("p",{className:"lh9lMCxr",children:p("GiftOfferAcceptReceive",{amount:F},{withNodes:!0,withMarkdown:!0})}),Boolean(k.length)&&(0,N.Y)(Pi.A,{tableData:k,className:"wGrc4H5s"}),Y&&(0,N.Y)("p",{className:Y.isLow?"YnTd0N6i":"UitlqwUx",children:p(Y.isLow?"GiftOfferPriceLow":"GiftOfferPriceHigh",{percent:(0,W.l9)(Y.percent,0),gift:B.title},{withNodes:!0,withMarkdown:!0})})]})})),nn=(0,n.ph)((0,a.EK)((e,{modal:t})=>({user:t?.userId?(0,o.mBe)(e,t.userId):void 0}))(({modal:e,user:t})=>{const{closeChatRefundModal:i,toggleNoPaidMessagesException:o}=(0,a.ko)(),[s,l]=(0,n.J0)(!1),c=(0,d.A)(e),m=(0,d.A)(t),{starsToRefund:f,userId:p}=c||{},h=(0,M.A)(),A=Boolean(e),g=(0,u.A)(()=>{i(),p&&o({userId:p,shouldRefundCharged:s})});return(0,N.FD)(ui.A,{isOpen:A,onClose:i,title:h("RemoveFeeTitle"),confirmLabel:h("ConfirmRemoveMessageFee"),confirmHandler:g,children:[h("ConfirmDialogMessageRemoveFee",{peer:m&&(0,r.F9)(h,m)},{withMarkdown:!0,withNodes:!0}),Boolean(f)&&(0,N.Y)(qe.A,{className:"dialog-checkbox",label:h("ConfirmDialogRemoveFeeRefundStars",{amount:(0,pe.Kk)(h,f)},{withMarkdown:!0,withNodes:!0}),checked:s,onCheck:l})]})}));var an=i(14487);const rn=(0,n.ph)((0,a.EK)(e=>{const t=e.stars?.balance,i=e.ton?.balance?.amount;return{starBalance:t,tonBalance:i}})(({modal:e,starBalance:t,tonBalance:i})=>{const r=(0,a.ko)(),o=(0,M.A)(),s=(0,n.hb)(()=>{if(!e?.directInfo)return void r.closePriceConfirmModal();const{currency:n,newAmount:a}=e,o="TON"===n,s=o?i:t?.amount;if(void 0!==s){if(s<a)return r.openStarsBalanceModal({currency:o?"TON":"XTR",tabId:(0,an.g0)()}),void r.closePriceConfirmModal();r.sendStarPaymentForm({directInfo:e.directInfo,tabId:(0,an.g0)()}),r.closePriceConfirmModal()}else r.closePriceConfirmModal()},[e,t,i,r]),c=(0,n.hb)(()=>{r.closePriceConfirmModal()},[r]);if(!e)return;const{originalAmount:d,newAmount:u,currency:m}=e;let f,p;return"TON"===m?(f=(0,pe.QH)(o,(0,l.wD)(d)),p=(0,pe.QH)(o,(0,l.wD)(u))):(f=(0,pe.Kk)(o,d),p=(0,pe.Kk)(o,u)),(0,N.Y)(ui.A,{isOpen:Boolean(e),onClose:c,title:o("PriceChanged"),confirmHandler:s,confirmLabel:o("PayNewPrice"),children:(0,N.Y)("p",{children:o("PriceChangedText",{originalAmount:f,newAmount:p},{withMarkdown:!0,withNodes:!0})})})}))}}]);
//# sourceMappingURL=6930.04675138f937ad079724.js.map