"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[6930],{25404:(e,t,i)=>{i.d(t,{A:()=>p});var a=i(84051),n=i(13439),r=i(31481),o=i(85982),s=i(17663),l=i(80140),c=i(39351),d=i(17712),u=i(59030),m=i(24433),f=i(20021);const p=(0,a.ph)(({peerId:e,canManage:t,gift:i,currentUserEmojiStatus:p,collectibleEmojiStatuses:h})=>{const{showNotification:A,openChatWithDraft:g,openGiftTransferModal:b,openGiftResalePriceComposerModal:v,openGiftStatusInfoModal:N,setEmojiStatus:S,toggleSavedGiftPinned:G,changeGiftVisibility:C,updateStarGiftPrice:y,closeGiftInfoModal:I}=(0,n.ko)(),k=(0,c.A)(),Y=(0,u.A)(),B=i&&"gift"in i,P=B?i:void 0,D=B?i.gift:i,T="starGiftUnique"===D?.type?D.slug:void 0,w=(0,a.Kr)(()=>{if(T)return`${r.jsp}nft/${T}`},[T]),M=(0,a.Kr)(()=>{if(T)return h?.find(e=>"collectible"===e.type&&e.slug===T)},[T,h]),F="collectible"===p?.type?p.slug:void 0,U=D&&"starGiftUnique"===D.type,R=U&&F===D.slug,x=M&&!R,L=U?D.resellPrice:void 0,O=t&&P&&!P.isUnsaved&&U,K=(0,d.A)(()=>{const{inputGift:e,isUnsaved:t}=P;C({gift:e,shouldUnsave:!t})}),V=(0,d.A)(()=>{w&&((0,o.eM)(w),A({message:k("LinkCopied")}))}),E=(0,d.A)(()=>{w&&g({text:{text:w}})}),q=(0,d.A)(()=>{P&&"starGiftUnique"===P?.gift.type&&(P.canTransferAt&&P.canTransferAt>(0,l.Fm)()?A({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,s.U)(Y,1e3*P.canTransferAt)}}}):b({gift:P}))}),H=(0,d.A)(()=>{P&&(P.canResellAt&&P.canResellAt>(0,l.Fm)()?A({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,s.U)(Y,1e3*P.canResellAt)}}}):v({peerId:e,gift:P}))}),z=(0,d.A)(()=>{P&&"starGiftUnique"===P.gift.type&&P.inputGift&&(I(),y({gift:P.inputGift,price:{currency:r.OUy,amount:0,nanos:0}}),A({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:k("GiftUnique",{title:P.gift.title,number:P.gift.number})}}}))}),J=(0,d.A)(()=>{"starGiftUnique"===D?.type&&M&&N({emojiStatus:M})}),W=(0,d.A)(()=>{R&&S({emojiStatus:{type:"regular",documentId:r.zNY}})}),j=(0,d.A)(()=>{G({peerId:e,gift:P})});return(0,f.FD)(f.FK,{children:[O&&(0,f.Y)(m.A,{icon:P.isPinned?"unpin":"pin",onClick:j,children:k(P.isPinned?"ChatListUnpinFromTop":"ChatListPinToTop")}),(0,f.Y)(m.A,{icon:"link-badge",onClick:V,children:k("CopyLink")}),(0,f.Y)(m.A,{icon:"forward",onClick:E,children:k("Share")}),t&&U&&(0,f.Y)(m.A,{icon:"diamond",onClick:q,children:k("GiftInfoTransfer")}),t&&U&&!L&&(0,f.Y)(m.A,{icon:"sell-outline",onClick:H,children:k("Sell")}),t&&U&&Boolean(L)&&(0,f.Y)(m.A,{icon:"unlist-outline",onClick:z,children:k("GiftInfoUnlist")}),t&&P&&(0,f.Y)(m.A,{icon:P.isUnsaved?"eye-outline":"eye-crossed-outline",onClick:K,children:k(P.isUnsaved?"GiftActionShow":"GiftActionHide")}),x&&(0,f.Y)(m.A,{icon:"crown-wear-outline",onClick:J,children:k("GiftInfoWear")}),R&&(0,f.Y)(m.A,{icon:"crown-take-off-outline",onClick:W,children:k("GiftInfoTakeOff")})]})})},46544:(e,t,i)=>{i.r(t),i.d(t,{ChatRefundModal:()=>ta,GiftAuctionAcquiredModal:()=>Di,GiftAuctionBidModal:()=>Ii,GiftAuctionChangeRecipientModal:()=>wi,GiftAuctionInfoModal:()=>ki,GiftAuctionModal:()=>Ci,GiftDescriptionRemoveModal:()=>ea,GiftInfoModal:()=>ui,GiftInfoValueModal:()=>fi,GiftLockedModal:()=>pi,GiftModal:()=>Zt,GiftRecipientPicker:()=>ei,GiftResalePriceComposerModal:()=>Ai,GiftStatusInfoModal:()=>Ri,GiftTransferConfirmModal:()=>Zi,GiftTransferModal:()=>$i,GiftUpgradeModal:()=>Si,GiftWithdrawModal:()=>Vi,PaidReactionModal:()=>ct,PriceConfirmModal:()=>aa,StarGiftPriceDecreaseInfoModal:()=>Mi,StarPaymentModal:()=>be,StarsBalanceModal:()=>fe,StarsGiftModal:()=>S,StarsGiftingPickerModal:()=>B,StarsSubscriptionModal:()=>Ve,StarsTransactionInfoModal:()=>Le});var a=i(84051),n=i(13439),r=i(70636),o=i(91048),s=i(87357),l=i(17142),c=i(4961),d=i(14),u=i(17712),m=i(59030),f=i(21849),p=i(84685),h=i(22337),A=i(1526);const g={modalDialog:"MFXAwnxJ",content:"Sl6xVf1R",main:"bTN9Jeph",headerInfo:"c6MiyJgW",logo:"StGLWvzb",logoBackground:"SyTXSfml",description:"kFe3mIZo",section:"BgfHkWd2",header:"zMtAGfXs",starHeaderText:"q3v8orGj",hiddenHeader:"bq3FnXT0",closeButton:"bDsDTkbe",avatar:"jK36xUj4",center:"v1PckUQn",secondaryInfo:"TDWSRfP9"},b=i.p+"GoldStar.fb6812e915ddfe27f504.svg",v=i.p+"stars-bg.dee4c4b73c7d21c2ec73.png";var N=i(20021);const S=(0,a.ph)((0,n.EK)((e,{modal:t})=>({user:t?.forUserId?(0,o.mBe)(e,t.forUserId):void 0}))(({modal:e,user:t})=>{const{closeStarsGiftModal:i,openInvoice:o,requestConfetti:S}=(0,n.ko)(),G=(0,a.li)(),C=Boolean(e?.isOpen),y=(0,d.A)(e),I=(0,m.A)(),[k,Y]=(0,a.J0)(),[B,P]=(0,a.J0)(!0);(0,a.vJ)(()=>{C||P(!0)},[C]);const D=(0,u.A)(()=>{const e=G.current;if(e&&C){const{top:t,left:i,width:a,height:n}=e.querySelector(".modal-content").getBoundingClientRect();S({top:t,left:i,width:a,height:n,withStars:!0})}});(0,a.vJ)(()=>{y?.isCompleted&&D()},[y,D]);const T=(0,u.A)(e=>{y&&(Y(e),o(t?{type:"starsgift",userId:t.id,stars:e.stars,currency:e.currency,amount:e.amount}:{type:"stars",stars:e.stars,currency:e.currency,amount:e.amount}))}),w=(0,u.A)(()=>{i()}),M=(0,a.Kr)(()=>{const e=I("lng_credits_summary_options_about").split("{link}");return[e[0],(0,N.Y)(p.A,{url:I("StarsTOSLink"),text:I("lng_credits_summary_options_about_link")}),e[1]]},[I]);return(0,N.Y)(h.A,{className:(0,s.A)(g.modalDialog),contentClassName:g.content,dialogRef:G,isSlim:!0,onClose:w,isOpen:C,hasAbsoluteCloseButton:!0,children:(0,N.FD)("div",{className:(0,s.A)(g.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;P(t<=150)},children:[(0,N.Y)("div",{className:(0,s.A)(g.header,B&&g.hiddenHeader),children:(0,N.Y)("h2",{className:g.starHeaderText,children:I(t?"GiftStarsTitle":"Star.List.GetStars")})}),(0,N.Y)("div",{className:g.headerInfo,children:t?(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:100,peer:t,className:g.avatar}),(0,N.Y)("img",{className:g.logoBackground,src:v,alt:"",draggable:!1})]}):(0,N.FD)(N.FK,{children:[(0,N.Y)("img",{className:g.logo,src:b,alt:"",draggable:!1}),(0,N.Y)("img",{className:g.logoBackground,src:v,alt:"",draggable:!1})]})}),(0,N.Y)("h2",{className:(0,s.A)(g.headerText,g.center),children:y?.isCompleted?t?(0,c.A)(I("Notification.StarsGift.SentYou",(0,l.Ad)(k.amount,k.currency,I.code)),["simple_markdown"]):(0,c.A)(I("StarsAcquiredInfo",k?.stars),["simple_markdown"]):I(t?"GiftStarsTitle":"Star.List.GetStars")}),(0,N.Y)("p",{className:g.description,children:t?(0,c.A)(I("ActionGiftStarsSubtitle",(0,r.F9)(I,t)),["simple_markdown"]):I("Stars.Purchase.GetStarsInfo")}),(0,N.FD)("div",{className:g.section,children:[(0,N.Y)(A.A,{options:y?.starsGiftOptions,onClick:T}),(0,N.Y)("div",{className:g.secondaryInfo,children:M})]})]})})}));var G=i(31481),C=i(90709),y=i(87894),I=i(79582),k=i(54960),Y=i(34642);const B=(0,a.ph)((0,n.EK)(e=>{const{chats:{listIds:t},currentUserId:i}=e;return{userIds:e.contactList?.userIds,activeListIds:t.active,archivedListIds:t.archived,currentUserId:i}})(({isOpen:e,currentUserId:t,activeListIds:i,archivedListIds:o,userIds:s})=>{const{closeStarsGiftingPickerModal:l,openStarsGiftModal:c}=(0,n.ko)(),d=(0,m.A)(),[f,p]=(0,a.J0)(""),h=(0,a.Kr)(()=>{const e=(0,n.mS)().users.byId,a=(0,y.Am)([...s||[],...i||[],...o||[]]),l=(0,r.PU)({ids:a,query:f,type:"user"});return(0,I.A)(l.filter(i=>{const a=e[i];return!(!a||a.isSupport||(0,C.tv)(a)||(0,C.PL)(a)||i===t||i===G.zv8)}))},[t,f,s,i,o]),A=(0,u.A)(e=>{e?.length&&(c({forUserId:e}),l())});return(0,N.Y)(Y.A,{className:"s3k01dTm",isOpen:e,onClose:l,title:d("GiftStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Continue"),onEnter:l,children:(0,N.Y)(k.A,{className:"cuI2eDIY",itemIds:h,filterValue:f,filterPlaceholder:d("Search"),onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,onSelectedIdChange:A})})}));var P=i(30708),D=i(31460),T=i(76023),w=i(37661),M=i(39351),F=i(18276),U=i(64493),R=i(46222),x=i(24680),L=i(41036),O=i(38777),K=i(86046),V=i(81949),E=i(9267);const q={root:"TtE8LQNJ",minimal:"nkV4JXHc",transition:"nXQS4E59",main:"JuWZY1ds",container:"mnhBs1uK",section:"lYkNd_gb",lastSection:"f749AI4g",sectionTitle:"FF8gm7MP",tos:"Vu6blJk9",hint:"Rs8WXoOz",topUpButton:"dc_DZoVF",tonBalanceContainer:"lorbW9II",tonBalance:"h2Fs3tOv",tonIconBalance:"Ut6GidJP",tonInUsd:"FdcdsB4l",tonIconLogo:"_hCjjyEv",description:"teXilLxe",header:"fnhXotO2",starHeaderText:"iUwego5s",botItem:"AhxcrKWn",hiddenHeader:"DZk6d6hF",noSeparator:"UwUaTrab",closeButton:"piD1PXHW",addStarsButton:"dqnGL2uh",addStarsIcon:"w9Db2eiK",balanceBlock:"Yk0OQBKC",balanceInfo:"p2dW9NOV",smallerText:"rUnPcfmE",balanceBottom:"F5BTkZ9G",modalBalance:"t8tMrx3y",starButton:"oOt4VBD2",paymentContent:"OReEUNTV",paymentImages:"oKorQYTC",paymentPhoto:"HGTrEtUF",avatarStar:"Wu10dXoa",paymentImageBackground:"os8jb_qv",paymentButton:"VzR5cibf",paymentButtonStar:"Uhg7yWxK",transactions:"Qvc0fTTH",subscriptions:"IX5BhCUF",tabs:"KZVEyKOX",disclaimer:"bpVifdwH",amountBadge:"BPM7LKwo",loadMore:"TKmZjMyd",loadMoreIcon:"buepwtN1"},H=(0,a.ph)(({balance:e,className:t,withAddButton:i})=>{const a=(0,M.A)(),{openStarsBalanceModal:r}=(0,n.ko)();return(0,N.Y)("div",{className:(0,s.A)(q.balanceBlock,t),children:(0,N.FD)("div",{className:q.balanceInfo,children:[(0,N.Y)("span",{className:q.smallerText,children:a("StarsBalance")}),(0,N.Y)("div",{className:q.balanceBottom,children:e?.currency===G.ykW?(0,N.FD)(N.FK,{children:[(0,N.Y)(F.A,{name:"toncoin"}),void 0!==e?(0,l.UL)(e.amount,e.currency):"…"]}):(0,N.FD)(N.FK,{children:[(0,N.Y)(E.A,{type:"gold",size:"middle"}),void 0!==e&&e.currency===G.OUy?(0,K.ZF)(a,e):"…",i&&(0,N.Y)(V.A,{className:q.addStarsButton,onClick:()=>r({}),children:(0,N.Y)(F.A,{className:q.addStarsIcon,name:"add"})})]})})]})})});var z=i(17663),J=i(14242),W=i(63527);const j={root:"ZXnbeQxP",info:"zLaaDX3c",status:"HbF2qTB2",statusPricing:"AveGvpdV",amount:"_CBiOQcv",title:"k9ZIv5Pd",description:"FlRlxMx2",subtitle:"YN2J8dw6",statusPeriod:"MRrP7Oew",statusEnded:"pRHwfr8m",preview:"t6Syyhzd",subscriptionStar:"ftlbevPm"},_=(0,a.ph)(({subscription:e})=>{const{openStarsSubscriptionModal:t}=(0,n.ko)(),{peerId:i,pricing:a,until:s,isCancelled:l,title:d,photo:p}=e,h=(0,m.A)(),A=(0,W.A)(function(e){return t=>(0,o.PVB)(t,e)}(i)),g=(0,u.A)(()=>{t({subscription:e})});if(!A)return;const b=s<Date.now()/1e3,v=(0,z.A)(1e3*s,h.code,!0,"long");return(0,N.FD)("div",{className:j.root,onClick:g,children:[(0,N.FD)("div",{className:j.preview,children:[(0,N.Y)(f.A,{size:"medium",peer:A}),(0,N.Y)(E.A,{className:j.subscriptionStar,type:"gold",size:"small"})]}),(0,N.FD)("div",{className:j.info,children:[(0,N.Y)("h3",{className:j.title,children:(0,c.A)((0,r.F9)(h,A)||"")}),d&&(0,N.FD)("p",{className:j.subtitle,children:[p&&(0,N.Y)(f.A,{webPhoto:p,size:"micro"}),(0,c.A)(d)]}),(0,N.Y)("p",{className:j.description,children:h(b?"StarsSubscriptionExpired":l?"StarsSubscriptionExpires":"StarsSubscriptionRenews",v)})]}),(0,N.Y)("div",{className:j.status,children:l||b?(0,N.Y)("div",{className:j.statusEnded,children:h(b?"StarsSubscriptionStatusExpired":"StarsSubscriptionStatusCancelled")}):(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{className:j.statusPricing,children:[(0,N.Y)(E.A,{className:j.star,type:"gold",size:"adaptive"}),(0,N.Y)("span",{className:j.amount,children:(0,J.Sm)(a.amount)})]}),(0,N.Y)("div",{className:j.statusPeriod,children:h("StarsParticipantSubscriptionPerMonth")})]})})]})});var Q=i(58968),X=i(66833);function $(e,t,i){if(i.paidMessages)return t("PaidMessageTransaction",{count:i.paidMessages},{withNodes:!0,pluralValue:i.paidMessages});if(i.isGiftResale)return Z(i.amount)?t("StarGiftSaleTransaction"):t("StarGiftPurchaseTransaction");if(i.isPostsSearch)return t("PostsSearchTransaction");if(i.isDropOriginalDetails)return t("DropOriginalDetailsTransaction");if(i.isPrepaidUpgrade)return t("GiftPrepaidUpgradeTransactionTitle");if(i.isStarGiftAuctionBid)return Z(i.amount)?t("StarGiftAuctionBidTransaction"):t("StarGiftAuctionBidRefundedTransaction");if(i.starRefCommision)return e("StarTransactionCommission",(0,J.l9)(i.starRefCommision));if(i.isGiftUpgrade)return e("Gift2TransactionUpgraded");if(i.extendedMedia)return e("StarMediaPurchase");if(i.subscriptionPeriod)return i.title||e("StarSubscriptionPurchase");if(i.isReaction)return e("StarsReactionsSent");if(i.giveawayPostId)return e("StarsGiveawayPrizeReceived");if(i.isMyGift)return e("StarsGiftSent");if(i.isGift)return i.amount.currency===G.ykW?t("TonGiftReceived"):e("StarsGiftReceived");if(i.starGift)return Z(i.amount)?e("Gift2TransactionSent"):e("Gift2ConvertedTitle");const a=i.peer&&(0,K.MA)(i)&&(0,K.Pc)(i)||void 0;return a?a.title||e(a.titleKey):i.title}function Z(e){return e.currency===G.OUy?e.amount?e.amount<0:e.nanos<0:e.amount<0}var ee=i(79577),te=i(40558),ie=i(62587),ae=i(27860);const ne={root:"jQkp75Gb",preview:"OYGSN3PF",count:"KX1yz2Jy",thumb:"EvinKr5k",noOutline:"KSAAsUDv",itemCount1:"GxDajfX_",itemCount2:"jXuZoxq8",itemCount3:"TPn3XGHJ",blurry:"hWZuxLS8",full:"w56QPFhl",fadeIn:"ds43W8Wq"};function re({boughtMedia:e,index:t,className:i}){const a=e.video||e.photo,n=(0,C.VO)(a,"pictogram"),r=(0,C.VD)(a),o=(0,ie.A)(n);return(0,N.FD)("div",{className:(0,s.A)(ne.thumb,void 0!==t&&`stars-transaction-media-${t}`,i),children:[r&&(0,N.Y)("img",{className:ne.blurry,src:r,alt:""}),o&&(0,N.Y)("img",{className:ne.full,src:o,alt:""})]})}const oe=(0,a.ph)(({media:e,className:t,isTransactionPreview:i,onClick:a})=>{const n=Math.min(e.length,i?2:3),r="mediaType"in e[0];return(0,N.FD)("div",{className:(0,s.A)(ne.root,ne[`itemCount${n}`],i&&ne.preview,t),dir:"rtl",onClick:a,children:[e.slice(0,n).reverse().map((e,t,a)=>{const n=a.length-t-1;return"mediaType"in e?(0,N.Y)(ae.A,{className:ne.thumb,isVisible:!0,width:e.width,height:e.height,thumbDataUri:e.thumbnail?.dataUri}):(0,N.Y)(re,{className:(0,s.A)(i&&n>0&&ne.noOutline),boughtMedia:e,index:n})}),r&&(0,N.FD)("div",{className:ne.count,children:[(0,N.Y)(F.A,{name:"stars-lock"}),e.length>1?e.length:""]})]})}),se={root:"aHAxv_Jg",info:"oyYrn3II",stars:"K5lc75ku",amount:"QLQPuLAr",title:"e0pK8CJ_",description:"xbERdDMQ",date:"l6CwQ0Ev",positive:"P_42_ZWR",negative:"TGjnLJfH",preview:"cnjGihOT",subscriptionStar:"z43YvnDX",uniqueGiftBackground:"eNvzMw2p",giftSticker:"U3dqmnM4"},le=(0,a.ph)(({transaction:e,className:t})=>{const{openStarsTransactionModal:i}=(0,n.ko)(),{date:l,amount:d,photo:p,peer:h,extendedMedia:A,subscriptionPeriod:g}=e,b=(0,M.A)(),v=(0,m.A)(),S="peer"===h.type?h.id:void 0,C=(0,W.A)(function(e){return t=>e?(0,o.PVB)(t,e):void 0}(S)),y=e.starGift,I="starGiftUnique"===y?.type,k=y&&(0,X.yQ)(y),Y=(0,a.Kr)(()=>{let t,i,a,n=$(v,b,e);if((0,K.MA)(e)){const i=(0,K.Pc)(e);n=i.title||v(i.titleKey),t=v(i.subtitleKey),a=i}else t=C&&(0,r.F9)(v,C),a=C||Q.lw;return(e.isGiftUpgrade||e.isDropOriginalDetails)&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isGiftResale&&"starGiftUnique"===e.starGift?.type&&(t=b("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isPostsSearch&&(n=$(v,b,e),t=void 0),e.photo&&(a=void 0),e.isRefund&&(i=v("StarsRefunded")),e.hasFailed&&(i=v("StarsFailed")),e.isPending&&(i=v("StarsPending")),{title:n,description:t,avatarPeer:a,status:i}},[v,b,C,e]),B=(0,a.Kr)(()=>{if(I){const{backdrop:e}=(0,X.uc)(y),t=[e.centerColor,e.edgeColor];return(0,N.FD)(N.FK,{children:[(0,N.Y)(te.A,{className:se.uniqueGiftBackground,backgroundColors:t}),(0,N.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1})]})}return k?(0,N.Y)(ee.A,{className:se.giftSticker,sticker:k,size:36,play:!1}):A?(0,N.Y)(oe,{media:A,isTransactionPreview:!0}):(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:"medium",webPhoto:p,peer:Y.avatarPeer}),Boolean(g)&&(0,N.Y)(E.A,{className:se.subscriptionStar,type:"gold",size:"small"})]})},[I,A,p,Y.avatarPeer,g,y,k]),P=(0,u.A)(()=>{i({transaction:e})}),D=Z(d)?se.negative:se.positive;return(0,N.FD)("div",{className:(0,s.A)(se.root,t),onClick:P,children:[(0,N.Y)("div",{className:se.preview,children:B}),(0,N.FD)("div",{className:se.info,children:[(0,N.Y)("h3",{className:se.title,children:Y.title}),Y.description&&(0,N.Y)("p",{className:se.description,children:(0,c.A)(Y.description)}),(0,N.FD)("p",{className:se.date,children:[(0,z.L2)(1e3*l,v.code,!0),Y.status&&` — (${Y.status})`]})]}),(0,N.FD)("div",{className:se.stars,children:[(0,N.Y)("span",{className:(0,s.A)(se.amount,D),children:(0,K.hk)(b,d)}),d.currency===G.OUy&&(0,N.Y)(E.A,{className:se.star,type:"gold",size:"adaptive"}),d.currency===G.ykW&&(0,N.Y)(F.A,{name:"toncoin",className:D})]})]})}),ce=3.5*T.$,de=["all","inbound","outbound"],ue=["StarsTransactionsAll","StarsTransactionsIncoming","StarsTransactionsOutgoing"],me="StarsTransactionItem",fe=(0,a.ph)((0,n.EK)((e,{modal:t})=>({shouldForceHeight:t?.currency===G.ykW?Boolean(e.ton?.history?.all?.transactions.length):Boolean(e.stars?.history?.all?.transactions.length),starsBalanceState:e.stars,tonBalanceState:e.ton,canBuyPremium:!(0,o.n_C)(e),tonUsdRate:e.appConfig.tonUsdRate,tonTopupUrl:e.appConfig.tonTopupUrl,animationLevel:(0,P.lS)(e).animationLevel}))(({modal:e,starsBalanceState:t,tonBalanceState:i,canBuyPremium:d,shouldForceHeight:f,tonUsdRate:g,tonTopupUrl:b,animationLevel:v})=>{const{closeStarsBalanceModal:S,loadStarsTransactions:y,loadStarsSubscriptions:I,openStarsGiftingPickerModal:k,openInvoice:Y,openUrl:B}=(0,n.ko)(),P=e?.currency||G.OUy,T=P===G.ykW?i:t,{balance:K,history:V}=T||{},{subscriptions:E}=P===G.OUy&&t||{},z=(0,m.A)(),J=(0,M.A)(),[W,j]=(0,a.J0)(!0),[Q,X,$]=(0,w.A)(!1),[Z,ee]=(0,a.J0)(0),[te,ie,ae]=(0,w.A)(),ne=(0,a.li)(),re=Boolean(e&&(t||i)),{originStarsPayment:oe,originReaction:se,originGift:fe,topup:pe}=e||{},he=oe||se||fe||pe,Ae=oe?.form?.invoice?.totalAmount||oe?.subscriptionInfo?.subscriptionPricing?.amount||se?.amount||fe?.gift.stars||pe?.balanceNeeded,ge=Ae?Ae-(K?.amount||0):void 0,be=(0,a.Kr)(()=>{const e=(0,n.mS)();if(se){const t=(0,o.hds)(e,se.chatId);if(!t)return;return z("StarsNeededTextReactions",(0,C.Js)(z,t))}if(oe){const t=oe.form?.botId?(0,o.mBe)(e,oe.form.botId):void 0;if(!t)return;return z("StarsNeededText",(0,C.Yg)(t))}if(fe){const t=(0,o.mBe)(e,fe.peerId);if(!t)return;return z("StarsNeededTextGift",(0,r.F9)(J,t))}return"subs"===pe?.purpose?z("StarsNeededTextLink"):pe?.purpose===G.D3m?J("StarsNeededTextSendPaidMessages",void 0,{withMarkdown:!0,withNodes:!0}):void 0},[se,oe,fe,pe?.purpose,J,z]),ve=Boolean(V?.all?.transactions.length&&!he),Ne=!he,Se=(0,a.Kr)(()=>{const e=V?.all?.transactions.length||0;return 1===e?"35.5rem":2===e?"39.25rem":3===e?"43rem":"45rem"},[V?.all?.transactions.length]),Ge=(0,a.Kr)(()=>ue.map(e=>({title:J(e)})),[J]);(0,a.vJ)(()=>{re||(j(!0),ee(0),ae(),$())},[re]),(0,a.vJ)(()=>{he?ie():ae()},[he]);const Ce=(0,a.Kr)(()=>{if(!re)return;const e=z("lng_credits_summary_options_about").split("{link}");return[e[0],(0,N.Y)(p.A,{url:z("StarsTOSLink"),text:z("lng_credits_summary_options_about_link")}),e[1]]},[re,z]),ye=(0,u.A)(()=>{y({type:de[Z],isTon:P===G.ykW})}),Ie=(0,u.A)(()=>{I()}),ke=(0,u.A)(()=>{k({})}),Ye=(0,u.A)(e=>{const t=oe?.inputInvoice;let i;switch(t?.type){case"message":i=t.chatId;break;case"slug":{const e=oe?.form;i=e?.botId;break}}se&&(i=se.chatId),Y({type:"stars",stars:e.stars,currency:e.currency,amount:e.amount,spendPurposePeerId:i})}),Be=(0,u.A)(()=>{B({url:b})});return(0,N.Y)(h.A,{className:(0,s.A)(q.root,!f&&!te&&q.minimal),isOpen:re,onClose:S,dialogStyle:`--modal-height: ${Se}`,hasAbsoluteCloseButton:!0,children:(0,N.FD)("div",{className:(0,s.A)(q.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;if(j(t<=150),ne.current){const{top:t}=ne.current.getBoundingClientRect(),{top:i}=e.currentTarget.getBoundingClientRect();t-i<=ce?X():$()}},children:[P!==G.ykW&&(0,N.Y)(H,{balance:K,className:q.modalBalance}),(0,N.Y)("div",{className:(0,s.A)(q.header,W&&q.hiddenHeader,Q&&q.noSeparator),children:(0,N.Y)("h2",{className:q.starHeaderText,children:z("TelegramStars")})}),(0,N.Y)("div",{className:q.section,children:P===G.ykW?(()=>{const e=(0,l.UL)(K?.amount||0,G.ykW);return(0,N.FD)(N.FK,{children:[(0,N.Y)(O.A,{model:"speeding-diamond",color:"blue",title:J("CurrencyTon"),description:J("DescriptionAboutTon"),isDisabled:!re}),(0,N.FD)("div",{className:q.tonBalanceContainer,children:[(0,N.FD)("div",{className:q.tonBalance,children:[(0,N.Y)(F.A,{name:"toncoin",className:q.tonIconBalance}),e]}),Boolean(g)&&(0,N.Y)("span",{className:q.tonInUsd,children:`≈ ${(0,l.Ad)((0,l.C)(K?.amount||0,g,!0),"USD",J.code)}`})]}),(0,N.Y)(U.A,{className:q.topUpButton,onClick:Be,fluid:!0,children:J("ButtonTopUpViaFragment")}),P===G.ykW&&(0,N.Y)("div",{className:q.hint,children:J("TonModalHint")})]})})():(0,N.FD)(N.FK,{children:[(0,N.Y)(O.A,{model:"swaying-star",color:"gold",title:ge?z("StarsNeededTitle",Ae):z("TelegramStars"),description:(0,c.A)(be||z("TelegramStarsInfo"),["simple_markdown","emoji"]),isDisabled:!re}),d&&!te&&(0,N.Y)(U.A,{className:q.starButton,onClick:ie,fluid:!0,children:z("Star.List.BuyMoreStars")}),d&&!te&&Ne&&(0,N.Y)(U.A,{isText:!0,noForcedUpperCase:!0,className:q.starButton,fluid:!0,onClick:ke,children:z("TelegramStarsGift")}),te&&t?.topupOptions&&(0,N.Y)(A.A,{starsNeeded:ge,options:t.topupOptions,onClick:Ye})]})}),te&&(0,N.Y)("div",{className:q.tos,children:Ce}),ve&&Boolean(E?.list.length)&&(0,N.FD)("div",{className:q.section,children:[(0,N.Y)("h3",{className:q.sectionTitle,children:z("StarMySubscriptions")}),(0,N.FD)("div",{className:q.subscriptions,children:[E?.list.map(e=>(0,N.Y)(_,{subscription:e},e.id)),E?.nextOffset&&(0,N.FD)(U.A,{isText:!0,disabled:E.isLoading,size:"smaller",noForcedUpperCase:!0,className:q.loadMore,onClick:Ie,children:[(0,N.Y)(F.A,{name:"down",className:q.loadMoreIcon}),z("StarMySubscriptionsExpand")]})]})]}),ve&&(0,N.FD)("div",{className:q.container,children:[(0,N.Y)("div",{className:q.lastSection,children:(0,N.Y)(L.Ay,{name:(0,D.P)("slideOptimized",v,void 0,J.isRtl),activeKey:Z,renderCount:ue.length,shouldRestoreHeight:!0,className:q.transition,children:(0,N.Y)(R.A,{onLoadMore:ye,items:V?.[de[Z]]?.transactions,scrollContainerClosest:`.${q.main}`,itemSelector:`.${me}`,className:q.transactions,noFastList:!0,noScrollRestoreOnTop:!0,children:V?.[de[Z]]?.transactions.map(e=>(0,N.Y)(le,{transaction:e,className:me},`${e.id}-${e.isRefund}`))})})}),(0,N.Y)(x.A,{ref:ne,className:q.tabs,tabClassName:q.tab,activeTab:Z,tabs:Ge,onSwitchTab:ee})]})]})})}));var pe=i(48775),he=i(29886),Ae=i(84991),ge=i(10187);const be=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.form?.botId?(0,o.mBe)(e,t.form.botId):void 0,a="message"===t?.inputInvoice?.type?t.inputInvoice:void 0,n=a?(0,o.O5q)(e,a.chatId,a.messageId):void 0,r=a?(0,o.hds)(e,a.chatId):void 0,s=n?.content.paidMedia;return{bot:i,starsBalanceState:e.stars,paidMediaMessage:s?n:void 0,paidMediaChat:s?r:void 0}})(({modal:e,bot:t,starsBalanceState:i,paidMediaMessage:r,paidMediaChat:o})=>{const{closeStarsPaymentModal:l,openStarsBalanceModal:d,sendStarPaymentForm:A}=(0,n.ko)(),[g,b,S]=(0,w.A)(),G=Boolean(e?.inputInvoice&&i),y=(0,he.A)(e),I=e||y,{form:k,subscriptionInfo:Y}=I||{},B=k?.invoice?.totalAmount||Y?.subscriptionPricing?.amount,P=Boolean(k?.invoice.subscriptionPeriod),D=!Y?.subscriptionPricing,T=k?.photo,F=(0,m.A)(),R=(0,M.A)();(0,a.vJ)(()=>{G||S()},[G]);const x=(0,a.Kr)(()=>{if(!I?.inputInvoice)return"";const e=(0,C.Yg)(t),i=F("Stars.Intro.PurchasedText.Stars",B);if(r){const e=r.content.paidMedia.extendedMedia,t=e.every(e=>!e.duration),a=e.every(e=>Boolean(e.duration)),n=F(t?"Stars.Transfer.Photos":a?"Stars.Transfer.Videos":"Media",e.length),s=(0,C.Js)(F,o);return F("Stars.Transfer.UnlockInfo",[n,s,i])}return Y?R("StarsSubscribeText",{chat:Y.title,amount:B},{withNodes:!0,withMarkdown:!0,pluralValue:B}):P?R("StarsSubscribeBotText",{name:k.title,amount:B,bot:e},{pluralValue:B}):F("Stars.Transfer.Info",[k.title,e,i])},[I?.inputInvoice,t,F,B,r,Y,P,k,o,R]),L=(0,a.Kr)(()=>{if(Y)return R("StarsSubscribeInfo",{link:(0,N.Y)(p.A,{url:R("StarsSubscribeInfoLink"),text:R("StarsSubscribeInfoLinkText")})},{withNodes:!0})},[Y,R]),O=(0,a.Kr)(()=>{if(Y)return(0,C.nr)(Y)},[Y]),K=(0,u.A)(()=>{const t=i?.balance;void 0!==B&&void 0!==t&&(B>t.amount?d({originStarsPayment:e}):(A({}),b()))});return(0,N.FD)(h.A,{contentClassName:q.paymentContent,isOpen:G,hasAbsoluteCloseButton:!0,isSlim:!0,onClose:l,children:[(0,N.Y)(H,{balance:i?.balance,className:q.modalBalance}),(0,N.FD)("div",{className:q.paymentImages,dir:R.isRtl?"ltr":"rtl",children:[r?(0,N.Y)(oe,{media:r.content.paidMedia.extendedMedia}):O?(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{className:q.paymentPhoto,peer:O,size:"giant"}),(0,N.Y)(E.A,{type:"gold",size:"adaptive",className:q.avatarStar})]}):(0,N.Y)(Ae.A,{peer:T?void 0:t,avatarWebPhoto:T,avatarSize:"giant",badgeIcon:"star",badgeText:(0,J.Sm)(B),badgeClassName:q.amountBadge,className:q.paymentPhoto}),(0,N.Y)("img",{className:q.paymentImageBackground,src:v,alt:"",draggable:!1})]}),(0,N.Y)("h2",{className:q.headerText,children:F(O?"StarsSubscribeTitle":"StarsConfirmPurchaseTitle")}),D&&(0,N.Y)(ge.A,{className:q.botItem,peerId:k?.botId}),(0,N.Y)("div",{className:q.description,children:(0,c.A)(x,["simple_markdown","emoji"])}),(0,N.Y)(U.A,{className:q.paymentButton,onClick:K,isLoading:g,children:R(P?"StarsSubscribeBotButtonMonth":"StarsPay",{amount:(0,pe.U2)(R,B,{asFont:!0})},{withNodes:!0})}),Boolean(L)&&(0,N.Y)("div",{className:(0,s.A)(q.disclaimer,q.smallerText),children:L})]})}));var ve=i(89925),Ne=i(85982),Se=i(97040),Ge=i(70046),Ce=i(96454),ye=i(95807),Ie=i(537),ke=i(43874),Ye=i(80140);const Be="biAUzmLA",Pe="hsDNs5hG",De="APNjRx1K",Te=(0,a.ph)((0,n.EK)(e=>{const{currentUserId:t}=e,i=t?(0,o.mBe)(e,t):void 0,a=i?.emojiStatus,n=e.collectibleEmojiStatuses?.statuses;return{currentUserEmojiStatus:a,collectibleEmojiStatuses:n}})(({savedGift:e,currentUserEmojiStatus:t,collectibleEmojiStatuses:i})=>{const{openGiftTransferModal:r,openGiftResalePriceComposerModal:s,openGiftStatusInfoModal:l,setEmojiStatus:c,updateStarGiftPrice:d,showNotification:f,closeGiftInfoModal:p}=(0,n.ko)(),h=(0,M.A)(),A=(0,m.A)(),g=e?.gift,b="starGiftUnique"===g?.type?g.resellPrice:void 0,v=(0,n.mS)(),S=(0,o.nTw)(v).giftInfoModal,C=S?.peerId,y="starGiftUnique"===g?.type?g.slug:void 0,I=(0,a.Kr)(()=>{if(y)return i?.find(e=>"collectible"===e.type&&e.slug===y)},[y,i]),k="collectible"===t?.type?t.slug:void 0,Y=void 0!==y&&k===y,B=Boolean(I)&&!Y,P=(0,u.A)(()=>{e&&"starGiftUnique"===e?.gift.type&&(e.canTransferAt&&e.canTransferAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,z.U)(A,1e3*e.canTransferAt)}}}):r({gift:e}))}),D=(0,u.A)(()=>{Y?c({emojiStatus:{type:"regular",documentId:G.zNY}}):I&&l({emojiStatus:I})}),T=(0,u.A)(()=>{e&&C&&(e.canResellAt&&e.canResellAt>(0,Ye.Fm)()?f({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,z.U)(A,1e3*e.canResellAt)}}}):s({peerId:C,gift:e}))}),w=(0,u.A)(()=>{e&&"starGiftUnique"===e.gift.type&&e.inputGift&&(p(),d({gift:e.inputGift,price:{currency:G.OUy,amount:0,nanos:0}}),f({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:h("GiftUnique",{title:e.gift.title,number:e.gift.number})}}}))});return(0,N.FD)("div",{className:"feHNN0j8",children:[(0,N.Y)(U.A,{color:"transparentBlured",iconName:"gift-transfer-inline",iconAlignment:"top",iconClassName:De,onClick:P,ariaLabel:h("GiftInfoTransfer"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:Pe,children:h("GiftInfoTransfer")})}),(B||!Y)&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:Y?"crown-take-off":"crown-wear",iconAlignment:"top",iconClassName:De,onClick:B||Y?D:void 0,disabled:!B&&!Y,ariaLabel:h(Y?"GiftInfoTakeOff":"GiftInfoWear"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:Pe,children:h(Y?"GiftInfoTakeOff":"GiftInfoWear")})}),!b&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:"sell",iconAlignment:"top",iconClassName:De,onClick:T,ariaLabel:h("Sell"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:Pe,children:h("Sell")})}),Boolean(b)&&(0,N.Y)(U.A,{color:"transparentBlured",iconName:"unlist",iconAlignment:"top",iconClassName:De,onClick:w,ariaLabel:h("GiftInfoUnlist"),noForcedUpperCase:!0,fluid:!0,className:Be,children:(0,N.Y)("span",{className:Pe,children:h("GiftInfoUnlist")})})]})})),we={root:"irv1C8bo",withManageButtons:"QcTw5OSp",sticker:"a1ASgPwu",subtitleBadge:"V7kDVPLm",radialPattern:"UvhsGZLf",amount:"zTVWZg63",transition:"Tu6_OHoq",transitionSlide:"iUTKLzTN",title:"ECTvfOda",subtitle:"S6JwvHWD"},Me=(0,a.ph)(({modelAttribute:e,backdropAttribute:t,patternAttribute:i,title:r,subtitle:o,subtitlePeer:l,className:c,resellPrice:d,showManageButtons:u,savedGift:m})=>{const{openChat:f}=(0,n.ko)(),{isMobile:p}=(0,ke.Ay)(),h=(0,M.A)(),[A,g,b]=(0,w.A)(!1),v=(0,Ie.A)([e,t,i]),S=t?.textColor,G=(0,a.Kr)(()=>{const e=[t.centerColor,t.edgeColor];return(0,N.Y)(te.A,{className:we.radialPattern,canvasClassName:we.radialPatternCanvas,backgroundColors:e,patternIcon:i.sticker,yPosition:7.5*T.$,maxRadius:.26,patternSize:p?14:16,ovalFactor:1.2})},[t,i,p]);return(0,N.FD)("div",{className:(0,s.A)(we.root,"interactive-gift",u&&we.withManageButtons,c),children:[(0,N.FD)(L.Ay,{className:we.transition,slideClassName:(0,s.A)(we.transitionSlide),activeKey:v,direction:1,name:"zoomBounceSemiFade",children:[G,(0,N.Y)(ee.A,{className:we.sticker,sticker:e.sticker,size:120,noLoop:!A,onMouseEnter:Ce.TF?void 0:g,onMouseLeave:Ce.TF?void 0:b})]}),r&&(0,N.Y)("h1",{className:we.title,children:r}),Boolean(o)&&(0,N.Y)("div",{className:(0,s.A)(we.subtitle,l&&we.subtitleBadge),style:(0,ye.A)(S&&`color: ${S}`),onClick:()=>{l&&f({id:l.id})},children:o}),m&&u&&(0,N.Y)(Te,{savedGift:m}),d&&(0,N.FD)("p",{className:we.amount,children:[(0,N.Y)("span",{children:(0,K.hk)(h,d)}),"XTR"===d.currency&&(0,N.Y)(E.A,{type:"gold",size:"middle"}),"TON"===d.currency&&(0,N.Y)(F.A,{name:"toncoin"})]})]})}),Fe="qBOIq6Jn",Ue="sso9uZM6",Re="NuWOY7ED",xe=[0,-50],Le=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i="peer"===t?.transaction?.peer?.type&&t.transaction.peer.id,a=i?(0,o.PVB)(e,i):void 0,n=e.appConfig.starsPaidMessageCommissionPermille,r=t?.transaction.amount,s=t?.transaction.isGift?r?.currency===G.OUy?(0,o.WLj)(e,r?.amount):(0,o.OD9)(e,r?.amount):void 0;return{peer:a,canPlayAnimatedEmojis:(0,o.BWX)(e),topSticker:s,paidMessageCommission:n}})(({modal:e,peer:t,canPlayAnimatedEmojis:i,topSticker:r,paidMessageCommission:o})=>{const{showNotification:l,openMediaViewer:c,closeStarsTransactionModal:d}=(0,n.ko)(),h=(0,M.A)(),A=(0,m.A)(),{transaction:g}=e||{},b=(0,a.li)(),v=(0,u.A)(()=>{const e=g?.extendedMedia;e&&c({origin:ve.TQ.StarsTransaction,standaloneMedia:e.flatMap(e=>Object.values(e))})}),S=(0,u.A)(()=>{b.current?.()}),y=(0,u.A)(e=>{b.current=e}),I=(0,a.Kr)(()=>{if(!g)return;const{giveawayPostId:e,photo:a,amount:n,isGiftUpgrade:c,isDropOriginalDetails:d,starGift:u,isGiftResale:m,starRefCommision:b}=g,I=g?.starGift,k="starGiftUnique"===I?.type,Y=g?.starGift?(0,X.yQ)(g.starGift):r,B=k?(0,X.uc)(I):void 0,P=g.peer&&(0,K.MA)(g)&&(0,K.Pc)(g)||void 0,D="peer"===g.peer?.type?g.peer.id:void 0,T=g.peer&&A(function(e){switch(e.type){case"appStore":return"AppStore";case"playMarket":return"PlayMarket";case"fragment":return"Fragment";case"premiumBot":return"StarsTransactionBot";case"ads":return"StarsTransactionAds";case"api":return"Stars.Intro.Transaction.TelegramBotApi.Subtitle";default:return"Stars.Transaction.Unsupported.Title"}}(g.peer)),w=$(A,h,g),M=t&&g.messageId&&!c&&!d?(0,C.yt)(t,void 0,g.messageId):void 0,U=t&&e?(0,C.yt)(t,void 0,e):void 0,R=g.extendedMedia,x=R?.length||0,L=R?.every(e=>!e.video),O=R?.every(e=>!e.photo),V=A(L?"Stars.Transfer.Photos":O?"Stars.Transfer.Videos":"Media",x),q=g.description||((c||d)&&"starGiftUnique"===u?.type?u.title:void 0)||(R?V:void 0),H=!R&&!Y&&!g.isPostsSearch,W=a?void 0:!(0,K.MA)(g)&&t||P,j=k&&(0,N.Y)("div",{className:(0,s.A)(Fe,"ApoQz22o"),children:(0,N.Y)(Me,{backdropAttribute:B.backdrop,patternAttribute:B.pattern,modelAttribute:B.model,title:I.title,subtitle:h("GiftInfoCollectible",{number:I.number}),resellPrice:g.amount})}),_=Z(n)?"xDyq9cc0":"jvBZSrpd",Q=(0,N.FD)("div",{className:Fe,children:[R&&(0,N.Y)(oe,{className:(0,s.A)("C5r59yiV","transaction-media-preview"),media:R,onClick:v}),!R&&Y&&(0,N.Y)(ee.A,{sticker:Y,play:i,noLoop:!0},g.id),H&&(0,N.Y)(f.A,{className:"hcrszlpT",peer:W,webPhoto:a,size:"giant",onMouseMove:S}),!Y&&!g.isPostsSearch&&(0,N.Y)(Se.A,{className:(0,s.A)("nML8IQqX"),color:"gold",onRequestAnimation:y,centerShift:xe}),Boolean(w)&&(0,N.Y)("h1",{className:"ZZAj3hj7",children:w}),(0,N.Y)("p",{className:Re,children:q}),(0,N.FD)("p",{className:Ue,children:[(0,N.Y)("span",{className:(0,s.A)(Ue,_),children:(0,K.hk)(h,n)}),n.currency===G.OUy&&(0,N.Y)(E.A,{type:"gold",size:"middle"}),"TON"===n.currency&&(0,N.Y)(F.A,{name:"toncoin",className:_}),g.isRefund&&(0,N.Y)("p",{className:"sxWAwxTd",children:h("Refunded")})]}),Boolean(g.paidMessages&&g.starRefCommision&&o)&&(0,N.Y)("p",{className:Re,children:h("PaidMessageTransactionDescription",{percent:(0,J.l9)(o/10)},{withNodes:!0,withMarkdown:!0})})]}),te=[];let ie;g&&b&&!g.paidMessages&&!m&&te.push([A("StarsTransaction.StarRefReason.Title"),A("StarsTransaction.StarRefReason.Program")]),c&&te.push([A("StarGiftReason"),A("StarGiftReasonUpgrade")]),d&&te.push([A("StarGiftReason"),h("StarGiftReasonDropOriginalDetails")]),m&&te.push([A("StarGiftReason"),Z(g.amount)?h("StarGiftSaleTransaction"):h("StarGiftPurchaseTransaction")]),ie=c?A("Stars.Transaction.GiftFrom"):Z(n)||g.isMyGift?A("Stars.Transaction.To"):!g.starRefCommision||g.paidMessages||m?A(D?"Star.Transaction.From":"Stars.Transaction.Via"):A("StarsTransaction.StarRefReason.Miniapp"),g.isPostsSearch||d||g.isStarGiftAuctionBid||te.push([ie,D?{chatId:D}:T||""]),g.starRefCommision&&g.paidMessages&&te.push([h("PaidMessageTransactionTotal"),(0,pe.U2)(h,g.amount.amount/((100-g.starRefCommision)/100),{asFont:!1,className:"cU5QlvwL",containerClassName:"Z2YALGgl"})]),M&&te.push([A("Stars.Transaction.Reaction.Post"),(0,N.Y)(p.A,{url:M,text:M})]),U&&g.amount.currency===G.OUy&&(te.push([A("BoostReason"),(0,N.Y)(p.A,{url:U,text:A("Giveaway")})]),te.push([A("Gift"),A("Stars",g.amount,"i")])),g.id&&te.push([A("Stars.Transaction.Id"),(0,N.FD)(N.FK,{children:[(0,N.Y)("div",{className:"tMF8VIOM",onClick:()=>{(0,Ne.eM)(g.id),l({message:A("StarsTransactionIDCopied")})},children:g.id}),(0,N.Y)(F.A,{className:"voCttFzS",name:"copy"})]})]),te.push([A("Stars.Transaction.Date"),(0,z.L2)(1e3*g.date,A.code,!0)]),g.isStarGiftAuctionBid&&"starGift"===I?.type&&I.availabilityTotal&&te.push([h("GiftInfoAvailability"),h("GiftInfoAvailabilityValue",{count:I.availabilityRemains||0,total:I.availabilityTotal},{pluralValue:I.availabilityRemains||0})]);const ae=A("lng_credits_box_out_about").split("{link}");return{header:k?j:Q,tableData:te,footer:(0,N.FD)("span",{className:"KgzPpgS6",children:[ae[0],(0,N.Y)(p.A,{url:A("StarsTOSLink"),text:A("lng_credits_summary_options_about_link")}),ae[1]]})}},[g,A,h,t,i,r,o,y]),k=(0,he.A)(I)||I;return(0,N.Y)(Ge.A,{isOpen:Boolean(g),className:"IzhfRIWu",hasBackdrop:"starGiftUnique"===g?.starGift?.type,header:k?.header,tableData:k?.tableData,footer:k?.footer,buttonText:A("OK"),onClose:d})})),Oe="oBLHWBtJ",Ke=[0,-50],Ve=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.subscription.peerId;return{peer:i?(0,o.PVB)(e,i):void 0}})(({modal:e,peer:t})=>{const{closeStarsSubscriptionModal:i,fulfillStarsSubscription:o,changeStarsSubscription:l,checkChatInvite:c,loadStarStatus:d,openInvoice:h}=(0,n.ko)(),A=(0,m.A)(),g=(0,M.A)(),{subscription:b}=e||{},v=(0,a.li)(),S=(0,u.A)(()=>{v.current?.()}),C=(0,u.A)(e=>{v.current=e}),y=(0,a.Kr)(()=>{if(!b)return"hidden";if(b.canRefulfill)return"refulfill";const e=b.until>Date.now()/1e3;if(e&&!b.isCancelled)return"cancel";if(e&&b.isCancelled)return"renew";const t=b.chatInviteHash||b.invoiceSlug;return!e&&t?"restart":"ok"},[b]),I=(0,u.A)(()=>{if(b){switch(y){case"refulfill":o({id:b.id});break;case"restart":b.chatInviteHash?c({hash:b.chatInviteHash}):b.invoiceSlug&&h({type:"slug",slug:b.invoiceSlug}),d();break;case"renew":l({id:b.id,isCancelled:!1});break;case"cancel":l({id:b.id,isCancelled:!0})}i()}}),k=(0,a.Kr)(()=>{if(!b||!t)return;const{pricing:e,until:i,isCancelled:a,canRefulfill:n,photo:o,title:l,hasBotCancelled:c}=b,d=(0,r.mO)(t),u=(0,N.FD)("div",{className:"E3R22yAI",children:[(0,N.FD)("div",{className:"wuTMXDP9",children:[(0,N.Y)(f.A,{peer:o?void 0:t,webPhoto:o,size:"giant",onMouseMove:S}),(0,N.Y)(E.A,{className:"enRetSny",type:"gold",size:"adaptive"})]}),(0,N.Y)(Se.A,{className:(0,s.A)("zGCayu45"),color:"gold",onRequestAnimation:C,centerShift:Ke}),(0,N.Y)("h1",{className:"qdydQHgc",children:l||A("StarsSubscriptionTitle")}),(0,N.Y)("p",{className:"FI6rEJlK",children:g("StarsPerMonth",{amount:e.amount},{withNodes:!0,specialReplacement:{[G.Cyx]:(0,N.Y)(E.A,{className:"J8HIcN6k",size:"adaptive",type:"gold"})}})})]}),m=[];m.push([A(d?"StarsSubscriptionBot":"StarsSubscriptionChannel"),{chatId:t.id}]),l&&m.push([A("StarsSubscriptionBotProduct"),l]);const h=i<Date.now()/1e3;m.push([A(h?"StarsSubscriptionUntilExpired":a?"StarsSubscriptionUntilExpires":"StarsSubscriptionUntilRenews"),(0,z.L2)(1e3*i,A.code,!0)]);const v=g("StarsTransactionTOS",{link:(0,N.Y)(p.A,{url:g("StarsTransactionTOSLink"),text:g("StarsTransactionTOSLinkText")})},{withNodes:!0});return{header:u,tableData:m,footer:(0,N.FD)("span",{className:"GMWMuWCr",children:[(0,N.Y)("p",{className:Oe,children:v}),a&&(0,N.Y)("p",{className:"nkwiG25Q",children:A(c?"StarsSubscriptionBotCancelledText":"StarsSubscriptionCancelledText")}),n&&(0,N.Y)("p",{className:Oe,children:A("StarsSubscriptionRefulfillInfo",(0,z.L2)(1e3*i,A.code,!0))}),!a&&!n&&h&&(0,N.Y)("p",{className:Oe,children:A("StarsSubscriptionExpiredInfo",(0,z.L2)(1e3*i,A.code,!0))}),!a&&!n&&!h&&(0,N.Y)("p",{className:Oe,children:A("StarsSubscriptionCancelInfo",(0,z.L2)(1e3*i,A.code,!0))}),"hidden"!==y&&(0,N.Y)(U.A,{color:"cancel"===y?"danger":"primary",isText:"cancel"===y,onClick:I,children:A("cancel"===y?"StarsSubscriptionCancel":"refulfill"===y?"StarsSubscriptionRefulfill":"restart"===y?"StarsSubscriptionAgain":"renew"===y?"StarsSubscriptionRenew":"OK")})]})}},[y,g,A,t,b]),Y=(0,he.A)(k)||k;return(0,N.Y)(Ge.A,{isOpen:Boolean(b),className:"eR_RZfGB",header:Y?.header,tableData:Y?.tableData,footer:Y?.footer,onClose:i})}));var Ee=i(34431),qe=i(19806),He=i(22699),ze=i(24433),Je=i(32581),We=i(93545),je=i(68292),_e=i(85118);const Qe={root:"CuBAw2yg",dragging:"LbDNXOOQ",progress:"kwK0cNPX",floatingBadgeWrapper:"uvlMoXj0",floatingBadgeText:"qqQan8uF",floatingBadgeTriangle:"mIdJOmsB",slider:"euOOAbZi",sparkles:"_L1YQTIP",dynamicColor:"uIYIwZpx",floatingBadge:"BGSDWAYc",clickable:"JwkM7nwU",noTransition:"cG6CiHRL",floatingBadgeSparkles:"JCciTRtu",floatingBadgeContent:"f1UPSN27",withDescription:"WsptdVHe",floatingBadgeTitle:"HkY6dR8D",floatingBadgeDescription:"mR3ddE5s",floatingBadgeTrianglePath:"IW9YhMAx",customValueIcon:"Td8Tc1MH"},Xe=[50,100,500,1e3,2e3,5e3,1e4],$e=1.875*T.$,Ze=2*T.$,et=1.5*T.$,tt=.125*T.$;let it;const at=["#955CDB","#955CDB","#46A3EB","#40A920","#E29A09","#ED771E","#E14542","#596473"];function nt(e,t,i){const a=e.findIndex(e=>t<=e),n=e[a-1]||i,r=e[a]||e[e.length-1];return r===n?a:a+(t-n)/(r-n)}function rt(e,t,i){const a=Math.floor(t),n=e[a-1]||i,r=n+((e[a]||e[e.length-1])-n)*(t-a);return Math.round(r)}const ot=(0,a.ph)(({maxValue:e,defaultValue:t,minValue:i,minAllowedValue:n,className:r,floatingBadgeDescription:o,shouldUseDynamicColor:l,shouldAllowCustomValue:c,onChange:d,onBadgeClick:m})=>{const f=(0,a.li)(),p=(0,a.li)(),h=(0,M.A)(),A=i??1,g=(0,a.Kr)(()=>{const t=[];for(let i=0;i<Xe.length;i++)if(!(Xe[i]<=A)&&(Xe[i]<e&&t.push(Xe[i]),Xe[i]>=e))return t.push(e),t;let i=Xe[Xe.length-1]+1e4;for(;i<e;)t.push(i),i+=1e4;return t.push(e),t},[e,A]),[b,v]=(0,a.J0)(0),[S,G]=(0,a.J0)(0),[C,y]=(0,a.J0)(0),[I,k]=(0,a.J0)(!1),Y=(0,a.li)(),B=(0,he.A)(C),P=h.number(rt(g,b,A)),D=void 0!==n?nt(g,n,A):0;(0,a.vJ)(()=>{v(nt(g,t,A))},[t,g,A]),(0,a.vJ)(()=>{if(!p.current)return;const e=p.current.querySelector(`.${Qe.floatingBadgeTitle}`);if(!e)return;const t=getComputedStyle(e),i=`${t.fontWeight} ${t.fontSize} ${t.fontFamily}`,a=function(e,t){it||(it=document.createElement("canvas"));const i=it.getContext("2d");return i.font=t,i.measureText(e).width}(P,i),n=et+tt+a,r=p.current.querySelector(`.${Qe.floatingBadgeDescription}`),o=r?.scrollWidth||0,s=Math.max(n,o)+Ze;y(e=>Math.abs(s-e)<6?e:s)},[P,o]);const T=(0,u.A)(e=>{G(e.contentRect.width)});(0,We.A)(f,T);const w=b/g.length,{minBadgeX:U,maxBadgeX:R,beakOffset:x,beakTipOffset:L,beakWidth:O}=(0,a.Kr)(()=>function(e,t,i){const a=t/2,n=a-22,r=e-$e,o=i*r,s=r-o,l=o<s,c=l?o:s,d=l?-1:1;let u=0,m=0,f=52;const p=a-$e/2;if(c<p)if(c>10)u=d*((p-c)/(p-10))*n;else if(c>0){u=d*n;const e=(10-c)/10;f=52-8*(1-(1-e)*(1-e)*(1-e)),m=d*e*(f/2)}else u=d*n,f=44,m=d*(f/2);return{minBadgeX:a,maxBadgeX:e-a,beakOffset:u,beakTipOffset:m,beakWidth:f}}(S,C,w),[S,C,w]),K=(0,a.Kr)(()=>function(e,t){const i=e/2+t;return`M 0 0 L ${e} 0 L ${i+2} 30 Q ${i} 32 ${i-2} 30 Z`}(O,L),[O,L]),V=(0,u.A)(e=>{const t=Number(e.currentTarget.value),i=Math.max(t,D);v(i);const a=rt(g,i,A);d(a)}),E=(0,u.A)(e=>{Y.current=e.clientX,k(!1)}),q=(0,u.A)(e=>{void 0!==Y.current&&Math.abs(e.clientX-Y.current)>=5&&k(!0)}),H=(0,u.A)(()=>{Y.current=void 0,k(!1)}),z=l?function(e){if(e>=1)return at[at.length-1];const t=at.length-1,i=Math.floor(e*t);return at[Math.min(i,t-1)]}(w):void 0,J=(0,ye.A)(Boolean(C)&&`width: ${C}px`),W=(0,ye.A)(`--progress: ${w}`,`--min-badge-x: ${U}px`,`--max-badge-x: ${R}px`,z&&`--dynamic-color: ${z}`);return(0,N.FD)("div",{ref:f,className:(0,s.A)(Qe.root,I&&Qe.dragging,r),style:W,children:[(0,N.Y)("div",{className:Qe.floatingBadgeWrapper,children:(0,N.FD)("div",{className:(0,s.A)(Qe.floatingBadge,m&&Qe.clickable),onClick:m,children:[(0,N.FD)("div",{className:(0,s.A)(Qe.floatingBadgeText,l&&Qe.dynamicColor,(!B||0===B)&&Qe.noTransition),style:J,children:[(0,N.Y)(_e.A,{preset:"button",className:Qe.floatingBadgeSparkles}),(0,N.FD)("div",{ref:p,className:(0,s.A)(Qe.floatingBadgeContent,o&&Qe.withDescription),children:[(0,N.FD)("div",{className:Qe.floatingBadgeTitle,children:[(0,N.Y)(F.A,{name:"star",className:Qe.floatingBadgeIcon}),(0,N.Y)(je.A,{text:P})]}),(0,N.Y)("div",{className:Qe.floatingBadgeDescription,children:o})]})]}),(0,N.FD)("svg",{className:Qe.floatingBadgeTriangle,width:O,height:32,viewBox:`0 0 ${O} 32`,fill:"none","aria-hidden":"true",role:"presentation",style:`transform: translate(calc(-50% + ${x}px), 33%)`,children:[!l&&(0,N.Y)("defs",{children:(0,N.FD)("linearGradient",{id:"StarBadgeTriangle",x1:"0",x2:"1",y1:"0",y2:"0",children:[(0,N.Y)("stop",{offset:"-50%","stop-color":"#FFAA00"}),(0,N.Y)("stop",{offset:"150%","stop-color":"#FFCD3A"})]})}),(0,N.Y)("path",{className:Qe.floatingBadgeTrianglePath,d:K,fill:z||"url(#StarBadgeTriangle)"})]})]})}),(0,N.Y)("div",{className:(0,s.A)(Qe.progress,l&&Qe.dynamicColor),children:(0,N.Y)(_e.A,{preset:"progress",className:Qe.sparkles})}),(0,N.Y)("input",{className:Qe.slider,type:"range",min:0,max:g.length,defaultValue:nt(g,t,A),step:"any",onChange:V,onPointerDown:E,onPointerMove:q,onPointerUp:H}),c&&(0,N.Y)(F.A,{name:"add",className:Qe.customValueIcon})]})}),st={content:"RdhRpsCn",title:"yzbjj73U",slider:"xePPMXOI",description:"BlpfdOtK",itemInfo:"nS9V516D",itemTitle:"sH5Nukjy",itemSubtitle:"dHlNODTI",itemIcon:"H_iHihXU",sendAsPeerButtonAvatar:"_mjvLELm",sendAsPeerMenuButton:"zxsRaWYV",buttonDownIcon:"zrwUUELS",sendAsPeerMenuBubble:"X1PB6mhQ",sendAsPeerMenu:"Px1MDij9",sendAsPeersMenuContainer:"Al1nfhHJ",headerControlPanel:"vu90kSL_",separator:"uhQLUjmo",checkBox:"Mc3bVeF0",topLabel:"bnou4CpV",top:"QludQDKR",topBadge:"JBF9pTUK",buttonStar:"NJJFuym9",topPeer:"Ty4Ud_Rd",disclaimer:"KRvkHeo1"},lt={avatarIcon:"author-hidden",customPeerAvatarColor:"#9eaab5",isCustomPeer:!0,titleKey:"StarsReactionAnonymous"},ct=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t&&(0,o.hds)(e,t.chatId),a=t&&(0,o.O5q)(e,t.chatId,t.messageId),n=e.stars?.balance,r=e.appConfig.paidReactionMaxAmount||2500,s=e.settings.paidReactionPrivacy,l=i?.sendPaidReactionsAsPeerIds,c=e.currentUserId;return{chat:i,message:a,starBalance:n,maxAmount:r,defaultPrivacy:s,sendPaidReactionsAsPeerIds:l,currentUserId:c,currentUser:(0,o.mBe)(e,c)}})(({modal:e,chat:t,message:i,maxAmount:l,starBalance:d,defaultPrivacy:A,sendPaidReactionsAsPeerIds:g,currentUserId:b,currentUser:v})=>{const{closePaidReactionModal:S,addLocalPaidReaction:C,loadSendPaidReactionsAs:y}=(0,n.ko)(),[I,k]=(0,a.J0)(50),[Y,B,P]=(0,w.A)(),[D,T]=(0,a.J0)(!0),[R,x]=(0,a.J0)(b),L=t?.id,O=R?(0,o.PVB)((0,n.mS)(),R):v,K=(0,m.A)(),{isMobile:V}=(0,ke.Ay)(),E=(0,M.A)(),q=(0,u.A)(e=>{T(!e.target.checked)}),z=(0,u.A)(e=>{k(e),B()});(0,a.vJ)(()=>{L&&!g&&y({chatId:L})},[L,g]);const W=(0,a.Kr)(()=>{const e=g?.map(e=>e.id).filter(e=>e!==L);return e?.unshift(b),e},[g,L,b]),j=W&&W.length>1;(0,a.vJ)(()=>{e||P()},[e]),(0,a.vJ)(()=>{const e=i?.reactions?.topReactors?.find(e=>e.isMy);if(e)return T(Boolean(e.isAnonymous)),void(e.peerId&&x(e.peerId));T("anonymous"===A?.type||!1),"peer"===A?.type&&W?.includes(A.peerId)?x(A.peerId):x(b)},[A,i?.reactions?.topReactors,W,b]);const _=(0,u.A)(()=>{e&&(C({chatId:e.chatId,messageId:e.messageId,count:I,isPrivate:D,peerId:D||R===b?void 0:R,shouldIgnoreDefaultPrivacy:!0}),S())}),Q=(0,u.A)(e=>{T(!1),x(e)}),X=(0,u.A)(e=>{const t=(0,o.PVB)((0,n.mS)(),e),i=R===e&&!D;if(t)return(0,N.FD)(ze.A,{onClick:()=>Q(e),children:[(0,N.Y)(f.A,{size:"small",peer:t}),(0,N.FD)("div",{className:(0,s.A)(st.itemInfo),children:[(0,N.Y)(Ee.A,{className:st.itemTitle,peer:t,noFake:!0,noVerified:!0}),(0,N.Y)("span",{className:st.itemSubtitle,children:(0,r.mO)(t)?E("PeerPersonalAccount"):E("PeerChannel")})]}),(0,N.Y)(F.A,{className:st.itemIcon,name:i?"check":"placeholder"})]})}),$=(0,a.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,N.FD)(U.A,{ripple:!V,size:"smaller",color:"translucent",className:(0,s.A)(st.sendAsPeerMenuButton,t?"active":""),onClick:e,ariaLabel:E("AriaLabelOpenMenu"),children:[(0,N.Y)(f.A,{className:st.sendAsPeerButtonAvatar,size:"mini",peer:D?lt:O}),(0,N.Y)(F.A,{name:"down",className:st.buttonDownIcon})]}),[V,E,O,D]),Z=(0,a.Kr)(()=>{if(j)return(0,N.Y)(He.A,{className:(0,s.A)(st.sendAsPeerMenu,"with-menu-transitions"),bubbleClassName:st.sendAsPeerMenuBubble,trigger:$,positionX:"right",autoClose:!0,children:W.map(e=>X(e))})},[$,W,j]),ee=(0,a.Kr)(()=>{const e=(0,n.mS)(),t=i?.reactions?.topReactors;if(!t)return;const a=[];let r=!1,s=0;if(t.forEach(t=>{const i=t.peerId?(0,o.PVB)(e,t.peerId):void 0;if(!i&&!t.isAnonymous&&!t.isMy)return;if(t.isMy&&(s=t.count),t.isMy&&(t.peerId!==R||t.isAnonymous&&!D))return;const n=R===t.peerId||D&&t.isAnonymous;n&&(r=!0),a.push({amount:t.count,localAmount:n&&Y?I:0,isMy:t.isMy,isAnonymous:t.isAnonymous,user:i})}),!r){const t=(0,o.PVB)(e,R);a.push({amount:s,localAmount:Y?I:0,isMy:!0,user:t})}return a.sort((e,t)=>t.amount+t.localAmount-(e.amount+e.localAmount)),a.slice(0,3)},[Y,i?.reactions?.topReactors,I,R,D]),te=t&&(0,r.F9)(K,t);return(0,N.FD)(h.A,{isOpen:Boolean(e),onClose:S,isSlim:!0,hasAbsoluteCloseButton:!0,contentClassName:st.content,isLowStackPriority:!0,children:[(0,N.Y)("div",{className:st.sendAsPeersMenuContainer,children:Z}),(0,N.Y)("div",{className:st.headerControlPanel,children:(0,N.Y)(H,{balance:d,className:st.modalBalance,withAddButton:!0})}),(0,N.Y)(ot,{className:st.slider,defaultValue:50,maxValue:l,onChange:z}),(0,N.Y)("h3",{className:st.title,children:K("StarsReactionTitle")}),(0,N.Y)("div",{className:st.description,children:(0,c.A)(K("StarsReactionText",te),["simple_markdown","emoji"])}),(0,N.Y)(Je.A,{children:ee&&(0,N.Y)("div",{className:st.topLabel,children:K("StarsReactionTopSenders")})}),ee&&(0,N.Y)("div",{className:st.top,children:ee.map(e=>{const t=(0,J.Sm)(e.amount+e.localAmount),i=e.isAnonymous||!e.user||e.isMy&&D?lt:e.user,a="isCustomPeer"in i?K(i.titleKey):i&&(0,r.F9)(K,i);return(0,N.Y)(Ae.A,{className:st.topPeer,peer:i,badgeText:t,badgeIcon:"star",badgeClassName:st.topBadge,text:a},`${e.user?.id||"anonymous"}-${t}`)})}),ee&&(0,N.Y)(Je.A,{className:st.separator}),(0,N.Y)(qe.A,{className:(0,s.A)(st.checkBox,"dialog-checkbox"),checked:!D,onChange:q,label:K("StarsReactionShowMeInTopSenders")}),(0,N.Y)(U.A,{onClick:_,children:E("SendPaidReaction",{amount:I},{withNodes:!0,specialReplacement:{[G.Cyx]:(0,N.Y)(F.A,{className:st.buttonStar,name:"star"})}})}),(0,N.Y)("p",{className:st.disclaimer,children:E("StarsReactionTerms",{link:(0,N.Y)(p.A,{text:E("StarsReactionLinkText"),url:E("StarsReactionLink")})},{withNodes:!0})})]})}));var dt=i(37836),ut=i(5912),mt=i(23174),ft=i(21309),pt=i(65632),ht=i(20333),At=i(36143),gt=i(96530),bt=i(22720),vt=i(63152),Nt=i(94079),St=i(61361);const Gt="zZUpGRSI",Ct="zAee80Dv",yt="nTPAv1ci",It=48*ft.dp,kt=(0,a.ph)((0,n.EK)((e,{peerId:t})=>{const i=(0,o.SJA)(e),{stars:a}=e,{isBlurred:n,patternColor:r,background:s,backgroundColor:l}=(0,o.Gyz)(e,i)||{},c=(0,o.PVB)(e,t),d=(0,o.WA9)(e,t),u=(0,o.vGo)(e,t),m=e.currentUserId===t,f=!m&&u?.disallowedGifts?.shouldDisallowUniqueStarGifts,p=!m&&u?.disallowedGifts?.shouldDisallowLimitedStarGifts,h=(0,o.nTw)(e);return{starBalance:a?.balance,peer:c,theme:i,isBackgroundBlurred:n,patternColor:r,customBackground:s,backgroundColor:l,captionLimit:e.appConfig.starGiftMaxMessageLength,currentUserId:e.currentUserId,isPaymentFormLoading:h.isPaymentFormLoading,paidMessagesStars:d,areUniqueStarGiftsDisallowed:f,shouldDisallowLimitedStarGifts:p,activeGiftAuction:h.activeGiftAuction}})(function({gift:e,giftByStars:t,peerId:i,peer:o,captionLimit:c,theme:d,isBackgroundBlurred:m,patternColor:f,backgroundColor:p,customBackground:h,currentUserId:A,isPaymentFormLoading:g,starBalance:b,paidMessagesStars:v,areUniqueStarGiftsDisallowed:S,shouldDisallowLimitedStarGifts:G,activeGiftAuction:C}){const{sendStarGift:y,sendPremiumGiftByStars:I,openInvoice:k,openGiftUpgradeModal:Y,openStarsBalanceModal:B,openGiftAuctionBidModal:P,openGiftAuctionInfoModal:D,openGiftAuctionChangeRecipientModal:T}=(0,n.ko)(),w=(0,M.A)(),[F,R]=(0,a.J0)(""),[x,L]=(0,a.J0)(!1),[O,K]=(0,a.J0)(!1),[V,E]=(0,a.J0)(!1),q=(0,pt.A)(d,h);(0,a.vJ)(()=>{G&&K(!0)},[G,O]);const H="id"in e&&"starGift"===e.type,J="months"in e,W=t&&"amount"in t,j=o&&(0,r.mO)(o),_=i===A,Q=(0,a.Kr)(()=>{if(J){const i=V&&W?t:e;return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"giftPremium",amount:i.amount,currency:i.currency,days:30*e.months,message:F?{text:F}:void 0}}}}if(H)return{id:-1,chatId:"0",isOutgoing:!1,senderId:A,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"starGift",message:F?.length?{text:F}:void 0,isNameHidden:x||void 0,starsToConvert:e.starsToConvert,canUpgrade:O||void 0,alreadyPaidUpgradeStars:O?e.upgradeStars:void 0,gift:e,peerId:i,fromId:A}}}},[A,e,F,H,x,O,i,V,W,t,J]),X=(0,u.A)(e=>{R(e.target.value)}),$=(0,u.A)(()=>{L(!x)}),Z=(0,u.A)(()=>{K(!O)}),ee=(0,u.A)(()=>{W&&E(!V)}),te=(0,u.A)(()=>{H&&Y({giftId:e.id,peerId:i})}),ie=(0,u.A)(()=>{B({})}),ae=(0,u.A)(()=>{D({})}),ne=(0,u.A)(()=>{if(C){const e=C.userState.bidPeerId;return e&&e!==i?void T({oldPeerId:e,newPeerId:i,message:F||void 0,shouldHideName:x||void 0}):void P({peerId:i,message:F||void 0,shouldHideName:x||void 0})}H?y({peerId:i,shouldHideName:x,gift:e,message:F?{text:F}:void 0,shouldUpgrade:O}):V&&W?I({userId:i,months:t.months,amount:t.amount,message:F?{text:F}:void 0}):J&&k({type:"giftcode",userIds:[i],currency:e.currency,amount:e.amount,option:e,message:F?{text:F}:void 0})}),re=W&&b&&b.amount>t.amount,oe=(0,s.A)("ZORVRSG3","soDpW2YR",h&&"Eny_G3JI",p&&"TkJZPU2u",h&&m&&"M6k91TdM");if((H||J)&&Q)return(0,N.FD)("div",{className:(0,s.A)("jKOG0It6","custom-scroll"),children:[(0,N.FD)("div",{className:(0,s.A)("CB1mxsgp","MessageList"),inert:!0,style:(0,ye.A)(`--pattern-color: ${f}`,p&&`--theme-background-color: ${p}`),children:[(0,N.Y)("div",{className:oe,style:q?`--custom-background: ${q}`:void 0}),(0,N.Y)(At.A,{message:Q,threadId:mt.l3,appearanceOrder:0},H?e.id:J?e.months:void 0)]}),function(){const i=c?c-F.length:void 0,a=(0,r.F9)(w,o);return(0,N.FD)("div",{className:"Y68CEIKn",children:[!v&&(0,N.Y)(Nt.A,{className:"o5r2IPoA",onChange:X,value:F,label:w("GiftMessagePlaceholder"),maxLength:c,maxLengthIndicator:i&&i<50?i.toString():void 0}),re&&(0,N.FD)(bt.A,{className:Gt,narrow:!0,ripple:!0,onClick:ee,children:[(0,N.Y)("span",{children:w("GiftPremiumPayWithStars",{stars:(0,pe.U2)(w,t.amount,{className:Ct})},{withNodes:!0})}),(0,N.Y)(vt.A,{checked:V,onChange:ee,label:w("GiftPremiumPayWithStarsAcc")})]}),W&&b&&(0,N.Y)("div",{className:yt,children:w("GiftPremiumDescriptionYourBalance",{stars:(0,pe.U2)(w,b.amount,{className:Ct}),link:(0,N.Y)(gt.A,{isPrimary:!0,onClick:ie,children:w("GetMoreStarsLinkText")})},{withNodes:!0,withMarkdown:!0})}),H&&Boolean(e.upgradeStars)&&!S&&(0,N.FD)(bt.A,{className:Gt,narrow:!0,ripple:!0,onClick:Z,disabled:G,children:[(0,N.Y)("span",{children:w("GiftMakeUnique",{stars:(0,pe.U2)(w,e.upgradeStars,{className:Ct})},{withNodes:!0})}),(0,N.Y)(vt.A,{checked:O,onChange:Z,label:w("GiftMakeUniqueAcc")})]}),H&&Boolean(e.upgradeStars)&&!S&&(0,N.Y)("div",{className:yt,children:j?w("GiftMakeUniqueDescription",{user:a,link:(0,N.Y)(gt.A,{isPrimary:!0,onClick:te,children:w("GiftMakeUniqueLink")})},{withNodes:!0}):w("GiftMakeUniqueDescriptionChannel",{peer:a,link:(0,N.Y)(gt.A,{isPrimary:!0,onClick:te,children:w("GiftMakeUniqueLink")})},{withNodes:!0})}),H&&(0,N.FD)(bt.A,{className:Gt,narrow:!0,ripple:!0,onClick:$,children:[(0,N.Y)("span",{children:w("GiftHideMyName")}),(0,N.Y)(vt.A,{checked:x,onChange:$,label:w("GiftHideMyName")})]}),H&&(0,N.Y)("div",{className:yt,children:_?w("GiftHideNameDescriptionSelf"):j?w("GiftHideNameDescription",{receiver:a}):w("GiftHideNameDescriptionChannel")})]})}(),(0,N.Y)("div",{className:"ATowWJ60"}),function(){const i=V&&W?(0,pe.U2)(w,t.amount,{asFont:!0}):H?(0,pe.U2)(w,e.stars+(O?e.upgradeStars:0),{asFont:!0}):J?(0,l.vv)(w,e.amount,e.currency):void 0,a=C?.gift.giftsPerRound,n=C?.state.endDate,r=n?n-(0,Ye.Fm)():void 0,o=void 0!==r&&r>0&&r<It;return(0,N.FD)("div",{className:"jxWZSvet",children:[H&&Boolean(e.availabilityRemains)&&(0,N.Y)(ht.A,{isPrimary:!0,progress:e.availabilityRemains/e.availabilityTotal,rightText:w("GiftSoldCount",{count:e.availabilityTotal-e.availabilityRemains}),leftText:w("GiftLeftCount",{count:e.availabilityRemains}),className:"mWzLu0c0"}),C&&Boolean(a)&&(0,N.Y)("div",{className:"j4s8T1dQ",children:w("GiftAuctionDescription",{count:a,link:(0,N.Y)(gt.A,{isPrimary:!0,onClick:ae,children:w("GiftAuctionLearnMore")})},{pluralValue:a,withNodes:!0})}),(0,N.Y)(U.A,{className:"IDuhjrne",size:r?void 0:"smaller",onClick:ne,isLoading:g,noForcedUpperCase:!0,children:C?(0,N.FD)("div",{children:[(0,N.Y)("div",{children:w("GiftAuctionPlaceBid")}),void 0!==r&&r>0&&(0,N.Y)("div",{className:"pB6hqcvA",children:w("GiftAuctionTimeLeft",{time:o?(0,N.Y)(St.A,{endsAt:n}):(0,z.zt)(w,r)},{withNodes:!0})})]}):w("GiftSend",{amount:i},{withNodes:!0})})]})}()]})}));var Yt=i(87049);const Bt="G1mBmzxs",Pt="a8no5WH0",Dt="DvJLTVFU",Tt=(0,a.ph)((0,n.EK)((e,{option:t})=>({sticker:(0,o.t0O)(e,t.months),canPlayAnimatedEmojis:(0,o.BWX)(e)}))(function({sticker:e,canPlayAnimatedEmojis:t,baseMonthAmount:i,option:a,optionByStars:n,onClick:r}){const{months:o,amount:s,currency:c}=a,d=(0,M.A)(),m=(0,u.A)(()=>{r(a)}),f=Math.floor(s/o),p=i&&i>f?Math.ceil(100-f/(i/100)):void 0;return(0,N.FD)("div",{className:Bt,tabIndex:0,role:"button",onClick:m,children:[(0,N.Y)(ee.A,{sticker:e,play:t,noLoop:!0,nonInteractive:!0,size:86}),function(){const e=12===o?d("Years",{count:1},{pluralValue:1}):d("Months",{count:o},{pluralValue:o});return(0,N.Y)("div",{className:"rn9aWFNA",children:e})}(),(0,N.Y)("div",{className:"q4_ydkAx",children:d("PremiumGiftDescription")}),(0,N.Y)(U.A,{className:Pt,color:"adaptive",nonInteractive:!0,size:"tiny",pill:!0,fluid:!0,children:(0,l.Ad)(s,c)}),n&&(0,N.Y)("div",{className:"QB5SI7ta",children:d("GiftPremiumStarsPrice",{stars:(0,pe.U2)(d,n.amount,{className:"jgnEfoeM"})},{withNodes:!0,withMarkdown:!0})}),Boolean(p)&&(0,N.Y)(Yt.A,{color:"purple",text:d("GiftDiscount",{percent:p})})]})}));var wt=i(82855);const Mt=(0,a.ph)((0,n.EK)(e=>({isCurrentUserPremium:(0,o.g29)(e)}))(function({gift:e,isResale:t,isCurrentUserPremium:i,withTransferBadge:r,hideBadge:o,noClickable:l,observeIntersection:c,onClick:d}){const{openGiftInfoModal:m,openPremiumModal:f,showNotification:p,checkCanSendGift:h,openGiftAuctionModal:A}=(0,n.ko)(),g=(0,a.li)(),b=(0,a.li)(),v=(0,M.A)(),[S,C]=(0,a.J0)(!1),[y,I,k]=(0,w.A)(),Y=(0,X.yQ)(e),B="starGiftUnique"===e.type,P=B?e:void 0,D=B?void 0:e,T=B?function(t){if(!t)return{amount:0,currency:G.OUy};if("starGiftUnique"===e.type&&e.resaleTonOnly){const e=t.find(e=>e.currency===G.ykW);if(e)return e}return t.find(e=>e.currency===G.OUy)}(P?.resellPrice):{amount:D?.stars||0,currency:G.OUy},R=T?.currency||G.OUy,x=D?.resellMinStars,L=!B&&t&&x?v.number(x)+"+":T?.amount||0,O=!B&&Boolean(D?.isLimited),K=!B&&Boolean(D?.isSoldOut),V=!B&&!t&&Boolean(D?.isAuction),E=Boolean(e?.requirePremium),q=Boolean(D?.limitedPerUser&&!D?.perUserRemains),H=D?.perUserTotal,z=(0,u.A)(()=>{V?A({gift:e}):!K||t?q?p({message:v("NotificationGiftsLimit2",{count:H},{pluralValue:H,withMarkdown:!0,withNodes:!0})}):!E||i?j?h({gift:e,onSuccess:()=>d?.(e,t?"resell":"original")}):d?.(e,t?"resell":"original"):f({gift:e}):m({gift:e})}),J=(0,a.Kr)(()=>{const{backdrop:t,pattern:i}=(0,X.uc)(e)||{};if(!t||!i)return;const a=[t.centerColor,t.edgeColor];return(0,N.Y)(te.A,{className:"Nkotr8Q4",backgroundColors:a,patternIcon:i.sticker,ringsCount:1,ovalFactor:1})},[e]),W=B?e.number:0,j=Boolean("starGift"===e.type&&e.lockedUntilDate),_=(0,a.Kr)(()=>{if(B){const{backdrop:t}=(0,X.uc)(e)||{};if(!t)return;return(0,N.Y)(Yt.A,{color:[t.centerColor,t.edgeColor],text:v("GiftSavedNumber",{number:W})})}return t?(0,N.Y)(Yt.A,{color:"green",text:v("GiftRibbonResale")}):K?(0,N.Y)(Yt.A,{color:"red",text:v("GiftSoldOut")}):V?(0,N.Y)(Yt.A,{color:"orange",text:v("GiftRibbonAuction")}):E?(0,N.Y)(Yt.A,{color:"orange",text:v("GiftRibbonPremium")}):O?(0,N.Y)(Yt.A,{color:"blue",text:v("GiftLimited")}):void 0},[B,t,e,K,O,v,W,E,V]);(0,ut.mv)(g,c,e=>{const t=e.isIntersecting;C(t)});const Q=(0,a.Kr)(()=>r?v("GiftTransferTitle"):V?v("GiftAuctionJoin"):R===G.ykW?(0,pe.Ms)(v,L||0,{shouldConvertFromNanos:!0,className:Dt}):(0,pe.U2)(v,L||0,{asFont:!0,className:Dt}),[r,R,L,V,v]);return(0,N.FD)("div",{ref:g,className:(0,s.A)("interactive-gift",Bt,"f5ArEO1S","starGiftItem",E&&"NBYIITte",V&&"WqBCC4Ce",l&&"pcLi3lcD"),tabIndex:l?void 0:0,role:l?void 0:"button",onClick:l?void 0:z,onMouseEnter:Ce.TF||l?void 0:I,onMouseLeave:Ce.TF||l?void 0:k,children:[J,(0,N.Y)("div",{ref:b,className:"rUSoeQXb",style:"width: 90px; height: 90px",children:Y&&(0,N.Y)(wt.A,{observeIntersectionForPlaying:c,observeIntersectionForLoading:c,containerRef:b,sticker:Y,size:90,shouldLoop:y,shouldPreloadPreview:!0})}),!o&&(0,N.Y)(U.A,{className:(0,s.A)(Pt,r&&"nqN62arv"),nonInteractive:!0,size:"tiny",color:B?"bluredStarsBadge":"stars",withSparkleEffect:S&&!r,pill:!0,fluid:!0,children:Q}),_,j&&(0,N.Y)(F.A,{name:"lock-badge",className:"kwuipwV7"})]})}));var Ft=i(13235),Ut=i(36175),Rt=i(96374),xt=i(64489);const Lt={root:"tJK1W0pJ",transition:"pP8TxefR",content:"o3V1HqbL",resaleScreenRoot:"Vce_TsJO",main:"cVXqeu9P",giftSection:"v4eKefwN",section:"EqfarEYb",resaleStarGiftsContainer:"RSFcSNGL",starGiftsContainer:"OQX3GZl5",premiumGiftsGallery:"n40m3BK2",header:"iqqoyRgW",noBorder:"cuvdjW2y",resaleHeader:"cJRBgg9B",resaleHeaderContentContainer:"OXYQmfGK",headerSlide:"BTWhJUQB",headerText:"lLRmbpIu",hiddenHeader:"XgGzn1cQ",resaleHeaderText:"bp_KPx8I",commonHeaderText:"ybZo03if",resaleHeaderDescription:"XefHUFm1",closeButton:"r_Y5uG1T",balance:"soqAknia",avatars:"N_7tYJKr",avatar:"_3hY4vIep",logoBackground:"ieK4TzSb",center:"Ey5gX40t",description:"ZioU5h_k",starGiftsDescription:"gFgzS8pV",boostIcon:"Qi2YR6Dz",optionBottom:"RTbClMKE",secondaryInfo:"g0R9GSNq",footer:"J3Gju3bv",starGiftsTransition:"kB6IyXqS",notFoundGiftsRoot:"UqnRlJ1n",notFoundGiftsDescription:"g0VbwIG_",notFoundGiftsLink:"j2zPEQr8"},Ot=(0,a.ph)((0,n.EK)(e=>{const{starGifts:t}=e,{resaleGifts:i}=(0,o.nTw)(e),a=i?.giftId?t?.byId[i.giftId]:void 0,n=i.filter,r=i.isAllLoaded,s=i.isLoading,l=i.updateIteration;return{resellGifts:i.gifts,gift:a,filter:n,areGiftsAllLoaded:r,areGiftsLoading:s,updateIteration:l}})(({resellGifts:e,gift:t,filter:i,areGiftsAllLoaded:r,areGiftsLoading:o,updateIteration:l,onGiftClick:c})=>{const{loadResaleGifts:d,updateResaleGiftsFilter:m}=(0,n.ko)(),f=(0,a.li)(),p=(0,M.A)(),h=(0,a.Kr)(()=>e?.map(e=>e.id),[e]),A=Boolean(i?.modelAttributes?.length||i?.patternAttributes?.length||i?.backdropAttributes?.length),g=(0,u.A)(()=>{if(t){const e="regularGiftId"in t?t.regularGiftId:t.id;d({giftId:e})}}),b=Boolean(!e||0===e.length),[v,S]=(0,Rt.A)(g,h,!t,Ft.bc),{observe:G}=(0,ut.BL)({rootRef:f,throttleMs:200}),C=(0,u.A)(()=>{m({filter:{...i,modelAttributes:[],backdropAttributes:[],patternAttributes:[]}})});return(0,N.Y)("div",{ref:f,className:(0,s.A)(Lt.resaleScreenRoot,"custom-scroll"),children:(0,N.FD)(L.Ay,{name:"zoomFade",activeKey:l,children:[b&&r&&(0,N.FD)("div",{className:Lt.notFoundGiftsRoot,children:[(0,N.Y)(xt.A,{size:160,tgsUrl:Ut.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,N.Y)("div",{className:Lt.notFoundGiftsDescription,children:p("ResellGiftsNoFound")}),A&&(0,N.Y)(gt.A,{className:Lt.notFoundGiftsLink,onClick:C,children:p("ResellGiftsClearFilters")})]}),(0,N.Y)(R.A,{className:(0,s.A)(Lt.resaleStarGiftsContainer),items:v,onLoadMore:S,itemSelector:".starGiftItem",noFastList:!0,preloadBackwards:Ft.bc,scrollContainerClosest:`.${Lt.resaleScreenRoot}`,children:e?.map(e=>(0,N.Y)(Mt,{gift:e,observeIntersection:G,isResale:!0,onClick:c},e.id))})]})})}));var Kt=i(10722),Vt=i(71429),Et=i(36393),qt=i(87094);const Ht=1.5*T.$,zt=(0,a.ph)((0,n.EK)(e=>({theme:(0,o.SJA)(e)}))(({className:e,type:t,sticker:i,observeIntersectionForLoading:n,observeIntersectionForPlaying:r,theme:o})=>{const l=(0,a.li)(),c=(0,qt.A)(l,void 0,"pattern"!==t);return(0,N.Y)("div",{ref:l,className:(0,s.A)("KLFLR9ji",e),style:`width: ${Ht}px; height: ${Ht}px`,children:(0,N.Y)(wt.A,{containerRef:l,sticker:i,size:Ht,shouldPreloadPreview:!0,observeIntersectionForLoading:n,observeIntersectionForPlaying:r,thumbClassName:"fCL5rY2D",customColor:c})})})),Jt={root:"_VgmQnUg",buttonsContainer:"IDlp6U6g",itemIcon:"yuctLnuR",sticker:"VT562JS0",backdropAttributeMenuItemText:"D50wFfRL",menuItemStickerText:"THcGWXSA",menuItemText:"L6EVE2Ux",backdrop:"A29QNxKb",menuItemIcon:"GL4rVsev",item:"qiYcBOYc",menuContentContainer:"EDsBn29z",menu:"ISaNdBwd",left:"e4Kkh_MR",right:"Kz_nCGC3"},Wt=(0,a.ph)((0,n.EK)(e=>{const{resaleGifts:t}=(0,o.nTw)(e);return{attributes:t.attributes,counters:t.counters,filter:t.filter}})(({attributes:e,counters:t,filter:i,dialogRef:r})=>{const o=(0,M.A)(),{updateResaleGiftsFilter:l}=(0,n.ko)(),[c,d]=(0,a.J0)(""),[m,f]=(0,a.J0)(""),[p,h]=(0,a.J0)(""),A=(0,a.Kr)(()=>{const i={model:[],pattern:[],backdrop:[]};for(const a of t??[]){const{attribute:t}=a;if(!a.count)continue;const n=e?.find(e=>"backdrop"===e.type&&"backdrop"===t.type?e.backdropId===t.backdropId:("model"===e.type&&"model"===t.type||"pattern"===e.type&&"pattern"===t.type)&&e.sticker.id===t.documentId);"backdrop"===n?.type&&i.backdrop.push(n),"model"===n?.type&&i.model.push(n),"pattern"===n?.type&&i.pattern.push(n)}return i},[e,t]),g=(0,a.Kr)(()=>{const e=(e,t)=>t.trim()?e.filter(e=>Boolean(e.name?.toLowerCase().includes(t.toLowerCase()))):e;return{model:e(A.model,c),pattern:e(A.pattern,p),backdrop:e(A.backdrop,m)}},[A,c,m,p]),b=(0,a.li)(),{isContextMenuOpen:v,contextMenuAnchor:S,handleContextMenu:G,handleContextMenuClose:C,handleContextMenuHide:y}=(0,Kt.A)(r),I=(0,u.A)(()=>b.current),k=(0,a.li)(),{isContextMenuOpen:Y,contextMenuAnchor:B,handleContextMenu:P,handleContextMenuClose:D,handleContextMenuHide:T}=(0,Kt.A)(r),w=(0,u.A)(()=>k.current),U=(0,a.li)(),{isContextMenuOpen:R,contextMenuAnchor:x,handleContextMenu:L,handleContextMenuClose:O,handleContextMenuHide:K}=(0,Kt.A)(r),V=(0,u.A)(()=>U.current),E=(0,a.li)(),{isContextMenuOpen:q,contextMenuAnchor:H,handleContextMenu:z,handleContextMenuClose:J,handleContextMenuHide:W}=(0,Kt.A)(r),j=(0,u.A)(()=>E.current),_=(0,a.Kr)(()=>{const e=i.sortType;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:Jt.item,onClick:t,children:["byDate"===e&&o("ValueGiftSortByDate"),"byNumber"===e&&o("ValueGiftSortByNumber"),"byPrice"===e&&o("ValueGiftSortByPrice"),(0,N.Y)(F.A,{name:"dropdown-arrows",className:Jt.itemIcon})]})},[o,i]),Q=(0,a.Kr)(()=>{const e=i?.modelAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:Jt.item,onClick:t,children:[0===e&&o("GiftAttributeModel"),e>0&&o("GiftAttributeModelPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:Jt.itemIcon})]})},[o,i]),X=(0,a.Kr)(()=>{const e=i?.backdropAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:Jt.item,onClick:t,children:[0===e&&o("GiftAttributeBackdrop"),e>0&&o("GiftAttributeBackdropPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:Jt.itemIcon})]})},[o,i]),$=(0,a.Kr)(()=>{const e=i?.patternAttributes?.length||0;return({onTrigger:t,isOpen:i})=>(0,N.FD)("div",{className:Jt.item,onClick:t,children:[0===e&&o("GiftAttributeSymbol"),e>0&&o("GiftAttributeSymbolPlural",{count:e},{pluralValue:e}),(0,N.Y)(F.A,{name:"dropdown-arrows",className:Jt.itemIcon})]})},[o,i]),Z=(0,u.A)(e=>{l({filter:{...i,sortType:e}})}),ee=(0,u.A)(()=>{l({filter:{...i,modelAttributes:[]}})}),ie=(0,u.A)(()=>{l({filter:{...i,patternAttributes:[]}})}),ae=(0,u.A)(()=>{l({filter:{...i,backdropAttributes:[]}})}),ne=(0,u.A)(e=>{if(!t)return;const a=i.modelAttributes||[],n=t.find(t=>"model"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!n)return;const r=a.some(e=>e.documentId===n.documentId)?a.filter(e=>e.documentId!==n.documentId):[...a,n];l({filter:{...i,modelAttributes:r}})}),re=(0,u.A)(e=>{if(!t)return;const a=i.patternAttributes||[],n=t.find(t=>"pattern"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!n)return;const r=a.some(e=>e.documentId===n.documentId)?a.filter(e=>e.documentId!==n.documentId):[...a,n];l({filter:{...i,patternAttributes:r}})}),oe=(0,u.A)(e=>{if(!t)return;const a=i.backdropAttributes||[],n=t.find(t=>"backdrop"===t.attribute.type&&t.attribute.backdropId===e.backdropId)?.attribute;if(!n)return;const r=a.some(e=>e.backdropId===n.backdropId)?a.filter(e=>e.backdropId!==n.backdropId):[...a,n];l({filter:{...i,backdropAttributes:r}})}),se=(0,a.hb)(()=>{d("")},[]),le=(0,a.hb)(()=>{f("")},[]),ce=(0,a.hb)(()=>{h("")},[]),de=(0,u.A)(e=>{e.stopPropagation(),e.preventDefault()}),ue=(0,a.li)(),{observe:me}=(0,ut.BL)({rootRef:ue,isDisabled:!B});return(0,N.FD)("div",{className:Jt.root,children:[Boolean(S)&&(0,N.Y)(Vt.A,{isOpen:v,anchor:S,ref:b,className:(0,s.A)(Jt.menu,Jt.left,"with-menu-transitions"),getMenuElement:I,autoClose:!0,onClose:C,onCloseAnimationEnd:y,positionX:"left",children:(0,N.FD)(N.FK,{children:[(0,N.FD)(ze.A,{icon:"sort-by-price",onClick:()=>{Z("byPrice")},children:[(0,N.Y)("div",{className:Jt.menuItemText,children:o("GiftSortByPrice")}),(0,N.Y)(F.A,{className:Jt.menuItemIcon,name:"byPrice"===i?.sortType?"check":"placeholder"})]}),(0,N.FD)(ze.A,{icon:"sort-by-date",onClick:()=>{Z("byDate")},children:[(0,N.Y)("div",{className:Jt.menuItemText,children:o("GiftSortByDate")}),(0,N.Y)(F.A,{className:Jt.menuItemIcon,name:"byDate"===i?.sortType?"check":"placeholder"})]}),(0,N.FD)(ze.A,{icon:"sort-by-number",onClick:()=>{Z("byNumber")},children:[(0,N.Y)("div",{className:Jt.menuItemText,children:o("GiftSortByNumber")}),(0,N.Y)(F.A,{className:Jt.menuItemIcon,name:"byNumber"===i?.sortType?"check":"placeholder"})]})]})}),Boolean(B)&&(0,N.Y)(Vt.A,{isOpen:Y,anchor:B,ref:k,className:(0,s.A)(Jt.menu,Jt.left,"with-menu-transitions"),getMenuElement:w,autoClose:!0,onClose:D,onCloseAnimationEnd:T,children:function(){const e=g.model,t=i.modelAttributes??[],a=0===t.length;return(0,N.FD)("div",{className:Jt.menuContentContainer,ref:ue,children:[(0,N.Y)(Et.A,{onClick:de,className:Jt.search,value:c,onChange:d,onReset:se,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ee,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,N.FD)(ze.A,{onClick:()=>{ne(e)},children:[(0,N.Y)(zt,{className:Jt.sticker,sticker:e.sticker,type:"model",observeIntersectionForLoading:me,observeIntersectionForPlaying:me}),(0,N.Y)("div",{className:Jt.menuItemStickerText,children:e.name}),(0,N.Y)(F.A,{className:Jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(x)&&(0,N.Y)(Vt.A,{isOpen:R,anchor:x,ref:U,className:(0,s.A)(Jt.menu,Jt.right,"with-menu-transitions"),getMenuElement:V,autoClose:!0,onClose:O,onCloseAnimationEnd:K,positionX:"right",children:function(){const e=g.backdrop,t=i.backdropAttributes??[],a=0===t.length;return(0,N.FD)("div",{className:Jt.menuContentContainer,children:[(0,N.Y)(Et.A,{onClick:de,className:Jt.search,value:m,onChange:f,onReset:le,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ae,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.backdropId===e.backdropId);return(0,N.FD)(ze.A,{onClick:()=>{oe(e)},children:[(0,N.Y)(te.A,{className:Jt.backdrop,backgroundColors:[e.centerColor,e.edgeColor]}),(0,N.Y)("div",{className:Jt.backdropAttributeMenuItemText,children:e.name}),(0,N.Y)(F.A,{className:Jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),Boolean(H)&&(0,N.Y)(Vt.A,{isOpen:q,anchor:H,ref:E,className:(0,s.A)(Jt.menu,Jt.right,"with-menu-transitions"),getMenuElement:j,autoClose:!0,onClose:J,onCloseAnimationEnd:W,children:function(){const e=g.pattern,t=i.patternAttributes??[],a=0===t.length;return(0,N.FD)("div",{className:Jt.menuContentContainer,children:[(0,N.Y)(Et.A,{onClick:de,className:Jt.search,value:p,onChange:h,onReset:ce,placeholder:o("Search")}),(0,N.Y)(ze.A,{icon:"select",onClick:ie,disabled:a,children:o("ContextMenuItemSelectAll")}),e.map(e=>{const i=a||t.some(t=>t.documentId===e.sticker.id);return(0,N.FD)(ze.A,{onClick:()=>{re(e)},children:[(0,N.Y)(zt,{className:Jt.sticker,sticker:e.sticker,type:"pattern"}),(0,N.Y)("div",{className:Jt.menuItemStickerText,children:e.name}),(0,N.Y)(F.A,{className:Jt.menuItemIcon,name:i?"check":"placeholder"})]},e.name)})]})}()}),(0,N.FD)("div",{className:Jt.buttonsContainer,children:[(0,N.Y)(_,{onTrigger:G,isOpen:v}),(0,N.Y)(Q,{onTrigger:P,isOpen:Y}),(0,N.Y)(X,{onTrigger:L,isOpen:R}),(0,N.Y)($,{onTrigger:z,isOpen:q})]})]})}));var jt=i(36838);const _t=(0,a.ph)((0,n.EK)(e=>{const{starGifts:t}=e;return{idsByCategory:t?.idsByCategory}})(({ref:e,idsByCategory:t,onCategoryChanged:i,areUniqueStarGiftsDisallowed:n,areLimitedStarGiftsDisallowed:r,isSelf:o,hasMyUnique:l,isPinned:c})=>{let d=(0,a.li)();e&&(d=e);const u=(0,M.A)(),m=Boolean(t?.collectible?.length),[f,p]=(0,a.J0)("all");function h(e){return"all"===e?u("AllGiftsCategory"):"myUnique"===e?u("GiftCategoryMyGifts"):"collectible"===e?u("GiftCategoryCollectibles"):e}function A(e){return(0,N.Y)("div",{className:(0,s.A)("dO7FKYY4",f===e&&"B2lEJk1v"),onClick:()=>function(e){p(e),i(e)}(e),children:h(e)})}return(0,jt.A)(d,void 0,!0),(0,N.FD)("div",{ref:d,className:(0,s.A)("cUjwvN00",c&&"NhJABU3M","no-scrollbar"),children:[A("all"),!n&&!o&&l&&A("myUnique"),(!n||!r)&&m&&A("collectible")]})})),Qt=[0,-50],Xt=3.5*T.$,$t=(0,dt.nF)(e=>e(),200,!0),Zt=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const{starGifts:i,stars:a,currentUserId:n}=e,r=t?.forPeerId?(0,o.PVB)(e,t.forPeerId):void 0,s=Boolean(n&&t?.forPeerId===n),l=r?(0,o.vGo)(e,r?.id):void 0,{resaleGifts:c}=(0,o.nTw)(e),d=c.count,u=!1!==c.isLoading,m=t?.selectedResaleGift;return{boostPerSentGift:e.appConfig.boostsPerSentGift,starGiftsById:i?.byId,starGiftIdsByCategory:i?.idsByCategory,myUniqueGiftsById:e.myUniqueGifts?.byId,myUniqueGiftIds:e.myUniqueGifts?.ids,starBalance:a?.balance,peer:r,isSelf:s,disallowedGifts:l?.disallowedGifts,resaleGiftsCount:d,areResaleGiftsLoading:u,selectedResaleGift:m,tabId:(0,o.nTw)(e).id}})(({modal:e,starGiftsById:t,starGiftIdsByCategory:i,myUniqueGiftsById:o,myUniqueGiftIds:l,starBalance:c,peer:A,isSelf:g,disallowedGifts:b,resaleGiftsCount:v,areResaleGiftsLoading:S,selectedResaleGift:y,tabId:I})=>{const{closeGiftModal:k,openGiftInfoModal:Y,resetResaleGifts:B,loadResaleGifts:P,openGiftInMarket:D,closeResaleGiftsMarket:T,loadMyUniqueGifts:F,openGiftTransferConfirmModal:x,setGiftModalSelectedGift:O,clearActiveGiftAuction:K}=(0,n.ko)(),V=(0,a.li)(),E=(0,a.li)(),q=(0,a.li)(),z=(0,a.li)(),J=(0,a.li)(),W=Boolean(e),j=(0,d.A)(e),_=A&&(0,r.mO)(A)?A:void 0,Q=A&&(0,r.vj)(A)?A:void 0,X=j?.selectedGift,[$,Z]=(0,a.J0)(!1),[ee,te]=(0,a.J0)(!1),[ie,ae]=(0,a.J0)(!1),[ne,re]=(0,a.J0)("all"),[oe,se,le]=(0,w.A)(!1),ce=(0,a.li)(),de=(0,a.Kr)(()=>{if(!b)return;const{shouldDisallowPremiumGifts:e,...t}=b;return!g&&Object.values(t).every(Boolean)},[g,b]),ue=!g&&b?.shouldDisallowUnlimitedStarGifts,me=!g&&b?.shouldDisallowLimitedStarGifts,fe=!g&&b?.shouldDisallowUniqueStarGifts,pe=(0,m.A)(),he=(0,M.A)(),Ae=j?.gifts,ge=(0,a.Kr)(()=>Ae?.sort((e,t)=>e.months-t.months).filter(e=>1===e.users&&e.currency!==G.OUy),[Ae]),be=(0,a.Kr)(()=>{const e=new Map;return ge?(ge.forEach(t=>{const i=Ae?.find(e=>e.currency===G.OUy&&e.months===t.months);i&&e.set(t,i)}),e):e},[Ae,ge]),ve=(0,a.Kr)(()=>ge?.reduce((e,t)=>e.amount<t.amount?e:t),[ge]),{observe:Ne}=(0,ut.BL)({rootRef:J,throttleMs:200,isDisabled:!W}),Ge=Boolean(y)&&!X,Ce=Boolean(X),ye=Ge||Ce||$,Ie=Ce?ie:ee;(0,a.vJ)(()=>{if(y){const e="regularGiftId"in y?y.regularGiftId:y.id;P({giftId:e})}},[y]),(0,a.vJ)(()=>{W||(Z(!1),O({gift:void 0}),re("all"))},[W]),(0,a.vJ)(()=>{ae(Boolean(X&&"id"in X))},[X]);const ke=(0,u.A)(e=>{if(Ce)return;const t=e.currentTarget;$t(()=>{const{scrollTop:e}=t;if(Z(e>150),E.current&&q.current){const{top:e}=q.current.getBoundingClientRect(),{top:t}=E.current.getBoundingClientRect();te(e-t<=0)}if(z.current&&J.current){const{top:e}=z.current.getBoundingClientRect(),{top:t}=J.current.getBoundingClientRect();e-t<=Xt?se():le()}})}),Ye=he("GiftPremiumDescription",{user:(0,C.Yg)(_),link:(0,N.Y)(p.A,{text:he("GiftPremiumDescriptionLinkCaption"),url:he("GiftPremiumDescriptionLink")})},{withNodes:!0}),Be=(0,a.Kr)(()=>Q?he("StarGiftDescriptionChannel",{peer:(0,r.F9)(he,Q)},{withNodes:!0,withMarkdown:!0}):g?he("StarGiftDescriptionSelf",void 0,{withNodes:!0,renderTextFilters:["br"]}):"collectible"===ne?he("StarGiftDescriptionCollectibles"):he("StarGiftDescription",{user:(0,C.Yg)(_)},{withNodes:!0,withMarkdown:!0}),[Q,g,ne,_,he]),Pe=(0,u.A)((e,t)=>{if("resell"===t){if(!("id"in e))return;return Ge?void Y({gift:e,recipientId:j?.forPeerId}):void D({gift:e,tabId:I})}O({gift:e})}),De=(0,u.A)(e=>{if("starGift"===e.type||!o||!A?.id)return;const t=o[e.id];x({gift:t,recipientId:A.id})}),Te=(0,u.A)(()=>{"myUnique"===ne&&F()});const we=(0,u.A)(e=>{re(e)}),Me=(0,u.A)(()=>{O({gift:void 0}),B(),k()}),Fe=(0,u.A)(()=>{if(!Ge)return Ce?(O({gift:void 0}),void K()):void Me();T({tabId:I})}),Ue=(0,u.A)(()=>{ce.current?.()}),Re=(0,u.A)(e=>{ce.current=e}),xe=Ce||Ge,Le=(0,s.A)("animated-close-icon",xe&&"state-back");return(0,N.FD)(h.A,{dialogRef:V,onClose:Me,isOpen:W,isSlim:!0,contentClassName:Lt.content,className:(0,s.A)(Lt.modalDialog,Lt.root),isLowStackPriority:!0,children:[(0,N.Y)(U.A,{className:Lt.closeButton,round:!0,color:"translucent",size:"tiny",onClick:Fe,ariaLabel:pe(xe?"Common.Back":"Common.Close"),children:(0,N.Y)("div",{className:Le})}),(0,N.Y)(H,{className:Lt.balance,balance:c,withAddButton:!0}),(0,N.Y)("div",{className:(0,s.A)(Lt.header,Ge&&Lt.resaleHeader,!ye&&Lt.hiddenHeader,oe&&Lt.noBorder),children:(0,N.Y)(L.Ay,{name:"slideVerticalFade",activeKey:ye?Ge?1:Ie?2:3:0,slideClassName:Lt.headerSlide,children:function(){if(ye){if(Ge){const e=S&&!v;return(0,N.FD)("div",{className:Lt.resaleHeaderContentContainer,children:[(0,N.Y)("h2",{className:Lt.resaleHeaderText,children:y.title}),e&&(0,N.Y)("div",{className:Lt.resaleHeaderDescription,children:he("Loading")}),!e&&void 0!==v&&(0,N.Y)("div",{className:Lt.resaleHeaderDescription,children:he("HeaderDescriptionResaleGifts",{count:v},{withNodes:!0,withMarkdown:!0,pluralValue:v})}),(0,N.Y)(Wt,{dialogRef:V})]})}return(0,N.Y)("h2",{className:Lt.commonHeaderText,children:he(Ie?g?"StarsGiftHeaderSelf":"StarsGiftHeader":"GiftPremiumHeader")})}}()})}),(0,N.FD)(L.Ay,{ref:E,className:Lt.transition,name:"pushSlide",activeKey:Ce?1:Ge?2:0,children:[!Ce&&!Ge&&(0,N.FD)("div",{ref:J,className:(0,s.A)(Lt.main,"custom-scroll"),onScroll:ke,children:[(0,N.FD)("div",{className:Lt.avatars,children:[(0,N.Y)(f.A,{className:Lt.avatar,size:100,peer:A,onMouseMove:Ue}),(0,N.Y)(Se.A,{className:Lt.logoBackground,color:"gold",centerShift:Qt,onRequestAnimation:Re})]}),!g&&!Q&&!b?.shouldDisallowPremiumGifts&&(0,N.FD)(N.FK,{children:[(0,N.Y)("h2",{className:(0,s.A)(Lt.headerText,Lt.center),children:he("GiftPremiumHeader")}),(0,N.Y)("p",{className:(0,s.A)(Lt.description,Lt.center),children:Ye}),(0,N.Y)("div",{className:Lt.premiumGiftsGallery,children:ge?.map(e=>(0,N.Y)(Tt,{option:e,optionByStars:be.get(e),baseMonthAmount:ve?Math.floor(ve.amount/ve.months):void 0,onClick:Pe}))})]}),!de&&(0,N.FD)(N.FK,{children:[(0,N.Y)("h2",{ref:q,className:(0,s.A)(Lt.headerText,Lt.center),children:he(g?"StarsGiftHeaderSelf":"StarsGiftHeader")}),(0,N.Y)("p",{className:(0,s.A)(Lt.description,Lt.starGiftsDescription,Lt.center),children:Be}),(0,N.Y)(_t,{ref:z,areUniqueStarGiftsDisallowed:fe,areLimitedStarGiftsDisallowed:me,isSelf:g,hasMyUnique:Boolean(l?.length),isPinned:oe,onCategoryChanged:we}),(0,N.Y)(L.Ay,{name:"zoomFade",activeKey:(Oe=ne,"all"===Oe?0:"myUnique"===Oe?1:2),className:Lt.starGiftsTransition,children:function(){if("myUnique"===ne)return(0,N.Y)(R.A,{className:Lt.starGiftsContainer,items:l,onLoadMore:Te,scrollContainerClosest:`.${Lt.main}`,itemSelector:".starGiftItem",children:o&&l?.map(e=>{const t=o[e];if(t)return(0,N.Y)(Mt,{gift:t.gift,observeIntersection:Ne,onClick:De,withTransferBadge:!0},e)})});const e=i?.[ne]?.filter(e=>{const i=t?.[e];if(!i)return!1;const{isLimited:a,availabilityResale:n}=i;return me&&a?!fe&&n:!(ue&&!a)});return(0,N.Y)("div",{className:Lt.starGiftsContainer,children:t&&e?.flatMap(e=>{const i=t[e],a=Boolean(i.availabilityResale)&&!fe,n=a&&!i.isSoldOut&&!me,r=[(0,N.Y)(Mt,{gift:i,observeIntersection:Ne,isResale:a&&!n,onClick:Pe},e)];return n&&r.push((0,N.Y)(Mt,{isResale:!0,gift:i,observeIntersection:Ne,onClick:Pe},`resale_${e}`)),r})})}()})]})]}),Ge&&y&&(0,N.Y)(Ot,{onGiftClick:Pe}),Ce&&j?.forPeerId&&(0,N.Y)(kt,{gift:X,giftByStars:be.get(X),peerId:j.forPeerId})]})]});var Oe}));const ei=(0,a.ph)((0,n.EK)(e=>{const{currentUserId:t}=e;return{currentUserId:t,userIds:e.contactList?.userIds}})(({modal:e,currentUserId:t,userIds:i})=>{const{closeGiftRecipientPicker:s,openGiftModal:l}=(0,n.ko)(),c=(0,m.A)(),d=e,[f,p]=(0,a.J0)(""),h=(0,a.Kr)(()=>{const e=(0,n.mS)(),a=i?i.concat(t):void 0,s=a?(0,r.PU)({ids:a,query:f}):[];return(0,I.A)((0,y.Am)(s).filter(t=>(0,o.X2D)(e,t)),void 0,[t])},[t,f,i]),A=(0,u.A)(e=>{l({forUserId:e}),s()});return(0,N.Y)(Y.A,{className:"W3JMs1YE",isOpen:d,onClose:s,title:c("GiftTelegramPremiumOrStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,children:(0,N.Y)(k.A,{className:"wOipz1Y_",itemIds:h,filterValue:f,filterPlaceholder:c("Search"),onSelectedIdChange:A,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,forceShowSelf:!0})})}));var ti=i(79089),ii=i(18501);function ai({originalDetails:e,recipient:t,sender:i,onOpenChat:a,lang:n}){const{recipientId:o,senderId:s,date:l,message:c}=e,d=(0,z.L2)(1e3*l,n.code,!0),u=(0,N.Y)(gt.A,{onClick:()=>a(o),isPrimary:!0,children:(0,r.F9)(n,t)});if(!i||s===o)return c?n("GiftInfoPeerOriginalInfoText",{peer:u,text:(0,ii.fd)(c),date:d},{withNodes:!0}):n("GiftInfoPeerOriginalInfo",{peer:u,date:d},{withNodes:!0});const m=(0,N.Y)(gt.A,{onClick:()=>a(i.id),isPrimary:!0,children:(0,r.F9)(n,i)});return c?n("GiftInfoPeerOriginalInfoTextSender",{peer:u,sender:m,text:(0,ii.fd)(c),date:d},{withNodes:!0}):n("GiftInfoPeerOriginalInfoSender",{peer:u,date:d,sender:m},{withNodes:!0})}var ni=i(25404);const ri={root:"Ef0cKSqQ",giftPreview:"IvuNzslN",backdrop:"dNukis4X",arrow:"oufsMLLF"},oi=4*T.$,si=3*T.$,li=(0,a.ph)(({peer:e,gift:t})=>{const i=(0,a.Kr)(()=>(0,X.uc)(t),[t]);if(i)return(0,N.FD)("div",{className:ri.root,children:[(0,N.FD)("div",{className:ri.giftPreview,children:[(0,N.Y)(te.A,{className:ri.backdrop,backgroundColors:[i.backdrop.centerColor,i.backdrop.edgeColor],patternIcon:i.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,N.Y)(ee.A,{className:ri.sticker,size:si,sticker:i.model?.sticker})]}),(0,N.Y)(F.A,{name:"next",className:ri.arrow}),(0,N.Y)(f.A,{peer:e,size:oi,className:ri.avatar})]})});var ci=i(94189);const di={modal:"nnublcCk",checkBox:"fjE0wGvw",checkBoxDescription:"tepUTe4z",upgradeIcon:"lgyInH5K",descriptionConfirm:"BJh2Tufh",titleConfirm:"gA102W1G",header:"p7FTs7_p",title:"pIbzzTir",description:"CCPfr26t",warningDescription:"eEsRJVa1",modalContent:"o9rFZ6By",moreMenuButton:"EMwExRMy",closeButton:"jQv0ZSEW",giftResalePriceContainer:"BN8gf5y6",starAmountIcon:"_5guecUe",giftResalePriceStar:"H_q8o2vY",headerButton:"WA0INleU",left:"aOhTHZlf",right:"rJOB1u5Q",footer:"bho0GTYt",footerDescription:"VUylTszM",footerHint:"mxS8kDnA",buyButton:"i1MmnrPG",unknown:"zDauXmpS",giftValue:"w_E4LkUj",uniqueValue:"uAjIRJva",uniqueAttribute:"OJQnkf17",attributeName:"dq7wCHJb",uniqueGift:"I6o_pGAm",modalHeader:"ie9tImaj",modalCloseButton:"p38RBGdC",ownerAddress:"DavMRg4Q",copyIcon:"SLX5tX8C",messageContainer:"oW5T3mkV",removeMessageButton:"TrW2LVm5"},ui=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.gift,a=i&&"gift"in i,n=e.currentUserId,s=a&&i.fromId,l=s?(0,o.PVB)(e,s):void 0,c=t?.peerId?(0,o.PVB)(e,t.peerId):void 0,d=c&&(0,r.vj)(c)?c:void 0,u=d&&(0,C.ub)(d,"postMessages"),m=(0,o.mBe)(e,n),f=t?.recipientId&&n!==t.recipientId?(0,o.PVB)(e,t.recipientId):void 0,p=m?.emojiStatus,h=e.collectibleEmojiStatuses?.statuses,A=a?i.gift:i,g="starGiftUnique"===A?.type&&A.releasedByPeerId;return{fromPeer:l,targetPeer:c,releasedByPeer:g?(0,o.PVB)(e,g):void 0,currentUserId:n,starGiftMaxConvertPeriod:e.appConfig.starGiftMaxConvertPeriod,tonExplorerUrl:e.appConfig.tonExplorerUrl,hasAdminRights:u,currentUserEmojiStatus:p,collectibleEmojiStatuses:h,currentUser:m,recipientPeer:f}})(({modal:e,fromPeer:t,targetPeer:i,releasedByPeer:c,currentUserId:h,starGiftMaxConvertPeriod:A,hasAdminRights:g,currentUserEmojiStatus:b,collectibleEmojiStatuses:v,tonExplorerUrl:S,currentUser:C,recipientPeer:y})=>{const{closeGiftInfoModal:I,changeGiftVisibility:k,convertGiftToStars:Y,openChatWithInfo:B,focusMessage:P,openGiftUpgradeModal:D,showNotification:T,buyStarGift:R,closeGiftModal:x,openGiftInfoValueModal:L,updateResaleGiftsFilter:O,openGiftInMarket:K,openGiftDescriptionRemoveModal:E}=(0,n.ko)(),[q,H,W]=(0,w.A)(),j=(0,M.A)(),_=(0,m.A)(),[$,Z]=(0,a.J0)(!1),[te,ie]=(0,a.J0)(!1),ae=(0,a.li)(),ne=(0,a.li)(),re=(0,a.li)(),{isContextMenuOpen:oe,contextMenuAnchor:se,handleContextMenu:le,handleContextMenuClose:ce,handleContextMenuHide:de}=(0,Kt.A)(ae),ue=(0,u.A)(()=>{Pe&&nt?.pattern&&(K({gift:Pe}),O({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[],patternAttributes:[{type:"pattern",documentId:nt.pattern.sticker.id}]}}))}),me=(0,u.A)(()=>{Pe&&nt?.backdrop&&(K({gift:Pe}),O({filter:{sortType:"byDate",modelAttributes:[],backdropAttributes:[{type:"backdrop",backdropId:nt.backdrop.backdropId}],patternAttributes:[]}}))}),fe=(0,u.A)(()=>{Pe&&nt?.model&&(K({gift:Pe}),O({filter:{sortType:"byDate",modelAttributes:[{type:"model",documentId:nt.model.sticker.id}],backdropAttributes:[],patternAttributes:[]}}))}),he=Boolean(e),Ae=(0,d.A)(e),ge=(0,d.A)(t),be=(0,d.A)(i),ve=be&&(0,r.vj)(be),{gift:Se}=Ae||{},Ce=Se&&"gift"in Se,ye=Ce?Se:void 0,Ie=ye?.fromId===h,ke=ye&&A&&ye.date+A-(0,Ye.Fm)()||0,Be=Math.ceil(ke/60/60/24),Pe=Ce?Se.gift:Se,De=Pe&&(0,X.yQ)(Pe),Te=ke>0&&Boolean(ye?.starsToConvert),we=Pe&&"starGiftUnique"===Pe.type,Fe=we?Pe:void 0,Ue=(0,a.Kr)(()=>{if(Pe&&"starGiftUnique"===Pe.type){if(c){const e=`@${(0,ti.Kl)(c)}`||(0,r.F9)(j,c),t=(0,r.mO)(c)?j("ActionFallbackUser"):j("ActionFallbackChannel");return j("GiftInfoCollectibleBy",{number:Pe.number,owner:e||t},{withNodes:!0,withMarkdown:!0})}return j("GiftInfoCollectible",{number:Pe.number})}},[Pe,c,j]),Re="starGiftUnique"===Pe?.type?Pe.slug:void 0,xe=(0,a.Kr)(()=>{if(Re)return v?.find(e=>"collectible"===e.type&&e.slug===Re)},[Re,v]),Le=Boolean(xe),Oe=Boolean(ye?.upgradeMsgId),Ke=!Oe&&ye?.inputGift&&(ve?g:"starGift"===Pe?.type?be?.id===h:Pe?.ownerId===h||Le);function Ve(e){if(!we)return;const t=Pe.resellPrice;return t?Pe?.resaleTonOnly||e?t.find(e=>e.currency===G.ykW):t.find(e=>e.currency===G.OUy):void 0}const Ee=Ve(),He=Ve(te),ze=Ee?.currency===G.ykW&&we?Pe.resellPrice?.find(e=>e.currency===G.OUy):void 0,Je=!Le&&"starGiftUnique"===Pe?.type&&Pe.ownerId!==h&&Boolean(Ee),We=(()=>{if(!we)return;const{ownerName:e,ownerId:t}=Pe,i=(0,n.mS)(),a=t?(0,o.PVB)(i,t):void 0;return a?(0,r.F9)(j,a):e})(),je=(0,u.A)(()=>{I()}),_e=(0,u.A)(()=>{const e=Ie?be:ge;if(!ye?.upgradeMsgId||!e)return;const{upgradeMsgId:t}=ye;P({chatId:e.id,messageId:t}),je()}),Qe=(0,u.A)(()=>{const{inputGift:e,isUnsaved:t}=ye;k({gift:e,shouldUnsave:!t}),je()}),Xe=(0,u.A)(()=>{const{inputGift:e}=ye;Y({gift:e}),W(),je()}),$e=(0,u.A)(()=>{if(!(ye?.inputGift&&ye.dropOriginalDetailsStars&&Pe&&nt))return;const{originalDetails:e}=nt;e&&E({gift:ye,price:ye.dropOriginalDetailsStars,details:e})}),Ze=(0,u.A)(()=>{if(!ye)return;const e=be?.id;D({giftId:ye.gift.id,gift:ye,peerId:e})}),et=(0,u.A)(()=>{"starGiftUnique"===Pe?.type&&Ve()&&Z(!0)}),tt=(0,u.A)(()=>{Z(!1)}),it=(0,u.A)(()=>{const e=y||C,t=Ve(te);e&&t&&"starGiftUnique"===Pe?.type&&(tt(),x(),R({peerId:e.id,slug:Pe.slug,price:t}))}),at=(0,u.A)(()=>{Pe&&"starGiftUnique"===Pe.type&&L({gift:Pe})}),nt=(0,a.Kr)(()=>Pe&&(0,X.uc)(Pe),[Pe]),rt=(0,u.A)(()=>Je?(0,N.FD)(U.A,{className:di.buyButton,onClick:et,children:[(0,N.Y)("div",{children:j("ButtonBuyGift",{stars:Ee?.currency===G.ykW?(0,pe.Ms)(j,Ee.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ee?.amount,{asFont:!0})},{withNodes:!0})}),Ee?.currency===G.ykW&&Boolean(ze)&&(0,N.Y)("div",{className:di.footerHint,children:j("GiftBuyEqualsTo",{stars:(0,pe.U2)(j,ze.amount,{asFont:!0})},{withNodes:!0})})]}):Oe?(0,N.Y)(U.A,{onClick:_e,children:j("GiftInfoViewUpgraded")}):Ke&&ye?.alreadyPaidUpgradeStars&&!ye.upgradeMsgId?(0,N.Y)(U.A,{isShiny:!0,onClick:Ze,iconName:"arrow-down-circle",iconClassName:di.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgradeForFree")}):Ke&&ye?.canUpgrade&&!ye.upgradeMsgId?(0,N.Y)(U.A,{isShiny:!0,onClick:Ze,iconName:"arrow-down-circle",iconClassName:di.upgradeIcon,iconAlignment:"end",children:j("GiftInfoUpgrade")}):ye?.prepaidUpgradeHash?(0,N.Y)(U.A,{isShiny:!0,onClick:Ze,iconName:"arrow-down-circle",iconClassName:di.upgradeIcon,iconAlignment:"end",children:j("GiftAnUpgradeButton")}):(0,N.Y)(U.A,{onClick:je,children:j("OK")})),ot=(0,a.Kr)(()=>{if(!Pe)return;let e="";return"starGift"===Pe.type&&(Pe.firstSaleDate&&(e+=`${j("GiftInfoFirstSale")} ${(0,z.L2)(1e3*Pe.firstSaleDate,j.code,!0)}`),Pe.lastSaleDate&&(e+="\n",e+=`${j("GiftInfoLastSale")} ${(0,z.L2)(1e3*Pe.lastSaleDate,j.code,!0)}`)),e},[Pe,j]),st=(0,a.Kr)(()=>{if(!Se||!Pe)return;const{fromId:e,isNameHidden:t,starsToConvert:i,isUnsaved:a,isConverted:d,upgradeMsgId:u}=ye||{},m=Te&&Boolean(i),h=t&&be,A=ye?.isRefunded||!ye&&"starGift"===Pe?.type,g=(()=>{if(!ye)return j("GiftInfoSoldOutDescription");if(!ve){if(ye.isRefunded)return j("GiftInfoDescriptionRefunded");if(ye.upgradeMsgId)return j("GiftInfoDescriptionUpgraded");if(Ke&&ye.canUpgrade&&ye.alreadyPaidUpgradeStars&&!ye.upgradeMsgId)return j("GiftInfoDescriptionUpgrade2");if(ye.canUpgrade&&Ke)return Ke?j("GiftInfoDescriptionFreeUpgrade"):j("GiftInfoPeerDescriptionFreeUpgradeOut",{peer:(0,r.F9)(j,be)});if(Ke||Ie)return d&&m?Ke?j("GiftInfoDescriptionConverted",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoPeerDescriptionOutConverted",{amount:i,peer:(0,r.F9)(j,be)},{pluralValue:i,withNodes:!0,withMarkdown:!0}):ye.canUpgrade&&Ke?m?j("GiftInfoDescriptionUpgrade",{amount:i},{pluralValue:i,withNodes:!0,withMarkdown:!0}):j("GiftInfoDescriptionUpgradeRegular"):Ke?m?j("GiftInfoDescription",{amount:i},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoDescriptionRegular"):m?j("GiftInfoPeerDescriptionOut",{amount:i,peer:(0,r.F9)(j,be)},{withNodes:!0,withMarkdown:!0,pluralValue:i}):j("GiftInfoPeerDescriptionOutRegular",{peer:(0,r.F9)(j,be)})}})(),b=(0,N.FD)("div",{className:di.modalHeader,children:[(0,N.Y)(U.A,{className:di.closeButton,round:!0,color:"translucent-white",size:"tiny",iconName:"close",ariaLabel:j("Close"),onClick:je}),(0,N.Y)(U.A,{ref:ae,className:di.moreMenuButton,round:!0,color:"translucent-white",size:"tiny",iconName:"more","aria-haspopup":"menu","aria-label":j("AriaMoreButton"),onContextMenu:le,onClick:le}),Boolean(Ee?.amount)&&(0,N.Y)("div",{className:di.giftResalePriceContainer,children:Ee.currency===G.ykW?(0,pe.Ms)(j,Ee.amount,{className:di.giftResalePriceStar,shouldConvertFromNanos:!0}):(0,pe.U2)(j,Ee.amount,{asFont:!0,className:di.giftResalePriceStar})})]}),v=we&&(0,N.Y)("div",{ref:re,className:(0,s.A)(di.header,di.uniqueGift),children:(0,N.Y)(Me,{backdropAttribute:nt.backdrop,patternAttribute:nt.pattern,modelAttribute:nt.model,title:Pe.title,subtitle:Ue,subtitlePeer:c,showManageButtons:Ke,savedGift:ye})}),C=(0,N.FD)("div",{className:di.header,children:[(0,N.Y)(ee.A,{className:di.giftSticker,sticker:De,size:120}),(0,N.Y)("h1",{className:di.title,children:we?Pe.title:j(ye?Ke?"GiftInfoReceived":"GiftInfoTitle":"GiftInfoSoldOutTitle")}),Boolean(g)&&(0,N.Y)("p",{className:(0,s.A)(di.description,A&&di.warningDescription),children:g})]}),y=[];if("starGift"===Pe.type){(e||t)&&y.push([j("GiftInfoFrom"),e?{chatId:e}:(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{size:"small",peer:Q.I5}),(0,N.Y)("span",{className:di.unknown,children:_(Q.I5.titleKey)})]})]),ye?.date&&y.push([j("GiftInfoDate"),(0,N.Y)("span",{title:ot,children:(0,z.L2)(1e3*ye.date,j.code,!0)})]),Pe.firstSaleDate&&!ye&&y.push([j("GiftInfoFirstSale"),(0,z.L2)(1e3*Pe.firstSaleDate,j.code,!0)]),Pe.lastSaleDate&&!ye&&y.push([j("GiftInfoLastSale"),(0,z.L2)(1e3*Pe.lastSaleDate,j.code,!0)]);const a=Pe.stars+(ye?.alreadyPaidUpgradeStars||0);y.push([j("GiftInfoValue"),(0,N.FD)("div",{className:di.giftValue,children:[(0,pe.U2)(j,a,{className:di.starAmountIcon}),Ke&&Te&&Boolean(i)&&(0,N.Y)(V.A,{onClick:H,children:j("GiftInfoConvert",{amount:i},{pluralValue:i})})]})]),Pe.availabilityTotal&&y.push([j("GiftInfoAvailability"),j("GiftInfoAvailabilityValue",{count:Pe.availabilityRemains||0,total:Pe.availabilityTotal},{pluralValue:Pe.availabilityRemains||0})]),Pe.upgradeStars&&!u&&y.push([j("GiftInfoStatus"),(0,N.Y)("div",{className:di.giftValue,children:j("GiftInfoStatusNonUnique")})]),ye?.message&&y.push([void 0,(0,ii.fd)(ye.message)])}if(we){const{ownerName:e,ownerAddress:t,ownerId:i}=Pe,a=i?(0,o.PVB)((0,n.mS)(),i):void 0,{model:r,backdrop:s,pattern:c,originalDetails:d}=nt||{};if(t?y.push([j("GiftInfoOwner"),(0,N.FD)("span",{className:di.ownerAddress,onClick:()=>{(0,Ne.eM)(t),T({message:{key:"WalletAddressCopied"},icon:"copy"})},children:[t,(0,N.Y)(F.A,{className:di.copyIcon,name:"copy"})]})]):(a||e)&&y.push([j("GiftInfoOwner"),i?{chatId:i,withEmojiStatus:!0}:e||""]),r&&y.push([j("GiftAttributeModel"),(0,N.FD)("span",{className:di.uniqueAttribute,children:[(0,N.Y)("span",{className:di.attributeName,onClick:fe,children:r.name}),(0,N.Y)(V.A,{children:(0,J.l9)(r.rarityPercent)})]})]),s&&y.push([j("GiftAttributeBackdrop"),(0,N.FD)("span",{className:di.uniqueAttribute,children:[(0,N.Y)("span",{className:di.attributeName,onClick:me,children:s.name}),(0,N.Y)(V.A,{children:(0,J.l9)(s.rarityPercent)})]})]),c&&y.push([j("GiftAttributeSymbol"),(0,N.FD)("span",{className:di.uniqueAttribute,children:[(0,N.Y)("span",{className:di.attributeName,onClick:ue,children:c.name}),(0,N.Y)(V.A,{children:(0,J.l9)(c.rarityPercent)})]})]),y.push([j("GiftInfoAvailability"),j("GiftInfoIssued",{issued:Pe.issuedCount,total:Pe.totalCount})]),Pe.valueAmount&&Pe.valueCurrency&&y.push([j("GiftInfoValue"),(0,N.FD)("span",{className:di.uniqueValue,children:["~"," ",(0,l.Ad)(Pe.valueAmount,Pe.valueCurrency,j.code),(0,N.Y)(V.A,{onClick:at,children:j("GiftInfoValueLinkMore")})]})]),d){const{recipientId:e,senderId:t}=d,i=(0,n.mS)(),a=e=>{B({id:e}),I()},r=ai({originalDetails:d,recipient:(0,o.PVB)(i,e),sender:t?(0,o.PVB)(i,t):void 0,onOpenChat:a,lang:j});y.push([void 0,(0,N.FD)("div",{className:di.messageContainer,children:[(0,N.Y)("div",{children:r}),Boolean(ye?.dropOriginalDetailsStars)&&(0,N.Y)(U.A,{round:!0,className:di.removeMessageButton,size:"smaller",color:"translucent",ariaLabel:"Delete original details",onClick:$e,iconName:"delete"})]})])}}const k=S&&we&&Pe.giftAddress&&`${S}${Pe.giftAddress}`,Y=(0,N.FD)("div",{className:di.footer,children:[(Ke||k||Je)&&(0,N.FD)("div",{className:di.footerDescription,children:[k&&(0,N.Y)("div",{children:j("GiftInfoTonText",{link:(0,N.Y)(p.A,{url:k,shouldSkipModal:!0,text:j("GiftInfoTonLinkText")})},{withNodes:!0})}),Ke&&(0,N.Y)("div",{children:j(`GiftInfo${ve?"Channel":""}${a?"Hidden":"Saved"}`,{link:(0,N.Y)(gt.A,{isPrimary:!0,onClick:Qe,children:j("GiftInfoSaved"+(a?"Show":"Hide"))})},{withNodes:!0})}),!Je&&h&&(0,N.Y)("div",{children:j("GiftInfoSenderHidden")}),Je&&We&&(0,N.Y)("div",{children:j("GiftInfoBuyGift",{user:We},{withNodes:!0})})]}),rt()]});return{modalHeader:we?b:void 0,header:we?v:C,tableData:y,footer:Y}},[Se,ye,be,De,j,Ke,Te,Ie,_,S,Pe,nt,rt,ve,we,ot,Je,We,Ee,Ue,c,ue,me,fe,le]),lt=(0,u.A)(()=>re.current),ct=(0,u.A)(()=>ae.current),dt=(0,u.A)(()=>ne.current),ut=(0,u.A)(()=>({withPortal:!0})),mt=se&&Se&&(0,N.Y)(Vt.A,{ref:ne,isOpen:oe,anchor:se,className:"gift-context-menu with-menu-transitions",autoClose:!0,withPortal:!0,onClose:ce,onCloseAnimationEnd:de,positionX:"right",getTriggerElement:ct,getRootElement:lt,getMenuElement:dt,getLayout:ut,children:(0,N.Y)(ni.A,{peerId:Ae.peerId,gift:Se,canManage:Ke,collectibleEmojiStatuses:v,currentUserEmojiStatus:b})});return(0,N.FD)(N.FK,{children:[(0,N.Y)(Ge.A,{isOpen:he,modalHeader:st?.modalHeader,header:st?.header,hasBackdrop:we,tableData:st?.tableData,footer:st?.footer,className:di.modal,contentClassName:di.modalContent,onClose:je,withBalanceBar:Boolean(Je),currencyInBalanceBar:He?.currency,isLowStackPriority:!0}),mt,Fe&&C&&Boolean(He)&&(0,N.FD)(ci.A,{isOpen:$,noDefaultTitle:!0,onClose:tt,confirmLabel:j("ButtonBuyGift",{stars:He?.currency===G.ykW?(0,pe.Ms)(j,He.amount,{shouldConvertFromNanos:!0}):(0,pe.U2)(j,He.amount,{asFont:!0})},{withNodes:!0}),confirmHandler:it,children:[Fe.resaleTonOnly&&(0,N.Y)("div",{className:di.descriptionConfirm,children:j("ConfirmBuyGiftForTonDescription")}),(0,N.Y)(li,{peer:y||C,gift:Fe}),(0,N.Y)("div",{className:di.titleConfirm,children:j("TitleConfirmPayment")}),!y&&(0,N.Y)("p",{children:j("GiftBuyConfirmDescription",{gift:j("GiftUnique",{title:Fe.title,number:Fe.number}),stars:He?.currency===G.ykW?(0,pe.QH)(j,He.amount,!0):(0,pe.Kk)(j,He.amount)},{withNodes:!0,withMarkdown:!0})}),y&&(0,N.Y)("p",{children:j("GiftBuyForPeerConfirmDescription",{gift:j("GiftUnique",{title:Fe.title,number:Fe.number}),stars:He?.currency===G.ykW?(0,pe.QH)(j,He.amount,!0):(0,pe.Kk)(j,He.amount),peer:(0,r.F9)(j,y)},{withNodes:!0,withMarkdown:!0})}),!Fe.resaleTonOnly&&(0,N.FD)(N.FK,{children:[(0,N.Y)(qe.A,{className:di.checkBox,label:j("LabelPayInTON"),checked:te,onCheck:ie}),(0,N.Y)("div",{className:di.checkBoxDescription,children:j("DescriptionPayInTON")})]})]}),ye&&(0,N.FD)(ci.A,{isOpen:q,onClose:W,confirmHandler:Xe,title:j("GiftInfoConvertTitle"),children:[(0,N.Y)("div",{children:j("GiftInfoPeerConvertDescription",{amount:(0,pe.Kk)(j,ye.starsToConvert),peer:(0,r.F9)(j,ge)},{withNodes:!0,withMarkdown:!0})}),Te&&(0,N.Y)("div",{children:j("GiftInfoConvertDescriptionPeriod",{count:Be},{withNodes:!0,withMarkdown:!0,pluralValue:Be})}),(0,N.Y)("div",{children:j("GiftInfoConvertDescription2")})]})]})})),mi="hspYTy7V",fi=(0,a.ph)(({modal:e})=>{const{closeGiftInfoValueModal:t,openUrl:i,openGiftInMarket:r}=(0,n.ko)(),o=(0,M.A)(),s=Boolean(e),c=(0,d.A)(e),m=(0,u.A)(()=>{e?.valueInfo.fragmentListedUrl&&i({url:e.valueInfo.fragmentListedUrl})}),f=(0,u.A)(()=>{e?.gift&&r({gift:e.gift})}),p=(0,a.Kr)(()=>{if(!c)return;const{gift:e,valueInfo:t}=c,i=(0,X.uc)(e);if(!i)return;const a=(0,N.FD)("div",{className:"v4GJBsdC",children:[(0,N.Y)(ee.A,{className:"lJodRD0R",sticker:i.model.sticker,size:120}),(0,N.Y)(U.A,{pill:!0,size:"tiny",fluid:!0,nonInteractive:!0,children:(0,l.Ad)(t.value,t.currency,o.code)}),(0,N.Y)("div",{className:"VjWaO8un",children:o("GiftValueDescription",{giftName:e.title},{withMarkdown:!0,withNodes:!0})})]}),n=[];n.push([o("GiftValueTitleInitialSale"),(0,z.A)(1e3*t.initialSaleDate,o.code)]),n.push([o("GiftValueTitleInitialPrice"),(0,N.FD)("span",{className:"K7zsAhVt",children:[(0,pe.U2)(o,t.initialSaleStars,{className:"Xw91xwpe"})," (~ ",(0,l.Ad)(t.initialSalePrice,t.currency,o.code),")"]})]),t.lastSaleDate&&n.push([o("GiftValueTitleLastSale"),(0,z.A)(1e3*t.lastSaleDate,o.code)]),t.lastSalePrice&&n.push([o("GiftValueTitleLastPrice"),(0,l.Ad)(t.lastSalePrice,t.currency,o.code)]),t.floorPrice&&n.push([o("GiftValueTitleMinimumPrice"),(0,l.Ad)(t.floorPrice,t.currency,o.code)]),t.averagePrice&&n.push([o("GiftValueTitleAveragePrice"),(0,l.Ad)(t.averagePrice,t.currency,o.code)]);const r=Boolean(t.fragmentListedUrl&&t.fragmentListedCount),s=Boolean(t.listedCount&&t.listedCount);return{header:a,tableData:n,footer:(r||s)&&(0,N.FD)("div",{className:"OJDo2xUd",children:[r&&(0,N.FD)(U.A,{isText:!0,onClick:m,noForcedUpperCase:!0,size:"tiny",children:[o.number(t.fragmentListedCount),(0,N.Y)(ee.A,{className:mi,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnFragment")]}),s&&(0,N.FD)(U.A,{isText:!0,noForcedUpperCase:!0,size:"tiny",onClick:f,children:[o.number(t.listedCount),(0,N.Y)(ee.A,{className:mi,sticker:i.model.sticker,size:24}),o("GiftValueForSaleOnTelegram")]})]})}},[o,c,m,f]);if(p)return(0,N.Y)(Ge.A,{isOpen:s,onClose:t,header:p.header,tableData:p.tableData,footer:p.footer})}),pi=(0,a.ph)(({modal:e})=>{const{closeLockedGiftModal:t}=(0,n.ko)(),i=(0,M.A)(),r=(0,u.A)(()=>{t()}),o=(0,a.hb)(()=>{if(!e)return"";if(e.untilDate){const t=e.untilDate?e.untilDate-(0,Ye.Fm)():0;return i("GiftLockedMessage",{relativeDate:(0,z.A$)(i,t)},{withNodes:!0,withMarkdown:!0})}return e.reason?(0,ii.fd)(e.reason):i("TitleGiftLocked")},[e,i]);return(0,N.FD)(h.A,{isOpen:Boolean(e),className:"narrow",onClose:r,title:i("TitleGiftLocked"),headerClassName:"AqB1qB8W",children:[(0,N.Y)("p",{className:"pA8Bz4TW",children:o()}),(0,N.Y)(U.A,{onClick:r,children:i("OK")})]})});var hi=i(40664);const Ai=(0,a.ph)((0,n.EK)(e=>{const t=e.appConfig.starsStargiftResaleCommissionPermille,i=t?t/1e3:void 0,a=e.appConfig.starsStargiftResaleAmountMin||0,n=e.appConfig.starsStargiftResaleAmountMax,r=e.appConfig.starsUsdWithdrawRateX1000,o=r?r/1e3:1,s=e.appConfig.tonStargiftResaleCommissionPermille,c=s?s/1e3:0,d=(0,l.wD)(e.appConfig.tonStargiftResaleAmountMin||0),u=e.appConfig.tonStargiftResaleAmountMax;return{starsStargiftResaleCommissionPermille:i,starsStargiftResaleAmountMin:a,starsStargiftResaleAmountMax:n,starsUsdWithdrawRate:o,tonStargiftResaleCommissionPermille:c,tonStargiftResaleAmountMin:d,tonStargiftResaleAmountMax:u&&(0,l.wD)(u),tonUsdRate:e.appConfig.tonUsdRate}})(({modal:e,starsStargiftResaleCommissionPermille:t,starsStargiftResaleAmountMin:i,starsStargiftResaleAmountMax:r,starsUsdWithdrawRate:o,tonStargiftResaleCommissionPermille:s,tonStargiftResaleAmountMin:c,tonStargiftResaleAmountMax:m,tonUsdRate:f})=>{const{closeGiftResalePriceComposerModal:p,closeGiftInfoModal:A,updateStarGiftPrice:g,showNotification:b}=(0,n.ko)(),v=Boolean(e),[S,G]=(0,a.J0)(void 0),[C,y]=(0,a.J0)(!1),I=(0,d.A)(e),{gift:k}=I||{},Y=k&&"gift"in k?k:void 0,B=Boolean(S),P=(0,M.A)(),D=(0,u.A)(e=>{const t=e.target.value,i=parseFloat(t),a=C?m:r,n=""===t||Number.isNaN(i)?void 0:a?Math.min(i,a):i;G(n)}),T=(0,u.A)(()=>{p()}),w=(0,u.A)(()=>{Y&&"starGiftUnique"===Y.gift.type&&Y.inputGift&&S&&(p(),A(),g({gift:Y.inputGift,price:{currency:C?"TON":"XTR",amount:C?(0,l.tT)(S):S,nanos:0}}),b({icon:"sell-outline",message:{key:"NotificationGiftIsSale",variables:{gift:P("GiftUnique",{title:Y.gift.title,number:Y.gift.number})}}}))}),F=C?s:t,R=C?c:i,x=B&&S>=R;return(0,N.FD)(h.A,{isOpen:v,title:P(C?"PriceInTON":"PriceInStars"),hasCloseButton:!0,isSlim:!0,onClose:T,children:[(0,N.Y)("div",{className:"ElDo1Bru",children:(0,N.Y)(hi.A,{label:P(C?"EnterPriceInTon":"EnterPriceInStars"),onChange:D,value:S?.toString(),inputMode:"numeric",tabIndex:0,teactExperimentControlled:!C})}),(0,N.FD)("div",{className:"SGFmA4kL",children:[(0,N.FD)("span",{children:[!x&&Boolean(F)&&P("DescriptionComposerGiftMinimumPrice",{stars:C?(0,pe.QH)(P,R):(0,pe.Kk)(P,R)},{withMarkdown:!0,withNodes:!0}),x&&(()=>{const e=F?Number((S*F).toFixed()):S;return P("DescriptionComposerGiftResalePrice",{stars:C?(0,pe.QH)(P,e):(0,pe.Kk)(P,e)},{withMarkdown:!0,withNodes:!0})})()]}),x&&Boolean(C?f:o)&&(0,N.Y)("span",{className:"r9R0VR_w",children:`≈ ${(0,l.Ad)(C?(0,l.C)(S,f):S*o,"USD",P.code)}`})]}),(0,N.Y)(qe.A,{className:"yt_nODdj",label:P("OnlyAcceptTON"),checked:C,onCheck:y}),(0,N.Y)("div",{className:"pWjQiY4m",children:P("OnlyAcceptTONDescription")}),(0,N.FD)(U.A,{noForcedUpperCase:!0,disabled:!x,onClick:w,children:[x&&P("ButtonSellGift",{stars:C?(0,pe.Ms)(P,S):(0,pe.U2)(P,S,{asFont:!0})},{withNodes:!0}),!x&&P("Sell")]})]})}));var gi=i(58554),bi=i(32625),vi=i(5463);const Ni={footer:"EWaVCxY4",footerButton:"_Dt6RSQV",link:"Xu0TqkRj",priceDecreaseTimer:"ryB8xKvy"},Si=(0,a.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.recipientId;return{recipient:i?(0,o.PVB)(e,i):void 0}})(({modal:e,recipient:t})=>{const{closeGiftUpgradeModal:i,closeGiftInfoModal:o,upgradeGift:s,upgradePrepaidGift:l,openStarGiftPriceDecreaseInfoModal:c,shiftGiftUpgradeNextPrice:m}=(0,n.ko)(),f=Boolean(e),p=(0,d.A)(e),h=(0,d.A)(t),[A,g]=(0,a.J0)(!1),b=Boolean(p?.gift?.prepaidUpgradeHash),[v,S]=(0,a.J0)(),G=(0,M.A)(),y=(0,u.A)(()=>i()),I=(0,u.A)(()=>{m()}),k=p?.nextPrices?.[0],Y=k?.date,B=p?.currentUpgradeStars,P=(0,u.A)(()=>{const e=p?.gift;if(e){if(b&&e.prepaidUpgradeHash&&h){if(!B)return;return l({peerId:h.id,hash:e.prepaidUpgradeHash,stars:B}),y(),void o()}e?.inputGift&&(s({gift:e.inputGift,shouldKeepOriginalDetails:A,upgradeStars:e.alreadyPaidUpgradeStars?void 0:B}),y())}}),D=(0,u.A)(()=>{p?.sampleAttributes&&S((0,X.HM)(p.sampleAttributes,v))}),T=(0,u.A)(()=>{p?.prices&&c({prices:p.prices,currentPrice:B||0,minPrice:p.minPrice||0,maxPrice:p.maxPrice||0})});(0,bi.A)(D,f?3e3:void 0,!0),(0,a.vJ)(()=>{f&&p?.sampleAttributes&&D()},[f,p?.sampleAttributes]),(0,a.vJ)(()=>{const e=p?.sampleAttributes;e&&[...e.filter(e=>"pattern"===e.type).map(e=>e.sticker),...e.filter(e=>"model"===e.type).map(e=>e.sticker)].map(e=>(0,C.Mw)(e,"full")).forEach(e=>{(0,gi.hd)(e,mt.qZ.BlobUrl)})},[p?.sampleAttributes]);const w=(0,a.Kr)(()=>B?(0,N.FD)("span",{children:[(0,N.Y)(F.A,{name:"star",className:"star-amount-icon"}),(0,N.Y)(je.A,{text:G.number(B)})]}):void 0,[G,B]),R=(0,a.Kr)(()=>{if(!v||!f)return;const e=p?.gift,t=h?(0,r.F9)(G,h):G("ActionFallbackUser"),i=h?[["diamond",G("GiftUpgradeUniqueTitle"),G("GiftPeerUpgradeUniqueDescription",{user:t})],["trade",G("GiftUpgradeTransferableTitle"),G("GiftPeerUpgradeTransferableDescription",{user:t})],["auction",G("GiftUpgradeTradeableTitle"),G("GiftPeerUpgradeTradeableDescription",{user:t})]]:[["diamond",G("GiftUpgradeUniqueTitle"),G("GiftUpgradeUniqueDescription")],["trade",G("GiftUpgradeTransferableTitle"),G("GiftUpgradeTransferableDescription")],["auction",G("GiftUpgradeTradeableTitle"),G("GiftUpgradeTradeableDescription")]],a=h?G("GiftPeerUpgradeText",{peer:(0,r.F9)(G,h)}):G("GiftUpgradeTextOwn"),n=Boolean(Y)&&Boolean(p?.prices?.length)&&!e?.alreadyPaidUpgradeStars;return{listItemData:i,header:(0,N.Y)(Me,{modelAttribute:v.model,backdropAttribute:v.backdrop,patternAttribute:v.pattern,title:G("GiftUpgradeTitle"),subtitle:a}),footer:(0,N.FD)("div",{className:Ni.footer,children:[!e&&(0,N.Y)(U.A,{className:Ni.footerButton,onClick:y,children:G("OK")}),e&&(0,N.FD)(N.FK,{children:[!b&&(0,N.Y)(qe.A,{label:G("GiftUpgradeKeepDetails"),onCheck:g,checked:A}),(0,N.Y)(U.A,{className:Ni.footerButton,isShiny:!0,onClick:P,children:(0,N.FD)("div",{className:Ni.buttonContent,children:[(0,N.Y)("div",{children:e.alreadyPaidUpgradeStars?G("GeneralConfirm"):G(b?"GiftPayForUpgradeButton":"GiftUpgradeButton",{amount:w},{withNodes:!0})}),n&&(0,N.Y)("div",{className:Ni.priceDecreaseTimer,children:G("StarGiftPriceDecreaseTimer",{timer:(0,N.Y)(St.A,{endsAt:Y,onEnd:I})},{withNodes:!0})})]})}),n&&(0,N.Y)(gt.A,{className:Ni.link,isPrimary:!0,onClick:T,children:G("StarGiftPriceDecreaseInfoLink")})]})]})}},[v,f,G,h,p?.gift,A,b,p?.prices?.length,Y,w]);return(0,N.Y)(vi.A,{isOpen:f,header:R?.header,footer:R?.footer,listItemData:R?.listItemData,hasBackdrop:!0,onClose:y})})),Gi=48*ft.dp,Ci=(0,a.ph)((0,n.EK)(e=>{const{activeGiftAuction:t}=(0,o.nTw)(e);return{auctionState:t}})(({modal:e,auctionState:t})=>{const{closeGiftAuctionModal:i,setGiftModalSelectedGift:r,openGiftAuctionInfoModal:o,openGiftAuctionAcquiredModal:s}=(0,n.ko)(),l=Boolean(e?.isOpen),c=(0,d.A)(t),m=c?.gift,f=c?.state,p=c?.userState,h="finished"===f?.type,A=(0,M.A)(),g=(0,u.A)(()=>i()),b=(0,u.A)(()=>{o({})}),v=(0,u.A)(()=>{if(!m)return;const e=(0,X.yQ)(m);s({giftId:m.id,giftTitle:m.title,giftSticker:e})}),S=(0,u.A)(()=>{m&&(i({shouldKeepActiveAuction:!0}),r({gift:m}))}),G=(0,a.Kr)(()=>{if(!m||!f)return;const e=m.title||A("StarGift"),t=m.giftsPerRound||0;return(0,N.FD)("div",{className:"lTDjKYuV",children:[(0,N.Y)(Mt,{gift:m,hideBadge:!0,noClickable:!0}),(0,N.Y)("h1",{className:"_tvAimMQ",children:e}),h?(0,N.Y)("span",{className:"pC_V4Juh",children:A("GiftAuctionEnded")}):(0,N.Y)("p",{className:"X88e7g62",children:A("GiftAuctionTopBidders",{count:t,gift:(0,N.Y)("span",{className:"AwBqE6Vc",children:e}),link:(0,N.Y)(gt.A,{isPrimary:!0,onClick:b,children:A("GiftAuctionLearnMore")})},{pluralValue:t,withNodes:!0,withMarkdown:!0})})]})},[m,f,h,A,b]),C=(0,a.Kr)(()=>{if(!m||!f||!p)return;const e=[];e.push([A("GiftAuctionStarted"),(0,z.L2)(1e3*f.startDate,A.code,!0)]),e.push([A("GiftAuctionEnds"),(0,z.L2)(1e3*f.endDate,A.code,!0)]),m.availabilityTotal&&e.push([A("GiftInfoAvailability"),A("GiftInfoAvailabilityValue",{count:m.availabilityRemains||0,total:A.number(m.availabilityTotal)},{pluralValue:m.availabilityRemains||0})]),"active"===f.type&&e.push([A("GiftAuctionCurrentRound"),A("GiftAuctionRoundValue",{current:A.number(f.currentRound),total:A.number(f.totalRounds)})]),h&&e.push([A("GiftAuctionAveragePrice"),(0,pe.U2)(A,f.averagePrice,{className:"Ui25Ac3P"})]);const t=p.acquiredCount,i=(0,X.yQ)(m),a=f.endDate-(0,Ye.Fm)(),n=a>0&&a<Gi;return{tableData:e,footer:(0,N.FD)("div",{className:"kVyu9ZRp",children:[t>0&&(0,N.Y)(gt.A,{className:"GwhTY_Uw",isPrimary:!0,onClick:v,children:A("GiftAuctionItemsBought",{count:t,gift:i&&(0,N.Y)(ee.A,{className:"H4JSQGvw",sticker:i,size:20,play:!1})},{pluralValue:t,withNodes:!0})}),(0,N.Y)(U.A,{noForcedUpperCase:!0,className:"QgTA5Tm_",onClick:h?g:S,children:h?A("OK"):(0,N.FD)("div",{children:[(0,N.Y)("div",{children:A("GiftAuctionJoin")}),a>0&&(0,N.Y)("div",{className:"XV66UlTa",children:A("GiftAuctionTimeLeft",{time:n?(0,N.Y)(St.A,{endsAt:f.endDate}):(0,z.zt)(A,a)},{withNodes:!0})})]})})]})}},[m,f,p,h,A,S,v,g]);return(0,N.Y)(Ge.A,{isOpen:l,header:G,footer:C?.footer,tableData:C?.tableData,className:"rCVinZx6",contentClassName:"MAEILhFp",onClose:g})})),yi={content:"FbamIaWM",headerControlPanel:"oKcR_Gxv",slider:"lpcp8Oip",title:"jNHNh7KT",subtitle:"HlVun4XF",infoCards:"K9fWcZP0",infoCard:"QBcr61z8",infoCardValue:"S9vK5Tny",infoCardLabel:"UzCztm_V",separator:"eCFcDThE",winningStatus:"IENM5upL",bidderInfoSlide:"VvFvniw8",winningText:"mHlgX1Lm",winningBadge:"yWQ_64QE",section:"VfdOWkWu",sectionTitle:"aJxJv1Tj",sectionTitleTransition:"I344VxP8",bidderRow:"_6493YZ5",bidderPosition:"bjYqFB3Y",bidderInfo:"MSwHwQYX",bidderName:"StE9kpcQ",topBidderRow:"Q0o2Mlnj",topBidderPosition:"mQa4yF_w",bidderAmount:"jTHhbapk",buttonStar:"eY_4yHis",giftSticker:"ETmmzDXX",customBidInput:"KRqfUs0J",customBidInputIcon:"m1O8A6wT"},Ii=(0,a.ph)((0,n.EK)(e=>{const{activeGiftAuction:t}=(0,o.nTw)(e),{stars:i,currentUserId:a}=e,n=a?(0,o.PVB)(e,a):void 0,r="active"===t?.state.type?t.state.topBidders:void 0;return{auctionState:t,starBalance:i?.balance,currentUserPeer:n,topBidderIds:r}})(({modal:e,auctionState:t,starBalance:i,currentUserPeer:r,topBidderIds:s})=>{const{closeGiftAuctionBidModal:l,sendStarGiftAuctionBid:m,loadActiveGiftAuction:p}=(0,n.ko)(),A=Boolean(e?.isOpen),g=(0,d.A)(t),b=(0,d.A)(s),v=(0,a.Kr)(()=>{if(!b)return;const e=(0,n.mS)();return b.map(t=>(0,o.PVB)(e,t)).filter(Boolean)},[b]),[S,G,C]=v||[],y=(0,Ie.A)([S?.id||"0"]),I=(0,Ie.A)([G?.id||"0"]),k=(0,Ie.A)([C?.id||"0"]),Y=g?.gift.giftsPerRound||0,B=(0,M.A)(),P="active"===g?.state.type?g.state:void 0,D=g?.userState,[T,F]=(0,a.J0)(50),[R,x,O]=(0,w.A)(),[K,V]=(0,a.J0)(""),q=P?.minBidAmount||50,z=D?.minBidAmount||q,J=1e4*Math.ceil(z/1e4)+5e4,W=(z-q)/(J-q),j=Math.floor((z-.25*J)/.75),_=W>.25?Math.max(1,j):q;(0,a.vJ)(()=>{F(z)},[z]);const Q=P?.nextRoundAt,X=D?.bidAmount?T-D.bidAmount:0,$=T>=J,Z=(0,a.Kr)(()=>$?B("GiftAuctionTapToBidMore"):X<=0?void 0:(0,N.FD)(N.FK,{children:["+",(0,N.Y)(je.A,{text:B.number(X)})]}),[X,$,B]),te=(0,u.A)(e=>{F(e)}),ie=(0,u.A)(()=>{g?.gift.id&&p({giftId:g.gift.id})}),ae=(0,u.A)(()=>{$&&x()}),ne=(0,u.A)(e=>{const t=e.target.value.replace(/\D/g,"");Number(t)>1e9||V(t)}),re=(0,u.A)(()=>{if(!g?.gift.id||!e)return;const t=Number(K);if(t<z)return;F(t),O(),V("");const{peerId:i,message:a,shouldHideName:n}=e,r=Boolean(D?.bidAmount);m({giftId:g.gift.id,bidAmount:t,peerId:i,message:a?{text:a}:void 0,shouldHideName:n,isUpdateBid:r})}),oe=(0,u.A)(()=>{if(!g?.gift.id||!e)return;const{peerId:t,message:i,shouldHideName:a}=e,n=Boolean(D?.bidAmount);m({giftId:g.gift.id,bidAmount:T,peerId:t,message:i?{text:i}:void 0,shouldHideName:a,isUpdateBid:n})}),se=(0,a.Kr)(()=>{if(!T||!P?.bidLevels?.length)return;const{bidLevels:e}=P,t=D?.bidDate||Number.MAX_SAFE_INTEGER;for(const i of e)if(i.amount<T||i.amount===T&&i.date>=t)return i.pos;return e[e.length-1].pos+1},[T,P,D?.bidDate]),le=Boolean(D?.bidAmount&&se&&se<=Y);function ce(e,t,i,a,n){return(0,N.FD)("div",{className:yi.topBidderRow,children:[(0,N.Y)("div",{className:yi.topBidderPosition,children:(0,c.A)(t,["emoji"])}),(0,N.Y)(L.Ay,{name:"fade",activeKey:n,className:yi.bidderInfo,slideClassName:yi.bidderInfoSlide,children:i&&(0,N.FD)(N.FK,{children:[(0,N.Y)(f.A,{peer:i,size:"small"}),(0,N.Y)(Ee.A,{peer:i,className:yi.bidderName})]})}),void 0!==a&&(0,N.FD)("div",{className:yi.bidderAmount,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(a)]})]},e)}return(0,N.FD)(h.A,{isOpen:A,hasAbsoluteCloseButton:!0,isSlim:!0,contentClassName:yi.content,onClose:l,isLowStackPriority:!0,children:[(0,N.Y)("div",{className:yi.headerControlPanel,children:(0,N.Y)(H,{balance:i,className:yi.modalBalance,withAddButton:!0})}),(0,N.Y)(ot,{className:yi.slider,defaultValue:z,minValue:_,minAllowedValue:z,maxValue:J,floatingBadgeDescription:Z,onChange:te,onBadgeClick:ae,shouldUseDynamicColor:!0,shouldAllowCustomValue:!0}),(0,N.Y)("h3",{className:yi.title,children:B("GiftAuctionPlaceBid")}),(0,N.FD)("div",{className:yi.infoCards,children:[(0,N.FD)("div",{className:yi.infoCard,children:[(0,N.FD)("div",{className:yi.infoCardValue,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(z)]}),(0,N.Y)("div",{className:yi.infoCardLabel,children:B("GiftAuctionMinimumBid")})]}),(0,N.FD)("div",{className:yi.infoCard,children:[(0,N.Y)("div",{className:yi.infoCardValue,children:(0,N.Y)(St.A,{endsAt:Q||0,shouldShowZeroOnEnd:!0,onEnd:ie})}),(0,N.Y)("div",{className:yi.infoCardLabel,children:B("GiftAuctionUntilNextRound")})]}),(0,N.FD)("div",{className:yi.infoCard,children:[(0,N.FD)("div",{className:yi.infoCardValue,children:[(0,N.Y)(ee.A,{noLoop:!1,className:yi.giftSticker,sticker:g?.gift.sticker,size:24}),B.number(P?.giftsLeft||0)]}),(0,N.Y)("div",{className:yi.infoCardLabel,children:B("GiftAuctionLeft")})]})]}),(0,N.FD)("div",{className:yi.section,children:[function(){const e=g?.gift.title||B("StarGift"),t=se&&se<=100?(P?.lastGiftNum||0)+se:void 0;return(0,N.Y)(L.Ay,{name:"fade",activeKey:le?0:1,className:yi.sectionTitleTransition,slideClassName:yi.bidderInfoSlide,children:le?(0,N.FD)("div",{className:yi.winningStatus,children:[(0,N.Y)("span",{className:yi.winningText,children:B("GiftAuctionYoureWinning")}),(0,N.Y)("span",{className:yi.winningBadge,children:B("GiftUnique",{title:e,number:t?B.number(t):void 0})})]}):(0,N.Y)("div",{className:yi.sectionTitle,children:B("GiftAuctionYourBidWillBe")})})}(),(0,N.FD)("div",{className:yi.bidderRow,children:[(0,N.Y)("div",{className:yi.bidderPosition,children:se&&se>100?`${se}+`:se||1}),(0,N.FD)("div",{className:yi.bidderInfo,children:[r&&(0,N.Y)(f.A,{peer:r,size:"small"}),r&&(0,N.Y)(Ee.A,{peer:r,className:yi.bidderName})]}),(0,N.FD)("div",{className:yi.bidderAmount,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive"}),B.number(T)]})]})]}),function(){const e=P?.bidLevels;return(0,N.FD)("div",{className:yi.section,children:[(0,N.Y)("div",{className:yi.sectionTitle,children:B("GiftAuctionTopWinners",{count:3},{pluralValue:3})}),ce(0,"🥇",S,e?.[0]?.amount,y),ce(1,"🥈",G,e?.[1]?.amount,I),ce(2,"🥉",C,e?.[2]?.amount,k)]})}(),(0,N.Y)(U.A,{noForcedUpperCase:!0,onClick:oe,children:B(D?.bidAmount?"GiftAuctionAddToBid":"GiftAuctionPlaceBidButton",{amount:(0,pe.U2)(B,D?.bidAmount?T-D.bidAmount:T,{asFont:!0,className:yi.buttonStar})},{withNodes:!0})}),(0,N.FD)(ci.A,{isOpen:R,title:B("GiftAuctionCustomBidTitle"),confirmLabel:B("GiftAuctionCustomBidButton"),isConfirmDisabled:!K||Number(K)<z,confirmHandler:re,onClose:O,children:[(0,N.Y)("p",{children:B("GiftAuctionCustomBidDescription",{count:g?.gift.giftsPerRound})}),(0,N.FD)("div",{className:yi.customBidInput,children:[(0,N.Y)(E.A,{type:"gold",size:"adaptive",className:yi.customBidInputIcon}),(0,N.Y)(hi.A,{value:K,onChange:ne,placeholder:B("GiftAuctionCustomBidPlaceholder"),inputMode:"numeric",teactExperimentControlled:!0})]})]})]})})),ki=(0,a.ph)((0,n.EK)(e=>{const{activeGiftAuction:t}=(0,o.nTw)(e);return{activeGiftAuction:t}})(({modal:e,activeGiftAuction:t})=>{const{closeGiftAuctionInfoModal:i}=(0,n.ko)(),r=(0,M.A)(),o=Boolean(e?.isOpen&&t),s=(0,u.A)(()=>{i()}),l=(0,a.Kr)(()=>(0,N.FD)("div",{className:"BYvGxmfu",children:[(0,N.Y)("div",{className:"X5HEn2ho",children:(0,N.Y)(F.A,{name:"auction-filled",className:"aiSlk9Zw"})}),(0,N.Y)("div",{className:"obG607lY",children:r("GiftAuctionInfoTitle")}),(0,N.Y)("div",{className:"wKo4cuID",children:r("GiftAuctionInfoSubtitle")})]}),[r]),c=(0,a.Kr)(()=>{if(o)return(0,N.Y)("div",{className:"M_SnCV2j",children:(0,N.Y)(U.A,{iconName:"understood",iconClassName:"OQCwJP3j",onClick:s,children:r("ButtonUnderstood")})})},[r,o,s]),d=(0,a.Kr)(()=>{const e=t?.gift.giftsPerRound||0;return[["auction-drop",r("GiftAuctionInfoTopBiddersTitle",{count:e},{pluralValue:e}),r("GiftAuctionInfoTopBiddersSubtitle",{count:e},{pluralValue:e})],["auction-next-round",r("GiftAuctionInfoBidCarryoverTitle"),r("GiftAuctionInfoBidCarryoverSubtitle",{count:e})],["stars-refund",r("GiftAuctionInfoMissedBiddersTitle"),r("GiftAuctionInfoMissedBiddersSubtitle")]]},[r,t]);return(0,N.Y)(vi.A,{isOpen:o,header:l,listItemData:d,footer:c,onClose:s})}));var Yi=i(60406),Bi=i(96802);const Pi={modal:"Pz3wJVwI",content:"vBYqMeRD",giftsListContainer:"Ly9mKtg2",giftsList:"lla9jO09",giftHeader:"TuVkgxwZ",bidValue:"zdUvUfOO",badge:"btuWuz25",starIcon:"GRggVFef",okButton:"kIsP2W0m"},Di=(0,a.ph)((0,n.EK)(e=>{const{giftAuctionAcquiredModal:t}=(0,o.nTw)(e);return{acquiredGifts:t?.acquiredGifts,giftTitle:t?.giftTitle,giftSticker:t?.giftSticker}})(({modal:e,acquiredGifts:t,giftTitle:i,giftSticker:r})=>{const{closeGiftAuctionAcquiredModal:o}=(0,n.ko)(),s=(0,a.li)(),l=(0,M.A)(),c=Boolean(e?.giftId),m=(0,d.A)(t),f=(0,d.A)(i),p=(0,d.A)(r),A=(0,u.A)(()=>{o()}),g=(0,a.Kr)(()=>{if(m?.length)return m.map(e=>{const t=l("GiftAuctionBoughtGiftHeader",{gift:f||l("StarGift"),giftNumber:e.giftNumber?l.number(e.giftNumber):"",round:l.number(e.round)});return{tableData:[[void 0,(0,N.FD)("span",{className:Pi.giftHeader,children:[p&&(0,N.Y)(ee.A,{className:Pi.giftSticker,sticker:p,size:20,play:!1}),(0,N.Y)("span",{children:t})]})],[l("GiftAuctionRecipient"),{chatId:e.peerId}],[l("GiftAuctionDate"),(0,z.L2)(1e3*e.date,l.code,!0)],[l("GiftAuctionAcceptedBid"),(0,N.FD)("span",{className:Pi.bidValue,children:[(0,pe.U2)(l,e.bidAmount,{className:Pi.starIcon}),(0,N.Y)(V.A,{className:Pi.badge,children:l("GiftAuctionTopPosition",{position:e.position})})]})]],key:`${e.round}-${e.giftNumber}`}})},[m,f,p,l]),b=m?.length||0;return(0,Yi.A)({containerRef:s,selector:`.${Pi.giftsList}`,isBottomNotch:!0},[g]),(0,N.FD)(h.A,{isOpen:c,hasCloseButton:!0,title:l("GiftAuctionBoughtGiftsTitle",{count:b},{pluralValue:b}),className:Pi.modal,contentClassName:Pi.content,onClose:A,isCondensedHeader:!0,isSlim:!0,children:[(0,N.Y)("div",{className:Pi.giftsListContainer,ref:s,children:(0,N.Y)("div",{className:Pi.giftsList,children:g?.map(e=>(0,N.Y)(Bi.A,{tableData:e.tableData},e.key))})}),(0,N.Y)(U.A,{className:Pi.okButton,onClick:A,children:l("OK")})]})})),Ti=4*T.$,wi=(0,a.ph)((0,n.EK)((e,{modal:t})=>({oldPeer:t?.oldPeerId?(0,o.PVB)(e,t.oldPeerId):void 0,newPeer:t?.newPeerId?(0,o.PVB)(e,t.newPeerId):void 0}))(({modal:e,oldPeer:t,newPeer:i})=>{const{closeGiftAuctionChangeRecipientModal:a,openGiftAuctionBidModal:o}=(0,n.ko)(),s=(0,M.A)(),l=Boolean(e?.isOpen),c=(0,d.A)(t),m=(0,d.A)(i),p=(0,d.A)(e),h=(0,u.A)(()=>{p&&(a(),o({peerId:p.newPeerId,message:p.message,shouldHideName:p.shouldHideName}))});if(c&&m)return(0,N.FD)(ci.A,{isOpen:l,title:s("GiftAuctionChangeRecipientTitle"),onClose:a,confirmLabel:s("Continue"),confirmHandler:h,children:[(0,N.FD)("div",{className:"GiX7PhEa",children:[(0,N.Y)(f.A,{peer:c,size:Ti}),(0,N.Y)(F.A,{name:"next",className:"rkG87LNM"}),(0,N.Y)(f.A,{peer:m,size:Ti})]}),(0,N.Y)("p",{children:s("GiftAuctionChangeRecipientDescription",{oldPeer:(0,r.F9)(s,c),newPeer:(0,r.F9)(s,m)},{withNodes:!0,withMarkdown:!0})})]})})),Mi=(0,a.ph)(({modal:e})=>{const{closeStarGiftPriceDecreaseInfoModal:t}=(0,n.ko)(),i=(0,M.A)(),r=Boolean(e),o=(0,d.A)(e),l=(0,u.A)(()=>{t()}),c=(0,a.Kr)(()=>{if(!o)return;const{prices:e}=o;return e.map(e=>[(0,z.L2)(1e3*e.date,i.code,!0,void 0,!0),(0,pe.U2)(i,e.upgradeStars,{containerClassName:"NEElQBO6"})])},[i,o]),m=(0,a.Kr)(()=>{if(r)return(0,N.FD)("div",{className:"OXLUuiYb",children:[(0,N.Y)("p",{className:"TWuxZcHO",children:i("UpgradeCostDrops")}),(0,N.Y)(U.A,{onClick:l,iconName:"understood",iconClassName:"QJryEH9W",children:i("ButtonUnderstood")})]})},[i,r,l]);if(!c||!o)return;const{currentPrice:f,minPrice:p,maxPrice:h}=o,A=h!==p?(f-p)/(h-p):0,g=(0,N.FD)("div",{className:"ETFjTQkC",children:[(0,N.Y)(ht.A,{leftText:(0,pe.Kk)(i,h),rightText:(0,pe.Kk)(i,p),floatingBadgeText:(0,pe.Kk)(i,f),floatingBadgeIcon:"star",progress:A,isInverted:!0,shouldSkipGradient:!0,className:"DJPf4ekd"}),(0,N.Y)("p",{className:"JKYZ8cFl",children:i("StarGiftUpgradeCostModalTitle")}),(0,N.Y)("p",{className:"wHxufgix",children:i("StarGiftUpgradeCostHint")})]});return(0,N.Y)(Ge.A,{isOpen:r,onClose:l,header:g,tableData:c,tableClassName:(0,s.A)("WuL_UIYd","custom-scroll"),footer:m})});var Fi=i(45294);const Ui=7*T.$,Ri=(0,a.ph)((0,n.EK)(e=>({currentUser:(0,o.mBe)(e,e.currentUserId),isCurrentUserPremium:(0,o.g29)(e)}))(({modal:e,currentUser:t,isCurrentUserPremium:i})=>{const{closeGiftStatusInfoModal:r,setEmojiStatus:o}=(0,n.ko)(),l=(0,M.A)(),{isMobile:c}=(0,ke.Ay)(),m=Boolean(e),p=(0,d.A)(e),{emojiStatus:h}=p||{},A=h?.textColor,g=(0,Fi.A)(h?.patternDocumentId),b=(0,u.A)(()=>{r()}),v=(0,u.A)(()=>{h&&o({emojiStatus:h}),r()}),S=(0,a.Kr)(()=>{if(!h||!m)return;const e=[h.centerColor,h.edgeColor];return(0,N.Y)(te.A,{className:"_1RfhkfB",backgroundColors:e,patternIcon:g.customEmoji,yPosition:6.875*T.$,maxRadius:.31,patternSize:c?13:15,ovalFactor:1})},[h,m,c,g]),G=(0,a.Kr)(()=>({...t,emojiStatus:h}),[t,h]),C=(0,a.Kr)(()=>(0,N.FD)("div",{className:"qL0cHbwS",children:[(0,N.FD)("div",{className:(0,s.A)("t18QCmAb"),style:(0,ye.A)(A&&`color: ${A}`),children:[S,(0,N.Y)(f.A,{peer:G,size:Ui,className:"JK2zOWA7"}),(0,N.Y)(Ee.A,{peer:G,className:"lxxbgNCl",withEmojiStatus:!0,noFake:!0,noVerified:!0}),(0,N.Y)("p",{className:"MLMdxkUg",style:(0,ye.A)(A&&`color: ${A}`),children:l("Online")})]}),(0,N.Y)("div",{className:"wxg_5ou_",children:l("UniqueStatusWearTitle",{gift:G?.emojiStatus?.title})}),(0,N.Y)("div",{className:"KSCLIMZm",children:l("UniqueStatusBenefitsDescription")})]}),[A,S,G,l]),y=[["radial-badge",l("UniqueStatusBadgeBenefitTitle"),l("UniqueStatusBadgeDescription")],["unique-profile",l("UniqueStatusProfileDesignBenefitTitle"),l("UniqueStatusProfileDesignDescription")],["proof-of-ownership",l("UniqueStatusProofOfOwnershipBenefitTitle"),l("UniqueStatusProofOfOwnershipDescription")]],I=(0,a.Kr)(()=>{if(m)return(0,N.Y)("div",{className:"VDrvalBo",children:(0,N.FD)(U.A,{onClick:v,children:[l("UniqueStatusWearButton"),!i&&(0,N.Y)(F.A,{name:"lock-badge",className:"jiPObOWv"})]})})},[l,i,m]);return(0,N.Y)(vi.A,{isOpen:m,header:C,listItemData:y,footer:I,hasBackdrop:!0,onClose:b})}));var xi=i(15535);const Li={header:"LQgz8Nlx",giftPreview:"hgs0ts_O",backdrop:"OnBhMaBw",description:"HBxB4QPY",arrow:"kXTOUpfb",noPassword:"BnqLhoKr"},Oi={isCustomPeer:!0,avatarIcon:"fragment",title:"",customPeerAvatarColor:"#000000"},Ki=4.5*T.$,Vi=(0,a.ph)((0,n.EK)(e=>{const{settings:{byKey:{hasPassword:t}},twoFaSettings:{hint:i}}=e;return{hasPassword:t,passwordHint:i}})(({modal:e,hasPassword:t,passwordHint:i})=>{const{closeGiftWithdrawModal:r,clearGiftWithdrawError:o,closeGiftInfoModal:s,processStarGiftWithdrawal:l,openSettingsScreen:c}=(0,n.ko)(),m=Boolean(e),[p,A]=(0,a.J0)(!1),g=(0,M.A)(),b=(0,d.A)(e),v=b?.gift?.gift,S=v&&(0,X.uc)(v),G=b?.gift?.canExportAt?Math.max(b.gift.canExportAt-(0,Ye.Fm)(),0):void 0,C=(0,u.A)(()=>{r()}),y=(0,u.A)(e=>{l({gift:b.gift.inputGift,password:e})}),I=(0,u.A)(()=>{c({screen:ve.VS.TwoFaDisabled}),r(),s()});return(0,N.FD)(h.A,{isOpen:m,title:g("GiftWithdrawTitle"),isCondensedHeader:!0,hasCloseButton:!0,isSlim:!0,onClose:C,children:[S&&(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{className:Li.header,children:[(0,N.FD)("div",{className:Li.giftPreview,children:[(0,N.Y)(te.A,{className:Li.backdrop,backgroundColors:[S.backdrop.centerColor,S.backdrop.edgeColor],patternIcon:S.pattern?.sticker,ringsCount:1,ovalFactor:1,patternSize:12}),(0,N.Y)(ee.A,{className:Li.sticker,size:Ki,sticker:S.model?.sticker})]}),(0,N.Y)(F.A,{name:"next",className:Li.arrow}),(0,N.Y)(f.A,{peer:Oi,size:"giant",className:Li.avatar})]}),(0,N.Y)("p",{className:Li.description,children:g("GiftWithdrawDescription",{gift:`${v.title} #${v.number}`},{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]})})]}),Boolean(G)&&(0,N.Y)("p",{className:Li.exportHint,children:g("GiftWithdrawWait",{days:(0,ft._k)(G)},{pluralValue:(0,ft._k)(G)})}),!t&&(0,N.FD)(N.FK,{children:[(0,N.Y)("span",{className:Li.noPassword,children:g("ErrorPasswordMissing")}),(0,N.Y)(U.A,{className:"mt-2",onClick:I,children:g("SetUp2FA")})]}),t&&!G&&(0,N.Y)(xi.A,{shouldShowSubmit:!0,placeholder:g("CheckPasswordPlaceholder"),error:b?.errorKey&&g.withRegular(b?.errorKey),description:g("CheckPasswordDescription"),onClearError:o,isLoading:b?.isLoading,hint:i,isPasswordVisible:p,shouldResetValue:m,onChangePasswordVisibility:A,submitLabel:g("GiftWithdrawSubmit"),onSubmit:y})]})}));var Ei=i(79824),qi=i(74984),Hi=i(4875),zi=i(56863),Ji=i(30857),Wi=i(84080),ji=i(56133),_i=i(35297);function Qi(){}async function Xi(e){const t=await(0,Hi.px)("searchChats",{query:e});if(t)return[...t.accountResultIds,...t.globalResultIds]}const $i=(0,a.ph)((0,n.EK)(e=>{const{contactList:t,currentUserId:i}=e;return{contactIds:t?.userIds,currentUserId:i}})(({modal:e,contactIds:t,currentUserId:i})=>{const{closeGiftTransferModal:r,openGiftWithdrawModal:s,openGiftTransferConfirmModal:l}=(0,n.ko)(),c=Boolean(e),m=(0,M.A)(),[f,p]=(0,a.J0)(""),h=(0,d.A)(e),A=(0,qi.Rh)(G.DSF),g=(0,a.Kr)(()=>(0,y.Am)([...t||[],...A||[]]),[t,A]),{result:b,currentResultsQuery:v}=function({query:e,queryFn:t=Xi,defaultValue:i,debounceTimeout:n=300,isDisabled:r}){const o=function(e,t,i){const[n,r]=(0,a.J0)(),{isFrozen:o,updateWhenUnfrozen:s}=function(){const e=(0,a.li)(!1),t=(0,a.hb)(()=>{e.current=!0},[]),i=(0,Ji.A)(),n=(0,a.hb)(()=>{e.current&&(e.current=!1,i())},[i]);return(0,Wi.Ay)(Qi,n),{isFrozen:(0,a.OV)(),updateWhenUnfrozen:t}}(),l=(0,ji.A)(t,!0);return(0,_i.A)(()=>{o?s():l(()=>{r(e())})},[...i,o]),n}(()=>e,n,[e]),[s,l]=(0,a.J0)(""),c=e?o:e,d=(0,u.A)(t);return{...(0,zi.A)(async()=>{if(!c||r)return l(""),Promise.resolve(i);const e=await d(c);return l(c),e},[c,i,d,r],i),currentResultsQuery:s}}({query:f,defaultValue:g}),S=v!==f,C=(0,a.Kr)(()=>v?Ei.p:[{type:"withdraw",isCustomPeer:!0,avatarIcon:"toncoin",peerColorId:5,title:m("GiftTransferTON")}],[m,v]),B=(0,u.A)(e=>{"withdraw"===e&&(s({gift:h.gift}),r())}),P=(0,a.Kr)(()=>{if(S)return Ei.p;const e=(0,n.mS)();return(0,I.A)((b||[]).filter(t=>t!==i&&(0,o.X2D)(e,t)),!1)},[S,b,i]),D=(0,u.A)(e=>{h?.gift&&l({gift:h.gift,recipientId:e})});return(0,N.Y)(Y.A,{isOpen:c,onClose:r,title:m("GiftTransferTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,ignoreFreeze:!0,children:(0,N.Y)(k.A,{itemIds:P,categories:C,onSelectedCategoryChange:B,withDefaultPadding:!0,withPeerUsernames:!0,isSearchable:!0,noScrollRestore:!0,isLoading:S,filterValue:f,filterPlaceholder:m("Search"),onFilterChange:p,onSelectedIdChange:D})})})),Zi=(0,a.ph)((0,n.EK)((e,{modal:t})=>({selectedPeer:t?.recipientId?(0,o.PVB)(e,t.recipientId):void 0}))(({modal:e,selectedPeer:t})=>{const{closeGiftTransferConfirmModal:i,transferGift:a,openChat:o,closeGiftModal:s,closeGiftTransferModal:l}=(0,n.ko)(),c=(0,M.A)(),m=Boolean(e),f=(0,d.A)(e),p=(0,d.A)(t),h=(0,u.A)(()=>{f?.gift.inputGift&&f.recipientId&&(a({gift:f.gift.inputGift,recipientId:f.recipientId,transferStars:f.gift.transferStars}),i(),o({id:f.recipientId}),s(),l())});if(!f)return;const{gift:A}=f,g="starGiftUnique"===A.gift.type?A.gift:void 0;return g?(0,N.FD)(ci.A,{isOpen:m,noDefaultTitle:!0,onClose:i,confirmLabel:A.transferStars?c("GiftTransferConfirmButton",{amount:(0,pe.U2)(c,A.transferStars,{asFont:!0})},{withNodes:!0}):c("GiftTransferConfirmButtonFree"),confirmHandler:h,children:[p&&(0,N.Y)(li,{peer:p,gift:g}),(0,N.Y)("p",{children:A.transferStars?c("GiftTransferConfirmDescription",{gift:c("GiftUnique",{title:g.title,number:g.number}),amount:(0,pe.Kk)(c,A.transferStars),peer:(0,r.F9)(c,p)},{withNodes:!0,withMarkdown:!0}):c("GiftTransferConfirmDescriptionFree",{gift:c("GiftUnique",{title:g.title,number:g.number}),peer:(0,r.F9)(c,p)},{withNodes:!0,withMarkdown:!0})})]}):void 0})),ea=(0,a.ph)((0,n.EK)((e,{modal:t})=>({senderPeer:t?.details.senderId?(0,o.PVB)(e,t.details.senderId):void 0,recipientPeer:t?.details.recipientId?(0,o.PVB)(e,t.details.recipientId):void 0}))(({modal:e,senderPeer:t,recipientPeer:i})=>{const{closeGiftDescriptionRemoveModal:a,removeGiftDescription:r,openChat:o}=(0,n.ko)(),s=(0,M.A)(),l=Boolean(e),c=(0,d.A)(e),m=(0,d.A)(t),f=(0,d.A)(i),p=(0,u.A)(e=>{a(),o({id:e})}),h=(0,u.A)(()=>{c?.gift.inputGift&&c.price&&r({gift:c.gift.inputGift,price:c.price})});if(!c||!f)return;const{price:A,details:g}=c,b=ai({originalDetails:g,recipient:f,sender:m,onOpenChat:p,lang:s});return(0,N.FD)(ci.A,{isOpen:l,title:s("RemoveGiftDescriptionTitle"),onClose:a,confirmLabel:s("RemoveGiftDescriptionButton",{amount:(0,pe.U2)(s,A,{asFont:!0})},{withNodes:!0}),confirmHandler:h,children:[(0,N.Y)("div",{className:"LVOpBXUW",children:s("RemoveGiftDescriptionConfirmText")}),Boolean(b)&&(0,N.Y)("div",{className:"FA1_yVBY",children:b})]})})),ta=(0,a.ph)((0,n.EK)((e,{modal:t})=>({user:t?.userId?(0,o.mBe)(e,t.userId):void 0}))(({modal:e,user:t})=>{const{closeChatRefundModal:i,toggleNoPaidMessagesException:o}=(0,n.ko)(),[s,l]=(0,a.J0)(!1),c=(0,d.A)(e),m=(0,d.A)(t),{starsToRefund:f,userId:p}=c||{},h=(0,M.A)(),A=Boolean(e),g=(0,u.A)(()=>{i(),p&&o({userId:p,shouldRefundCharged:s})});return(0,N.FD)(ci.A,{isOpen:A,onClose:i,title:h("RemoveFeeTitle"),confirmLabel:h("ConfirmRemoveMessageFee"),confirmHandler:g,children:[h("ConfirmDialogMessageRemoveFee",{peer:m&&(0,r.F9)(h,m)},{withMarkdown:!0,withNodes:!0}),Boolean(f)&&(0,N.Y)(qe.A,{className:"dialog-checkbox",label:h("ConfirmDialogRemoveFeeRefundStars",{amount:(0,pe.Kk)(h,f)},{withMarkdown:!0,withNodes:!0}),checked:s,onCheck:l})]})}));var ia=i(14487);const aa=(0,a.ph)((0,n.EK)(e=>{const t=e.stars?.balance,i=e.ton?.balance?.amount;return{starBalance:t,tonBalance:i}})(({modal:e,starBalance:t,tonBalance:i})=>{const r=(0,n.ko)(),o=(0,M.A)(),s=(0,a.hb)(()=>{if(!e?.directInfo)return void r.closePriceConfirmModal();const{currency:a,newAmount:n}=e,o="TON"===a,s=o?i:t?.amount;if(void 0!==s){if(s<n)return r.openStarsBalanceModal({currency:o?"TON":"XTR",tabId:(0,ia.g0)()}),void r.closePriceConfirmModal();r.sendStarPaymentForm({directInfo:e.directInfo,tabId:(0,ia.g0)()}),r.closePriceConfirmModal()}else r.closePriceConfirmModal()},[e,t,i,r]),c=(0,a.hb)(()=>{r.closePriceConfirmModal()},[r]);if(!e)return;const{originalAmount:d,newAmount:u,currency:m}=e;let f,p;return"TON"===m?(f=(0,pe.QH)(o,(0,l.wD)(d)),p=(0,pe.QH)(o,(0,l.wD)(u))):(f=(0,pe.Kk)(o,d),p=(0,pe.Kk)(o,u)),(0,N.Y)(ci.A,{isOpen:Boolean(e),onClose:c,title:o("PriceChanged"),confirmHandler:s,confirmLabel:o("PayNewPrice"),children:(0,N.Y)("p",{children:o("PriceChangedText",{originalAmount:f,newAmount:p},{withMarkdown:!0,withNodes:!0})})})}))}}]);
//# sourceMappingURL=6930.223457beaac4b6a37957.js.map