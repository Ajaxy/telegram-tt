"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[7768],{49736:(e,t,s)=>{s.r(t),s.d(t,{LockScreen:()=>Ld,Main:()=>Nd});var a=s(31481),o=(s(48544),s(42347)),n=s(23174),i=s(89925),r=s(24585),d=s(96454),c=s(85982),l=s(46275),u=s(14487),h=s(87894),m=s(60343),p=s(43044),g=s(48775),f=s(6e4),I=s(37836),v=s(80140),b=s(4875),y=s(90709),S=s(70636),w=s(13439),A=s(17872),M=s(32989),C=s(91048),P=s(22986),k=s(9716),F=s(5560),T=s(26129),x=s(43503),U=s(76023);const B=32*U.$,R=45.5*U.$,N=26.5*U.$,J=16*U.$,E=16.125*U.$;var L=s(16350),Y=s(82150),D=s(43874);function O(e,t){return t-((0,C.nTw)(e).isLeftColumnShown&&!(0,D.Ny)()?e.leftColumnWidth||((s=x.A.get().width)>a.gQx?Math.min(Math.max(.25*s,J),.33*s):s>a.j7z?Math.min(Math.max(.33*s,J),.4*s):N):0);var s}function G(e,t,s){const a=(0,C.nZ4)(e,t.chatId),o=t.reactions||{results:[],areTags:a},n=(0,C.VF$)(e,t.chatId),i=(0,y.AK)(o.results,s);let{recentReactions:r=[]}=o;return r.length&&(r=r.filter(t=>{let{isOwn:s,peerId:a}=t;return!s&&a!==e.currentUserId})),s.forEach(t=>{const{currentUserId:s}=e;"paid"!==t.type&&r.unshift({peerId:n?.id||s,reaction:t,addedDate:Math.floor(Date.now()/1e3),isOwn:!0})}),(0,Y.r3)(e,t.chatId,t.id,{reactions:{...o,results:i,recentReactions:r}})}function V(e,t,s){return(0,L.wi)(e,t,s,!0)}const j=350,q=1e3;let z=0;function K(e,t,s,a,o,n,i,r){const d=r?.reactions;if(d&&(0,P.T)(o,d))return e;const c=d?.results.find(e=>e.localAmount);if(c?.localAmount){const{localIsPrivate:e,localAmount:t,localPeerId:s}=c;o.results=(0,y.Ny)(o.results,t,e,s)}if(e=(0,A.r3y)(e,s,a,{reactions:o}),!i)return e;const{reaction:l,isOwn:h,isUnread:p}=o.recentReactions?.[0]??{};if((0,C.xYJ)(e,"reactionEffects")&&r&&l&&p&&!h){const e=(0,m.bj)(r);t.startActiveReaction({containerId:e,reaction:l,tabId:(0,u.g0)()})}const g=n.unreadReactions?.includes(a),f=(0,y.pU)(e,o);if(f&&!g){e=V(e,s,{unreadReactionsCount:(n?.unreadReactionsCount||0)+1,unreadReactions:[...n?.unreadReactions||[],a].sort((e,t)=>t-e)});const t=(0,C.O5q)(e,s,a);if(!n||!t)return e;(0,I.aj)(()=>{(0,F.Oq)({chat:n,message:t,isReaction:!0})})}return!f&&g&&(e=V(e,s,{unreadReactionsCount:(n?.unreadReactionsCount||1)-1,unreadReactions:n?.unreadReactions?.filter(e=>e!==a)})),e}function W(e,t,s,a){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const n=o?(0,C.Jl6)(e,t,s):(0,C.O5q)(e,t,s);if(n&&a.content&&!(0,m.iL)(s)){const{photo:e,video:t,sticker:s,document:o}=(0,y.r_)(n);e&&a.content.photo?(a.content.photo.blobUrl??=e.blobUrl,a.content.photo.thumbnail??=e.thumbnail):t&&a.content.video?a.content.video.blobUrl??=t.blobUrl:s&&a.content.sticker?a.content.sticker.isPreloadedGlobally??=s.isPreloadedGlobally:o&&a.content.document&&(a.content.document.previewBlobUrl??=o.previewBlobUrl)}const i=n?{...n,...a}:a;return o?(0,A.Egm)(e,t,s,i):(0,A.r3y)(e,t,s,i)}function H(e,t,s,a){const{chatId:o}=s,n=(0,T.Q)(s),{threadInfo:i}=(0,C.Tac)(e,s)||{};if(!i&&n?.replyToMsgId){const i=(0,C.O5q)(e,o,n.replyToMsgId);i?e=(0,A.Wwn)(e,i,o,s.id,a):t.loadMessage({chatId:o,messageId:n.replyToMsgId,threadUpdate:{isDeleting:a,lastMessageId:s.id}})}return e}function _(e,t,s){const{id:a,chatId:o}=s,i=(0,C.QP5)(e,s),{threadInfo:r}=(0,C.Tac)(e,s)||{},d=(0,C.hds)(e,o),c=d?.unreadCount&&!(0,C.gCU)(e,o,n.l3);e=H(e,t,s);const{threadId:l}=r??{threadId:i};return l&&(e=(0,A.d4w)(e,o,l,[a]),Object.values(e.byTabId).forEach(t=>{let{id:s}=t;if((0,C.haw)(e,o,l,s)){const t=(0,C.RjD)(e,o,l),n=(0,A.fgD)(e,o,l,a,s),i=(0,C.rA3)(n,o,l,s);t&&!i.includes(t)||(e=n)}}),r&&(e=(0,A.eww)(e,o,l,"threadInfo",{...r,lastMessageId:s.id}),(0,y.Nb)(s)||(0,y._P)(s)||(e=(0,A.eAk)(e,o,l,{messagesCount:(r.messagesCount||0)+1})))),c||(e=(0,A.d4w)(e,o,n.l3,[a]),Object.values(e.byTabId).forEach(t=>{let{id:s}=t;if((0,C.haw)(e,o,n.l3,s)){const t=(0,C.RjD)(e,o,n.l3),i=(0,A.fgD)(e,o,n.l3,a,s),r=(0,C.rA3)(i,o,n.l3,s);t&&!r.includes(t)||(e=i)}})),e}function $(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{chats:o}=e,n=o.byId[t],i=(0,C.ZZX)(e,t),r=n?.isForum?(0,C.nkm)(e,s):void 0;r&&(e=(0,A.TwA)(e,t,r.id,{lastMessageId:s.id}));const d=(0,C.L_2)(e,s);e=(0,A.eAk)(e,t,d,{lastMessageId:s.id});const c=(0,C.QP5)(e,s);return c&&(e=(0,A.yKC)(e,c,s.id,"saved")),!i||a||i===s.id||i===s.previousLocalId||s.id>i?(0,A.yKC)(e,t,s.id):e}function X(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.l3;const a=(0,C.zeq)(e,t),o=(0,C.gCU)(e,t,s);if(!a||!o)return;let i=o.length;for(;i--;){const e=a[o[i]];if(e&&!e.isDeleting)return e}}function Q(e,t,s,a){if(t){const o=(0,C.hds)(e,t);if(!o)return;const i=new Set;i.add(n.l3),s.forEach(s=>{e=(0,A.r3y)(e,t,s,{isDeleting:!0}),(0,C.S0q)(e,t,s)&&(e=(0,A.do9)(e,t,s));const o=(0,C.O5q)(e,t,s);if(!o)return;"chatEditPhoto"===o.content.action?.type&&o.content.action.photo&&(e=(0,A.sol)(e,t,o.content.action.photo.id,!0)),e=H(e,a,o,!0);const n=(0,C.L_2)(e,o);n&&i.add(n)}),a.requestChatUpdate({chatId:t});const r=new Set(s);i.forEach(s=>{const i=(0,C.Vw0)(e,t,s);if(!i?.lastMessageId||!r.has(i.lastMessageId))return;const d=X(e,t,s);d?(s===n.l3&&(e=$(e,t,d,!0)),e=(0,A.eAk)(e,t,s,{lastMessageId:d.id}),o.isForum&&(e=(0,A.TwA)(e,t,Number(s),{lastMessageId:d.id}))):o.isForum&&s!==n.l3&&a.loadTopicById({chatId:t,topicId:Number(s)})}),(0,w.UF)(e);const d=(0,C.Rwe)(e);return void setTimeout(()=>{e=(0,w.mS)();const a=s.filter(s=>(0,C.O5q)(e,t,s)?.isDeleting);e=(0,A.AH0)(e,t,a),(0,w.UF)(e)},d?q:j)}const o=[];s.forEach(t=>{const s=(0,C.Egn)(e,t);if(s){o.push(s);const n=X(e=(0,A.r3y)(e,s,t,{isDeleting:!0}),s);n&&(e=$(e,s,n,!0));const i=(0,C.O5q)(e,s,t);if((0,C.nZ4)(e,s)&&i){const t=(0,C.L_2)(e,i);if((0,y.cG)(s,t,e.currentUserId)){const o=X(e,s,t);a.requestSavedDialogUpdate({chatId:String(t)}),o&&(e=(0,A.yKC)(e,s,o.id,"saved"))}}"chatEditPhoto"===i?.content.action?.type&&i.content.action.photo&&(e=(0,A.sol)(e,s,i.content.action.photo.id,!0));const r=(0,C.Rwe)(e);setTimeout(()=>{e=(0,w.mS)(),e=(0,A.AH0)(e,s,[t]),(0,w.UF)(e)},r?q:j)}}),(0,w.UF)(e),(0,h.Am)(o).forEach(e=>{a.requestChatUpdate({chatId:e})})}(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"newMessage":{const{chatId:a,id:o,message:n,shouldForceReply:i,wasDrafted:r,poll:d,webPage:c}=s;e=_(e=W(e,a,o,n),t,n);const l=(0,C.O5q)(e,a,o),u=(0,T.Q)(l),h=(0,T.W)(l),m=(0,C.hds)(e,a);m?.isForum&&u?.isForumTopic&&!(0,C.nkm)(e,l)&&u.replyToMsgId&&t.loadTopicById({chatId:a,topicId:u.replyToMsgId});const p=(0,y.Nb)(n);if(Object.values(e.byTabId).forEach(s=>{let{id:d}=s;p&&r&&(e=$(e,a,l));const c=(0,C.L_2)(e,l);if(e=(0,A.PKO)(e,l,a,c,d),(0,C.fo$)(e,a,n,d)){if(p&&n.isOutgoing&&!n.content?.action&&!h?.storyId&&!n.content?.storyData){const s=(0,C.Xf0)(e,d);s&&t.focusMessage({chatId:a,threadId:s.threadId,messageId:n.id,noHighlight:!0,isResizingContainer:!0,tabId:d})}p||setTimeout(()=>{e=(0,w.mS)(),i&&t.updateDraftReplyInfo({replyToMsgId:o,tabId:d}),e=$(e,a,l),(0,w.UF)(e)},j)}else e=$(e,a,l)}),d&&(e=(0,A.J81)(e,d.id,d)),c&&(e=(0,A.o7c)(e,c.id,c)),n.reportDeliveryUntilDate&&n.reportDeliveryUntilDate>(0,v.Fm)()&&t.reportMessageDelivery({chatId:a,messageId:o}),(0,w.UF)(e),p||m?.isNotJoined||(0,C.mJZ)(e,a)||t.loadTopChats(),!p&&(0,C.nZ4)(e,a)){const s=(0,C.QP5)(e,l);s&&!(0,C.mJZ)(e,s,"saved")&&t.requestSavedDialogUpdate({chatId:s})}break}case"updateChatLastMessage":{const{id:t,lastMessage:a}=s;e=$(e,t,a,!0),e=(0,A.KcS)(e,[a]),(0,w.UF)(e);break}case"updateStartEmojiInteraction":Object.values(e.byTabId).forEach(t=>{let{id:a}=t;const{chatId:o}=(0,C.Xf0)(e,a)||{};if(o!==s.id)return;const n=(0,C.O5q)(e,o,s.messageId);if(!n)return;if((0,y.P5)(n)?.text!==s.emoji)return;const i=(0,C.nTw)(e,a);e=(0,M.w)(e,{activeEmojiInteractions:[...i.activeEmojiInteractions||[],{id:Math.random(),animatedEffect:s.emoji,messageId:s.messageId}]},a)}),(0,w.UF)(e);break;case"newScheduledMessage":{const{chatId:t,id:a,message:o,poll:i,webPage:r}=s;e=W(e,t,a,o,!0);const d=(0,C.K3w)(e,t,n.l3)||[];e=(0,A.eww)(e,t,n.l3,"scheduledIds",(0,h.Am)([...d,a]));const c=(0,C.L_2)(e,o);if(c!==n.l3){const s=(0,C.K3w)(e,t,c)||[];e=(0,A.eww)(e,t,c,"scheduledIds",(0,h.Am)([...s,a]))}i&&(e=(0,A.J81)(e,i.id,i)),r&&(e=(0,A.o7c)(e,r.id,r)),e=(0,A.zTz)(e,t,{hasScheduledMessages:!0}),(0,w.UF)(e);break}case"updateScheduledMessage":{const{chatId:a,id:o,message:i,poll:r,webPage:d,isFromNew:c}=s,l=(0,C.Jl6)(e,a,o);if(!l)return void(c&&t.apiUpdate({"@type":"newScheduledMessage",id:s.id,chatId:s.chatId,message:s.message,poll:s.poll,webPage:s.webPage}));e=W(e,a,o,i,!0);const u=Object.keys((0,C.yFI)(e,a)||{}).map(Number).sort((e,t)=>t-e);e=(0,A.eww)(e,a,n.l3,"scheduledIds",u);const h=(0,C.L_2)(e,l);if(h!==n.l3){const t=(0,C.K3w)(e,a,h)||[];e=(0,A.eww)(e,a,h,"scheduledIds",t.sort((e,t)=>t-e))}r&&(e=(0,A.J81)(e,r.id,r)),d&&(e=(0,A.o7c)(e,d.id,d)),(0,w.UF)(e);break}case"updateMessage":{const{chatId:a,id:o,message:n,poll:i,webPage:r,isFromNew:d,shouldForceReply:c}=s,l=(0,C.O5q)(e,a,o);if(!l)return void(d&&t.apiUpdate({"@type":"newMessage",id:s.id,chatId:s.chatId,message:s.message,poll:s.poll,webPage:s.webPage,shouldForceReply:c}));const u=(0,C.hds)(e,a);e=W(e,a,o,n);const h=(0,C.O5q)(e,a,o);n.reactions&&u&&(e=K(e,t,a,o,n.reactions,u,h.isOutgoing,l)),n.content?.text?.text!==l?.content?.text?.text&&(e=(0,A.gt4)(e,a,o)),i&&(e=(0,A.J81)(e,i.id,i)),r&&(e=(0,A.o7c)(e,r.id,r)),(0,w.UF)(e);break}case"updateQuickReplyMessage":{const{id:t,message:a,poll:o,webPage:n}=s;e=(0,A.QNR)(e,t,a),o&&(e=(0,A.J81)(e,o.id,o)),n&&(e=(0,A.o7c)(e,n.id,n)),(0,w.UF)(e);break}case"deleteQuickReplyMessages":{const{messageIds:t}=s;e=(0,A.vad)(e,t),(0,w.UF)(e);break}case"updateQuickReplies":{const{quickReplies:t}=s,a=(0,h.dU)(t,"id");e=(0,A.xAV)(e,a),(0,w.UF)(e);break}case"deleteQuickReply":e=(0,A.hjk)(e,s.quickReplyId),(0,w.UF)(e);break;case"updateVideoProcessingPending":{const{chatId:a,localId:o,newScheduledMessageId:n}=s;e=(0,A.AH0)(e,a,[o]),e=(0,A.zTz)(e,a,{hasScheduledMessages:!0}),(0,w.UF)(e),Object.values(e.byTabId).forEach(s=>{let{id:o}=s;const i=(0,C.Xf0)(e,o);if(i?.chatId!==a)return;const r=Date.now();r-z<1e3||(z=r,t.showNotification({message:{key:"VideoConversionText"},title:{key:"VideoConversionTitle"},tabId:o}),t.focusMessage({chatId:a,messageId:n,messageListType:"scheduled",tabId:o}))});break}case"updateMessageSendSucceeded":{const{chatId:a,localId:o,message:i,poll:r}=s;e=_(e,t,i);const d=(0,C.O5q)(e,a,o);e=(0,A.AH0)(e,a,[o]),i.isScheduled&&(e=(0,A.XAm)(e,a,[o])),e=(0,A.r3y)(e,a,i.id,{...d,...i,previousLocalId:o,isDeleting:void 0}),r&&(e=(0,A.J81)(e,r.id,r)),e={...e,fileUploads:{byMessageKey:(0,h.cJ)(e.fileUploads.byMessageKey,[(0,m.bj)(i)])}};const c=(0,C.O5q)(e,a,i.id);e=$(e,a,c);const l=(0,C.Tac)(e,i);Object.values(e.byTabId).forEach(s=>{let{id:o}=s;const{chatId:r,threadId:d}=(0,C.Xf0)(e,o)||{};r===a&&(l?.threadInfo?.threadId||n.l3)===d&&t.markMessageListRead({maxId:i.id,tabId:o})}),l?.threadInfo?.threadId&&(e=(0,A.eww)(e,a,l.threadInfo.threadId,"threadInfo",{...l.threadInfo,lastMessageId:i.id,lastReadInboxMessageId:i.id})),e=(0,A.wix)(e,a,{lastReadInboxMessageId:i.id});const u=(0,C.hds)(e,a);if(u?.isNotJoined||(0,C.mJZ)(e,a)||t.loadTopChats(),(0,C.nZ4)(e,a)){const s=(0,C.QP5)(e,c);s&&!(0,C.mJZ)(e,s,"saved")&&t.requestSavedDialogUpdate({chatId:s})}(0,w.UF)(e);break}case"updateScheduledMessageSendSucceeded":{const{chatId:t,localId:a,message:o,poll:i}=s,r=(0,C.K3w)(e,t,n.l3)||[];e=(0,A.eww)(e,t,n.l3,"scheduledIds",[...r,o.id]);const d=(0,C.L_2)(e,o);if(d!==n.l3){const s=(0,C.K3w)(e,t,d)||[];e=(0,A.eww)(e,t,d,"scheduledIds",[...s,o.id])}const c=(0,C.Jl6)(e,t,a);e=(0,A.XAm)(e,t,[a]),e=(0,A.Egm)(e,t,o.id,{...c,...o,previousLocalId:a,isDeleting:void 0}),i&&(e=(0,A.J81)(e,i.id,i)),(0,w.UF)(e);break}case"updatePinnedIds":{const{chatId:t,isPinned:a,messageIds:o}=s,i=(0,h._E)((0,C.zeq)(e,t),o),r={[n.l3]:o};Object.values(i).forEach(s=>{const o=(0,C.L_2)(e,s);if(e=(0,A.r3y)(e,t,s.id,{isPinned:a}),o===n.l3)return;const i=r[o]||[];i.push(s.id),r[o]=i}),Object.entries(r).forEach(s=>{let[o,i]=s;const r=(0,C.fcC)(e,t,n.l3)||[],d=a?(0,h.Am)(r.concat(i)).sort((e,t)=>t-e):r.filter(e=>!i.includes(e));e=(0,A.eww)(e,t,Number(o),"pinnedIds",d)}),(0,w.UF)(e);break}case"updateThreadInfo":{const{threadInfo:a}=s;e=(0,A.Ng8)(e,[a]);const{chatId:o,threadId:n}=a;if(!o||!n)return;const i=(0,C.hds)(e,o),r=(0,C.Vw0)(e,o,n),d=(0,C.S0q)(e,o,n);if(i?.isForum&&(d&&d.lastMessageId===r?.lastReadInboxMessageId?e=(0,A.TwA)(e,o,Number(n),{unreadCount:0}):t.loadTopicById({chatId:o,topicId:Number(n)})),!i?.isForum){const t=i?.lastReadInboxMessageId,s=a.lastReadInboxMessageId||t;t&&s&&(e=(0,A.eAk)(e,o,n,{lastReadInboxMessageId:Math.max(s,t)}))}(0,w.UF)(e);break}case"resetMessages":{const{id:a}=s,o=(0,C.zeq)(e,a);if(o&&!(0,k.L8)(a)){const s=(0,u.g0)();e=(0,A.AH0)(e,a,Object.keys(o).map(Number)),(0,w.UF)(e),t.loadFullChat({chatId:a,force:!0}),t.loadViewportMessages({chatId:a,threadId:n.l3,tabId:s})}break}case"deleteMessages":{const{ids:a,chatId:o}=s;Q(e,o,a,t);break}case"deleteScheduledMessages":{const{ids:a,newIds:o,chatId:i}=s,r=a?.some(t=>(0,C.Jl6)(e,i,t)?.isVideoProcessingPending),d=o?.find(t=>{const s=(0,C.O5q)(e,i,t);return s?.content.video});r&&d&&Object.values(e.byTabId).forEach(e=>{let{id:s}=e;t.showNotification({message:{key:"VideoConversionDone"},actionText:{key:"VideoConversionView"},action:{action:"focusMessage",payload:{chatId:i,messageId:d,tabId:s}},tabId:s})}),function(e,t,s,a){t.forEach(t=>{a=(0,A.Egm)(a,e,t,{isDeleting:!0})}),(0,w.UF)(a);const o=(0,C.Rwe)(a);setTimeout(()=>{a=(0,w.mS)(),a=(0,A.XAm)(a,e,t);const s=(0,C.yFI)(a,e);a=(0,A.eww)(a,e,n.l3,"scheduledIds",Object.keys(s||{}).map(Number)),(0,w.UF)(a)},o?q:j)}(i,a,0,e);break}case"deleteHistory":{const{chatId:o}=s,n=e.messages.byChatId[o];if(o===a.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map(e=>({...e,isDeleted:!0}))},(0,w.UF)(e)),n){const s=Object.keys(n.byId).map(Number);Q(e=(0,w.mS)(),o,s,t)}else t.requestChatUpdate({chatId:o});e=(0,w.mS)(),e=(0,A.SJu)(e,o),(0,w.UF)(e);break}case"deleteSavedHistory":{const{chatId:a}=s,o=e.currentUserId;e=(0,A.SJu)(e,a,"saved"),(0,w.UF)(e),function(e,t,s,a){const o=(0,C.zeq)(e,t);if(!o)return;const n=Object.values(o).filter(t=>(0,C.L_2)(e,t)===s).map(e=>e.id);n.length&&Q(e,t,n,a)}(e=(0,w.mS)(),o,a,t);break}case"deleteParticipantHistory":{const{chatId:a,peerId:o}=s;!function(e,t,s,a){const o=(0,C.zeq)(e,t),n=Object.values(o).filter(e=>e.senderId===s).map(e=>e.id);n.length&&Q(e,t,n,a)}(e=(0,w.mS)(),a,o,t);break}case"updateCommonBoxMessages":{const{ids:t,messageUpdate:a}=s;t.forEach(t=>{const s=(0,C.Egn)(e,t);s&&(e=(0,A.r3y)(e,s,t,a))}),(0,w.UF)(e);break}case"updateChannelMessages":{const{channelId:t,ids:a,messageUpdate:o}=s;a.forEach(s=>{e=(0,A.r3y)(e,t,s,o)}),(0,w.UF)(e);break}case"updateMessagePoll":{const{pollId:t,pollUpdate:a}=s;e=(0,A.J81)(e,t,a),(0,w.UF)(e);break}case"updateMessagePollVote":{const{pollId:t,peerId:a,options:o}=s;e=(0,A.DLl)(e,t,a,o),(0,w.UF)(e);break}case"updateServiceNotification":{const{message:a}=s;(0,C.dqr)(e)&&t.createServiceNotification({message:a});break}case"updateMessageReactions":{const{chatId:a,id:o,reactions:n}=s,i=(0,C.O5q)(e,a,o),r=(0,C.hds)(e,s.chatId);if(!r||!i)return;e=K(e,t,a,o,n,r,i.isOutgoing,i),(0,w.UF)(e);break}case"updateMessageExtendedMedia":{const{chatId:t,id:a,extendedMedia:o,isBought:n}=s,i=(0,C.O5q)(e,t,a);if(!(0,C.hds)(e,s.chatId)||!i)return;if(i.content.invoice){const s=o[0];if("mediaType"in s&&"extendedMediaPreview"===s.mediaType){if(!i.content.invoice)return;e=(0,A.r3y)(e,t,a,{content:{...i.content,invoice:{...i.content.invoice,extendedMedia:s}}}),(0,w.UF)(e)}else{const o=s;e=(0,A.r3y)(e,t,a,{content:{...o}}),(0,w.UF)(e)}}if(i.content.paidMedia){const s=n?{isBought:n,extendedMedia:o}:{extendedMedia:o,isBought:void 0};e=(0,A.r3y)(e,t,a,{content:{...i.content,paidMedia:{...i.content.paidMedia,...s}}}),(0,w.UF)(e)}break}case"updateTranscribedAudio":{const{transcriptionId:t,text:a,isPending:o}=s;e={...e,transcriptions:{...e.transcriptions,[t]:{...e.transcriptions[t]||{},transcriptionId:t,text:a,isPending:o}}},(0,w.UF)(e);break}case"updateMessageSendFailed":{const{chatId:a,localId:o,error:n}=s;n.match(/CHAT_SEND_.+?FORBIDDEN/)&&Object.values(e.byTabId).forEach(e=>{let{id:s}=e;t.showAllowedMessageTypesNotification({chatId:a,tabId:s})}),e=(0,A.r3y)(e,a,o,{sendingState:"messageSendingStateFailed"}),(0,w.UF)(e);break}case"updateMessageTranslations":{const{chatId:t,messageIds:a,toLanguageCode:o,translations:n}=s;e=(0,A.rmT)(e,t,a,o,n),(0,w.UF)(e);break}case"failedMessageTranslations":{const{chatId:t,messageIds:a,toLanguageCode:o}=s;e=(0,A.rmT)(e,t,a,o,[]),(0,w.UF)(e)}}});const Z=new Map,ee=(0,I.sg)(e=>e(),500,!1);async function te(e){let{global:t,chatId:s,threadId:a,draft:o,isLocalOnly:n,noLocalTimeUpdate:i}=e;const r=(0,C.hds)(t,s),d=(0,C.mBe)(t,s);if(!r||d&&(0,y.PL)(d))return;const c=(0,C.OEv)(t,s,a,o?.replyInfo),l=o?{...o,replyInfo:c,date:Math.floor(Date.now()/1e3),isLocal:!0}:void 0;t=(0,A.eww)(t,s,a,"draft",l),i||(t=(0,A.wix)(t,s,{draftDate:l?.date})),(0,w.UF)(t),n||(await(0,b.px)("saveDraft",{chat:r,draft:l})&&l&&(l.isLocal=!1),t=(0,w.mS)(),t=(0,A.eww)(t,s,a,"draft",l),t=(0,A.wix)(t,s,{draftDate:l?.date}),(0,w.UF)(t))}async function se(e,t,s){const{fromChatId:a,messageIds:o,toChatId:i,withMyScore:r,noAuthors:d,noCaptions:c,toThreadId:l=n.l3}=(0,C.nTw)(e,s).forwardMessages,{messagePriceInStars:u,isSilent:m,scheduledAt:p}=t,g=(0,C.g29)(e),f=l===n.l3,I=a?(0,C.hds)(e,a):void 0,v=i?(0,C.hds)(e,i):void 0,S=a&&o?o.sort((e,t)=>e-t).map(t=>(0,C.O5q)(e,a,t)).filter(Boolean):void 0;if(!I||!v||!S||l&&!f&&!v.isForum)return;const A=(0,C.VF$)(e,i),P=(0,C.GA4)(e,i,l||n.l3),k=(0,C.ZZX)(e,v.id),F=[],[T,x]=(0,h.jB)(S,e=>!(0,y.u7)(e)),U=T.filter(t=>(0,C.R4s)(e,t));if(U.length){const s=e.config?.maxForwardedCount?(0,y.v$)(U,e.config.maxForwardedCount):[U];for(const e of s){const s={fromChat:I,toChat:v,toThreadId:l,messages:e,isSilent:m,scheduledAt:p,sendAs:A,withMyScore:r,noAuthors:d,noCaptions:c,isCurrentUserPremium:g,wasDrafted:Boolean(P),lastMessageId:k,messagePriceInStars:u};if(u){const e=await(0,b.px)("forwardMessagesLocal",s);F.push({...t,forwardParams:{...s,forwardedLocalMessagesSlice:e},forwardedLocalMessagesSlice:e})}else(0,b.px)("forwardMessages",s)}}for(const t of x){const{text:s,entities:a}=t.content.text||{},{sticker:o}=t.content,n={chat:v,replyInfo:(0,C.OEv)(e,v.id,l),text:s,entities:a,sticker:o,isSilent:m,scheduledAt:p,sendAs:A,lastMessageId:k};await ie(e,n,F)}return e=(0,w.mS)(),e=(0,M.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},s),(0,w.UF)(e),F}async function ae(e,t,s,o,r){let d=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7?arguments[7]:void 0;for(var m=arguments.length,p=new Array(m>8?m-8:0),g=8;g<m;g++)p[g-8]=arguments[g];let[f=(0,u.g0)()]=p;const I=t.id;let v,S=a.yo2;switch(r){case i.TN.Backwards:o?(v=-1,S+=1):v=void 0;break;case i.TN.Around:v=-(Math.round(a.yo2/2)+1);break;case i.TN.Forwards:v=-(a.yo2+1),o&&(S+=1)}const M=(e=(0,w.mS)()).currentUserId,P=(0,y.cG)(I,s,M),k=P?String(s):I,F=await(0,b.px)("fetchMessages",{chat:(0,C.hds)(e,k),offsetId:o,addOffset:v,limit:S,threadId:s,isSavedDialog:P});if(!F)return;const{messages:T,count:x}=F;e=(0,w.mS)();const U=I===a.zv8?e.serviceNotifications.filter(e=>{let{isDeleted:t}=e;return!t}).map(e=>{let{message:t}=e;return t}):[],B=[].concat(T,U),R=(0,h.dU)(B,"id"),N=Object.keys(R).map(Number);if(s!==n.l3&&!(0,y.cG)(I,s,e.currentUserId)){const t=(0,C.dU3)(e,I,s);N[0]&&t!==N[0]||t===s||N.unshift(Number(s))}e=(0,A.o4A)(e,I,R),e=d?(0,A.E0b)(e,I,s,N):(0,A.d4w)(e,I,s,N);let J=(0,C.gCU)(e,I,s);const E=o?(0,C.Lzh)(e,I,s,o):void 0;if(d&&J&&E&&(E.length&&!(0,h.h8)(J,E)||(e=(0,A.d4w)(e,I,s,E),J=(0,C.gCU)(e,I,s),e=(0,A.qKm)(e,I,s,E),d=!1)),!c){const t=d&&E?E:J;if(t){const{newViewportIds:a}=oe(t,o,r);e=(0,A.s3Z)(e,I,s,a,f)}}x&&(e=(0,A.eAk)(e,t.id,s,{messagesCount:x})),(0,w.UF)(e),l?.()}function oe(e,t,s){const{length:o}=e,n=t?function(e,t){return t<e[0]?0:t>e[e.length-1]?e.length-1:e.findIndex((s,a)=>s===t||s<t&&e[a+1]>t)}(e,t):-1,r=s===i.TN.Backwards?n:n+1||o,d=s===i.TN.Around?Math.round(a.yo2/2):a.yo2,c=r-d,l=r+d-1,u=e.slice(Math.max(0,c),l+1);let h,m;switch(s){case i.TN.Backwards:h=r>=0,m=c>=0;break;case i.TN.Forwards:h=r<o,m=l<=o-1;break;case i.TN.Around:default:h=u.length>0,m=u.length===a.yo2}return{newViewportIds:u,areSomeLocal:h,areAllLocal:m}}async function ne(e,t){const s=(0,C.PVB)(e,t);if(!s)return;if((0,S.vj)(s)){if((0,C.ODG)(e,t))return;return s.paidMessagesStars}if(!s?.paidMessagesStars)return;const a=(0,C.vGo)(e,s.id);return a?a.paidMessagesStars:await(0,b.px)("fetchPaidMessagesStarsAmount",s)}async function ie(e,t,s){if(t.messagePriceInStars){const e=await(0,b.px)("sendMessageLocal",t);e&&s.push({...t,localMessage:e})}else re(e,t)}async function re(e,t){let s;(t.replyInfo||d.pz)&&await(0,I.P_)();const a=t.attachment?(t,o)=>{Z.has(o)||(s=o,Z.set(o,a)),e=(0,w.mS)(),e=(0,A.mR)(e,o,t),(0,w.UF)(e)}:void 0;await(0,b.px)("sendMessage",t,a),a&&s&&(e=(0,w.mS)(),e=(0,A.mR)(e,s,void 0),(0,w.UF)(e),Z.delete(s))}async function de(e,t,s){const a=(0,C.hds)(e,t);if(!a)return;const o=await(0,b.px)("fetchUnreadMentions",{chat:a,offsetId:s});if(!o)return;const{messages:n}=o,i=(0,h.dU)(n,"id"),r=Object.keys(i).map(Number);e=(0,w.mS)(),e=(0,A.o4A)(e,a.id,i),e=(0,A.Wez)(e,t,a,r),(0,w.UF)(e)}(0,w.aJ)("loadViewportMessages",(e,t,s)=>{const{direction:a=i.TN.Around,isBudgetPreload:o=!1,shouldForceRender:n=!1,onLoaded:r,onError:d,tabId:c=(0,u.g0)()}=s||{};let{chatId:l,threadId:h}=s||{};if(!l||!h){const t=(0,C.Xf0)(e,c);if(!t)return void d?.();l=t.chatId,h=t.threadId}const p=(0,C.hds)(e,l),g=(0,C._ls)(e,l);if(!p||g)return void d?.();const f=(0,C.rA3)(e,l,h,c),v=(0,C.gCU)(e,l,h);if(f&&f.length&&a!==i.TN.Around){const s=a===i.TN.Backwards?f[0]:f[f.length-1];if((0,m.iL)(s))return;if(s===h&&a===i.TN.Backwards)return;const n=Boolean(v&&!v.includes(s)),d=n?(0,C.Lzh)(e,l,h,s):v;if(d?.length){const{newViewportIds:i,areSomeLocal:m,areAllLocal:g}=oe(d,s,a);m&&(e=(0,A.s3Z)(e,l,h,i,c)),(0,I.aj)(()=>{!async function(e,t,s,a,o,n,i,r,d,c){for(var l=arguments.length,h=new Array(l>10?l-10:0),m=10;m<l;m++)h[m-10]=arguments[m];let[p=(0,u.g0)()]=h;s||await ae(e,n,i,d,r,a,o,c,p),o||t.loadViewportMessages({chatId:n.id,threadId:i,direction:r,isBudgetPreload:!0,onLoaded:c,tabId:p})}(e,t,g,n,o,p,h,a,s,r,c)})}if(o)return}else{const t=(0,C.kdX)(e,l,c)||(0,C.EHH)(e,l,h),s=Boolean(t&&v&&!v.includes(t)),a=(s?(0,C.Lzh)(e,l,h,t):v)||[],{newViewportIds:n,areSomeLocal:d,areAllLocal:u}=oe(a,t,i.TN.Around);d&&(e=(0,A.s3Z)(e,l,h,n,c)),u?r?.():(0,I.aj)(()=>{ae(e,p,h,t,i.TN.Around,s,o,r,c)})}(0,w.UF)(e,{forceOnHeavyAnimation:n})}),(0,w.aJ)("loadMessage",async(e,t,s)=>{const{chatId:a,messageId:o,replyOriginForId:i,threadUpdate:r}=s,d=(0,C.hds)(e,a);if(!d)return;const c=await async function(e,t,s,a){const o=await(0,b.px)("fetchMessage",{chat:t,messageId:s});if(o){if(o!==n.K1)return e=(0,w.mS)(),e=(0,A.r3y)(e,t.id,s,o.message),(0,w.UF)(e),o.message;if(a){e=(0,w.mS)();const s=(0,C.O5q)(e,t.id,a);e=(0,A.r3y)(e,t.id,a,{...s,replyInfo:void 0}),(0,w.UF)(e)}}}(e,d,o,i);if(c&&r){const{lastMessageId:t,isDeleting:s}=r;e=(0,w.mS)(),e=(0,A.Wwn)(e,c,a,t,s),(0,w.UF)(e)}}),(0,w.aJ)("loadMessagesById",async(e,t,s)=>{const{chatId:a,messageIds:o}=s,n=(0,C.hds)(e,a);if(!n)return;const i=await(0,b.px)("fetchMessagesById",{chat:n,messageIds:o});i&&(e=(0,w.mS)(),e=(0,A.o4A)(e,a,(0,h.dU)(i,"id")),(0,w.UF)(e))}),(0,w.aJ)("sendMessage",async(e,t,s)=>{const{messageList:o,tabId:i=(0,u.g0)()}=s,{storyId:r,peerId:d}=(0,C.V9I)(e,i),c=Boolean(r&&d);if(!o&&!c)return;let{chatId:l,threadId:f,type:I}=o||{};if(c&&(l=d,f=n.l3,I="thread"),s=(0,h.cJ)(s,["tabId"]),"scheduled"===I&&!s.scheduledAt)return e=(0,M.w)(e,{contentToBeScheduled:s},i),void(0,w.UF)(e);const v=(0,C.hds)(e,l),b=(0,C.GA4)(e,l,f),y=(0,C.nTw)(e,i).forwardMessages?.messageIds?.length,S=y||c?void 0:b?.replyInfo,A=y||c?void 0:b?.suggestedPostInfo,P=c?{type:"story",peerId:d,storyId:r}:void 0,k=(0,C.OEv)(e,l,f,S),F=P||k,T=(0,C.Vw0)(e,l,f),x=f===n.l3?(0,C.ZZX)(e,l):T?.lastMessageId,U=await ne(e,l),B=A?.price,R=B?.currency||a.OUy,N=B?.amount||0;if(N&&!S)if(R===a.OUy){if(N>(e.stars?.balance?.amount||0))return void t.openStarsBalanceModal({topup:{balanceNeeded:N},tabId:i})}else if(R===a.ykW&&N>(e.ton?.balance?.amount||0))return void t.openStarsBalanceModal({currency:a.ykW,tabId:i});const J=S&&A?(0,C.O5q)(e,l,S.replyToMsgId):void 0;let E;A&&J?.content&&(E=J.content);const L={...s,chat:v,replyInfo:F,suggestedPostInfo:A,suggestedMedia:E,noWebPage:(0,C.rQx)(e,l,f),sendAs:(0,C.VF$)(e,l),lastMessageId:x,messagePriceInStars:U,isStoryReply:c,isPending:!!U||void 0,...J&&{isInvertedMedia:J?.isInvertedMedia}};c||t.clearWebPagePreview({tabId:i});const Y=(!s.attachments||s.attachments.length<=1)&&!y,D=!Y&&s.shouldGroupMessages,O=[];if(Y){const{attachments:t,...s}=L,a={...s,attachment:t?t[0]:void 0,wasDrafted:Boolean(b)};await ie(e,a,O)}else if(D){const{text:t,entities:s,attachments:o,...n}=L,i=function(e){return e.reduce((e,t,s,a)=>0===s?(e.push([t]),e):(pe(t)===pe(a[s-1])?e[e.length-1].push(t):e.push([t]),e),[])}(o);let r=!1;for(let o=0;o<i.length;o++){const d=i[o],c=(0,h.lD)(d,a.ynd);for(let a=0;a<c.length;a++){const l=`${Date.now()}${o}${a}`,u=0===a&&0===o,h=a===c.length-1&&o===i.length-1;if(d[0].quick&&!d[0].shouldSendAsFile){const[o,...i]=c[a];let d={...n,text:u&&!r?t:void 0,entities:u&&!r?s:void 0,attachment:o,groupedId:i.length>0?l:void 0,wasDrafted:Boolean(b)};await ie(e,d,O),r=!0;for(const t of i)d={...n,attachment:t,groupedId:l},await ie(e,d,O)}else{const o=c[a].slice(0,-1),i=c[a][c[a].length-1];for(const t of o){const s={...n,attachment:t,groupedId:l};await ie(e,s,O)}const d={...n,text:h&&!r?t:void 0,entities:h&&!r?s:void 0,attachment:i,groupedId:o.length>0?l:void 0,wasDrafted:Boolean(b)};await ie(e,d,O),r=!0}}}}else{const{text:t,entities:s,attachments:a,replyInfo:o,...n}=L;if(t){const a={...n,text:t,entities:s,replyInfo:o,wasDrafted:Boolean(b)};await ie(e,a,O)}if(a)for(const t of a){const s={...n,attachment:t};await ie(e,s,O)}}if(y){const t=await se(e,L,i);t&&O.push(...t)}O?.length&&async function(e,t){const s=t[0]?.chat;if(!s||!t.length)return;const a=await ne(e,s.id);if(!a)return void(0,w.ko)().sendMessages({sendParams:t});const o=t.reduce((e,t)=>{if(t.localMessage?.id)e.push(t.localMessage.id);else if(t.forwardedLocalMessagesSlice?.localMessages){const s=Object.values(t.forwardedLocalMessagesSlice.localMessages).map(e=>e.id).filter(Boolean);e.push(...s)}return e},[]),n=t[0]?.forwardedLocalMessagesSlice?.localMessages,i=t[0]?.localMessage||n&&Object.values(n)[0];if(!i)return;const r=o.length,d=t[0];let c;if(1===t.length&&d.isStoryReply){const{gif:e,sticker:t,isReaction:s}=d;e?c={key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}}:t?c={key:"StoryTooltipStickerSent"}:s&&(c={key:"StoryTooltipReactionSent"})}const l=c||{key:"MessageSentPaidToastTitle",variables:{count:r},options:{pluralValue:r}};(0,w.ko)().sendMessages({sendParams:t}),(0,w.ko)().showNotification({localId:(0,m.bj)(i),title:l,message:{key:"MessageSentPaidToastText",variables:{amount:(0,g.Kk)((0,p.Yw)(),a*r)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage"})}(e,O)}),(0,w.aJ)("sendInviteMessages",async(e,t,s)=>{const{chatId:a,userIds:o,tabId:n=(0,u.g0)()}=s,i=(0,C.AWZ)(e,a);if(!i?.inviteLink)return;const r=[];return await Promise.all(o.map(t=>{const s=(0,C.hds)(e,t);if(!s)return;const a=(0,y.Yg)((0,C.mBe)(e,t));return a&&r.push(a),re(e,{chat:s,text:i.inviteLink})})),t.showNotification({message:(0,f.yE)("Conversation.ShareLinkTooltip.Chat.One",r.join(", ")),tabId:n})}),(0,w.aJ)("editMessage",(e,t,s)=>{const{messageList:a,text:o,entities:n,attachments:i,tabId:r=(0,u.g0)()}=s;if(!a)return;let d;const c=i?(t,s)=>{Z.has(s)||(d=s,Z.set(s,c)),e=(0,w.mS)(),e=(0,A.mR)(e,s,t),(0,w.UF)(e)}:void 0,{chatId:l,threadId:h,type:m}=a,p=(0,C.hds)(e,l),g=(0,C.KLw)(e,l,h,m);p&&g&&(t.setEditingId({messageId:void 0,tabId:r}),(async()=>{await(0,b.px)("editMessage",{chat:p,message:g,attachment:i?i[0]:void 0,text:o,entities:n,noWebPage:(0,C.rQx)(e,l,h)},c),c&&d&&(e=(0,w.mS)(),e=(0,A.mR)(e,d,void 0),(0,w.UF)(e),Z.delete(d))})())}),(0,w.aJ)("editTodo",(e,t,s)=>{const{chatId:a,todo:o,messageId:n}=s,i=(0,C.hds)(e,a),r=(0,C.O5q)(e,a,n);i&&r&&(0,b.px)("editTodo",{chat:i,message:r,todo:o})}),(0,w.aJ)("cancelUploadMedia",(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.O5q)(e,a,o);if(!n)return;const i=n&&Z.get((0,m.bj)(n));i&&(0,b.om)(i),(0,y.Nb)(n)&&t.apiUpdate({"@type":"deleteMessages",ids:[o],chatId:a})}),(0,w.aJ)("saveDraft",(e,t,s)=>{const{chatId:a,threadId:o,text:n}=s,i=(0,C.hds)(e,a);if(!n||!i)return;const r=(0,C.GA4)(e,a,o);(!i.isMonoforum||r?.replyInfo||r?.suggestedPostInfo)&&te({global:e,chatId:a,threadId:o,draft:{text:n,replyInfo:r?.replyInfo,effectId:r?.effectId,suggestedPostInfo:r?.suggestedPostInfo}})}),(0,w.aJ)("clearDraft",(e,t,s)=>{const{chatId:a,threadId:o=n.l3,isLocalOnly:i,shouldKeepReply:r,shouldKeepSuggestedPost:d}=s,c=(0,C.GA4)(e,a,o);if(!c)return;const l=c.replyInfo;te({global:e,chatId:a,threadId:o,draft:r&&l||d&&c.suggestedPostInfo?{replyInfo:r?l:void 0,suggestedPostInfo:d?c.suggestedPostInfo:void 0}:void 0,isLocalOnly:i})}),(0,w.aJ)("updateDraftReplyInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,n=(0,C.Xf0)(e,a);if(!n)return;const{chatId:i,threadId:r}=n,d=(0,C.GA4)(e,i,r),c={type:"message",...d?.replyInfo,...o};c.replyToMsgId&&te({global:e,chatId:i,threadId:r,draft:{...d,replyInfo:c,suggestedPostInfo:void 0},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("resetDraftReplyInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:n,threadId:i}=o,r=(0,C.hds)(e,n),d=(0,C.GA4)(e,n,i);if(r?.isMonoforum&&!d?.replyInfo&&!d?.suggestedPostInfo)return;const c=d?.text?{...d,replyInfo:void 0}:void 0;te({global:e,chatId:n,threadId:i,draft:c,isLocalOnly:Boolean(c)})}),(0,w.aJ)("updateDraftSuggestedPostInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,n=(0,C.Xf0)(e,a);if(!n)return;const{chatId:i,threadId:r}=n,d=(0,C.GA4)(e,i,r),c={...d?.suggestedPostInfo,...o};te({global:e,chatId:i,threadId:r,draft:{...d,suggestedPostInfo:c},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("resetDraftSuggestedPostInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:n,threadId:i}=o;te({global:e,chatId:n,threadId:i,draft:void 0,isLocalOnly:!1})}),(0,w.aJ)("initDraftFromSuggestedMessage",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.O5q)(e,a,o);if(!i)return;const r=(0,C.Xf0)(e,n);if(!r)return;const{threadId:d}=r;if(t.clearDraft({chatId:a,threadId:d,isLocalOnly:!0}),t.updateDraftReplyInfo({replyToMsgId:o,monoforumPeerId:(0,C.QP5)(e,i),tabId:n}),i.suggestedPostInfo){const{scheduleDate:s,...a}=i.suggestedPostInfo,o=(0,v.Fm)(),r=e.appConfig.starsSuggestedPostFutureMin,d=s&&s>o+r?s:void 0;t.updateDraftSuggestedPostInfo({...a,scheduleDate:d,tabId:n})}t.saveDraft({chatId:a,threadId:d,text:i.content.text})}),(0,w.aJ)("saveEffectInDraft",(e,t,s)=>{const{chatId:a,threadId:o,effectId:n}=s,i=(0,C.hds)(e,a),r=(0,C.GA4)(e,a,o);(!i?.isMonoforum||r?.replyInfo||r?.suggestedPostInfo)&&te({global:e,chatId:a,threadId:o,draft:{...r,effectId:n},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("updateInsertingPeerIdMention",(e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{insertingPeerIdMention:a},o)}),(0,w.aJ)("toggleMessageWebPage",(e,t,s)=>{const{chatId:a,threadId:o,noWebPage:n}=s;return(0,A.eww)(e,a,o,"noWebPage",n)}),(0,w.aJ)("pinMessage",(e,t,s)=>{const{chatId:a,messageId:o,isUnpin:n,isOneSide:i,isSilent:r}=s,d=(0,C.hds)(e,a);d&&(0,b.px)("pinMessage",{chat:d,messageId:o,isUnpin:n,isOneSide:i,isSilent:r})}),(0,w.aJ)("unpinAllMessages",async(e,t,s)=>{const{chatId:a,threadId:o}=s,i=(0,C.hds)(e,a);if(!i)return;await(0,b.px)("unpinAllMessages",{chat:i,threadId:o}),e=(0,w.mS)();const r=(0,C.fcC)(e,a,o);r?.forEach(t=>{e=(0,A.r3y)(e,a,t,{isPinned:!1})}),e=(0,A.eww)(e,i.id,n.l3,"pinnedIds",[]),(0,w.UF)(e)}),(0,w.aJ)("deleteMessages",(e,t,s)=>{const{messageIds:a,shouldDeleteForAll:o,messageList:n,tabId:i=(0,u.g0)()}=s,r=(0,C.Xf0)(e,i),d=n||r;if(!d)return;const{chatId:c,threadId:l}=d,h=(0,C.hds)(e,c),m=a.filter(t=>{const s=(0,C.O5q)(e,c,t);return s&&!(0,y.Nb)(s)});if(!m.length&&a.length)return void Q(e,(0,y.WX)(h)||(0,y.Vs)(h)?c:void 0,a,t);(0,b.px)("deleteMessages",{chat:h,messageIds:m,shouldDeleteForAll:o});const p=(0,C.Ys6)(e,c,l);p&&a.includes(p)&&t.setEditingId({messageId:void 0,tabId:i})}),(0,w.aJ)("resetLocalPaidMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).notifications;return o&&o.length?(o.forEach(e=>{if("paidMessage"===e.type){const s=e.dismissAction;s&&!Array.isArray(s)&&t[s.action](s.payload),t.dismissNotification({localId:e.localId,tabId:a})}}),e):e}),(0,w.aJ)("deleteParticipantHistory",(e,t,s)=>{const{chatId:a,peerId:o}=s,n=(0,C.hds)(e,a),i=(0,C.PVB)(e,o);(0,b.px)("deleteParticipantHistory",{chat:n,peer:i})}),(0,w.aJ)("deleteScheduledMessages",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Xf0)(e,o);if(!n)return;const{chatId:i}=n,r=(0,C.hds)(e,i);(0,b.px)("deleteScheduledMessages",{chat:r,messageIds:a});const d=(0,C.VlN)(e,i);d&&a.includes(d)&&t.setEditingId({messageId:void 0,tabId:o})}),(0,w.aJ)("deleteHistory",async(e,t,s)=>{const{chatId:a,shouldDeleteForAll:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;await(0,b.px)("deleteHistory",{chat:i,shouldDeleteForAll:o}),e=(0,w.mS)();const r=(0,C.Xf0)(e,n);r&&r.chatId===a&&t.openChat({id:void 0,tabId:n});const d=e.chatFolders.byId;Object.values(d).forEach(e=>{if(e.includedChatIds.includes(a)||e.pinnedChatIds?.includes(a)){const t=e.includedChatIds.filter(e=>e!==a),s=e.pinnedChatIds?.filter(e=>e!==a),o={...e,includedChatIds:t,pinnedChatIds:s};(0,b.px)("editChatFolder",{id:e.id,folderUpdate:o})}})}),(0,w.aJ)("deleteSavedHistory",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;await(0,b.px)("deleteSavedHistory",{chat:n}),e=(0,w.mS)();const i=(0,C.Xf0)(e,o);i&&i.threadId===a&&t.openChat({id:void 0,tabId:o})}),(0,w.aJ)("reportMessages",async(e,t,s)=>{const{messageIds:o,description:n="",option:i="",chatId:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,r),l=await(0,b.px)("reportMessages",{peer:c,messageIds:o,description:n,option:i});if(!l)return;const{result:h,error:m}=l;if(m===a.zLi)return t.showNotification({message:(0,f.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===i),a={title:h.title,options:h.options,subtitle:s?.text};e=(0,M.w)(e,{reportModal:{chatId:r,messageIds:o,description:n,subject:"message",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===i),a={isOptional:h.isOptional,option:h.option,title:s?.text};e=(0,M.w)(e,{reportModal:{chatId:r,messageIds:o,description:n,subject:"message",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}}}),(0,w.aJ)("sendMessageAction",async(e,t,s)=>{const{action:a,chatId:o,threadId:n}=s;if("connectionStateReady"!==e.connectionState)return;if((0,C.nZ4)(e,o))return;const i=(0,C.hds)(e,o);if(!i||i.isMonoforum)return;const r=(0,C.mBe)(e,o);r&&((0,y.tv)(r)||(0,y.PL)(r))||await(0,b.px)("sendMessageAction",{peer:i,threadId:n,action:a})}),(0,w.aJ)("reportChannelSpam",(e,t,s)=>{const{participantId:a,chatId:o,messageIds:n}=s,i=(0,C.PVB)(e,a),r=(0,C.hds)(e,o);i&&r&&(0,b.px)("reportChannelSpam",{peer:i,chat:r,messageIds:n})}),(0,w.aJ)("markMessageListRead",(e,t,s)=>{if((0,C.trm)(e))return;const{maxId:o,tabId:i=(0,u.g0)()}=s,r=(0,C.Xf0)(e,i);if(!r)return;const{chatId:d,threadId:c}=r,l=(0,C.hds)(e,d);if(!l||(0,y.cG)(d,c,e.currentUserId))return;ee(()=>{(0,b.px)("markMessageListRead",{chat:l,threadId:c,maxId:o})}),d===a.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map(e=>e.isUnread&&e.id<=o?{...e,isUnread:!1}:e)});const h=(0,C.rA3)(e,d,c,i),m=(0,C.RjD)(e,d,c);if(c!==n.l3&&!l.isForum)return(0,A.eAk)(e,d,c,{lastReadInboxMessageId:o});if(!h||!m||!l.unreadCount)return e;const p=function(e,t,s){if(0===e.length||t<e[0]||s>e[e.length-1])return;let a=0;for(let o=0,n=e.length;o<n&&(e[o]>=t&&e[o]<=s&&a++,!(e[o]>=s));o++);return a}(h,m,o);if(!p)return e;const g=(0,C.S0q)(e,d,c);if(l.isForum&&g){e=(0,A.eAk)(e,d,c,{lastReadInboxMessageId:o});const t=Math.max(0,g.unreadCount-p);return 0===t&&(e=(0,A.wix)(e,d,{unreadCount:Math.max(0,l.unreadCount-1)})),(0,A.TwA)(e,d,Number(c),{unreadCount:t})}return(0,A.wix)(e,d,{lastReadInboxMessageId:o,unreadCount:Math.max(0,l.unreadCount-p)})}),(0,w.aJ)("markMessagesRead",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)(),shouldFetchUnreadReactions:n}=s,i=(0,C.meB)(e,o);i&&(0,b.px)("markMessagesRead",{chat:i,messageIds:a}).then(()=>{n&&t.fetchUnreadReactions({chatId:i.id})})}),(0,w.aJ)("loadWebPagePreview",async(e,t,s)=>{const{text:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("fetchWebPagePreview",{text:a});e=(0,w.mS)(),e=(0,M.w)(e,{webPagePreviewId:n?.id},o),(0,w.UF)(e),n&&t.apiUpdate({"@type":"updateWebPage",webPage:n})}),(0,w.aJ)("clearWebPagePreview",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{webPagePreviewId:void 0},a)}),(0,w.aJ)("sendPollVote",(e,t,s)=>{const{chatId:a,messageId:o,options:n}=s,i=(0,C.hds)(e,a);i&&(0,b.px)("sendPollVote",{chat:i,messageId:o,options:n})}),(0,w.aJ)("toggleTodoCompleted",(e,t,s)=>{const{chatId:a,messageId:o,completedIds:n,incompletedIds:i}=s,r=(0,C.hds)(e,a),d=(0,C.O5q)(e,a,o),c=e.currentUserId,l=d?.content.todo;if(!l||!c||!r)return;const u=l.completions||[],h=u.map(e=>e.itemId),m=[...u],p=(0,v.Fm)();n.forEach(e=>{h.includes(e)||m.push({itemId:e,completedBy:c,completedAt:p})});const g=m.filter(e=>!i.includes(e.itemId)),f={...d.content,todo:{...l,completions:g}},I={...d,content:f};e=W(e,a,d.id,I),(0,w.UF)(e),(0,b.px)("toggleTodoCompleted",{chat:r,messageId:d.id,completedIds:n,incompletedIds:i})}),(0,w.aJ)("appendTodoList",(e,t,s)=>{const{chatId:a,items:o,messageId:n}=s,i=(0,C.hds)(e,a),r=(0,C.O5q)(e,a,n);i&&r&&(0,b.px)("appendTodoList",{chat:i,message:r,items:o})}),(0,w.aJ)("cancelPollVote",(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a);n&&(0,b.px)("sendPollVote",{chat:n,messageId:o,options:[]})}),(0,w.aJ)("closePoll",(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a),i=(0,C.O5q)(e,a,o),r=i&&(0,C.zcZ)(e,i);n&&r&&(0,b.px)("closePoll",{chat:n,messageId:o,poll:r})}),(0,w.aJ)("loadPollOptionResults",async(e,t,s)=>{const{chat:a,messageId:o,option:n,offset:i,limit:r,shouldResetVoters:d,tabId:c=(0,u.g0)()}=s,l=await(0,b.px)("loadPollOptionResults",{chat:a,messageId:o,option:n,offset:i,limit:r});if(!l)return;e=(0,w.mS)();const m=(0,C.nTw)(e,c),{pollResults:p}=m,{voters:g}=m.pollResults;e=(0,M.w)(e,{pollResults:{...p,voters:{...g,[n]:(0,h.Am)([...!d&&g?.[n]?g[n]:[],...l.votes.map(e=>e.peerId)])},offsets:{...p.offsets?p.offsets:{},[n]:l.nextOffset||""}}},c),(0,w.UF)(e)}),(0,w.aJ)("loadExtendedMedia",(e,t,s)=>{const{chatId:a,ids:o}=s,n=(0,C.hds)(e,a);n&&(0,b.px)("fetchExtendedMedia",{chat:n,ids:o})}),(0,w.aJ)("loadScheduledHistory",async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const i=await(0,b.px)("fetchScheduledHistory",{chat:o});if(!i)return;const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort((e,t)=>t-e);if(e=(0,w.mS)(),e=(0,A.Ffw)(e,o.id,d),e=(0,A.eww)(e,o.id,n.l3,"scheduledIds",c),c.length||(e=(0,A.zTz)(e,o.id,{hasScheduledMessages:!1})),o?.isForum){const t={};r.forEach(s=>{const a=(0,C.L_2)(e,s),o=t[a]||[];o.push(s.id),t[a]=o}),Object.entries(t).forEach(t=>{let[s,a]=t;e=(0,A.eww)(e,o.id,Number(s),"scheduledIds",a)})}(0,w.UF)(e)}),(0,w.aJ)("sendScheduledMessages",(e,t,s)=>{const{chatId:a,id:o}=s,n=(0,C.hds)(e,a);n&&(0,b.px)("sendScheduledMessages",{chat:n,ids:[o]})}),(0,w.aJ)("rescheduleMessage",(e,t,s)=>{const{chatId:a,messageId:o,scheduledAt:n}=s,i=(0,C.hds)(e,a),r=i&&(0,C.Jl6)(e,i.id,o);i&&r&&(0,b.px)("rescheduleMessage",{chat:i,message:r,scheduledAt:n})}),(0,w.aJ)("transcribeAudio",async(e,t,s)=>{const{messageId:a,chatId:o}=s,n=(0,C.hds)(e,o);if(!n)return;e=(0,A.r3y)(e,o,a,{transcriptionId:""}),(0,w.UF)(e);const i=await(0,b.px)("transcribeAudio",{chat:n,messageId:a});e=(0,w.mS)(),e=(0,A.r3y)(e,o,a,{transcriptionId:i,isTranscriptionError:!i}),(0,w.UF)(e)}),(0,w.aJ)("loadCustomEmojis",async(e,t,s)=>{const{ids:a,ignoreCache:o}=s,n=o?a:(0,h.Am)(a.filter(t=>!(0,C.O8F)(e,t))),i=await(0,b.px)("fetchCustomEmoji",{documentId:n});i&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,byId:{...e.customEmojis.byId,...(0,h.dU)(i,"id")}}},(0,w.UF)(e))}),(0,w.aJ)("forwardMessages",(e,t,s)=>{const{isSilent:a,scheduledAt:o,tabId:n=(0,u.g0)()}=s,{toChatId:i}=(0,C.nTw)(e,n).forwardMessages,r=i?(0,C.hds)(e,i):void 0;r&&se(e,{chat:r,isSilent:a,scheduledAt:o},n)}),(0,w.aJ)("sendMessages",async(e,t,s)=>{const{sendParams:a}=s;await Promise.all(a.map(async t=>{t.forwardedLocalMessagesSlice&&t.forwardParams?(await(0,I.P_)(),await(0,b.px)("forwardApiMessages",t.forwardParams)):await re(e,t)})),a.length>0&&a[0].messagePriceInStars&&t.loadStarStatus()}),(0,w.aJ)("loadPinnedMessages",async(e,t,s)=>{const{chatId:a,threadId:o}=s,n=(0,C.hds)(e,a);if(!n||(0,y.cG)(a,o,e.currentUserId))return;const i=await(0,b.px)("fetchPinnedMessages",{chat:n,threadId:o});if(!i)return;const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort((e,t)=>t-e);e=(0,w.mS)(),e=(0,A.o4A)(e,n.id,d),e=(0,A.gz3)(e,n.id,o,c),(0,w.UF)(e)}),(0,w.aJ)("loadSeenBy",async(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a);if(!n)return;const i=await(0,b.px)("fetchSeenBy",{chat:n,messageId:o});i&&(e=(0,w.mS)(),e=(0,A.r3y)(e,a,o,{seenByDates:i}),(0,w.UF)(e))}),(0,w.aJ)("saveDefaultSendAs",(e,t,s)=>{const{chatId:a,sendAsId:o}=s,n=(0,C.hds)(e,a),i=(0,C.hds)(e,o)||(0,C.mBe)(e,o);if(n&&i)return(0,b.px)("saveDefaultSendAs",{sendAs:i,chat:n}),(0,A.ltr)(e,a,{sendAsId:o})}),(0,w.aJ)("loadSendAs",async(e,t,s)=>{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const n=await(0,b.px)("fetchSendAs",{chat:o});if(!n)return e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendAsPeerIds:n}),(0,w.UF)(e)}),(0,w.aJ)("loadSendPaidReactionsAs",async(e,t,s)=>{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const n=await(0,b.px)("fetchSendAs",{chat:o,isForPaidReactions:!0});if(!n)return e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendPaidReactionsAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendPaidReactionsAsPeerIds:n}),(0,w.UF)(e)}),(0,w.aJ)("loadSponsoredMessages",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;if((0,S.mO)(o)&&(0,C.I_m)(e,o.id))return;const n=await(0,b.px)("fetchSponsoredMessages",{peer:o});n&&(e=(0,w.mS)(),e=(0,A.EKx)(e,a,n.messages[0]),(0,w.UF)(e))}),(0,w.aJ)("viewSponsored",(e,t,s)=>{const{randomId:a}=s;(0,b.px)("viewSponsoredMessage",{random:a})}),(0,w.aJ)("clickSponsored",(e,t,s)=>{const{randomId:a,isMedia:o,isFullscreen:n}=s;(0,b.px)("clickSponsoredMessage",{random:a,isMedia:o,isFullscreen:n})}),(0,w.aJ)("reportSponsored",async(e,t,s)=>{const{peerId:a,randomId:o,option:n="",tabId:i=(0,u.g0)()}=s,r=await(0,b.px)("reportSponsoredMessage",{randomId:o,option:n});if(r){if("premiumRequired"===r.type)return t.openPremiumModal({initialSection:"no_ads",tabId:i}),void t.closeReportAdModal({tabId:i});if("reported"===r.type||"hidden"===r.type)return t.showNotification({message:(0,f.yE)("reported"===r.type?"AdReported":"AdHidden"),tabId:i}),t.closeReportAdModal({tabId:i}),e=(0,w.mS)(),e=a?(0,A.Itk)(e,a):(0,A.b8O)(e,{sponsoredPeer:void 0},i),void(0,w.UF)(e);if("selectOption"===r.type){e=(0,w.mS)();const t=(0,C.nTw)(e,i).reportAdModal?.sections,s=t?.[t.length-1]?.options.find(e=>e.option===n),d={title:r.title,options:r.options,subtitle:s?.text};e=(0,M.w)(e,{reportAdModal:{chatId:a,randomId:o,sections:t?[...t,d]:[d]}},i),(0,w.UF)(e)}}}),(0,w.aJ)("hideSponsored",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};(0,C.g29)(e)?await(0,b.px)("toggleSponsoredMessages",{enabled:!1})&&(e=(0,w.mS)(),e=(0,A.weB)(e,e.currentUserId,{areAdsEnabled:!1}),(0,w.UF)(e),t.showNotification({message:(0,f.yE)("AdHidden"),tabId:a})):t.openPremiumModal({initialSection:"no_ads",tabId:a})}),(0,w.aJ)("fetchUnreadMentions",async(e,t,s)=>{const{chatId:a,offsetId:o}=s;await de(e,a,o)}),(0,w.aJ)("approveSuggestedPost",async(e,t,s)=>{const{chatId:o,messageId:n,scheduleDate:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,o);if(!d)return;const c=(0,C.O5q)(e,o,n);if(!(0,C.ODG)(e,o)&&c?.suggestedPostInfo?.price?.amount){const s=c.suggestedPostInfo.price.amount;if(c.suggestedPostInfo.price.currency===a.OUy){if(s>(e.stars?.balance?.amount||0))return void t.openStarsBalanceModal({topup:{balanceNeeded:s},tabId:r})}else if(s>(e.ton?.balance?.amount||0))return void t.openStarsBalanceModal({currency:a.ykW,tabId:r})}await(0,b.px)("toggleSuggestedPostApproval",{chat:d,messageId:n,reject:!1,scheduleDate:i})&&t.showNotification({message:{key:"SuggestedPostApproved"},tabId:r})}),(0,w.aJ)("rejectSuggestedPost",async(e,t,s)=>{const{chatId:a,messageId:o,rejectComment:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a);r&&await(0,b.px)("toggleSuggestedPostApproval",{chat:r,messageId:o,reject:!0,rejectComment:n})&&t.showNotification({message:{key:"SuggestedPostRejectedNotification"},tabId:i})}),(0,w.aJ)("markMentionsRead",(e,t,s)=>{const{chatId:a,messageIds:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);i&&(e=(0,A.pWt)(e,a,i,o,!0),(0,w.UF)(e),t.markMessagesRead({messageIds:o,tabId:n}))}),(0,w.aJ)("focusNextMention",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};let o=(0,C.meB)(e,a);if(o){if(!o.unreadMentions){await de(e,o.id),e=(0,w.mS)();const t=o.id;if(o=(0,C.meB)(e,a),!o?.unreadMentions||t!==o.id)return}t.focusMessage({chatId:o.id,messageId:o.unreadMentions[0],tabId:a})}}),(0,w.aJ)("readAllMentions",(e,t,s)=>{const{chatId:a,threadId:o=n.l3}=s,i=(0,C.hds)(e,a);if(i)return(0,b.px)("readAllMentions",{chat:i,threadId:o===n.l3?void 0:o}),o===n.l3?(0,A.wix)(e,i.id,{unreadMentionsCount:void 0,unreadMentions:void 0}):void 0}),(0,w.aJ)("openUrl",(e,t,s)=>{const{url:o,shouldSkipModal:n,ignoreDeepLinks:i,linkContext:d,tabId:c=(0,u.g0)()}=s,h=(0,r.Tc)(o),m=new URL(h),p=(0,r._G)(h);if(!i&&(0,l.zq)(h))return t.closeStoryViewer({tabId:c}),t.closePaymentModal({tabId:c}),void t.openTelegramLink({url:o,linkContext:d,tabId:c});const{appConfig:g,config:f}=e;if(f?.autologinToken&&g.autologinDomains.includes(m.hostname))return m.searchParams.set("autologin_token",f.autologinToken),void window.open(m.href,"_blank","noopener");if(g.urlAuthDomains.includes(m.hostname))return t.closeStoryViewer({tabId:c}),void t.requestLinkUrlAuth({url:o,tabId:c});const I=g.whitelistedDomains.includes(m.hostname);h.match(a.H_r)||n||I?window.open(m,"_blank","noopener"):t.toggleSafeLinkModal({url:p?m.toString():h,tabId:c})}),(0,w.aJ)("openChatOrTopicWithReplyInDraft",(e,t,s)=>{const{chatId:a,topicId:o,tabId:i=(0,u.g0)()}=s;e=(0,w.mS)();const r=(0,C.nTw)(e,i).replyingMessage;e=(0,M.w)(e,{isShareMessageModalShown:!1,replyingMessage:{}},i),(0,w.UF)(e),e=(0,w.mS)();const d=(0,C.meB)(e,i),c=(0,C.Xf0)(e,i)?.threadId;if(!d||!c)return;const l=o||n.l3,h=d.id,m={type:"message",replyToMsgId:r.messageId,replyToTopId:r.toThreadId,replyToPeerId:h,monoforumPeerId:r.toThreadId,quoteText:r.quoteText,quoteOffset:r.quoteOffset},p=r.messageId?m:(0,C.GA4)(e,h,c)?.replyInfo;if(!p)return;if(!(0,C.Vz3)(e,a,h,p))return void t.showNotification({message:(0,f.yE)("Chat.SendNotAllowedText"),tabId:i});if(!p.replyToPeerId&&a===d.id)return;const g=p?.replyToPeerId?p.replyToPeerId===a?void 0:p.replyToPeerId:h;!function(e,t,s,a){const o=(0,C.GA4)(e,a,t);s.replyToMsgId&&te({global:e,chatId:a,threadId:t,draft:{...o,replyInfo:s},isLocalOnly:!0,noLocalTimeUpdate:!0})}(e,l,{...p,replyToPeerId:g,type:"message"},a),t.openThread({chatId:a,threadId:l,tabId:i}),t.closeMediaViewer({tabId:i}),t.exitMessageSelectMode({tabId:i}),t.clearDraft({chatId:h,threadId:c})}),(0,w.aJ)("setForwardChatOrTopic",async(e,t,s)=>{const{chatId:a,topicId:o,tabId:i=(0,u.g0)()}=s,r=(0,C.mBe)(e,a);(0,C.lC)(e,i)&&r&&!await async function(e,t,s){let a=(0,C.vGo)(e,s);if(!a){const{accessHash:e}=t,o=await(0,b.px)("fetchFullUser",{id:s,accessHash:e});a=o?.fullInfo}return Boolean(!a?.noVoiceMessages)}(e,r,a)?t.showDialog({data:{message:(0,f.yE)("VoiceMessagesRestrictedByPrivacy",(0,y.Yg)(r))},tabId:i}):(e=(0,w.mS)(),(0,C.DI)(e,a,i)?(e=(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,i).forwardMessages,toChatId:a,toThreadId:o},isShareMessageModalShown:!1},i),(0,w.UF)(e),t.openThread({chatId:a,threadId:o||n.l3,tabId:i}),t.closeMediaViewer({tabId:i}),t.exitMessageSelectMode({tabId:i})):t.showAllowedMessageTypesNotification({chatId:a,tabId:i}))}),(0,w.aJ)("forwardToSavedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,a).forwardMessages,toChatId:e.currentUserId}},a),(0,w.UF)(e),t.exitMessageSelectMode({tabId:a}),t.forwardMessages({isSilent:!0,tabId:a})}),(0,w.aJ)("forwardStory",(e,t,s)=>{const{toChatId:a,tabId:o=(0,u.g0)()}=s||{},{fromChatId:n,storyId:i}=(0,C.nTw)(e,o).forwardMessages,r=n?(0,C.hds)(e,n):void 0,d=a?(0,C.hds)(e,a):void 0,c=n&&i?(0,C.Msb)(e,n,i):void 0;if(!r||!d||!c||"isDeleted"in c)return;const l=(0,C.ZZX)(e,a),{text:h,entities:m}=c.content.text||{};re(e,{chat:d,text:h,entities:m,story:c,lastMessageId:l}),e=(0,w.mS)(),e=(0,M.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},o),(0,w.UF)(e)}),(0,w.aJ)("requestMessageTranslation",(e,t,s)=>{const{chatId:a,id:o,toLanguageCode:n=(0,C.Qq_)(e),tabId:i=(0,u.g0)()}=s;return e=(0,A._Bm)(e,a,o,n,i),(0,A.qpc)(e,{translationLanguage:n})}),(0,w.aJ)("showOriginalMessage",(e,t,s)=>{const{chatId:a,id:o,tabId:n=(0,u.g0)()}=s;return(0,A.xGf)(e,a,o,n)}),(0,w.aJ)("markMessagesTranslationPending",(e,t,s)=>{const{chatId:a,messageIds:o,toLanguageCode:n=(0,C.wmb)(e)}=s;return o.forEach(t=>{e=(0,A.oeN)(e,a,t,n,{isPending:!0})}),e}),(0,w.aJ)("translateMessages",(e,t,s)=>{const{chatId:a,messageIds:o,toLanguageCode:n=(0,C.wmb)(e)}=s,i=(0,C.hds)(e,a);if(i)return t.markMessagesTranslationPending({chatId:a,messageIds:o,toLanguageCode:n}),(0,b.px)("translateText",{chat:i,messageIds:o,toLanguageCode:n}),e});let ce,le={};function ue(){ce&&(clearTimeout(ce),ce=void 0);const{loadMessageViews:e}=(0,w.ko)();Object.entries(le).forEach(t=>{let[s,a]=t;e({chatId:s,ids:Array.from(a),shouldIncrement:!0})}),le={}}(0,w.aJ)("scheduleForViewsIncrement",(e,t,s)=>{const{ids:a,chatId:o}=s;ce||setTimeout(ue,1e3),le[o]||(le[o]=new Set),a.forEach(e=>{le[o].add(e)})}),(0,w.aJ)("loadMessageViews",async(e,t,s)=>{const{chatId:a,ids:o,shouldIncrement:n}=s;if((0,C.trm)(e))return;const i=(0,C.hds)(e,a);if(!i)return;const r=await(0,b.px)("fetchMessageViews",{chat:i,ids:o,shouldIncrement:n});r&&(e=(0,w.mS)(),r.viewsInfo.forEach(t=>{e=(0,A.r3y)(e,a,t.id,{viewsCount:t.views,forwardsCount:t.forwards},!0),t.threadInfo&&(e=(0,A.eAk)(e,a,t.id,t.threadInfo))}),(0,w.UF)(e))}),(0,w.aJ)("loadFactChecks",async(e,t,s)=>{const{chatId:a,ids:o}=s,n=(0,C.hds)(e,a);if(!n)return;const i=await(0,b.px)("fetchFactChecks",{chat:n,ids:o});i&&(e=(0,w.mS)(),i.forEach((t,s)=>{e=(0,A.r3y)(e,a,o[s],{factCheck:t})}),(0,w.UF)(e))}),(0,w.aJ)("loadPaidReactionPrivacy",()=>{(0,b.px)("fetchPaidReactionPrivacy")}),(0,w.aJ)("loadOutboxReadDate",async(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a);if(n)try{const t=await(0,b.px)("fetchOutboxReadDate",{chat:n,messageId:o});t?.date&&(e=(0,w.mS)(),e=(0,A.r3y)(e,a,o,{readDate:t.date}),(0,w.UF)(e))}catch(t){const{message:s}=t;if("USER_PRIVACY_RESTRICTED"===s||"YOUR_PRIVACY_RESTRICTED"===s){if(e=(0,w.mS)(),!(0,C.mBe)(e,a))return;const t=(0,C.K0y)(e,a);if(!t)return;const n="USER_PRIVACY_RESTRICTED"===s?{isReadDateRestricted:!0}:{isReadDateRestrictedByMe:!0};e=(0,A.wWy)(e,{[a]:{...t,...n}}),e=(0,A.r3y)(e,a,o,{readDate:void 0}),(0,w.UF)(e)}}}),(0,w.aJ)("loadQuickReplies",async e=>{const t=await(0,b.px)("fetchQuickReplies");t&&(e=(0,w.mS)(),e=(0,A.tMr)(e,(0,h.dU)(t.messages,"id")),e=(0,A.xAV)(e,t.quickReplies),(0,w.UF)(e))}),(0,w.aJ)("sendQuickReply",(e,t,s)=>{const{chatId:a,quickReplyId:o}=s,n=(0,C.hds)(e,a);return n?((0,b.px)("sendQuickReply",{chat:n,shortcutId:o}),e):e}),(0,w.aJ)("copyMessageLink",async(e,t,s)=>{const{chatId:a,messageId:o,shouldIncludeThread:n,shouldIncludeGrouped:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a);if(!d)return void t.showNotification({message:(0,f.yE)("ErrorOccurred"),tabId:r});const l=()=>t.showNotification({message:(0,f.yE)("ErrorOccurred"),tabId:r});if(!(0,y.WX)(d)&&!(0,y.Vs)(d))return void l();const h=(0,b.px)("exportMessageLink",{chat:d,id:o,shouldIncludeThread:n,shouldIncludeGrouped:i});await(0,c.LD)(h,()=>t.showNotification({message:(0,f.yE)("LinkCopied"),tabId:r}),l)});const he=new Map;let me;function pe(e){const{shouldSendAsFile:t,mimeType:s}=e;return a.IH3.has(s)?"audio":t?"file":s===a.Vz3?"gif":a.gex.has(s)||a.fNs.has(s)?"media":e.voice?"voice":"file"}(0,w.aJ)("reportMessageDelivery",(e,t,s)=>{const{chatId:a,messageId:o}=s,n=he.get(a)||[];n.push(o),he.set(a,n),me||(me=window.setTimeout(()=>{me=void 0,he.forEach((t,s)=>{const a=(0,C.hds)(e,s);a&&(0,b.px)("reportMessagesDelivery",{chat:a,messageIds:t})}),he.clear()},500))}),(0,w.aJ)("openPreparedInlineMessageModal",async(e,t,s)=>{const{botId:a,messageId:o,webAppKey:n,tabId:i=(0,u.g0)()}=s,r=(0,C.mBe)(e,a);if(!r)return;const d=await(0,b.px)("fetchPreparedInlineMessage",{bot:r,id:o});d?(e=(0,w.mS)(),e=(0,M.w)(e,{preparedMessageModal:{message:d,webAppKey:n,botId:a}},i),(0,w.UF)(e)):t.sendWebAppEvent({webAppKey:n,event:{eventType:"prepared_message_failed",eventData:{error:"MESSAGE_EXPIRED"}},tabId:i})}),(0,w.aJ)("openSharePreparedMessageModal",(e,t,s)=>{const{webAppKey:a,message:o,tabId:n=(0,u.g0)()}=s,i=o.peerTypes?.filter(e=>"self"!==e);e=(0,w.mS)(),e=(0,M.w)(e,{sharePreparedMessageModal:{webAppKey:a,filter:i,message:o}},n),(0,w.UF)(e)});var ge=s(529),fe=s(64520);const Ie=(0,I.nF)(e=>e(),500,!1);async function ve(e,t){const s=await(0,b.px)("fetchRecentStickers",{hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:s}},(0,w.UF)(e))}async function be(e,t,s){let a;try{a=await(0,b.px)("fetchStickers",{stickerSetInfo:s})}catch(a){if("STICKERSET_INVALID"===a.message)return void Object.values(e.byTabId).forEach(a=>{let{id:o}=a;t.showNotification({message:(0,f.yE)("StickerPack.ErrorNotFound"),tabId:o}),"shortName"in s&&(0,C.nTw)(e,o).openedStickerSetShortName===s.shortName&&(e=(0,M.w)(e,{openedStickerSetShortName:void 0},o),(0,w.UF)(e))})}if(e=(0,w.mS)(),!a)return;const{set:o,stickers:n,packs:i}=a,r=(e=(0,A.v9P)(e,o.id,{...o,stickers:n,packs:i})).stickers.forEmoji.emoji;r&&i[r]&&(e=(0,A.PcY)(e)),(0,w.UF)(e)}async function ye(e,t,s,a){for(var o=arguments.length,n=new Array(o>4?o-4:0),i=4;i<o;i++)n[i-4]=arguments[i];let[r=(0,u.g0)()]=n;const d=await(0,b.px)("searchGifs",{query:t,offset:a,username:s});d&&(e=(0,w.mS)(),e=(0,A.Mel)(e,!a,d.gifs,d.nextOffset,r),(0,w.UF)(e))}(0,w.aJ)("loadStickerSets",async(e,t)=>{const[s,a]=await Promise.all([(0,b.px)("fetchStickerSets",{hash:e.stickers.added.hash}),(0,b.px)("fetchCustomEmojiSets",{hash:e.customEmojis.added.hash})]);a&&s&&(e=(0,w.mS)(),e=(0,A.MkE)(e,"added",s.hash,s.sets),e=(0,A.E24)(e,a.hash,a.sets),(0,w.UF)(e),t.loadCustomEmojis({ids:e.recentCustomEmojis}))}),(0,w.aJ)("loadAddedStickers",async(e,t)=>{const{added:{setIds:s=[]},setsById:a}=e.stickers,{added:{setIds:o=[]}}=e.customEmojis,n=[...s,...o];if(n.length)for(let e=0;e<n.length;e++){const s=n[e];a[s]?.stickers||(t.loadStickers({stickerSetInfo:{id:s,accessHash:a[s].accessHash}}),e%10==0&&e>0&&await(0,I.v7)(200))}}),(0,w.aJ)("loadRecentStickers",e=>{const{hash:t}=e.stickers.recent||{};ve(e,t)}),(0,w.aJ)("loadFavoriteStickers",async e=>{const{hash:t}=e.stickers.favorite||{},s=await(0,b.px)("fetchFavoriteStickers",{hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:s}},(0,w.UF)(e))}),(0,w.aJ)("loadPremiumStickers",async e=>{const{hash:t}=e.stickers.premium||{};if((0,C.trm)(e))return;const s=await(0,b.px)("fetchStickersForEmoji",{emoji:"⭐️⭐️",hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,premium:{hash:s.hash,stickers:s.stickers}}},(0,w.UF)(e))}),(0,w.aJ)("loadGreetingStickers",async e=>{const{hash:t}=e.stickers.greeting||{};if((0,C.trm)(e))return;const s=await(0,b.px)("fetchStickersForEmoji",{emoji:"👋⭐️",hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,greeting:{hash:s.hash,stickers:s.stickers.filter(e=>"👋"===e.emoji)}}},(0,w.UF)(e))}),(0,w.aJ)("loadFeaturedStickers",async e=>{const{hash:t}=e.stickers.featured||{},s=await(0,b.px)("fetchFeaturedStickers",{hash:t});s&&(e=(0,w.mS)(),e=(0,A.MkE)(e,"featured",s.hash,s.sets),(0,w.UF)(e))}),(0,w.aJ)("loadPremiumGifts",async e=>{const t=await(0,b.px)("fetchPremiumGifts");if(!t)return;const{set:s,stickers:a}=t;e=(0,w.mS)(),e={...e,premiumGifts:{...s,stickers:a}},(0,w.UF)(e)}),(0,w.aJ)("loadTonGifts",async e=>{const t=await(0,b.px)("fetchTonGifts");if(!t)return;const{set:s,stickers:a}=t;e=(0,w.mS)(),e={...e,tonGifts:{...s,stickers:a}},(0,w.UF)(e)}),(0,w.aJ)("loadDefaultTopicIcons",async e=>{const t=await(0,b.px)("fetchDefaultTopicIcons");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t,o={...s,stickers:a};e=(0,A.v9P)(e,o.id,o),e={...e,defaultTopicIconsId:o.id},(0,w.UF)(e)}),(0,w.aJ)("loadDefaultStatusIcons",async e=>{const t=await(0,b.px)("fetchDefaultStatusEmojis");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t,o={...s,stickers:a};e=(0,A.v9P)(e,o.id,o),e={...e,defaultStatusIconsId:o.id},(0,w.UF)(e)}),(0,w.aJ)("loadUserCollectibleStatuses",async(e,t)=>{(0,w.UF)(e);const{hash:s}=e.collectibleEmojiStatuses||{},a=await(0,b.px)("fetchCollectibleEmojiStatuses",{hash:s});if(!a)return;e=(0,w.mS)(),e={...e,collectibleEmojiStatuses:{hash:a.hash,statuses:a.statuses}},(0,w.UF)(e);const o=a.statuses.map(e=>{let{documentId:t}=e;return t});t.loadCustomEmojis({ids:o})}),(0,w.aJ)("loadStickers",(e,t,s)=>{const{stickerSetInfo:a}=s,o=(0,C.ycM)(e,a);o&&o.count===o?.stickers?.length||be(e,t,a)}),(0,w.aJ)("loadAnimatedEmojis",async e=>{const[t,s]=await Promise.all([(0,b.px)("fetchAnimatedEmojis"),(0,b.px)("fetchAnimatedEmojiEffects")]);t&&s&&(e=(0,w.mS)(),e=(0,A.$nQ)(e,{...t.set,stickers:t.stickers}),e={...e,animatedEmojiEffects:{...s.set,stickers:s.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadBirthdayNumbersStickers",async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:a.OVC}});t&&(e=(0,w.mS)(),e={...e,birthdayNumbers:{...t.set,stickers:t.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadRestrictedEmojiStickers",async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:a.Kh8}});t&&(e=(0,w.mS)(),e={...e,restrictedEmoji:{...t.set,stickers:t.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadGenericEmojiEffects",async e=>{const t=await(0,b.px)("fetchGenericEmojiEffects");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t;e={...e,genericEmojiEffects:{...s,stickers:a}},(0,w.UF)(e)}),(0,w.aJ)("loadSavedGifs",async e=>{const{hash:t}=e.gifs.saved,s=await(0,b.px)("fetchSavedGifs",{hash:t});s&&(e=(0,w.mS)(),e={...e,gifs:{...e.gifs,saved:s}},(0,w.UF)(e))}),(0,w.aJ)("saveGif",async(e,t,s)=>{const{gif:a,shouldUnsave:o,tabId:n=(0,u.g0)()}=s,i=e.gifs.saved.gifs?.length,r=(0,fe.d)(e,"savedGifs"),d=(0,fe.B)(e,"savedGifs"),c=(0,C.g29)(e);if(!o&&i&&i>=r&&t.showNotification({title:f.yE("LimitReachedFavoriteGifs",r.toString()),message:c?f.yE("LimitReachedFavoriteGifsSubtitlePremium"):f.yE("LimitReachedFavoriteGifsSubtitle",d.toString()),...!c&&{action:{action:"openPremiumModal",payload:{tabId:n}}},className:"bold-link",tabId:n}),!await(0,b.px)("saveGif",{gif:a,shouldUnsave:o}))return;e=(0,w.mS)();const l=e.gifs.saved.gifs?.filter(e=>{let{id:t}=e;return t!==a.id})||[],h=o?l:[a,...l];e={...e,gifs:{...e.gifs,saved:{...e.gifs.saved,gifs:h}}},(0,w.UF)(e)}),(0,w.aJ)("faveSticker",(e,t,s)=>{const{sticker:a,tabId:o=(0,u.g0)()}=s,n=e.stickers.favorite.stickers.length,i=(0,fe.d)(e,"stickersFaved"),r=(0,fe.B)(e,"stickersFaved"),d=(0,C.g29)(e);n>=i&&t.showNotification({title:f.yE("LimitReachedFavoriteStickers",i.toString()),message:d?f.yE("LimitReachedFavoriteStickersSubtitlePremium"):f.yE("LimitReachedFavoriteStickersSubtitle",r.toString()),...!d&&{action:{action:"openPremiumModal",payload:{tabId:o}}},className:"bold-link",tabId:o}),a&&(0,b.px)("faveSticker",{sticker:a})}),(0,w.aJ)("unfaveSticker",(e,t,s)=>{const{sticker:a}=s;a&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:{...e.stickers.favorite,stickers:e.stickers.favorite.stickers.filter(e=>{let{id:t}=e;return t!==a.id})}}},(0,w.UF)(e),(0,b.px)("faveSticker",{sticker:a,unfave:!0}))}),(0,w.aJ)("removeRecentSticker",async(e,t,s)=>{const{sticker:a}=s;await(0,b.px)("removeRecentSticker",{sticker:a})&&ve((0,w.mS)())}),(0,w.aJ)("clearRecentStickers",async e=>{await(0,b.px)("clearRecentStickers")&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:{stickers:[]}}},(0,w.UF)(e))}),(0,w.aJ)("toggleStickerSet",(e,t,s)=>{const{stickerSetId:a}=s,o=(0,C.ycM)(e,a);if(!o)return;const{accessHash:n,installedDate:i,isArchived:r}=o,d=!r&&Boolean(i);(0,b.px)(d?"uninstallStickerSet":"installStickerSet",{stickerSetId:a,accessHash:n})}),(0,w.aJ)("loadEmojiKeywords",async(e,t,s)=>{const{language:a}=s;let o=e.emojiKeywords[a];if(o?.isLoading)return;e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{...o,isLoading:!0}}},(0,w.UF)(e);const n=await(0,b.px)("fetchEmojiKeywords",{language:a,fromVersion:o?o.version:0});if(o=(e=(0,w.mS)()).emojiKeywords[a],!n)return e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{...o,isLoading:!1}}},void(0,w.UF)(e);e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{isLoading:!1,version:n.version,keywords:{...o?.keywords,...n.keywords}}}},(0,w.UF)(e)}),(0,w.aJ)("setStickerSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;a&&Ie(async()=>{const t=await(0,b.px)("searchStickers",{query:a});if(!t)return;e=(0,w.mS)();const{setsById:s,added:n}=e.stickers,i=t.sets.map(e=>{let{id:t}=e;return t});n.setIds&&n.setIds.forEach(e=>{if(!i.includes(e)){const{title:t}=s[e]||{};t&&(0,ge.A)(t,a)&&i.unshift(e)}}),e=(0,A.MkE)(e,"search",t.hash,t.sets),e=(0,A.bG)(e,t.hash,i,o),(0,w.UF)(e)})}),(0,w.aJ)("setGifSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;"string"==typeof a&&Ie(()=>{ye(e=(0,w.mS)(),a,e.config?.gifSearchUsername,void 0,o)})}),(0,w.aJ)("searchMoreGifs",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{query:o,offset:n}=(0,C.nTw)(e,a).gifSearch;"string"==typeof o&&Ie(()=>{ye(e=(0,w.mS)(),o,e.config?.gifSearchUsername,n,a)})}),(0,w.aJ)("loadStickersForEmoji",(e,t,s)=>{const{emoji:a}=s,{hash:o}=e.stickers.forEmoji;Ie(async()=>{e=(0,w.mS)(),e={...e,stickers:{...e.stickers,forEmoji:{...e.stickers.forEmoji,emoji:a}}},(0,w.UF)(e);const t=await(0,b.px)("fetchStickersForEmoji",{emoji:a,hash:o});e=(0,w.mS)(),t&&e.stickers.forEmoji.emoji===a&&(e=(0,A.f_N)(e,a,t.stickers,t.hash),(0,w.UF)(e))})}),(0,w.aJ)("clearStickersForEmoji",e=>({...e,stickers:{...e.stickers,forEmoji:{}}})),(0,w.aJ)("loadCustomEmojiForEmoji",(e,t,s)=>{const{emoji:a}=s;return(0,A.G4z)(e,a)}),(0,w.aJ)("clearCustomEmojiForEmoji",e=>({...e,customEmojis:{...e.customEmojis,forEmoji:{}}})),(0,w.aJ)("loadFeaturedEmojiStickers",async e=>{const t=await(0,b.px)("fetchFeaturedEmojiStickers");t&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,featuredIds:t.sets.map(e=>{let{id:t}=e;return t}),byId:{...e.customEmojis.byId,...(0,h.dU)(t.sets.flatMap(e=>e.stickers||[]),"id")}},stickers:{...e.stickers,setsById:{...e.stickers.setsById,...(0,h.dU)(t.sets,"id")}}},(0,w.UF)(e))}),(0,w.aJ)("openStickerSet",async(e,t,s)=>{const{stickerSetInfo:a,shouldIgnoreCache:o,tabId:n=(0,u.g0)()}=s;!o&&(0,C.ycM)(e,a)||await be(e,t,a),e=(0,w.mS)();const i=(0,C.ycM)(e,a);i?.shortName&&(e=(0,M.w)(e,{openedStickerSetShortName:i.shortName},n),(0,w.UF)(e))}),(0,w.aJ)("loadRecentEmojiStatuses",async e=>{const t=await(0,b.px)("fetchRecentEmojiStatuses");t&&(e=(0,w.mS)(),e=(0,A.T3R)(e,t.hash,t.emojiStatuses),(0,w.UF)(e))});var Se=s(17663),we=s(62214);const Ae=(0,I.nF)(e=>e(),500,!1);async function Me(e,t,s){if(!(0,we.YE)(t)&&!(0,we.WX)(t))return;const a=(0,C.O5q)(e,t.id,s);if(a)return a;const o=await(0,b.px)("fetchMessage",{chat:t,messageId:s});return"MESSAGE_DELETED"===o?void 0:o?.message}(0,w.aJ)("setGlobalSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,{chatId:n}=(0,C.nTw)(e,o).globalSearch;a&&!n&&Ae(async()=>{const[t,s]=await Promise.all([(0,b.px)("searchChats",{query:a}),(0,b.px)("fetchSponsoredPeer",{query:a})]);e=(0,w.mS)();const n=(0,C.xT4)(e,o);if(!t||!n||a!==n)return e=(0,A.RgT)(e,{chats:!1},o),void(0,w.UF)(e);const{accountResultIds:i,globalResultIds:r}=t;e=(0,A.RgT)(e,{chats:!1},o),e=(0,A.b8O)(e,{localResults:{peerIds:i},globalResults:{...(0,C.nTw)(e,o).globalSearch.globalResults,peerIds:r},sponsoredPeer:s},o),(0,w.UF)(e)})}),(0,w.aJ)("setGlobalSearchDate",(e,t,s)=>{const{date:a,tabId:o=(0,u.g0)()}=s,n=a?(0,Se.TI)(a):a;e=(0,A.b8O)(e,{minDate:a,maxDate:n,query:"",resultsByType:{...(0,C.nTw)(e,o).globalSearch.resultsByType,text:{totalCount:void 0,foundIds:[],nextOffsetId:0}}},o),(0,w.UF)(e),t.searchMessagesGlobal({type:"text",tabId:o})}),(0,w.aJ)("searchMessagesGlobal",(e,t,s)=>{const{type:o,context:n,shouldResetResultsByType:i,shouldCheckFetchingMessagesStatus:r,tabId:d=(0,u.g0)()}=s;r&&(e=(0,A.RgT)(e,{messages:!0},d),(0,w.UF)(e),e=(0,w.mS)());const{query:c,resultsByType:h,chatId:m}=(0,C.nTw)(e,d).globalSearch,{totalCount:f,foundIds:I,nextOffsetId:v,nextOffsetPeerId:y,nextOffsetRate:M}=!i&&h?.[o]||{};if(void 0!==f&&(!f||I&&I.length>=f))return;const P=m?(0,C.PVB)(e,m):void 0;!async function(e,t){const{query:s="",type:o,context:n,offsetRate:i,offsetId:r,offsetPeer:d,peer:c,maxDate:h,minDate:m,shouldResetResultsByType:f,tabId:I=(0,u.g0)()}=t;let v,y;"publicPosts"===o&&(e=(0,A.RgT)(e,{publicPosts:!0},I),(0,w.UF)(e));const M=(0,C.nTw)(e,I).globalSearch.searchFlood;if(c){const e=(0,b.px)("searchMessagesInChat",{peer:c,query:s,type:o,limit:a.wAs,offsetId:r,minDate:m,maxDate:h}),t=(0,S.vj)(c)&&c.isForum?(0,b.px)("fetchTopics",{chat:c,query:s,limit:a.mH$}):void 0,[n,i]=await Promise.all([e,t]);if(n){const{messages:e,totalCount:t,nextOffsetId:s}=n,{topics:a,count:o}=i||{};v={topics:a,totalTopicsCount:o,messages:e,totalCount:t,nextOffsetId:s}}}else if(v=await(0,b.px)("searchMessagesGlobal",{query:s,offsetRate:i,offsetId:r,offsetPeer:d,limit:a.wAs,type:o,context:n,maxDate:h,minDate:m}),(0,l.zq)(s)){const t=(0,l.vG)(s);"publicMessageLink"===t?.type?y=await async function(e,t){const{username:s,messageId:a}=t,o=(0,C.qn$)(e,s);if(o)return Me(e,o,a);const{chat:n}=await(0,b.px)("getChatByUsername",s)??{};return n?Me(e,n,a):void 0}(e,t):"privateMessageLink"===t?.type&&(y=await function(e,t){const{channelId:s,messageId:a}=t,o=(0,k.QE)(s),n=(0,C.hds)(e,o);if(n)return Me(e,n,a)}(e,t))}e=(0,w.mS)(),f&&(e=(0,A.b8O)(e,{resultsByType:{...((0,C.nTw)(e,I).globalSearch||{}).resultsByType,[o]:void 0}},I));const P=(0,C.xT4)(e,I);if(!v||""!==s&&s!==P)return e=(0,A.RgT)(e,{messages:!1,publicPosts:!1},I),void(0,w.UF)(e);y&&(v.totalCount=v.messages.unshift(y));const{messages:F,userStatusesById:T,totalCount:x,nextOffsetRate:U,nextOffsetId:B,nextOffsetPeerId:R}=v,N=v.searchFlood||M;T&&(e=(0,A.d2X)(e,T)),F.length&&(e=(0,A.KcS)(e,F)),e=(0,A.HyB)(e,F,x,o,U,B,R,N,I),v.topics&&(e=(0,A.mIA)(e,c.id,v.totalTopicsCount,v.topics));const J=v.topics?.map(e=>{let{id:t}=e;return t}).sort((e,t)=>t-e);if(e=(0,A.b8O)(e,{foundTopicIds:J},I),(0,w.UF)(e),"publicPosts"===o&&N&&!N.queryIsFree&&!r&&0===M?.remains){const e=(0,p.Yw)();(0,w.ko)().showNotification({icon:"star",message:{key:"NotificationPaidExtraSearch",variables:{stars:(0,g.Kk)(e,N.starsAmount)}}})}}(e,{query:c,type:o,context:n,shouldResetResultsByType:i,offsetRate:M,offsetId:v,offsetPeer:y?(0,C.PVB)(e,y):void 0,peer:P,tabId:d})}),(0,w.aJ)("searchPopularBotApps",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).globalSearch.popularBotApps,n=o?.nextOffset;if(o?.peerIds&&!n)return;e=(0,A.RgT)(e,{botApps:!0},a),(0,w.UF)(e);const i=await(0,b.px)("fetchPopularAppBots",{offset:n});if(e=(0,w.mS)(),!i)return e=(0,A.RgT)(e,{botApps:!1},a),void(0,w.UF)(e);e=(0,A.b8O)(e,{popularBotApps:{peerIds:[...o?.peerIds||[],...i.peerIds],nextOffset:i.nextOffset}},a),e=(0,A.RgT)(e,{botApps:!1},a),(0,w.UF)(e)}),(0,w.aJ)("checkSearchPostsFlood",async(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("checkSearchPostsFlood",a);e=(0,w.mS)(),n&&(e=(0,A.b8O)(e,{searchFlood:n},o),(0,w.UF)(e))});var Ce=s(57309);async function Pe(e,t,s,o,n){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6?arguments[6]:void 0;for(var d=arguments.length,c=new Array(d>7?d-7:0),l=7;l<d;l++)c[l-7]=arguments[l];let[m=(0,u.g0)()]=c;const p=r?e.currentUserId:t.id,g=await(0,b.px)("searchMessagesInChat",{peer:t,type:o,limit:2*a.Um,threadId:s,offsetId:n,isSavedDialog:r});if(!g)return;const{userStatusesById:f,messages:I,totalCount:v,nextOffsetId:y}=g,S=(0,h.dU)(I,"id"),M=Object.keys(S).map(Number);e=(0,w.mS)(),(0,C.BU_)(e,m)&&(e=(0,A.d2X)(e,f),e=(0,A.o4A)(e,p,S),e=(0,A.jU1)(e,p,s,o,M,v,y,m),(0,w.UF)(e),i||Pe(e,t,s,o,y,!0,r,m))}(0,w.aJ)("performMiddleSearch",async(e,t,s)=>{const{query:o,chatId:i,threadId:r=n.l3,tabId:d=(0,u.g0)()}=s||{};if(!i)return;const c=e.currentUserId,l=(0,y.cG)(i,r,c),h=l?String(r):i,m=h?(0,C.PVB)(e,h):void 0;let p=(0,C.TCk)(e,d);if(!m)return;p||(e=(0,A.$RI)(e,h,r,{},d),(0,w.UF)(e),e=(0,w.mS)()),p=(0,C.TCk)(e,d);const{results:g,savedTag:f,type:I,isHashtag:v}=p,S=g?.query===o,M=S?g?.nextOffsetId:void 0,P=S?g?.nextOffsetRate:void 0,k=S?g?.nextOffsetPeerId:void 0,F=S&&k?(0,C.hds)(e,k):void 0;if((v||!f)&&!o)return e=(0,A.$RI)(e,h,r,{fetchingQuery:void 0},d),void(0,w.UF)(e);let T;if(e=(0,A.$RI)(e,h,r,{fetchingQuery:o},d),(0,w.UF)(e),"chat"===I&&(T=await(0,b.px)("searchMessagesInChat",{peer:m,type:"text",query:v?`#${o}`:o,threadId:r,limit:a.gXr,offsetId:M,isSavedDialog:l,savedTag:f})),"myChats"===I&&(T=await(0,b.px)("searchMessagesGlobal",{type:"text",query:v?`#${o}`:o,limit:a.gXr,offsetId:M,offsetRate:P,offsetPeer:F})),"channels"===I&&(T=await(0,b.px)("searchPublicPosts",{hashtag:o,limit:a.gXr,offsetId:M,offsetPeer:F,offsetRate:P})),!T)return;const{userStatusesById:x,messages:U,totalCount:B,nextOffsetId:R,nextOffsetRate:N,nextOffsetPeerId:J}=T,E=U.map(Ce.D);e=(0,w.mS)(),p=(0,C.TCk)(e,d);const L=p?.savedTag&&!(0,y.a0)(f,p.savedTag);if(!p||p?.fetchingQuery!==o||L)return;const Y=l?c:m.id;e=(0,A.d2X)(e,x),e=(0,A.KcS)(e,U),e=(0,A.$RI)(e,Y,r,{fetchingQuery:void 0},d),e=(0,A.VmW)(e,Y,r,{foundIds:E,totalCount:B,nextOffsetId:R,nextOffsetRate:N,nextOffsetPeerId:J,query:o||""},d),(0,w.UF)(e)}),(0,w.aJ)("searchHashtag",(e,t,s)=>{const{hashtag:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Xf0)(e,o);if(!n)return;const i=a.replace(/^#/,"");t.updateMiddleSearch({chatId:n.chatId,threadId:n.threadId,update:{isHashtag:!0,requestedQuery:i},tabId:o})}),(0,w.aJ)("searchSharedMediaMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(!o||!n)return;const i=(0,y.cG)(o,n,e.currentUserId),r=i?String(n):o,d=(0,C.PVB)(e,r),c=(0,C.BU_)(e,a);if(!d||!c)return;const{currentType:l,resultsByType:h}=c,m=l&&h&&h[l],p=m?.nextOffsetId;l&&Pe(e,d,n,l,p,void 0,i,a)}),(0,w.aJ)("searchChatMediaMessages",(e,t,s)=>{const{chatId:o,threadId:n,currentMediaMessageId:r,limit:d,direction:c,tabId:l=(0,u.g0)()}=s;if(!o||!n||!r)return;const m=(0,y.cG)(o,n,e.currentUserId),p=m?String(n):o,g=(0,C.hds)(e,p);if(!g)return;let f=(0,C.CuV)(e,l);if(!f){if(e=(0,A.tXQ)(e,o,n,l),(0,w.UF)(e),f=(0,C.CuV)(e,l),!f)return;e=(0,w.mS)()}!async function(e,t,s,o,n,r,d){let c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:a.laV;for(var l=arguments.length,m=new Array(l>8?l-8:0),p=8;p<l;p++)m[p-8]=arguments[p];let[g=(0,u.g0)()]=m;const{isSynced:f}=e;if(!f||n.isLoading)return;let I=function(e,t){if((0,h.OX)(t,e.currentSegment.foundIds))return e.currentSegment;const s=e.segments.findIndex(e=>(0,h.OX)(t,e.foundIds));if(-1===s)return void(e.currentSegment&&e.currentSegment.foundIds.length&&e.segments.push(e.currentSegment));const a=e.segments.splice(s,1)[0];return e.segments.push(e.currentSegment),a}(n,o);if(void 0===r&&(r=function(e,t){if(!t)return i.TN.Around;const s=t.foundIds.length,a=t.foundIds.indexOf(e);if(-1===a)return i.TN.Around;if(t.loadingState.areAllItemsLoadedBackwards&&t.loadingState.areAllItemsLoadedForwards)return;const o=9>Math.floor(s/2)?0:9,n=s-1;if(a<=o){if(t.loadingState.areAllItemsLoadedBackwards)return;return i.TN.Backwards}if(a>=n-o){if(t.loadingState.areAllItemsLoadedForwards)return;return i.TN.Forwards}}(o,I)),void 0===r)return;const v=function(e,t,s){return s?e===i.TN.Backwards?s.foundIds[0]:e===i.TN.Forwards?s.foundIds[s.foundIds.length-1]:t:t}(r,o,I),S=function(e,t){return e===i.TN.Backwards?0:e===i.TN.Forwards?-(t+1):-(Math.round(t/2)+1)}(r,c),M=d?e.currentUserId:t.id;e=(0,A.lwK)(e,M,s,!0,g),(0,w.UF)(e);const C=await(0,b.px)("searchMessagesInChat",{peer:t,type:"media",limit:c,threadId:s,offsetId:v,isSavedDialog:d,addOffset:S});if(e=(0,w.mS)(),!C)return e=(0,A.lwK)(e,M,s,!1,g),void(0,w.UF)(e);const{messages:P,userStatusesById:k}=C,F=(0,h.dU)(P,"id"),T=Object.keys(F).map(Number);e=(0,A.d2X)(e,k),e=(0,A.o4A)(e,M,F);const x=function(e,t,s,a){let o=Boolean(a?.loadingState.areAllItemsLoadedForwards),n=Boolean(a?.loadingState.areAllItemsLoadedBackwards);return s<t&&(e===i.TN.Forwards?o=!0:e===i.TN.Backwards&&(n=!0)),{areAllItemsLoadedForwards:o,areAllItemsLoadedBackwards:n}}(r,c,T.length,I),U=(0,y.Wm)(F,T,!1);I=(0,A.olz)(U,x,I),e=(0,A.Qb2)(e,M,s,I,n,g),e=(0,A.lwK)(e,M,s,!1,g),(0,w.UF)(e)}(e,g,n,r,f,c,m,d,l)}),(0,w.aJ)("searchMessagesByDate",async(e,t,s)=>{const{timestamp:a,tabId:o=(0,u.g0)()}=s,{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.hds)(e,n);if(!i)return;const r=await(0,b.px)("findFirstMessageIdAfterDate",{chat:i,timestamp:a});r&&t.focusMessage({chatId:i.id,messageId:r,tabId:o})}),(0,w.aJ)("checkPublicLink",async(e,t,s)=>{const{username:a,tabId:o=(0,u.g0)()}=s,{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;if((0,C.nTw)(e,o).management.progress===i.TD.InProgress)return;e=(0,A.H6X)(e,n,{isUsernameAvailable:void 0,checkedUsername:void 0},o),(0,w.UF)(e);const{result:r,error:d}=await(0,b.px)("checkChatUsername",{username:a});e=(0,w.mS)(),e=(0,A.G42)(e,!0===r?i.TD.Complete:i.TD.Error,o),e=(0,A.H6X)(e,n,{isUsernameAvailable:!0===r,checkedUsername:a,error:d},o),(0,w.UF)(e),void 0===r&&t.openLimitReachedModal({limit:"channelsPublic",tabId:o})}),(0,w.aJ)("updatePublicLink",async(e,t,s)=>{const{username:a,shouldDisableUsernames:n,tabId:r=(0,u.g0)()}=s,{chatId:d}=(0,C.Xf0)(e,r)||{};if(!d)return;const c=await(0,o.Jm)(e,t,d,r);if(!c)return;e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.InProgress,r),(0,w.UF)(e);const l=await(0,b.px)("setChatUsername",{chat:c,username:a});n&&await(0,b.px)("deactivateAllUsernames",{chat:c}),e=(0,w.mS)(),e=(0,A.G42)(e,l?i.TD.Complete:i.TD.Error,r),e=(0,A.H6X)(e,c.id,{isUsernameAvailable:void 0,checkedUsername:void 0,error:void 0},r),(0,w.UF)(e)}),(0,w.aJ)("updatePrivateLink",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{},n=o&&(0,C.hds)(e,o);o&&n&&(0,b.px)("updatePrivateLink",{chat:n})}),(0,w.aJ)("setEditingExportedInvite",(e,t,s)=>{const{chatId:a,invite:o,tabId:n=(0,u.g0)()}=s;e=(0,A.H6X)(e,a,{editingInvite:o},n),(0,w.UF)(e)}),(0,w.aJ)("setOpenedInviteInfo",(e,t,s)=>{const{chatId:a,invite:o,tabId:n=(0,u.g0)()}=s,i=o?{inviteInfo:{invite:o}}:{inviteInfo:void 0};e=(0,A.H6X)(e,a,i,n),(0,w.UF)(e)}),(0,w.aJ)("loadExportedChatInvites",async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a,adminId:o,isRevoked:n,limit:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a),c=(0,C.mBe)(e,o||e.currentUserId);if(!d||!c)return;const l=await(0,b.px)("fetchExportedChatInvites",{peer:d,admin:c,isRevoked:n,limit:i});if(!l)return;e=(0,w.mS)();const{invites:h}=l,m=n?{revokedInvites:h}:{invites:h};e=(0,A.H6X)(e,a,m,r),(0,w.UF)(e)}),(0,w.aJ)("editExportedChatInvite",async(e,t,s)=>{const{chatId:a,link:o,isRevoked:n,expireDate:i,usageLimit:r,isRequestNeeded:d,title:c,tabId:l=(0,u.g0)()}=s,h=(0,C.hds)(e,a);if(!h)return;const m=await(0,b.px)("editExportedChatInvite",{peer:h,link:o,isRevoked:n,expireDate:i,usageLimit:r,isRequestNeeded:d,title:c});if(!m)return;const{oldInvite:p,newInvite:g}=m;e=(0,w.mS)();const{management:f}=(0,C.nTw)(e,l),I=(f.byChatId[a].invites||[]).filter(e=>e.link!==p.link),v=[...f.byChatId[a].revokedInvites||[]];g.isRevoked?v.unshift(g):I.push(g),e=(0,A.H6X)(e,a,{invites:I,revokedInvites:v},l),(0,w.UF)(e)}),(0,w.aJ)("exportChatInvite",async(e,t,s)=>{const{chatId:a,expireDate:o,usageLimit:n,isRequestNeeded:i,title:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a);if(!c)return;const l=await(0,b.px)("exportChatInvite",{peer:c,expireDate:o,usageLimit:n,isRequestNeeded:i,title:r});if(!l)return;e=(0,w.mS)();const h=(0,C.nTw)(e,d).management.byChatId[a].invites||[];e=(0,A.H6X)(e,a,{invites:[...h,l]},d),(0,w.UF)(e)}),(0,w.aJ)("deleteExportedChatInvite",async(e,t,s)=>{const{chatId:a,link:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;if(!await(0,b.px)("deleteExportedChatInvite",{peer:i,link:o}))return;e=(0,w.mS)();const r=(0,C.nTw)(e,n).management.byChatId[a];e=(0,A.H6X)(e,a,{invites:r?.invites?.filter(e=>e.link!==o),revokedInvites:r?.revokedInvites?.filter(e=>e.link!==o)},n),(0,w.UF)(e)}),(0,w.aJ)("deleteRevokedExportedChatInvites",async(e,t,s)=>{const{chatId:a,adminId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.mBe)(e,o||e.currentUserId);i&&r&&await(0,b.px)("deleteRevokedExportedChatInvites",{peer:i,admin:r})&&(e=(0,w.mS)(),e=(0,A.H6X)(e,a,{revokedInvites:[]},n),(0,w.UF)(e))}),(0,w.aJ)("loadChatInviteImporters",async(e,t,s)=>{const{chatId:a,link:o,offsetDate:n,offsetUserId:i,limit:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a),l=i?(0,C.mBe)(e,i):void 0;if(!c||i&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:n,offsetUser:l,limit:r});if(!h)return;const{importers:m}=h;e=(0,w.mS)();const p=(0,C.nTw)(e,d).management.byChatId[a]?.inviteInfo;p?.invite&&p.invite.link===o&&(e=(0,A.H6X)(e,a,{inviteInfo:{...p,importers:m}},d),(0,w.UF)(e))}),(0,w.aJ)("loadChatInviteRequesters",async(e,t,s)=>{const{chatId:a,link:o,offsetDate:n,offsetUserId:i,limit:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a),l=i?(0,C.mBe)(e,i):void 0;if(!c||i&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:n,offsetUser:l,limit:r,isRequested:!0});if(!h)return;const{importers:m}=h;e=(0,w.mS)();const p=(0,C.nTw)(e,d).management.byChatId[a]?.inviteInfo;p?.invite&&p.invite.link===o&&(e=(0,A.H6X)(e,a,{inviteInfo:{...p,requesters:m}},d),(0,w.UF)(e))}),(0,w.aJ)("loadChatJoinRequests",async(e,t,s)=>{const{chatId:a,offsetDate:o=0,offsetUserId:n,limit:i=0}=s,r=(0,C.hds)(e,a),d=n?(0,C.mBe)(e,n):void 0;if(!r||n&&!d)return;const c=await(0,b.px)("fetchChatInviteImporters",{peer:r,offsetDate:o,offsetUser:d,limit:i,isRequested:!0});if(!c)return;const{importers:l}=c;e=(0,w.mS)(),e=(0,A.wix)(e,a,{joinRequests:l}),(0,w.UF)(e)}),(0,w.aJ)("hideChatJoinRequest",async(e,t,s)=>{const{chatId:a,userId:o,isApproved:n}=s,i=(0,C.hds)(e,a),r=(0,C.mBe)(e,o);if(!i||!r)return;if(!await(0,b.px)("hideChatJoinRequest",{peer:i,user:r,isApproved:n}))return;e=(0,w.mS)();const d=(0,C.hds)(e,a);d&&(e=(0,A.wix)(e,a,{joinRequests:d.joinRequests?.filter(e=>e.userId!==o)}),(0,w.UF)(e))}),(0,w.aJ)("hideAllChatJoinRequests",async(e,t,s)=>{const{chatId:a,isApproved:o,link:n}=s,i=(0,C.hds)(e,a);i&&await(0,b.px)("hideAllChatJoinRequests",{peer:i,isApproved:o,link:n})&&(e=(0,w.mS)(),(0,C.hds)(e,a)&&(e=(0,A.wix)(e,a,{joinRequests:[]}),e=(0,A.ltr)(e,a,{recentRequesterIds:[],requestsPending:0}),(0,w.UF)(e)))}),(0,w.aJ)("hidePeerSettingsBar",async(e,t,s)=>{const{peerId:a}=s,o=(0,C.mBe)(e,a);o&&await(0,b.px)("hidePeerSettingsBar",o)&&(e=(0,w.mS)(),e=(0,A.weB)(e,a,{settings:void 0}),(0,w.UF)(e))}),(0,w.aJ)("uploadContactProfilePhoto",async(e,t,s)=>{const{userId:a,file:o,isSuggest:n,tabId:r=(0,u.g0)()}=s,d=(0,C.mBe)(e,a);if(!d)return;if(e=(0,A.G42)(e,i.TD.InProgress,r),(0,w.UF)(e),!await(0,b.px)("uploadContactProfilePhoto",{user:d,file:o,isSuggest:n}))return e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Error,r),void(0,w.UF)(e);e=(0,w.mS)(),(0,w.UF)(e);const{id:c,accessHash:l}=d;if(!await(0,b.px)("fetchFullUser",{id:c,accessHash:l}))return e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Error,r),void(0,w.UF)(e);t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0}),e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Complete,r),(0,w.UF)(e),o&&!n&&t.showNotification({message:f.yE("UserInfo.SetCustomPhoto.SuccessPhotoText",(0,y.u0)(d)),tabId:r})}),(0,w.aJ)("resetManagementError",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s||{};return(0,A.H6X)(e,a,{error:void 0},o)});var ke=s(37932),Fe=s(49763);let Te,xe;function Ue(e,t,s){const o=e.currentUserId,n=(0,y.cG)(t,s,o),i=n?String(s):t,r=(0,C.hds)(e,i);return(0,b.px)("fetchMessages",{chat:r,threadId:s,offsetId:n?void 0:r.lastReadInboxMessageId,addOffset:-(Math.round(a.yo2/2)+1),limit:a.yo2,isSavedDialog:n})}(0,w.aJ)("sync",(e,t)=>{a.Oig&&console.log(">>> START SYNC"),Te&&clearTimeout(Te),e=(0,w.mS)(),e={...e,isSyncing:!0},(0,w.UF)(e),Te=window.setTimeout(()=>{e=(0,w.mS)(),e={...e,isSyncing:!1},(0,w.UF)(e),Te=void 0},15e3);const{loadAllChats:s,preloadTopChatMessages:o}=t;(0,Fe.Ts)(),s({listType:"active",whenFirstBatchDone:async()=>{await async function(e,t){let s=!1;e=(0,w.mS)();let o=!1;const i=Object.keys(e.messages.byChatId).reduce((t,s)=>(t[s]=Object.keys(e.messages.byChatId[s].threadsById).reduce((t,a)=>(t[Number(a)]=(0,h.Oy)({draft:(0,C.GA4)(e,s,Number(a)),editingId:(0,C.Ys6)(e,s,Number(a)),editingDraft:(0,C.U0A)(e,s,Number(a))}),t),{}),t),{}),r=Object.entries(e.chats.lastMessageIds.all||{}).map(t=>{let[s,a]=t;return(0,C.O5q)(e,s,Number(a))}).filter(Boolean),d=Object.values(e.chats.lastMessageIds.saved||{}).map(t=>(0,C.O5q)(e,e.currentUserId,Number(t))).filter(Boolean);for(const{id:i}of Object.values(e.byTabId)){e=(0,w.mS)();const{chatId:r,threadId:d}=(0,C.Xf0)(e,i)||{},c=d||n.l3,l=r&&d?(0,C.Vw0)(e,r,d):void 0,u=r?e.chats.byId[r]:void 0;if(r&&u){const[t,d]=await Promise.all([Ue(e,r,c),c===n.l3||(0,y.cG)(u.id,c,e.currentUserId)?void 0:(0,b.px)("fetchDiscussionMessage",{chat:u,messageId:Number(c)})]);e=(0,w.mS)();const{chatId:m}=(0,C.Xf0)(e,i)||{};if(t&&m===r){const i=(0,C.zeq)(e,r),u=r===a.zv8?e.serviceNotifications.filter(e=>{let{isDeleted:t}=e;return!t}).map(e=>{let{message:t}=e;return t}):[],m=(0,C.pSx)(e,r),p=m?Object.values(m).map(e=>{let{lastMessageId:t}=e;return i[t]}).filter(Boolean):[],g=t.messages.map(e=>{let{id:t}=e;return t}),f=(0,h.Up)(e.messages.byChatId[r].threadsById,g),I=((!t.messages.length||t.messages.some(e=>{let{id:t}=e;return t===d?.firstMessageId}))&&d?.topMessages||[]).concat(t.messages,u),v=I.concat(p),b=(0,h.dU)(v,"id"),y=(0,h.Am)(I.map(e=>{let{id:t}=e;return t}));o||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach(t=>{let{id:s}=t;e=(0,M.w)(e,{tabThreads:{}},s)}),o=!0),e=(0,A.o4A)(e,r,b),e=(0,A.d4w)(e,r,c,y),Object.entries(f).forEach(t=>{let[s,a]=t;a?.threadInfo&&(e=(0,A.eAk)(e,r,s,a.threadInfo))}),l&&!l.isCommentsInfo&&c!==n.l3&&(e=(0,A.eAk)(e,r,c,{...(0,h.Up)(l,["fromChannelId","fromMessageId"])})),Object.values(e.byTabId).forEach(t=>{let{id:s}=t;const{chatId:a,threadId:o}=(0,C.Xf0)(e,s)||{};a===r&&o===c&&(e=(0,A.s3Z)(e,r,c,y,s))}),e=(0,A.h7P)(e,(0,h.dU)(t.chats,"id")),e=(0,A.CKT)(e,(0,h.dU)(t.users,"id")),s=!0}}(0,w.UF)(e),u?.isForum&&(t.loadTopics({chatId:r,force:!0}),d&&d!==n.l3&&t.loadTopicById({chatId:r,topicId:Number(d),shouldCloseChatOnError:!0}))}e=(0,w.mS)(),s||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach(t=>{let{id:s}=t;e=(0,M.w)(e,{tabThreads:{}},s)})),Object.keys(i).forEach(t=>{const s=i[t];Object.keys(s).forEach(s=>{e=(0,A.e49)(e,t,Number(s),i[t][Number(s)])})}),e=(0,A.KcS)(e,r),e=(0,A.KcS)(e,d),(0,w.UF)(e),Object.values(e.byTabId).forEach(s=>{let{id:a}=s;const{chatId:o,messageId:n}=(0,C.nTw)(e,a).audioPlayer;o&&n&&!(0,C.O5q)(e,o,n)&&t.closeAudioPlayer({tabId:a})})}(e,t),e=(0,w.mS)(),e={...e,isSyncing:!1,isSynced:!0,isFetchingDifference:!1},(0,w.UF)(e),a.Oig&&console.log(">>> FINISH SYNC"),s({listType:"archived"}),o()}})}),(0,ke.DW)(e=>{const{connectionState:t,authState:s,isSynced:a}=e,{isMasterTab:o}=(0,C.nTw)(e);!o||a||xe?.connectionState===t&&xe?.authState===s||"connectionStateReady"===t&&"authorizationStateReady"===s&&(0,w.ko)().sync(),xe=e}),(0,w.aJ)("reportPeer",async(e,t,s)=>{const{chatId:a,reason:o,description:n,tabId:i=(0,u.g0)()}=s;if(!a)return;const r=(0,C.hds)(e,a);if(!r)return;const d=await(0,b.px)("reportPeer",{peer:r,reason:o,description:n});t.showNotification({message:d?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:i})}),(0,w.aJ)("reportProfilePhoto",async(e,t,s)=>{const{chatId:a,reason:o,description:n,photo:i,tabId:r=(0,u.g0)()}=s;if(!a)return;const d=(0,C.hds)(e,a);if(!d||!i)return;const c=await(0,b.px)("reportProfilePhoto",{peer:d,photo:i,reason:o,description:n});t.showNotification({message:c?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:r})}),(0,w.aJ)("loadAuthorizations",async e=>{const t=await(0,b.px)("fetchAuthorizations");t&&(e=(0,w.mS)(),e={...e,activeSessions:{byHash:t.authorizations,orderedHashes:Object.keys(t.authorizations),ttlDays:t.ttlDays}},(0,w.UF)(e))}),(0,w.aJ)("terminateAuthorization",async(e,t,s)=>{const{hash:a}=s;if(!await(0,b.px)("terminateAuthorization",a))return;e=(0,w.mS)();const{[a]:o,...n}=e.activeSessions.byHash;e={...e,activeSessions:{byHash:n,orderedHashes:e.activeSessions.orderedHashes.filter(e=>e!==a)}},(0,w.UF)(e)}),(0,w.aJ)("terminateAllAuthorizations",async e=>{if(!await(0,b.px)("terminateAllAuthorizations"))return;const t=(e=(0,w.mS)()).activeSessions.orderedHashes.find(t=>e.activeSessions.byHash[t].isCurrent);if(!t)return;const s=e.activeSessions.byHash[t];e={...e,activeSessions:{byHash:{[t]:s},orderedHashes:[t]}},(0,w.UF)(e)}),(0,w.aJ)("changeSessionSettings",async(e,t,s)=>{const{hash:a,areCallsEnabled:o,areSecretChatsEnabled:n,isConfirmed:i}=s;await(0,b.px)("changeSessionSettings",{hash:a,areCallsEnabled:o,areSecretChatsEnabled:n,isConfirmed:i})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,byHash:{...e.activeSessions.byHash,[a]:{...e.activeSessions.byHash[a],...void 0!==o?{areCallsEnabled:o}:void 0,...void 0!==n?{areSecretChatsEnabled:n}:void 0,...i&&{isUnconfirmed:void 0}}}}},(0,w.UF)(e))}),(0,w.aJ)("changeSessionTtl",async(e,t,s)=>{const{days:a}=s;await(0,b.px)("changeSessionTtl",{days:a})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,ttlDays:a}},(0,w.UF)(e))}),(0,w.aJ)("loadWebAuthorizations",async e=>{const t=await(0,b.px)("fetchWebAuthorizations");if(!t)return;const{webAuthorizations:s}=t;e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:s,orderedHashes:Object.keys(s)}},(0,w.UF)(e)}),(0,w.aJ)("terminateWebAuthorization",async(e,t,s)=>{const{hash:a}=s;if(!await(0,b.px)("terminateWebAuthorization",a))return;e=(0,w.mS)();const{[a]:o,...n}=e.activeWebSessions.byHash;e={...e,activeWebSessions:{byHash:n,orderedHashes:e.activeWebSessions.orderedHashes.filter(e=>e!==a)}},(0,w.UF)(e)}),(0,w.aJ)("terminateAllWebAuthorizations",async e=>{await(0,b.px)("terminateAllWebAuthorizations")&&(e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:{},orderedHashes:[]}},(0,w.UF)(e))}),(0,w.aJ)("loadAccountDaysTtl",async(e,t,s)=>{const a=await(0,b.px)("fetchAccountTTL");a&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:a.days}},(0,w.UF)(e))}),(0,w.aJ)("setAccountTTL",async(e,t,s)=>{const{days:a,tabId:o=(0,u.g0)()}=s||{};a&&await(0,b.px)("setAccountTTL",{days:a})&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:a}},(0,w.UF)(e),t.closeDeleteAccountModal({tabId:o}))});const Be=(0,I.nF)(e=>e(),500,!1);(0,w.aJ)("loadFullUser",async(e,t,s)=>{const{userId:a,withPhotos:o}=s,n=(0,C.mBe)(e,a);if(!n)return;const{id:i,accessHash:r}=n,d=await(0,b.px)("fetchFullUser",{id:i,accessHash:r});if(!d?.user)return;e=(0,w.mS)();const c=(0,C.vGo)(e,a),{user:l,fullInfo:u}=d,m=(0,C.IVq)(e,a),p=n.avatarPhotoId!==l.avatarPhotoId||c?.profilePhoto?.id!==u?.profilePhoto?.id||c?.fallbackPhoto?.id!==u?.fallbackPhoto?.id||c?.personalPhoto?.id!==u?.personalPhoto?.id;e=(0,A.TKu)(e,a,d.user),e=(0,A.weB)(e,a,d.fullInfo),e=(0,A.CKT)(e,(0,h.dU)(d.users,"id")),e=(0,A.h7P)(e,(0,h.dU)(d.chats,"id")),(0,w.UF)(e),(o||m?.count&&p)&&t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0})}),(0,w.aJ)("loadUser",async(e,t,s)=>{const{userId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const n=await(0,b.px)("fetchUsers",{users:[o]});if(!n)return;const{users:i,userStatusesById:r}=n;e=(0,w.mS)(),e=(0,A.CKT)(e,(0,h.dU)(i,"id")),e=(0,A.wWy)(e,{...e.users.statusesById,...r}),(0,w.UF)(e)}),(0,w.aJ)("loadTopUsers",async e=>{const{topPeers:{lastRequestedAt:t}}=e;if(t&&!((0,v.Fm)()-t>60))return;const s=await(0,b.px)("fetchTopUsers");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topPeers:{...e.topPeers,userIds:a,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("loadContactList",async e=>{const t=await(0,b.px)("fetchContactList");if(!t)return;e=(0,w.mS)(),e=(0,A.d2X)(e,t.userStatusesById);const s=e=>e.lastName||e.firstName||"",a=new Intl.Collator("en-US"),o=t.users.sort((e,t)=>a.compare(s(e),s(t))).filter(e=>!e.isSelf);e={...e,contactList:{userIds:o.map(e=>e.id)}},(0,w.UF)(e)}),(0,w.aJ)("loadCurrentUser",()=>{(0,b.px)("fetchCurrentUser")}),(0,w.aJ)("loadCommonChats",async(e,t,s)=>{const{userId:a}=s;if((0,C.trm)(e))return;const o=(0,C.mBe)(e,a),n=(0,C.Ua4)(e,a);if(!o||(0,y.tv)(o)||n?.isFullyLoaded)return;const i=await(0,b.px)("fetchCommonChats",o,n?.maxId);if(!i)return;const{chatIds:r,count:d}=i,c=(0,h.Am)((n?.ids||[]).concat(r));e=(0,w.mS)(),e=(0,A.lWl)(e,o.id,{maxId:r.length?r[r.length-1]:void 0,ids:c,isFullyLoaded:c.length>=d}),(0,w.UF)(e)}),(0,w.aJ)("toggleNoPaidMessagesException",async(e,t,s)=>{const{userId:a,shouldRefundCharged:o}=s,n=(0,C.mBe)(e,a);n&&await(0,b.px)("toggleNoPaidMessagesException",{user:n,shouldRefundCharged:o})&&(e=(0,w.mS)(),e=(0,A.weB)(e,a,{settings:void 0}),(0,w.UF)(e))}),(0,w.aJ)("openChatRefundModal",async(e,t,s)=>{const{userId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.mBe)(e,a);if(!n)return;const i=await(0,b.px)("fetchPaidMessagesRevenue",{user:n});void 0!==i&&(e=(0,w.mS)(),e=(0,M.w)(e,{chatRefundModal:{userId:a,starsToRefund:i}},o),(0,w.UF)(e))}),(0,w.aJ)("updateContact",async(e,t,s)=>{const{userId:a,firstName:o,lastName:n,shouldSharePhoneNumber:r,tabId:d=(0,u.g0)()}=s,c=(0,C.mBe)(e,a);if(!c)return;let l;if(e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.InProgress,d),(0,w.UF)(e),!c.isContact&&c.phoneNumber)l=await(0,b.px)("importContact",{phone:c.phoneNumber,firstName:o,lastName:n});else{const{id:e,accessHash:t}=c;l=await(0,b.px)("updateContact",{id:e,accessHash:t,phoneNumber:"",firstName:o,lastName:n,shouldSharePhoneNumber:r})}l&&(t.loadPeerSettings({peerId:a}),t.loadPeerStories({peerId:a}),e=(0,w.mS)(),e=(0,A.TKu)(e,c.id,{firstName:o,lastName:n}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Complete,d),e=(0,A.BOn)(e,d),(0,w.UF)(e)}),(0,w.aJ)("deleteContact",async(e,t,s)=>{const{userId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const{id:n,accessHash:i}=o;await(0,b.px)("deleteContact",{id:n,accessHash:i})}),(0,w.aJ)("loadMoreProfilePhotos",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,shouldInvalidateCache:o,isPreload:n}=s,i=(0,k.L8)(a),r=i?(0,C.mBe)(e,a):void 0,d=i?void 0:(0,C.hds)(e,a),c=r||d;if(d&&(0,C._ls)(e,a))return;const l=(0,C.IVq)(e,a);if(!c?.avatarPhotoId)return;if(l&&!o&&(n||!l.nextOffset))return;e=(0,A.Tqk)(e,a,!0),(0,w.UF)(e),e=(0,w.mS)();let u=(0,C.vGo)(e,a),h=(0,C.AWZ)(e,a);if(r&&!u){const{id:e,accessHash:t}=r,s=await(0,b.px)("fetchFullUser",{id:e,accessHash:t});if(!s?.user)return;u=s.fullInfo}if(d&&!h){const e=await(0,b.px)("fetchFullChat",d);if(!e?.fullInfo)return;h=e.fullInfo}const m=u||h;if(!m)return;const p=l?.nextOffset,g=!p||n||o?10:void 0,f=await(0,b.px)("fetchProfilePhotos",{peer:c,offset:p,limit:g});if(!f||!f.photos)return;e=(0,w.mS)();const{photos:I,count:v,nextOffsetId:y}=f;e=(0,A.LZP)(e,a,{newPhotos:I,count:v,nextOffset:y,fullInfo:m,shouldInvalidateCache:o}),(0,w.UF)(e)}),(0,w.aJ)("setUserSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;a&&Be(async()=>{const t=await(0,b.px)("searchChats",{query:a});e=(0,w.mS)();const s=(0,C.nTw)(e,o).userSearch.query;if(!t||!s||a!==s)return e=(0,A.Z0S)(e,!1,o),void(0,w.UF)(e);const{accountResultIds:n,globalResultIds:i}=t,r=n.filter(k.L8),d=i.filter(k.L8);e=(0,A.Z0S)(e,!1,o),e=(0,A.BFh)(e,{localUserIds:r,globalUserIds:d},o),(0,w.UF)(e)})}),(0,w.aJ)("importContact",async(e,t,s)=>{const{phoneNumber:a,firstName:o,lastName:n,tabId:i=(0,u.g0)()}=s,r=await(0,b.px)("importContact",{phone:a,firstName:o,lastName:n});r?(t.openChat({id:r,tabId:i}),e=(0,w.mS)(),e=(0,A.BOn)(e,i),(0,w.UF)(e)):t.showNotification({message:f.yE("Contacts.PhoneNumber.NotRegistred"),tabId:i})}),(0,w.aJ)("reportSpam",(e,t,s)=>{const{chatId:a}=s,o=(0,C.PVB)(e,a);o&&(0,b.px)("reportSpam",o)}),(0,w.aJ)("setEmojiStatus",async(e,t,s)=>{const{emojiStatus:a,referrerWebAppKey:o,tabId:n=(0,u.g0)()}=s;if(!(0,C.g29)(e))return o&&t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}},tabId:n}),void t.openPremiumModal({initialSection:"emoji_status",tabId:n});const i=await(0,b.px)("updateEmojiStatus",a);if(o){if(!i)return void t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"SERVER_ERROR"}},tabId:n});t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_set"},tabId:n}),t.showNotification({message:{key:"BotSuggestedStatusUpdated"},customEmojiIconId:a.documentId,tabId:n})}}),(0,w.aJ)("saveCloseFriends",async(e,t,s)=>{const{userIds:a}=s;await(0,b.px)("saveCloseFriends",a)&&(e=(0,w.mS)(),e.contactList?.userIds.forEach(t=>{const{isCloseFriend:s}=e.users.byId[t]||{};s&&!a.includes(t)&&(e=(0,A.TKu)(e,t,{isCloseFriend:void 0}))}),a.forEach(t=>{e=(0,A.TKu)(e,t,{isCloseFriend:!0})}),(0,w.UF)(e))}),(0,w.aJ)("openSuggestedStatusModal",async(e,t,s)=>{const{customEmojiId:a,duration:o,botId:n,webAppKey:i,tabId:r=(0,u.g0)()}=s,d=await(0,b.px)("fetchCustomEmoji",{documentId:[a]});d?.[0]?(e=(0,w.mS)(),e=(0,M.w)(e,{suggestedStatusModal:{customEmojiId:a,duration:o,webAppKey:i,botId:n}},r),(0,w.UF)(e)):i&&t.sendWebAppEvent({webAppKey:i,event:{eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}},tabId:r})}),(0,w.aJ)("loadPeerSettings",async(e,t,s)=>{const{peerId:a}=s;if((0,C.trm)(e))return;if(!(0,C.vGo)(e,a))return void t.loadFullUser({userId:a});const o=(0,C.mBe)(e,a);if(!o)return;const n=await(0,b.px)("fetchPeerSettings",o);if(!n)return;const{settings:i}=n;e=(0,w.mS)(),e=(0,A.weB)(e,a,{settings:i}),(0,w.UF)(e)}),(0,w.aJ)("markBotVerificationInfoShown",(e,t,s)=>{const{peerId:o}=s,n=e.settings.botVerificationShownPeerIds,i=(0,h.Am)([o,...n]).slice(0,a.qLe);e={...e,settings:{...e.settings,botVerificationShownPeerIds:i}},(0,w.UF)(e)});var Re=s(33204),Ne=s(59852),Je=s(20179);function Ee(e,t,s){for(var a=arguments.length,o=new Array(a>3?a-3:0),n=3;n<a;n++)o[n-3]=arguments[n];let[i=(0,u.g0)()]=o;const r=(0,C.nTw)(e,i);return(0,M.w)(e,{inlineBots:{...r.inlineBots,byUsername:{...r.inlineBots.byUsername,[t]:s}}},i)}function Le(e,t){for(var s=arguments.length,a=new Array(s>2?s-2:0),o=2;o<s;o++)a[o-2]=arguments[o];let[n=(0,u.g0)()]=a;return(0,M.w)(e,{inlineBots:{...(0,C.nTw)(e,n).inlineBots,isLoading:t}},n)}function Ye(e,t,s){for(var a=arguments.length,o=new Array(a>3?a-3:0),n=3;n<a;n++)o[n-3]=arguments[n];let[i=(0,u.g0)()]=o;const r=(0,C.nTw)(e,i),d=r.webApps.openedWebApps,c=d[t];if(!c)return e;const l={...c,...s},h=(0,Je.rp)(l);return h?e=(0,M.w)(e,{webApps:{...r.webApps,openedWebApps:{...d,[h]:l}}},i):e}function De(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];for(var o=arguments.length,n=new Array(o>4?o-4:0),i=4;i<o;i++)n[i-4]=arguments[i];let[r=(0,u.g0)()]=n;const d=(0,C.nTw)(e,r),c=(0,Je.rp)(t);if(!c)return e;const l=[...d.webApps.openedOrderedKeys];l.includes(c)||l.push(c);const h=[...d.webApps.sessionKeys];h.includes(c)||h.push(c);const m=d.webApps.openedWebApps;return(0,M.w)(e,{webApps:{...d.webApps,...s&&{activeWebAppKey:c},isMoreAppsTabActive:!1,isModalOpen:a,modalState:"maximized",openedWebApps:{...m,[c]:t},openedOrderedKeys:l,sessionKeys:h}},r)}function Oe(e,t,s){for(var a=arguments.length,o=new Array(a>3?a-3:0),n=3;n<a;n++)o[n-3]=arguments[n];let[i=(0,u.g0)()]=o;const r=(0,C.nTw)(e,i),{openedWebApps:d,openedOrderedKeys:c,activeWebAppKey:l}=r.webApps,h=d[t];if(!h)return e;if(!s&&h.shouldConfirmClosing)return Ye(e,t,{isCloseModalOpen:!0},i);const m={...d},p=(0,Je.rp)(h);let g=c;p&&(delete m[p],g=c.filter(e=>e!==p));const f=l===(0,Je.rp)(h),I=Object.keys(m),v=I.length;return(0,M.w)(e,{webApps:{...r.webApps,...f&&{activeWebAppKey:v?I[v-1]:void 0},openedWebApps:m,openedOrderedKeys:g,...!v&&{sessionKeys:[]}}},i)}function Ge(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];let[o=(0,u.g0)()]=s;return Object.keys((0,C.nTw)(e,o).webApps.openedWebApps).length>0}function Ve(e,t){for(var s=arguments.length,a=new Array(s>2?s-2:0),o=2;o<s;o++)a[o-2]=arguments[o];let[n=(0,u.g0)()]=a;const i=(0,C.nTw)(e,n);return(0,M.w)(e,{webApps:{...i.webApps,isModalOpen:t}},n)}var je=s(30708);const qe=(0,I.sg)(e=>e(),500,!1);let ze;function Ke(e,t,s,a,o){const n={botId:t,requestUrl:a,webAppName:o};if(function(e,t,s){const a=(0,C.nTw)(e,s).webApps.openedWebApps,o=(0,y.rp)(t);return!!o&&a[o]}(e,n,s)){const t=(0,y.rp)(n);return t&&(e=function(e,t){for(var s=arguments.length,a=new Array(s>2?s-2:0),o=2;o<s;o++)a[o-2]=arguments[o];let[n=(0,u.g0)()]=a;const i=(0,C.nTw)(e,n);return i.webApps.openedWebApps[t]?e=(0,M.w)(e,{webApps:{...i.webApps,isMoreAppsTabActive:!1,activeWebAppKey:t,modalState:"maximized"}},n):e}(e,t,s),(0,w.UF)(e)),!0}return!1}function We(e,t,s,a){for(var o=arguments.length,n=new Array(o>4?o-4:0),i=4;i<o;i++)n[i-4]=arguments[i];let[r=(0,u.g0)()]=n;if("request"===a.type){e=(0,w.mS)();const t=(0,C.nTw)(e,r);if(!t.urlAuth)return;const{domain:s,bot:o,shouldRequestWriteAccess:n}=a;return e=(0,M.w)(e,{urlAuth:{...t.urlAuth,request:{domain:s,botId:o.id,shouldRequestWriteAccess:n}}},r),void(0,w.UF)(e)}const d="accepted"===a.type?a.url:s;window.open(d,"_blank","noopener"),t.closeUrlAuthModal({tabId:r})}async function He(e,t,s,a,o){await(0,b.px)("sendMessage",{chat:e,replyInfo:s,text:t,sendAs:a,lastMessageId:o})}async function _e(e,t,s,a,o,n){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6];for(var r=arguments.length,d=new Array(r>7?r-7:0),c=7;c<r;c++)d[c-7]=arguments[c];let[l=(0,u.g0)()]=d;const{showDialog:h,showNotification:m,openUrl:p,openGame:g}=t,f=await(0,b.px)("answerCallbackButton",{chatId:s.id,accessHash:s.accessHash,messageId:a,data:n,isGame:i});if(!f)return;const{message:I,alert:v,url:y}=f;v?h({data:{message:I||"Error"},tabId:l}):I?m({message:I,tabId:l}):y&&(i?g({url:y,chatId:s.id,messageId:a,tabId:l}):p({url:y,tabId:l,linkContext:{type:"message",chatId:s.id,messageId:a,threadId:o}}))}(0,w.aJ)("clickSuggestedMessageButton",(e,t,s)=>{const{chatId:a,messageId:o,button:n,tabId:i=(0,u.g0)()}=s,{buttonType:r}=n,d=(0,C.O5q)(e,a,o);switch(r){case"suggestChanges":if(!d)break;t.initDraftFromSuggestedMessage({chatId:a,messageId:o,tabId:i})}}),(0,w.aJ)("clickBotInlineButton",(e,t,s)=>{const{chatId:a,messageId:o,threadId:n,button:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a),l=(0,C.O5q)(e,a,o);if(d&&l)switch(i.type){case"command":t.sendBotCommand({command:i.text,tabId:r});break;case"url":{const{url:e}=i;t.openUrl({url:e,tabId:r,linkContext:{type:"message",chatId:a,messageId:o,threadId:n}});break}case"copy":(0,c.eM)(i.copyText),t.showNotification({message:(0,f.yE)("ExactTextCopied",i.copyText),tabId:r});break;case"callback":_e(e,t,d,o,n,i.data,void 0,r);break;case"requestPoll":t.openPollModal({isQuiz:i.isQuiz,tabId:r});break;case"requestPhone":{const s=e.currentUserId?(0,C.mBe)(e,e.currentUserId):void 0;if(!s)return;t.showDialog({data:{phoneNumber:s.phoneNumber,firstName:s.firstName||"",lastName:s.lastName||"",userId:s.id},tabId:r});break}case"receipt":{const{receiptMessageId:e}=i;t.getReceipt({chatId:d.id,messageId:e,tabId:r});break}case"buy":t.openInvoice({type:"message",chatId:d.id,messageId:o,tabId:r});break;case"game":_e(e,t,d,o,n,void 0,!0,r);break;case"switchBotInline":{const{query:e,isSamePeer:s}=i;t.switchBotInline({query:e,isSamePeer:s,messageId:o,tabId:r});break}case"userProfile":{const{userId:e}=i;t.openChatWithInfo({id:e,tabId:r});break}case"simpleWebView":{const{url:s}=i,a=(0,C.Y7C)(e,l);if(!a)return;const o=(0,Ne.A)();t.requestSimpleWebView({url:s,botId:a.id,theme:o,buttonText:i.text,tabId:r});break}case"webView":{const{url:s}=i,a=(0,C.Y7C)(e,l),o=l.viaBotId||a?.id;if(!o)return;const n=(0,Ne.A)();t.requestWebView({url:s,botId:o,peerId:d.id,theme:n,buttonText:i.text,tabId:r});break}case"urlAuth":{const{url:e}=i;t.requestBotUrlAuth({chatId:d.id,messageId:o,buttonId:i.buttonId,url:e,tabId:r});break}}}),(0,w.aJ)("sendBotCommand",(e,t,s)=>{const{command:a,chatId:o,tabId:n=(0,u.g0)()}=s,i=o?(0,C.hds)(e,o):(0,C.meB)(e,n),r=(0,C.Xf0)(e,n);if(!i||!r)return;const{threadId:d}=r;t.resetDraftReplyInfo({tabId:n}),t.clearWebPagePreview({tabId:n});const c=(0,C.ZZX)(e,i.id);He(i,a,(0,C.GA4)(e,i.id,d)?.replyInfo,(0,C.VF$)(e,i.id),c)}),(0,w.aJ)("restartBot",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,{currentUserId:n}=e,i=(0,C.meB)(e,o),r=n&&(0,C.yps)(e,a);if(!n||!i||!r)return;const d=(0,C.ZZX)(e,i.id);await(0,b.px)("unblockUser",{user:r})&&(e=(0,w.mS)(),e=(0,A.OW3)(e,r.id),(0,w.UF)(e),He(i,"/start",void 0,(0,C.VF$)(e,a),d))}),(0,w.aJ)("loadTopInlineBots",async e=>{const{lastRequestedAt:t}=e.topInlineBots;if(t&&(0,v.Fm)()-t<60)return;const s=await(0,b.px)("fetchTopInlineBots");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topInlineBots:{...e.topInlineBots,userIds:a,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("loadTopBotApps",async e=>{const{lastRequestedAt:t}=e.topBotApps;if(t&&(0,v.Fm)()-t<60)return;const s=await(0,b.px)("fetchTopBotApps");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topBotApps:{...e.topBotApps,userIds:a,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("queryInlineBot",async(e,t,s)=>{const{chatId:a,username:o,query:n,offset:i,tabId:r=(0,u.g0)()}=s;let d=(0,C.nTw)(e,r).inlineBots.byUsername[o];if(!1!==d){if(void 0===d){const{user:t,chat:s}=await(0,b.px)("fetchInlineBot",{username:o})||{};if(e=(0,w.mS)(),!t||!s)return e=Ee(e,o,!1,r),void(0,w.UF)(e);d={id:t.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=Ee(e,o,d,r),(0,w.UF)(e)}(n!==d.query||d.canLoadMore)&&qe(()=>{!async function(e,t){let{username:s,inlineBotData:a,chatId:o,query:n,offset:i}=t;for(var r=arguments.length,d=new Array(r>2?r-2:0),c=2;c<r;c++)d[c-2]=arguments[c];let[l=(0,u.g0)()]=d;e=(0,w.mS)();const m=(0,C.mBe)(e,a.id),p=(0,C.hds)(e,o);if(!m||!p)return;const g=a.query!==n;e=Ee(e=Le(e,!0,l),s,{...a,query:n,...g&&{offset:void 0,results:[]}},l),(0,w.UF)(e);const f=await(0,b.px)("fetchInlineBotResults",{bot:m,chat:p,query:n,offset:g?void 0:i});e=(0,w.mS)();const I=(0,C.nTw)(e,l).inlineBots.byUsername[s];if(e=Le(e,!1,l),!f||!I||n!==I.query)return void(0,w.UF)(e);const v=new Set((I.results||[]).map(e=>e.id)),y=f.results.filter(e=>!v.has(e.id));e=Ee(e,s,{...I,...(0,h.Up)(f,["help","switchPm","switchWebview"]),cacheTime:Date.now()+1e3*f.cacheTime,...y.length&&{isGallery:f.isGallery},canLoadMore:f.results.length>0&&Boolean(f.nextOffset),results:""===I.offset||I.offset===f.nextOffset?f.results:(I.results||[]).concat(y),offset:y.length?f.nextOffset:""},l),(0,w.UF)(e)}(e,{username:o,inlineBotData:d,chatId:a,query:n,offset:i},r)})}}),(0,w.aJ)("switchBotInline",(e,t,s)=>{const{query:a,isSamePeer:o,messageId:n,filter:i,tabId:r=(0,u.g0)()}=s;let{botId:d}=s;const c=(0,C.meB)(e,r);if(!c)return;if(!d&&n){const t=(0,C.O5q)(e,c.id,n);if(!t)return;const s=(0,C.Y7C)(e,t);d=t.viaBotId||s?.id}if(!d)return;const l=(0,C.mBe)(e,d);l&&t.openChatWithDraft({text:{text:`@${(0,y.Kl)(l)} ${a}`},chatId:o?c.id:void 0,filter:i,tabId:r})}),(0,w.aJ)("sendInlineBotApiResult",async(e,t,s)=>{const{chat:a,id:o,queryId:n,replyInfo:i,sendAs:r,isSilent:d,scheduledAt:c,allowPaidStars:l}=s;await(0,b.px)("sendInlineBotResult",{chat:a,resultId:o,queryId:n,replyInfo:i,sendAs:r,isSilent:d,scheduleDate:c,allowPaidStars:l}),l&&t.loadStarStatus()}),(0,w.aJ)("sendInlineBotResult",async(e,t,s)=>{const{id:a,queryId:o,isSilent:n,scheduledAt:i,threadId:r,chatId:d,tabId:c=(0,u.g0)()}=s;if(!a)return;const l=(0,C.hds)(e,d),h=(0,C.GA4)(e,d,r)?.replyInfo,m=(0,C.OEv)(e,d,r,h);t.resetDraftReplyInfo({tabId:c}),t.clearWebPagePreview({tabId:c});const f=await ne(e,d),I={chat:l,id:a,queryId:o,replyInfo:m,sendAs:(0,C.VF$)(e,d),isSilent:n,scheduledAt:i,allowPaidStars:f};f?(t.sendInlineBotApiResult({...I}),t.showNotification({localId:o,title:{key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}},message:{key:"MessageSentPaidToastText",variables:{amount:(0,g.Kk)((0,p.Yw)(),f)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage",tabId:c})):t.sendInlineBotApiResult(I)}),(0,w.aJ)("resetInlineBot",(e,t,s)=>{const{username:a,force:o,tabId:n=(0,u.g0)()}=s;let i=(0,C.nTw)(e,n).inlineBots.byUsername[a];i&&(!o&&Date.now()<i.cacheTime||(i={id:i.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=Ee(e,a,i,n),(0,w.UF)(e)))}),(0,w.aJ)("resetAllInlineBots",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).inlineBots.byUsername;Object.keys(o).forEach(e=>{t.resetInlineBot({username:e,tabId:a})})}),(0,w.aJ)("startBot",async(e,t,s)=>{const{botId:a,param:o}=s,n=(0,C.mBe)(e,a);if(!n)return;let i=(0,C.vGo)(e,a);if(!i){const e=await(0,b.px)("fetchFullUser",{id:n.id,accessHash:n.accessHash});i=e?.fullInfo}i?.isBlocked&&await(0,b.px)("unblockUser",{user:n}),await(0,b.px)("startBot",{bot:n,startParam:o})}),(0,w.aJ)("sharePhoneWithBot",async(e,t,s)=>{const{botId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;let n=(0,C.vGo)(e,a);if(!n){const e=await(0,b.px)("fetchFullUser",{id:o.id,accessHash:o.accessHash});n=e?.fullInfo}n?.isBlocked&&await(0,b.px)("unblockUser",{user:o}),e=(0,w.mS)();const i=(0,C.hds)(e,a),r=(0,C.mBe)(e,e.currentUserId);if(!i)return;const d=(0,C.ZZX)(e,i.id);await(0,b.px)("sendMessage",{chat:i,contact:{mediaType:"contact",firstName:r.firstName||"",lastName:r.lastName||"",phoneNumber:r.phoneNumber||"",userId:r.id},lastMessageId:d})}),(0,w.aJ)("requestSimpleWebView",async(e,t,s)=>{const{url:a,botId:o,theme:n,buttonText:i,isFromSideMenu:r,isFromSwitchWebView:d,startParam:c,tabId:l=(0,u.g0)()}=s;if(Ke(e,o,l,a))return;const h=(0,C.mBe)(e,o);if(!h)return;if(!(0,C.nTL)(e,o))return e=(0,M.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestSimpleWebView",payload:s}}},l),void(0,w.UF)(e);const m=await(0,b.px)("requestSimpleWebView",{url:a,bot:h,theme:n,startParam:c,isFromSideMenu:r,isFromSwitchWebView:d});m&&(e=De(e=(0,w.mS)(),{requestUrl:a,appName:h.firstName,url:m,botId:o,buttonText:i},!0,!0,l),(0,w.UF)(e))}),(0,w.aJ)("requestWebView",async(e,t,s)=>{const{url:a,botId:o,peerId:i,theme:r,isSilent:d,buttonText:c,isFromBotMenu:l,startParam:h,isFullscreen:m,tabId:p=(0,u.g0)()}=s;if(Ke(e,o,p,a))return;const g=(0,C.mBe)(e,o);if(!g)return;const f=(0,C.PVB)(e,i);if(!f)return;if(!(0,C.nTL)(e,o))return e=(0,M.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestWebView",payload:s}}},p),void(0,w.UF)(e);const I=(0,C.Xf0)(e,p),{chatId:v,threadId:y=n.l3}=I||{},S=v?(0,C.GA4)(e,v,y)?.replyInfo:void 0,A=v?(0,C.OEv)(e,v,y,S):void 0,P=v?(0,C.VF$)(e,v):void 0,k=await(0,b.px)("requestWebView",{url:a,bot:g,peer:f,theme:r,isSilent:d,replyInfo:A,isFromBotMenu:l,startParam:h,sendAs:P,isFullscreen:m});if(!k)return;const{url:F,queryId:T,isFullScreen:x}=k;e=De(e=(0,w.mS)(),{requestUrl:a,url:F,appName:g.firstName,botId:o,peerId:i,queryId:T,replyInfo:A,buttonText:c},!0,!0,p),(0,w.UF)(e),x&&(0,D.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:p})}),(0,w.aJ)("requestMainWebView",async(e,t,s)=>{const{botId:a,peerId:o,theme:n,startParam:i,mode:r,shouldMarkBotTrusted:d,tabId:c=(0,u.g0)()}=s;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:c});if(Ke(e,a,c))return;const l=(0,C.mBe)(e,a);if(!l)return;const h=(0,C.PVB)(e,o);if(!h)return;if(!(0,C.nTL)(e,a)){if(!d)return e=(0,M.w)(e,{botTrustRequest:{botId:a,type:"webApp",onConfirm:{action:"requestMainWebView",payload:s}}},c),void(0,w.UF)(e);t.markBotTrusted({botId:a,isWriteAllowed:!0,tabId:c})}const m=await(0,b.px)("requestMainWebView",{bot:l,peer:h,theme:n,startParam:i,mode:r});if(!m)return;const{url:p,queryId:g,isFullscreen:f}=m;e=De(e=(0,w.mS)(),{url:p,appName:l.firstName,botId:a,peerId:o,queryId:g,buttonText:""},!0,!0,c),(0,w.UF)(e),f&&(0,D.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:c})}),(0,w.aJ)("loadPreviewMedias",async(e,t,s)=>{const{botId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const n=await(0,b.px)("fetchPreviewMedias",{bot:o});e=(0,w.mS)(),n&&(e={...e,users:{...e.users,previewMediaByBotId:{...e.users.previewMediaByBotId,[a]:n}}},(0,w.UF)(e))}),(0,w.aJ)("openWebAppsCloseConfirmationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isWebAppsCloseConfirmationModalOpen:!0},a)}),(0,w.aJ)("closeWebAppsCloseConfirmationModal",(e,t,s)=>{const{shouldSkipInFuture:a,tabId:o=(0,u.g0)()}=s||{};return e=(0,A.qoo)(e,{shouldSkipWebAppCloseConfirmation:Boolean(a)}),(0,M.w)(e,{isWebAppsCloseConfirmationModalOpen:void 0},o)}),(0,w.aJ)("requestAppWebView",async(e,t,s)=>{const{botId:a,appName:o,startApp:n,mode:i,theme:r,isWriteAllowed:d,isFromConfirm:c,shouldSkipBotTrustRequest:l,tabId:h=(0,u.g0)()}=s;if(Ke(e,a,h,o))return;const m=(0,C.mBe)(e,a);if(!m)return;const p=Boolean(e.attachMenu.bots[m.id]);if(m.isAttachBot&&!c&&!p){const t=await(0,b.px)("loadAttachBot",{bot:m});if(t){e=(0,w.mS)();const a=t.bot;if(a.isDisclaimerNeeded||a.isForAttachMenu||a.isForSideMenu)return e=(0,M.w)(e,{requestedAttachBotInstall:{bot:a,onConfirm:{action:"requestAppWebView",payload:{...s,isFromConfirm:!0}}}},h),void(0,w.UF)(e)}}const g=await(0,b.px)("fetchBotApp",{bot:m,appName:o});if(e=(0,w.mS)(),!g)return void t.showNotification({message:(0,f.yE)("lng_username_app_not_found"),tabId:h});if(!l&&(g.isInactive||!(0,C.nTL)(e,a)))return s.shouldSkipBotTrustRequest=!0,e=(0,M.w)(e,{botTrustRequest:{botId:a,shouldRequestWriteAccess:g.shouldRequestWriteAccess,type:"botApp",onConfirm:{action:"requestAppWebView",payload:s}}},h),void(0,w.UF)(e);const I=(0,C.meB)(e,h),{url:v,isFullscreen:y}=await(0,b.px)("requestAppWebView",{peer:I||m,app:g,startParam:n,mode:i,isWriteAllowed:d,theme:r});if(e=(0,w.mS)(),!v)return;e=(0,w.mS)();const S=I?I.id:m.id;e=De(e,{url:v,appName:o&&m.firstName,peerId:S,botId:a,buttonText:""},!0,!0,h),(0,w.UF)(e),y&&(0,D.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:h})}),(0,w.aJ)("prolongWebView",async(e,t,s)=>{const{botId:a,peerId:o,isSilent:n,replyInfo:i,queryId:r,tabId:d=(0,u.g0)()}=s,c=(0,C.mBe)(e,a);if(!c)return;const l=(0,C.hds)(e,o);if(!l)return;const h=(0,C.VF$)(e,o);await(0,b.px)("prolongWebView",{bot:c,peer:l,isSilent:n,replyInfo:i,queryId:r,sendAs:h})||t.closeActiveWebApp({tabId:d})}),(0,w.aJ)("sendWebViewData",(e,t,s)=>{const{bot:a,data:o,buttonText:n}=s;(0,b.px)("sendWebViewData",{bot:a,data:o,buttonText:n})}),(0,w.aJ)("loadAttachBots",async e=>{await async function(e){const t=await(0,b.px)("loadAttachBots",{hash:void 0});if(t)return e=(0,w.mS)(),e={...e,attachMenu:{hash:t.hash,bots:t.bots}},(0,w.UF)(e),t}(e),(0,Re.A)({action:"loadAttachBots",payload:void 0},a.npx)}),(0,w.aJ)("toggleAttachBot",async(e,t,s)=>{const{botId:a,isWriteAllowed:o,isEnabled:n}=s,i=(0,C.mBe)(e,a);i&&await(0,b.px)("toggleAttachBot",{bot:i,isWriteAllowed:o,isEnabled:n})}),(0,w.aJ)("callAttachBot",(e,t,s)=>{const{bot:a,startParam:o,isFromConfirm:i,tabId:r=(0,u.g0)()}=s,d="isFromSideMenu"in s&&s.isFromSideMenu,c=!a,l=!c&&!e.attachMenu.bots[a.id]||a?.isInactive||a?.isDisclaimerNeeded;if(!i&&l)return(0,M.w)(e,{requestedAttachBotInstall:{bot:a,onConfirm:{action:"callAttachBot",payload:{...s,isFromConfirm:!0}}}},r);const h=(0,Ne.A)();if(d&&t.requestSimpleWebView({botId:a.id,buttonText:"",isFromSideMenu:!0,startParam:o,theme:h,tabId:r}),"chatId"in s){const{chatId:e,threadId:i=n.l3,url:d}=s;t.openThread({chatId:e,threadId:i,tabId:r}),t.requestWebView({url:d,peerId:e,botId:c?e:a.id,theme:h,buttonText:"",isFromBotMenu:c,startParam:o,tabId:r})}}),(0,w.aJ)("confirmAttachBotInstall",async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,{requestedAttachBotInstall:n}=(0,C.nTw)(e,o),{bot:i,onConfirm:r}=n;e=(0,M.w)(e,{requestedAttachBotInstall:void 0},o),(0,w.UF)(e);const d=(0,C.mBe)(e,i.id);if(d&&(t.markBotTrusted({botId:i.id,isWriteAllowed:a,tabId:o}),await(0,b.px)("toggleAttachBot",{bot:d,isWriteAllowed:a,isEnabled:!0}),r)){const{action:e,payload:s}=r;t[e](s)}}),(0,w.aJ)("requestBotUrlAuth",async(e,t,s)=>{const{chatId:a,buttonId:o,messageId:n,url:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a);if(!d)return;const c=await(0,b.px)("requestBotUrlAuth",{chat:d,buttonId:o,messageId:n});c&&(e=(0,w.mS)(),e=(0,M.w)(e,{urlAuth:{url:i,button:{buttonId:o,messageId:n,chatId:d.id}}},r),(0,w.UF)(e),We(e,t,i,c,r))}),(0,w.aJ)("acceptBotUrlAuth",async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);if(!n.urlAuth?.button)return;const{button:i,url:r}=n.urlAuth,{chatId:d,messageId:c,buttonId:l}=i,h=(0,C.hds)(e,d);if(!h)return;const m=await(0,b.px)("acceptBotUrlAuth",{chat:h,messageId:c,buttonId:l,isWriteAllowed:a});m&&We(e=(0,w.mS)(),t,r,m,o)}),(0,w.aJ)("requestLinkUrlAuth",async(e,t,s)=>{const{url:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("requestLinkUrlAuth",{url:a});n&&(e=(0,w.mS)(),e=(0,M.w)(e,{urlAuth:{url:a}},o),(0,w.UF)(e),We(e,t,a,n,o))}),(0,w.aJ)("acceptLinkUrlAuth",async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);if(!n.urlAuth?.url)return;const{url:i}=n.urlAuth,r=await(0,b.px)("acceptLinkUrlAuth",{url:i,isWriteAllowed:a});r&&We(e=(0,w.mS)(),t,i,r,o)}),(0,w.aJ)("closeUrlAuthModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{urlAuth:void 0},a)}),(0,w.aJ)("setBotInfo",async(e,t,s)=>{const{bot:a,name:o,description:n,tabId:r=(0,u.g0)()}=s;let{langCode:d}=s;d||(d=(0,je.l)(e).language);const{currentUserId:c}=e;c&&a&&(e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.InProgress,r),(0,w.UF)(e),(o||n)&&await(0,b.px)("setBotInfo",{bot:a,langCode:d,name:o,about:n})&&(e=(0,w.mS)(),e=(0,A.TKu)(e,a.id,{firstName:o}),e=(0,A.weB)(e,a.id,{bio:n}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Complete,r),(0,w.UF)(e))}),(0,w.aJ)("toggleUserEmojiStatusPermission",async(e,t,s)=>{const{botId:a,isEnabled:o,isBotAccessEmojiGranted:n}=s,i=(0,C.yps)(e,a);a&&i&&await(0,b.px)("toggleUserEmojiStatusPermission",{bot:i,isEnabled:o})&&(e=(0,w.mS)(),e=(0,A.weB)(e,a,{isBotCanManageEmojiStatus:o,isBotAccessEmojiGranted:n}),(0,w.UF)(e))}),(0,w.aJ)("toggleUserLocationPermission",(e,t,s)=>{const{botId:a,isAccessGranted:o}=s,n=(0,C.mBe)(e,a);n&&(e=(0,w.mS)(),e=(0,A.cxc)(e,n.id,{geolocation:o}),(0,w.UF)(e))}),(0,w.aJ)("startBotFatherConversation",async(e,t,s)=>{const{param:n,tabId:i=(0,u.g0)()}=s;if(!ze){const t=await(0,o.A$)(e,a.aFH);if(!t)return;ze=t.id}n&&t.startBot({botId:ze,param:n}),t.openChat({id:ze,tabId:i})}),(0,w.aJ)("loadBotFreezeAppeal",async e=>{const t=e.appConfig.freezeAppealUrl;if(!t)return;const s=t?(0,l.l8)(t):void 0;if(!s)return;const a=await(0,o.A$)(e,s);e=(0,w.mS)(),e={...e,botFreezeAppealId:a?.id},(0,w.UF)(e)}),s(26943),(0,w.aJ)("loadPasswordInfo",async e=>{const t=await(0,b.px)("getPasswordInfo");t&&(e=(0,w.mS)(),e=(0,A.qpc)(e,{hasPassword:t.hasPassword}),e=(0,A.keG)(e,{hint:t.hint}),(0,w.UF)(e))}),(0,w.aJ)("checkPassword",async(e,t,s)=>{const{currentPassword:a,onSuccess:o}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const n=await(0,b.px)("checkPassword",a);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),n&&o()}),(0,w.aJ)("clearPassword",async(e,t,s)=>{const{currentPassword:a,onSuccess:o}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const n=await(0,b.px)("clearPassword",a);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),n&&o()}),(0,w.aJ)("updatePassword",async(e,t,s)=>{const{currentPassword:a,password:o,hint:n,email:i,onSuccess:r}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const d=await(0,b.px)("updatePassword",a,o,n,i);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),d&&r()}),(0,w.aJ)("updateRecoveryEmail",async(e,t,s)=>{const{currentPassword:a,email:o,onSuccess:n,tabId:i=(0,u.g0)()}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),e=(0,M.w)(e,{recoveryEmail:o},i),(0,w.UF)(e);const r=await(0,b.px)("updateRecoveryEmail",a,o);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1,waitingEmailCodeLength:void 0}),e=(0,M.w)(e,{recoveryEmail:void 0},i),(0,w.UF)(e),r&&n()}),(0,w.aJ)("provideTwoFaEmailCode",(e,t,s)=>{const{code:a}=s;(0,b.px)("provideRecoveryEmailCode",a)}),(0,w.aJ)("clearTwoFaError",e=>(0,A.keG)(e,{errorKey:void 0}));const $e={missing_payment_information:{field:"cardNumber",message:"Incorrect card number"},invalid_number:{field:"cardNumber",message:"Incorrect card number"},number:{field:"cardNumber",message:"Incorrect card number"},exp_year:{field:"expiry",message:"Incorrect year"},exp_month:{field:"expiry",message:"Incorrect month"},invalid_expiry_year:{field:"expiry",message:"Incorrect year"},invalid_expiry_month:{field:"expiry",message:"Incorrect month"},cvc:{field:"cvv",message:"Incorrect CVV"},invalid_cvc:{field:"cvv",message:"Incorrect CVV"}};var Xe=s(86046);async function Qe(e,t,s){for(var o=arguments.length,n=new Array(o>3?o-3:0),i=3;i<o;i++)n[i-3]=arguments[i];let[r=(0,u.g0)()]=n;const d=(0,w.ko)(),c="stargiftResale"===t.type&&t.currency===a.ykW,l=c?e.ton?.balance:e.stars?.balance,h=c?a.ykW:a.OUy;if(void 0===l)return;if(l.amount<s)return void d.openStarsBalanceModal({currency:h,tabId:r});const m=(0,Xe.jA)(e,t);if(!m)return;e=(0,M.w)(e,{isPaymentFormLoading:!0},r),(0,w.UF)(e);const p=(0,Ne.A)(),g=await(0,b.px)("getPaymentForm",m,p);if(!g)return;if(e=(0,w.mS)(),e=(0,M.w)(e,{isPaymentFormLoading:!1},r),(0,w.UF)(e),"error"in g)return void Ze(g.error,r);const f=g.invoice.totalAmount;f===s?d.sendStarPaymentForm({directInfo:{inputInvoice:t,formId:g.formId},tabId:r}):d.openPriceConfirmModal({originalAmount:s,newAmount:f,currency:h,directInfo:{inputInvoice:t,formId:g.formId},tabId:r})}function Ze(e,t){"SLUG_INVALID"!==e?(0,w.ko)().showDialog({data:{message:e,hasErrorKey:!0},tabId:t}):(0,w.ko)().showNotification({message:{key:"PaymentInvoiceNotFound"},tabId:t})}(0,w.aJ)("validateRequestedInfo",(e,t,s)=>{const{requestInfo:a,saveInfo:o,tabId:n=(0,u.g0)()}=s,r=(0,C.aF2)(e,n);if(!r)return;const d=(0,Xe.jA)(e,r);d&&async function(e,t,s,a){for(var o=arguments.length,n=new Array(o>4?o-4:0),r=4;r<o;r++)n[r-4]=arguments[r];let[d=(0,u.g0)()]=n;const c=await(0,b.px)("validateRequestedInfo",{inputInvoice:t,requestInfo:s,shouldSave:a});if(!c)return;const{id:l,shippingOptions:h}=c;e=(0,w.mS)(),e=(0,A.bbG)(e,l,d),h?.length?(e=(0,A.oFy)(e,h,d),e=(0,A.lwH)(e,i.tn.Shipping,d)):e=(0,A.lwH)(e,i.tn.Checkout,d),(0,w.UF)(e)}(e,d,a,o,n)}),(0,w.aJ)("openInvoice",async(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,n=(0,Xe.jA)(e,o);if(!n)return;e=(0,M.w)(e,{isPaymentFormLoading:!0},a),(0,w.UF)(e);const r=(0,Ne.A)(),d=await(0,b.px)("getPaymentForm",n,r);if(d){if(e=(0,w.mS)(),e=(0,M.w)(e,{isPaymentFormLoading:!1},a),"error"in d)return(0,w.UF)(e),void Ze(d.error,a);"regular"===d.type&&(e=(0,A._$X)(e,{inputInvoice:s,form:d,isPaymentModalOpen:!0,isExtendedMedia:s.isExtendedMedia,status:void 0},a),e=(0,A.lwH)(e,i.tn.Checkout,a)),"stars"===d.type&&(e=(0,M.w)(e,{starsPayment:{inputInvoice:o,form:d,status:"pending"}},a)),(0,w.UF)(e)}}),(0,w.aJ)("sendStarGift",(e,t,s)=>{const{gift:a,peerId:o,message:n,shouldHideName:i,shouldUpgrade:r,tabId:d=(0,u.g0)()}=s;Qe(e,{type:"stargift",peerId:o,giftId:a.id,message:n,shouldHideName:i,shouldUpgrade:r||void 0},a.stars,d)}),(0,w.aJ)("buyStarGift",(e,t,s)=>{const{slug:a,peerId:o,price:n,tabId:i=(0,u.g0)()}=s;Qe(e,{type:"stargiftResale",slug:a,peerId:o,currency:n.currency},n.amount,i)}),(0,w.aJ)("sendPremiumGiftByStars",(e,t,s)=>{const{userId:a,months:o,amount:n,message:i,tabId:r=(0,u.g0)()}=s;Qe(e,{type:"premiumGiftStars",userId:a,months:o,message:i},n,r)}),(0,w.aJ)("getReceipt",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=a&&(0,C.hds)(e,a);if(!o||!i)return;const r=await(0,b.px)("getReceipt",i,o);r&&(e=(0,w.mS)(),e="stars"===r.receipt.type?(0,A.MeL)(e,r.receipt,n):(0,A.lEm)(e,r.receipt,n),(0,w.UF)(e))}),(0,w.aJ)("clearPaymentError",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,a).payment,error:void 0}},a),(0,w.UF)(e)}),(0,w.aJ)("clearReceipt",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{payment:{...(0,C.nTw)(e,a).payment,receipt:void 0}},a)}),(0,w.aJ)("sendCredentialsInfo",(e,t,s)=>{const{credentials:o,tabId:n=(0,u.g0)()}=s,{nativeProvider:r}=(0,C.nTw)(e,n).payment.form,{data:d}=o;if("stripe"===r){const t=(0,C.EGt)(e,n);if(!t)return;!async function(e,t,s){for(var a=arguments.length,o=new Array(a>3?a-3:0),n=3;n<a;n++)o[n-3]=arguments[n];let[r=(0,u.g0)()]=o;const d=function(e){const t=Object.keys(e).map(t=>`${t}=${e[t]}`).join("&");return t.length>0?`?${t}`:""}({"card[number]":t.cardNumber,"card[exp_month]":t.expiryMonth,"card[exp_year]":t.expiryYear,"card[cvc]":t.cvv,"card[address_zip]":t.zip,"card[address_country]":t.country}),c=await fetch(`https://api.stripe.com/v1/tokens${d}`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${s}`}}),l=await c.json();if(l.error){const t=function(e){const{message:t,code:s,param:a}=e,{field:o,message:n}=a?$e[a]:$e[s];return{field:o,message:n,description:t}}(l.error);return e=(0,w.mS)(),e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,r).payment,status:"failed",error:{...t}}},r),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,A.yQW)(e,{type:l.type,id:l.id},r),e=(0,A.lwH)(e,i.tn.Checkout,r),(0,w.UF)(e)}(e,d,t,n)}else if("smartglocal"===r){const t=(0,C.Kt9)(e,n);if(!t)return;!async function(e,t,s){for(var o=arguments.length,n=new Array(o>3?o-3:0),r=3;r<o;r++)n[r-3]=arguments[r];let[d=(0,u.g0)()]=n;const c={card:{number:t.cardNumber.replace(/\D+/g,""),expiration_month:t.expiryMonth,expiration_year:t.expiryYear,security_code:t.cvv.replace(/\D+/g,"")}},l=(0,C.nTw)(e,d).payment.form?.nativeParams.tokenizeUrl;let h;h=a.qKY?"https://tgb-playground.smart-glocal.com/cds/v1/tokenize/card":"https://tgb.smart-glocal.com/cds/v1/tokenize/card",l?.startsWith("https://")&&l.endsWith(".smart-glocal.com/cds/v1/tokenize/card")&&(h=l);const m=await fetch(h,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-PUBLIC-TOKEN":s},body:JSON.stringify(c)}),p=await m.json();if("ok"!==p.status){const t={descriptionKey:{key:"ErrorUnexpected"}};return e=(0,w.mS)(),e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,d).payment,status:"failed",error:{...t}}},d),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,A.Mac)(e,{type:"card",token:p.data.token},d),e=(0,A.lwH)(e,i.tn.Checkout,d),(0,w.UF)(e)}(e,d,t,n)}}),(0,w.aJ)("sendPaymentForm",async(e,t,s)=>{const{shippingOptionId:a,saveCredentials:o,savedCredentialId:n,tipAmount:i,tabId:r=(0,u.g0)()}=s,d=(0,C.PGw)(e,r),c=(0,C.nTw)(e,r).payment,{form:l,temporaryPassword:h,inputInvoice:m}=c;if(!m||!l)return;const{nativeProvider:p,formId:g}=l,f=(0,Xe.jA)(e,m);if(!f)return;e=(0,A._$X)(e,{status:"pending"},r),(0,w.UF)(e);const I={save:o,data:"stripe"===p?(0,C.e7$)(e,r):(0,C.G4m)(e,r)};await(0,b.px)("sendPaymentForm",{inputInvoice:f,formId:g,credentials:I,requestedInfoId:d,shippingOptionId:a,savedCredentialId:n,temporaryPassword:h?.value,tipAmount:i})&&(e=(0,w.mS)(),e=(0,A._$X)(e,{status:"paid"},r),e=(0,A.cYc)(e,r),(0,w.UF)(e),t.apiUpdate({"@type":"updatePaymentStateCompleted",paymentState:c,tabId:r}))}),(0,w.aJ)("sendStarPaymentForm",async(e,t,s)=>{const{directInfo:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Osl)(e,o),i=n?.inputInvoice||a?.inputInvoice;if(!i)return;const r=(0,Xe.jA)(e,i);if(!r)return;const d=n.form?.formId||n.subscriptionInfo?.subscriptionFormId||a?.formId;e=(0,A.nv6)(e,{status:"pending"},o),(0,w.UF)(e);const c=await(0,b.px)("sendStarPaymentForm",{inputInvoice:r,formId:d});if(!c)return e=(0,w.mS)(),e=(0,A.nv6)(e,{status:"failed"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),void t.closeGiftModal({tabId:o});e=(0,w.mS)(),e=(0,A.nv6)(e,{status:"paid"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),"channelId"in c&&t.openChat({id:c.channelId,tabId:o}),t.apiUpdate({"@type":"updateStarPaymentStateCompleted",paymentState:a?{inputInvoice:i}:n,tabId:o}),t.loadStarStatus()}),(0,w.aJ)("setSmartGlocalCardInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)(),type:o,token:n}=s;return(0,A.Mac)(e,{type:o,token:n},a)}),(0,w.aJ)("setPaymentStep",(e,t,s)=>{const{step:a,tabId:o=(0,u.g0)()}=s;return(0,A.lwH)(e,a??i.tn.Checkout,o)}),(0,w.aJ)("closePremiumModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(o.premiumModal)return(0,M.w)(e,{premiumModal:{promo:o.premiumModal.promo,isOpen:!1}},a)}),(0,w.aJ)("openPremiumModal",async(e,t,s)=>{const{initialSection:a,fromUserId:o,isSuccess:n,isGift:i,monthsAmount:r,toUserId:d,gift:c,tabId:l=(0,u.g0)()}=s||{};t.loadPremiumStickers();const h=await(0,b.px)("fetchPremiumPromo");h&&(e=(0,w.mS)(),e=(0,M.w)(e,{premiumModal:{promo:h.promo,initialSection:a,isOpen:!0,fromUserId:o,toUserId:d,isGift:i,monthsAmount:r,isSuccess:n,gift:c}},l),(0,w.UF)(e),t.closeReactionPicker({tabId:l}))}),(0,w.aJ)("openGiveawayModal",async(e,t,s)=>{const{chatId:a,prepaidGiveaway:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;const r=await(0,b.px)("getPremiumGiftCodeOptions",{chat:i}),d=await(0,b.px)("fetchStarsGiveawayOptions");r&&d&&(e=(0,w.mS)(),e=(0,M.w)(e,{giveawayModal:{chatId:a,gifts:r,isOpen:!0,prepaidGiveaway:o,starOptions:d}},n),(0,w.UF)(e))}),(0,w.aJ)("openGiftModal",async(e,t,s)=>{const{forUserId:a,selectedResaleGift:o,tabId:n=(0,u.g0)()}=s;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:n});const i=await(0,b.px)("getPremiumGiftCodeOptions",{});i&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftModal:{forPeerId:a,gifts:i,selectedResaleGift:o}},n),(0,w.UF)(e))}),(0,w.aJ)("openStarsGiftModal",async(e,t,s)=>{const{forUserId:a,tabId:o=(0,u.g0)()}=s||{};if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:o});const n=await(0,b.px)("getStarsGiftOptions",{});e=(0,w.mS)(),e=(0,M.w)(e,{starsGiftModal:{isOpen:!0,forUserId:a,starsGiftOptions:n}},o),(0,w.UF)(e)}),(0,w.aJ)("validatePaymentPassword",async(e,t,s)=>{const{password:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("fetchTemporaryPaymentPassword",a);e=(0,w.mS)(),e=n?"error"in n?(0,A._$X)(e,{error:{messageKey:n.messageKey,field:"password"}},o):(0,A._$X)(e,{temporaryPassword:n,step:i.tn.Checkout},o):(0,A._$X)(e,{error:{messageKey:{key:"ErrorUnexpected"},field:"password"}},o),(0,w.UF)(e)}),(0,w.aJ)("openBoostModal",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n||!(0,y.WX)(n)&&!(0,y.Vs)(n))return;e=(0,M.w)(e,{boostModal:{chatId:a}},o),(0,w.UF)(e);const i=await(0,b.px)("fetchBoostStatus",{chat:n});if(!i)return void t.closeBoostModal({tabId:o});e=(0,w.mS)(),e=(0,M.w)(e,{boostModal:{chatId:a,boostStatus:i}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchMyBoosts");if(!r)return;e=(0,w.mS)();const d=(0,C.nTw)(e,o);d.boostModal&&(e=(0,M.w)(e,{boostModal:{...d.boostModal,myBoosts:r.boosts}},o),(0,w.UF)(e))}),(0,w.aJ)("openBoostStatistics",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;e=(0,M.w)(e,{boostStatistics:{chatId:a}},o),(0,w.UF)(e);const[i,r,d]=await Promise.all([(0,b.px)("fetchBoostList",{chat:n}),(0,b.px)("fetchBoostList",{chat:n,isGifts:!0}),(0,b.px)("fetchBoostStatus",{chat:n})]);if(e=(0,w.mS)(),!i||!r||!d)return e=(0,M.w)(e,{boostStatistics:void 0},o),void(0,w.UF)(e);e=(0,M.w)(e,{boostStatistics:{chatId:a,boostStatus:d,nextOffset:i.nextOffset,boosts:{count:i.count,list:i.boostList},giftedBoosts:{count:r?.count,list:r?.boostList}}},o),(0,w.UF)(e)}),(0,w.aJ)("openMonetizationStatistics",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;(0,C.hds)(e,a)&&(e=(0,M.w)(e,{monetizationStatistics:{chatId:a}},o),(0,w.UF)(e))}),(0,w.aJ)("loadMoreBoosters",async(e,t,s)=>{const{isGifts:a,tabId:o=(0,u.g0)()}=s||{};let n=(0,C.nTw)(e,o);if(!n.boostStatistics)return;const i=(0,C.hds)(e,n.boostStatistics.chatId);if(!i)return;e=(0,M.w)(e,{boostStatistics:{...n.boostStatistics,isLoadingBoosters:!0}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchBoostList",{chat:i,offset:n.boostStatistics.nextOffset,isGifts:a});if(!r)return;if(e=(0,w.mS)(),n=(0,C.nTw)(e,o),!n.boostStatistics)return;const d=(a?n.boostStatistics.giftedBoosts?.list||[]:n.boostStatistics.boosts?.list||[]).concat(r.boostList);e=(0,M.w)(e,{boostStatistics:{...n.boostStatistics,nextOffset:r.nextOffset,isLoadingBoosters:!1,[a?"giftedBoosts":"boosts"]:{count:r.count,list:d}}},o),(0,w.UF)(e)}),(0,w.aJ)("applyBoost",async(e,t,s)=>{const{chatId:a,slots:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;const r=(0,C.AWZ)(e,a),d=r?.boostsApplied||0,c=o.length;let l=(0,C.nTw)(e,n);const h=l.boostModal?.boostStatus;if(h){const t=h.nextLevelBoosts?h.nextLevelBoosts-h.currentLevelBoosts:1,s=h.boosts+c,a=h.nextLevelBoosts&&s>=h.nextLevelBoosts,o=a?h.nextLevelBoosts:h.currentLevelBoosts,i=a?h.nextLevelBoosts+t:h.nextLevelBoosts;e=(0,M.w)(e,{boostModal:{...l.boostModal,boostStatus:{...h,level:a?h.level+1:h.level,currentLevelBoosts:o,nextLevelBoosts:i,hasMyBoost:!0,boosts:s}}},n),(0,w.UF)(e)}e=(0,w.mS)(),l=(0,C.nTw)(e,n);const m=l.boostModal?.myBoosts;if(m){const t=(0,v.Fm)(),s=m.map(e=>o.includes(e.slot)?{...e,chatId:a,date:t,cooldownUntil:t+86400}:e);e=(0,M.w)(e,{boostModal:{...l.boostModal,myBoosts:s}},n),(0,w.UF)(e)}const p=await(0,b.px)("applyBoost",{slots:o,chat:i});if(e=(0,w.mS)(),p)l=(0,C.nTw)(e,n),r&&(e=(0,A.ltr)(e,a,{boostsApplied:d+o.length})),l.boostModal&&(e=(0,M.w)(e,{boostModal:{...l.boostModal,myBoosts:p.boosts}},n)),(0,w.UF)(e);else{const t=(0,C.nTw)(e,n).boostModal;t&&(e=(0,M.w)(e,{boostModal:{...t,boostStatus:h,myBoosts:m}},n),(0,w.UF)(e))}}),(0,w.aJ)("checkGiftCode",async(e,t,s)=>{const{slug:a,message:o,tabId:n=(0,u.g0)()}=s,i=await(0,b.px)("checkGiftCode",{slug:a});i?(e=(0,w.mS)(),e=(0,M.w)(e,{giftCodeModal:{slug:a,info:i.code,message:o}},n),(0,w.UF)(e)):t.showNotification({message:f.yE("lng_gift_link_expired"),tabId:n})}),(0,w.aJ)("applyGiftCode",async(e,t,s)=>{const{slug:a,tabId:o=(0,u.g0)()}=s;await(0,b.px)("applyGiftCode",{slug:a})&&(t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftCodeModal({tabId:o}))}),(0,w.aJ)("launchPrepaidGiveaway",async(e,t,s)=>{const{chatId:a,giveawayId:o,paymentPurpose:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a);if(!r)return;const d=n?.additionalChannelIds?.map(t=>(0,C.hds)(e,t)).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"giveaway",chat:r,areWinnersVisible:n?.areWinnersVisible,additionalChannels:d,countries:n?.countries,prizeDescription:n.prizeDescription,untilDate:n.untilDate,currency:n.currency,amount:n.amount}})&&t.openBoostStatistics({chatId:a,tabId:i})}),(0,w.aJ)("launchPrepaidStarsGiveaway",async(e,t,s)=>{const{chatId:a,giveawayId:o,paymentPurpose:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a);if(!r)return;const d=n?.additionalChannelIds?.map(t=>(0,C.hds)(e,t)).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"starsgiveaway",chat:r,areWinnersVisible:n?.areWinnersVisible,additionalChannels:d,countries:n?.countries,prizeDescription:n.prizeDescription,untilDate:n.untilDate,currency:n.currency,amount:n.amount,stars:n.stars,users:n.users}})&&t.openBoostStatistics({chatId:a,tabId:i})}),(0,w.aJ)("upgradeGift",async(e,t,s)=>{const{gift:a,shouldKeepOriginalDetails:o,upgradeStars:n,tabId:i=(0,u.g0)()}=s,r=(0,Xe.HT)(e,a);if(r){if(e=(0,M.w)(e,{isWaitingForStarGiftUpgrade:!0},i),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftUpgradeModal({tabId:i}),t.closeGiftInfoModal({tabId:i}),!n){const s=await(0,b.px)("upgradeStarGift",{inputSavedGift:r,shouldKeepOriginalDetails:o||void 0});return e=(0,w.mS)(),void(s&&e.currentUserId&&t.reloadPeerSavedGifts({peerId:e.currentUserId}))}Qe(e,{type:"stargiftUpgrade",inputSavedGift:a,shouldKeepOriginalDetails:o||void 0},n,i)}}),(0,w.aJ)("transferGift",(e,t,s)=>{const{gift:a,recipientId:o,transferStars:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,o),d=(0,Xe.HT)(e,a);r&&d&&(e=(0,M.w)(e,{isWaitingForStarGiftTransfer:!0},i),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftTransferModal({tabId:i}),t.closeGiftInfoModal({tabId:i}),n?Qe(e,{type:"stargiftTransfer",inputSavedGift:a,recipientId:o},n,i):(0,b.px)("transferStarGift",{inputSavedGift:d,toPeer:r}))}),(0,w.aJ)("openUniqueGiftBySlug",async(e,t,s)=>{const{slug:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("fetchUniqueStarGift",{slug:a});n?t.openGiftInfoModal({gift:n,tabId:o}):t.showNotification({message:{key:"GiftWasNotFound"},tabId:o})}),(0,w.aJ)("processStarGiftWithdrawal",async(e,t,s)=>{const{gift:a,password:o,tabId:n=(0,u.g0)()}=s;let i=(0,C.nTw)(e,n).giftWithdrawModal;if(!i)return;e=(0,M.w)(e,{giftWithdrawModal:{...i,isLoading:!0,errorKey:void 0}},n),(0,w.UF)(e);const r=(0,Xe.HT)(e,a);if(!r)return;const d=await(0,b.px)("fetchStarGiftWithdrawalUrl",{inputGift:r,password:o});if(d&&(e=(0,w.mS)(),i=(0,C.nTw)(e,n).giftWithdrawModal,i)){if("error"in d)return e=(0,M.w)(e,{giftWithdrawModal:{...i,isLoading:!1,errorKey:d.messageKey}},n),void(0,w.UF)(e);t.openUrl({url:d.url,tabId:n}),t.closeGiftWithdrawModal({tabId:n})}});var et=s(13235);(0,w.aJ)("loadStarStatus",async e=>{const t=e.stars,s=!t?.topupOptions,[o,n,i]=await Promise.all([(0,b.px)("fetchStarsStatus"),(0,b.px)("fetchStarsStatus",{isTon:!0}),s?(0,b.px)("fetchStarsTopupOptions"):void 0]);!o&&!n||s&&!i||(e=(0,w.mS)(),o&&o.balance.currency===a.OUy&&(e={...e,stars:{...t,balance:o.balance,topupOptions:i||t.topupOptions,history:{all:void 0,inbound:void 0,outbound:void 0},subscriptions:void 0}},o.history&&(e=(0,A.Psh)(e,"all",o.history,o.nextHistoryOffset)),o.subscriptions&&(e=(0,A.qEh)(e,o.subscriptions,o.nextSubscriptionOffset))),n?.balance.currency===a.ykW&&(e={...e,ton:{...n,balance:n.balance,history:{all:void 0,inbound:void 0,outbound:void 0}}},e=(0,A.L_F)(e,n.balance),n.history&&(e=(0,A.Psh)(e,"all",n.history,n.nextHistoryOffset,!0))),(0,w.UF)(e))}),(0,w.aJ)("loadStarsTransactions",async(e,t,s)=>{const{type:a,isTon:o}=s,n=o?e.ton?.history[a]:e.stars?.history[a],i=n?.nextOffset;if(n&&!i)return;const r=await(0,b.px)("fetchStarsTransactions",{isInbound:"inbound"===a,isOutbound:"outbound"===a,offset:i||"",isTon:o});r&&(e=(0,w.mS)(),e=(0,A.L_F)(e,r.balance),r.history&&(e=(0,A.Psh)(e,a,r.history,r.nextOffset,o)),(0,w.UF)(e))}),(0,w.aJ)("loadStarGifts",async e=>{const t=await(0,b.px)("fetchStarGifts");if(!t)return;e=(0,w.mS)();const s=(0,h.dU)(t.gifts,"id"),a={all:[],stock:[],limited:[],resale:[]},o=Object.keys(s),n=Object.values(s),i=n.map(e=>e.isLimited?e.id:void 0).filter(Boolean),r=n.map(e=>e.availabilityRemains||!e.availabilityTotal?e.id:void 0).filter(Boolean),d=n.map(e=>e.availabilityResale?e.id:void 0).filter(Boolean);a.all=o,a.limited=i,a.stock=r,a.resale=d,n.forEach(e=>{const t=e.stars;a[t]||(a[t]=[]),a[t].push(e.id)}),e={...e,starGifts:{byId:s,idsByCategory:a}},(0,w.UF)(e)}),(0,w.aJ)("updateResaleGiftsFilter",(e,t,s)=>{const{filter:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);e=(0,M.w)(e,{resaleGifts:{...n.resaleGifts,filter:a}},o),n.resaleGifts.giftId&&t.loadResaleGifts({giftId:n.resaleGifts.giftId,shouldRefresh:!0,tabId:o}),(0,w.UF)(e)}),(0,w.aJ)("loadResaleGifts",async(e,t,s)=>{const{giftId:a,shouldRefresh:o,tabId:n=(0,u.g0)()}=s;let i=(0,C.nTw)(e,n);if(i.resaleGifts.isLoading||i.resaleGifts.isAllLoaded&&!o)return;e=(0,M.w)(e,{resaleGifts:{...i.resaleGifts,isLoading:!0,...o&&{count:0,nextOffset:void 0,isAllLoaded:!1}}},n),(0,w.UF)(e),e=(0,w.mS)(),i=(0,C.nTw)(e,n);const r=i.resaleGifts.nextOffset,d=i.resaleGifts.attributesHash,c=i.resaleGifts.filter,l=await(0,b.px)("fetchResaleGifts",{giftId:a,offset:r,limit:et.bc,attributesHash:d,filter:c});if(!l)return;const{chats:m,users:p}=l;e=(0,w.mS)(),i=(0,C.nTw)(e,n);const g=i.resaleGifts.gifts,f=o?l.gifts:g.concat(l.gifts),I=i.resaleGifts.updateIteration,v=i.resaleGifts.giftId!==a||o?I+1:I;e=(0,M.w)(e,{resaleGifts:{...i.resaleGifts,giftId:a,count:l.count||i.resaleGifts.count,gifts:f,attributes:l.attributes||i.resaleGifts.attributes,counters:l.counters||i.resaleGifts.counters,attributesHash:l.attributesHash,nextOffset:l.nextOffset,isLoading:!1,isAllLoaded:!l.nextOffset,updateIteration:v}},n),e=(0,A.CKT)(e,(0,h.dU)(p,"id")),e=(0,A.h7P)(e,(0,h.dU)(m,"id")),(0,w.UF)(e)}),(0,w.aJ)("resetResaleGifts",(e,t,s)=>{const{tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);return(0,M.w)(e,{resaleGifts:{updateIteration:n.resaleGifts.updateIteration+1,filter:a.hYe,count:0,gifts:[]}},o)}),(0,w.aJ)("loadPeerSavedGifts",async(e,t,s)=>{const{peerId:a,shouldRefresh:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,a);if(!i)return;e=(0,w.mS)();const r=(0,C.FDg)(e,a,n),d=r?.nextOffset;if(!o&&r&&!d)return;const c=(0,C.w0X)(e,a,n),l=(0,C.B59)(e,a,n),h=await(0,b.px)("fetchSavedStarGifts",{peer:i,offset:o?"":d,filter:c,collectionId:"all"===l?void 0:l});e=(0,w.mS)();const m=(0,C.w0X)(e,a,n),p=(0,C.B59)(e,a,n);if(!h||p!==l||m!==c)return;const g=r&&!o?r.gifts.concat(h.gifts):h.gifts;e=(0,A.xOA)(e,a,g,h.nextOffset,n),(0,w.UF)(e)}),(0,w.aJ)("reloadPeerSavedGifts",(e,t,s)=>{const{peerId:a}=s;Object.values(e.byTabId).forEach(s=>{(0,C.FDg)(e,a,s.id)&&t.loadPeerSavedGifts({peerId:a,shouldRefresh:!0,tabId:s.id})})}),(0,w.aJ)("loadStarsSubscriptions",async e=>{const t=e.stars?.subscriptions,s=t?.nextOffset;if(t&&!s)return;e=(0,A.Yzx)(e,!0),(0,w.UF)(e);const o=await(0,b.px)("fetchStarsSubscriptions",{offset:s||""});o&&o.balance.currency===a.OUy&&(e=(0,w.mS)(),e=(0,A.L_F)(e,o.balance),e=(0,A.qEh)(e,o.subscriptions,o.nextOffset),(0,w.UF)(e))}),(0,w.aJ)("changeStarsSubscription",async(e,t,s)=>{const{peerId:a,id:o,isCancelled:n}=s,i=a?(0,C.PVB)(e,a):void 0;a&&!i||(await(0,b.px)("changeStarsSubscription",{peer:i,subscriptionId:o,isCancelled:n}),t.loadStarStatus())}),(0,w.aJ)("fulfillStarsSubscription",async(e,t,s)=>{const{peerId:a,id:o}=s,n=a?(0,C.PVB)(e,a):void 0;a&&!n||(await(0,b.px)("fulfillStarsSubscription",{peer:n,subscriptionId:o}),t.loadStarStatus())}),(0,w.aJ)("changeGiftVisibility",async(e,t,s)=>{const{gift:a,shouldUnsave:o,tabId:n=(0,u.g0)()}=s,i="user"===a.type?e.currentUserId:a.chatId,r=(0,Xe.HT)(e,a);if(!r)return;const d=(0,C.B59)(e,i,n),c=(0,C.nTw)(e,n).savedGifts.collectionsByPeerId[i]?.[d];if(c?.gifts?.length){const t=c.gifts.map(e=>e.inputGift&&(0,Xe.j6)(e.inputGift,a)?{...e,isUnsaved:o}:e);e=(0,A.xOA)(e,i,t,c.nextOffset,n),(0,w.UF)(e)}const l=await(0,b.px)("saveStarGift",{inputGift:r,shouldUnsave:o});if(e=(0,w.mS)(),!l)return e=(0,A.xOA)(e,i,c.gifts,c.nextOffset,n),void(0,w.UF)(e);Object.values(e.byTabId).forEach(s=>{(0,C.FDg)(e,i,n)&&t.loadPeerSavedGifts({peerId:i,shouldRefresh:!0,tabId:s.id})})}),(0,w.aJ)("convertGiftToStars",async(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,n=(0,Xe.HT)(e,a);if(!n)return;if(!await(0,b.px)("convertStarGift",{inputSavedGift:n}))return;const i="user"===a.type?e.currentUserId:a.chatId;Object.values(e.byTabId).forEach(s=>{(0,C.FDg)(e,i,s.id)&&t.loadPeerSavedGifts({peerId:i,shouldRefresh:!0,tabId:s.id})}),t.openStarsBalanceModal({tabId:o})}),(0,w.aJ)("openGiftUpgradeModal",async(e,t,s)=>{const{giftId:a,gift:o,peerId:n,tabId:i=(0,u.g0)()}=s,r=await(0,b.px)("fetchStarGiftUpgradePreview",{giftId:a});r&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftUpgradeModal:{recipientId:n,gift:o,sampleAttributes:r}},i),(0,w.UF)(e))}),(0,w.aJ)("toggleSavedGiftPinned",async(e,t,s)=>{const{gift:a,peerId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,o);if(!i)return;const r=(0,C.FDg)(e,o,n);if(!r)return;const d=e.appConfig.savedGiftPinLimit,c=r.gifts.filter(e=>e.isPinned),l=a.isPinned?c.filter(e=>e.gift.slug!==a.gift.slug):[...c,a],h=(d?l.slice(-d):l).map(t=>(0,Xe.HT)(e,t.inputGift)).filter(Boolean);await(0,b.px)("toggleSavedGiftPinned",{inputSavedGifts:h,peer:i})&&Object.values(e.byTabId).forEach(s=>{(0,C.FDg)(e,o,s.id)&&t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:s.id})})}),(0,w.aJ)("updateStarGiftPrice",async(e,t,s)=>{const{gift:a,price:o}=s,n=(0,Xe.HT)(e,a);n&&await(0,b.px)("updateStarGiftPrice",{inputSavedGift:n,price:o})&&t.reloadPeerSavedGifts({peerId:e.currentUserId})}),(0,w.aJ)("loadStarGiftCollections",async(e,t,s)=>{const{peerId:a,hash:o}=s,n=(0,C.PVB)(e,a);if(!n)return;const i=await(0,b.px)("fetchStarGiftCollections",{peer:n,hash:o});i&&(e=(0,w.mS)(),e=(0,A.thC)(e,a,i.collections),(0,w.UF)(e))});var tt=s(58554);let st=0;(0,w.aJ)("loadAvailableReactions",async e=>{const t=await(0,b.px)("fetchAvailableReactions");t&&(t.forEach(e=>{e.aroundAnimation&&tt.hd(`sticker${e.aroundAnimation.id}`,n.qZ.BlobUrl),e.centerIcon&&tt.hd(`sticker${e.centerIcon.id}`,n.qZ.BlobUrl),e.appearAnimation&&tt.hd(`sticker${e.appearAnimation.id}`,n.qZ.BlobUrl),e.selectAnimation&&tt.hd((0,y.mr)(e.selectAnimation,"full"),n.qZ.BlobUrl)}),e=(0,w.mS)(),e={...e,reactions:{...e.reactions,availableReactions:t}},(0,w.UF)(e),(0,Re.A)({action:"loadAvailableReactions",payload:void 0},a.npx))}),(0,w.aJ)("loadAvailableEffects",async e=>{const t=await(0,b.px)("fetchAvailableEffects");if(!t)return;const{effects:s,emojis:a,stickers:o}=t,n=[],i=(0,h.dU)(s,"id");for(const e of s)if(e.effectAnimationId){const t={type:"emoji",emoticon:e.emoticon};n.push(t)}e=(0,w.mS)(),e={...e,availableEffectById:i,stickers:{...e.stickers,effect:{stickers:o,emojis:a}},reactions:{...e.reactions,effectReactions:n}},(0,w.UF)(e)}),(0,w.aJ)("interactWithAnimatedEmoji",(e,t,s)=>{const{emoji:a,x:o,y:n,startSize:i,isReversed:r,tabId:d=(0,u.g0)()}=s,c={id:st++,animatedEffect:a,x:O(e,o)+40*Math.random()-20,y:n+40*Math.random()-20,startSize:i,isReversed:r};return(0,M.w)(e,{activeEmojiInteractions:[...(0,C.nTw)(e,d).activeEmojiInteractions||[],c]},d)}),(0,w.aJ)("sendEmojiInteraction",(e,t,s)=>{const{messageId:a,chatId:o,emoji:n,interactions:i}=s;if("connectionStateReady"!==e.connectionState)return;const r=(0,C.hds)(e,o);r&&n&&!(0,C.nZ4)(e,o)&&(0,b.px)("sendEmojiInteraction",{chat:r,messageId:a,emoticon:n,timestamps:i})}),(0,w.aJ)("sendDefaultReaction",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.nTJ)(e,a),r=(0,C.O5q)(e,a,o);i&&r&&!(0,y.Nb)(r)&&t.toggleReaction({chatId:a,messageId:o,reaction:i,tabId:n})}),(0,w.aJ)("toggleReaction",async(e,t,s)=>{const{chatId:a,reaction:o,shouldAddToRecent:n,tabId:i=(0,u.g0)()}=s;let{messageId:r}=s;const d=(0,C.hds)(e,a);let c=(0,C.O5q)(e,a,r);if(!d||!c)return;const l=(0,C.nZ4)(e,a),p=Boolean(c.groupedId)&&!c.isInAlbum,g=p?(0,C.D_S)(e,a,c.groupedId)[0]:void 0;c=p&&(0,C.O5q)(e,a,g)||c,r=c?.id||r;const f=(0,y.uC)(c),I=f.some(e=>(0,y.a0)(e,o)),v=I?f.filter(e=>!(0,y.a0)(e,o)):[...f,o],S=(0,C.cO5)(e),[A,M]=(0,h.jB)(v,e=>"paid"===e.type),P=M.slice(-S),k=[...A,...P],F=(0,m.bj)(c);(0,C.xYJ)(e,"reactionEffects")&&(I?t.stopActiveReaction({containerId:F,reaction:o,tabId:i}):t.startActiveReaction({containerId:F,reaction:o,tabId:i})),e=G(e,c,k),(0,w.UF)(e);try{await(0,b.px)("sendReaction",{chat:d,messageId:r,reactions:P,shouldAddToRecent:n}),l&&t.loadSavedReactionTags()}catch(t){e=G(e=(0,w.mS)(),c,f),(0,w.UF)(e)}}),(0,w.aJ)("addLocalPaidReaction",(e,t,s)=>{const{chatId:a,messageId:o,count:n,shouldIgnoreDefaultPrivacy:i=!1,tabId:r=(0,u.g0)()}=s,d=e.settings.paidReactionPrivacy,c=i?s.isPrivate:"anonymous"===d?.type,l=i?s.peerId:"peer"===d?.type?d.peerId:void 0,h=(0,C.hds)(e,a),p=(0,C.O5q)(e,a,o);if(!h||!p)return;const g=p.reactions?.results||[],f=(0,y.Ny)(g,n,c,l);e=(0,A.r3y)(e,p.chatId,p.id,{reactions:{...g,results:f}}),(0,w.UF)(e);const I=(0,m.bj)(p);(0,C.xYJ)(e,"reactionEffects")&&t.startActiveReaction({containerId:I,reaction:{type:"paid"},tabId:r})}),(0,w.aJ)("sendPaidReaction",async(e,t,s)=>{const{chatId:a,messageId:o,forcedAmount:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a),d=(0,C.O5q)(e,a,o);if(!r||!d)return;const c=d.reactions?.results?.find(e=>"paid"===e.reaction.type),l=n||c?.localAmount||0;if(l){t.resetLocalPaidReactions({chatId:a,messageId:o});try{await(0,b.px)("sendPaidReaction",{chat:r,messageId:o,count:l,isPrivate:c?.localIsPrivate,peerId:c?.localPeerId})}catch(e){"BALANCE_TOO_LOW"===e.message&&t.openStarsBalanceModal({originReaction:{chatId:a,messageId:o,amount:l},tabId:i})}}}),(0,w.aJ)("startActiveReaction",(e,t,s)=>{const{containerId:a,reaction:o,tabId:n=(0,u.g0)()}=s,i=(0,C.nTw)(e,n);if(!(0,C.xYJ)(e,"reactionEffects"))return;const r=i.activeReactions[a]||[];if(r.some(e=>(0,y.a0)(e,o)))return;const d=r.concat(o);return(0,M.w)(e,{activeReactions:{...i.activeReactions,[a]:d}},n)}),(0,w.aJ)("stopActiveReaction",(e,t,s)=>{const{containerId:a,reaction:o,tabId:n=(0,u.g0)()}=s,i=(0,C.nTw)(e,n),r=i.activeReactions[a]||[],d=o?r.filter(e=>!(0,y.a0)(e,o)):[],c=d.length?{...i.activeReactions,[a]:d}:(0,h.cJ)(i.activeReactions,[a]);return(0,M.w)(e,{activeReactions:c},n)}),(0,w.aJ)("setDefaultReaction",async(e,t,s)=>{const{reaction:a}=s;await(0,b.px)("setDefaultReaction",{reaction:a})&&((e=(0,w.mS)()).config?(e={...e,config:{...e.config,defaultReaction:a}},(0,w.UF)(e)):t.loadConfig())}),(0,w.aJ)("stopActiveEmojiInteraction",(e,t,s)=>{const{id:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{activeEmojiInteractions:(0,C.nTw)(e,o).activeEmojiInteractions?.filter(e=>e.id!==a)},o)}),(0,w.aJ)("loadReactors",async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a,messageId:o,reaction:n}=s,i=(0,C.hds)(e,a),r=(0,C.O5q)(e,a,o);if(!i||!r)return;const d=r.reactors?.nextOffset,c=await(0,b.px)("fetchMessageReactionsList",{reaction:n,chat:i,messageId:o,offset:d});c&&(e=(0,w.mS)(),e=(0,A.r3y)(e,a,o,{reactors:c}),(0,w.UF)(e))}),(0,w.aJ)("loadMessageReactions",(e,t,s)=>{if((0,C.trm)(e))return;const{ids:a,chatId:o}=s,n=(0,C.hds)(e,o);n&&"connectionStateReady"===e.connectionState&&(0,b.px)("fetchMessageReactions",{ids:a,chat:n})}),(0,w.aJ)("sendWatchingEmojiInteraction",(e,t,s)=>{const{chatId:a,emoticon:o,x:n,y:i,startSize:r,isReversed:d,id:c,tabId:l=(0,u.g0)()}=s,h=(0,C.hds)(e,a),m=(0,C.nTw)(e,l);if(h&&m.activeEmojiInteractions?.some(e=>e.id===c)&&!(0,C.nZ4)(e,a))return"connectionStateReady"===e.connectionState&&(0,b.px)("sendWatchingEmojiInteraction",{chat:h,emoticon:o}),(0,M.w)(e,{activeEmojiInteractions:m.activeEmojiInteractions.map(t=>t.id===c?{...t,x:O(e,n),y:i,startSize:r,isReversed:d}:t)},l)}),(0,w.aJ)("fetchUnreadReactions",async(e,t,s)=>{const{chatId:a,offsetId:o}=s,n=(0,C.hds)(e,a);if(!n)return;const i=await(0,b.px)("fetchUnreadReactions",{chat:n,offsetId:o,addOffset:o?-1:void 0});if(!i||!i.messages.length)return e=V(e=(0,w.mS)(),a,{unreadReactionsCount:0}),void(0,w.UF)(e);const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number);e=(0,w.mS)(),e=V(e=(0,A.o4A)(e,n.id,d),a,{unreadReactions:(0,h.Am)([...n.unreadReactions||[],...c]).sort((e,t)=>t-e)}),(0,w.UF)(e)}),(0,w.aJ)("animateUnreadReaction",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,n=(0,C.meB)(e,o);if(!n)return;if(!n.unreadReactionsCount)return V(e,n.id,{unreadReactions:[]});const i=Math.max(n.unreadReactionsCount-a.length,0),r=(n.unreadReactions||[]).filter(e=>!a.includes(e));e=V(e,n.id,{unreadReactions:r,unreadReactionsCount:i}),(0,w.UF)(e),t.markMessagesRead({messageIds:a,shouldFetchUnreadReactions:!0,tabId:o}),(0,C.xYJ)(e,"reactionEffects")&&(e=(0,w.mS)(),a.forEach(s=>{const a=(0,C.O5q)(e,n.id,s);if(!a)return;const{reaction:o,isOwn:i,isUnread:r}=a.reactions?.recentReactions?.[0]??{};if(o&&r&&!i){const e=(0,m.bj)(a);t.startActiveReaction({containerId:e,reaction:o,tabId:(0,u.g0)()})}}))}),(0,w.aJ)("focusNextReaction",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.meB)(e,a);if(!o?.unreadReactions)return o?.unreadReactionsCount?(0,A.wix)(e,o.id,{unreadReactionsCount:0}):void 0;t.focusMessage({chatId:o.id,messageId:o.unreadReactions[0],tabId:a,scrollTargetPosition:"end"}),t.markMessagesRead({messageIds:[o.unreadReactions[0]],tabId:a})}),(0,w.aJ)("readAllReactions",(e,t,s)=>{const{chatId:a,threadId:o=n.l3}=s,i=(0,C.hds)(e,a);if(i)return(0,b.px)("readAllReactions",{chat:i,threadId:o===n.l3?void 0:o}),o===n.l3?V(e,i.id,{unreadReactionsCount:void 0,unreadReactions:void 0}):void 0}),(0,w.aJ)("loadTopReactions",async e=>{const t=await(0,b.px)("fetchTopReactions",{hash:e.reactions.hash.topReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,topReactions:t.reactions,hash:{...e.reactions.hash,topReactions:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("loadRecentReactions",async e=>{const t=await(0,b.px)("fetchRecentReactions",{hash:e.reactions.hash.recentReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:t.reactions,hash:{...e.reactions.hash,recentReactions:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("clearRecentReactions",async e=>{await(0,b.px)("clearRecentReactions")&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:[]}},(0,w.UF)(e))}),(0,w.aJ)("loadDefaultTagReactions",async e=>{const t=await(0,b.px)("fetchDefaultTagReactions",{hash:e.reactions.hash.defaultTags});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,defaultTags:t.reactions,hash:{...e.reactions.hash,defaultTags:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("loadSavedReactionTags",async e=>{const{hash:t}=e.savedReactionTags||{},s=await(0,b.px)("fetchSavedReactionTags",{hash:t});if(!s)return;e=(0,w.mS)();const a=(0,h.pA)(s.tags,e=>[(0,y.Jj)(e.reaction),e]);e={...e,savedReactionTags:{hash:s.hash,byKey:a}},(0,w.UF)(e)}),(0,w.aJ)("editSavedReactionTag",async(e,t,s)=>{const{reaction:a,title:o}=s;if(!await(0,b.px)("updateSavedReactionTag",{reaction:a,title:o}))return;e=(0,w.mS)();const n=e.savedReactionTags?.byKey;if(!n)return;const i=(0,y.Jj)(a),r={...n[i],title:o};e={...e,savedReactionTags:{...e.savedReactionTags,byKey:{...n,[i]:r}}},(0,w.UF)(e)}),(0,w.aJ)("loadStatistics",async(e,t,s)=>{const{chatId:a,isGroup:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=await(0,b.px)(o?"fetchGroupStatistics":"fetchChannelStatistics",{chat:i,dcId:r.statisticsDcId});if(!d)return;const{stats:c}=d;if(e=(0,w.mS)(),e=(0,A.n8l)(e,a,c,n),(0,w.UF)(e),"channel"===c.type){const e=c.recentPosts.filter(e=>"message"===e.type),s=c.recentPosts.filter(e=>"story"===e.type);e.length>0&&t.loadMessagesById({chatId:a,messageIds:e.map(e=>e.msgId)}),s.length>0&&t.loadPeerStoriesByIds({peerId:a,storyIds:s.map(e=>e.storyId)})}}),(0,w.aJ)("loadChannelMonetizationStatistics",async(e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.PVB)(e,a),i=(0,C.AWZ)(e,a);if(!n)return;const r=i?.statisticsDcId,d=await(0,b.px)("fetchChannelMonetizationStatistics",{peer:n,dcId:r});d&&(e=(0,w.mS)(),e=(0,A.$ry)(e,d,o),(0,w.UF)(e))}),(0,w.aJ)("loadMessageStatistics",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchMessageStatistics",{chat:i,messageId:o,dcId:d});c||(c={}),e=(0,w.mS)();const{viewsCount:l,forwardsCount:h,reactions:m}=(0,C.zeq)(e,a)[o]||{};c.viewsCount=l,c.forwardsCount=h,c.reactionsCount=m?.results?m?.results.reduce((e,t)=>e+t.count,0):void 0,e=(0,A.gJI)(e,c,n),(0,w.UF)(e),t.loadMessagePublicForwards({chatId:a,messageId:o,tabId:n})}),(0,w.aJ)("loadMessagePublicForwards",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,n).statistics.currentMessage||{};if(c?.publicForwards&&!c.nextOffset)return;const l=await(0,b.px)("fetchMessagePublicForwards",{chat:i,messageId:o,dcId:d,offset:c.nextOffset}),{forwards:h,nextOffset:m,count:p}=l||{};e=(0,w.mS)(),e=(0,A.gJI)(e,{...c,publicForwards:p||h?.length,publicForwardsData:(c.publicForwardsData||[]).concat(h||[]),nextOffset:m},n),(0,w.UF)(e)}),(0,w.aJ)("loadStatisticsAsyncGraph",async(e,t,s)=>{const{chatId:a,token:o,name:n,isPercentage:i,tabId:r=(0,u.g0)()}=s,d=(0,C.AWZ)(e,a);if(!d)return;const c=d.statisticsDcId,l=await(0,b.px)("fetchStatisticsAsyncGraph",{token:o,dcId:c,isPercentage:i});l&&(e=(0,w.mS)(),e=(0,A.RoI)(e,a,n,l,r),(0,w.UF)(e))}),(0,w.aJ)("loadStoryStatistics",async(e,t,s)=>{const{chatId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchStoryStatistics",{chat:i,storyId:o,dcId:d});c||(c={}),e=(0,w.mS)();const l=(0,C.Msb)(e,a,o),{forwardsCount:h=0,viewsCount:m=0,reactionsCount:p=0}=l&&"views"in l&&l.views?l.views:{};c.viewsCount=m,c.forwardsCount=h,c.reactionsCount=p,e=(0,w.mS)(),e=(0,A.KXe)(e,c,n),(0,w.UF)(e),t.loadStoryPublicForwards({chatId:a,storyId:o,tabId:n})}),(0,w.aJ)("loadStoryPublicForwards",async(e,t,s)=>{const{chatId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,n).statistics.currentStory||{};if(c?.publicForwards&&!c.nextOffset)return;const{publicForwards:l,count:h,nextOffset:m}=await(0,b.px)("fetchStoryPublicForwards",{chat:i,storyId:o,dcId:d,offset:c.nextOffset})||{};e=(0,w.mS)(),e=(0,A.KXe)(e,{...c,publicForwards:h||l?.length,publicForwardsData:(c.publicForwardsData||[]).concat(l||[]),nextOffset:m},n),(0,w.UF)(e)}),(0,w.aJ)("processMonetizationRevenueWithdrawalUrl",async(e,t,s)=>{const{peerId:a,currentPassword:o,tabId:n=(0,u.g0)()}=s;e=(0,A.Zct)(e,{isLoading:!0},n),(0,w.UF)(e);const i=(0,C.PVB)(e,a);if(!i)return;const r=await(0,b.px)("fetchMonetizationRevenueWithdrawalUrl",{peer:i,currentPassword:o});r&&(e=(0,w.mS)(),e=(0,A.Zct)(e,{isLoading:!1,errorKey:"error"in r?r.messageKey:void 0},n),(0,w.UF)(e),"url"in r&&(t.openUrl({url:r.url,tabId:n,ignoreDeepLinks:!0}),t.closeMonetizationVerificationModal({tabId:n})))});var at=s(1903);(0,w.aJ)("loadAllStories",async e=>{let t=0;for(;e.stories.hasNext;){if(t++>=100)return void(a.Oig&&console.error("`actions/loadAllStories`: Infinite loop detected"));e=(0,w.mS)();const{stateHash:s,hasNext:o}=e.stories;if(s&&!o)return;const n=await(0,b.px)("fetchAllStories",{isFirstRequest:!s,stateHash:s});if(!n)return;(e=(0,w.mS)()).stories.stateHash=n.state,"peerStories"in n&&(e=(0,A.Niu)(e,n.peerStories),e=(0,A.Gzl)(e,n.peerStories),(e=(0,A.qsx)(e,n.stealthMode)).stories.hasNext=n.hasMore),(0,w.UF)(e)}}),(0,w.aJ)("loadAllHiddenStories",async e=>{let t=0;for(;e.stories.hasNextInArchive;){if(t++>=100)return void(a.Oig&&console.error("`actions/loadAllHiddenStories`: Infinite loop detected"));e=(0,w.mS)();const{archiveStateHash:s,hasNextInArchive:o}=e.stories;if(s&&!o)return;const n=await(0,b.px)("fetchAllStories",{isFirstRequest:!s,stateHash:s,isHidden:!0});if(!n)return;(e=(0,w.mS)()).stories.archiveStateHash=n.state,"peerStories"in n&&(e=(0,A.Niu)(e,n.peerStories),e=(0,A.Gzl)(e,n.peerStories),(e=(0,A.qsx)(e,n.stealthMode)).stories.hasNextInArchive=n.hasMore),(0,w.UF)(e)}}),(0,w.aJ)("loadPeerSkippedStories",async(e,t,s)=>{const{peerId:a}=s,o=(0,C.PVB)(e,a),n=(0,C._bp)(e,a);if(!o||!n)return;const i=Object.values(n.byId).reduce((e,t)=>("content"in t||e.push(t.id),e),[]);if(0===i.length)return;const r=await(0,b.px)("fetchPeerStoriesByIds",{peer:o,ids:i});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,r.stories,r.pinnedIds),(0,w.UF)(e))}),(0,w.aJ)("viewStory",async(e,t,s)=>{const{peerId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,a),r=(0,C.Msb)(e,a,o);if(!i||!r||!("content"in r))return;e=(0,A.SYp)(e,a,o,n),(0,w.UF)(e);const d=(0,v.Fm)();r.expireDate<d&&r.isInProfile&&(0,b.px)("viewStory",{peer:i,storyId:o}),(e.stories.byPeerId[a].lastReadId||0)<r.id&&await(0,b.px)("markStoryRead",{peer:i,storyId:o})&&(e=(0,w.mS)(),e=(0,A.Ahb)(e,a,o),(0,w.UF)(e))}),(0,w.aJ)("deleteStory",async(e,t,s)=>{const{peerId:a,storyId:o}=s,n=(0,C.PVB)(e,a);n&&await(0,b.px)("deleteStory",{peer:n,storyId:o})&&(e=(0,w.mS)(),e=(0,A.ONz)(e,a,o),(0,w.UF)(e))}),(0,w.aJ)("toggleStoryInProfile",async(e,t,s)=>{const{peerId:a,storyId:o,isInProfile:n}=s,i=(0,C.PVB)(e,a);if(!i)return;const r=(0,C.Msb)(e,a,o),d=r&&"content"in r?r.isInProfile:void 0;e=(0,A.Xzz)(e,a,o,{isInProfile:n}),e=(0,A.KpR)(e,a,o,n),(0,w.UF)(e);const c=await(0,b.px)("toggleStoryInProfile",{peer:i,storyId:o,isInProfile:n});c?.length||(e=(0,w.mS)(),e=(0,A.Xzz)(e,a,o,{isInProfile:d}),e=(0,A.KpR)(e,a,o,d),(0,w.UF)(e))}),(0,w.aJ)("toggleStoryPinnedToTop",async(e,t,s)=>{const{peerId:a,storyId:o}=s,n=(0,C.PVB)(e,a),i=(0,C._bp)(e,a);if(!n||!i)return;const r=(0,C.gVx)(e,a)?.map(e=>e.id)||[],d=r.includes(o)?r.filter(e=>e!==o):[...r,o];e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[a]:{...i,pinnedIds:d.sort((e,t)=>t-e)}}}},(0,w.UF)(e),await(0,b.px)("toggleStoryPinnedToTop",{peer:n,storyIds:d})||(e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[a]:{...i,pinnedIds:r}}}},(0,w.UF)(e))}),(0,w.aJ)("loadPeerStories",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;const n=await(0,b.px)("fetchPeerStories",{peer:o});n&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,n.stories),n.lastReadStoryId&&(e=(0,A.Ahb)(e,a,n.lastReadStoryId)),(0,w.UF)(e))}),(0,w.aJ)("loadPeerProfileStories",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,offsetId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,a);let r=(0,C._bp)(e,a);if(!i||r?.isFullyLoaded)return;const d=(0,at.tW)(e,n);if("all"!==d){let t=r?.idsByAlbumId?.[d];if(t?.isFullyLoaded)return;const s=await(0,b.px)("fetchAlbumStories",{peer:i,albumId:d,offset:o||0});if(!s)return;return e=(0,w.mS)(),e=(0,A.K4v)(e,a,s.stories,s.pinnedIds,!1,d),r=(0,C._bp)(e,a),t=r?.idsByAlbumId?.[d],(0===Object.values(s.stories).length||t?.ids?.length&&t.ids.length>=s.count)&&(e=(0,A.oeX)(e,a,!0,!1,d)),void(0,w.UF)(e)}const c=await(0,b.px)("fetchPeerProfileStories",{peer:i,offsetId:o});c&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,c.stories,c.pinnedIds),r=(0,C._bp)(e,a),(0===Object.values(c.stories).length||r?.profileIds?.length&&r?.profileIds.length>=c.count)&&(e=(0,A.oeX)(e,a,!0)),(0,w.UF)(e))}),(0,w.aJ)("loadStoriesArchive",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,offsetId:o}=s,n=(0,C.PVB)(e,a);let i=(0,C._bp)(e,a);if(!n||i?.isArchiveFullyLoaded)return;const r=await(0,b.px)("fetchStoriesArchive",{peer:n,offsetId:o});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,r.stories,void 0,!0),i=(0,C._bp)(e,a),(0===Object.values(r.stories).length||i?.archiveIds?.length&&i?.archiveIds.length>=r.count)&&(e=(0,A.oeX)(e,a,!0,!0)),(0,w.UF)(e))}),(0,w.aJ)("loadPeerStoriesByIds",async(e,t,s)=>{const{peerId:a,storyIds:o}=s,n=(0,C.PVB)(e,a);if(!n)return;const i=await(0,b.px)("fetchPeerStoriesByIds",{peer:n,ids:o});i&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,i.stories),(0,w.UF)(e))}),(0,w.aJ)("loadStoryViews",async(e,t,s)=>{const{peerId:a,storyId:o}=s,n=(0,C.PVB)(e,a);if(!n)return;const i=await(0,b.px)("fetchStoriesViews",{peer:n,storyIds:[o]});i&&(e=(0,w.mS)(),e=(0,A.ZCo)(e,a,o,i.views),(0,w.UF)(e))}),(0,w.aJ)("loadStoryViewList",async(e,t,s)=>{const{peerId:a,storyId:o,offset:n,areReactionsFirst:i,areJustContacts:r,query:d,limit:c,tabId:l=(0,u.g0)()}=s,h=(0,C.PVB)(e,a);if(!h)return;e=(0,A.dxy)(e,!0,l),(0,w.UF)(e);const m=await(0,b.px)("fetchStoryViewList",{peer:h,storyId:o,offset:n,areReactionsFirst:i,areJustContacts:r,limit:c,query:d});if(!m)return e=(0,w.mS)(),e=(0,A.dxy)(e,!1,l),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.X5v)(e,o,m.views,m.nextOffset,l),(0,w.UF)(e)}),(0,w.aJ)("reportStory",async(e,t,s)=>{const{peerId:o,storyId:n,description:i="",option:r="",tabId:d=(0,u.g0)()}=s,c=(0,C.PVB)(e,o);if(!c)return;const l=await(0,b.px)("reportStory",{peer:c,storyId:n,description:i,option:r});if(!l)return;const{result:h,error:m}=l;if(m===a.zLi)return t.showNotification({message:(0,f.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===r),a={title:h.title,options:h.options,subtitle:s?.text};e=(0,M.w)(e,{reportModal:{messageIds:[n],subject:"story",peerId:o,description:i,sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===r),a={isOptional:h.isOptional,option:h.option,title:s?.text};e=(0,M.w)(e,{reportModal:{messageIds:[n],description:i,peerId:o,subject:"story",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}}}),(0,w.aJ)("editStoryPrivacy",(e,t,s)=>{const{peerId:a,storyId:o,privacy:n}=s,i=(0,C.PVB)(e,a);if(!i)return;const r=[...n.allowUserIds,...n.allowChatIds],d=[...n.blockUserIds,...n.blockChatIds],c=(0,y.wT)(e,{visibility:n.visibility,isUnspecified:n.isUnspecified,allowedIds:r,blockedIds:d,botsPrivacy:"none"});(0,b.px)("editStoryPrivacy",{peer:i,id:o,privacy:c})}),(0,w.aJ)("toggleStoriesHidden",async(e,t,s)=>{const{peerId:a,isHidden:o}=s,n=(0,C.PVB)(e,a);n&&await(0,b.px)("toggleStoriesHidden",{peer:n,isHidden:o})&&(e=(0,w.mS)(),e=(0,A.VWO)(e,a,o),(0,w.UF)(e))}),(0,w.aJ)("loadStoriesMaxIds",async(e,t,s)=>{const{peerIds:a}=s,o=a.map(t=>(0,C.PVB)(e,t)).filter(Boolean);if(!o.length)return;const n=await(0,b.px)("fetchStoriesMaxIds",{peers:o});if(!n)return;const i=[];e=(0,w.mS)(),n.forEach((t,s)=>{const a=o[s];e=(0,A.kTB)(e,a.id,{maxStoryId:t,hasStories:0!==t}),0!==t&&i.push(a.id)}),(0,w.UF)(e),i?.forEach(e=>t.loadPeerStories({peerId:e}))}),(0,w.aJ)("sendStoryReaction",async(e,t,s)=>{const{peerId:a,storyId:o,containerId:n,reaction:i,shouldAddToRecent:r,tabId:d=(0,u.g0)()}=s,c=(0,C.PVB)(e,a);if(!c)return;const l=(0,C.Msb)(e,a,o);if(!l||!("content"in l))return;const h=l.sentReaction;e=(0,A.k31)(e,a,o,i),(0,w.UF)(e),i?t.startActiveReaction({containerId:n,reaction:i,tabId:d}):t.stopActiveReaction({containerId:n,tabId:d});const m=await(0,b.px)("sendStoryReaction",{peer:c,storyId:o,reaction:i,shouldAddToRecent:r});e=(0,w.mS)(),m||(e=(0,A.k31)(e,a,o,h)),(0,w.UF)(e)}),(0,w.aJ)("activateStealthMode",(e,t,s)=>{const{isForPast:a=!0,isForFuture:o=!0}=s||{};(0,b.px)("activateStealthMode",{isForPast:a||!0,isForFuture:o||!0})}),(0,w.aJ)("loadStoryAlbums",async(e,t,s)=>{const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;const n=await(0,b.px)("fetchAlbums",{peer:o});n&&(e=(0,w.mS)(),e={...e,stories:{...e.stories,albumsByPeerId:{...e.stories.albumsByPeerId,[a]:n}}},(0,w.UF)(e))}),(0,w.aJ)("selectStoryAlbum",(e,t,s)=>{const{peerId:a,albumId:o,tabId:n=(0,u.g0)()}=s;o&&a&&(e=(0,A.oeX)(e,a,!1)),e=(0,M.w)(e,{selectedStoryAlbumId:o||void 0},n),(0,w.UF)(e),t.loadPeerProfileStories({peerId:a,tabId:n})}),(0,w.aJ)("loadAlbumStories",async(e,t,s)=>{const{peerId:a,albumId:o,offsetId:n}=s,i=(0,C.PVB)(e,a);if(!i)return;const r=await(0,b.px)("fetchAlbumStories",{peer:i,albumId:o,offset:n||0});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,r.stories,r.pinnedIds),(0,w.UF)(e))}),(0,w.aJ)("resetSelectedStoryAlbum",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{selectedStoryAlbumId:void 0},a)}),s(88742);var ot=s(66414);(0,w.aJ)("processOpenChatOrThread",(e,t,s)=>{const{chatId:a,threadId:o=n.l3,type:i="thread",shouldReplaceHistory:r=!1,shouldReplaceLast:d=!1,noForumTopicPanel:c,tabId:l=(0,u.g0)()}=s,h=(0,C.Xf0)(e,l),m=(0,C.nTw)(e,l);if(m.premiumModal?.promo&&m.premiumModal?.isOpen&&(e=(0,M.w)(e,{premiumModal:{...m.premiumModal,isOpen:!1}},l)),t.hideEffectInComposer({tabId:l}),t.closeStoryViewer({tabId:l}),t.closeStarsBalanceModal({tabId:l}),t.closeStarsTransactionModal({tabId:l}),t.closeGiftInfoModal({tabId:l}),h&&h.chatId===a&&h.threadId===o&&h.type===i||(a&&(e=(0,A.n4t)(e,a,o,"replyStack",[],l),e=(0,M.w)(e,{activeReactions:{},shouldPreventComposerAnimation:!0},l),e=(0,A._54)(e,a,o,l)),e=(0,A.T4Z)(e,l),e=(0,M.w)(e,{isStatisticsShown:!1,monetizationStatistics:void 0,boostStatistics:void 0,contentToBeScheduled:void 0,...a!==(0,C.nTw)(e,l).forwardMessages.toChatId&&{forwardMessages:{},isShareMessageModalShown:!1}},l)),a){const s=(0,C.hds)(e,a);s?.isForum&&!c?t.openForumPanel({chatId:a,tabId:l}):a!==(0,C.nTw)(e,l).forumPanelChatId&&t.closeForumPanel({tabId:l})}return t.updatePageTitle({tabId:l}),(0,A.MNF)(e,a,o,i,r,d,l)}),(0,w.aJ)("openChatInNewTab",(e,t,s)=>{const{chatId:a,threadId:o=n.l3}=s,i=(0,ot.dk)(a,"thread",o);window.open(i,"_blank")}),(0,w.aJ)("openPreviousChat",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return t.updatePageTitle({tabId:a}),(0,A.MNF)(e,void 0,void 0,void 0,void 0,void 0,a)}),(0,w.aJ)("openChatWithInfo",(e,t,s)=>{const{profileTab:a,forceScrollProfileTab:o=!1,tabId:n=(0,u.g0)()}=s;e=(0,M.w)(e,{...(0,C.nTw)(e,n),isChatInfoShown:!0,nextProfileTab:a,forceScrollProfileTab:o},n),e={...e,lastIsChatInfoShown:!0},(0,w.UF)(e),t.openChat({...s,tabId:n})}),(0,w.aJ)("openThreadWithInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;e=(0,M.w)(e,{...(0,C.nTw)(e,a),isChatInfoShown:!0},a),e={...e,lastIsChatInfoShown:!0},(0,w.UF)(e),t.openThread({...s,tabId:a})}),(0,w.aJ)("openChatWithDraft",(e,t,s)=>{const{chatId:a,text:o,threadId:i=n.l3,files:r,filter:d,tabId:c=(0,u.g0)()}=s;return a&&t.openThread({chatId:a,threadId:i,tabId:c}),(0,M.w)(e,{requestedDraft:{chatId:a,text:o,files:r,filter:d}},c)}),(0,w.aJ)("resetChatCreation",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatCreation:void 0},a)}),(0,w.aJ)("setNewChatMembersDialogState",(e,t,s)=>{const{newChatMembersProgress:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{newChatMembersProgress:a},o)}),(0,w.aJ)("openNextChat",(e,t,s)=>{const{targetIndexDelta:a,orderedIds:o,tabId:n=(0,u.g0)()}=s,{chatId:i}=(0,C.Xf0)(e,n)||{};if(!i)return void t.openChat({id:o[0],tabId:n});const r=o.indexOf(i);if(-1===r)return;const d=o[r+a];t.openChat({id:d,shouldReplaceHistory:!0,tabId:n})}),(0,w.aJ)("closeDeleteChatFolderModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{deleteFolderDialogModal:void 0},a)}),(0,w.aJ)("closeChatlistModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatlistModal:void 0},a)}),(0,w.aJ)("requestChatTranslation",(e,t,s)=>{const{chatId:a,toLanguageCode:o,tabId:n=(0,u.g0)()}=s;return(0,A.lcj)(e,a,o,n)}),(0,w.aJ)("closeChatInviteModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatInviteModal:void 0},a)}),(0,w.aJ)("openWebAppTab",(e,t,s)=>{const{webApp:a,tabId:o=(0,u.g0)()}=s;a&&(e=De(e=(0,w.mS)(),a,!0,!0,o),(0,w.UF)(e))}),(0,w.aJ)("updateWebApp",(e,t,s)=>{const{key:a,update:o,tabId:n=(0,u.g0)()}=s;return Ye(e,a,o,n)}),(0,w.aJ)("closeActiveWebApp",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return e=function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];let[o=(0,u.g0)()]=s;const n=(0,C.nTw)(e,o).webApps.activeWebAppKey;return n?Oe(e,n,!1,o):e}(e,a),Ge(e,a)?e:Ve(e,!1,a)}),(0,w.aJ)("openMoreAppsTab",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{webApps:{...o.webApps,activeWebAppKey:void 0,isMoreAppsTabActive:!0}},a)}),(0,w.aJ)("closeMoreAppsTab",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),n=o.webApps.openedWebApps,i=Object.keys(n),r=i.length;return(0,M.w)(e,{webApps:{...o.webApps,isMoreAppsTabActive:!1,activeWebAppKey:r?i[r-1]:void 0,isModalOpen:r>0}},a)}),(0,w.aJ)("closeWebApp",(e,t,s)=>{const{key:a,skipClosingConfirmation:o,tabId:n=(0,u.g0)()}=s||{};return Ge(e=Oe(e,a,o,n),n)?e:Ve(e,!1,n)}),(0,w.aJ)("closeWebAppModal",(e,t,s)=>{const{shouldSkipConfirmation:a,tabId:o=(0,u.g0)()}=s||{},n=!a&&!(0,je.l)(e).shouldSkipWebAppCloseConfirmation&&function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];let[o=(0,u.g0)()]=s;return Object.keys((0,C.nTw)(e,o).webApps.openedWebApps).length>1}(e,o);return n?(t.openWebAppsCloseConfirmationModal({tabId:o}),e):(e=function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];let[o=(0,u.g0)()]=s;const n=(0,C.nTw)(e,o),i=Object.fromEntries(Object.entries(n.webApps.openedWebApps).filter(e=>{let[,t]=e;return t.shouldConfirmClosing})),r=Object.values(i);if(!(r.length>0))return(0,M.w)(e,{webApps:{...n.webApps,activeWebAppKey:void 0,openedWebApps:{},openedOrderedKeys:[],sessionKeys:[]}},o);const d=(0,C.ES7)(e,o),c=d?.shouldConfirmClosing?d:r[0],l=(0,Je.rp)(c);l&&(i[l]={...c,isCloseModalOpen:!0});const h=n.webApps.openedOrderedKeys.filter(e=>i[e]);return(0,M.w)(e,{webApps:{...n.webApps,activeWebAppKey:l,isMoreAppsTabActive:!1,openedWebApps:i,openedOrderedKeys:h}},o)}(e,o),Ge(e,o)?e:Ve(e,!1,o))}),(0,w.aJ)("changeWebAppModalState",(e,t,s)=>{const{state:a,tabId:o=(0,u.g0)()}=s;return function(e,t){for(var s=arguments.length,a=new Array(s>2?s-2:0),o=2;o<s;o++)a[o-2]=arguments[o];let[n=(0,u.g0)()]=a;const i=(0,C.nTw)(e,n);return(0,M.w)(e,{webApps:{...i.webApps,modalState:t}},n)}(e,a,o)}),(0,w.aJ)("updateMiniAppCachedPosition",(e,t,s)=>{const{position:a}=s;return(0,A.qoo)(e,{miniAppsCachedPosition:a})}),(0,w.aJ)("updateMiniAppCachedSize",(e,t,s)=>{const{size:a}=s;return(0,A.qoo)(e,{miniAppsCachedSize:a})}),(0,w.aJ)("setWebAppPaymentSlug",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,o=(0,C.ES7)(e,a);if(o?.url)return Ye(e,(0,y.rp)(o),{slug:s.slug},a)}),(0,w.aJ)("cancelBotTrustRequest",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{botTrustRequest:void 0},a)}),(0,w.aJ)("markBotTrusted",(e,t,s)=>{const{botId:a,isWriteAllowed:o,tabId:n=(0,u.g0)()}=s,{trustedBotIds:i}=e,r=new Set(i);r.add(a),e={...e,trustedBotIds:Array.from(r)};const d=(0,C.nTw)(e,n);if(d.botTrustRequest?.onConfirm){const{action:e,payload:s}=d.botTrustRequest.onConfirm;t[e]({...s,isWriteAllowed:o})}e=(0,M.w)(e,{botTrustRequest:void 0},n),(0,w.UF)(e)}),(0,w.aJ)("sendWebAppEvent",(e,t,s)=>{const{event:a,webAppKey:o,tabId:n=(0,u.g0)()}=s,i=(0,C.wtp)(e,o,n);if(!i)return e;const r=i.plannedEvents?[...i.plannedEvents,a]:[a];return t.updateWebApp({key:o,update:{plannedEvents:r},tabId:n}),e}),(0,w.aJ)("cancelAttachBotInstall",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{requestedAttachBotInstall:void 0},a)}),(0,w.aJ)("requestAttachBotInChat",(e,t,s)=>{const{bot:a,filter:o,startParam:n,tabId:i=(0,u.g0)()}=s,r=(0,C.Xf0)(e,i)?.chatId,d=a.attachMenuPeerTypes?.filter(e=>"self"!==e&&o.includes(e));d?.length?(e=(0,M.w)(e,{requestedAttachBotInChat:{bot:a,filter:d,startParam:n}},i),(0,w.UF)(e)):t.callAttachBot({chatId:r||a.id,bot:a,startParam:n,tabId:i})}),(0,w.aJ)("cancelAttachBotInChat",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{requestedAttachBotInChat:void 0},a)}),(0,w.aJ)("openEmojiStatusAccessModal",(e,t,s)=>{const{bot:a,webAppKey:o,tabId:n=(0,u.g0)()}=s;a&&o&&(e=(0,w.mS)(),e=(0,M.w)(e,{emojiStatusAccessModal:{bot:a,webAppKey:o}},n),(0,w.UF)(e))}),(0,w.aJ)("closeEmojiStatusAccessModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{emojiStatusAccessModal:void 0},a)}),(0,w.aJ)("openLocationAccessModal",(e,t,s)=>{const{bot:a,webAppKey:o,tabId:n=(0,u.g0)()}=s;a&&o&&(e=(0,w.mS)(),e=(0,M.w)(e,{locationAccessModal:{bot:a,webAppKey:o}},n),(0,w.UF)(e))}),(0,w.aJ)("closeLocationAccessModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{locationAccessModal:void 0},a)});var nt=s(81954),it=s(80539),rt=s(3544);function dt(e,t){(0,w.aJ)(e,(e,s,a)=>{const{tabId:o=(0,u.g0)()}=a||{};return(0,M.w)(e,{[t]:void 0},o)})}var ct=s(49086),lt=s(86525),ut=s(56494);const ht=a.OzO+a.xB5;let mt;function pt(e,t,s){const{type:a,threadId:o}=(0,C.Xf0)(e)||{},n=(0,p.Yw)(),i=(0,C.hds)(e,t),r="scheduled"===a?(0,C.yFI)(e,t):(0,C.zeq)(e,t);if(!i||!r||!o)return;const d=s.map(e=>r[e]).filter(t=>(0,C.WAX)(e,t,o).canCopy).sort((e,t)=>e.id-t.id),l=[],u=[];d.forEach(t=>{const s=(0,y.WX)(i)?i:(0,C.Y7C)(e,t),a=`> ${s?(0,S.F9)(n,s):t.forwardInfo?.hiddenUserName||""}:`,o=(0,y.ni)(e,t);l.push(a),l.push(`${function(e,t){const s=(0,w.mS)(),a=(0,rt.Su)(t),o=a?`${a} `:"",n=(0,ct.V)({message:t,shouldRenderAsHtml:!0})?.join(""),i=(0,lt.ni)(s,t);return`${o}${(0,rt.oL)(e,t,i,n,!0)}`}(n,t)}\n`),u.push(a),u.push(`${(0,rt.dS)(n,t,o,!1,0,!0)}\n`)}),(0,c.A)(l.join("\n"),u.join("\n"))}(0,w.aJ)("setScrollOffset",(e,t,s)=>{const{chatId:a,threadId:o,scrollOffset:n,tabId:i=(0,u.g0)()}=s;return e=(0,A.eww)(e,a,o,"lastScrollOffset",n),(0,A.n4t)(e,a,o,"scrollOffset",n,i)}),(0,w.aJ)("setEditingId",(e,t,s)=>{const{messageId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Xf0)(e,o);if(!n)return;const{chatId:i,threadId:r,type:d}=n,c="scheduled"===d?"editingScheduledId":"editingId";return(0,A.eww)(e,i,r,c,a)}),(0,w.aJ)("setEditingDraft",(e,t,s)=>{const{text:a,chatId:o,threadId:n,type:i}=s,r="scheduled"===i?"editingScheduledDraft":"editingDraft";return(0,A.eww)(e,o,n,r,a)}),(0,w.aJ)("editLastMessage",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(!o||!n)return;const i=(0,C.zeq)(e,o),r=(0,C.rA3)(e,o,n,a);if(!i||!r)return;const d=(0,h.Uk)(r,t=>Boolean(i[t]&&(0,C.WAX)(e,i[t],n).canEdit));return d?(0,A.eww)(e,o,n,"editingId",d):void 0}),(0,w.aJ)("replyToNextMessage",(e,t,s)=>{const{targetIndexDelta:a,tabId:o=(0,u.g0)()}=s,{chatId:i,threadId:r}=(0,C.Xf0)(e,o)||{};if(!i||!r)return;const d=(0,C.zeq)(e,i),c=(0,C.rA3)(e,i,r,o);if(!d||!c)return;const l=(0,C.GA4)(e,i,r)?.replyInfo;let h;if((0,C.haw)(e,i,r,o)&&l?.replyToMsgId){const e=Object.keys(d),t=e.indexOf(l.replyToMsgId.toString())+a;h=t<=e.length+1&&t>=0?Number(e[t]):void 0}else if(r===n.l3)h=(0,C.ZZX)(e,i);else{const t=(0,C.Vw0)(e,i,r);h=t?.lastMessageId}t.updateDraftReplyInfo({replyToMsgId:h,replyToPeerId:void 0,quoteText:void 0,tabId:o}),t.focusMessage({chatId:i,threadId:r,messageId:h,tabId:o})}),(0,w.aJ)("openAudioPlayer",(e,t,s)=>{const{chatId:a,threadId:o,messageId:n,origin:i,volume:r,playbackRate:d,isMuted:c,timestamp:l,tabId:h=(0,u.g0)()}=s,m=(0,C.nTw)(e,h);return(0,M.w)(e,{audioPlayer:{chatId:a,threadId:o,messageId:n,timestamp:l,origin:i??m.audioPlayer.origin,volume:r??m.audioPlayer.volume,playbackRate:d||m.audioPlayer.playbackRate||e.audioPlayer.lastPlaybackRate,isPlaybackRateActive:void 0===m.audioPlayer.isPlaybackRateActive?e.audioPlayer.isLastPlaybackRateActive:m.audioPlayer.isPlaybackRateActive,isMuted:c||m.audioPlayer.isMuted}},h)}),(0,w.aJ)("setAudioPlayerVolume",(e,t,s)=>{const{volume:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,volume:a,isMuted:!1}},o)}),(0,w.aJ)("setAudioPlayerPlaybackRate",(e,t,s)=>{const{playbackRate:a,isPlaybackRateActive:o,tabId:n=(0,u.g0)()}=s;return e={...e,audioPlayer:{...e.audioPlayer,lastPlaybackRate:a,isLastPlaybackRateActive:o}},(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,n).audioPlayer,playbackRate:a,isPlaybackRateActive:o}},n)}),(0,w.aJ)("setAudioPlayerMuted",(e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,isMuted:a}},o)}),(0,w.aJ)("setAudioPlayerOrigin",(e,t,s)=>{const{origin:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,origin:a}},o)}),(0,w.aJ)("closeAudioPlayer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{audioPlayer:{volume:o.audioPlayer.volume,playbackRate:o.audioPlayer.playbackRate,isPlaybackRateActive:o.audioPlayer.isPlaybackRateActive,isMuted:o.audioPlayer.isMuted}},a)}),(0,w.aJ)("openPollResults",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.gjV)(e,(0,D.Ny)(),n),r=(0,C.nTw)(e,n);if(i){if(a!==r.pollResults.chatId||o!==r.pollResults.messageId)return(0,M.w)(e,{pollResults:{chatId:a,messageId:o,voters:{}}},n)}else window.setTimeout(()=>{e=(0,w.mS)(),e=(0,M.w)(e,{pollResults:{chatId:a,messageId:o,voters:{}}},n),(0,w.UF)(e)},450)}),(0,w.aJ)("closePollResults",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{pollResults:{}},a)}),(0,w.aJ)("focusLastMessage",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:i,threadId:r,type:d}=o,c=(0,y.cG)(i,r,e.currentUserId);let l;if(r===n.l3)if("pinned"===d){const t=(0,C.fcC)(e,i,n.l3);if(!t?.length)return;l=t[t.length-1]}else l=(0,C.ZZX)(e,i);else if(c)l=(0,C.ZZX)(e,String(r),"saved");else{const t=(0,C.Vw0)(e,i,r);l=t?.lastMessageId}l&&t.focusMessage({chatId:i,threadId:r,messageListType:d,messageId:l,noHighlight:!0,noForumTopicPanel:!0,tabId:a})}),(0,w.aJ)("focusNextReply",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:n,threadId:i}=o,r=(0,C.jp_)(e,n,i,a);if(r&&0!==r.length){const s=r.pop();e=(0,A.n4t)(e,n,i,"replyStack",[...r],a),(0,w.UF)(e),t.focusMessage({chatId:n,threadId:i,messageId:s,tabId:a,noForumTopicPanel:!0})}else t.focusLastMessage({tabId:a})}),(0,w.aJ)("focusMessage",(e,t,s)=>{const{chatId:a,threadId:o=n.l3,messageListType:r="thread",noHighlight:d,groupedId:c,groupedChatId:l,replyMessageId:m,isResizingContainer:p,shouldReplaceHistory:g,noForumTopicPanel:f,quote:I,quoteOffset:v,scrollTargetPosition:b,timestamp:y,tabId:S=(0,u.g0)()}=s;let{messageId:M}=s;if(!(0,C.hds)(e,a))return void t.showNotification({message:{key:"ErrorFocusInaccessibleMessage"},tabId:S});const P=y?()=>t.openMediaFromTimestamp({chatId:a,threadId:o,messageId:M,timestamp:y,tabId:S}):void 0;if(void 0!==c){const t=(0,C.VC8)(e,l,c);t?.length&&([M]=(0,h.oE)(t))}const k=(0,C.Xf0)(e,S),F=!k||a!==k.chatId||o!==k.threadId||r!==k.type;if(mt&&(clearTimeout(mt),mt=void 0),mt=window.setTimeout(()=>{e=(0,w.mS)(),e=(0,A.kV7)({global:e},S),e=(0,A.Xbp)(e,void 0,S),(0,w.UF)(e)},d?ht:1500),e=(0,A.kV7)({global:e,chatId:a,messageId:M,threadId:o,noHighlight:d,isResizingContainer:p,quote:I,quoteOffset:v,scrollTargetPosition:b},S),e=(0,A.Xbp)(e,void 0,S),m){const t=(0,C.jp_)(e,a,o,S)||[];e=(0,A.n4t)(e,a,o,"replyStack",[...t,m],S)}F&&(e=(0,A.Xbp)(e,i.CC.Static,S));const T=(0,C.rA3)(e,a,o,S);if(T&&T.includes(M))return(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:a,threadId:o,type:r,shouldReplaceHistory:g,noForumTopicPanel:f,tabId:S}),void P?.();if(F&&(e=(0,A.n4t)(e,a,o,"viewportIds",void 0,S)),T&&!F){const t=M>T[0]?i.CC.Down:i.CC.Up;e=(0,A.Xbp)(e,t,S)}(0,nt.o8)()&&(0,nt.H$)(),(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:a,threadId:o,type:r,shouldReplaceHistory:g,noForumTopicPanel:f,tabId:S}),t.loadViewportMessages({chatId:a,threadId:o,tabId:S,shouldForceRender:!0,onLoaded:P})}),(0,w.aJ)("setShouldPreventComposerAnimation",(e,t,s)=>{const{shouldPreventComposerAnimation:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{shouldPreventComposerAnimation:a},o)}),(0,w.aJ)("openReplyMenu",(e,t,s)=>{const{fromChatId:a,messageId:o,quoteText:n,quoteOffset:i,tabId:r=(0,u.g0)()}=s;return(0,M.w)(e,{replyingMessage:{fromChatId:a,messageId:o,quoteText:n,quoteOffset:i},isShareMessageModalShown:!0},r)}),(0,w.aJ)("openForwardMenu",(e,t,s)=>{const{fromChatId:a,messageIds:o,storyId:n,groupedId:i,withMyScore:r,tabId:d=(0,u.g0)()}=s;let c;return i&&(c=(0,C.D_S)(e,a,i)),(0,M.w)(e,{forwardMessages:{fromChatId:a,messageIds:c||o,storyId:n,withMyScore:r},isShareMessageModalShown:!0},d)}),(0,w.aJ)("changeRecipient",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,a).forwardMessages,toChatId:void 0,noAuthors:!1,noCaptions:!1},isShareMessageModalShown:!0},a)}),(0,w.aJ)("setForwardNoAuthors",(e,t,s)=>{const{noAuthors:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);return(0,M.w)(e,{forwardMessages:{...n.forwardMessages,noAuthors:a,noCaptions:a&&n.forwardMessages.noCaptions}},o)}),(0,w.aJ)("setForwardNoCaptions",(e,t,s)=>{const{noCaptions:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,o).forwardMessages,noCaptions:a,noAuthors:a}},o)}),(0,w.aJ)("exitForwardMode",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,M.w)(e,{isShareMessageModalShown:!1,forwardMessages:{},replyingMessage:{}},a),(0,w.UF)(e)}),(0,w.aJ)("openForwardMenuForSelectedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages,r=i.filter(t=>{const s=(0,C.O5q)(e,n,t);return s&&(0,C.R4s)(e,s)});r.length&&t.openForwardMenu({fromChatId:n,messageIds:r,tabId:a})}),(0,w.aJ)("cancelMediaDownload",(e,t,s)=>{const{media:a,tabId:o=(0,u.g0)()}=s,n=(0,y.VO)(a,"download");if(n)return(0,A.IwB)(e,[n],o)}),(0,w.aJ)("cancelMediaHashDownloads",(e,t,s)=>{const{mediaHashes:a,tabId:o=(0,u.g0)()}=s;return(0,A.IwB)(e,a,o)}),(0,w.aJ)("downloadMedia",(e,t,s)=>{const{media:a,originMessage:o,tabId:n=(0,u.g0)()}=s,i=(0,y.VO)(a,"download");if(!i)return;const r={size:"size"in a?a.size:0,format:(0,y.Cz)(a,"download"),filename:(0,y.sd)(a),originChatId:o?.chatId,originMessageId:o?.id};return(0,A.iRS)(e,i,r,n)}),(0,w.aJ)("downloadSelectedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages,{threadId:r}=(0,C.Xf0)(e,a)||{},d=(0,C.zeq)(e,n);d&&r&&i.map(e=>d[e]).filter(t=>(0,C.WAX)(e,t,r).canDownload).forEach(s=>{const o=(0,ut.iS)(e,s);o&&t.downloadMedia({media:o,originMessage:s,tabId:a})})}),(0,w.aJ)("enterMessageSelectMode",(e,t,s)=>{const{messageId:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.meB)(e,o);return n?(0,A.l3i)(e,n.id,a,o):e}),(0,w.aJ)("toggleMessageSelection",(e,t,s)=>{const{messageId:a,groupedId:o,childMessageIds:n,withShift:i,tabId:r=(0,u.g0)()}=s,c=(0,C.Xf0)(e,r);if(!c)return;const{chatId:l,threadId:h,type:m}=c;e=(0,A.yrN)(e,l,h,m,a,o,n,i,r),(0,w.UF)(e),e.shouldShowContextMenuHint&&(t.disableContextMenuHint(),t.showNotification({message:{key:d.TF?"ContextMenuHintTouch":"ContextMenuHintMouse"},tabId:r}))}),(0,w.aJ)("disableContextMenuHint",e=>{if(e.shouldShowContextMenuHint)return{...e,shouldShowContextMenuHint:!1}}),(0,w.aJ)("exitMessageSelectMode",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.T4Z)(e,a)}),(0,w.aJ)("openPollModal",(e,t,s)=>{const{isQuiz:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{pollModal:{isOpen:!0,isQuiz:a}},o)}),(0,w.aJ)("closePollModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{pollModal:{isOpen:!1}},a)}),(0,w.aJ)("openTodoListModal",(e,t,s)=>{const{chatId:a,messageId:o,forNewTask:n,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{todoListModal:{chatId:a,messageId:o,forNewTask:n}},i)}),dt("closeTodoListModal","todoListModal"),(0,w.aJ)("checkVersionNotification",(e,t)=>{if(a.cOD&&Date.now()>Number(a.cOD)+2592e5)return;const s="10.9.73".split(".").slice(0,2).join("."),{serviceNotifications:o}=e;if(o.find(e=>{let{version:t}=e;return t===s}))return;const n={chatId:a.zv8,date:(0,v.Fm)(),content:{text:(0,it.Ay)("**Telegram Web A Digest**\n\nMany new features and useful optimizations have been added in recent months. Here is a brief overview of what's been happening in Web A since August.\n\n**September – November** \n\n✏️ __General__\n• [Reply Revolution](https://telegram.org/blog/reply-revolution#reply-revolution) – the app learned to quote specific parts of any message, making your responses 100% precise.\n• Also, [Quote Formatting](https://telegram.org/blog/reply-revolution#quote-formatting) have arrived.\n\n📣 __Channels__\n• Channels added [boosts](https://telegram.org/blog/channel-stories#stories-for-channels) and [giveaways.](https://telegram.org/blog/giveaways#free-telegram-premium) \n• Users also got an option to reassign their boosts between channels.\n\n🌄 __Stories__\n• Numerous improvements have been made to the animations flow, ensuring the stories bar expands more smoothly. Additionally, a package of optimizations has been added to enhance the performance of stories on mobile devices.\n• Stories have been introduced for [channels,](https://telegram.org/blog/channel-stories#stories-for-channels) and the story viewer has been updated with new gestures to expand and reply.\n\n⚙️ __Settings__\n• The app has added an option, 'Who can find me by phone number,' along with a setting under 'Privacy and Security' to manage the visibility of your bio.\n\n✨ __Extra__\n• Some further improvements have been made to the Mini Apps area.\n• New security notifications have been added to the chat list to alert you when your account is logged into from a new device.\n• New design for code blocks formatting.\n\n**December – February**\n\n✏️ __General__\n• [Saved Messages 2.0](https://telegram.org/blog/new-saved-messages-and-9-more#saved-messages-2-0) – including tags, My Notes, Replies and forwards from hidden authors.\n• [One-Time Voice Messages](https://telegram.org/blog/new-saved-messages-and-9-more#one-time-voice-and-video-messages) including both listening and recording. Added support for viewing One-Time Video Messages.\n• [Read-Time in Private Chats](https://telegram.org/blog/new-saved-messages-and-9-more#read-time-in-private-chats)\n• You can now replace media when editing messages.\n• The app learned to [preserve the selected mode](https://telegram.org/blog/similar-channels#improvements-for-topics) for topics in groups.\n• Whenever you create a small group, Web A suggests a name for it based on users' name you have added.\n\n📣 __Channels__ \n• Added [custom channel reactions.](https://telegram.org/blog/similar-channels#custom-reactions-for-channels)\n• Implemented [channel stories stats.](https://telegram.org/blog/similar-channels#story-stats-for-channels)\n• Channel emoji statuses.\n• [Similar Channels.](https://telegram.org/blog/similar-channels#similar-channels)\n\n👥 __Groups__\n• [9 new features for groups.](https://telegram.org/blog/february2024)\n\n🤖 __Bots__\n• Edit your bots info right from their profile.\n\n🌄 __Stories__\n• Added support for [forwarded stories](https://telegram.org/blog/posts-in-stories-and-more#view-reposts-and-more) and [channel posts in stories.](https://telegram.org/blog/posts-in-stories-and-more#share-posts-in-stories)\n\n✨ __Extra__\n• Giveaway Improvements: displaying winners list and additional prizes.\n\n**March**\n\n📣 __Channels__ \n• Admins will soon be able to launch giveaways in their channels.\n\n✨ __Extra__\n• Added support for Emoji v15.1.\n• Some design enhancements for shared contacts, links preview and more.\n",!0)},isOutgoing:!1};t.createServiceNotification({message:n,version:s})}),(0,w.aJ)("createServiceNotification",(e,t,s)=>{const{message:o,version:n}=s,{serviceNotifications:i}=e,r=Math.max((0,C.ZZX)(e,a.zv8)||0,...i.map(e=>{let{id:t}=e;return t})),d=(i.length+1)/1e3,c=Math.floor(r)+d;o.previousLocalId=o.id,o.id=c;const l={id:c,message:o,version:n,isUnread:!0};e={...e,serviceNotifications:[...i.slice(-1e3),l]},(0,w.UF)(e),t.apiUpdate({"@type":"newMessage",id:o.id,chatId:o.chatId,message:o})}),(0,w.aJ)("openReactorListModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{reactorModal:{chatId:a,messageId:o}},n)}),(0,w.aJ)("closeReactorListModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{reactorModal:void 0},a)}),(0,w.aJ)("openSeenByModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{seenByModal:{chatId:a,messageId:o}},n)}),(0,w.aJ)("closeSeenByModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{seenByModal:void 0},a)}),(0,w.aJ)("openPrivacySettingsNoticeModal",(e,t,s)=>{const{chatId:a,isReadDate:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{privacySettingsNoticeModal:{chatId:a,isReadDate:o}},n)}),(0,w.aJ)("closePrivacySettingsNoticeModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{privacySettingsNoticeModal:void 0},a)}),(0,w.aJ)("openChatLanguageModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=o?(0,C.Rny)(e,a,o,n):(0,C.qZq)(e,a,n);return(0,M.w)(e,{chatLanguageModal:{chatId:a,messageId:o,activeLanguage:i}},n)}),(0,w.aJ)("closeChatLanguageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatLanguageModal:void 0},a)}),(0,w.aJ)("copySelectedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages;pt(e,n,i)}),(0,w.aJ)("copyMessagesByIds",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,n=(0,C.meB)(e,o);a&&0!==a.length&&n&&pt(e,n.id,a)}),(0,w.aJ)("openOneTimeMediaModal",(e,t,s)=>{const{message:a,tabId:o=(0,u.g0)()}=s;e=(0,M.w)(e,{oneTimeMediaModal:{message:a}},o),(0,w.UF)(e)}),(0,w.aJ)("closeOneTimeMediaModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,M.w)(e,{oneTimeMediaModal:void 0},a),(0,w.UF)(e)}),(0,w.aJ)("closeReportAdModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{reportAdModal:void 0},a)}),(0,w.aJ)("closeReportModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{reportModal:void 0},a)}),(0,w.aJ)("openPreviousReportAdModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).reportAdModal;if(o){if(1!==o.sections.length)return(0,M.w)(e,{reportAdModal:{...o,sections:o.sections.slice(0,-1)}},a);t.closeReportAdModal({tabId:a})}}),(0,w.aJ)("openPreviousReportModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).reportModal;if(o){if(1!==o.sections.length)return(0,M.w)(e,{reportModal:{...o,sections:o.sections.slice(0,-1)}},a);t.closeReportModal({tabId:a})}}),(0,w.aJ)("openPaidReactionModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{paidReactionModal:{chatId:a,messageId:o}},n)}),(0,w.aJ)("closePaidReactionModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{paidReactionModal:void 0},a)}),(0,w.aJ)("openSuggestMessageModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{suggestMessageModal:{chatId:a,messageId:o}},n)}),(0,w.aJ)("closeSuggestMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{suggestMessageModal:void 0},a)}),(0,w.aJ)("openSuggestedPostApprovalModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{suggestedPostApprovalModal:{chatId:a,messageId:o}},n)}),(0,w.aJ)("closeSuggestedPostApprovalModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{suggestedPostApprovalModal:void 0},a)}),(0,w.aJ)("openDeleteMessageModal",(e,t,s)=>{const{chatId:a,messageIds:o,isSchedule:n,tabId:i=(0,u.g0)()}=s;e=(0,w.mS)(),e=(0,M.w)(e,{deleteMessageModal:{chatId:a,messageIds:o,isSchedule:n}},i),(0,w.UF)(e)}),(0,w.aJ)("closeDeleteMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{deleteMessageModal:void 0},a)}),(0,w.aJ)("openAboutAdsModal",(e,t,s)=>{const{randomId:a,additionalInfo:o,canReport:n,sponsorInfo:i,tabId:r=(0,u.g0)()}=s||{};return(0,M.w)(e,{aboutAdsModal:{randomId:a,canReport:n,additionalInfo:o,sponsorInfo:i}},r)}),(0,w.aJ)("closeAboutAdsModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{aboutAdsModal:void 0},a)}),(0,w.aJ)("closePreparedInlineMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{preparedMessageModal:void 0},a)}),(0,w.aJ)("closeSharePreparedMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{sharePreparedMessageModal:void 0},a)}),(0,w.aJ)("updateSharePreparedMessageModalSendArgs",async(e,t,s)=>{const{args:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);if(!n.sharePreparedMessageModal)return;if(!a)return e=(0,M.w)(e,{sharePreparedMessageModal:{...n.sharePreparedMessageModal,pendingSendArgs:void 0}},o),void(0,w.UF)(e);const i=await ne(e,a.peerId);e=(0,w.mS)(),e=(0,M.w)(e,{sharePreparedMessageModal:{...n.sharePreparedMessageModal,pendingSendArgs:{peerId:a.peerId,threadId:a.threadId,starsForSendMessage:i}}},o),(0,w.UF)(e)}),(0,w.aJ)("setGlobalSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,{chatId:n,currentContent:r}=(0,C.nTw)(e,o).globalSearch,d=a&&r!==i.$C.BotApps&&r!==i.$C.PublicPosts?{chats:!n,messages:!0}:void 0;return t.checkSearchPostsFlood({query:a,tabId:o}),(0,A.b8O)(e,{globalResults:{},localResults:{},resultsByType:void 0,fetchingStatus:d,query:a},o)}),(0,w.aJ)("setGlobalSearchClosing",(e,t,s)=>{const{tabId:a=(0,u.g0)(),isClosing:o}=s||{};return(0,A.b8O)(e,{isClosing:o},a)}),(0,w.aJ)("addRecentlyFoundChatId",(e,t,s)=>{const{id:a}=s,{recentlyFoundChatIds:o}=e;if(!o)return{...e,recentlyFoundChatIds:[a]};const n=o.filter(e=>e!==a);return n.unshift(a),n.length>10&&n.pop(),{...e,recentlyFoundChatIds:n}}),(0,w.aJ)("clearRecentlyFoundChats",e=>({...e,recentlyFoundChatIds:void 0})),(0,w.aJ)("setGlobalSearchContent",(e,t,s)=>{const{content:a,tabId:o=(0,u.g0)()}=s;return(0,A.GQ)(e,a,o)}),(0,w.aJ)("setGlobalSearchChatId",(e,t,s)=>{const{id:a,tabId:o=(0,u.g0)()}=s;return(0,A.b8O)(e,{chatId:a,query:void 0,resultsByType:void 0},o)}),(0,w.aJ)("openMiddleSearch",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(o&&n)return(0,A.$RI)(e,o,n,{},a)}),(0,w.aJ)("closeMiddleSearch",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(o&&n)return(0,A._54)(e,o,n,a)}),(0,w.aJ)("updateMiddleSearch",(e,t,s)=>{const{update:a,tabId:o=(0,u.g0)()}=s;let i,r;if(s.chatId)i=s.chatId,r=s.threadId||n.l3;else{const t=(0,C.Xf0)(e,o);if(!t)return;i=t.chatId,r=t.threadId}return(0,A.$RI)(e,i,r,a,o)}),(0,w.aJ)("resetMiddleSearch",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(o&&n)return(0,A.zde)(e,o,n,a)}),(0,w.aJ)("setSharedMediaSearchType",(e,t,s)=>{const{mediaType:a,tabId:o=(0,u.g0)()}=s,{chatId:n,threadId:i}=(0,C.Xf0)(e,o)||{};if(n&&i)return(0,A.Tu_)(e,n,i,a,o)}),(0,w.aJ)("setStickerSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{stickerSearch:{query:a,resultIds:void 0}},o)}),(0,w.aJ)("setGifSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{gifSearch:{query:a,offset:void 0,results:void 0}},o)}),(0,w.aJ)("openFrozenAccountModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isFrozenAccountModalOpen:!0},a)}),(0,w.aJ)("closeFrozenAccountModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isFrozenAccountModalOpen:!1},a)}),(0,w.aJ)("openDeleteAccountModal",(e,t,s)=>{const{days:a,tabId:o=(0,u.g0)()}=s||{};a&&(e=(0,M.w)(e,{...(0,C.nTw)(e,o),deleteAccountModal:{selfDestructAccountDays:a}},o),(0,w.UF)(e))}),(0,w.aJ)("closeDeleteAccountModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{deleteAccountModal:void 0},a)}),(0,w.aJ)("openAgeVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isAgeVerificationModalOpen:!0},a)}),(0,w.aJ)("closeAgeVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isAgeVerificationModalOpen:!1},a)}),(0,w.aJ)("setUserSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,A.BFh)(e,{globalUserIds:void 0,localUserIds:void 0,fetchingStatus:Boolean(a),query:a},o)}),(0,w.aJ)("openAddContactDialog",(e,t,s)=>{const{userId:a,tabId:o=(0,u.g0)()}=s;return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:o}),e):(0,M.w)(e,{newContact:{userId:a}},o)}),(0,w.aJ)("openNewContactDialog",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:a}),e):(0,M.w)(e,{newContact:{isByPhoneNumber:!0}},a)}),(0,w.aJ)("closeNewContactDialog",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.BOn)(e,a)}),(0,w.aJ)("closeSuggestedStatusModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{suggestedStatusModal:void 0},a)}),dt("closeChatRefundModal","chatRefundModal"),(0,w.aJ)("openProfileRatingModal",(e,t,s)=>{const{userId:a,level:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{profileRatingModal:{userId:a,level:o}},n)}),dt("closeProfileRatingModal","profileRatingModal"),s(11117);var gt=s(63495),ft=s(14235);const It=/^\d+\.\d+(\.\d+)?$/;var vt=s(99375);function bt(e){document.querySelectorAll('link[rel="icon"], link[rel="alternate icon"]').forEach(t=>{e?t.href.includes("favicon-unread")||(t.href=t.href.replace("favicon","favicon-unread")):t.href=t.href.replace("favicon-unread","favicon")})}async function yt(e){gt.Vq?await(window.tauri?.setWindowTitle(e)):document.title!==e&&(document.title=e)}const St=(0,I.sg)(yt,200,!1);let wt,At;(0,w.aJ)("toggleChatInfo",(e,t,s)=>{const{force:a,tabId:o=(0,u.g0)()}=s||{},n=void 0!==a?a:!(0,C.nTw)(e,o).isChatInfoShown;return e=(0,M.w)(e,{isChatInfoShown:n},o),{...e,lastIsChatInfoShown:n}}),(0,w.aJ)("setLeftColumnWidth",(e,t,s)=>{const{leftColumnWidth:a}=s;return{...e,leftColumnWidth:a}}),(0,w.aJ)("resetLeftColumnWidth",e=>({...e,leftColumnWidth:void 0})),(0,w.aJ)("toggleManagement",(e,t,s)=>{const{force:a,tabId:o=(0,u.g0)()}=s||{},{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.nTw)(e,o);return(0,M.w)(e,{management:{byChatId:{...i.management.byChatId,[n]:{...i.management.byChatId[n],isActive:void 0!==a?a:!(i.management.byChatId[n]||{}).isActive}}}},o)}),(0,w.aJ)("requestNextManagementScreen",(e,t,s)=>{const{screen:a,tabId:o=(0,u.g0)()}=s||{},{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.nTw)(e,o);return(0,M.w)(e,{management:{byChatId:{...i.management.byChatId,[n]:{...i.management.byChatId[n],isActive:!0,nextScreen:a}}}},o)}),(0,w.aJ)("closeManagement",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{};if(!o)return;const n=(0,C.nTw)(e,a);return(0,M.w)(e,{management:{byChatId:{...n.management.byChatId,[o]:{...n.management.byChatId[o],isActive:!1}}}},a)}),(0,w.aJ)("processOpenChatOrThread",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;if((0,D.Ny)()||(0,D.Bb)())return(0,M.w)(e,{isLeftColumnShown:0===(0,C.nTw)(e,a).messageLists.length},a)}),(0,w.aJ)("resetNextProfileTab",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{};if(o)return(0,M.w)(e,{nextProfileTab:void 0,forceScrollProfileTab:!1},a)}),(0,w.aJ)("toggleStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{isStatisticsShown:!o.isStatisticsShown,statistics:{...o.statistics,currentMessageId:void 0,currentStoryId:void 0}},a)}),(0,w.aJ)("toggleMessageStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)(),messageId:o}=s||{};return(0,M.w)(e,{statistics:{...(0,C.nTw)(e,a).statistics,currentMessageId:o,currentMessage:void 0,currentStoryId:void 0,currentStory:void 0}},a)}),(0,w.aJ)("toggleStoryStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)(),storyId:o}=s||{};return(0,M.w)(e,{statistics:{...(0,C.nTw)(e,a).statistics,currentStoryId:o,currentMessageId:void 0,currentMessage:void 0,currentStory:void 0}},a)}),(0,w.aJ)("toggleLeftColumn",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isLeftColumnShown:!(0,C.nTw)(e,a).isLeftColumnShown},a)}),(0,w.aJ)("addRecentEmoji",(e,t,s)=>{const{emoji:a}=s,{recentEmojis:o}=e;if(!o)return{...e,recentEmojis:[a]};const n=o.filter(e=>e!==a);return n.unshift(a),n.length>32&&n.pop(),{...e,recentEmojis:n}}),(0,w.aJ)("addRecentSticker",(e,t,s)=>{const{sticker:a}=s,{recent:o}=e.stickers;if(!o)return{...e,stickers:{...e.stickers,recent:{hash:"0",stickers:[a]}}};const n=o.stickers.filter(e=>e.id!==a.id);return n.unshift(a),{...e,stickers:{...e.stickers,recent:{...o,stickers:n}}}}),(0,w.aJ)("addRecentCustomEmoji",(e,t,s)=>{const{documentId:a}=s,{recentCustomEmojis:o}=e;if(!o)return{...e,recentCustomEmojis:[a]};const n=o.filter(e=>e!==a);return n.unshift(a),n.length>32&&n.pop(),{...e,recentCustomEmojis:n}}),(0,w.aJ)("clearRecentCustomEmoji",e=>({...e,recentCustomEmojis:[]})),(0,w.aJ)("reorderStickerSets",(e,t,s)=>{const{order:a,isCustomEmoji:o}=s;return{...e,stickers:{...e.stickers,added:{setIds:o?e.stickers.added.setIds:a}},customEmojis:{...e.customEmojis,added:{setIds:o?a:e.customEmojis.added.setIds}}}}),(0,w.aJ)("showNotification",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,n=o.localId;o.localId||=(0,ft.A)();const i=[...(0,C.nTw)(e,a).notifications],r=i.findIndex(e=>n?e.localId===o.localId:e.message===o.message);return-1!==r&&i.splice(r,1),i.push(o),(0,M.w)(e,{notifications:i},a)}),(0,w.aJ)("showAllowedMessageTypesNotification",(e,t,s)=>{const{chatId:a,messageListType:o,tabId:n=(0,u.g0)()}=s;if((0,C.WA9)(e,a)&&"scheduled"===o)return void t.showNotification({message:{key:"DescriptionScheduledPaidMessagesNotAllowed"},tabId:n});const i=(0,C.hds)(e,a);if(!i)return;const r=(0,C.AWZ)(e,a),d=a?(0,C.nZ4)(e,a):void 0,c=a?(0,C.ALW)(e,i):void 0,{canSendPlainText:l,canSendPhotos:m,canSendVideos:p,canSendDocuments:g,canSendAudios:I,canSendStickers:v,canSendRoundVideos:b,canSendVoices:S}=(0,y.Q_)(i,r,c,d),w=(0,h.oE)([l?"Chat.SendAllowedContentTypeText":void 0,m?"Chat.SendAllowedContentTypePhoto":void 0,p?"Chat.SendAllowedContentTypeVideo":void 0,S?"Chat.SendAllowedContentTypeVoiceMessage":void 0,b?"Chat.SendAllowedContentTypeVideoMessage":void 0,g?"Chat.SendAllowedContentTypeFile":void 0,I?"Chat.SendAllowedContentTypeMusic":void 0,v?"Chat.SendAllowedContentTypeSticker":void 0]).map(e=>f.yE(e));if(!w.length)return void t.showNotification({message:f.yE("Chat.SendNotAllowedText"),tabId:n});const A=f.yE("AutoDownloadSettings.LastDelimeter"),M=w.join(", ").replace(/,([^,]*)$/,`${A}$1`);t.showNotification({message:f.yE("Chat.SendAllowedContentText",M),tabId:n})}),(0,w.aJ)("dismissNotification",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,o=(0,C.nTw)(e,a).notifications.filter(e=>{let{localId:t}=e;return t!==s.localId});return(0,M.w)(e,{notifications:o},a)}),(0,w.aJ)("showDialog",(e,t,s)=>{const{data:a,tabId:o=(0,u.g0)()}=s;if("message"in a&&a.hasErrorKey&&!(0,vt.Ay)(a))return e;const n=[...(0,C.nTw)(e,o).dialogs];if("message"in a){const e=n.findIndex(e=>e.message===a.message);-1!==e&&n.splice(e,1)}return n.push(a),(0,M.w)(e,{dialogs:n},o)}),(0,w.aJ)("dismissDialog",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=[...(0,C.nTw)(e,a).dialogs];return o.pop(),(0,M.w)(e,{dialogs:o},a)}),(0,w.aJ)("toggleSafeLinkModal",(e,t,s)=>{const{url:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{safeLinkModalUrl:a},o)}),(0,w.aJ)("openHistoryCalendar",(e,t,s)=>{const{selectedAt:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{historyCalendarSelectedAt:a},o)}),(0,w.aJ)("closeHistoryCalendar",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{historyCalendarSelectedAt:void 0},a)}),(0,w.aJ)("openGame",(e,t,s)=>{const{url:a,chatId:o,messageId:n,tabId:i=(0,u.g0)()}=s,r=(0,C.O5q)(e,o,n);if(!r)return;const d=r.viaBotId||(0,C.Y7C)(e,r)?.id;if(d){if(!(0,C.nTL)(e,d))return e=(0,M.w)(e,{botTrustRequest:{botId:d,type:"game",onConfirm:{action:"openGame",payload:s}}},i),void(0,w.UF)(e);e=(0,M.w)(e,{openedGame:{url:a,chatId:o,messageId:n}},i),(0,w.UF)(e)}}),(0,w.aJ)("closeGame",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{openedGame:void 0},a)}),(0,w.aJ)("requestConfetti",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s;if((0,C.PKK)(e))return(0,M.w)(e,{confetti:{lastConfettiTime:Date.now(),...o}},a)}),(0,w.aJ)("requestWave",(e,t,s)=>{const{startX:o,startY:n,tabId:i=(0,u.g0)()}=s;if(!d.J6||!(0,C.PKK)(e))return;const r=(0,C.nTw)(e,i),c=r.wave?.lastWaveTime||0;return Date.now()-c<a.S4O?void 0:(0,M.w)(e,{wave:{lastWaveTime:Date.now(),startX:o,startY:n}},i)}),(0,w.aJ)("updateAttachmentSettings",(e,t,s)=>({...e,attachmentSettings:{...e.attachmentSettings,...s}})),(0,w.aJ)("requestEffectInComposer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;return(0,M.w)(e,{shouldPlayEffectInComposer:!0},a)}),(0,w.aJ)("hideEffectInComposer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;return(0,M.w)(e,{shouldPlayEffectInComposer:void 0},a)}),(0,w.aJ)("setPaidMessageAutoApprove",e=>({...e,settings:{...e.settings,byKey:{...e.settings.byKey,shouldPaidMessageAutoApprove:!0}}})),(0,w.aJ)("setReactionEffect",(e,t,s)=>{const{chatId:a,threadId:o,reaction:n,tabId:i=(0,u.g0)()}=s,r="emoji"===n?.type&&n.emoticon;if(!r)return;const d=Object.values(e.availableEffectById).find(e=>e.effectAnimationId&&e.emoticon===r),c=d?.id,l=(0,C.g29)(e);!d?.isPremium||l?c&&(t.requestEffectInComposer({tabId:i}),t.saveEffectInDraft({chatId:a,threadId:o,effectId:c})):t.openPremiumModal({initialSection:"effects",tabId:i})}),(0,w.aJ)("openLimitReachedModal",(e,t,s)=>{const{limit:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{limitReachedModal:{limit:a}},o)}),(0,w.aJ)("closeLimitReachedModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{limitReachedModal:void 0},a)}),(0,w.aJ)("closeStickerSetModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{openedStickerSetShortName:void 0},a)}),(0,w.aJ)("openCustomEmojiSets",(e,t,s)=>{const{setIds:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{openedCustomEmojiSetIds:a},o)}),(0,w.aJ)("closeCustomEmojiSets",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{openedCustomEmojiSetIds:void 0},a)}),(0,w.aJ)("updateLastRenderedCustomEmojis",(e,t,s)=>{const{ids:o}=s,{lastRendered:n}=e.customEmojis;return{...e,customEmojis:{...e.customEmojis,lastRendered:(0,h.Am)([...n,...o]).slice(0,a.GW0)}}}),(0,w.aJ)("openCreateTopicPanel",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;return(0,C.meB)(e,o)||t.openChat({id:a,tabId:o}),(0,M.w)(e,{createTopicPanel:{chatId:a}},o)}),(0,w.aJ)("closeCreateTopicPanel",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{createTopicPanel:void 0},a)}),(0,w.aJ)("openEditTopicPanel",(e,t,s)=>{const{chatId:a,topicId:o,tabId:n=(0,u.g0)()}=s;return(0,C.meB)(e,n)||t.openChat({id:a,tabId:n}),(0,M.w)(e,{editTopicPanel:{chatId:a,topicId:o}},n)}),(0,w.aJ)("closeEditTopicPanel",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{editTopicPanel:void 0},a)}),(0,w.aJ)("updateArchiveSettings",(e,t,s)=>{const{archiveSettings:a}=e,{isHidden:o=a.isHidden,isMinimized:n=a.isMinimized}=s;return{...e,archiveSettings:{isHidden:o,isMinimized:n}}}),(0,w.aJ)("openMapModal",(e,t,s)=>{const{geoPoint:a,zoom:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{mapModal:{point:a,zoom:o}},n)}),(0,w.aJ)("closeMapModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{mapModal:void 0},a)}),(0,w.aJ)("checkAppVersion",e=>{fetch(`version.txt?${Date.now()}`).then(e=>e.text()).then(t=>{(function(e,t){const s=e.trim();return!!It.test(s)&&s!==t})(t=t.trim(),"10.9.73")&&(e=(0,w.mS)(),e={...e,isAppUpdateAvailable:!0},(0,w.UF)(e))}).catch(e=>{a.Oig&&console.error("[checkAppVersion failed] ",e)})}),(0,w.aJ)("afterHangUp",e=>{(0,C.nTw)(e,(0,u.g0)()).multitabNextAction&&(0,u.I)()}),(0,w.aJ)("onTabFocusChange",(e,t,s)=>{const{isBlurred:a,tabId:o=(0,u.g0)()}=s;return a?(wt&&clearInterval(wt),wt=window.setInterval(()=>{t.updatePageTitle({tabId:o})},500)):(clearInterval(wt),wt=void 0),e=(0,M.w)(e,{isBlurred:a},o),{...e,initialUnreadNotifications:a?(0,Fe.vp)():void 0}}),(0,w.aJ)("updatePageTitle",(e,t,s)=>{const{tabId:o=(0,u.g0)()}=s||{},{canDisplayChatInTitle:n}=(0,je.l)(e),i=e.currentUserId,r=e.config?.isTestServer,d=r?"[T] ":"",c=gt.Vq?a.zGP:a.j0M;if(document.title.includes(a.LaL))return bt(!1),void yt(`${d}${c} ${a.LaL}`);if(!gt.Vq&&e.initialUnreadNotifications&&Math.round(Date.now()/1e3)%2==0){const t=(0,Fe.vp)()-e.initialUnreadNotifications;if(t>0)return yt(`${d}${t} notification${t>1?"s":""}`),void bt(!0)}bt(!1);const l=(0,C.Xf0)(e,o);if(l&&n&&!e.passcode.isScreenLocked){const{chatId:t,threadId:s}=l,a=(0,C.hds)(e,t);if(a){const o=(0,y.Js)(f.yE,a,t===i),n=(0,C.S0q)(e,t,s);return a.isForum&&n?void St(`${d}${o} › ${n.title}`):void St(`${d}${o}`)}}yt(`${d}${c}`)}),(0,w.aJ)("closeInviteViaLinkModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s??{};return(0,M.w)(e,{inviteViaLinkModal:void 0},a)}),(0,w.aJ)("closeCollectibleInfoModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s??{};return(0,M.w)(e,{collectibleInfoModal:void 0},a)}),(0,w.aJ)("setShouldCloseRightColumn",(e,t,s)=>{const{value:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{shouldCloseRightColumn:a},o)}),(0,w.aJ)("refreshLangPackFromCache",(e,t,s)=>{(0,p.K1)(s.langCode)}),(0,w.aJ)("processPremiumFloodWait",(e,t,s)=>{const{isUpload:a}=s,{bandwidthPremiumDownloadSpeedup:o,bandwidthPremiumUploadSpeedup:n,bandwidthPremiumNotifyPeriod:i}=e.appConfig,{lastPremiumBandwithNotificationDate:r}=e.settings;if(o&&n&&i&&!(r&&Date.now()<r+1e3*i))return Object.values(e.byTabId).filter(e=>!e.isBlurred).map(e=>e.id).forEach(e=>{t.showNotification({title:f.yE(a?"UploadSpeedLimited":"DownloadSpeedLimited"),message:f.yE(a?"UploadSpeedLimitedMessage":"DownloadSpeedLimitedMessage",a?n:o),duration:6e3,tabId:e})}),{...e,settings:{...e.settings,lastPremiumBandwithNotificationDate:Date.now()}}});let Mt,Ct=0;(0,ke.DW)(e=>{const{updatePageTitle:t,updateIsOnline:s}=(0,w.ko)(),a=e.passcode.isScreenLocked!==At,o=Object.values(e.byTabId).filter(e=>e.isBlurred).length,n=(0,C.nTw)(e,(0,u.g0)()).isMasterTab;a&&t(),o!==Ct&&n&&(Mt&&clearTimeout(Mt),Mt=window.setTimeout(()=>{e=(0,w.mS)();const t=Object.values(e.byTabId).filter(e=>e.isBlurred).length;s({isOnline:t!==(0,u.gb)().length})},100)),At=e.passcode.isScreenLocked,Ct=o}),(0,w.aJ)("closePaymentModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).payment.status||"cancelled",n=(0,C.nTw)(e,a).starsBalanceModal;return t.processOriginStarsPayment({originData:n,status:o,tabId:a}),e=(0,A.GSI)(e,a),(0,A._$X)(e,{status:o},a)}),(0,w.aJ)("resetPaymentStatus",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return e=(0,A._$X)(e,{status:void 0},a),(0,A.nv6)(e,{status:void 0},a)}),(0,w.aJ)("addPaymentError",(e,t,s)=>{const{error:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{payment:{...(0,C.nTw)(e,o).payment,status:"failed",error:a}},o)}),(0,w.aJ)("closeGiveawayModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{giveawayModal:void 0},a)}),(0,w.aJ)("closeGiftCodeModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftCodeModal:void 0},a)}),(0,w.aJ)("updateGiftProfileFilter",(e,t,s)=>{const{filter:a,peerId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,n),r=i.savedGifts.filter;let d={...r,...a};d.shouldIncludeUnlimited||d.shouldIncludeLimited||d.shouldIncludeUnique||d.shouldIncludeUpgradable||(d={...r,shouldIncludeUnlimited:!0,shouldIncludeLimited:!0,shouldIncludeUnique:!0,shouldIncludeUpgradable:!0,...a}),d.shouldIncludeDisplayed||d.shouldIncludeHidden||(d={...r,shouldIncludeDisplayed:!0,shouldIncludeHidden:!0,...a});const c=(0,C.B59)(e,o,n);e=(0,M.w)(e,{savedGifts:{...i.savedGifts,collectionsByPeerId:{[o]:{[c]:i.savedGifts.collectionsByPeerId[o]?.[c]}},filter:d}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:i.id})}),(0,w.aJ)("resetGiftProfileFilter",(e,t,s)=>{const{peerId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,n),r=(0,C.B59)(e,o,n);e=(0,M.w)(e,{savedGifts:{...i.savedGifts,collectionsByPeerId:{[o]:{[r]:i.savedGifts.collectionsByPeerId[o]?.[r]}},filter:{...a.tBS}}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:i.id})}),(0,w.aJ)("openPaymentMessageConfirmDialogOpen",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isPaymentMessageConfirmDialogOpen:!0},a)}),(0,w.aJ)("closePaymentMessageConfirmDialogOpen",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isPaymentMessageConfirmDialogOpen:!1},a)}),(0,w.aJ)("openPriceConfirmModal",(e,t,s)=>{const{originalAmount:a,newAmount:o,currency:n,directInfo:i,tabId:r=(0,u.g0)()}=s;return(0,M.w)(e,{priceConfirmModal:{originalAmount:a,newAmount:o,currency:n,directInfo:i}},r)}),(0,w.aJ)("closePriceConfirmModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{priceConfirmModal:void 0},a)});var Pt=s(12859);(0,w.aJ)("openMediaViewer",(e,t,s)=>{const{chatId:a,threadId:o=n.l3,messageId:i,timestamp:r,mediaIndex:d,isAvatarView:c,isSponsoredMessage:l,origin:h,withDynamicLoading:m,standaloneMedia:p,tabId:g=(0,u.g0)()}=s,f=(0,C.nTw)(e,g);return(0,M.w)(e,{mediaViewer:{...f.mediaViewer,chatId:a,threadId:o,messageId:i,mediaIndex:d||0,isAvatarView:c,isSponsoredMessage:l,origin:h,standaloneMedia:p,isHidden:!1,withDynamicLoading:m,timestamp:r},forwardMessages:{},isShareMessageModalShown:!1},g)}),(0,w.aJ)("closeMediaViewer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{volume:o,isMuted:n,playbackRate:i,isHidden:r}=(0,C.nTw)(e,a).mediaViewer;return(0,M.w)(e,{mediaViewer:{volume:o,isMuted:n,isHidden:r,playbackRate:i}},a)}),(0,w.aJ)("openMediaFromTimestamp",(e,t,s)=>{const{chatId:a,messageId:o,threadId:n,timestamp:r,tabId:d=(0,u.g0)()}=s,c=(0,C.O5q)(e,a,o);if(!c)return;const l=(0,T.Q)(c),h=(0,C.gMr)(e,c),m=(0,ut.ly)(e,c),p=m?.duration;if(p){if(p<=r)return;return"video"===m.mediaType?void t.openMediaViewer({chatId:a,messageId:o,threadId:n,origin:i.TQ.Inline,timestamp:r,tabId:d}):void t.openAudioPlayer({chatId:a,messageId:o,threadId:n,origin:i.d9.Inline,timestamp:r,tabId:d})}const g=h?(0,ut.ly)(e,h):void 0,f=g?.duration;!f||f<=r||("video"!==g.mediaType?t.openAudioPlayer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:i.d9.Inline,timestamp:r,tabId:d}):t.openMediaViewer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:i.TQ.Inline,timestamp:r,tabId:d}))}),(0,w.aJ)("updateLastPlaybackTimestamp",(e,t,s)=>{const{chatId:a,messageId:o,timestamp:n}=s,i=e.messages.playbackByChatId[a]?.byId||{};return n?{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[a]:{byId:{...i,[o]:n}}}}}:{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[a]:{byId:(0,h.cJ)(i,[o])}}}}}),(0,w.aJ)("setMediaViewerVolume",(e,t,s)=>{const{volume:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,volume:a,isMuted:!1}},o)}),(0,w.aJ)("setMediaViewerPlaybackRate",(e,t,s)=>{const{playbackRate:a,tabId:o=(0,u.g0)()}=s;return e={...e,mediaViewer:{...e.mediaViewer,lastPlaybackRate:a}},(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,playbackRate:a}},o)}),(0,w.aJ)("setMediaViewerMuted",(e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isMuted:a}},o)}),(0,w.aJ)("setMediaViewerHidden",(e,t,s)=>{const{isHidden:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isHidden:a}},o)});var kt=s(70934),Ft=s(57751),Tt=s(42385),xt=s(20714);let Ut=!1;(0,I.yu)(()=>{const e=(0,w.mS)();e.isInited&&e.passcode.hasPasscode&&!Ut&&1===Object.keys(e.byTabId).length&&(0,Ft.rE)()}),(0,w.aJ)("setPasscode",async(e,t,s)=>{const{passcode:a,tabId:o=(0,u.g0)()}=s;e=(0,A.Vg3)(e,{isLoading:!0}),(0,w.UF)(e),await(0,kt.IG)(a);const n=JSON.stringify({...(0,Ft.CX)(),userId:e.currentUserId});e=(0,w.mS)();const r=(0,Tt.Mm)((0,A.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}));try{await(0,kt.yp)(n,r),(0,u.ZQ)(),e=(0,w.mS)(),e=(0,A.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}),(0,w.UF)(e),(0,Tt.Bo)(!0)}catch(s){(0,kt.m)(),e=(0,w.mS)(),e=(0,A.Vg3)(e,{isLoading:!1}),(0,w.UF)(e),t.showNotification({message:"Failed to set passcode",tabId:o}),t.openSettingsScreen({screen:i.VS.PasscodeDisabled,tabId:o})}}),(0,w.aJ)("clearPasscode",e=>((0,kt.WN)(),localStorage.removeItem(a.ozB),(0,A.XQb)(e))),(0,w.aJ)("unlockScreen",(e,t,s)=>{const a=Object.values(e.byTabId),{sessionJson:o,globalJson:n}=s,i=JSON.parse(o);(0,Ft.AA)(i);const r=e;(e=JSON.parse(n)).byTabId=r.byTabId,(0,Tt.e)(e,(0,h.mg)(xt.HB)),e=(0,A.Vg3)(e,{isScreenLocked:!1,error:void 0,invalidAttemptsCount:0}),(0,w.UF)(e),(0,u.ZQ)(),a.forEach(e=>{let{id:s,isMasterTab:a}=e;return t.init({tabId:s,isMasterTab:a})}),t.initApi()}),(0,w.aJ)("logInvalidUnlockAttempt",e=>{const t=(e.passcode?.invalidAttemptsCount??0)+1;return(0,A.Vg3)(e,{invalidAttemptsCount:t,timeoutUntil:t>=5?Date.now()+15e3:void 0})}),(0,w.aJ)("resetInvalidUnlockAttempts",e=>(0,A.Vg3)(e,{invalidAttemptsCount:0,timeoutUntil:void 0})),(0,w.aJ)("setPasscodeError",(e,t,s)=>{const{error:a}=s;return(0,A.Vg3)(e,{error:a})}),(0,w.aJ)("clearPasscodeError",e=>(0,A.Vg3)(e,{error:void 0})),(0,w.aJ)("skipLockOnUnload",()=>{Ut=!0}),(0,w.aJ)("processOriginStarsPayment",(e,t,s)=>{const{originData:a,status:o,tabId:n=(0,u.g0)()}=s,{originStarsPayment:i,originReaction:r,originGift:d,topup:c}=a||{};if((i||r||d||c)&&(t.closeStarsBalanceModal({tabId:n}),"paid"===o))return i&&(e=(0,M.w)(e,{starsPayment:i},n)),r&&t.sendPaidReaction({chatId:r.chatId,messageId:r.messageId,forcedAmount:r.amount,tabId:n}),d&&t.sendStarGift({...d,tabId:n}),e}),(0,w.aJ)("openGiftRecipientPicker",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:a}),e):(0,M.w)(e,{isGiftRecipientPickerOpen:!0},a)}),dt("closeGiftRecipientPicker","isGiftRecipientPickerOpen"),(0,w.aJ)("openStarsGiftingPickerModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{starsGiftingPickerModal:{isOpen:!0}},a)}),dt("closeStarsGiftingPickerModal","starsGiftingPickerModal"),(0,w.aJ)("openPrizeStarsTransactionFromGiveaway",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.O5q)(e,a,o);if(!i)return;const r=(0,Xe.D5)(i);return r?(0,A.V5q)(e,r,n):void 0}),(0,w.aJ)("openStarsBalanceModal",(e,t,s)=>{const{originStarsPayment:o,originReaction:n,originGift:i,topup:r,shouldIgnoreBalance:d,currency:c=a.OUy,tabId:l=(0,u.g0)()}=s||{},h=e.stars?.balance;if(!(!d&&h&&r&&r.balanceNeeded<=h.amount))return e=(0,A.Y1r)(e,l),t.loadStarStatus(),(0,M.w)(e,{starsBalanceModal:{originStarsPayment:o,originReaction:n,originGift:i,topup:r,currency:c}},l);t.showNotification({message:f.yE("StarsTopupLinkEnough"),actionText:f.yE("StarsTopupLinkTopupAnyway"),action:{action:"openStarsBalanceModal",payload:{topup:r,shouldIgnoreBalance:!0,tabId:l}},icon:"star",tabId:l})}),dt("closeStarsBalanceModal","starsBalanceModal"),(0,w.aJ)("closeStarsPaymentModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Osl)(e,a);let n=o?.status;return n&&"pending"!==n||(n="cancelled"),(0,M.w)(e,{starsPayment:{status:n}},a)}),(0,w.aJ)("openStarsTransactionModal",(e,t,s)=>{const{transaction:a,tabId:o=(0,u.g0)()}=s;return(0,A.V5q)(e,a,o)}),(0,w.aJ)("openStarsTransactionFromGift",(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.O5q)(e,a,o);if(!i)return;const r=(0,Xe.M6)(i);return r?(0,A.V5q)(e,r,n):void 0}),dt("closeStarsTransactionModal","starsTransactionModal"),(0,w.aJ)("openStarsSubscriptionModal",(e,t,s)=>{const{subscription:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{starsSubscriptionModal:{subscription:a}},o)}),dt("closeStarsSubscriptionModal","starsSubscriptionModal"),dt("closeGiftModal","giftModal"),(0,w.aJ)("closeStarsGiftModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{starsGiftModal:{isOpen:!1}},a)}),(0,w.aJ)("openGiftInfoModalFromMessage",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;if(!(0,C.hds)(e,a))return;await(0,w.pv)().loadMessage({chatId:a,messageId:o}),e=(0,w.mS)();const i=(0,C.O5q)(e,a,o);if(!i||!i.content.action)return;const r=i.content.action;if("starGift"!==r.type&&"starGiftUnique"!==r.type)return;const d="starGift"===r.type?r:void 0,c="starGiftUnique"===r.type?r:void 0,l=r.peerId||(i.isOutgoing?i.chatId:e.currentUserId),h=r.savedId?{type:"chat",chatId:a,savedId:r.savedId}:{type:"user",messageId:o},m=r.fromId||(i.isOutgoing?e.currentUserId:i.chatId),p={date:i.date,gift:r.gift,message:d?.message,starsToConvert:d?.starsToConvert,isNameHidden:d?.isNameHidden,isUnsaved:!r.isSaved,fromId:m,messageId:i.id,isConverted:d?.isConverted,upgradeMsgId:d?.upgradeMsgId,canUpgrade:d?.canUpgrade,alreadyPaidUpgradeStars:d?.alreadyPaidUpgradeStars,inputGift:h,canExportAt:c?.canExportAt,savedId:r.savedId,transferStars:c?.transferStars};t.openGiftInfoModal({peerId:l,gift:p,tabId:n})}),(0,w.aJ)("openGiftInfoModal",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,n="peerId"in s?s.peerId:void 0,i="recipientId"in s?s.recipientId:void 0;return(0,M.w)(e,{giftInfoModal:{peerId:n,gift:a,recipientId:i}},o)}),(0,w.aJ)("openGiftResalePriceComposerModal",(e,t,s)=>{const{gift:a,peerId:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{giftResalePriceComposerModal:{peerId:o,gift:a}},n)}),(0,w.aJ)("openGiftInMarket",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o).giftModal;return t.closeGiftInfoValueModal({tabId:o}),t.closeGiftInfoModal({tabId:o}),n?(0,M.w)(e,{giftModal:{...n,selectedResaleGift:a}},o):(t.openGiftModal({forUserId:e.currentUserId,selectedResaleGift:a,tabId:o}),e)}),(0,w.aJ)("closeResaleGiftsMarket",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};t.resetResaleGifts({tabId:a});const o=(0,C.nTw)(e,a).giftModal;return o?(0,M.w)(e,{giftModal:{...o,selectedResaleGift:void 0}},a):e}),(0,w.aJ)("openGiftInfoValueModal",async(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("fetchUniqueStarGiftValueInfo",{slug:a.slug});n&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftInfoValueModal:{valueInfo:n,gift:a}},o),(0,w.UF)(e))}),dt("closeGiftInfoModal","giftInfoModal"),dt("closeGiftInfoValueModal","giftInfoValueModal"),dt("closeGiftResalePriceComposerModal","giftResalePriceComposerModal"),dt("closeGiftUpgradeModal","giftUpgradeModal"),(0,w.aJ)("openGiftWithdrawModal",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftWithdrawModal:{gift:a}},o)}),dt("closeGiftWithdrawModal","giftWithdrawModal"),(0,w.aJ)("openGiftStatusInfoModal",(e,t,s)=>{const{emojiStatus:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftStatusInfoModal:{emojiStatus:a}},o)}),(0,w.aJ)("closeGiftStatusInfoModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftStatusInfoModal:void 0},a)}),(0,w.aJ)("clearGiftWithdrawError",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),n=o?.giftWithdrawModal;if(n)return(0,M.w)(e,{giftWithdrawModal:{...n,errorKey:void 0}},a)}),(0,w.aJ)("openGiftTransferModal",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{giftTransferModal:{gift:a}},o)}),dt("closeGiftTransferModal","giftTransferModal"),(0,w.aJ)("updateSelectedGiftCollection",(e,t,s)=>{const{peerId:a,collectionId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.nTw)(e,n);e=(0,M.w)(e,{savedGifts:{...i.savedGifts,activeCollectionByPeerId:{...i.savedGifts.activeCollectionByPeerId,[a]:o}}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:a,shouldRefresh:!0,tabId:i.id})}),(0,w.aJ)("resetSelectedGiftCollection",(e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);e=(0,M.w)(e,{savedGifts:{...n.savedGifts,activeCollectionByPeerId:{...n.savedGifts.activeCollectionByPeerId,[a]:void 0}}},o),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:a,shouldRefresh:!0,tabId:n.id})}),(0,w.aJ)("processOpenChatOrThread",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;return a?(0,M.w)(e,{reactionPicker:{chatId:a,messageId:void 0,position:void 0}},o):(0,M.w)(e,{reactionPicker:void 0},o)}),(0,w.aJ)("openMessageReactionPicker",(e,t,s)=>{const{chatId:a,messageId:o,position:n,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{reactionPicker:{chatId:a,messageId:o,position:n}},i)}),(0,w.aJ)("openStoryReactionPicker",(e,t,s)=>{const{peerId:a,storyId:o,position:n,sendAsMessage:i,tabId:r=(0,u.g0)()}=s;return(0,M.w)(e,{reactionPicker:{storyPeerId:a,storyId:o,sendAsMessage:i,position:n}},r)}),(0,w.aJ)("openEffectPicker",(e,t,s)=>{const{position:a,chatId:o,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{reactionPicker:{position:a,chatId:o,isForEffects:!0}},n)}),(0,w.aJ)("closeReactionPicker",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{reactionPicker:{...o.reactionPicker,messageId:void 0,position:void 0,storyId:void 0,storyPeerId:void 0,isForEffects:void 0}},a)}),(0,w.aJ)("resetLocalPaidReactions",(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.O5q)(e,a,o);if(!n)return;const{reactions:i}=n;if(!i)return;const r=i.results.map(e=>{if(e.localAmount){if(!e.count)return;return{...e,localAmount:void 0,localPreviousChosenOrder:void 0,chosenOrder:e.localPreviousChosenOrder}}return e}).filter(Boolean);return Object.values(e.byTabId).forEach(e=>{let{id:s}=e;t.dismissNotification({localId:(0,m.bj)(n),tabId:s})}),(0,A.r3y)(e,a,o,{reactions:{...i,results:r}})}),(0,w.aJ)("openStoryViewer",async(e,t,s)=>{const{peerId:a,storyId:o,isSinglePeer:n,isSingleStory:i,isPrivate:r,isArchive:d,origin:c,tabId:l=(0,u.g0)()}=s,h=(0,C.PVB)(e,a);if(!h)return;const m=(0,C.nTw)(e,l),p=(0,C._bp)(e,a);if(o&&(!p||!p.byId[o])){const t=await(0,b.px)("fetchPeerStoriesByIds",{peer:h,ids:[o]});if(!t)return;e=(0,w.mS)(),e=(0,A.K4v)(e,a,t.stories)}const g=m.storyViewer.storyList||(0,C.R3Q)(e,a,o,i,n,r,d);e=(0,M.w)(e,{storyViewer:{...m.storyViewer,peerId:a,storyId:o||(0,C._$$)(e,a)||(0,C.dNJ)(e,a),isSinglePeer:n,isPrivate:r,isArchive:d,isSingleStory:i,viewModal:void 0,origin:c,storyList:g}},l),(0,w.UF)(e)}),(0,w.aJ)("openStoryViewerByUsername",async(e,t,s)=>{const{username:a,storyId:n,origin:i,tabId:r=(0,u.g0)()}=s,d=await(0,o.A$)(e,a);d&&t.openStoryViewer({peerId:d.id,storyId:n,isSinglePeer:!0,isSingleStory:!0,origin:i,tabId:r})}),(0,w.aJ)("closeStoryViewer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{isMuted:o,isRibbonShown:n,isArchivedRibbonShown:i,storyId:r}=(0,C.nTw)(e,a).storyViewer;return r?e=(0,M.w)(e,{storyViewer:{isMuted:o,isRibbonShown:n,isArchivedRibbonShown:i,lastViewedByPeerId:void 0,storyList:void 0}},a):e}),(0,w.aJ)("setStoryViewerMuted",(e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{storyViewer:{...(0,C.nTw)(e,o).storyViewer,isMuted:a}},o)}),(0,w.aJ)("toggleStoryRibbon",(e,t,s)=>{const{isShown:a,isArchived:o,tabId:n=(0,u.g0)()}=s,i=e.stories.orderedPeerIds[o?"archived":"active"];return i?.length?(0,M.w)(e,{storyViewer:{...(0,C.nTw)(e,n).storyViewer,[o?"isArchivedRibbonShown":"isRibbonShown"]:a}},n):e}),(0,w.aJ)("openPreviousStory",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),{peerId:n,storyId:i,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:a});if(!n||!i)return;const l=(0,C.PVB)(e,n);if(!(0,C._bp)(e,n)||!l)return;const{peerIds:h,storyIdsByPeerId:m}=c,p=(m[n]??[]).indexOf(i);let g,f;if(p>0)g=p-1,f=n;else{const e=h.indexOf(n)-1;if(r||e<0)return;f=h[e],g=(m?.[f]?.length||1)-1}const I=m?.[f]?.[g];return I?(0,M.w)(e,{storyViewer:{...o.storyViewer,peerId:f,storyId:I}},a):void 0}),(0,w.aJ)("openNextStory",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),{peerId:n,storyId:i,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:a});if(!n||!i)return;const l=(0,C.PVB)(e,n);if(!(0,C._bp)(e,n)||!l)return;const{peerIds:h,storyIdsByPeerId:m}=c,p=m[n]??[],g=p.indexOf(i);let f,I;if(g<p.length-1)f=g+1,I=n;else{const e=h.indexOf(n)+1;if(r||e>h.length-1)return void t.closeStoryViewer({tabId:a});I=h[e],f=0}const v=m?.[I]?.[f];return v?(0,M.w)(e,{storyViewer:{...o.storyViewer,peerId:I,storyId:v}},a):void 0}),(0,w.aJ)("openStoryViewModal",(e,t,s)=>{const{storyId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);return(0,M.w)(e,{storyViewer:{...n.storyViewer,viewModal:{storyId:a,nextOffset:"",isLoading:!0}}},o)}),(0,w.aJ)("closeStoryViewModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{storyViewer:(0,h.cJ)(o.storyViewer,["viewModal"])},a)}),(0,w.aJ)("copyStoryLink",async(e,t,s)=>{const{peerId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,a);if(!i)return;const r=await(0,b.px)("fetchStoryLink",{peer:i,storyId:o});r&&((0,c.eM)(r),t.showNotification({message:f.yE("LinkCopied"),tabId:n}))}),(0,w.aJ)("sendMessage",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,{storyId:o,peerId:n}=(0,C.V9I)(e,a);if(!Boolean(o&&n))return;if(void 0===await ne(e,n))return;const{gif:i,sticker:r,isReaction:d}=s;let c;c=i?"Story.Tooltip.GifSent":r?"Story.Tooltip.StickerSent":d?"Story.Tooltip.ReactionSent":"Story.Tooltip.MessageSent",t.showNotification({message:f.yE(c),actionText:f.yE("Story.ToastViewInChat"),action:[{action:"closeStoryViewer",payload:void 0},{action:"openChat",payload:{id:n}}],tabId:a})}),(0,w.aJ)("openStoryPrivacyEditor",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!0}},a)}),(0,w.aJ)("closeStoryPrivacyEditor",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!1}},a)}),(0,w.aJ)("toggleStealthModal",(e,t,s)=>{const{isOpen:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);return(0,M.w)(e,{storyViewer:{...n.storyViewer,isStealthModalOpen:a}},o)}),(0,w.aJ)("clearStoryViews",(e,t,s)=>{const{isLoading:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);return n.storyViewer.viewModal?(0,M.w)(e,{storyViewer:{...n.storyViewer,viewModal:{...n.storyViewer.viewModal,views:void 0,isLoading:a,nextOffset:""}}},o):e}),(0,w.aJ)("updateStoryView",(e,t,s)=>{const{userId:a,isUserBlocked:o,areStoriesBlocked:n,tabId:i=(0,u.g0)()}=s,r=(0,C.nTw)(e,i),{viewModal:d}=r.storyViewer;if(!d?.storyId)return;const c=d?.views?.map(e=>e.peerId===a?{...e,isUserBlocked:o||void 0,areStoriesBlocked:n||void 0}:e);return(0,M.w)(e,{storyViewer:{...r.storyViewer,viewModal:{...d,views:c}}},i)}),(0,w.aJ)("closeBoostModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{boostModal:void 0},a)}),(0,w.aJ)("closeBoostStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{boostStatistics:void 0},a)}),(0,w.aJ)("openMonetizationVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)(),chatId:o}=s||{};return(0,M.w)(e,{monetizationVerificationModal:{chatId:o}},a)}),(0,w.aJ)("closeMonetizationVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{monetizationVerificationModal:void 0},a)}),(0,w.aJ)("clearMonetizationVerificationError",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.Zct)(e,{errorKey:void 0},a)}),(0,w.aJ)("closeMonetizationStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{monetizationStatistics:void 0},a)}),s(4990);const Bt=new Set(["boostLevel","isForum","isLinkedInDiscussion","fakeType","restrictionReasons","isJoinToSend","isJoinRequest","type"]);(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateChat":{const a=(0,C.hds)(e,s.id),{isForum:o,lastReadOutboxMessageId:n}=a||{};s.chat.lastReadOutboxMessageId&&n&&s.chat.lastReadOutboxMessageId<n&&(s={...s,chat:(0,h.cJ)(s.chat,["lastReadInboxMessageId"])}),e=(0,A.wix)(e,s.id,s.chat),a?.areStoriesHidden!==s.chat.areStoriesHidden&&(e=(0,A.VWO)(e,s.id,s.chat.areStoriesHidden||!1)),(0,w.UF)(e);const i=(0,C.hds)(e,s.id);if(s.noTopChatsRequest||(0,C.mJZ)(e,s.id)||i?.isNotJoined||t.loadTopChats(),s.chat.id&&(0,F.Kz)({chatId:s.chat.id,lastReadInboxMessageId:s.chat.lastReadInboxMessageId}),Object.values(e.byTabId).forEach(a=>{let{id:n}=a;const{chatId:i}=(0,C.Xf0)(e,n)||{},r=s;i===r.id&&"isForum"in r.chat&&o!==r.chat.isForum&&(o&&t.closeForumPanel({tabId:n}),t.openChat({id:i,tabId:n}))}),a){const e=s.chat;Object.keys(e).filter(t=>a[t]!==e[t]).some(e=>Bt.has(e))&&t.invalidateFullInfo({peerId:s.id})}return}case"updateChatJoin":{const a=(0,C.P4G)(e,s.id),o=(0,C.hds)(e,s.id);if(e=(0,A.wix)(e,s.id,{isNotJoined:!1}),(0,w.UF)(e),o&&t.requestChatUpdate({chatId:o.id}),t.loadFullChat({chatId:s.id,force:!0}),!a)return;return e=(0,w.mS)(),e=(0,A.ec2)(e,a,[s.id]),void(0,w.UF)(e)}case"updateChatLeave":{e=(0,A.CX_)(e,s.id);const t=(0,C.hds)(e,s.id);if(t&&(0,y.WX)(t)){const a=(0,C.zeq)(e,s.id);if(a){const s=Object.keys(a).map(Number).filter(m.iL);e=(0,A.AH0)(e,t.id,s)}}return e}case"updateChatInbox":return(0,A.wix)(e,s.id,s.chat);case"updateChatTypingStatus":{const{id:t,threadId:a=n.l3,typingStatus:o}=s;return e=(0,A.eww)(e,t,a,"typingStatus",o),(0,w.UF)(e),void setTimeout(()=>{e=(0,w.mS)();const s=(0,C.C5H)(e,t,a,"typingStatus");o&&s&&o.timestamp===s.timestamp&&(e=(0,A.eww)(e,t,a,"typingStatus",void 0),(0,w.UF)(e))},6e3)}case"newMessage":{const{message:t}=s;if((t.senderId?t.senderId===e.currentUserId:t.isOutgoing)&&!t.isFromScheduled)return;const o=(0,m.iL)(t.id),n=(0,C.hds)(e,s.chatId);if(!n)return;const i=Boolean(s.message.id&&s.message.hasUnreadMention);if(!o||n.id===a.zv8){e=(0,A.wix)(e,s.chatId,{unreadCount:n.unreadCount?n.unreadCount+1:1}),i&&(e=(0,A.Wez)(e,s.chatId,n,[s.message.id],!0));const a=n.isForum?(0,C.nkm)(e,t):void 0;a&&(e=(0,A.TwA)(e,s.chatId,a.id,{unreadCount:a.unreadCount?a.unreadCount+1:1}))}return(0,w.UF)(e),void(0,F.Oq)({chat:n,message:t})}case"updateCommonBoxMessages":case"updateChannelMessages":{const{ids:t,messageUpdate:a}=s;return t.forEach(t=>{const o="channelId"in s?s.channelId:(0,C.Egn)(e,t),n=(0,C.hds)(e,o);a.reactions&&n?.unreadReactionsCount&&!(0,y.pU)(e,a.reactions)&&(e=V(e,o,{unreadReactionsCount:Math.max(n.unreadReactionsCount-1,0)||void 0,unreadReactions:n.unreadReactions?.filter(e=>e!==t)})),!a.hasUnreadMention&&n?.unreadMentionsCount&&(e=(0,A.pWt)(e,o,n,[t],!0))}),e}case"updateChatFullInfo":return(0,A.ltr)(e,s.id,s.fullInfo);case"updatePinnedChatIds":{const{ids:o,folderId:n}=s,i=n===a._E9?"archived":"active";return o?{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[i]:o.length?o:void 0}}}:(t.loadPinnedDialogs({listType:i}),e)}case"updatePinnedSavedDialogIds":{const{ids:t}=s;return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:t.length?t:void 0}}}}case"updateChatPinned":{const{id:t,isPinned:o}=s,n=(0,C.P4G)(e,t);if(!n)return;const{[n]:i}=e.chats.orderedPinnedIds;let r=i||[];if(o){if(!r.includes(t)){if("active"===n&&r.length>=a.FZw){const t=e.chats.listIds.active;r=r.filter(e=>t&&t.includes(e))}r=[t,...r]}}else r=r.filter(e=>e!==t);return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[n]:r.length?r:void 0}}}}case"updateSavedDialogPinned":{const{id:t,isPinned:a}=s,{saved:o}=e.chats.orderedPinnedIds;let n=o||[];return a?n.includes(t)||(n=[t,...n]):n=n.filter(e=>e!==t),{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:n.length?n:void 0}}}}case"updateChatListType":{const{id:t,folderId:a}=s;return(0,A.KrP)(e,t,a)}case"updateChatFolder":{const{id:t,folder:a}=s,{byId:o,orderedIds:n}=e.chatFolders,i=void 0===a;Object.values(e.byTabId).forEach(s=>{let{id:a}=s;const n=(0,C.nTw)(e,a);Object.values(o)[n.activeChatFolder-1]?.id===t&&(e=(0,M.w)(e,{activeChatFolder:0},a))});const r=i?(0,h.cJ)(o,[t]):{...o,[t]:a},d=i?n?.filter(e=>e!==t):n?.includes(t)?n:[...n||[],t];return{...e,chatFolders:{...e.chatFolders,byId:r,orderedIds:d,invites:(0,h.cJ)(e.chatFolders.invites,[t])}}}case"updateChatFoldersOrder":{const{orderedIds:t}=s;return{...e,chatFolders:{...e.chatFolders,orderedIds:t}}}case"updateRecommendedChatFolders":{const{folders:t}=s;return{...e,chatFolders:{...e.chatFolders,recommended:t}}}case"updateChatMembers":{const t=(0,C.AWZ)(e,s.id),{replacedMembers:a,addedMember:o,deletedMemberId:n}=s;if(!t)return;let i=!1,r=t?.members?[...t.members]:[];if(a)r=a,i=!0;else if(o)r.length&&r.some(e=>e.userId===o.userId)||(r.push(o),i=!0);else if(r.length&&n){const e=r.findIndex(e=>e.userId===n);e>-1&&(r.slice(e,1),i=!0)}if(i){const t=r.filter(e=>{let{isOwner:t,isAdmin:s}=e;return t||s});return e=(0,A.wix)(e,s.id,{membersCount:r.length}),e=(0,A.ltr)(e,s.id,{members:r,adminMembersById:(0,h.dU)(t,"userId")})}return}case"draftMessage":{const{chatId:t,threadId:a,draft:o}=s;if(!e.chats.byId[t])return;return e=(0,A.eww)(e,t,a||n.l3,"draft",o),e=(0,A.wix)(e,t,{draftDate:o?.date})}case"updatePendingJoinRequests":{const{chatId:a,requestsPending:o,recentRequesterIds:n}=s;if(!e.chats.byId[a])return;return e=(0,A.ltr)(e,a,{requestsPending:o,recentRequesterIds:n}),(0,w.UF)(e),void t.loadChatJoinRequests({chatId:a})}case"updatePinnedTopic":{const{chatId:t,topicId:a,isPinned:o}=s;if(!e.chats.byId[t])return;return e=(0,A.TwA)(e,t,a,{isPinned:o}),void(0,w.UF)(e)}case"updatePinnedTopicsOrder":{const{chatId:t,order:a}=s;if(!e.chats.byId[t])return;return e=(0,A.mPd)(e,t,a),void(0,w.UF)(e)}case"updateTopic":{const{chatId:a,topicId:o}=s,n=(0,C.hds)(e,a);if(!n?.isForum)return;return void t.loadTopicById({chatId:a,topicId:o})}case"updateTopics":{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o?.isForum)return;return void t.loadTopics({chatId:a,force:!0})}case"updateViewForumAsMessages":{const{chatId:t,isEnabled:a}=s,o=(0,C.hds)(e,t);if(!o?.isForum)return;e=(0,A.wix)(e,t,{isForumAsMessages:a}),(0,w.UF)(e);break}case"updateNewProfilePhoto":{const{peerId:a,photo:o}=s;e=(0,A.wix)(e,a,{avatarPhotoId:o.id}),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0});break}case"updateDeleteProfilePhoto":{const{peerId:a,photoId:o}=s,n=(0,C.PVB)(e,a);if(!n)return;o&&n.avatarPhotoId!==o?e=(0,A.sol)(e,a,o):(e=(0,A.wix)(e,a,{avatarPhotoId:void 0}),e=(0,A.Khb)(e,a,void 0)),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0});break}}});const Rt=(0,s(8718).By)(function(){let e=(0,w.mS)();e=(0,A.wWy)(e,{...e.users.statusesById,...Nt}),(0,w.UF)(e),Nt={}});let Nt={};(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"deleteContact":return(0,A.MOQ)(e,s.id);case"updateUser":{Object.values(e.byTabId).forEach(a=>{let{id:o}=a;(0,C.nZ4)(e,s.id)&&s.user.isPremium!==(0,C.g29)(e)&&(s.user.isPremium&&e.byTabId[o].premiumModal&&t.openPremiumModal({isSuccess:!0,tabId:o}),e={...e,translations:{byChatId:{}}})});const a=(0,C.mBe)(e,s.id);return e=(0,A.TKu)(e,s.id,s.user),s.fullInfo&&(e=(0,A.weB)(e,s.id,s.fullInfo)),a?.areStoriesHidden!==s.user.areStoriesHidden&&(e=(0,A.VWO)(e,s.id,s.user.areStoriesHidden||!1)),e}case"updateRequestUserUpdate":t.loadFullUser({userId:s.id});break;case"updateUserEmojiStatus":return e=(0,A.TKu)(e,s.userId,{emojiStatus:s.emojiStatus}),e=(0,A.wix)(e,s.userId,{emojiStatus:s.emojiStatus});case"updateUserStatus":return Nt[s.userId]=s.status,void Rt();case"updateUserFullInfo":{const{id:t,fullInfo:a}=s;return(0,A.weB)(e,t,a)}case"updateBotMenuButton":{const{botId:t,button:a}=s,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,A.weB)(e,t,{botInfo:{...o.botInfo,menuButton:a}})}case"updateBotCommands":{const{botId:t,commands:a}=s,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,A.weB)(e,t,{botInfo:{...o.botInfo,commands:a}})}case"updatePeerSettings":{const{id:a,settings:o}=s,n=(0,C.vGo)(e,a);return n?.botInfo?e=(0,A.weB)(e,a,{settings:o}):void t.loadFullUser({userId:a})}}}),(0,w.aJ)("apiUpdate",(e,t,s)=>{if("updateStickerSet"===s["@type"])return(0,A.v9P)(e,s.id,s.stickerSet)}),(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateEntities":{const{users:t,chats:a,threadInfos:o,polls:n,webPages:i}=s;t&&(e=(0,A.g18)(e,t)),a&&(e=(0,A.Nl5)(e,a)),o&&(e=(0,A.Ng8)(e,o)),n&&n.forEach(t=>{e=(0,A.J81)(e,t.id,t)}),i&&i.forEach(t=>{e="full"===t.webpageType?(0,A.Cfr)(e,t.id,t):(0,A.o7c)(e,t.id,t)}),(0,w.UF)(e);break}case"updatePeerBlocked":return s.isBlocked?(0,A.P6h)(e,s.id):s.isBlockedFromStories?e:(0,A.OW3)(e,s.id);case"updateResetContactList":e={...e,contactList:{userIds:[]}},(0,w.UF)(e);break;case"updateConfig":t.loadConfig();break;case"updateNewAuthorization":t.loadAuthorizations();break;case"updateFavoriteStickers":t.loadFavoriteStickers();break;case"updateRecentStickers":t.loadRecentStickers();break;case"updateRecentReactions":t.loadRecentReactions();break;case"updateRecentEmojiStatuses":t.loadRecentEmojiStatuses();break;case"updateSavedReactionTags":t.loadSavedReactionTags();break;case"updateMoveStickerSetToTop":{const a=s.isCustomEmoji?e.customEmojis.added.setIds:e.stickers.added.setIds;if(!a?.some(e=>e===s.id))return e;const o=[s.id,...a.filter(e=>e!==s.id)];t.reorderStickerSets({order:o,isCustomEmoji:s.isCustomEmoji});break}case"updateStickerSets":t.loadStickerSets();break;case"updateStickerSetsOrder":{const a=s.order.filter(t=>Boolean(e.stickers.setsById[t]));t.reorderStickerSets({order:a,isCustomEmoji:s.isCustomEmoji});break}case"updateSavedGifs":t.loadSavedGifs();break;case"updatePrivacy":e={...e,settings:{...e.settings,privacy:{...e.settings.privacy,[s.key]:s.rules}}},(0,w.UF)(e);break;case"updatePaymentVerificationNeeded":Object.values(e.byTabId).forEach(t=>{let{id:a}=t;e=(0,A._te)(e,s.url,a),e=(0,A.lwH)(e,i.tn.ConfirmPayment,a)}),(0,w.UF)(e);break;case"updateWebViewResultSent":Object.values(e.byTabId).forEach(e=>{Object.entries(e.webApps.openedWebApps).forEach(a=>{let[o,n]=a;n.queryId===s.queryId&&(t.resetDraftReplyInfo({tabId:e.id}),t.closeWebApp({key:o,tabId:e.id}))})});break;case"updateWebPage":{const{webPage:t}=s;e="full"===t.webpageType?(0,A.Cfr)(e,t.id,t):(0,A.o7c)(e,t.id,t),(0,w.UF)(e);break}case"updateStory":e=(0,A.K4v)(e,s.peerId,{[s.story.id]:s.story}),e=(0,A.Gzl)(e,{[s.peerId]:(0,C._bp)(e,s.peerId)}),(0,w.UF)(e);break;case"deleteStory":e=(0,A.ONz)(e,s.peerId,s.storyId),(0,w.UF)(e);break;case"updateReadStories":e=(0,A.Ahb)(e,s.peerId,s.lastReadId),(0,w.UF)(e);break;case"updateSentStoryReaction":{const{peerId:t,storyId:a,reaction:o}=s;if(!(0,C.Msb)(e,t,a))return e;e=(0,A.Xzz)(e,t,a,{sentReaction:o}),(0,w.UF)(e);break}case"updateStealthMode":e=(0,A.qsx)(e,s.stealthMode),(0,w.UF)(e);break;case"updateAttachMenuBots":t.loadAttachBots();break;case"updatePremiumFloodWait":t.processPremiumFloodWait({isUpload:s.isUpload});break;case"updatePaidReactionPrivacy":e={...e,settings:{...e.settings,paidReactionPrivacy:s.private}},(0,w.UF)(e);break;case"updateLangPackTooLong":(0,p.eg)(s.langCode);break;case"updateLangPack":(0,p.DV)(s.version,s.strings,s.keysToRemove);break;case"newMessage":{const o=s.message.content?.action;if(!s.message.isOutgoing&&s.message.chatId!==a.zv8)return;if("starGiftUnique"!==o?.type)return;const n=o.gift;Object.values(e.byTabId).forEach(a=>{let{id:o}=a;const i=(0,C.nTw)(e,o);if(i.isWaitingForStarGiftUpgrade&&(t.openUniqueGiftBySlug({slug:n.slug,tabId:o}),t.showNotification({title:{key:"GiftUpgradedTitle"},message:{key:"GiftUpgradedDescription"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),e=(0,M.w)(e,{isWaitingForStarGiftUpgrade:void 0},o)),i.isWaitingForStarGiftTransfer){const a=s.message.chatId,i=a?(0,C.PVB)(e,a):void 0;i&&(t.focusMessage({chatId:i.id,messageId:s.message.id,tabId:o}),t.showNotification({message:{key:"GiftTransferSuccessMessage",variables:{gift:{key:"GiftUnique",variables:{title:n.title,number:n.number}},peer:(0,S.F9)((0,p.Yw)(),i)}},tabId:o})),t.requestConfetti({withStars:!0,tabId:o}),e=(0,M.w)(e,{isWaitingForStarGiftTransfer:void 0},o)}}),(0,w.UF)(e)}}}),(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateDefaultNotifySettings":return(0,A.p92)(e,s.peerType,s.settings);case"updateChatNotifySettings":{const{chatId:t,settings:a}=s;e=(0,A.m1I)(e,t,a),(0,w.UF)(e);break}case"updateTopicNotifySettings":{const{chatId:t,topicId:a,settings:o}=s;e=(0,A.TwA)(e,t,a,{notifySettings:o}),(0,w.UF)(e);break}}}),(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateTwoFaStateWaitCode":return{...e,twoFaSettings:{...e.twoFaSettings,isLoading:!1,waitingEmailCodeLength:s.length}};case"updateTwoFaError":return{...e,twoFaSettings:{...e.twoFaSettings,errorKey:s.messageKey}}}});var Jt=s(80840),Et=s(71331);(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateGroupCall":{if("discarded"===s.call.connectionState)return e.groupCalls.activeGroupCallId?void("leaveGroupCall"in t&&t.leaveGroupCall({shouldRemove:!0,tabId:(0,u.g0)()})):(0,Jt.um)(e,s.call.id);const a=(0,Et.Ip)(e,s.call.id),o=a?.chatId;return o&&(e=(0,A.wix)(e,o,{isCallNotEmpty:a.participantsCount>0||Boolean(a.participants?.length)})),(0,Jt.h9)(e,s.call.id,(0,h.cJ)(s.call,["connectionState"]),void 0,s.call.participantsCount)}case"updateGroupCallChatId":return(0,C.hds)(e,s.chatId)&&(e=(0,A.ltr)(e,s.chatId,{groupCallId:s.call.id})),e;case"updateGroupCallParticipants":{const{groupCallId:t,participants:a,nextOffset:o}=s,{currentUserId:n}=e;e=(0,w.mS)(),a.forEach(s=>{s.id&&(e=(0,Jt.c5)(e,t,s.id,s,Boolean(o)||n===s.id))}),o&&(e=(0,Jt.h9)(e,t,{nextOffset:o}));const i=(0,Et.Ip)(e,t),r=i?.chatId;return r&&(e=(0,A.wix)(e,r,{isCallNotEmpty:i.participantsCount>0||Boolean(i.participants?.length)})),e}case"updatePhoneCall":{if(!d.OL)return;const{phoneCall:a,currentUserId:o}=e,{call:n}=s;if(a)return"discarded"===n.state?(t.playGroupCallSound({sound:"end"}),"hangUp"in t&&t.hangUp({tabId:(0,u.g0)()}),{...e,...n.needRating&&{ratingPhoneCall:n}}):void 0;if(n?.adminId!==o&&"requested"===n.state)return(0,I.aj)(()=>{e=(0,w.mS)();const t=(0,Et.uu)(e);t&&(0,F.DJ)({call:n,user:t})}),(0,Pt.JD)(),(0,Pt.re)(e,t,n.isVideo,(0,u.g0)()),e={...e,phoneCall:n},(0,M.w)(e,{isCallPanelVisible:!1},(0,u.g0)())}}});var Lt=s(17142);(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updatePaymentStateCompleted":{const{paymentState:a,tabId:o}=s,n=a.form,{invoice:i}=n,{totalAmount:r,currency:d}=i,c=a.inputInvoice;if("stars"===c?.type)t.closeStarsBalanceModal({tabId:o}),t.showNotification({message:f.yE("StarsAcquiredInfo",c.stars),title:f.yE("StarsAcquired"),icon:"star",tabId:o}),t.requestConfetti({withStars:!0,tabId:o});else if("giftcode"===c?.type){const s=(0,C.nTw)(e,o).giftModal;s&&c?.userIds[0]===s.forPeerId&&(t.showNotification({message:{key:"GiftSent"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}else t.showNotification({tabId:o,message:f.yE("PaymentInfoHint",[(0,Lt.Ad)(r,d,f.Yw().code),n.title])});(0,w.UF)(e);break}case"updateStarPaymentStateCompleted":{const{paymentState:a,tabId:o}=s,{inputInvoice:n,subscriptionInfo:i,form:r}=a;if("chatInviteSubscription"===n?.type&&i){const e=i.subscriptionPricing.amount;t.showNotification({tabId:o,title:f.yE("StarsSubscriptionCompleted"),message:f.yE("StarsSubscriptionCompletedText",[e,i.title],void 0,e),icon:"star"})}if(r?.invoice.subscriptionPeriod){const e=r.invoice.totalAmount;t.showNotification({tabId:o,title:f.yE("StarsSubscriptionCompleted"),message:f.yE("StarsSubscriptionCompletedText",[e,r.title],void 0,e),icon:"star"})}if("giftcode"===n?.type){if(!n.userIds)return;const s=(0,C.nTw)(e,o).giftModal;s&&n.userIds[0]===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("premiumGiftStars"===n?.type){const s=(0,C.nTw)(e,o).giftModal;s&&n.userId===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("starsgift"===n?.type){if(!n.userId)return;const t=(0,C.nTw)(e,o).starsGiftModal;t?.isOpen&&n.userId===t.forUserId&&(e=(0,M.w)(e,{starsGiftModal:{...t,isCompleted:!0}},o))}if("stargift"===n?.type){if(!n.peerId)return;const s=(0,C.nTw)(e,o).giftModal;s&&n.peerId===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("stargiftResale"===n?.type){const s=(0,C.nTw)(e,o).giftInfoModal;s&&(t.showNotification({message:{key:"StarsGiftBought"},tabId:o}),s.peerId&&t.reloadPeerSavedGifts({peerId:s.peerId}),t.reloadPeerSavedGifts({peerId:n.peerId}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftInfoModal({tabId:o}))}"stargiftUpgrade"===n?.type&&e.currentUserId&&t.reloadPeerSavedGifts({peerId:e.currentUserId});break}case"updateStarsBalance":e=(0,A.L_F)(e,s.balance),(0,w.UF)(e),t.loadStarStatus()}});var Yt=s(84051),Dt=s(61433),Ot=s(66644),Gt=s(87357),Vt=s(25903),jt=s(55148),qt=s(80089),zt=s(32625),Kt=s(14737),Wt=s(30857),Ht=s(39351),_t=s(17712);const $t=document.querySelector('meta[name="viewport"]'),Xt=$t?.getAttribute("content")||"";function Qt(e){e.preventDefault()}var Zt=s(34201),es=s(35297),ts=s(61157),ss=s(60138),as=s(90423),os=s(80464),ns=s(20021);const is=e=>{const{isActive:t}=e,s=(0,os.A)(qt.ar.Calls,"ActiveCallHeader",!t);return s?(0,ns.Y)(s,{}):void 0},rs=e=>{const{groupCallId:t}=e,s=(0,os.A)(qt.ar.Calls,"GroupCall",!t);return s?(0,ns.Y)(s,{...e}):void 0},ds=e=>{const{isActive:t}=e,s=(0,os.A)(qt.ar.Calls,"PhoneCall",!t);return s?(0,ns.Y)(s,{}):void 0},cs=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Calls,"RatePhoneCallModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},ls=e=>{const{customEmojiSetIds:t}=e,s=(0,os.A)(qt.ar.Extra,"CustomEmojiSetsModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},us=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"DeleteMessageModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},hs=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"StickerSetModal",!t);return s?(0,ns.Y)(s,{...e}):void 0};var ms=s(26120),ps=s(14242),gs=s(74984);const fs=(0,Yt.ph)(e=>{let{isForAppBadge:t}=e;(0,gs.ic)();const s=(0,Fe.vp)(),a=(0,Ht.A)();if((0,Yt.vJ)(()=>{t&&(0,ms.q)(s)},[t,s]),!t&&s)return(0,ns.Y)("div",{className:"unread-count active",children:(0,ps.Vw)(a,s)})});var Is=s(11778),vs=s(31460),bs=s(55994),ys=s(31880),Ss=s(2178),ws=s(29886),As=s(41257),Ms=s(41036),Cs=s(52745);const Ps=e=>{const t=(0,os.A)(qt.ar.Extra,"ArchivedChats");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})};var ks=s(11462),Fs=s(59030),Ts=s(50680),xs=s(64493),Us=s(18276),Bs=s(71429),Rs=s(24433);const Ns=e=>{let{isShown:t,onNewPrivateChat:s,onNewChannel:a,onNewGroup:o,isAccountFrozen:n}=e;const[i,r]=(0,Yt.J0)(!1),{openFrozenAccountModal:d}=(0,w.ko)();(0,Yt.vJ)(()=>{t||r(!1)},[t]);const c=(0,Fs.A)(),l=(0,Gt.A)("NewChatButton",t&&"revealed",i&&"menu-is-open"),u=(0,Yt.hb)(()=>{n?d():r(!i)},[i,n]),h=(0,Yt.hb)(()=>{r(!1)},[]),m=(0,Yt.Kr)(()=>(0,ns.FD)(ns.FK,{children:[(0,ns.Y)(Rs.A,{icon:"channel",onClick:a,children:c("NewChannel")}),(0,ns.Y)(Rs.A,{icon:"group",onClick:o,children:c("NewGroup")}),(0,ns.Y)(Rs.A,{icon:"user",onClick:s,children:c("NewMessageTitle")})]}),[c,a,o,s]);return(0,ns.FD)("div",{className:l,dir:c.isRtl?"rtl":void 0,children:[(0,ns.FD)(xs.A,{round:!0,color:"primary",className:i?"active":"",onClick:u,ariaLabel:c(i?"Close":"NewMessageTitle"),tabIndex:-1,children:[(0,ns.Y)(Us.A,{name:"new-chat-filled"}),(0,ns.Y)(Us.A,{name:"close"})]}),(0,ns.Y)(Bs.A,{isOpen:i,positionX:c.isRtl?"left":"right",positionY:"bottom",autoClose:!0,onClose:h,children:m})]})},Js=e=>{const t=(0,os.A)(qt.ar.Extra,"LeftSearch");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})};var Es=s(50442),Ls=s(79824),Ys=s(18501),Ds=s(19129),Os=s(26072),Gs=s(75343),Vs=s(24680),js=s(41118);const qs=(0,Yt.ph)((0,w.EK)(e=>{const{chatFolders:{byId:t,orderedIds:s,invites:a},chats:{listIds:{archived:o}},stories:{orderedPeerIds:{archived:n}},activeSessions:{byHash:i},currentUserId:r,archiveSettings:d}=e,{animationLevel:c}=(0,je.l)(e),{shouldSkipHistoryAnimations:l,activeChatFolder:u}=(0,C.nTw)(e),{storyViewer:{isRibbonShown:h}}=(0,C.nTw)(e),m=(0,C.trm)(e);return{chatFoldersById:t,folderInvitesById:a,orderedFolderIds:s,activeChatFolder:u,currentUserId:r,animationLevel:c,shouldSkipHistoryAnimations:l,hasArchivedChats:Boolean(o?.length),hasArchivedStories:Boolean(n?.length),maxFolders:(0,fe.d)(e,"dialogFilters"),maxFolderInvites:(0,fe.d)(e,"chatlistInvites"),maxChatLists:(0,fe.d)(e,"chatlistJoined"),archiveSettings:d,isStoryRibbonShown:h,sessions:i,isAccountFrozen:m}})(e=>{let{foldersDispatch:t,chatFoldersById:s,orderedFolderIds:o,activeChatFolder:n,currentUserId:r,isForumPanelOpen:c,animationLevel:l,shouldSkipHistoryAnimations:u,maxFolders:h,maxChatLists:m,shouldHideFolderTabs:p,folderInvitesById:g,maxFolderInvites:f,hasArchivedChats:I,hasArchivedStories:v,archiveSettings:b,isStoryRibbonShown:y,sessions:S,isAccountFrozen:A}=e;const{loadChatFolders:M,setActiveChatFolder:P,openChat:k,openShareChatFolderModal:F,openDeleteChatFolderModal:T,openEditChatFolder:x,openLimitReachedModal:U,markChatMessagesRead:B,openSettingsScreen:R}=(0,w.ko)(),N=(0,Yt.li)(),J=(0,Ht.A)();(0,Yt.vJ)(()=>{M()},[]);const{ref:E,shouldRender:L,getIsClosing:Y}=(0,Zt.A)({isOpen:y,className:!1,withShouldRender:!0}),D=(0,Ds.A)(Y),O=(0,_t.A)(()=>{const e=E.current?.querySelector(".chat-list.Transition_slide-active");e?.scrollTo({top:0,behavior:"smooth"})}),G=(0,Yt.Kr)(()=>({id:a.DSF,title:{text:o?.[0]===a.DSF?J("FilterAllChatsShort"):J("FilterAllChats")},includedChatIds:Ls.p,excludedChatIds:Ls.p}),[o,J]),V=(0,Yt.Kr)(()=>o?o.map(e=>e===a.DSF?G:s[e]||{}).filter(Boolean):void 0,[s,G,o]),j=V?.findIndex(e=>e.id===a.DSF),q=j===n,z=0===n,K=(0,gs.Jm)(),W=(0,_t.A)(e=>{const t=K[e];t?.length&&t.forEach(e=>{B({id:e})})}),H=(0,gs.ic)(),_=(0,Yt.Kr)(()=>{if(V&&V.length)return V.map((e,t)=>{const{id:o,title:n}=e,r=o!==a.DSF&&t>h-1,d=[];return(0,C.w5O)((0,w.mS)(),o)&&d.push({title:J("FilterShare"),icon:"link",handler:()=>{Object.values(s).reduce((e,t)=>e+(t.isChatList?1:0),0)>=m&&!e.isChatList?U({limit:"chatlistJoined"}):g[o]?.length>=f?U({limit:"chatlistInvites"}):F({folderId:o})}}),o===a.DSF?(d.push({title:J("FilterEditFolders"),icon:"edit",handler:()=>{R({screen:i.VS.Folders})}}),K[o]?.length&&d.push({title:J("ChatListMarkAllAsRead"),icon:"readchats",handler:()=>W(e.id)})):(d.push({title:J("EditFolder"),icon:"edit",handler:()=>{x({folderId:o})}}),K[o]?.length&&d.push({title:J("ChatListMarkAllAsRead"),icon:"readchats",handler:()=>W(e.id)}),d.push({title:J("FilterMenuDelete"),icon:"delete",destructive:!0,handler:()=>{T({folderId:o})}})),{id:o,title:(0,Ys.fd)({text:n.text,entities:n.entities,noCustomEmojiPlayback:e.noTitleAnimations}),badgeCount:H[o]?.chatsCount,isBadgeActive:Boolean(H[o]?.notificationsCount),isBlocked:r,contextActions:d?.length?d:void 0}})},[V,h,H,J,s,m,g,f,K,R]),$=(0,_t.A)(e=>{P({activeChatFolder:e},{forceOnHeavyAnimation:!0}),n===e&&O()});(0,Yt.vJ)(()=>{_?.length&&n>=_.length&&P({activeChatFolder:0})},[n,_,P]),(0,Yt.vJ)(()=>{if(d.TF&&_?.length&&!c)return(0,Es.wJ)(N.current,{selectorToPreventScroll:".chat-list",onSwipe:(e,t)=>t===Es.ez.Left?(P({activeChatFolder:Math.min(n+1,_.length-1)},{forceOnHeavyAnimation:!0}),!0):t===Es.ez.Right&&(P({activeChatFolder:Math.max(0,n-1)},{forceOnHeavyAnimation:!0}),!0)})},[n,_,c,P]);const X=(0,Yt.li)();X.current=!z,(0,Yt.vJ)(()=>X.current?(0,Is.A)(()=>{X.current&&P({activeChatFolder:0})}):void 0,[n,P]),(0,Os.A)({isActive:!z,onBack:()=>P({activeChatFolder:0},{forceOnHeavyAnimation:!0})}),(0,Yt.vJ)(()=>{const e=e=>{if(e.ctrlKey&&e.shiftKey&&e.code.startsWith("Digit")&&_){const[,t]=e.code.match(/Digit(\d)/)||[];if(!t)return;if("0"===t)return void k({id:r,shouldReplaceHistory:!0});const s=Number(t)-1;if(s>_.length-1)return;P({activeChatFolder:s},{forceOnHeavyAnimation:!0}),e.preventDefault()}};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[r,_,k,P]);const{ref:Q,shouldRender:Z}=(0,Zt.A)({isOpen:!o,noMountTransition:!0,withShouldRender:!0}),ee=_&&_.length>1;return(0,ns.FD)("div",{ref:E,className:(0,Gt.A)("ChatFolders",ee&&p&&"ChatFolders--tabs-hidden",L&&"with-story-ribbon"),children:[L&&(0,ns.Y)(Gs.A,{isClosing:D}),ee?(0,ns.Y)(Vs.A,{contextRootElementSelector:"#LeftColumn",tabs:_,activeTab:n,onSwitchTab:$}):Z?(0,ns.Y)("div",{ref:Q,className:"tabs-placeholder"}):void 0,(0,ns.Y)(Ms.Ay,{ref:N,name:(0,vs.P)("slideOptimized",l,u,J.isRtl),activeKey:n,renderCount:ee?_.length:void 0,children:function(e){const a=Object.values(s).find(e=>{let{id:t}=e;return t===_[n].id}),o=a&&!q;return(0,ns.Y)(js.A,{folderType:o?"folder":"all",folderId:o?a.id:void 0,isActive:e,isForumPanelOpen:c,foldersDispatch:t,isMainList:!0,canDisplayArchive:(I||v)&&!b.isHidden,archiveSettings:b,sessions:S,isAccountFrozen:A,withTags:!0})}})]})})),zs=e=>{const t=(0,os.A)(qt.ar.Extra,"ContactList");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})};var Ks=s(90054);let Ws=function(e){return e[e.waitingForNetwork=0]="waitingForNetwork",e[e.syncing=1]="syncing",e[e.online=2]="online",e}({});function Hs(e,t,s,a,o,n){let i,r,d;return i=function(){const[e,t]=(0,Yt.J0)(window.navigator.onLine);return(0,Yt.vJ)(()=>{function e(){t(window.navigator.onLine)}return window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("offline",e),window.removeEventListener("online",e)}},[]),e}()&&"connectionStateConnecting"!==t?s?Ws.syncing:Ws.online:Ws.waitingForNetwork,r=i===Ws.online||n?"none":a?"middleHeader":o?"minimized":"overlay",i===Ws.waitingForNetwork?d=e("WaitingForNetwork"):i===Ws.syncing&&(d=e("Updating")),"middleHeader"===r&&(d=d.toLowerCase().replace(/\.+$/,"")),{connectionStatus:i,connectionStatusPosition:r,connectionStatusText:d}}var _s=s(37661),$s=s(24920),Xs=s(10187),Qs=s(40175),Zs=s(22699),ea=s(36393),ta=s(26607),sa=s(57474);const aa=(0,Yt.ph)(e=>{let{connectionStatus:t,connectionStatusText:s,onClick:a}=e;const o=(0,Fs.A)();return(0,ns.FD)("div",{id:"ConnectionStatusOverlay",dir:o.isRtl?"rtl":void 0,onClick:a,children:[(0,ns.Y)(sa.A,{color:"black"}),(0,ns.Y)("div",{className:"state-text",children:(0,ns.Y)(Ms.Ay,{activeKey:t,name:"slideFade",children:s})}),(0,ns.Y)(xs.A,{round:!0,size:"tiny",color:"translucent-black",children:(0,ns.Y)(Us.A,{name:"close"})})]})});var oa=s(4029),na=s(19800),ia=s(54639),ra=s(60859),da=s(63152),ca=s(629),la=s(4350),ua=s(93855),ha=s(21849),ma=s(34431);const pa=(0,Yt.ph)(e=>{let{currentUser:t,totalLimit:s,onSelectCurrent:a}=e;const{showNotification:o}=(0,w.ko)(),n=(0,Ht.A)(),i=(0,ua.A)(t),r=(0,y.Em)(),d=(0,y.SM)(),c=(0,Yt.Kr)(()=>Object.values(i).find(e=>e.userId===t.id),[i,t.id]),l=r>=d,u=(0,_t.A)(()=>{o({title:n("PremiumLimitAccountsTitle"),message:t.isPremium?n("PremiumLimitAccounts"):n("PremiumLimitAccountsNoPremium"),duration:7e3})}),h=(0,Yt.Kr)(()=>{if(!Object.values(i).length)return;if(r===s)return;let e=1;for(;i[e];)e+=1;return(0,la.Nv)(e,!0)},[i,r,s]);return(0,ns.FD)(ns.FK,{children:[Object.entries(i||{}).sort(e=>{let[,s]=e;return s.userId===t.id?-1:1}).map((e,s,o)=>{let[n,i]=e;const r=i.isTest===c?.isTest,d={title:[i.firstName,i.lastName].filter(Boolean).join(" "),isCustomPeer:!0,peerColorId:i.color,emojiStatusId:r?i.emojiStatusId:void 0,isPremium:i.isPremium},l=i.userId===t.id&&(h||o.length>1);return(0,ns.FD)(ns.FK,{children:[(0,ns.FD)(Rs.A,{className:"account-menu-item",customIcon:(0,ns.Y)(ha.A,{size:"mini",className:"account-avatar",peer:d,previewUrl:i.avatarUri}),onClick:i.userId===t.id?a:void 0,href:i.userId!==t.id?(0,la.Nv)(Number(n)):void 0,children:[i.isTest&&(0,ns.Y)("span",{className:"account-menu-item-test",children:"T"}),(0,ns.Y)(ma.A,{peer:d,withEmojiStatus:!0,emojiStatusSize:U.$})]}),l&&(0,ns.Y)(ra.A,{})]})}),h&&(0,ns.Y)(Rs.A,{icon:"add",rel:"noopener",href:l?void 0:h,onClick:l?u:void 0,children:n("MenuAddAccount")})]})}),ga=(0,Yt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{currentUserId:s,archiveSettings:a}=e,{animationLevel:o}=(0,je.l)(e),n=e.attachMenu.bots;return{currentUserId:s,currentUser:(0,C.mBe)(e,s),theme:(0,C.SJA)(e),animationLevel:o,canInstall:Boolean(t.canInstall),archiveSettings:a,attachBots:n,accountsTotalLimit:(0,fe.B)(e,"moreAccounts")}})(e=>{let{currentUserId:t,archiveSettings:s,animationLevel:o,theme:n,canInstall:i,attachBots:r,currentUser:d,accountsTotalLimit:c,onSelectArchived:l,onSelectContacts:u,onSelectSettings:h,onBotMenuOpened:m,onBotMenuClosed:p}=e;const{openChat:g,setSharedSettingOption:f,updatePerformanceSettings:I,openChatByUsername:v,openUrl:b,openChatWithInfo:y}=(0,w.ko)(),S=(0,Ht.A)(),A=o!==a.dnp?o===a.zP3?"max":"mid":"min",M=!gt.Vq&&(window.location.hostname===a.mFn||a.W75),C=(0,gs.ic)()[a._E9]?.chatsCount||0,P=(0,Yt.Kr)(()=>Object.values(r).filter(e=>e.isForSideMenu),[r]),k=(0,_t.A)(()=>{y({id:t,shouldReplaceHistory:!0,profileTab:"stories"})}),F=(0,_t.A)(()=>{g({id:t,shouldReplaceHistory:!0})}),T=(0,_t.A)(e=>{e.stopPropagation(),f({theme:"light"===n?"dark":"light"}),f({shouldUseSystemTheme:!1})}),x=(0,_t.A)(e=>{e.stopPropagation();let t=o+1;t>a.zP3&&(t=a.dnp);const s=t===a.dnp?xt.PI:t===a.zP3?xt.LH:xt.tS;f({animationLevel:t,wasAnimationLevelSetManually:!0}),I(s)}),U=(0,_t.A)(()=>{window.open(a.qGQ,"_blank","noopener,noreferrer")}),B=(0,_t.A)(()=>{(0,na.Bt)("K")}),R=(0,_t.A)(()=>{v({username:S("TelegramFeaturesUsername")})}),N=(0,_t.A)(()=>{b({url:a.ukY})});return(0,ns.FD)(ns.FK,{children:[gt.vM&&d&&(0,ns.FD)(ns.FK,{children:[(0,ns.Y)(pa,{currentUser:d,totalLimit:c,onSelectCurrent:h}),(0,ns.Y)(ra.A,{})]}),(0,ns.Y)(Rs.A,{icon:"user",onClick:k,children:S("MenuMyProfile")}),(0,ns.Y)(Rs.A,{icon:"saved-messages",onClick:F,children:S("MenuSavedMessages")}),s.isHidden&&(0,ns.FD)(Rs.A,{icon:"archive",onClick:l,children:[(0,ns.Y)("span",{className:"menu-item-name",children:S("MenuArchivedChats")}),C>0&&(0,ns.Y)("div",{className:"right-badge",children:C})]}),(0,ns.Y)(Rs.A,{icon:"group",onClick:u,children:S("MenuContacts")}),P.map(e=>(0,ns.Y)(ia.A,{bot:e,theme:n,isInSideMenu:!0,canShowNew:!0,onMenuOpened:m,onMenuClosed:p})),(0,ns.Y)(Rs.A,{icon:"settings",onClick:h,children:S("MenuSettings")}),(0,ns.FD)(Rs.A,{icon:"darkmode",onClick:T,children:[(0,ns.Y)("span",{className:"menu-item-name",children:S("MenuNightMode")}),(0,ns.Y)(da.A,{id:"darkmode",label:S("dark"===n?"AriaMenuDisableNightMode":"AriaMenuEnableNightMode"),checked:"dark"===n,noAnimation:!0})]}),(0,ns.FD)(Rs.A,{icon:"animations",onClick:x,children:[(0,ns.Y)("span",{className:"menu-item-name capitalize",children:S("MenuAnimationsSwitch")}),(0,ns.Y)(ca.A,{value:A})]}),(0,ns.Y)(Rs.A,{icon:"help",onClick:R,children:S("MenuTelegramFeatures")}),(0,ns.Y)(Rs.A,{icon:"bug",onClick:N,children:S("MenuReportBug")}),a.Cmz&&(0,ns.Y)(Rs.A,{icon:"permissions",onClick:U,children:S("MenuBetaChangelog")}),M&&(0,ns.Y)(Rs.A,{icon:"K",isCharIcon:!0,href:`${a.qJR}k`,onClick:B,children:S("MenuSwitchToK")}),i&&(0,ns.Y)(Rs.A,{icon:"install",onClick:(0,oa.S)(),children:S("MenuInstallApp")})]})}));var fa=s(82117),Ia=s(87412),va=s(9267),ba=s(83594);const ya=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"StatusPickerMenu",!t);return s?(0,ns.Y)(s,{...e}):void 0},Sa=(0,Yt.ph)((0,w.EK)(e=>{const{currentUserId:t}=e,s=t?(0,C.mBe)(e,t):void 0,a=e.collectibleEmojiStatuses?.statuses,o=(0,C.trm)(e);return{emojiStatus:s?.emojiStatus,collectibleStatuses:a,isAccountFrozen:o}})(e=>{let{emojiStatus:t,collectibleStatuses:s,isAccountFrozen:o}=e;const{setEmojiStatus:n,loadCurrentUser:i,openFrozenAccountModal:r}=(0,w.ko)(),d=(0,Yt.li)(),[c,l,u]=(0,_s.A)(!1),[h,m,p]=(0,_s.A)(!1),[g,f,I]=(0,_s.A)(!1),{isMobile:b}=(0,D.Ay)(),y=t?.until?1e3*(t.until-(0,v.Fm)()):void 0;(0,Kt.A)(i,y),(0,fa.A)(e=>{let[s]=e;c&&t&&t.documentId!==s?.documentId&&(m(),u())},[t,c,m,u]);const S=(0,Yt.hb)(e=>{const t=s?.find(t=>"collectibleId"in t&&t.documentId===e.id);l(),n({emojiStatus:t||{type:"regular",documentId:e.id}})},[l,n,s]);(0,Kt.A)(p,h?1500:void 0);const A=(0,Yt.hb)(()=>{o?r():f()},[f,o]);return(0,ns.FD)("div",{className:"StatusButton extra-spacing",children:[Boolean(h&&t)&&(0,ns.Y)(ba.A,{reaction:t,isLottie:!0,className:"emoji-status-effect"}),(0,ns.Y)(xs.A,{round:!0,ref:d,ripple:!b,size:"smaller",color:"translucent",className:"emoji-status",onClick:A,children:t?(0,ns.Y)(Ia.A,{documentId:t.documentId,size:24,loopLimit:a.J$1,withSparkles:"collectible"===t?.type},t.documentId):(0,ns.Y)(va.A,{})}),(0,ns.Y)(ya,{statusButtonRef:d,isOpen:g,onEmojiStatusSelect:S,onClose:I})]})})),wa={date:void 0},Aa={id:void 0},Ma=(0,Yt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{query:s,fetchingStatus:a,chatId:o,minDate:n}=t.globalSearch,{connectionState:i,isSyncing:r,isFetchingDifference:d}=e,{isConnectionStatusMinimized:c}=(0,je.l)(e);return{searchQuery:s,isLoading:!!a&&Boolean(a.chats||a.messages||a.publicPosts),globalSearchChatId:o,searchDate:n,theme:(0,C.SJA)(e),connectionState:i,isSyncing:r,isFetchingDifference:d,isMessageListOpen:Boolean((0,C.Xf0)(e)),isConnectionStatusMinimized:c,isCurrentUserPremium:(0,C.g29)(e),areChatsLoaded:Boolean(e.chats.listIds.active),hasPasscode:Boolean(e.passcode.hasPasscode),canSetPasscode:(0,C.Ntz)(e)}})(e=>{let{shouldHideSearch:t,content:s,contactsFilter:o,isClosingSearch:n,searchQuery:r,isLoading:c,isCurrentUserPremium:l,shouldSkipTransition:u,globalSearchChatId:h,searchDate:m,theme:p,connectionState:g,isSyncing:f,isFetchingDifference:I,isMessageListOpen:v,isConnectionStatusMinimized:b,areChatsLoaded:y,hasPasscode:S,canSetPasscode:A,onSearchQuery:M,onSelectSettings:C,onSelectContacts:P,onSelectArchived:k,onReset:F}=e;const{setGlobalSearchDate:T,setSharedSettingOption:x,setGlobalSearchChatId:U,lockScreen:B,openSettingsScreen:R,searchMessagesGlobal:N}=(0,w.ko)(),J=(0,Fs.A)(),E=(0,Ht.A)(),{isMobile:L}=(0,D.Ay)(),[Y,O,G]=(0,_s.A)(),V=s===i.Bn.Contacts,j=s===i.Bn.ChatList,q=(0,Yt.Kr)(()=>m?(0,Se.A)(new Date(1e3*m)):void 0,[m]),{connectionStatus:z,connectionStatusText:K,connectionStatusPosition:W}=Hs(J,g,f||I,v,b,!y),H=(0,_t.A)(e=>{e.preventDefault(),e.stopPropagation(),S?B():R({screen:i.VS.PasscodeDisabled})});(0,Ss.v)((0,Yt.Kr)(()=>A?{"Ctrl+Shift+L":H,"Alt+Shift+L":H,"Meta+Shift+L":H,...d.lE&&{"Mod+L":H}}:void 0,[A]));const _=(0,Yt.Kr)(()=>e=>{let{onTrigger:t,isOpen:s}=e;return(0,ns.Y)(xs.A,{round:!0,ripple:j&&!L,size:"smaller",color:"translucent",className:s?"active":"",onClick:j?t:()=>F(),ariaLabel:j?J("AccDescrOpenMenu2"):"Return to chat list",children:(0,ns.Y)("div",{className:(0,Gt.A)("animated-menu-icon",!j&&"state-back",u&&"no-animation")})})},[j,L,J,F,u]),$=(0,_t.A)(()=>{r||M("")}),X=(0,_t.A)(()=>{x({isConnectionStatusMinimized:!b})}),Q=(0,_t.A)(()=>{B()}),Z=(0,_t.A)(()=>{r&&s===i.Bn.GlobalSearch&&N({type:"publicPosts",shouldResetResultsByType:!0})}),ee=Boolean(h)||s===i.Bn.GlobalSearch||s===i.Bn.Contacts,te=L?!v&&ee:ee;(0,Yt.vJ)(()=>te?(0,Is.A)(()=>F()):void 0,[te,F]);const se=s===i.Bn.Contacts?E("SearchFriends"):E("Search"),ae=a.Cmz?"10.9.73 Beta (master#1a4aae6)":a.Oig?"master#1a4aae6":"10.9.73",oe=(0,as.zk)(),{shouldDisableDropdownMenuTransitionRef:ne,handleDropdownMenuTransitionEnd:ie}=(0,$s.A)(t),re=!(te||q||h||V),de=(0,Yt.Kr)(()=>(0,ns.FD)(ns.FK,{children:[q&&(0,ns.Y)(Xs.A,{icon:"calendar",title:q,canClose:!0,isMinimized:Boolean(h),className:"left-search-picker-item",onClick:T,isCloseNonDestructive:!0,clickArg:wa}),h&&(0,ns.Y)(Xs.A,{className:"left-search-picker-item",peerId:h,onClick:U,canClose:!0,isMinimized:!0,clickArg:Aa})]}),[h,q]),ce=(0,Yt.Kr)(()=>{let e="";return gt.Vq&&window.tauri.version&&(e=`Tauri ${window.tauri.version} | `),e+=`${a.C39} ${ae}`,e},[ae]);return(0,ns.Y)("div",{className:"LeftMainHeader",children:(0,ns.FD)("div",{id:"LeftMainHeader",className:"left-header","data-tauri-drag-region":!(!gt.Vq||!d.MP)||void 0,children:[J.isRtl&&(0,ns.Y)("div",{className:"DropdownMenuFiller"}),(0,ns.Y)(Zs.A,{trigger:_,footer:ce,className:(0,Gt.A)("main-menu",J.isRtl&&"rtl",t&&J.isRtl&&"right-aligned",ne.current&&J.isRtl&&"disable-transition"),forceOpen:Y,positionX:t&&J.isRtl?"right":"left",transformOriginX:gt.Vq&&d.MP&&!oe?90:void 0,onTransitionEnd:J.isRtl?ie:void 0,children:(0,ns.Y)(ga,{onSelectArchived:k,onSelectContacts:P,onSelectSettings:C,onBotMenuOpened:O,onBotMenuClosed:G})}),(0,ns.FD)(ea.A,{inputId:"telegram-search-input",resultsItemSelector:".LeftSearch .ListItem-button",className:(0,Gt.A)(h||m?"with-picker-item":void 0,t&&"SearchInput--hidden"),value:n?void 0:o||r,focused:te,isLoading:c||"minimized"===W,spinnerColor:"minimized"===W?"yellow":void 0,spinnerBackgroundColor:"minimized"===W&&"light"===p?"light":void 0,placeholder:se,autoComplete:"off",canClose:Boolean(h||m),onChange:M,onReset:F,onFocus:$,onSpinnerClick:"minimized"===W?X:void 0,onEnter:Z,children:[de,(0,ns.Y)(Qs.A,{canShow:re})]}),l&&(0,ns.Y)(Sa,{}),S&&(0,ns.Y)(xs.A,{round:!0,ripple:!L,size:"smaller",color:"translucent",ariaLabel:`${J("ShortcutsController.Others.LockByPasscode")} (Ctrl+Shift+L)`,onClick:Q,className:(0,Gt.A)(!l&&"extra-spacing"),children:(0,ns.Y)(Us.A,{name:"lock"})}),(0,ns.Y)(ta.A,{isOpen:"overlay"===W,isCustom:!0,className:"connection-state-wrapper",children:(0,ns.Y)(aa,{connectionStatus:z,connectionStatusText:K,onClick:X})})]})})})),Ca=Object.keys(i.Bn).length/2;let Pa;const ka=(0,Yt.ph)(e=>{let{content:t,searchQuery:s,searchDate:o,isClosingSearch:n,contactsFilter:r,shouldSkipTransition:c,foldersDispatch:l,isAppUpdateAvailable:u,isForumPanelOpen:h,onSearchQuery:m,onReset:p,onTopicSearch:g,isAccountFrozen:f}=e;const{closeForumPanel:I,openLeftColumnContent:v}=(0,w.ko)(),[b,y]=(0,Yt.J0)(d.TF),[S,A]=(0,Yt.J0)(),[M,C]=(0,Yt.J0)(!1),{shouldRenderForumPanel:P,handleForumPanelAnimationEnd:k,handleForumPanelAnimationStart:F,isAnimationStarted:T}=(0,ks.A)(h),x=h&&t===i.Bn.ChatList,U=x&&T,{shouldRender:B,transitionClassNames:R}=(0,Ts.A)(u||Boolean(S)),N=(0,Yt.li)(!1),J=(0,_t.A)(()=>{t===i.Bn.ChatList&&(N.current=!0,y(!0))}),E=(0,_t.A)(()=>{N.current=!1,Pa&&(clearTimeout(Pa),Pa=void 0),Pa=window.setTimeout(()=>{N.current||y(!1)},250)}),L=(0,_t.A)(()=>{v({contentKey:i.Bn.Settings})}),Y=(0,_t.A)(()=>{v({contentKey:i.Bn.Contacts})}),D=(0,_t.A)(()=>{v({contentKey:i.Bn.Archived}),I()}),O=(0,_t.A)(async()=>{if(S)try{C(!0),await S.downloadAndInstall(),C(!1),await(window.tauri?.relaunch())}catch(e){console.error("Failed to download and install Tauri update",e)}finally{C(!1)}else window.location.reload()}),G=(0,_t.A)(()=>{v({contentKey:i.Bn.NewChannelStep1})}),V=(0,_t.A)(()=>{v({contentKey:i.Bn.NewGroupStep1})});(0,Yt.vJ)(()=>{let e;return t!==i.Bn.ChatList?e=window.setTimeout(()=>{y(!1)},250):(N.current||d.TF)&&y(!0),()=>{e&&(clearTimeout(e),e=void 0)}},[t]);const j=(0,_t.A)(()=>{window.tauri?.checkUpdate().then(e=>A(e??void 0)).catch(e=>{console.error("Tauri update check failed:",e)})});(0,Yt.vJ)(()=>{j()},[]),(0,zt.A)(j,gt.Vq&&!a.Oig?6e5:void 0);const q=(0,Fs.A)();return(0,ns.FD)("div",{id:"LeftColumn-main",onMouseEnter:d.TF?void 0:J,onMouseLeave:d.TF?void 0:E,children:[(0,ns.Y)(Ma,{shouldHideSearch:U,content:t,contactsFilter:r,onSearchQuery:m,onSelectSettings:L,onSelectContacts:Y,onSelectArchived:D,onReset:p,shouldSkipTransition:c,isClosingSearch:n}),(0,ns.Y)(Ms.Ay,{name:c?"none":"zoomFade",renderCount:Ca,activeKey:t,shouldCleanup:!0,cleanupExceptionKey:i.Bn.ChatList,shouldWrap:!0,wrapExceptionKey:i.Bn.ChatList,children:e=>{switch(t){case i.Bn.ChatList:return(0,ns.Y)(qs,{shouldHideFolderTabs:U,foldersDispatch:l,isForumPanelOpen:U});case i.Bn.GlobalSearch:return(0,ns.Y)(Js,{searchQuery:s,searchDate:o,isActive:e,onReset:p});case i.Bn.Contacts:return(0,ns.Y)(zs,{filter:r,isActive:e,onReset:p});default:return}}}),B&&(0,ns.Y)(xs.A,{fluid:!0,badge:!0,className:(0,Gt.A)("btn-update",R),onClick:O,isLoading:M,children:q("lng_update_telegram")}),P&&(0,ns.Y)(Ks.A,{isOpen:h,isHidden:!x,onTopicSearch:g,onOpenAnimationStart:F,onCloseAnimationEnd:k}),(0,ns.Y)(Ns,{isShown:b,onNewPrivateChat:Y,onNewChannel:G,onNewGroup:V,isAccountFrozen:f})]})}),Fa=e=>{const t=(0,os.A)(qt.ar.Extra,"NewChat");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})},Ta=e=>{const t=(0,os.A)(qt.ar.Extra,"Settings");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})};var xa=function(e){return e[e.Main=0]="Main",e[e.Settings=1]="Settings",e[e.Archived=2]="Archived",e[e.NewGroup=3]="NewGroup",e[e.NewChannel=4]="NewChannel",e}(xa||{});const Ua=Object.keys(xa).length/2,Ba=(0,Yt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{globalSearch:{query:s,minDate:a},shouldSkipHistoryAnimations:o,activeChatFolder:n,leftColumn:i,nextFoldersAction:r,storyViewer:{isArchivedRibbonShown:d}}=t,{currentUserId:c,passcode:{hasPasscode:l},isAppUpdateAvailable:u,archiveSettings:h}=e,{animationLevel:m}=(0,je.l)(e),p=(0,C.meB)(e),g=Boolean(p?.id),f=(0,C.clw)(e),I=t.forumPanelChatId,v=(0,C.trm)(e);return{searchQuery:s,searchDate:a,isFirstChatFolderActive:0===n,animationLevel:m,shouldSkipHistoryAnimations:o,currentUserId:c,hasPasscode:l,nextFoldersAction:r,isChatOpen:g,isAppUpdateAvailable:u,isForumPanelOpen:f,forumPanelChatId:I,isClosingSearch:t.globalSearch.isClosing,archiveSettings:h,isArchivedStoryRibbonShown:d,isAccountFrozen:v,contentKey:i.contentKey,settingsScreen:i.settingsScreen}})(function(e){let{ref:t,contentKey:s,settingsScreen:a,searchQuery:o,searchDate:n,isFirstChatFolderActive:r,animationLevel:c,shouldSkipHistoryAnimations:l,currentUserId:u,hasPasscode:h,nextFoldersAction:m,isChatOpen:p,isAppUpdateAvailable:g,isForumPanelOpen:f,forumPanelChatId:I,isClosingSearch:v,archiveSettings:b,isArchivedStoryRibbonShown:y,isAccountFrozen:S}=e;const{setGlobalSearchQuery:A,setGlobalSearchClosing:M,setGlobalSearchChatId:C,resetChatCreation:P,setGlobalSearchDate:k,loadPasswordInfo:F,clearTwoFaError:T,openChat:x,openLeftColumnContent:U,openSettingsScreen:B}=(0,w.ko)(),[R,N]=(0,Yt.J0)(""),[J,E]=(0,ys.A)(),[L,Y]=(0,Yt.J0)(0);let D=xa.Main;switch(s){case i.Bn.Archived:D=xa.Archived;break;case i.Bn.Settings:D=xa.Settings;break;case i.Bn.NewChannelStep1:case i.Bn.NewChannelStep2:D=xa.NewChannel;break;case i.Bn.NewGroupStep1:case i.Bn.NewGroupStep2:D=xa.NewGroup}const O=(0,_t.A)(e=>{function t(){U({contentKey:void 0}),B({screen:void 0}),N(""),M({isClosing:!0}),P(),setTimeout(()=>{A({query:""}),k({date:void 0}),C({id:void 0}),M({isClosing:!1}),Y(Date.now())},250)}if(!0!==e)if(s!==i.Bn.NewGroupStep2)if(s!==i.Bn.NewChannelStep2){if(s===i.Bn.NewGroupStep1){const e=document.getElementById("new-group-picker-search");e&&e.blur()}if(s===i.Bn.Settings)switch(a){case i.VS.EditProfile:case i.VS.Folders:case i.VS.General:case i.VS.Notifications:case i.VS.DataStorage:case i.VS.Privacy:case i.VS.Performance:case i.VS.ActiveSessions:case i.VS.Language:case i.VS.Stickers:case i.VS.Experimental:return void B({screen:i.VS.Main});case i.VS.GeneralChatBackground:return void B({screen:i.VS.General});case i.VS.GeneralChatBackgroundColor:return void B({screen:i.VS.GeneralChatBackground});case i.VS.PrivacyPhoneNumber:case i.VS.PrivacyAddByPhone:case i.VS.PrivacyLastSeen:case i.VS.PrivacyProfilePhoto:case i.VS.PrivacyBio:case i.VS.PrivacyBirthday:case i.VS.PrivacyGifts:case i.VS.PrivacyPhoneCall:case i.VS.PrivacyPhoneP2P:case i.VS.PrivacyForwarding:case i.VS.PrivacyGroupChats:case i.VS.PrivacyVoiceMessages:case i.VS.PrivacyMessages:case i.VS.PrivacyBlockedUsers:case i.VS.ActiveWebsites:case i.VS.TwoFaDisabled:case i.VS.TwoFaEnabled:case i.VS.TwoFaCongratulations:case i.VS.PasscodeDisabled:case i.VS.PasscodeEnabled:case i.VS.PasscodeCongratulations:return void B({screen:i.VS.Privacy});case i.VS.PasscodeNewPasscode:return void B({screen:h?i.VS.PasscodeEnabled:i.VS.PasscodeDisabled});case i.VS.PasscodeChangePasscodeCurrent:case i.VS.PasscodeTurnOff:return void B({screen:i.VS.PasscodeEnabled});case i.VS.PasscodeNewPasscodeConfirm:return void B({screen:i.VS.PasscodeNewPasscode});case i.VS.PasscodeChangePasscodeNew:return void B({screen:i.VS.PasscodeChangePasscodeCurrent});case i.VS.PasscodeChangePasscodeConfirm:return void B({screen:i.VS.PasscodeChangePasscodeNew});case i.VS.PrivacyPhoneNumberAllowedContacts:case i.VS.PrivacyPhoneNumberDeniedContacts:return void B({screen:i.VS.PrivacyPhoneNumber});case i.VS.PrivacyLastSeenAllowedContacts:case i.VS.PrivacyLastSeenDeniedContacts:return void B({screen:i.VS.PrivacyLastSeen});case i.VS.PrivacyProfilePhotoAllowedContacts:case i.VS.PrivacyProfilePhotoDeniedContacts:return void B({screen:i.VS.PrivacyProfilePhoto});case i.VS.PrivacyBioAllowedContacts:case i.VS.PrivacyBioDeniedContacts:return void B({screen:i.VS.PrivacyBio});case i.VS.PrivacyBirthdayAllowedContacts:case i.VS.PrivacyBirthdayDeniedContacts:return void B({screen:i.VS.PrivacyBirthday});case i.VS.PrivacyGiftsAllowedContacts:case i.VS.PrivacyGiftsDeniedContacts:return void B({screen:i.VS.PrivacyGifts});case i.VS.PrivacyPhoneCallAllowedContacts:case i.VS.PrivacyPhoneCallDeniedContacts:return void B({screen:i.VS.PrivacyPhoneCall});case i.VS.PrivacyPhoneP2PAllowedContacts:case i.VS.PrivacyPhoneP2PDeniedContacts:return void B({screen:i.VS.PrivacyPhoneP2P});case i.VS.PrivacyForwardingAllowedContacts:case i.VS.PrivacyForwardingDeniedContacts:return void B({screen:i.VS.PrivacyForwarding});case i.VS.PrivacyVoiceMessagesAllowedContacts:case i.VS.PrivacyVoiceMessagesDeniedContacts:return void B({screen:i.VS.PrivacyVoiceMessages});case i.VS.PrivacyGroupChatsAllowedContacts:case i.VS.PrivacyGroupChatsDeniedContacts:return void B({screen:i.VS.PrivacyGroupChats});case i.VS.TwoFaNewPassword:return void B({screen:i.VS.TwoFaDisabled});case i.VS.TwoFaNewPasswordConfirm:return void B({screen:i.VS.TwoFaNewPassword});case i.VS.TwoFaNewPasswordHint:return void B({screen:i.VS.TwoFaNewPasswordConfirm});case i.VS.TwoFaNewPasswordEmail:return void B({screen:i.VS.TwoFaNewPasswordHint});case i.VS.TwoFaNewPasswordEmailCode:return void B({screen:i.VS.TwoFaNewPasswordEmail});case i.VS.TwoFaChangePasswordCurrent:case i.VS.TwoFaTurnOff:case i.VS.TwoFaRecoveryEmailCurrentPassword:return void B({screen:i.VS.TwoFaEnabled});case i.VS.TwoFaChangePasswordNew:return void B({screen:i.VS.TwoFaChangePasswordCurrent});case i.VS.TwoFaChangePasswordConfirm:return void B({screen:i.VS.TwoFaChangePasswordNew});case i.VS.TwoFaChangePasswordHint:return void B({screen:i.VS.TwoFaChangePasswordConfirm});case i.VS.TwoFaRecoveryEmail:return void B({screen:i.VS.TwoFaRecoveryEmailCurrentPassword});case i.VS.TwoFaRecoveryEmailCode:return void B({screen:i.VS.TwoFaRecoveryEmail});case i.VS.FoldersCreateFolder:case i.VS.FoldersEditFolder:return void B({screen:i.VS.Folders});case i.VS.FoldersShare:return void B({screen:i.VS.FoldersEditFolder});case i.VS.FoldersIncludedChatsFromChatList:case i.VS.FoldersExcludedChatsFromChatList:return void B({screen:i.VS.FoldersEditFolderFromChatList});case i.VS.FoldersEditFolderFromChatList:case i.VS.FoldersEditFolderInvites:return U({contentKey:i.Bn.ChatList}),void B({screen:i.VS.Main});case i.VS.QuickReaction:case i.VS.CustomEmoji:return void B({screen:i.VS.Stickers});case i.VS.DoNotTranslate:return void B({screen:i.VS.Language});case i.VS.PrivacyNoPaidMessages:return void B({screen:i.VS.PrivacyMessages})}s===i.Bn.ChatList&&r?U({contentKey:i.Bn.GlobalSearch}):t()}else U({contentKey:i.Bn.NewChannelStep1});else U({contentKey:i.Bn.NewGroupStep1});else t()}),G=(0,_t.A)(e=>{s!==i.Bn.Contacts?(U({contentKey:i.Bn.GlobalSearch}),e!==o&&A({query:e})):N(e)}),V=(0,_t.A)(()=>{U({contentKey:i.Bn.GlobalSearch}),A({query:""}),C({id:I})});(0,Yt.vJ)(()=>{const e=s===i.Bn.Archived,t=s===i.Bn.ChatList,a=!p&&!f;return e&&a||!t&&!e||r&&a?(0,Is.A)(()=>{O()}):void 0},[r,s,O,p,f]);const j=(0,_t.A)(e=>{s!==i.Bn.GlobalSearch&&(e.preventDefault(),U({contentKey:i.Bn.GlobalSearch}))}),q=(0,_t.A)(e=>{e.preventDefault(),x({id:u,shouldReplaceHistory:!0})}),z=(0,_t.A)(e=>{e.preventDefault(),U({contentKey:i.Bn.Archived})}),K=(0,_t.A)(e=>{e.preventDefault(),U({contentKey:i.Bn.Settings})});(0,Ss.v)((0,Yt.Kr)(()=>({"Mod+Shift+F":j,...!d.$M&&{"Mod+Shift+S":q},...d.lE&&{"Mod+0":q,"Mod+9":z},...d.MP&&d.lE&&{"Mod+,":K}}),[])),(0,Yt.vJ)(()=>{T(),a===i.VS.Privacy&&F()},[T,F,a]),(0,es.A)(()=>{m&&E(m)},[E,m]);const W=(0,As.i)((0,ws.A)(D===xa.Settings?a:-1));return(0,Yt.vJ)(()=>{if(d.TF)return(0,bs.P)(t.current,{excludedClosestSelector:".ProfileInfo, .color-picker, .hue-picker",selectorToPreventScroll:"#Settings .custom-scroll",onSwipeRightStart:O,onCancel:()=>{U({contentKey:i.Bn.Settings}),B({screen:W.current})}})},[W,t]),(0,ns.Y)(Ms.Ay,{ref:t,name:(0,vs.P)("layers",c,l),renderCount:Ua,activeKey:D,shouldCleanup:!0,cleanupExceptionKey:xa.Main,shouldWrap:!0,wrapExceptionKey:xa.Main,id:"LeftColumn",withSwipeControl:!0,children:function(e){switch(D){case xa.Archived:return(0,ns.Y)(Ps,{isActive:e,onReset:O,onTopicSearch:V,foldersDispatch:E,isForumPanelOpen:f,archiveSettings:b,isStoryRibbonShown:y});case xa.Settings:return(0,ns.Y)(Ta,{isActive:e,currentScreen:a,foldersState:J,foldersDispatch:E,animationLevel:c,shouldSkipTransition:l,onReset:O});case xa.NewChannel:return(0,ns.Y)(Fa,{isActive:e,isChannel:!0,content:s,animationLevel:c,onReset:O},L);case xa.NewGroup:return(0,ns.Y)(Fa,{isActive:e,content:s,animationLevel:c,onReset:O},L);default:return(0,ns.Y)(ka,{content:s,isClosingSearch:v,searchQuery:o,searchDate:n,contactsFilter:R,foldersDispatch:E,onSearchQuery:G,onReset:O,shouldSkipTransition:l,isAppUpdateAvailable:g,isForumPanelOpen:f,onTopicSearch:V,isAccountFrozen:S})}}})})),Ra=e=>{let{isOpen:t}=e;const s=(0,os.A)(qt.ar.Extra,"MediaViewer",!t);return s?(0,ns.Y)(s,{}):void 0},Na=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"ReactionPicker",!t);return s?(0,ns.Y)(s,{...e}):void 0},Ja=(0,Yt.ph)((0,w.EK)(e=>({messageLists:(0,C.nTw)(e).messageLists}))(e=>{let{messageLists:t}=e;const{openChat:s}=(0,w.ko)(),a=()=>{s({id:void 0},{forceSyncOnIOs:!0})},o=e=>{let{chatId:t,type:s,threadId:o}=e;(0,Os.A)({isActive:!0,hash:(0,ot.az)(t,s,o),onBack:a})};return(0,ns.Y)("div",{children:t?.map((e,t)=>(0,ns.Y)(o,{...e},`${e.chatId}_${e.threadId}_${e.type}_${t}`))})}));var Ea=s(95807),La=s(65632),Ya=s(23565),Da=s(73767),Oa=s(39751),Ga=s(67054),Va=s(83414);let ja,qa;function za(e){return Math.max(0,e)}var Ka=s(48196),Wa=s(22081);const Ha=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"PrivacySettingsNoticeModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},_a=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"SeenByModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},$a=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"UnpinAllMessagesModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},Xa=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"ChatLanguageModal",!t);return s?(0,ns.Y)(s,{...e}):void 0};var Qa=s(41510);const Za=e=>{const{activeEmojiInteraction:t}=e,s=(0,os.A)(qt.ar.Extra,"EmojiInteractionAnimation",!t);return s?(0,ns.Y)(s,{...e}):void 0};var eo=s(10722);const to=(0,Yt.ph)(e=>{let{icon:t,ariaLabelLang:s,unreadCount:a,onClick:o,onReadAll:n,className:i}=e;const r=(0,Fs.A)(),d=(0,Ht.A)(),c=(0,Yt.li)(),{isContextMenuOpen:l,handleContextMenu:u,handleContextMenuClose:h,handleContextMenuHide:m}=(0,eo.A)(c,!n);return(0,ns.FD)("div",{className:(0,Gt.A)("Y2NKrpKj",i),ref:c,children:[(0,ns.Y)(xs.A,{color:"secondary",round:!0,className:"cxwA6gDO",onClick:o,onContextMenu:u,ariaLabel:r(s),children:(0,ns.Y)(Us.A,{name:t,className:"F4zNUFhH"})}),Boolean(a)&&(0,ns.Y)("div",{className:"GovSzpfQ",children:(0,ps.Vw)(d,a)}),n&&(0,ns.Y)(Bs.A,{isOpen:l,onClose:h,onCloseAnimationEnd:m,autoClose:!0,positionX:"right",positionY:"bottom",children:(0,ns.Y)(Rs.A,{icon:"readchats",onClick:n,children:r("MarkAllAsRead")})})]})}),so="UMXbiYB3",ao=(0,Yt.ph)((0,w.EK)(e=>{const t=(0,C.Xf0)(e);if(!t)return{};const{chatId:s,threadId:a,type:o}=t,i=(0,C.hds)(e,s),r=Boolean((0,C.TCk)(e)),d=i&&a===n.l3&&"thread"===o&&!r;return{messageListType:o,chatId:s,threadId:a,reactionsCount:d?i.unreadReactionsCount:void 0,unreadReactions:d?i.unreadReactions:void 0,unreadMentions:d?i.unreadMentions:void 0,mentionsCount:d?i.unreadMentionsCount:void 0,unreadCount:d?i.unreadCount:void 0}})(e=>{let{withScrollDown:t,canPost:s,messageListType:a,chatId:o,threadId:n,unreadCount:i,unreadReactions:r,unreadMentions:d,reactionsCount:c,mentionsCount:l,withExtraShift:u}=e;const{focusNextReply:h,focusNextReaction:m,focusNextMention:p,fetchUnreadReactions:g,readAllMentions:f,readAllReactions:I,fetchUnreadMentions:v}=(0,w.ko)(),b=(0,Yt.li)(),y=Boolean(c),S=Boolean(l),A=(0,_t.A)(()=>{o&&I({chatId:o,threadId:n})}),M=(0,_t.A)(()=>{o&&f({chatId:o,threadId:n})});(0,Yt.vJ)(()=>{y&&o&&!r?.length&&g({chatId:o})},[o,g,y,r?.length]),(0,Yt.vJ)(()=>{y&&o&&g({chatId:o})},[o,g,y]),(0,Yt.vJ)(()=>{S&&o&&!d?.length&&v({chatId:o})},[o,v,S,d?.length]),(0,Yt.vJ)(()=>{S&&o&&v({chatId:o})},[o,v,S]);const C=(0,_t.A)(()=>{if(t)if("thread"===a)h();else{const e=b.current.parentElement.querySelector(".Transition_slide-active > .MessageList"),t=e.querySelectorAll(".message-list-item"),s=t[t.length-1];if(!s)return;(0,nt.Ay)({container:e,element:s,position:"end",margin:20})}}),P=(0,Gt.A)("VWoOZCD5",(t||Boolean(c)||Boolean(l))&&"iozW83la",(Boolean(c)||Boolean(l))&&!t&&"UBa5kAK5",!s&&"yzzjqibi",!u&&"wDwOdyQH");return(0,ns.FD)("div",{ref:b,className:P,children:[(0,ns.Y)(to,{icon:"heart-outline",ariaLabelLang:"AccDescrReactionMentionDown",onClick:m,onReadAll:A,unreadCount:c,className:(0,Gt.A)("eO_Fz8SD",!y&&so,!S&&"gn3iLVq1")}),(0,ns.Y)(to,{icon:"mention",ariaLabelLang:"AccDescrMentionDown",onClick:p,onReadAll:M,unreadCount:l,className:!S&&so}),(0,ns.Y)(to,{icon:"arrow-down",ariaLabelLang:"AccDescrPageDown",onClick:C,unreadCount:i,className:"u62x81QI"})]})})),oo=(0,Yt.ph)(function(){const e=(0,Ht.A)(),{openFrozenAccountModal:t}=(0,w.ko)(),s=(0,_t.A)(()=>{t()});return(0,ns.FD)("div",{className:"GuZke_HG",onClick:s,children:[(0,ns.Y)("div",{className:"oLWeN4mA",children:e("ComposerTitleFrozenAccount")}),(0,ns.Y)("div",{className:"ZxTe54MY",children:e("ComposerSubtitleFrozenAccount")})]})});var no=s(21133),io=s(19408),ro=s(9718),co=s(16460);function lo(e){return"albumId"in e}function uo(e,t,s,a,o){let n;const i=[{originalDate:e[0].date,datetime:(0,Se.CS)(1e3*e[0].date),senderGroups:[[]]}];return e.forEach((r,d)=>{const c=i[i.length-1],l=c.senderGroups[c.senderGroups.length-1];r.isInAlbum?n?(n.messages.push(r),r.hasComments&&(n.commentsMessage=r),r.content.text&&!n.hasMultipleCaptions&&(n.captionMessage?(n.hasMultipleCaptions=!0,n.captionMessage=void 0):n.captionMessage=r)):n={albumId:r.groupedId,messages:[r],mainMessage:r,hasMultipleCaptions:!1}:(r.content.paidMedia?.extendedMedia.length||0)>1?l.push({albumId:`paid-${r.id}`,messages:[r],mainMessage:r,hasMultipleCaptions:!1,isPaidMedia:!0}):l.push(r);const u=e[d+1];!n||u&&u.groupedId&&u.groupedId===n.albumId||(l.push(n),n=void 0);const h=l[l.length-1];if(u&&!n){const e=(0,Se.CS)(1e3*u.date);if(c.datetime!==e){const t={originalDate:u.date,datetime:e,senderGroups:[[]]};i.push(t)}else(u.id===t||r.senderId!==u.senderId||!o&&r.paidMessageStars||u.suggestedPostInfo||r.isOutgoing!==u.isOutgoing||r.postAuthorTitle!==u.postAuthorTitle||(0,y._P)(r)&&"phoneCall"!==r.content.action?.type||(0,y._P)(u)&&"phoneCall"!==u.content.action?.type||r.inlineButtons||u.inlineButtons||u.date-r.date>600||s&&(r.id===s||h&&"mainMessage"in h&&h.mainMessage?.id===s)&&u.id!==s||a&&r.forwardInfo?.fromId!==u.forwardInfo?.fromId)&&c.senderGroups.push([])}}),i}var ho=s(54464),mo=s(37859),po=s(81686);var go=s(93545),fo=s(56133);var Io=s(82855);const vo=(0,Yt.ph)((0,w.EK)((e,t)=>{let{userId:s}=t;const{stickers:a}=e.stickers.greeting,o=(0,C.hds)(e,s);if(!o)return{};const n=(0,C.mBe)(e,s),i=(0,C.vGo)(e,s),r=(0,C.yHC)(e,o.id);return{defaultStickers:a,lastUnreadMessageId:r&&r.id!==o.lastReadInboxMessageId?r.id:void 0,connectionState:e.connectionState,currentMessageList:(0,C.Xf0)(e),businessIntro:i?.businessIntro,user:n}})(e=>{let{defaultStickers:t,connectionState:s,lastUnreadMessageId:a,currentMessageList:o,businessIntro:n,user:i}=e;const{loadGreetingStickers:r,sendMessage:d,markMessageListRead:c}=(0,w.ko)(),l=(0,Fs.A)(),u=(0,Yt.li)(),h=(0,Yt.Kr)(()=>{if(n?.sticker)return n.sticker;if(!t?.length)return;const e=Math.floor(Math.random()*t.length);return t[e]},[n?.sticker,t]);(0,Yt.vJ)(()=>{t?.length||"connectionStateReady"!==s||r()},[s,r,t]),(0,Yt.vJ)(()=>{"connectionStateReady"===s&&a&&c({maxId:a})},[s,c,a]);const m=(0,_t.A)(()=>{o&&d({sticker:{...h,isPreloadedGlobally:!0},messageList:o})}),p=n?.title||l("Conversation.EmptyPlaceholder"),g=n?.description||l("Conversation.GreetingText");return(0,ns.FD)("div",{className:"osdROIcA",children:[(0,ns.FD)("div",{className:"c3NtU3JZ",children:[(0,ns.Y)("p",{className:"n2KO1cAv",dir:"auto",children:p}),(0,ns.Y)("p",{className:"MVSedxKc",dir:"auto",children:g}),(0,ns.Y)("div",{ref:u,className:"qsfxNv7L",onClick:m,children:h&&(0,ns.Y)(Io.A,{containerRef:u,sticker:h,size:160,shouldLoop:!0})})]}),n&&(0,ns.Y)("div",{className:"WIbO6rja",children:l("Chat.EmptyStateIntroFooter",(0,y.Yg)(i))})]})}));var bo=s(52491),yo=s(64713),So=s(83868),wo=s(4961),Ao=s(62587),Mo=s(26875),Co=s(92108),Po=s(96530),ko=s(65843),Fo=s(55158);const To="ubFGDy3d",xo="kpMdEhns",Uo="mtKNWJmZ",Bo="BH_g_jqY",Ro=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s}=t;const{countryList:{phoneCodes:a}}=e,o=(0,C.hds)(e,s),n=(0,C.vGo)(e,s),i=(0,C.Ua4)(e,s);let r,d=!1;return(0,C.yps)(e,s)&&(n?r=n.botInfo:d=!0),{chat:o,userFullInfo:n,botInfo:r,isLoadingFullUser:d,phoneCodeList:a,commonChats:i}})(e=>{let{chat:t,chatId:s,botInfo:a,isLoadingFullUser:o,phoneCodeList:n,commonChats:i,userFullInfo:r,hasMessages:d}=e;const{loadCommonChats:c,openChatWithInfo:l}=(0,w.ko)(),u=(0,Fs.A)(),h=(0,Ht.A)(),{phoneCountry:m,registrationMonth:p,nameChangeDate:g,photoChangeDate:f}=r?.settings||{};(0,Yt.vJ)(()=>{c({userId:s})},[s]);const I=(0,Yt.Kr)(()=>{if(n&&m)return(0,yo.gH)(n,m)},[n,m]),v=(0,Ao.A)(a?.photo?(0,y.Fi)(a.photo):void 0),b=(0,Ao.A)(a?.gif?(0,y.sC)(a.gif,"full"):void 0),S=a?.photo?(0,y.Xn)(a.photo):a?.gif?(0,y.NZ)(a.gif):void 0,A=a&&!a.description&&!a.gif&&!a.photo,M=!I||!p,P=(0,y.Rl)(s),{width:k,height:F}=S||{},T=(0,_t.A)(e=>{(0,So.A)(e),l({id:s,shouldReplaceHistory:!0,profileTab:"commonChats",forceScrollProfileTab:!0})}),x=g&&t?(0,ns.Y)("div",{className:"local-action-message",children:(0,ns.Y)("span",{children:h("UserUpdatedName",{user:t.title,time:(0,Se.vm)(h,g)},{withNodes:!0,withMarkdown:!0})})},"security-name-message"):void 0,U=f&&t?(0,ns.Y)("div",{className:"local-action-message",children:(0,ns.Y)("span",{children:h("UserUpdatedPhoto",{user:t.title,time:(0,Se.vm)(h,f)},{withNodes:!0,withMarkdown:!0})})},"security-photo-message"):void 0,B=(0,Yt.Kr)(()=>{const e=[];if(I&&e.push([u("PrivacyPhone"),(0,ns.FD)("span",{className:"TYJGFKqJ",children:[(0,ns.Y)("span",{className:"WuX68A65",children:(0,wo.A)((0,bo.D0)(I?.iso2))}),I?.defaultName]})]),p&&e.push([h("ContactInfoRegistration"),(0,Se.BR)(h.code,p)]),r?.commonChatsCount){const t=(0,w.mS)(),s=i?.ids.slice(0,3).map(e=>(0,C.PVB)(t,e)).filter(Boolean);e.push([h("ChatNonContactUserGroups"),(0,ns.FD)(Po.A,{className:"yIJ4jRxH",onClick:T,children:[(0,ns.Y)("span",{className:"_MPDNfhr",children:h("ChatGroups",{count:r.commonChatsCount},{pluralValue:r.commonChatsCount})}),Boolean(s?.length)&&(0,ns.Y)(Mo.A,{size:"micro",peers:s}),(0,ns.Y)(Us.A,{name:"next",className:"KYcoeDmo"})]})])}return e},[h,u,I,p,i,r]);return(0,ns.FD)("div",{className:(0,Gt.A)("tFPZHCMt","empty"),children:[o&&M&&(0,ns.Y)("span",{children:u("Loading")}),A&&M&&!o&&!d&&(0,ns.Y)("span",{children:u("NoMessages")}),a&&(0,ns.FD)("div",{className:(0,Gt.A)(To,"kXKBpNnb"),style:(0,Ea.A)(k?`width: ${k}px`:void 0),children:[v&&(0,ns.Y)("img",{className:Uo,src:v,width:k,height:F,alt:"Bot info"}),b&&(0,ns.Y)(ko.A,{canPlay:!0,className:Uo,src:b,loop:!0,disablePictureInPicture:!0,muted:!0,playsInline:!0,style:(0,Ea.A)(Boolean(k)&&`width: ${k}px`,Boolean(F)&&`height: ${F}px`)}),S&&!v&&!b&&(0,ns.Y)(Fo.A,{className:Uo,width:k,height:F,forceAspectRatio:!0}),P&&(0,ns.Y)("div",{className:xo,children:u("VerifyChatInfo")}),!P&&a.description&&(0,ns.FD)("div",{className:xo,children:[(0,ns.Y)("p",{className:"H__cBlx8",children:u("BotInfoTitle")}),(0,wo.A)(a.description,["br","emoji","links"])]})]}),!M&&t&&(0,ns.FD)("div",{className:(0,Gt.A)(To,"niS9Gfcl"),children:[(0,ns.Y)("h3",{className:"RyB2zw9K",children:(0,wo.A)((0,y.Js)(h,t))}),(0,ns.Y)("p",{className:(0,Gt.A)("n9OcHdnh",Bo),children:h("ChatNonContactUserSubtitle")}),(0,ns.Y)(Co.A,{keyClassName:Bo,data:B}),!t?.isVerified&&(0,ns.FD)("div",{className:(0,Gt.A)("sCB3zhO3",Bo),children:[(0,ns.Y)(Us.A,{name:"info-filled"}),(0,ns.Y)("p",{className:"dlaTjW_s",children:h("ContactInfoNotVerified")})]})]}),x,U]})}));var No=s(4262),Jo=s(5912);const Eo=d.Ni?1e3:350;var Lo=s(63988),Yo=s(5718),Do=s(36143),Oo=s(90596);const Go="FHxnbOg6",Vo=(0,Yt.ph)((0,w.EK)((e,t)=>{const{message:s,withAvatar:a}=t,{chatId:o}=s,n=(0,C.nZ4)(e,o),i=(0,y.DX)(o),r=(0,y.Qe)(o),d=!n&&(0,y.zP)(s),c=a||d;return{sender:(0,C.Y7C)(e,s),canShowSender:c,originSender:(0,C.Szq)(e,s),isChatWithSelf:n,isRepliesChat:i,isAnonymousForwards:r}})(e=>{let{message:t,withAvatar:s,children:o,id:n,appearanceOrder:i,sender:r,canShowSender:d,originSender:c,isChatWithSelf:l,isRepliesChat:u,isAnonymousForwards:h,canPost:m}=e;const{openChat:p,updateInsertingPeerIdMention:g}=(0,w.ko)(),{forwardInfo:f}=t,I=d?r:void 0,v=(0,Ht.A)(),b=i<=0,[A,M]=(0,_s.A)(b);(0,Yt.vJ)(()=>{b||setTimeout(M,i*a.zq7)},[i,M,b]);const C=f&&(l||u||h||!I)?c:I,P=C&&(0,S.mO)(C),k=(0,_t.A)(()=>{C&&p({id:C.id})}),F=(0,_t.A)(()=>{C&&document.querySelector(a.m$5)&&g({peerId:C.id})}),T=(0,_t.A)(()=>{k()}),{ref:x,shouldRender:U}=(0,Zt.A)({isOpen:s&&A,noMountTransition:A,withShouldRender:!0}),{isContextMenuOpen:B,contextMenuAnchor:R,handleContextMenu:N,handleContextMenuClose:J,handleContextMenuHide:E}=(0,eo.A)(x),L=(0,_t.A)(()=>x.current),Y=(0,_t.A)(()=>document.querySelector(".Transition_slide-active > .MessageList")),D=(0,_t.A)(()=>x?.current?.querySelector(`.${Go} .bubble`)),O=(0,_t.A)(()=>({withPortal:!0})),G=m&&C&&(P||Boolean((0,y.Kl)(C))),V=Boolean(R)&&(P||G),j=(0,Gt.A)("sender-group-container","Tk8btfOT");return(0,ns.FD)("div",{id:n,className:j,children:[U&&(0,ns.FD)("div",{ref:x,className:"UPrRM3Ks",children:[function(){const e=!C&&f?f.hiddenUserName:void 0;return(0,ns.Y)(ha.A,{size:"small",className:"jdvqXfYh",peer:C,text:e,onClick:C?T:void 0,onContextMenu:N})}(),V&&(0,ns.Y)(Bs.A,{isOpen:B,anchor:R,getTriggerElement:L,getRootElement:Y,getLayout:O,getMenuElement:D,className:Go,onClose:J,onCloseAnimationEnd:E,withPortal:!0,autoClose:!0,children:(0,ns.FD)(ns.FK,{children:[P&&(0,ns.Y)(Rs.A,{icon:"comments",onClick:k,children:v("SendMessage")}),G&&(0,ns.Y)(Rs.A,{icon:"mention",onClick:F,children:v("ContextMenuItemMention")})]})})]}),o]})}));var jo=s(35127),qo=s(81949),zo=s(86070),Ko=s(48906),Wo=s(51644);const Ho=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"SponsoredContextMenuContainer",!t);return s?(0,ns.Y)(s,{...e}):void 0};var _o=s(25477);const $o=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s}=t;const a=(0,C.v8U)(e,s),o=(0,C.yuw)(e),n=a?(0,ut.iS)(e,a):void 0,i=n&&(0,y.$r)(o,n);return{message:a,theme:(0,C.SJA)(e),isDownloading:i,canAutoLoadMedia:a?(0,C.wwb)(e,a):void 0,canAutoPlayMedia:a?(0,C.OEt)(e,a):void 0}})(e=>{let{chatId:t,message:s,containerRef:a,theme:o,observeIntersectionForLoading:n,observeIntersectionForPlaying:r,isDownloading:c,canAutoLoadMedia:l,canAutoPlayMedia:u}=e;const{viewSponsored:h,openUrl:m,hideSponsored:p,clickSponsored:g,openMediaViewer:f,openAboutAdsModal:I}=(0,w.ko)(),v=(0,Fs.A)(),b=(0,Yt.li)(),S=(0,Yt.li)(),A=Boolean(s),{isMobile:M}=(0,D.Ay)(),{observe:C}=(0,Jo.BL)({rootRef:a,debounceMs:200,threshold:1}),{isContextMenuOpen:P,contextMenuAnchor:k,handleBeforeContextMenu:F,handleContextMenu:T,handleContextMenuClose:x,handleContextMenuHide:U}=(0,eo.A)(S,void 0,!0,d.Ni);(0,Yt.vJ)(()=>A?C(b.current,e=>{e.isIntersecting&&s?.randomId&&h({randomId:s.randomId})}):void 0,[s?.randomId,A,C,h]);const B=(0,_t.A)(()=>{p()}),{photo:R,video:N}=s?(0,y.r_)(s):{photo:void 0,video:void 0},J=N?.isGif,E=Boolean(R||N),L=(0,_t.A)(()=>{s&&(g({randomId:s.randomId,isMedia:!(!R&&!J)||void 0}),m({url:s.url,shouldSkipModal:!0}))}),Y=(0,_t.A)(()=>{s&&(g({randomId:s.randomId,isMedia:!0}),f({origin:i.TQ.SponsoredMessage,chatId:t,isSponsoredMessage:!0}))}),O=(0,_t.A)(()=>{s&&I({randomId:s.randomId,canReport:s.canReport,additionalInfo:s.additionalInfo,sponsorInfo:s.sponsorInfo})}),G=(0,Yt.Kr)(()=>{let e,t,s="";if(R||N){let s;R?s=(0,jo.yA)({media:R,isMobile:M}).width:N&&(s=(0,jo.yA)({media:N,isMobile:M}).width),s&&(s<jo.MC&&(t=s),e=Math.max((0,jo.nP)(),s))}return e&&(s=`width: ${e+0}px`),{contentWidth:t,noMediaCorners:!1,style:s}},[R,N,M]),{contentWidth:V,style:j}=G;if(s&&s.content)return(0,ns.FD)("div",{ref:S,className:"SponsoredMessage Message open sponsored-media-preview",children:[(0,ns.FD)("div",{className:"message-content media has-shadow has-solid-background has-appendix",dir:"auto",style:j,onMouseDown:e=>{(0,ho.l)(e),F(e)},onContextMenu:T,children:[(0,ns.FD)(zo.A,{peerColor:s.peerColor,className:"content-inner",dir:"auto",children:[function(){if(s)return R?(0,ns.Y)(Wo.A,{photo:R,theme:o,canAutoLoad:l,isDownloading:c,observeIntersection:n,noAvatars:!0,onClick:L,forcedWidth:V}):N?(0,ns.Y)(_o.A,{video:N,observeIntersectionForLoading:n,observeIntersectionForPlaying:r,noAvatars:!0,canAutoLoad:l,canAutoPlay:u,isDownloading:c,onClick:J?L:Y,forcedWidth:V}):void 0}(),s.photo&&(0,ns.Y)(ha.A,{size:"large",photo:s.photo,className:(0,Gt.A)("channel-avatar",v.isRtl&&"is-rtl")}),(0,ns.FD)("span",{className:(0,Gt.A)("message-title message-type",E&&"has-media"),children:[s.isRecommended?v("Message.RecommendedLabel"):v("SponsoredMessage"),(0,ns.Y)(qo.A,{onClick:O,className:"ad-about",children:v("SponsoredMessageAdWhatIsThis")})]}),function(){if(s)return(0,ns.FD)(ns.FK,{children:[(0,ns.Y)("div",{className:"message-title message-peer",dir:"auto",children:s.title}),Boolean(s.content?.text)&&(0,ns.Y)("div",{className:"text-content with-meta",dir:"auto",ref:b,children:(0,ns.Y)("span",{className:"text-content-inner",dir:"auto",children:(0,Ys.fd)({text:s.content.text.text,entities:s.content.text.entities})})}),(0,ns.Y)(xs.A,{className:"SponsoredMessage__button",size:"tiny",color:"translucent",isRectangular:!0,onClick:L,children:s.buttonText})]})}()]}),(0,ns.Y)(Ko.A,{}),(0,ns.FD)("div",{className:"message-action-buttons",children:[(0,ns.Y)(xs.A,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:v("Close"),onClick:B,children:(0,ns.Y)(Us.A,{name:"close",className:"sponsored-action-icon"})}),s.canReport&&(0,ns.Y)(xs.A,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:v("More"),onClick:T,onContextMenu:T,children:(0,ns.Y)(Us.A,{name:"more",className:"sponsored-action-icon"})})]})]}),k&&(0,ns.Y)(Ho,{isOpen:P,anchor:k,triggerRef:S,randomId:s.randomId,canReport:s.canReport,sponsorInfo:s.sponsorInfo,additionalInfo:s.additionalInfo,onClose:x,onCloseAnimationEnd:U})]},"sponsored-message")}));var Xo=s(50805);const Qo=(0,Yt.ph)(e=>{let{canShowAds:t,chatId:s,threadId:o,messageIds:r,messageGroups:c,getContainerHeight:l,isViewportNewest:u,isUnread:m,isComments:p,isEmptyThread:f,withUsers:v,isChannelChat:b,isChatMonoforum:A,noAvatars:M,containerRef:P,anchorIdRef:k,memoUnreadDividerBeforeIdRef:F,memoFirstUnreadIdRef:T,type:x,isReady:U,hasLinkedChat:B,isSchedule:R,shouldRenderAccountInfo:N,nameChangeDate:J,photoChangeDate:E,noAppearanceAnimation:L,isSavedDialog:Y,onScrollDownToggle:O,onNotchToggle:G,onIntersectPinnedMessage:V,canPost:j}=e;const{openHistoryCalendar:q}=(0,w.ko)(),z=Yt.OV,K=(0,Va.A)(()=>U&&!z(),[U,z]),W=!Y&&!R,{observeIntersectionForReading:H,observeIntersectionForLoading:_,observeIntersectionForPlaying:$}=function(e,t,s,a,o){const{markMessageListRead:n,markMentionsRead:i,animateUnreadReaction:r,scheduleForViewsIncrement:d}=(0,w.ko)(),{isMobile:c}=(0,D.Ay)(),l=c?300:500,{observe:u,freeze:h,unfreeze:m}=(0,Jo.BL)({rootRef:t,throttleMs:150},t=>{if("thread"!==e||(0,ts.g1)())return;let c=0;const l=[],u=[],h=[],m=[],p=[];t.forEach(e=>{const{isIntersecting:t,target:s}=e,{dataset:a}=s,o=Number(a.lastMessageId||a.messageId),n="true"===a.shouldUpdateViews,i=a.albumMainId?Number(a.albumMainId):void 0;t?(o>c&&(c=o),a.hasUnreadMention&&l.push(o),a.hasUnreadReaction&&u.push(o),a.isPinned&&h.push(i||o),n&&p.push(i||o)):a.isPinned&&m.push(i||o)}),s.current&&c>=s.current&&n({maxId:c}),l.length&&i({chatId:o,messageIds:l}),u.length&&r({messageIds:u}),(h.length||m.length)&&a({viewportPinnedIdsToAdd:h,viewportPinnedIdsToRemove:m}),p.length&&d({chatId:o,ids:p})});(0,ts.Ay)(h,m);const{observe:p}=(0,Jo.BL)({rootRef:t,throttleMs:Eo,margin:l}),{observe:g}=(0,Jo.BL)({rootRef:t,throttleMs:Eo});return{observeIntersectionForReading:u,observeIntersectionForLoading:p,observeIntersectionForPlaying:g}}(x,P,T,V,s),{withHistoryTriggers:X,backwardsTriggerRef:Q,forwardsTriggerRef:Z,fabTriggerRef:ee}=function(e,t,s,a,o,n,r,c,l){const{loadViewportMessages:u}=(0,w.ko)(),[h,m]=(0,Yt.Kr)(()=>"thread"===e?[(0,I.sg)(()=>u({direction:i.TN.Backwards}),1e3,!0,!1),(0,I.sg)(()=>u({direction:i.TN.Forwards}),1e3,!0,!1)]:[],[u,s]),p=(0,Yt.li)(),g=(0,Yt.li)(),f=(0,Yt.li)(),v=(0,_t.A)(()=>{if(!l)return;if(!s?.length)return r(!1),void c(!1);if(!o)return r(!0),void c(!0);const e=t.current,a=f.current;if(!e||!a)return;const{offsetHeight:i,scrollHeight:d,scrollTop:u}=e,h=a.offsetTop,m=Math.round(h-u-i),p=m<=1;0!==d&&(r(n?!p:!(m<=50)),c(!p))}),{observe:b}=(0,Jo.BL)({rootRef:t,margin:d.et},e=>{m&&h&&e.forEach(e=>{let{isIntersecting:t,target:s}=e;t&&("backwards-trigger"===s.className&&h(),"forwards-trigger"===s.className&&m())})}),y=s&&s.length>1;(0,Jo.mv)(p,y?b:void 0),(0,Jo.mv)(g,y?b:void 0);const{observe:S,freeze:A,unfreeze:M}=(0,Jo.BL)({rootRef:t,margin:100,throttleScheduler:Ot.YS},v);(0,Jo.mv)(f,S);const{observe:C,freeze:P,unfreeze:k}=(0,Jo.BL)({rootRef:t,margin:1,throttleScheduler:Ot.YS},v);(0,Jo.mv)(f,C),(0,Yt.vJ)(()=>{l&&v()},[l,v]);const F=(0,_t.A)(()=>{A(),P(),setTimeout(()=>{k(),M()},350)});(0,es.A)(F,[F,s]);const T=(0,Lo.D7)(a,200);return(0,Yo.R)(F,[F,T]),{withHistoryTriggers:y,backwardsTriggerRef:p,forwardsTriggerRef:g,fabTriggerRef:f}}(x,P,r,l,u,m,O,G,U),te=(0,Fs.A)(),se=(0,Ht.A)(),ae=(0,ns.Y)("div",{className:(0,Gt.A)("unread-divider","local-action-message"),children:(0,ns.Y)("span",{children:te("UnreadMessages")})},"unread-messages"),oe=(e,t)=>{if(e.paidMessageStars){const s=t?.messages?.length||1,a=e.paidMessageStars*s;return(0,ns.Y)("div",{className:(0,Gt.A)("local-action-message"),children:(0,ns.Y)("span",{children:e.isOutgoing?se("ActionPaidOneMessageOutgoing",{amount:(0,g.Kk)(se,a)}):(()=>{const t=(0,C.Y7C)((0,w.mS)(),e),s=t?(0,S.F9)(se,t):"";return se("ActionPaidOneMessageIncoming",{user:s,amount:(0,g.Kk)(se,a)})})()})},`paid-messages-action-${e.id}`)}},ne=e=>{if(e.suggestedPostInfo){const{price:t,scheduleDate:s}=e.suggestedPostInfo,a=(0,C.Y7C)((0,w.mS)(),e),o=a?(0,S.F9)(se,a):"",n=(0,No.Nm)(a?.id,o||se("ActionFallbackUser")),i="message"===e.replyInfo?.type&&e.replyInfo.replyToMsgId?(0,C.O5q)((0,w.mS)(),e.chatId,e.replyInfo.replyToMsgId):void 0,r=(0,y.Do)(e,i)?(0,y.EQ)(se,e,i,e.isOutgoing,n):e.isOutgoing?se("ActionSuggestedPostOutgoing",void 0,{withNodes:!0,withMarkdown:!0}):se("ActionSuggestedPostIncoming",{user:n},{withNodes:!0,withMarkdown:!0}),d=(0,h.oE)([[se("TitlePrice"),t?"TON"===t.currency?(0,g.QH)(se,(0,Lt.wD)(t.amount)):(0,g.Kk)(se,t.amount):se("SuggestMessageNoPrice")],[se("TitleTime"),s?(0,Se.e0)(s,se,te):se("SuggestMessageAnytime")]]);return(0,ns.Y)("div",{className:(0,Gt.A)("local-action-message"),children:(0,ns.FD)("span",{className:Xo.A.suggestedPostContainer,children:[(0,ns.Y)("div",{className:Xo.A.suggestedPostTitle,children:r}),Boolean(d.length)&&(0,ns.Y)(Co.A,{className:Xo.A.suggestedPostInfo,data:d})]})},`suggested-post-action-${e.id}`)}},ie=L?0:c.reduce((e,t)=>e+t.senderGroups.flat().length,0);let re=0;const de=(0,Da.A)(r),ce=Boolean(r&&de&&r[r.length-2]===de[de.length-1]),le=c.map((e,t,s)=>{const i=function(e,t,s){return e.senderGroups.map((e,a,i)=>{if(1===e.length&&!lo(e[0])&&(0,y._P)(e[0])&&"phoneCall"!==e[0].content.action?.type){const n=e[0],r=a===i.length-1&&t===s.length-1;return(0,h.oE)([n.id===F.current&&ae,(0,ns.Y)(Do.A,{message:n,threadId:o,observeIntersectionForBottom:H,observeIntersectionForLoading:_,observeIntersectionForPlaying:$,memoFirstUnreadIdRef:T,appearanceOrder:ie-++re,isJustAdded:r&&ce,isLastInList:r,getIsMessageListReady:K,onIntersectPinnedMessage:V},n.id)])}let r;const d=e.map((d,c)=>{const l=lo(d)?d.mainMessage:d,u=lo(d)?d:void 0,m=(0,y.Ie)(l),g=lo(d),I=e[c+1];l.previousLocalId&&k.current===(0,y.GZ)(l.previousLocalId)&&(k.current=(0,y.GZ)(l.id));const S=!g&&l.groupedId?l.groupedId:void 0,w=I&&!lo(I)?I.groupedId:void 0,C=l.id===o,P={isFirstInGroup:0===c,isLastInGroup:c===e.length-1,isFirstInDocumentGroup:Boolean(S&&S!==r),isLastInDocumentGroup:Boolean(S&&S!==w),isLastInList:c===e.length-1&&a===i.length-1&&t===s.length-1};r=S;const U=(0,y.sj)(l),R=(0,y.u7)(l)?`${l.date}_${U}`:U,N=!1===B||!b||Boolean(A);return(0,h.oE)([l.id===F.current&&ae,l.paidMessageStars&&!v&&oe(l,u),l.suggestedPostInfo&&ne(l),(0,ns.Y)(Oo.A,{message:l,observeIntersectionForBottom:H,observeIntersectionForLoading:_,observeIntersectionForPlaying:$,album:u,noAvatars:M,withAvatar:P.isLastInGroup&&v&&!m&&(!C||!p),withSenderName:P.isFirstInGroup&&v&&!m,threadId:o,messageListType:x,noComments:N,noReplies:!N||o!==n.l3||"scheduled"===x,appearanceOrder:ie-++re,isJustAdded:P.isLastInList&&ce,isFirstInGroup:P.isFirstInGroup,isLastInGroup:P.isLastInGroup,isFirstInDocumentGroup:P.isFirstInDocumentGroup,isLastInDocumentGroup:P.isLastInDocumentGroup,isLastInList:P.isLastInList,memoFirstUnreadIdRef:T,onIntersectPinnedMessage:V,getIsMessageListReady:K},R),l.id===o&&(0,ns.Y)("div",{className:"local-action-message",children:(0,ns.Y)("span",{children:te(f?p?"NoComments":"NoReplies":"DiscussionStarted")})},"discussion-started")])}).flat();if(!v)return d;const c=e[e.length-1],l=lo(c)?c.mainMessage:c,u=(0,y.sj)(l),m=ie-re,g=l.id===o,I=(0,y.Ie)(l),S=e[0],w=lo(S)?S.mainMessage:S,C=(0,y.sj)(w),P=`${C}-${u}`,U=C===u?`message-group-${C}`:`message-group-${C}-${u}`,R=v&&!I&&(!g||!p);return(0,ns.Y)(Vo,{id:U,message:l,withAvatar:R,appearanceOrder:m,canPost:j,children:d},P)})}(e,t,s);return(0,ns.FD)("div",{className:(0,Gt.A)("message-date-group",!(J||E)&&0===t&&"first-message-date-group"),onMouseDown:ho.l,teactFastList:!0,children:[(0,ns.Y)("div",{className:(0,Gt.A)("sticky-date",W&&"interactive"),onMouseDown:ho.l,onClick:W?()=>q({selectedAt:e.datetime}):void 0,children:(0,ns.FD)("span",{dir:"auto",children:[R&&e.originalDate===a.NkL&&te("MessageScheduledUntilOnline"),R&&e.originalDate!==a.NkL&&te("MessageScheduledOn",(0,Se.F5)(te,e.datetime,void 0,!0)),!R&&(0,Se.F5)(te,e.datetime)]})},"date-header"),i.flat()]},e.datetime)});return(0,ns.FD)("div",{className:"messages-container",teactFastList:!0,children:[X&&(0,ns.Y)("div",{ref:Q,className:"backwards-trigger"},"backwards-trigger"),N&&(0,ns.Y)(Ro,{chatId:s,hasMessages:!0},`account_info_${s}`),le.flat(),X&&(0,ns.Y)("div",{ref:Z,className:"forwards-trigger"},"forwards-trigger"),(0,ns.Y)("div",{ref:ee,className:"fab-trigger"},"fab-trigger"),t&&u&&(0,ns.Y)($o,{chatId:s,containerRef:P,observeIntersectionForLoading:_,observeIntersectionForPlaying:$},s)]})});var Zo=s(38102);const en=3*U.$,tn=(0,Yt.ph)(e=>{let{isChatWithSelf:t,type:s,isGroupChatJustCreated:a,topic:o}=e;const n=(0,Fs.A)();return"scheduled"===s?function(e){return(0,ns.Y)("div",{className:"empty",children:(0,ns.Y)("span",{children:e("ScheduledMessages.EmptyPlaceholder")})})}(n):t?function(e){return(0,ns.Y)("div",{className:"NoMessages",children:(0,ns.FD)("div",{className:"wrapper",children:[(0,ns.Y)(Us.A,{name:"cloud-download",className:"no-messages-icon"}),(0,ns.Y)("h3",{className:"title",children:e("Conversation.CloudStorageInfo.Title")}),(0,ns.FD)("ul",{className:"description",children:[(0,ns.Y)("li",{children:e("Conversation.ClousStorageInfo.Description1")}),(0,ns.Y)("li",{children:e("Conversation.ClousStorageInfo.Description2")}),(0,ns.Y)("li",{children:e("Conversation.ClousStorageInfo.Description3")}),(0,ns.Y)("li",{children:e("Conversation.ClousStorageInfo.Description4")})]})]})})}(n):a?function(e){return(0,ns.Y)("div",{className:"NoMessages",children:(0,ns.FD)("div",{className:"wrapper",dir:e.isRtl?"rtl":void 0,children:[(0,ns.Y)("h3",{className:"title",children:e("EmptyGroupInfo.Title")}),(0,ns.Y)("p",{className:"description",children:e("EmptyGroupInfo.Subtitle")}),(0,ns.FD)("ul",{className:"list-checkmarks",children:[(0,ns.Y)("li",{children:e("EmptyGroupInfo.Line1")}),(0,ns.Y)("li",{children:e("EmptyGroupInfo.Line2")}),(0,ns.Y)("li",{children:e("EmptyGroupInfo.Line3")}),(0,ns.Y)("li",{children:e("EmptyGroupInfo.Line4")})]})]})})}(n):o?function(e,t){return(0,ns.Y)("div",{className:"NoMessages",children:(0,ns.FD)("div",{className:"wrapper",children:[(0,ns.Y)(Zo.A,{topic:t,size:en,className:"no-messages-icon topic-icon"}),(0,ns.Y)("h3",{className:"title",children:e("Chat.EmptyTopicPlaceholder.Title")}),(0,ns.Y)("p",{className:"description topic-description",children:(0,wo.A)(e("Chat.EmptyTopicPlaceholder.Text"),["br"])})]})})}(n,o):(0,ns.Y)("div",{className:"empty",children:(0,ns.Y)("span",{children:n("NoMessages")})})});var sn=s(58443),an=s(64489),on=s(85118);const nn=(0,Yt.ph)((0,w.EK)((e,t)=>{let{peerId:s}=t;const a=(0,C.SJA)(e),{patternColor:o}=(0,C.Gyz)(e,a)||{};return{patternColor:o,peer:(0,C.PVB)(e,s)}})(function(e){let{patternColor:t,peer:s,paidMessagesStars:a}=e;const o=(0,Fs.A)(),n=(0,Ht.A)(),{openPremiumModal:i,openStarsBalanceModal:r}=(0,w.ko)(),d=(0,_t.A)(()=>i()),c=(0,_t.A)(()=>{r({})});if(s)return(0,ns.Y)("div",{className:"J2RfusJI",children:(0,ns.FD)("div",{className:"C90W_KKX",children:[(0,ns.FD)("div",{className:"Qi7tZATP",children:[(0,ns.Y)(an.A,{tgsUrl:sn.w.Unlock,size:54,color:t,className:"lfcZJyxp"}),(0,ns.Y)(Us.A,{name:"comments-sticker",className:"zd5EAc5e"})]}),(0,ns.Y)("span",{className:"E_YZ3IQs",children:a?n((0,S.mO)(s)?"MessagesPlaceholderPaidUser":"MessagesPlaceholderPaidChannel",{peer:(0,S.F9)(n,s),amount:(0,g.U2)(n,a,{asFont:!0,className:"C_e1ij6A",containerClassName:"IL_EHscS"})},{withNodes:!0,withMarkdown:!0}):(0,wo.A)(o("MessageLockedPremium",(0,S.F9)(n,s)),["simple_markdown"])}),(0,ns.Y)(xs.A,{color:"translucent-black",size:"default",pill:!0,onClick:a?c:d,className:"Nz8BOo0i",children:a?(0,ns.FD)(ns.FK,{children:[n("ButtonBuyStars"),(0,ns.Y)(on.A,{preset:"button"})]}):o("MessagePremiumUnlock")})]})})}));var rn=function(e){return e[e.Loading=0]="Loading",e[e.Restricted=1]="Restricted",e[e.StarsRequired=2]="StarsRequired",e[e.PremiumRequired=3]="PremiumRequired",e[e.AccountInfo=4]="AccountInfo",e[e.ContactGreeting=5]="ContactGreeting",e[e.NoMessages=6]="NoMessages",e[e.MessageList=7]="MessageList",e}(rn||{});const dn=(0,I.sg)(e=>e(),200,!1),cn=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s,threadId:o,type:i}=t;const r=e.currentUserId,d=(0,C.hds)(e,s),c=(0,C.vGo)(e,s);if(!d)return{currentUserId:r};const l=(0,C.vRX)(e,s,o,i),u="scheduled"===i?(0,C.yFI)(e,s):(0,C.zeq)(e,s),h=(0,y.cG)(s,o,r);if(!(o===n.l3||h||d?.isForum||u&&o&&u[Number(o)]))return{currentUserId:r};const m=(0,no._l)(e,s),p=(0,io.G6)(e,d?.restrictionReasons),g=(0,C.yHC)(e,s,h?"saved":"all"),f=(0,C.kdX)(e,s),I=o===n.l3&&!l&&!d.unreadCount&&!f&&g&&!g.groupedId,v=(0,C.yps)(e,s),b=Boolean(c?.settings?.canAddContact),S=c?.settings?.nameChangeDate,w=c?.settings?.photoChangeDate,A=(0,C.S0q)(e,s,o),M=(0,k.L8)(s)?void 0:(0,C.AWZ)(e,s),P=!(0,C.Vw0)(e,s,o)?.messagesCount,F=!(0,C.g29)(e)||(0,C.vGo)(e,r)?.areAdsEnabled,T=(0,C.trm)(e),x=Boolean(c?.businessIntro),U=e.isAppConfigLoaded,B=(0,C.k2W)(e,s)?.id,R=(0,C.jGY)(e,s)&&!M?.isTranslationDisabled,N=d?.hasAutoTranslation,J=(0,C.Qq_)(e);return{areAdsEnabled:F,isChatLoaded:!0,isRestricted:m,restrictionReasons:p,isChannelChat:(0,y.WX)(d),isChatMonoforum:(0,y.Ve)(d),isGroupChat:(0,y.YE)(d),isChannelWithAvatars:d.areProfilesShown,isCreator:d.isCreator,isChatWithSelf:(0,C.nZ4)(e,s),isSystemBotChat:(0,y.DX)(s),isAnonymousForwards:(0,y.Qe)(s),isBot:Boolean(v),isNonContact:b,nameChangeDate:S,photoChangeDate:w,isSynced:e.isSynced,messageIds:l,messagesById:u,firstUnreadId:(0,C.RjD)(e,s,o),isViewportNewest:"thread"!==i||(0,C.haw)(e,s,o),focusingId:f,isSelectModeActive:(0,C.rTV)(e),hasLinkedChat:M?Boolean(M.linkedChatId):void 0,channelJoinInfo:M?.joinInfo,topic:A,noMessageSendingAnimation:!(0,C.xYJ)(e,"messageSendingAnimations"),isServiceNotificationsChat:s===a.zv8,isForum:d.isForum,isEmptyThread:P,currentUserId:r,isChatProtected:(0,C.ryq)(e,s),lastMessage:I?g:void 0,isAccountFrozen:T,hasCustomGreeting:x,isAppConfigLoaded:U,monoforumChannelId:B,canTranslate:R,translationLanguage:J,shouldAutoTranslate:N}})(e=>{let{chatId:t,threadId:s,type:o,isChatLoaded:r,isForum:d,isChannelChat:c,isGroupChat:l,isChannelWithAvatars:u,canPost:p,isSynced:g,isChatMonoforum:f,isReady:v,isChatWithSelf:b,isSystemBotChat:S,isAnonymousForwards:A,isCreator:M,isBot:P,isNonContact:F,nameChangeDate:T,photoChangeDate:x,messageIds:U,messagesById:B,firstUnreadId:R,isComments:N,isViewportNewest:J,isRestricted:E,restrictionReasons:L,isEmptyThread:Y,focusingId:D,isSelectModeActive:O,lastMessage:G,hasLinkedChat:V,withBottomShift:j,withDefaultBg:q,topic:z,noMessageSendingAnimation:K,isServiceNotificationsChat:W,currentUserId:H,isContactRequirePremium:_,paidMessagesStars:$,areAdsEnabled:X,channelJoinInfo:Q,isChatProtected:Z,isAccountFrozen:ee,hasCustomGreeting:te,monoforumChannelId:se,isAppConfigLoaded:ae,canTranslate:oe,translationLanguage:ne,shouldAutoTranslate:ie,onIntersectPinnedMessage:re,onScrollDownToggle:de,onNotchToggle:ce}=e;const{loadViewportMessages:le,setScrollOffset:ue,loadSponsoredMessages:he,loadMessageReactions:me,copyMessagesByIds:pe,loadMessageViews:ge,loadPeerStoriesByIds:fe,loadFactChecks:Ie,requestChatTranslation:ve}=(0,w.ko)(),be=(0,Yt.li)(),ye=(0,Yt.li)("thread"===o&&(0,C.j_4)((0,w.mS)(),t,s)||(0,C.rKQ)((0,w.mS)(),t,s)||0),Se=(0,Yt.li)(),we=(0,Yt.li)(),Ae=(0,Yt.li)(),Me=(0,Yt.li)(),Ce=(0,Yt.li)(),Pe=(0,Yt.li)(),ke=(0,Yt.li)(!1),Fe=(0,Yt.li)(Boolean(G)),Te=(0,y.cG)(t,s,H),xe=Te&&s!==a.Ckz,Ue=Boolean(U),Be=(0,k.L8)(t),Re=Boolean(!Be&&!c||b||S||A||u);(0,es.A)(()=>{Ue&&(0,I.aj)(()=>{Fe.current=!1})},[Ue]),(0,es.A)(()=>{Me.current=R},[R]),(0,Yt.vJ)(()=>{X&&(c||P)&&g&&v&&ae&&he({peerId:t})},[t,g,v,c,P,X,ae]),(0,es.A)(()=>{Ue&&(Ce.current=Me.current)},[Ue]),(0,es.A)(()=>{Pe.current=D},[D]),(0,Yt.vJ)(()=>{ie&&oe&&ve({chatId:t,toLanguageCode:ne})},[ie,oe,ne,t]),(e=>{const t=(0,_t.A)(t=>{const s=(0,po.A)();s&&s.length>1&&(t.preventDefault(),e({messageIds:s}))});(0,Ss.v)((0,Yt.Kr)(()=>({"Mod+C":t}),[]))})(pe);const Ne=(0,Yt.Kr)(()=>{if(!U?.length||!B)return;const e=[];U.forEach((t,s,a)=>{const n=e[e.length-1],i=B[t];if(!i)return;const{shouldAppendJoinMessage:r,shouldAppendJoinMessageAfterCurrent:d}=(()=>{if(Q&&"thread"===o)return n&&n.date<Q.joinedDate&&Q.joinedDate<=i.date?{shouldAppendJoinMessage:!0,shouldAppendJoinMessageAfterCurrent:!1}:s===a.length-1&&i.date<Q.joinedDate?{shouldAppendJoinMessage:!0,shouldAppendJoinMessageAfterCurrent:!0}:void 0})()||{};if(d&&e.push(i),r){const t=d?i.id:n?.id||i.id-1;e.push({id:ln(t),chatId:i.chatId,date:Q.joinedDate,isOutgoing:!1,content:{action:{mediaType:"action",type:"channelJoined",inviterId:Q?.inviterId,isViaRequest:Q?.isViaRequest||void 0}}})}d||e.push(i)});const t="scheduled"===o||W?["date","id"]:["id"];return e.length?uo((0,h.My)(e,t),Ce.current,d?void 0:Number(s),b,Re):void 0},[Re,U,B,o,W,d,s,b,Q]);(0,zt.A)(()=>{if(!U||!B||"scheduled"===o||ee)return;if(!c&&!l)return;const e=U.filter(e=>{const t=B[e];return t&&t.reactions&&!t.content.action});e.length&&me({chatId:t,ids:e})},2e4),(0,zt.A)(()=>{if(!U||!B||"scheduled"===o)return;const e=U.map(e=>B[e]?.content.storyData).filter(Boolean);if(!e.length)return;const t=e.reduce((e,t)=>{const{peerId:s,id:a}=t;return e[s]||(e[s]=[]),e[s].push(a),e},{});Object.entries(t).forEach(e=>{let[t,s]=e;fe({peerId:t,storyIds:s})})},3e5),(0,zt.A)(()=>{if(!U||!B||s!==n.l3||"scheduled"===o)return;const e=(0,w.mS)(),a=U.filter(s=>(0,C.Vw0)(e,t,s)?.isCommentsInfo||void 0!==B[s]?.viewsCount);a.length&&ge({chatId:t,ids:a})},2e4,!0),(0,zt.A)(()=>{if(!U||!B||s!==n.l3||"scheduled"===o)return;const e=U.filter(e=>B[e]?.factCheck?.shouldFetch);e.length&&Ie({chatId:t,ids:e})},5e3);const Je=(0,Yt.Kr)(()=>{if("thread"===o)return(0,I.sg)(()=>le({direction:i.TN.Around}),1e3,!0,!1)},[le,U]),{isScrolled:Ee,updateStickyDates:Le}=function(){const[e,t]=(0,_s.A)(!1),s=(0,fo.A)(1e3,!0);return{isScrolled:e,updateStickyDates:(0,_t.A)(e=>{t(),document.body.classList.contains("is-scrolling-messages")||(0,Ot.RK)(()=>{document.body.classList.add("is-scrolling-messages")}),s(()=>{const t=function(e){const t=e.querySelectorAll(".sticky-date"),s=e.scrollTop,a=getComputedStyle(e),o=parseInt(a.getPropertyValue("--middle-header-panes-height"),10);return Array.from(t).find(e=>{const{offsetTop:t,offsetHeight:a}=e,n=t-s;return-a<=n&&n<=o+10})}(e);(0,Ot.RK)(()=>{const e=document.querySelector(".stuck");e&&e.classList.remove("stuck"),t&&t.classList.add("stuck"),document.body.classList.remove("is-scrolling-messages")})})})}}(),Ye=(0,_t.A)(()=>{if(ke.current)return void(ke.current=!1);const e=be.current;e&&(Pe.current||Le(e),dn(()=>{const a=(0,w.mS)();Boolean((0,C.nTw)(a).focusedMessage?.chatId)||re({shouldCancelWaiting:!0}),e.parentElement&&(ye.current=e.scrollHeight-e.scrollTop,"thread"===o&&ue({chatId:t,threadId:s,scrollOffset:ye.current}))}))}),[De,Oe]=function(e,t){const[s,a]=(0,Yt.Ul)(),o=(0,_t.A)(e=>{a(e.contentRect.height)});(0,go.A)(e,o),(0,Yt.vJ)(()=>{const a=Number(e.current.dataset.normalHeight)||0,o=s();o&&o>a&&t&&(e.current.dataset.normalHeight=String(o))},[t,e,s]);const n=(0,Yt.li)();return[s,n]}(be,p&&!O);(0,Yt.vJ)(()=>{if(!Je||!r||E||D)return;if(U&&(0,m.iL)(U[U.length-1]))return;const e=be.current;(!U||1===U.length||U.length<a.yo2/2&&e.firstElementChild.clientHeight<=e.offsetHeight)&&Je()},[r,U,Je,D,E]);const Ge=(0,As.i)(()=>{if(!U||!Ae.current)return;const e=Ae.current.filter(e=>U.includes(Number(e.dataset.messageId))),t=e[1]||e[0];t&&(Se.current=t.id,we.current=t.getBoundingClientRect().top)});(0,es.A)(()=>(0,Ot.Uj)(()=>Ge.current()),[U,J,Ge]),(0,Yt.vJ)(()=>Ge.current(),[De,Ge]),(0,mo.A)(e=>{let[t,s]=e;const o=De(),n=Oe.current;if(Oe.current=o,U===t&&J===s&&o!==n&&void 0===n)return;const i=be.current;Ae.current=Array.from(i.querySelectorAll(".message-list-item"));const r=Ae.current[Ae.current.length-1],d=Me.current?i.querySelector(`#${(0,y.GZ)(Me.current)}`):void 0,c=U&&t&&U[U.length-1]!==t[t.length-1],l=U?.[0]!==t?.[0]&&U?.length===a.yo2/2+1,u=c&&!l;J&&u&&U&&U.length<a.yo2/2&&!i.parentElement.classList.contains("force-messages-scroll")&&(0,Ot.Uj)(()=>i.firstElementChild.clientHeight<=2*i.offsetHeight)&&((0,Dt.YM)(i.parentElement,"force-messages-scroll"),i.parentElement.classList.add("force-messages-scroll"),setTimeout(()=>{i.parentElement&&(0,Dt.HW)(i.parentElement,"force-messages-scroll")},500)),(0,Ot.gm)(()=>{const{scrollTop:e,scrollHeight:t,offsetHeight:a}=i,c=ye.current;let l=c-(n||a);u&&(l-=r?r.offsetHeight:0);const h=J&&s&&l<=50,m=U&&Pe.current===U[U.length-1];u&&h&&!m&&(0,Ot.YS)(()=>{const e=!(0,ts.g1)()||!d;(0,nt.Ay)({container:i,element:e?r:d,position:e?"end":"start",margin:20,forceDuration:K?0:void 0})});const p=void 0!==n&&n!==o;if(p&&(0,nt.o8)())return;const g=Se.current&&i.querySelector(`#${Se.current}`),f=!g&&Ce.current&&i.querySelector(".unread-divider");let I;if(h&&p)I=t-a;else if(g){const t=g.getBoundingClientRect().top;I=e+(t-(we.current||0))}else I=f?Math.min((0,co.A)(f,i).top-10,t-c):t-c;return()=>{(0,ro.A)(i,Math.ceil(I)),(0,nt._v)(),ye.current=Math.max(Math.ceil(t-I),a),Pe.current||(ke.current=!0,(0,Ot.YS)(()=>{ke.current=!1}))}})},[U,J,De,Oe,K]),(0,fa.A)(e=>{let[t]=e;void 0!==t&&(0,Yt.VK)(200+a.xB5)},[O]);const Ve=Boolean(!Re||c&&!u),je=(0,k.L8)(t)&&!b&&!P&&!A&&"thread"===o&&(!Ne&&!G&&U&&(!Ae.current||0===Ae.current.length)||1===U?.length&&"contactSignUp"===B?.[U[0]]?.content.action?.type||"contactSignUp"===G?.content?.action?.type),qe=l&&M&&1===U?.length&&"chatCreate"===B?.[U[0]]?.content.action?.type,ze=1===U?.length&&"topicCreate"===B?.[U[0]]?.content.action?.type,Ke=(0,Gt.A)("MessageList custom-scroll",Ve&&"no-avatars",!p&&"no-composer","pinned"===o&&"type-pinned",j&&"with-bottom-shift",q&&"with-default-bg",O&&"select-mode-active",Ee&&"scrolled",!v&&"is-animating",xe&&"saved-dialog",Z&&"hide-on-print"),We=Boolean(U&&Ne||G);(0,Yt.vJ)(()=>{We||de(!1)},[We,de]);const He=E?rn.Restricted:!$||We||te?_&&!We?rn.PremiumRequired:!P&&!F||We?je?rn.ContactGreeting:U&&(!Ne||qe||ze)?rn.NoMessages:We?rn.MessageList:rn.Loading:rn.AccountInfo:rn.StarsRequired;return(0,ns.Y)(Ms.Ay,{ref:be,className:Ke,name:"fade",activeKey:He,shouldCleanup:!0,onScroll:Ye,onMouseDown:ho.l,children:He===rn.Restricted?(0,ns.Y)("div",{className:"empty",children:(0,ns.Y)("span",{children:L?.[0]?.text||"This is a private "+(c?"channel":"chat")})}):He===rn.StarsRequired?(0,ns.Y)(nn,{paidMessagesStars:$,peerId:se||t}):He===rn.PremiumRequired?(0,ns.Y)(nn,{peerId:t}):He===rn.AccountInfo?(0,ns.Y)(Ro,{chatId:t,hasMessages:We}):He===rn.ContactGreeting?(0,ns.Y)(vo,{userId:t},t):He===rn.NoMessages?(0,ns.Y)(tn,{chatId:t,topic:z,type:o,isChatWithSelf:b,isGroupChatJustCreated:qe}):He===rn.MessageList?(0,ns.Y)(Qo,{canShowAds:X&&c,chatId:t,isComments:N,isChannelChat:c,isChatMonoforum:f,isSavedDialog:Te,messageIds:U||[G.id],messageGroups:Ne||uo([G]),getContainerHeight:De,isViewportNewest:Boolean(J),isUnread:Boolean(R),isEmptyThread:Y,withUsers:Re,noAvatars:Ve,containerRef:be,anchorIdRef:Se,memoUnreadDividerBeforeIdRef:Ce,memoFirstUnreadIdRef:Me,threadId:s,type:o,isReady:v,hasLinkedChat:V,isSchedule:!!Ne&&"scheduled"===o,shouldRenderAccountInfo:P||F,nameChangeDate:T,photoChangeDate:x,noAppearanceAnimation:!Ne||!Fe.current,onScrollDownToggle:de,onNotchToggle:ce,onIntersectPinnedMessage:re,canPost:p}):(0,ns.Y)(Cs.A,{color:"white",backgroundColor:"dark"})})}));function ln(e){return e+1e-6}const un=e=>{const{isActive:t}=e,s=(0,os.A)(qt.ar.Extra,"MessageSelectToolbar",!t);return s?(0,ns.Y)(s,{...e}):void 0};var hn=s(38218),mn=s(51083),pn=s(17751),gn=s(48553),fn=s(53827),In=s(49642),vn=s(35749),bn=s(88792),yn=s(14),Sn=s(24909),wn=s(56863);const An=s.p+"telegram-logo-filled.67469f6dc5e301e8e0bd.svg",Mn={width:200,height:200},Cn=115;var Pn=s(48885),kn=s(82497),Fn=s(42452);const Tn={.5:.66,.75:.8,1:1,1.5:1.4,2:1.8},xn=Object.keys(Tn).sort().map(Number);function Un(e){const{title:t,performer:s,fileName:a}=e;return(0,ns.FD)(ns.FK,{children:[(0,ns.Y)("div",{className:"title",dir:"auto",children:(0,wo.A)(t||a)}),s&&(0,ns.Y)("div",{className:"subtitle",dir:"auto",children:(0,wo.A)(s)})]})}function Bn(e,t){return(0,ns.FD)(ns.FK,{children:[(0,ns.Y)("div",{className:"title",dir:"auto",children:t&&(0,wo.A)(t)}),(0,ns.Y)("div",{className:"subtitle",dir:"auto",children:e})]})}const Rn=(0,w.EK)((e,t)=>{let{isHidden:s}=t;const{audioPlayer:a}=(0,C.nTw)(e),{chatId:o,messageId:n}=a,i=!s&&o&&n?(0,C.O5q)(e,o,n):void 0,r=i&&(0,C.Y7C)(e,i),d=i&&(0,C.hds)(e,i.chatId),{volume:c,playbackRate:l,isMuted:u,isPlaybackRateActive:h,timestamp:m}=(0,C.nTw)(e).audioPlayer;return{message:i,sender:r,chat:d,volume:c,playbackRate:l,isPlaybackRateActive:h,isMuted:u,timestamp:m,mediaDuration:i?(0,ut.Y9)(e,i):void 0}})(e=>{let{message:t,mediaDuration:s,className:o,noUi:n,sender:i,chat:r,volume:c,playbackRate:l,isPlaybackRateActive:u,isMuted:h,isFullWidth:m,timestamp:p,onPaneStateChange:g}=e;const{setAudioPlayerVolume:f,setAudioPlayerPlaybackRate:I,setAudioPlayerMuted:v,focusMessage:b,closeAudioPlayer:A}=(0,w.ko)(),M=(0,Fs.A)(),{isMobile:C}=(0,D.Ay)(),P=(0,yn.A)(t),{audio:k,voice:F,video:T}=P?(0,y.r_)(P):{},x=Boolean(F||T),B=x||(k?.duration||0)>a.CVm,R=i?(0,S.F9)(M,i):void 0,N=(0,vn.A)(P,"inline"),J=N&&tt.Ih(N),E=((e,t,s)=>{const a=(0,Fs.A)(),{audio:o,voice:n}=e?(0,y.r_)(e):{},i=o?o.title||o.fileName:n?"Voice message":"",r=o?.performer||t&&(0,S.F9)(a,t),d=s&&(0,y.Js)(a,s)||"Telegram",c=o&&(0,y.AB)(o)&&(0,y.VO)(o,"pictogram"),l=t&&(0,y.cP)(t,"big"),u=o&&c||n&&l,h=(0,Ao.A)(u),m=(0,Yt.Kr)(()=>function(e,t,s){if(!s)return Mn;if(e){if(!e.thumbnailSizes?.length)return;const t=e.thumbnailSizes.find(e=>"m"===e.type);return t||e.thumbnailSizes[0]}return t?U.cf:void 0}(o,n,h),[o,h,n]),{result:p}=(0,wn.A)(()=>function(e,t){if(!e)return Promise.resolve(An);if(!t)return(0,Sn.y)(e,Cn,Cn);const s=Math.min(t.width,t.height);if(s<Cn){const t=Cn/s;return(0,Sn.s)(e,t)}return Promise.resolve(e)}(h,m),[h,m],An);return(0,Yt.Kr)(()=>(0,In.wp)({title:i,artist:r,album:d,artwork:[{src:p}]}),[d,r,i,p])})(P,i,r),{playPause:L,stop:Y,isPlaying:O,requestNextTrack:G,requestPreviousTrack:V,isFirst:j,isLast:q,setVolume:z,toggleMuted:K,setPlaybackRate:W,setCurrentTime:H}=(0,bn.A)(t&&(0,fn.dj)(t),s||0,x?"voice":"audio",J,void 0,E,void 0,!0,void 0,void 0,t&&(0,y.Nb)(t),!0),_=Boolean(t),{ref:$}=(0,Zt.A)({isOpen:_,shouldForceOpen:m}),{ref:X,shouldRender:Q}=(0,Pn.A)({isOpen:_,isDisabled:!m,ref:$,onStateChange:g}),{isContextMenuOpen:Z,handleBeforeContextMenu:ee,handleContextMenu:te,handleContextMenuClose:se,handleContextMenuHide:ae}=(0,eo.A)($,!Q);(0,Yt.vJ)(()=>{p&&H(p)},[p,H]),(0,Yt.vJ)(()=>{O&&t?.isDeleting&&L()},[O,t?.isDeleting,L]);const oe=(0,_t.A)(()=>{const{chatId:e,id:t}=P;b({chatId:e,messageId:t})}),ne=(0,_t.A)(()=>{Y&&(O&&L(),A(),(0,In.Eg)(),Y())}),ie=(0,_t.A)(e=>{z&&(f({volume:e/100}),z(e/100))}),re=(0,_t.A)(()=>{d.TF&&!d.pz||K&&(K(),v({isMuted:!h}))}),de=(0,_t.A)(function(e){if(!W)return;const t=Tn[e],s=1!==e&&(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);I({playbackRate:t,isPlaybackRateActive:s}),W(s?t:1)}),ce=(0,_t.A)(()=>{se();const e=Number(Object.entries(Tn).find(e=>{let[,t]=e;return t===l})?.[0])||1,t=!u;de(t&&1===e?2:e,t)}),le=(0,_t.A)(()=>{const e=Object.entries(Tn).find(e=>{let[,t]=e;return t===l})?.[0]||1,t=`${1===l?2:e}Х`;return(0,ns.FD)("div",{className:"playback-wrapper",children:[Z&&(0,ns.Y)("div",{className:"playback-backdrop",onClick:se}),(0,ns.Y)(xs.A,{round:!0,className:(0,Gt.A)("playback-button",u&&"applied",Z&&"on-top"),color:"translucent",size:"smaller",ariaLabel:"Playback Rate",ripple:!C,onMouseEnter:te,onClick:ce,onMouseDown:ee,onContextMenu:te,children:(0,ns.Y)("span",{className:(0,Gt.A)("playback-button-inner",4===t.length&&"small",5===t.length&&"tiny"),children:t})})]})}),ue=(0,Yt.Kr)(()=>0===c||h?"muted":c<.3?"volume-1":c<.6?"volume-2":"volume-3",[c,h]);if(!n&&Q)return(0,ns.FD)("div",{className:(0,Gt.A)("AudioPlayer",m?"full-width-player":"mini-player",o),dir:M.isRtl?"rtl":void 0,ref:X,children:[(0,ns.FD)("div",{className:"AudioPlayer-content",onClick:oe,children:[k?Un(k):Bn(M("AttachAudio"),R),(0,ns.Y)(Fn.A,{})]}),(0,ns.Y)(xs.A,{round:!0,ripple:!C,color:"translucent",size:"smaller",className:"player-button",disabled:j?.(),onClick:V,ariaLabel:"Previous track",children:(0,ns.Y)(Us.A,{name:"skip-previous"})}),(0,ns.FD)(xs.A,{round:!0,ripple:!C,color:"translucent",size:"smaller",className:(0,Gt.A)("toggle-play","player-button",O?"pause":"play"),onClick:L,ariaLabel:O?"Pause audio":"Play audio",children:[(0,ns.Y)(Us.A,{name:"play"}),(0,ns.Y)(Us.A,{name:"pause"})]}),(0,ns.Y)(xs.A,{round:!0,ripple:!C,color:"translucent",size:"smaller",className:"player-button",disabled:q?.(),onClick:G,ariaLabel:"Next track",children:(0,ns.Y)(Us.A,{name:"skip-next"})}),(0,ns.FD)("div",{className:"volume-button-wrapper",children:[(0,ns.Y)(xs.A,{round:!0,className:"player-button volume-button",color:"translucent",size:"smaller",ariaLabel:"Volume",onClick:re,ripple:!C,children:(0,ns.Y)(Us.A,{name:ue})}),!d.pz&&(0,ns.FD)("div",{className:"volume-slider-wrapper",children:[(0,ns.Y)("div",{className:"volume-slider-spacer"}),(0,ns.Y)("div",{className:"volume-slider",children:(0,ns.Y)(kn.A,{bold:!0,value:h?0:100*c,onChange:ie})})]})]}),B&&(0,ns.Y)(Zs.A,{forceOpen:Z,positionX:"right",positionY:"top",className:"playback-rate-menu",trigger:le,onClose:se,onHide:ae,onMouseEnterBackdrop:se,children:xn.map(e=>function(e,t,s,a){const o=t===Tn[e]&&a||1===e&&!a;return(0,ns.FD)(Rs.A,{onClick:()=>s(e),icon:o?"check":void 0,customIcon:o?void 0:(0,ns.Y)(Us.A,{name:"placeholder"}),children:[e,"X"]},e)}(e,l,de,u))}),(0,ns.Y)(xs.A,{round:!0,className:"player-close",color:"translucent",size:"smaller",onClick:ne,ariaLabel:"Close player",children:(0,ns.Y)(Us.A,{name:"close"})})]})});var Nn=s(85449),Jn=s(2338),En=s(49746),Ln=s(11217),Yn=s(93809),Dn=s(68292),On=s(27860),Gn=s(18653),Vn=s(94189);const jn={"pinned-message-border":"L5TQCriM",pinnedMessageBorder:"L5TQCriM","pinned-message-border-wrapper-1":"v5sJGzfS",pinnedMessageBorderWrapper1:"v5sJGzfS","pinned-message-border-wrapper":"p6PQhvds",pinnedMessageBorderWrapper:"p6PQhvds","pinned-message-border-mark":"M2PQZgBd",pinnedMessageBorderMark:"M2PQZgBd"};function qn(e,t,s,a,o){return`M${e},${t+o}a${o},${o},0,0,1,\n  ${s},0v${a-2*o}a${o},${o},0,0,1,${-s},0Z`}const zn=(0,Yt.ph)(e=>{let{count:t,index:s}=e;const a=(0,Yt.li)(),o=(0,Yt.Kr)(()=>function(e,t){const s=e-t-1,a=function(e){let t=8;return 1===e?t=36:2===e?t=17:3===e?t=11:(4===e||e>3)&&(t=7.5),t}(e),o=function(e,t){let s=36;return 1===e?s=36:2===e?s=17:3===e?s=1===t?12:11:(4===e||e>3)&&(s=7.5),s}(e,s),n=function(e,t){return e<=3?36:t*e+2*(e-1)}(e,a),i=`clipPath${e}`,r=function(e,t,s){let a="";if(3===s)a=qn(0,0,2,t,1)+qn(0,12,2,t+1,1)+qn(0,25,2,t,1);else for(let e=0;e<s;e++)a+=qn(0,(t+2)*e,2,t,1);return`<clipPath id="${e}">\n      <path d="${a}" />\n    </clipPath>`}(i,a,e),d=function(e,t,s){return 1===s?0:2===s?0===e?0:t+2:3===s?0===e?0:1===e?12:25:(t+2)*e}(s,a,e),c=function(e,t,s,a){return t<=4||e<=1?0:e>=t-2?a-36:(s+4)/2+(e-2)*(s+2)}(s,e,a,n);return{markHeight:o,clipPath:r,markTranslateY:d,trackTranslateY:c,trackHeight:n,clipPathId:i}}(t,s),[t,s]);if((0,Yt.Nf)(()=>{if(!a.current)return;const{trackHeight:e,trackTranslateY:t,markHeight:s,markTranslateY:n,clipPathId:i,clipPath:r}=o,d=a.current.firstElementChild;if(a?.current){const o=a.current,{style:c}=o;c.height=`${e}px`,c.transform=`translateY(-${t}px)`,c.clipPath=`url("#${i}")`;const l=o.querySelector("svg"),u=o.querySelector("div"),h=o.querySelector("defs");l||d&&(d.innerHTML=`<svg height="0" width="0"><defs> ${r} </defs></svg>`),h&&(h.innerHTML=r),u&&(u.style.height=`${s}px`,u.style.transform=`translateY(${n}px)`)}},[o]),1===t)return(0,ns.Y)("div",{className:jn.pinnedMessageBorder,children:(0,ns.Y)("div",{className:jn.pinnedMessageBorderWrapper1,ref:a})});const{trackHeight:n,trackTranslateY:i,markHeight:r,markTranslateY:d,clipPathId:c}=o;return(0,ns.Y)("div",{className:(0,Gt.A)(jn.pinnedMessageBorder,t>4&&jn.pinnedMessageBorderMask),children:(0,ns.FD)("div",{className:jn.pinnedMessageBorderWrapper,ref:a,style:`clip-path: url("#${c}"); width: 2px;\n          height: ${n}px; transform: translateY(-${i}px);`,children:[(0,ns.Y)("span",{}),(0,ns.Y)("div",{className:jn.pinnedMessageBorderMark,style:`--height: ${r}px; --translate-y: ${d}px; --translate-track: ${i}px;`})]})})}),Kn="LFRysfVa",Wn="E_C4DXKN",Hn="ljzqevcj",_n=1.125*U.$,$n=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s,threadId:a,messageListType:o}=t;const i=(0,C.hds)(e,s),r=e.isSynced,d=(0,y.cG)(s,a,e.currentUserId),c=(0,C.zeq)(e,s),l={chat:i,isSynced:r};if("thread"!==o||!c)return l;if(a!==n.l3&&!d&&!i?.isForum){const t=Number(a),o=t?(0,C.O5q)(e,s,t):void 0,n=o?(0,C.Szq)(e,o):void 0;return{...l,pinnedMessageIds:t,messagesById:c,canUnpin:!1,topMessageSender:n}}const u=d?void 0:(0,C.fcC)(e,s,a);if(u?.length){const t=c[u[0]],{canUnpin:s=!1}=t&&1===u.length&&(0,C.WAX)(e,t,a)||{};return{...l,pinnedMessageIds:u,messagesById:c,canUnpin:s}}return l})(e=>{let{chatId:t,threadId:s,canUnpin:a,getLoadingPinnedId:o,pinnedMessageIds:i,messagesById:r,isFullWidth:c,topMessageSender:l,getCurrentPinnedIndex:u,className:h,chat:m,isSynced:p,shouldHide:g,onPaneStateChange:f,onFocusPinnedMessage:I}=e;const{clickBotInlineButton:v,focusMessage:b,openThread:A,pinMessage:M,loadPinnedMessages:C}=(0,w.ko)(),P=(0,Ht.A)(),k=(0,Ds.A)(u),F=Array.isArray(i)?i[k]:i,T=r&&F?r[F]:void 0,x=Array.isArray(i)?i.length:i?1:0,B=Math.max(x-k,1),R=l?(0,S.F9)(P,l):void 0,N=T&&(0,y.zX)(T),J=N?.isGif?N:void 0,E=Boolean(J&&!J.previewPhotoSizes?.length),L=(0,Jn.A)(T),Y=(0,vn.A)(T,E?"full":"pictogram"),D=(0,Ao.A)(Y),O=T&&(0,y.y2)(T),G=Boolean((0,Ds.A)(o)),V=(0,Yn.A)([G],450)&&G,j=(0,yn.A)(T,!0);(0,Yt.vJ)(()=>{p&&(s===n.l3||m?.isForum)&&C({chatId:t,threadId:s})},[t,s,p,m?.isForum]),(0,En.A)(t,F,T);const q=Boolean(T)&&!g,{ref:z}=(0,Zt.A)({isOpen:q,noOpenTransition:!0,shouldForceOpen:c}),{ref:K,shouldRender:W}=(0,Pn.A)({isOpen:q,isDisabled:!c,ref:z,onStateChange:f}),[H,_,$]=(0,_s.A)(),X=(0,_t.A)(()=>{$(),M({chatId:t,messageId:T.id,isUnpin:!0})}),Q=T&&(0,y.rK)(T),Z=(0,_t.A)(()=>{Q&&v({chatId:T.chatId,messageId:T.id,button:Q})}),ee=(0,_t.A)(()=>{A({chatId:t,threadId:s,type:"pinned"})}),te=(0,_t.A)(e=>{const a=e.shiftKey&&Array.isArray(i)?i[(0,Ga.A)(i.length,i.indexOf(F)-2)]:F;o()||(b({chatId:t,threadId:s,messageId:a,noForumTopicPanel:!0}),I(a))}),[se,ae,oe]=(0,_s.A)(),{handleClick:ne,handleMouseDown:ie}=(0,Ln.Q)(te);if(W&&j)return(0,ns.FD)("div",{ref:K,className:(0,Gt.A)("HeaderPinnedMessageWrapper","tE8PJzpv",c?"gutn4asD":"lrBhOgvf",h),children:[(x>1||V)&&(0,ns.FD)(xs.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:P("EventLogFilterPinnedMessages"),onClick:V?void 0:ee,children:[G&&(0,ns.Y)(sa.A,{color:"blue",className:(0,Gt.A)("yvd9_9PF",Kn,!V&&Wn)}),(0,ns.Y)(Us.A,{name:"pin-list",className:(0,Gt.A)(Kn,V&&Wn)})]}),a&&(0,ns.Y)(xs.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:P("UnpinMessageAlertTitle"),onClick:_,children:(0,ns.Y)(Us.A,{name:"close"})}),(0,ns.Y)(Vn.A,{isOpen:H,onClose:$,text:P("PinnedConfirmUnpin"),confirmLabel:P("DialogUnpin"),confirmHandler:X}),(0,ns.FD)("div",{className:(0,Gt.A)("ayLUtX1S",se&&"WVjde2rq"),onClick:ne,onMouseDown:ie,dir:P.isRtl?"rtl":void 0,children:[(0,ns.Y)(zn,{count:x,index:k}),(0,ns.Y)(Ms.Ay,{activeKey:j.id,name:"slideVertical",className:"Gp431jU4",children:function(e,t,s,a){const{width:o,height:n}=(0,U.mr)(),i=t||e,r=s&&t;return(0,ns.FD)("div",{className:"XjjZeOUy",children:[e&&!a&&!r&&(0,ns.Y)("img",{className:Hn,src:i,width:o,height:n,alt:"",draggable:!1}),r&&!a&&(0,ns.Y)("video",{src:t,width:o,height:n,playsInline:!0,disablePictureInPicture:!0,className:Hn}),e&&(0,ns.Y)(On.A,{thumbDataUri:i,isVisible:Boolean(a),width:o,height:n})]})}(L,D,E,O)}),(0,ns.FD)("div",{className:(0,Gt.A)("ETMw73qH",L&&"BWZytkCB"),dir:P.isRtl?"rtl":void 0,children:[(0,ns.FD)("div",{className:"IWpRWVBg",dir:P.isRtl?"rtl":void 0,children:[!R&&(0,ns.Y)(Dn.A,{text:1===x?P("PinnedMessageTitleSingle"):P("PinnedMessageTitle",{index:B},{pluralValue:x})}),R&&(0,wo.A)(R)]}),(0,ns.Y)(Ms.Ay,{activeKey:j.id,name:"slideVerticalFade",className:"mA1i07pG",children:(0,ns.Y)("p",{dir:"auto",className:"k19QLKaH",children:(0,ns.Y)(Gn.A,{message:j,truncateLength:256,noEmoji:Boolean(L),emojiSize:_n})})})]}),(0,ns.Y)(Fn.A,{}),Q&&(0,ns.Y)(xs.A,{size:"tiny",className:"fpQMpARI",onClick:Z,shouldStopPropagation:!0,onMouseEnter:d.TF?void 0:ae,onMouseLeave:d.TF?void 0:oe,children:(0,Nn.A)(P,Q)})]})]})})),Xn=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s,threadId:a,messageListType:o,isMobile:i}=t;const{isLeftColumnShown:r,shouldSkipHistoryAnimations:d,audioPlayer:c,messageLists:l}=(0,C.nTw)(e),u=(0,C.hds)(e,s),h=(0,C.PVB)(e,s),{chatId:m,messageId:p}=c,g=m&&p?(0,C.O5q)(e,m,p):void 0;let f;if("pinned"===o){const t=(0,C.fcC)(e,s,a);f=t?.length}else if("scheduled"===o){const t=(0,C.K3w)(e,s,a);f=t?.length}else if("thread"===o&&a!==n.l3){const t=(0,C.Vw0)(e,s,a);f=t?.messagesCount||0}const I=(0,C.C5H)(e,s,a,"typingStatus"),v=h?.emojiStatus,b=v&&(0,C.O8F)(e,v.documentId),S="collectible"===v?.type?v.slug:void 0,w=(0,y.cG)(s,a,e.currentUserId);return{typingStatus:I,isLeftColumnShown:r,isRightColumnShown:(0,C.gjV)(e,i),isSelectModeActive:(0,C.rTV)(e),audioMessage:g,chat:u,messagesCount:f,isChatWithSelf:(0,C.nZ4)(e,s),shouldSkipHistoryAnimations:d,currentTransitionKey:Math.max(0,l.length-1),connectionState:e.connectionState,isSyncing:e.isSyncing,isFetchingDifference:e.isFetchingDifference,emojiStatusSticker:b,emojiStatusSlug:S,isSavedDialog:w}})(e=>{let{chatId:t,threadId:s,messageListType:o,isMobile:r,typingStatus:c,isSelectModeActive:l,isLeftColumnShown:u,audioMessage:h,chat:m,messagesCount:p,isComments:g,isChatWithSelf:f,shouldSkipHistoryAnimations:I,currentTransitionKey:v,connectionState:b,isSyncing:y,isFetchingDifference:S,getCurrentPinnedIndex:A,getLoadingPinnedId:M,emojiStatusSticker:C,emojiStatusSlug:P,isSavedDialog:F,onFocusPinnedMessage:T}=e;const{openThreadWithInfo:x,openChat:U,openPreviousChat:B,toggleLeftColumn:R,exitMessageSelectMode:N,openPremiumModal:J,openStickerSet:E,updateMiddleSearch:L,openUniqueGiftBySlug:Y}=(0,w.ko)(),O=(0,Fs.A)(),G=(0,Yt.li)(!0),{isDesktop:V,isTablet:j}=(0,D.Ay)(),{width:q}=(0,Oa.A)(),z=q<=a.j7z,K=j&&u,W=(0,Yt.li)(),H=(0,_t.A)(()=>{L({chatId:t,threadId:s,update:{}})}),_=(0,_t.A)(e=>{e.target.closest(".title > .custom-emoji")||x({chatId:t,threadId:s})}),{onMouseDown:$,onMouseUp:X,onMouseLeave:Q,onTouchStart:Z,onTouchEnd:ee}=(0,hn.A)({onStart:H,onClick:_,threshold:500}),te=(0,_t.A)(()=>{setTimeout(()=>{G.current=!0},450)}),se=(0,_t.A)(()=>{P?Y({slug:P}):J({fromUserId:t})}),ae=(0,_t.A)(()=>{P?Y({slug:P}):E({stickerSetInfo:C.stickerSetInfo})}),oe=(0,_t.A)(e=>{if(G.current){if(G.current=!1,r){const e=document.querySelector(a.m$5);e?.blur()}if(l)return N(),void te();if("thread"===o&&0===v)return!j||K?(e.stopPropagation(),U({id:void 0},{forceOnHeavyAnimation:!0})):R(),void te();B(),te()}}),ne=(0,Da.A)(v),ie=void 0!==ne&&ne<v?ne:void 0,re=Boolean(h),de=V&&re,ce=re||!V,{connectionStatusText:le}=Hs(O,b,y||S,!0);function ue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,ns.FD)("div",{className:"back-button",children:[(0,ns.Y)(xs.A,{round:!0,size:"smaller",color:"translucent",onClick:oe,ariaLabel:O(e?"Close":"Back"),children:(0,ns.Y)("div",{className:(0,Gt.A)("animated-close-icon",!e&&"state-back")})}),t&&(0,ns.Y)(fs,{})]})}return(0,ns.FD)("div",{className:"MiddleHeader",ref:W,"data-tauri-drag-region":!(!gt.Vq||!d.MP)||void 0,children:[(0,ns.Y)(Ms.Ay,{name:I?"none":"slideFade",activeKey:v,shouldCleanup:!0,cleanupExceptionKey:ie,children:"thread"===o&&(s===n.l3||F||m?.isForum)?function(){const e=F?O("SavedMessages"):void 0,a=F?String(s):t,o=m?.isMonoforum?m.linkedMonoforumId:a;return(0,ns.FD)(ns.FK,{children:[(z||v>0)&&ue(K,!F),(0,ns.Y)("div",{className:"chat-info-wrapper",onMouseDown:$,onMouseUp:X,onMouseLeave:Q,onTouchStart:Z,onTouchEnd:ee,children:(0,k.L8)(o)?(0,ns.Y)(pn.A,{userId:o,typingStatus:c,status:le||e,withDots:Boolean(le),withFullInfo:!0,withMediaViewer:!0,withStory:!f,withUpdatingStatus:!0,isSavedDialog:F,storyViewerOrigin:i.G9.MiddleHeaderAvatar,emojiStatusSize:22,noRtl:!0,onEmojiStatusClick:se},o):(0,ns.Y)(mn.A,{chatId:o,threadId:F?void 0:s,typingStatus:c,withMonoforumStatus:m?.isMonoforum,status:le||e,withDots:Boolean(le),withMediaViewer:s===n.l3,withFullInfo:s===n.l3,withUpdatingStatus:!0,withStory:!0,isSavedDialog:F,storyViewerOrigin:i.G9.MiddleHeaderAvatar,emojiStatusSize:22,onEmojiStatusClick:ae,noRtl:!0},o)})]})}():(0,ns.FD)(ns.FK,{children:[ue(),(0,ns.Y)("h3",{children:void 0!==p?"thread"===o?p?O(g?"Comments":"Replies",p,"i"):O(g?"CommentsTitle":"RepliesTitle"):"pinned"===o?O("PinnedMessagesCount",p,"i"):"scheduled"===o?f?O("Reminders"):O("messages",p,"i"):void 0:O("Loading")})]})}),!ce&&(0,ns.Y)($n,{chatId:t,threadId:s,messageListType:o,onFocusPinnedMessage:T,getLoadingPinnedId:M,getCurrentPinnedIndex:A},t),(0,ns.FD)("div",{className:"header-tools",children:[de&&(0,ns.Y)(Rn,{}),(0,ns.Y)(gn.A,{chatId:t,threadId:s,messageListType:o,isMobile:r,canExpandActions:!de})]})]})}));var Qn=s(15283),Zn=s(63744),ei=s(35049),ti=s(89873);const si=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s}=t;const a=(0,C.yps)(e,s),o=(0,C.v8U)(e,s);return{isBot:Boolean(a),sponsoredMessage:o}})(e=>{let{chatId:t,isBot:s,messageListType:a,sponsoredMessage:o,onPaneStateChange:n}=e;const{viewSponsored:i,openUrl:r,clickSponsored:d,openAboutAdsModal:c}=(0,w.ko)(),l=(0,Ht.A)(),u=Boolean(s&&o&&"thread"===a),h=(0,yn.A)(o),{ref:m,shouldRender:p}=(0,Pn.A)({isOpen:u,withResizeObserver:!0,onStateChange:n}),{isContextMenuOpen:g,contextMenuAnchor:f,handleBeforeContextMenu:I,handleContextMenu:v,handleContextMenuClose:b,handleContextMenuHide:y}=(0,eo.A)(m,!p,!0),S=(0,_t.A)(()=>{h&&(d({randomId:h.randomId}),r({url:h.url,shouldSkipModal:!0}))}),A=(0,_t.A)(e=>{if(!h)return;const{randomId:t,additionalInfo:s,canReport:a,sponsorInfo:o}=h;e.stopPropagation(),c({randomId:t,additionalInfo:s,canReport:a,sponsorInfo:o})});if((0,Yt.vJ)(()=>{p&&h&&i({randomId:h.randomId})},[p,h,t]),!p||!h)return;const{randomId:M,canReport:C,additionalInfo:P,sponsorInfo:k}=h,{peerColor:F,content:T,photo:x,title:U}=h;return(0,ns.FD)(ns.FK,{children:[(0,ns.FD)("div",{ref:m,className:"yMkfzjus",onClick:S,onMouseDown:I,onContextMenu:v,children:[(0,ns.FD)("div",{className:(0,Gt.A)("__w9Ejd3",F&&(0,ei.a)(F)),children:[(0,ns.FD)("span",{className:"wdU19Be7",children:[l("SponsoredMessageAd"),(0,ns.Y)(qo.A,{onClick:A,className:"SrgXYpPk",children:l("SponsoredMessageAdWhatIsThis")})]}),(0,ns.Y)("div",{className:"u2vIptvT",children:U}),T.text&&(0,ns.Y)("div",{className:"SVG6BaX3",children:(0,Ys.fd)({text:T.text.text,entities:T.text.entities})})]}),x&&(0,ns.Y)(ha.A,{size:"large",photo:x,className:"AQFE1t4V"})]}),f&&(0,ns.Y)(ti.A,{isOpen:g,anchor:f,triggerRef:m,randomId:M,additionalInfo:P,canReport:C,sponsorInfo:k,onClose:b,onCloseAnimationEnd:y})]})})),ai=(0,Yt.ph)((0,w.EK)((e,t)=>{let{peerId:s}=t;const a=(0,C.kBv)(e,s),o=a?.botVerification;return{botVerification:o,wasShown:e.settings.botVerificationShownPeerIds.includes(s)}})(e=>{let{peerId:t,wasShown:s,botVerification:a,onPaneStateChange:o}=e;const n=Boolean(!s&&a),{markBotVerificationInfoShown:i}=(0,w.ko)(),{ref:r,shouldRender:d}=(0,Pn.A)({isOpen:n,onStateChange:o}),c=(0,_t.A)(()=>{i({peerId:t})});if((0,Kt.A)(c,s?void 0:5e3),d&&a)return(0,ns.FD)("div",{ref:r,className:"sAWttcxl",children:[(0,ns.Y)("span",{className:"tK9d2y8u",children:(0,ns.Y)(Ia.A,{documentId:a.iconId,size:16})}),a.description]})}));var oi=s(19806);const ni=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s}=t;return{currentUserId:e.currentUserId,peer:(0,C.PVB)(e,s)}})(e=>{let{chatId:t,className:s,isAutoArchived:a,canReportSpam:o,canAddContact:n,canBlockContact:i,peer:r,currentUserId:d,onPaneStateChange:c}=e;const{openAddContactDialog:l,blockUser:u,reportSpam:h,deleteChat:m,leaveChannel:p,deleteChatUser:g,deleteHistory:f,toggleChatArchived:I,hidePeerSettingsBar:v}=(0,w.ko)(),b=(0,Fs.A)(),[A,M,C]=(0,_s.A)(),[P,k]=(0,Yt.J0)(!0),[F,T]=(0,Yt.J0)(!0),x=(0,yn.A)(r),U=x&&(0,S.vj)(x)?x:void 0,B=x&&(0,S.mO)(x)?x:void 0,R=U&&(0,y.yn)(U),N=(0,yn.A)(n),J=(0,yn.A)(i),E=(0,yn.A)(o),L=(0,yn.A)(a),Y=(0,_t.A)(()=>{l({userId:t}),L&&I({id:t})}),D=(0,_t.A)(()=>{C(),u({userId:t}),E&&P&&h({chatId:t}),F&&m({chatId:t})}),O=(0,_t.A)(()=>{v({peerId:t})}),G=(0,_t.A)(()=>{C(),h({chatId:t}),R?(g({chatId:t,userId:d}),f({chatId:t,shouldDeleteForAll:!1})):p({chatId:t})}),V=Boolean((n||i||o)&&r);(0,Yt.vJ)(()=>{V||C()},[V]);const{ref:j,shouldRender:q}=(0,Pn.A)({isOpen:V,onStateChange:c});if(q)return(0,ns.FD)("div",{ref:j,className:(0,Gt.A)("ChatReportPane",s),dir:b.isRtl?"rtl":void 0,children:[N&&(0,ns.Y)(xs.A,{isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:Y,children:b("lng_new_contact_add")}),J&&(0,ns.Y)(xs.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:M,children:b("lng_new_contact_block")}),E&&!J&&(0,ns.Y)(xs.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:M,children:b("lng_report_spam_and_leave")}),(0,ns.Y)(xs.A,{round:!0,ripple:!0,size:"smaller",color:"translucent",onClick:O,ariaLabel:b("Close"),children:(0,ns.Y)(Us.A,{name:"close"})}),(0,ns.FD)(Vn.A,{isOpen:A,onClose:C,title:b("BlockUserTitle",B?(0,y.u0)(B):(0,y.Js)(b,U)),text:B?b("UserInfo.BlockConfirmationTitle",(0,y.Yg)(B)):b("Chat.Confirm.ReportSpam.Channel"),confirmIsDestructive:!0,confirmLabel:b("Block"),confirmHandler:B?D:G,children:[B&&(0,ns.Y)(oi.A,{className:"dialog-checkbox",label:b("DeleteThisChat"),checked:F,onCheck:T}),B&&o&&(0,ns.Y)(oi.A,{className:"ChatReportPane--Checkbox dialog-checkbox",label:b("ReportChat"),checked:P,onCheck:k})]})]})})),ii={root:"xqcWnBH4",message:"CJhqoyif",messageStars:"sZR8zqEk",messageStarIcon:"AKXOpk8S"},ri=(0,Yt.ph)((0,w.EK)((e,t)=>{let{peerId:s}=t;const a=(0,C.hds)(e,s),o=(0,C.vGo)(e,s),n=o?.settings?.chargedPaidMessageStars;return{chargedPaidMessageStars:n,chat:a}})(e=>{let{chargedPaidMessageStars:t,chat:s,peerId:a,onPaneStateChange:o}=e;const n=Boolean(t),i=(0,Ht.A)(),{openChatRefundModal:r}=(0,w.ko)(),{ref:d,shouldRender:c}=(0,Pn.A)({isOpen:n,onStateChange:o}),l=(0,_t.A)(()=>{r({userId:a})});if(!c||!t)return;const u=i("PaneMessagePaidMessageCharge",{peer:s?(0,S.F9)(i,s):void 0,amount:(0,g.U2)(i,t,{asFont:!0,className:ii.messageStarIcon,containerClassName:ii.messageStars})},{withMarkdown:!0,withNodes:!0});return(0,ns.FD)("div",{ref:d,className:ii.root,children:[(0,ns.Y)("div",{className:ii.message,children:u}),(0,ns.Y)(xs.A,{isText:!0,noForcedUpperCase:!0,pill:!0,fluid:!0,size:"tiny",className:ii.button,onClick:l,children:i("RemoveFeeTitle")})]})})),di={height:0},ci=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s}=t;const{audioPlayer:a}=(0,C.nTw)(e),o=(0,C.hds)(e,s),n=(0,C.vGo)(e,s),{chatId:i,messageId:r}=a,d=i&&r?(0,C.O5q)(e,i,r):void 0,c=Boolean((0,C.TCk)(e));return{chat:o,userFullInfo:n,isAudioPlayerRendered:Boolean(d),isMiddleSearchOpen:c,withRightColumnAnimation:(0,C.MBp)(e)}})(e=>{let{className:t,chatId:s,threadId:a,messageListType:o,chat:i,userFullInfo:r,getCurrentPinnedIndex:d,getLoadingPinnedId:c,isAudioPlayerRendered:l,isMiddleSearchOpen:u,withRightColumnAnimation:h,onFocusPinnedMessage:m}=e;const{settings:p}=r||{},{isDesktop:g}=(0,D.Ay)(),[f,I]=(0,Yt.Ul)(di),[v,b]=(0,Yt.Ul)(di),[y,S]=(0,Yt.Ul)(di),[w,A]=(0,Yt.Ul)(di),[M,C]=(0,Yt.Ul)(di),[P,k]=(0,Yt.Ul)(di),[F,T]=(0,Yt.Ul)(di),x=l||!g,U=(0,Yt.li)(!0),{shouldRender:B,ref:R}=(0,Zt.A)({isOpen:!u,withShouldRender:!0,noMountTransition:!0});if((0,Qn.A)(()=>{U.current=!1}),(0,Yo.R)(()=>{const e=f(),t=P(),s=v(),a=[e,y(),w(),t,s,M(),F()],o=U.current,n=a.reduce((e,t)=>e+t.height,0),i=document.getElementById("MiddleColumn");i&&((0,Pn.S)(a,o),(0,Dt.Tv)(i,{"--middle-header-panes-height":`${n}px`}))},[f,y,v,w,M,P,F]),B)return(0,ns.FD)("div",{ref:R,className:(0,Gt.A)("oCUr3DTX",h&&"YPrc0luK",t),children:[(0,ns.Y)(Rn,{isFullWidth:!0,onPaneStateChange:I,isHidden:g}),a===n.l3&&!i?.isForum&&(0,ns.Y)(Zn.A,{chatId:s,onPaneStateChange:S}),(0,ns.Y)(ni,{chatId:s,canAddContact:p?.canAddContact,canBlockContact:p?.canBlockContact,canReportSpam:p?.canReportSpam,isAutoArchived:p?.isAutoArchived,onPaneStateChange:A}),(0,ns.Y)(ai,{peerId:s,onPaneStateChange:k}),(0,ns.Y)(ri,{peerId:s,onPaneStateChange:T}),(0,ns.Y)($n,{chatId:s,threadId:a,messageListType:o,onFocusPinnedMessage:m,getLoadingPinnedId:c,getCurrentPinnedIndex:d,onPaneStateChange:b,isFullWidth:!0,shouldHide:!x}),(0,ns.Y)(si,{chatId:s,messageListType:o,onPaneStateChange:C})]})})),li=(0,Yt.ph)((0,w.EK)((e,t)=>{let{userId:s}=t;const a=(0,C.mBe)(e,s);return{userName:(0,y.u0)(a)}})(function(e){let{userName:t}=e;const s=(0,Fs.A)(),{openPremiumModal:a}=(0,w.ko)(),o=(0,_t.A)(()=>a());return(0,ns.FD)("div",{children:[(0,ns.Y)("div",{children:s("Chat.MessagingRestrictedPlaceholder",t)}),(0,ns.Y)(Po.A,{isPrimary:!0,onClick:o,children:s("Chat.MessagingRestrictedPlaceholderAction")})]})})),ui=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"ReactorListModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},hi=e=>{const{isActive:t}=e,s=(0,os.A)(qt.ar.Extra,"MiddleSearch",!t,!0);return s?(0,ns.Y)(s,{...e}):void 0},mi=450+a.xB5,pi=(0,Yt.ph)((0,w.EK)((e,t)=>{let{isMobile:s}=t;const o=(0,C.SJA)(e),{isBlurred:i,background:r,backgroundColor:d,patternColor:c}=(0,C.Gyz)(e,o)||{},{messageLists:l,isLeftColumnShown:u,activeEmojiInteractions:h,seenByModal:m,reactorModal:p,shouldSkipHistoryAnimations:g,chatLanguageModal:f,privacySettingsNoticeModal:I}=(0,C.nTw)(e),v=(0,C.Xf0)(e),{leftColumnWidth:b}=e,S={theme:o,customBackground:r,backgroundColor:d,patternColor:c,isLeftColumnShown:u,isRightColumnShown:(0,C.gjV)(e,s),isBackgroundBlurred:i,hasActiveMiddleSearch:Boolean((0,C.TCk)(e)),isSelectModeActive:(0,C.rTV)(e),isSeenByModalOpen:Boolean(m),isPrivacySettingsNoticeModalOpen:Boolean(I),isReactorListModalOpen:Boolean(p),isChatLanguageModalOpen:Boolean(f),animationLevel:(0,je.l)(e).animationLevel,withInterfaceAnimations:(0,C.PKK)(e),withRightColumnAnimation:(0,C.MBp)(e),currentTransitionKey:Math.max(0,l.length-1),activeEmojiInteractions:h,leftColumnWidth:b};if(!v)return S;const{chatId:w,threadId:A,type:M}=v,P=(0,k.L8)(w),F=(0,C.hds)(e,w),T=(0,C.yps)(e,w),x=(0,C.fcC)(e,w,A),U=w?(0,C.AWZ)(e,w):void 0,B=w?(0,C.vGo)(e,w):void 0,R=(0,C.Ys6)(e,w,A),N=(0,C.Vw0)(e,w,A),J=Boolean(!N?.isCommentsInfo&&N?.fromChannelId),E=(0,C.S0q)(e,w,A),L=F&&(0,y.__)(F,E,J,U),Y=(0,C.I_m)(e,w),D="pinned"===M,O="thread"===M&&A===n.l3,G=Boolean(F&&(0,y.WX)(F)),V=Boolean(F&&O&&(G||(0,y.Vs)(F))&&F.isNotJoined&&!F.joinRequests&&!F.isMonoforum),j=Boolean(F?.isNotJoined&&F.isJoinToSend),q=Boolean(F?.isNotJoined&&F.isJoinRequest),z=!!P&&(0,C.apd)(e,w),K=Boolean(T&&z),W=!K&&Y,H=z&&!T,_=Boolean(F&&(0,y.YE)(F)&&!U),$=(0,C.GA4)(e,w,A)?.replyInfo,X=!!F?.isForum&&A===n.l3&&!$&&(0,C.S0q)(e,w,a.HxB)?.isClosed,Q=(0,C.ODG)(e,w),Z=Boolean(F?.isMonoforum&&!$&&Q&&!R),ee=(0,C.pSx)(e,w),te=(0,y.cG)(w,A,e.currentUserId),se=te&&A!==a.Ckz,ae=F&&(P||F?.isCreator||!G&&!(0,y.Sq)(F,"pinMessages")||(0,y.ub)(F,"pinMessages")),oe=(0,C.vGo)(e,w),ne=oe?.isContactRequirePremium,ie=(0,C.WA9)(e,w),re=(0,C.trm)(e),de=e.botFreezeAppealId,ce=de?(0,C.hds)(e,de):void 0;return{...S,chatId:w,threadId:A,messageListType:M,chat:F,draftReplyInfo:$,isPrivate:P,arePeerSettingsLoaded:Boolean(B?.settings),isComments:J,canPost:!D&&(!F||L)&&!Y&&!(j&&F?.isNotJoined)&&!X&&!Z&&!te&&(!re||ce?.id===w),isPinnedMessageList:D,currentUserBannedRights:F?.currentUserBannedRights,defaultBannedRights:F?.defaultBannedRights,pinnedMessagesCount:x?x.length:0,shouldSkipHistoryAnimations:g,isChannel:G,canSubscribe:V,canStartBot:W,canRestartBot:K,shouldJoinToSend:j,shouldSendJoinRequest:q,shouldLoadFullChat:_,pinnedIds:x,canUnpin:ae,canUnblock:H,isSavedDialog:te,canShowOpenChatButton:se,isContactRequirePremium:ne,topics:ee,paidMessagesStars:ie,isAccountFrozen:re,freezeAppealChat:ce,shouldBlockSendInMonoforum:Z}})(function(e){let{leftColumnRef:t,chatId:s,threadId:o,isComments:n,messageListType:i,isMobile:r,chat:c,draftReplyInfo:l,isPrivate:u,isPinnedMessageList:m,canPost:p,currentUserBannedRights:g,defaultBannedRights:f,pinnedMessagesCount:I,customBackground:v,theme:b,backgroundColor:S,patternColor:A,isLeftColumnShown:M,isRightColumnShown:P,isBackgroundBlurred:k,leftColumnWidth:F,hasActiveMiddleSearch:T,isSelectModeActive:x,isSeenByModalOpen:L,isPrivacySettingsNoticeModalOpen:Y,isReactorListModalOpen:O,isChatLanguageModalOpen:G,animationLevel:V,withInterfaceAnimations:j,withRightColumnAnimation:q,shouldSkipHistoryAnimations:z,currentTransitionKey:K,isChannel:W,arePeerSettingsLoaded:H,canSubscribe:_,canStartBot:$,canRestartBot:X,activeEmojiInteractions:Q,shouldJoinToSend:Z,shouldSendJoinRequest:ee,shouldLoadFullChat:te,pinnedIds:se,canUnpin:ae,canUnblock:oe,isSavedDialog:ne,canShowOpenChatButton:ie,isContactRequirePremium:re,topics:de,paidMessagesStars:ce,isAccountFrozen:le,freezeAppealChat:ue,shouldBlockSendInMonoforum:he}=e;const{openChat:me,openPreviousChat:pe,unpinAllMessages:ge,loadUser:fe,loadPeerSettings:Ie,exitMessageSelectMode:ve,joinChannel:be,sendBotCommand:ye,restartBot:Se,showNotification:we,loadFullChat:Ae,setLeftColumnWidth:Me,resetLeftColumnWidth:Ce,unblockUser:Pe}=(0,w.ko)(),{width:ke}=(0,Oa.A)(),{isTablet:Fe,isDesktop:Te}=(0,D.Ay)(),xe=(0,Fs.A)(),Ue=(0,Ht.A)(),[Be,Re]=(0,Yt.J0)(Qa.I.None),[Ne,Je]=(0,Yt.J0)(!1),Ee=Ne&&(!r||!T),[Le,Ye]=(0,Yt.J0)(),[De,Oe]=(0,Yt.J0)(!1),{handleIntersectPinnedMessage:Ge,handleFocusPinnedMessage:Ve,getCurrentPinnedIndex:je,getLoadingPinnedId:qe}=function(e,t,s){const[a,o]=(0,Yt.Ul)({}),[n,i]=(0,Yt.Ul)(),r=e?`${e}_${t}`:void 0,d=(0,Va.A)(()=>a()[r]??0,[a,r]);return(0,Yt.vJ)(()=>{ja=void 0,i(void 0)},[e,o,i,t]),(0,Yt.vJ)(()=>{if(!r)return;const e=a()[r],t=s?.length||0;e>=t&&o({...a(),[r]:za(t-1)})},[a,r,s?.length,o]),{handleIntersectPinnedMessage:(0,_t.A)(d=>{let{viewportPinnedIdsToAdd:c=[],viewportPinnedIdsToRemove:l=[],shouldCancelWaiting:u}=d;if(!(e&&t&&r&&s?.length))return;if(u)return qa=void 0,void i(void 0);const m=n();if(m){const e=s.indexOf(m);o({...a(),[r]:za(e)}),i(void 0)}ja=(0,h.Am)((ja?.filter(e=>!l.includes(e))??[]).concat(c));const p=(0,C.kdX)((0,w.mS)(),e)||qa;if(qa&&ja.includes(qa)&&(qa=void 0),p){const e=s.findIndex(e=>e<p);o({...a(),[r]:za(e)})}else if(ja.length){const e=Math.max(...ja),t=s.indexOf(e);o({...a(),[r]:za(t)})}}),handleFocusPinnedMessage:(0,_t.A)(n=>{if(!e||!t||!s?.length)return;qa=n;const d=(0,w.mS)(),c=(0,C.gCU)(d,e,t),l=c?.includes(n)||(0,C.Lzh)(d,e,t,n),u=s.indexOf(n),h=(0,Ga.A)(s.length,u+1);l?o({...a(),[r]:h}):i(s[h])}),getCurrentPinnedIndex:d,getLoadingPinnedId:n}}(s,o,se),ze=r?mi:void 0,Ke=(0,Ya.A)(s,ze),We=(0,Ya.A)(o,ze),He=(0,Ya.A)(i,ze),_e=(0,Ya.A)(_,ze),$e=(0,Ya.A)($,ze),Xe=(0,Ya.A)(X,ze),Qe=(0,Ya.A)(oe,ze),Ze=(0,Ya.A)(p,ze)&&!Xe&&!$e&&!_e&&!Qe&&s!==a.Xab&&!re,et=(0,Ya.A)(Ee,ze)&&s!==a.Xab,tt=(0,Ya.A)(W,ze),st=(0,Ya.A)(Z,ze),at=(0,Ya.A)(ee,ze),ot=(0,Ya.A)(s?Ge:void 0,ze),nt=(0,Da.A)(K),it=void 0!==nt&&nt<K?nt:void 0,{isReady:rt,handleCssTransitionEnd:dt,handleSlideTransitionStop:ct}=function(e,t,s,a,o){const[n,i]=(0,Yt.J0)(!o),r=(0,Wt.A)(),d=void 0!==s&&s!==t;return d&&(e?(i(!1),setTimeout(()=>{i(!0)},mi)):r()),(0,es.A)(()=>{e||i(!0)},[e]),{isReady:n&&!d,handleCssTransitionEnd:e?function(e){"transform"===e.propertyName&&e.target===e.currentTarget&&i(Boolean(a))}:void 0,handleSlideTransitionStop:e?function(){i(!0)}:void 0}}(!z&&j,K,nt,s,r);(0,Yt.vJ)(()=>s?(0,Is.A)(()=>{me({id:void 0})}):void 0,[s,me]),(0,es.A)(()=>{Re(Qa.I.None),Ye(void 0)},[s]),(0,Yt.vJ)(()=>{if(!d.pz&&!d.Ni)return;const{visualViewport:e}=window;if(!e)return;const t=()=>{const t=e.height!==document.documentElement.clientHeight;(0,Ot.RK)(()=>{document.body.classList.toggle("keyboard-visible",t),(0,Ot.YS)(()=>{!t&&e.offsetTop&&(0,Ot.RK)(()=>{window.scrollTo({top:0})})})})};return e.addEventListener("resize",t),()=>{e.removeEventListener("resize",t)}}),(0,Yt.vJ)(()=>{u&&fe({userId:s})},[s,u,fe]),(0,Yt.vJ)(()=>{H||Ie({peerId:s})},[s,u,H]),(0,Yt.vJ)(()=>{s&&te&&rt&&Ae({chatId:s})},[te,s,rt,Ae]);const{initResize:lt,resetResize:ut,handleMouseUp:ht}=function(e,t,s,a,o){const[n,i,r]=(0,_s.A)(),[d,c]=(0,Yt.J0)(0),[l,u]=(0,Yt.J0)(0),h=(0,_t.A)(t=>{(0,Ot.RK)(()=>{if(!e.current)return;const s=t?`${t}px`:"";e.current.style.width=s,o&&e.current.style.setProperty(o,s)})});function m(){(0,Ot.RK)(()=>{document.body.classList.remove("cursor-ew-resize")})}return(0,Yt.Nf)(()=>{e.current&&a&&h(a)},[o,e,a,h]),(0,Yt.vJ)(()=>{if(!n)return;const s=e=>{const t=Math.ceil(l+e.clientX-d);h(t)};function a(){o(),t(e.current.offsetWidth)}function o(){m(),document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",a,!1),document.removeEventListener("blur",a,!1),r()}return document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",a,!1),document.addEventListener("blur",a,!1),o},[l,d,e,t,n,r,h]),{initResize:function(t){t.preventDefault(),(0,Ot.RK)(()=>{document.body.classList.add("cursor-ew-resize")}),c(t.clientX),u(e.current.offsetWidth),i()},resetResize:function(e){e.preventDefault(),h(void 0),s()},handleMouseUp:m}}(t,e=>Me({leftColumnWidth:e}),Ce,F,"--left-column-width"),mt=(0,_t.A)(e=>{const{items:t}=e.dataTransfer||{},s=d.Yw||t&&t.length>0&&Array.from(t).filter(e=>"text/uri-list"!==e.type).every(e=>function(e){return"file"===e.kind&&e.type&&a.gex.has(e.type)}(e)||function(e){return"file"===e.kind&&e.type&&a.fNs.has(e.type)}(e));Re(s?Qa.I.QuickFile:Qa.I.Document)}),pt=(0,_t.A)(()=>{Re(Qa.I.None)}),ft=(0,_t.A)(()=>{Oe(!0)}),It=(0,_t.A)(()=>{Oe(!1)}),vt=(0,_t.A)(()=>{me({id:String(o)})}),bt=(0,_t.A)(()=>{ge({chatId:s,threadId:o}),It(),pe()}),yt=(0,_t.A)(()=>{me({id:s})}),St=(0,_t.A)(()=>{be({chatId:s}),at&&we({message:xe(W?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")})}),wt=(0,_t.A)(()=>{ye({command:"/start"})}),At=(0,_t.A)(()=>{Se({chatId:s})}),Mt=(0,_t.A)(()=>{Pe({userId:s})}),Ct=(0,La.A)(b,v),Pt=(0,Gt.A)(d.So?"mask-image-disabled":"mask-image-enabled"),kt=(0,Gt.A)("C6IaXYew",q&&"nXhZtCma",v&&"K1xhz7U5",S&&"CwoXMwaR",v&&k&&"JBrOVLsX",P&&"Lyw3O8XE"),Ft=(0,Gt.A)("messaging-disabled",!x&&"shown"),Tt=(0,y.gU)(xe,g,f),xt=(0,y.zc)(xe,c,o,de,Boolean(l)),Ut=Tt||xt||(he?Ue("MonoforumComposerPlaceholder"):void 0)||(re?(0,ns.Y)(li,{userId:s}):void 0)||(le&&ue?.id!==s?(0,ns.Y)(oo,{}):void 0),{composerHiddenScale:Bt,toolbarHiddenScale:Rt,composerTranslateX:Nt,toolbarTranslateX:Jt,unpinHiddenScale:Et,toolbarForUnpinHiddenScale:Lt}=(0,Yt.Kr)(()=>function(e,t){const s=e<=a.c2m?U.$:2*U.$,o=function(e){if(e>a.gQx){const t=Math.min(Math.max(.25*e,J),N),s=Math.min(.25*e,N);return Math.min(e-t-s,R)}if(e>a.j7z){const t=Math.min(Math.max(.4*e,J),N);return Math.min(e-t,R)}return e>R?R:e}(e),n=3*U.$,i=t?o-s-n:o-s,r=e>a.c2m?Math.min(o-s,B):o-s,d=r/i,c=i/r;return{composerHiddenScale:d,toolbarHiddenScale:c,composerTranslateX:t?n/2*c:0,toolbarTranslateX:t?n/2*-1*d:0,unpinHiddenScale:r/E,toolbarForUnpinHiddenScale:E/r}}(ke,Ze),[Ze,ke]),Dt=(0,Gt.A)("middle-column-footer",!Ze&&"no-composer",Ze&&Le&&!x&&"with-notch");(0,Os.A)({isActive:x,onBack:ve}),(0,Ka.A)(A);const Vt=Boolean(!m&&!ne&&!Ze&&!Xe&&!$e&&!_e&&Ut)||le&&ue?.id!==s,jt=Boolean(Xe||_e||at||$e||m&&ae||ie||Qe),qt=Boolean(Vt||x);return(0,ns.FD)("div",{id:"MiddleColumn",className:Pt,onTransitionEnd:dt,style:(0,Ea.A)(`--composer-hidden-scale: ${Bt}`,`--toolbar-hidden-scale: ${Rt}`,`--unpin-hidden-scale: ${Et}`,`--toolbar-unpin-hidden-scale: ${Lt},`,`--composer-translate-x: ${Nt}px`,`--toolbar-translate-x: ${Jt}px`,`--pattern-color: ${A}`,S&&`--theme-background-color: ${S}`),onClick:Fe&&M?yt:void 0,children:[Te&&(0,ns.Y)("div",{className:"resize-handle",onMouseDown:lt,onMouseUp:ht,onDoubleClick:ut}),(0,ns.Y)("div",{className:kt,style:Ct?`--custom-background: ${Ct}`:void 0,"data-tauri-drag-region":!(!gt.Vq||!d.MP||Ke&&We)||void 0}),(0,ns.Y)("div",{id:"middle-column-portals"}),Boolean(Ke&&We)&&(0,ns.FD)(ns.FK,{children:[(0,ns.FD)("div",{className:"messages-layout",onDragEnter:Ze?mt:void 0,children:[(0,ns.Y)(ci,{chatId:Ke,threadId:We,messageListType:He,getCurrentPinnedIndex:je,getLoadingPinnedId:qe,onFocusPinnedMessage:Ve},Ke),(0,ns.Y)(Xn,{chatId:Ke,threadId:We,messageListType:He,isComments:n,isMobile:r,getCurrentPinnedIndex:je,getLoadingPinnedId:qe,onFocusPinnedMessage:Ve}),(0,ns.FD)(Ms.Ay,{name:(0,vs.P)("slide",V,z||!j),activeKey:K,shouldCleanup:!0,cleanupExceptionKey:it,isBlockingAnimation:!0,onStop:ct,children:[(0,ns.Y)(cn,{chatId:Ke,threadId:We,type:He,isComments:n,canPost:Ze,onScrollDownToggle:Je,onNotchToggle:Ye,isReady:rt,isContactRequirePremium:re,paidMessagesStars:ce,withBottomShift:jt,withDefaultBg:Boolean(!v&&!S),onIntersectPinnedMessage:ot},`${Ke}-${We}-${He}`),(0,ns.FD)("div",{className:Dt,children:[Ze&&(0,ns.Y)(Wa.A,{type:"messageList",chatId:Ke,threadId:We,messageListType:He,dropAreaState:Be,onDropHide:pt,isReady:rt,isMobile:r,editableInputId:a.CfG,editableInputCssSelector:a.m$5,inputId:"message-input-text"}),m&&ae&&(0,ns.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,ns.FD)(xs.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button unpin-all-button",onClick:ft,children:[(0,ns.Y)(Us.A,{name:"unpin"}),(0,ns.Y)("span",{children:xe("Chat.Pinned.UnpinAll",I,"i")})]})}),ie&&(0,ns.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,ns.Y)(xs.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button open-chat-button",onClick:vt,children:(0,ns.Y)("span",{children:xe("SavedOpenChat")})})}),Vt&&(0,ns.Y)("div",{className:Ft,children:(0,ns.Y)("div",{className:"messaging-disabled-inner",children:(0,ns.Y)("span",{children:Ut})})}),r&&(_e||st&&!at)&&(0,ns.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,ns.Y)(xs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:St,children:xe(tt?"ProfileJoinChannel":"ProfileJoinGroup")})}),r&&at&&(0,ns.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,ns.Y)(xs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:St,children:xe("ChannelJoinRequest")})}),r&&$e&&(0,ns.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,ns.Y)(xs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:wt,children:xe("BotStart")})}),r&&Xe&&(0,ns.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,ns.Y)(xs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:At,children:xe("BotRestart")})}),r&&Qe&&(0,ns.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,ns.Y)(xs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:Mt,children:xe("Unblock")})}),(0,ns.Y)(un,{messageListType:He,isActive:x,canPost:Ze}),(0,ns.Y)(_a,{isOpen:L}),(0,ns.Y)(Ha,{isOpen:Y}),(0,ns.Y)(ui,{isOpen:O}),d.CM&&(0,ns.Y)(Xa,{isOpen:G})]})]}),(0,ns.Y)(ao,{withScrollDown:et,canPost:Ze,withExtraShift:qt})]}),(0,ns.Y)(hi,{isActive:Boolean(T)})]}),s&&(0,ns.Y)($a,{isOpen:De,chatId:s,pinnedMessagesCount:I,onClose:It,onUnpin:bt}),(0,ns.Y)("div",{teactFastList:!0,children:Q?.map((e,t)=>(0,ns.Y)(Za,{teactOrderKey:t,activeEmojiInteraction:e},e.id))})]})})),gi={giftCodeModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"GiftCodeModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},boostModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"BoostModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},chatlistModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"ChatlistModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},urlAuth:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"UrlAuthModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},oneTimeMediaModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"OneTimeMediaModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},inviteViaLinkModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"InviteViaLinkModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},requestedAttachBotInstall:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"AttachBotInstallModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},reportAdModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"ReportAdModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},reportModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"ReportModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},webApps:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"WebAppModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},collectibleInfoModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"CollectibleInfoModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},mapModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"MapModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},starsPayment:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"StarPaymentModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},starsBalanceModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"StarsBalanceModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},starsTransactionModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"StarsTransactionInfoModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},chatInviteModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"ChatInviteModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},paidReactionModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"PaidReactionModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},suggestMessageModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"SuggestMessageModal",!t);return s?(0,ns.Y)(s,{...e}):(0,ns.Y)(Cs.A,{})},suggestedPostApprovalModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"SuggestedPostApprovalModal",!t);return s?(0,ns.Y)(s,{...e}):(0,ns.Y)(Cs.A,{})},starsSubscriptionModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"StarsSubscriptionModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},starsGiftModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"StarsGiftModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},giftModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},isGiftRecipientPickerOpen:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftRecipientPicker",!t);return s?(0,ns.Y)(s,{...e}):void 0},isWebAppsCloseConfirmationModalOpen:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"WebAppsCloseConfirmationModal",!t);return s?(0,ns.Y)(s,{isOpen:t}):void 0},giftInfoModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftInfoModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},giftInfoValueModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftInfoValueModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},giftResalePriceComposerModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftResalePriceComposerModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},suggestedStatusModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"SuggestedStatusModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},emojiStatusAccessModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"EmojiStatusAccessModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},locationAccessModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"LocationAccessModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},aboutAdsModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"AboutAdsModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},giftUpgradeModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftUpgradeModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},monetizationVerificationModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"VerificationMonetizationModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},giftWithdrawModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftWithdrawModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},giftStatusInfoModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftStatusInfoModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},preparedMessageModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"PreparedMessageModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},sharePreparedMessageModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"SharePreparedMessageModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},giftTransferModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"GiftTransferModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},chatRefundModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Stars,"ChatRefundModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},priceConfirmModal:e=>{let{modal:t}=e;const s=(0,os.A)(qt.ar.Stars,"PriceConfirmModal",!t);return s?(0,ns.Y)(s,{modal:t}):void 0},isFrozenAccountModalOpen:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"FrozenAccountModal",t);return s?(0,ns.Y)(s,{...e}):void 0},deleteAccountModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"DeleteAccountModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},isAgeVerificationModalOpen:(0,Yt.ph)(e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"AgeVerificationModal",!t);return s?(0,ns.Y)(s,{...e}):void 0}),profileRatingModal:e=>{const{modal:t}=e,s=(0,os.A)(qt.ar.Extra,"ProfileRatingModal",!t);return s?(0,ns.Y)(s,{...e}):void 0}},fi=Object.keys(gi),Ii=Object.entries(gi),vi=(0,Yt.ph)((0,w.EK)(e=>(0,h.Up)((0,C.nTw)(e),fi))(e=>Ii.map(t=>{let[s,a]=t;return(0,ns.Y)(a,{modal:e[s]},s)}))),bi=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"PaymentModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},yi=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"ReceiptModal",!t);return s?(0,ns.Y)(s,{...e}):void 0};var Si=s(60406),wi=s(79582),Ai=s(54960),Mi=s(12933);const Ci=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s}=t;const a=(0,C.hds)(e,s),{userIds:o}=e.contactList||{},{newChatMembersProgress:n}=(0,C.nTw)(e),{currentUserId:r}=e,d=a&&(0,y.WX)(a),{query:c,fetchingStatus:l,globalUserIds:u,localUserIds:h}=(0,C.nTw)(e).userSearch;return{isChannel:d,members:(0,C.AWZ)(e,s)?.members,currentUserId:r,localContactIds:o,searchQuery:c,isSearching:l,isLoading:n===i.D7.Loading,globalUserIds:u,localUserIds:h}})(e=>{let{isChannel:t,members:s,onNextStep:a,currentUserId:o,localContactIds:n,isLoading:i,searchQuery:r,isSearching:d,localUserIds:c,globalUserIds:l,onClose:u,isActive:m}=e;const{setUserSearchQuery:p}=(0,w.ko)(),g=(0,Fs.A)(),[f,I]=(0,Yt.J0)([]),v=(0,Da.A)(f)===f;(0,Os.A)({isActive:m,onBack:u});const b=(0,Yt.Kr)(()=>s?s.map(e=>e.userId):[],[s]),A=(0,Yt.hb)(e=>{p({query:e})},[p]),M=(0,Yt.Kr)(()=>{const e=(0,w.mS)().users.byId,s=(0,S.PU)({ids:(0,h.Am)([...n||[],...c||[],...l||[]]),query:r,type:"user"});return(0,wi.A)(s.filter(s=>{const a=e[s];return!b.includes(s)&&s!==o&&(!a||!(0,y.tv)(a)||!t&&a.canBeInvitedToGroup)}))},[n,r,c,l,o,b,t]),C=(0,Yt.hb)(()=>{f.length&&(p({query:""}),a(f))},[f,p,a]);return(0,ns.Y)("div",{className:"AddChatMembers",children:(0,ns.FD)("div",{className:"AddChatMembers-inner",children:[(0,ns.Y)(Ai.A,{itemIds:M,selectedIds:f,filterValue:r,filterPlaceholder:g("lng_channel_add_users"),searchInputId:"new-members-picker-search",isLoading:d,onSelectedIdsChange:I,onFilterChange:A,isSearchable:!0,withDefaultPadding:!0,noScrollRestore:v,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),(0,ns.Y)(Mi.A,{isShown:Boolean(f.length),disabled:i,ariaLabel:g("lng_channel_add_users"),onClick:C,children:i?(0,ns.Y)(sa.A,{color:"white"}):(0,ns.Y)(Us.A,{name:"arrow-right"})})]})})})),Pi=e=>{const t=(0,os.A)(qt.ar.Extra,"CreateTopic");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})},ki=e=>{const t=(0,os.A)(qt.ar.Extra,"EditTopic");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})},Fi=()=>{const e=(0,os.A)(qt.ar.Extra,"GifSearch");return e?(0,ns.Y)(e,{}):(0,ns.Y)(Cs.A,{})},Ti=e=>{const t=(0,os.A)(qt.ar.Extra,"Management");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})},xi=()=>{const e=(0,os.A)(qt.ar.Extra,"PollResults");return e?(0,ns.Y)(e,{}):(0,ns.Y)(Cs.A,{})};var Ui=s(55475),Bi=s(35104),Ri=s(55429),Ni=s(68323),Ji=s(23459);const Ei=(0,I.nF)(e=>e(),250,!1);let Li=!1;function Yi(e){switch(e){case"members":return i.zW.MemberList;case"gifts":return i.zW.GiftList;case"stories":return i.zW.StoryList;case"dialogs":return i.zW.SavedDialogs;default:return i.zW.SharedMedia}}var Di=s(96374);function Oi(e,t){const[s,o]=(0,Di.A)(e,t,void 0,a.nnT);return[s,o,!(!s||!t||s[0]===t[0])]}function Gi(e,t,s,o,n,i){const r=(0,Yt.li)();(0,es.A)(()=>{r.current=void 0},[i]),(0,es.A)(()=>{t===e&&o&&n&&(r.current=(0,y.lH)(o,n,e))},[o,n,t,e]);const[d,c]=(0,Di.A)(s,r.current,void 0,"media"===e?a.Um:a.gXr);return[d,c,!(!d||!r.current||d[0]===r.current[0])]}var Vi=s(65240),ji=s(55723),qi=s(58968),zi=s(66833),Ki=s(40558),Wi=s(25404),Hi=s(87049);const _i="LLQBJODm",$i="_TMVTkD4",Xi=(0,Yt.ph)((0,w.EK)((e,t)=>{let{peerId:s,gift:a}=t;const o=a.fromId?(0,C.PVB)(e,a.fromId):void 0,n=(0,C.hds)(e,s),i=n&&(0,y.ub)(n,"postMessages"),r=e.currentUserId,d=r?(0,C.mBe)(e,r):void 0,c=d?.emojiStatus,l=e.collectibleEmojiStatuses?.statuses;return{fromPeer:o,hasAdminRights:i,currentUserId:r,currentUserEmojiStatus:c,collectibleEmojiStatuses:l}})(e=>{let{peerId:t,gift:s,style:o,fromPeer:n,currentUserId:i,hasAdminRights:r,collectibleEmojiStatuses:c,currentUserEmojiStatus:l,observeIntersection:u}=e;const{openGiftInfoModal:h}=(0,w.ko)(),m=(0,Yt.li)(),p=(0,Yt.li)(),f=(0,Ht.A)(),[I,v,b]=(0,_s.A)(),y=t===i||r,S=(0,zi.UC)(s.gift),A=s.gift,M="starGiftUnique"===A.type?A:void 0,C=(0,Yt.Kr)(()=>{if(M?.resellPrice)return M.resaleTonOnly?M.resellPrice.find(e=>e.currency===a.ykW):M.resellPrice.find(e=>e.currency===a.OUy)},[M]),P=M?.resellPrice?f("GiftRibbonSale"):s.isPinned&&M?f("GiftSavedNumber",{number:M.number}):S?f("ActionStarGiftLimitedRibbon",{total:(0,ps.Vw)(f,S)}):void 0,k=M?.resellPrice?"green":"blue",{isContextMenuOpen:F,contextMenuAnchor:T,handleBeforeContextMenu:x,handleContextMenu:U,handleContextMenuClose:B,handleContextMenuHide:R}=(0,eo.A)(m),N=(0,_t.A)(()=>m.current),J=(0,_t.A)(()=>m.current.closest(".custom-scroll")),E=(0,_t.A)(()=>document.querySelector("#portals")?.querySelector(".saved-gift-context-menu .bubble")),L=(0,_t.A)(()=>({withPortal:!0})),Y=(0,_t.A)(()=>{h({peerId:t,gift:s})}),D=s.isNameHidden&&!n?qi.I5:n,O=(0,zi.yQ)(s.gift),G=(0,Yt.Kr)(()=>(0,zi.uc)(s.gift),[s.gift]),{backdrop:V,pattern:j}=G||{},q=(0,Yt.Kr)(()=>{if(!V||!j)return;const e=[V.centerColor,V.edgeColor],t=V.patternColor;return(0,ns.Y)(Ki.A,{className:"_I9aOdGr",backgroundColors:e,patternColor:t,patternIcon:j.sticker})},[V,j]);if(O)return(0,ns.FD)("div",{ref:m,className:(0,Gt.A)("interactive-gift scroll-item","HN4dYXIk"),style:o,onClick:Y,onContextMenu:U,onMouseDown:x,onMouseEnter:d.TF?void 0:v,onMouseLeave:d.TF?void 0:b,children:[q,!q&&(0,ns.Y)(ha.A,{className:$i,peer:D,size:"micro"}),s.isPinned&&(0,ns.Y)(Us.A,{name:"pinned-message",className:$i}),(0,ns.Y)("div",{ref:p,className:"NYuBBB9j",style:"width: 90px; height: 90px",children:O&&(0,ns.Y)(Io.A,{containerRef:p,sticker:O,size:90,shouldLoop:I,shouldPreloadPreview:!0,observeIntersectionForPlaying:u,observeIntersectionForLoading:u})}),s.isUnsaved&&(0,ns.Y)("div",{className:"xY4yqqYA",children:(0,ns.Y)(Us.A,{name:"eye-crossed-outline"})}),C&&(0,ns.Y)(xs.A,{className:"haa6STaT",nonInteractive:!0,size:"tiny",withSparkleEffect:!0,pill:!0,fluid:!0,children:"TON"===C.currency?(0,g.Ms)(f,C.amount,{shouldConvertFromNanos:!0,className:_i}):(0,g.U2)(f,C.amount,{asFont:!0,className:_i})}),P&&(0,ns.Y)(Hi.A,{color:k,text:P}),void 0!==T&&(0,ns.Y)(Bs.A,{isOpen:F,anchor:T,className:"saved-gift-context-menu",autoClose:!0,withPortal:!0,getMenuElement:E,getTriggerElement:N,getRootElement:J,getLayout:L,onClose:B,onCloseAnimationEnd:R,children:(0,ns.Y)(Wi.A,{peerId:t,gift:s,canManage:y,collectibleEmojiStatuses:c,currentUserEmojiStatus:l})})]})}));var Qi=s(81524),Zi=s(42827),er=s(83057);const tr=(0,Yt.ph)(e=>{let{media:t,idPrefix:s="preview-media",isProtected:a,observeIntersection:o,onClick:n,index:i}=e;const r=(0,Yt.li)(),d=(0,Jo.Vz)(r,o),c=(0,Jn.A)(t),l=(0,vn.A)(t,"preview"),u=(0,Ao.A)(l,!d),h=(0,er.A)(u),m=t.content.video,p=(0,_t.A)(()=>{n(i)});return(0,ns.FD)("div",{ref:r,id:`${s}${i}`,className:"Media scroll-item",onClick:p,children:[(0,ns.Y)("img",{src:c,className:"media-miniature",alt:"",draggable:!a,decoding:"async",onContextMenu:a?So.A:void 0}),(0,ns.Y)("img",{src:u,className:(0,Gt.A)("full-media","media-miniature",h),alt:"",draggable:!a,decoding:"async",onContextMenu:a?So.A:void 0}),m&&(0,ns.Y)("span",{className:"video-duration",children:m.isGif?"GIF":(0,Se.QO)(m.duration)}),a&&(0,ns.Y)("span",{className:"protector"})]})});var sr=s(44784),ar=s(70195),or=s(37378),nr=s(59816);const ir="NOCaj4mx",rr=(0,Yt.ph)((0,w.EK)((e,t)=>{let{story:s}=t;const a=(0,C.hds)(e,s.peerId),o=a?.isProtected,{maxPinnedStoriesCount:n}=e.appConfig,i="isOut"in s&&s.isOut,r=(0,C.gVx)(e,s.peerId),d=r?.some(e=>e.id===s.id);return{isProtected:o,isPinned:d,canPin:i&&(!n||(r?.length||0)<n)}})(function(e){let{story:t,isProtected:s,isArchive:a,isPinned:o,canPin:n}=e;const{openStoryViewer:i,loadPeerSkippedStories:r,toggleStoryInProfile:d,toggleStoryPinnedToTop:c,showNotification:l}=(0,w.ko)(),u=(0,Fs.A)(),h=(0,Yt.li)(),m=(0,_t.A)(()=>h.current),p=(0,_t.A)(()=>document.body),g=(0,_t.A)(()=>document.querySelector("#portals .story-context-menu .bubble")),f=(0,_t.A)(()=>({withPortal:!0,isDense:!0})),I=t&&t.peerId,v=t&&"content"in t,b=v&&t.isOut,S=t&&"isDeleted"in t,A=v?t.content.video:void 0,M=A&&(0,Se.QO)(A.duration),C=v?(0,y.EN)(t):void 0,P=(0,Ao.A)(C)||A?.thumbnail?.dataUri;(0,Yt.vJ)(()=>{!t||v||S||r({peerId:t.peerId})},[S,v,t]);const{isContextMenuOpen:k,contextMenuAnchor:F,handleBeforeContextMenu:T,handleContextMenu:x,handleContextMenuClose:U,handleContextMenuHide:B}=(0,eo.A)(h,!b),R=(0,Yt.hb)(()=>{i({peerId:t.peerId,storyId:t.id,isSinglePeer:!0,isPrivate:!0,isArchive:a})},[a,t.id,t.peerId]),N=(0,_t.A)(e=>{(0,ho.u)(e),T(e)}),J=(0,_t.A)(e=>{(0,So.A)(e),d({peerId:I,storyId:t.id,isInProfile:!0}),l({message:u("Story.ToastSavedToProfileText")}),U()}),E=(0,_t.A)(e=>{(0,So.A)(e),d({peerId:I,storyId:t.id,isInProfile:!1}),l({message:u("Story.ToastRemovedFromProfileText")}),U()}),L=(0,_t.A)(()=>{c({peerId:I,storyId:t.id}),U()});return(0,ns.FD)("div",{ref:h,className:(0,Gt.A)("kxMIqtqr","scroll-item"),onMouseDown:N,onClick:R,onContextMenu:x,children:[S&&(0,ns.FD)("span",{children:[(0,ns.Y)(Us.A,{className:"cq7jTRkg",name:"story-expired"}),u("ExpiredStory")]}),o&&(0,ns.Y)(Us.A,{className:(0,Gt.A)(ir,"GTWFQyJx"),name:"pin-badge"}),v&&Boolean(t.views?.viewsCount)&&(0,ns.FD)("span",{className:(0,Gt.A)(ir,"g09Rb4Ps"),children:[(0,ns.Y)(Us.A,{name:"eye"}),t.views.viewsCount]}),M&&(0,ns.Y)("span",{className:(0,Gt.A)(ir,"lM_2MMyQ"),children:M}),(0,ns.FD)("div",{className:"D6Yajvjx",children:[P&&(0,ns.Y)("img",{src:P,alt:"",className:"cV_QL3N5",draggable:!1}),v&&(0,ns.Y)(nr.A,{story:t}),s&&(0,ns.Y)("span",{className:"protector"})]}),void 0!==F&&(0,ns.FD)(Bs.A,{isOpen:k,anchor:F,getTriggerElement:m,getRootElement:p,getMenuElement:g,getLayout:f,className:(0,Gt.A)("UAfI9izT","story-context-menu"),autoClose:!0,onClose:U,onCloseAnimationEnd:B,withPortal:!0,children:[a&&(0,ns.Y)(Rs.A,{icon:"archive",onClick:J,children:u("StoryList.SaveToProfile")}),!a&&(0,ns.Y)(Rs.A,{icon:"archive",onClick:E,children:u("Story.Context.RemoveFromProfile")}),!a&&!o&&n&&(0,ns.Y)(Rs.A,{icon:"pin",onClick:L,children:u("StoryList.ItemAction.Pin")}),!a&&o&&(0,ns.Y)(Rs.A,{icon:"unpin",onClick:L,children:u("StoryList.ItemAction.Unpin")})]})]})}));var dr=s(46222),cr=s(22720),lr=s(285),ur=s(36838),hr=s(79577);const mr=(0,Yt.ph)(e=>{let{id:t,title:s,sticker:a,onClick:o}=e;const n=(0,_t.A)(()=>{o?.(t)});return(0,ns.FD)("div",{className:"_KBrROQt",onClick:n,children:[a&&(0,ns.Y)(hr.A,{className:"Y3vEed9M",sticker:a,size:20,forcePreview:!0}),s]})}),pr=(0,Yt.ph)(e=>{let{items:t,selectedItemId:s,animationLevel:a,onItemSelect:o,className:n}=e;const i=(0,Yt.li)(),r=(0,Yt.li)(),d=t.findIndex(e=>e.id===s)||0,[c,l]=(0,Yt.J0)(""),u=a>0;(0,ur.A)(i,!t.length,!0);const h=(0,_t.A)(()=>{const e=r.current,t=d>=0&&e?.childNodes[d];if(e&&t&&e.offsetWidth>0){const{offsetLeft:s,offsetWidth:a}=t,o=e.offsetWidth,n=(s/o*100).toFixed(1),i=((o-(s+a))/o*100).toFixed(1);l(`inset(0 ${i}% 0 ${n}% round 1rem)`)}});if((0,Yt.vJ)(()=>{h()},[d,t]),(0,go.A)(r,h),t.length)return(0,ns.FD)("div",{ref:i,className:(0,Gt.A)("UQ6pUmuC","no-scrollbar",n,c&&"_Nw3GzkO"),children:[t.map(e=>(0,ns.Y)(mr,{id:e.id,title:e.title,sticker:e.sticker,onClick:o},e.id)),(0,ns.Y)("div",{ref:r,className:(0,Gt.A)("c397ZVz4","clip-path-container",!u&&"zNFdzcTe"),style:c?`clip-path: ${c}`:void 0,"aria-hidden":!0,children:t.map((e,t)=>(0,ns.Y)(mr,{id:e.id,title:e.title,sticker:e.sticker,onClick:o},e.id))})]})}),gr=(0,Yt.ph)((0,w.EK)((e,t)=>{let{peerId:s}=t;const{starGiftCollections:a}=e,o=a?.byPeerId?.[s];return{collections:o,activeCollectionId:(0,C.B59)(e,s),animationLevel:(0,je.l)(e).animationLevel}})(e=>{let{peerId:t,className:s,collections:a,activeCollectionId:o,animationLevel:n}=e;const{updateSelectedGiftCollection:i,resetSelectedGiftCollection:r}=(0,w.ko)(),d=(0,Ht.A)(),c=(0,_t.A)(e=>{if("all"===e)r({peerId:t});else{const s=Number(e);i({peerId:t,collectionId:s})}});if(!a||0===a.length)return;const l=(0,Yt.Kr)(()=>[{id:"all",title:d("AllGiftsCategory")},...a.map(e=>({id:String(e.collectionId),title:e.title,sticker:e.icon}))],[a,d]),u=o?String(o):"all";return(0,ns.Y)(pr,{items:l,selectedItemId:u,animationLevel:n,onItemSelect:c,className:(0,Gt.A)("pvf61Tbm",s)})})),fr=(0,Yt.ph)((0,w.EK)((e,t)=>{let{peerId:s}=t;const{stories:a}=e,o=a?.albumsByPeerId?.[s];return{albums:o,selectedAlbumId:(0,at.tW)(e),animationLevel:(0,je.l)(e).animationLevel}})(e=>{let{peerId:t,className:s,albums:a,selectedAlbumId:o,animationLevel:n}=e;const{selectStoryAlbum:i,resetSelectedStoryAlbum:r}=(0,w.ko)(),d=(0,Ht.A)(),c=(0,_t.A)(e=>{if("all"===e)r();else{const s=Number(e);i({peerId:t,albumId:s})}});if(!a?.length)return;const l=(0,Yt.Kr)(()=>[{id:"all",title:d("AllStoriesCategory")},...a.map(e=>({id:String(e.albumId),title:e.title}))],[a,d]),u=o?String(o):"all";return(0,ns.Y)(pr,{items:l,selectedItemId:u,animationLevel:n,onItemSelect:c,className:(0,Gt.A)("GgK8T6WN",s)})})),Ir=[{type:"media",key:"ProfileTabMedia"},{type:"documents",key:"ProfileTabFiles"},{type:"links",key:"ProfileTabLinks"},{type:"audio",key:"ProfileTabMusic"}];function vr(e,t,s,a){return(0,ns.FD)("div",{className:"profile-info",children:[(0,ns.Y)(ar.A,{peerId:e,canPlayVideo:t,isForMonoforum:a}),(0,ns.Y)(sr.A,{chatOrUserId:e,isSavedDialog:s})]})}const br=(0,Yt.ph)((0,w.EK)((e,t)=>{let{chatId:s,threadId:a,isMobile:o}=t;const i=(0,C.mBe)(e,s),r=(0,C.hds)(e,s),d=(0,C.AWZ)(e,s),c=(0,C.vGo)(e,s),l=(0,C.zeq)(e,s),{animationLevel:u,shouldWarnAboutFiles:h}=(0,je.l)(e),{currentType:m,resultsByType:p}=(0,C.BU_)(e)||{},{foundIds:g}=p&&m&&p[m]||{},f=Boolean(r?.isForum&&a&&a!==n.l3),{byId:I,statusesById:v}=e.users,{byId:b}=e.chats,S=(0,y.cG)(s,a,e.currentUserId),w=r&&(0,y.YE)(r),A=r&&(0,y.WX)(r),M=i&&(0,y.tv)(i),P=!f&&!S&&(w||A&&(0,y.SJ)(r))&&!r?.isMonoforum,k=d?.members,F=d?.adminMembersById,T=P&&r&&(r.isForbidden||d&&!d.canViewMembers),x=P&&r&&((0,y.ub)(r,"inviteUsers")||!A&&!(0,y.Sq)(r,"inviteUsers")||r.isCreator),U=P&&r&&((0,y.ub)(r,"banUsers")||r.isCreator),B=(0,C.yuw)(e),{similarChannelIds:R}=(0,C.dg4)(e,s)||{},{similarBotsIds:N}=(0,C.AOG)(e,s)||{},J=(0,C.g29)(e),E=i||r,L=c||d,Y=i&&!i.isSelf&&!(0,y.tv)(i)&&!S&&Boolean(c?.commonChatsCount),D=(0,C.Ua4)(e,s),O=c?.botInfo?.hasPreviewMedia,G=e.users.previewMediaByBotId[s],V=E&&(i?.isSelf||!E.areStoriesHidden&&L?.hasPinnedStories)&&!S,j=V?(0,C._bp)(e,E.id):void 0,q=(0,C.nTw)(e),{nextProfileTab:z,forceScrollProfileTab:K,savedGifts:W}=q,H=(0,at.tW)(e),_="all"!==H?j?.idsByAlbumId?.[H]?.ids:j?.profileIds,$=j?.pinnedIds,X=j?.byId,Q=j?.archiveIds,Z=Boolean(L?.starGiftCount)&&!S,ee=(0,Ui.B5)(e,s),te=W.collectionsByPeerId[s]?.[ee],se=e.stories.albumsByPeerId?.[s],ae=e.starGiftCollections?.byPeerId?.[s],oe=(0,C.k2W)(e,s),ne=r&&(0,C._ls)(e,r.id);return{theme:(0,C.SJA)(e),isChannel:A,isBot:M,messagesById:l,foundIds:g,mediaSearchType:m,hasCommonChatsTab:Y,hasStoriesTab:V,hasMembersTab:P,hasPreviewMediaTab:O,areMembersHidden:T,canAddMembers:x,canDeleteMembers:U,currentUserId:e.currentUserId,isRightColumnShown:(0,C.gjV)(e,o),isRestricted:ne,activeDownloads:B,usersById:I,userStatusesById:v,chatsById:b,storyIds:_,hasGiftsTab:Z,gifts:te?.gifts,storyAlbums:se,giftCollections:ae,pinnedStoryIds:$,archiveStoryIds:Q,storyByIds:X,selectedStoryAlbumId:H,activeCollectionId:ee,giftsFilter:W.filter,isChatProtected:r?.isProtected,nextProfileTab:z,forceScrollProfileTab:K,animationLevel:u,shouldWarnAboutFiles:h,similarChannels:R,similarBots:N,botPreviewMedia:G,isCurrentUserPremium:J,isTopicInfo:f,isSavedDialog:S,isSynced:e.isSynced,limitSimilarPeers:(0,fe.B)(e,"recommendedChannels"),members:P?k:void 0,adminMembersById:P?F:void 0,commonChatIds:D?.ids,monoforumChannel:oe}})(e=>{let{chatId:t,isActive:s,threadId:o,profileState:r,theme:c,monoforumChannel:l,isChannel:u,isBot:h,currentUserId:m,messagesById:p,foundIds:g,storyIds:f,pinnedStoryIds:I,archiveStoryIds:v,storyByIds:b,selectedStoryAlbumId:S,activeCollectionId:A,giftsFilter:M,mediaSearchType:C,hasCommonChatsTab:F,hasStoriesTab:T,hasMembersTab:x,hasPreviewMediaTab:U,hasGiftsTab:B,gifts:R,storyAlbums:N,giftCollections:J,botPreviewMedia:E,areMembersHidden:L,canAddMembers:Y,canDeleteMembers:D,commonChatIds:O,members:G,adminMembersById:V,usersById:j,userStatusesById:q,chatsById:z,isRightColumnShown:K,isRestricted:W,activeDownloads:H,isChatProtected:_,nextProfileTab:$,animationLevel:X,shouldWarnAboutFiles:Q,similarChannels:Z,similarBots:ee,isCurrentUserPremium:te,limitSimilarPeers:se,isTopicInfo:ae,isSavedDialog:oe,forceScrollProfileTab:ne,isSynced:ie,onProfileStateChange:re}=e;const{setSharedMediaSearchType:de,loadMoreMembers:ce,loadCommonChats:le,openChat:ue,searchSharedMediaMessages:he,openMediaViewer:me,openAudioPlayer:pe,focusMessage:ge,setNewChatMembersDialogState:fe,loadPeerProfileStories:Ie,loadStoriesArchive:ve,openPremiumModal:be,loadChannelRecommendations:ye,loadBotRecommendations:Se,loadPreviewMedias:we,loadPeerSavedGifts:Ae,resetGiftProfileFilter:Me,loadStarGiftCollections:Ce,loadStoryAlbums:Pe,resetSelectedStoryAlbum:ke}=(0,w.ko)(),Fe=(0,Yt.li)(),Te=(0,Yt.li)(),xe=(0,Fs.A)(),Ue=(0,Ht.A)(),[Be,Re]=(0,Yt.J0)(),[Ne,Je,Ee]=(0,_s.A)(),Le=oe?String(o):t,Ye=Le===m&&!oe,[De,Oe]=(0,Yt.J0)(0),Ge=(0,Yt.Kr)(()=>{const e=[];return Ye&&!oe&&e.push({type:"dialogs",key:"ProfileTabSavedDialogs"}),T&&e.push({type:"stories",key:"ProfileTabStories"}),T&&Ye&&e.push({type:"storiesArchive",key:"ProfileTabStoriesArchive"}),B&&e.push({type:"gifts",key:"ProfileTabGifts"}),x&&e.push({type:"members",key:u?"ProfileTabSubscribers":"ProfileTabMembers"}),U&&e.push({type:"previewMedia",key:"ProfileTabBotPreview"}),e.push(...Ir),ae||e.push({type:"voice",key:"ProfileTabVoice"}),F&&e.push({type:"commonChats",key:"ProfileTabSharedGroups"}),u&&Z?.length&&e.push({type:"similarChannels",key:"ProfileTabSimilarChannels"}),h&&ee?.length&&e.push({type:"similarBots",key:"ProfileTabSimilarBots"}),e.map(e=>({type:e.type,title:Ue(e.key)}))},[Ye,oe,T,B,x,U,ae,F,u,h,Z?.length,ee?.length,Ue]),Ve=(0,Yt.Kr)(()=>{if(!$)return 0;const e=Ge.findIndex(e=>{let{type:t}=e;return t===$});return-1===e?0:e},[$,Ge]),[je,qe,ze]=(0,_s.A)(!1),[Ke,We]=(0,Yt.J0)(Ve);(0,Yt.vJ)(()=>{if(!$)return;const e=Ge.findIndex(e=>{let{type:t}=e;return t===$});-1!==e&&We(e)},[$,Ge]);const He=(0,Yt.hb)(e=>{qe(),We(e)},[]);(0,Yt.vJ)(()=>{U&&!E&&we({botId:t})},[t,E,U]),(0,Yt.vJ)(()=>{u&&!Z&&ie&&ye({chatId:t})},[t,u,Z,ie]),(0,Yt.vJ)(()=>{h&&!ee&&ie&&Se({userId:t})},[t,h,ee,ie]),(0,Yt.vJ)(()=>{ke()},[t]),(0,es.A)(()=>{Je()},[M]),(0,es.A)(()=>{Ee()},[R]),(0,Yt.vJ)(()=>{B&&ie&&(Ce({peerId:t}),Pe({peerId:t}))},[t,B,ie]);const[_e,$e]=(0,Yt.J0)(R),{startViewTransition:Xe,shouldApplyVtn:Qe}=(0,Ni.Y)(),Ze=(0,Yt.Kr)(()=>_e?.map(e=>(0,Bi.p)(e)),[_e]),et=Ke>Ge.length-1?Ge.length-1:Ke,tt=Ge[et].type,st=(0,Yt.hb)(()=>{le({userId:t})},[t]),at=(0,Yt.hb)(e=>{let{offsetId:s}=e;Ie({peerId:t,offsetId:s})},[t]),ot=(0,Yt.hb)(e=>{let{offsetId:s}=e;ve({peerId:t,offsetId:s})},[t]),it=(0,Yt.hb)(()=>{Ae({peerId:t})},[t]),rt=(0,Yt.hb)(()=>{ce({chatId:t})},[t,ce]);(0,fa.A)(e=>{let[t]=e;if((0,P.T)(R,t))return;if(!R||!t||!Ne)return void $e(R);const s=t.map(e=>(0,Bi.p)(e)),a=R.map(e=>(0,Bi.p)(e));s.some((e,t)=>e!==a[t])&&X>0?Xe(()=>{$e(R)}):$e(R)},[R,Xe,X,Ne]);const[dt,ct,lt,ht]=function(e){let{loadMoreMembers:t,loadCommonChats:s,searchMessages:a,loadStories:o,loadStoriesArchive:n,loadMoreGifts:i,tabType:r,mediaSearchType:d,groupChatMembers:c,commonChatIds:l,usersById:u,userStatusesById:h,chatsById:m,chatMessages:p,foundIds:g,threadId:f,storyIds:I,giftIds:v,pinnedStoryIds:b,archiveStoryIds:S,similarChannels:w,similarBots:A}=e;const M="members"!==r&&d?d:r,C=(0,Yt.Kr)(()=>{if(c&&u&&h)return(0,y.UB)(c.map(e=>{let{userId:t}=e;return t}),u,h)},[c,u,h]),P=(0,Yt.Kr)(()=>{if(l&&m)return(0,wi.A)(l,!0)},[m,l]),[k,F,T]=Oi(t,C),[x,U,B]=Gi("media",M,a,p,g,f),[R,N,J]=Gi("documents",M,a,p,g,f),[E,L,Y]=Gi("links",M,a,p,g,f),[D,O,G]=Gi("audio",M,a,p,g,f),[V,j,q]=Gi("voice",M,a,p,g,f),[z,K,W]=Oi(s,P),H=(0,Yt.Kr)(()=>{if(!I?.length)return I;const e=new Set(b);return I.slice().sort((t,s)=>{const a=e.has(t),o=e.has(s);return a&&!o?-1:!a&&o?1:s-t})},[I,b]),[_,$,X]=Oi(o,H),[Q,Z,ee]=Oi(n,S);let te,se,ae=!1;switch(M){case"members":te=k,se=F,ae=T;break;case"commonChats":te=z,se=K,ae=W;break;case"media":te=x,se=U,ae=B;break;case"documents":te=R,se=N,ae=J;break;case"links":te=E,se=L,ae=Y;break;case"audio":te=D,se=O,ae=G;break;case"voice":te=V,se=j,ae=q;break;case"stories":te=_,se=$,ae=X;break;case"storiesArchive":te=Q,se=Z,ae=ee;break;case"similarChannels":te=w;break;case"similarBots":te=A;break;case"gifts":te=v,se=i;break;case"dialogs":ae=!0}return[M,te,se,ae]}({loadMoreMembers:rt,searchMessages:he,loadStories:at,loadStoriesArchive:ot,loadMoreGifts:it,loadCommonChats:st,tabType:tt,mediaSearchType:C,groupChatMembers:G,commonChatIds:O,usersById:j,userStatusesById:q,chatsById:z,chatMessages:p,foundIds:g,threadId:o,storyIds:f,giftIds:Ze,pinnedStoryIds:I,archiveStoryIds:v,similarChannels:Z,similarBots:ee}),mt=Ye&&"dialogs"===dt||T&&"stories"===dt||"members"===dt||!x&&"media"===dt,pt=Ge.findIndex(e=>{let{type:t}=e;return t===dt}),[gt,ft,It]=(0,_s.A)(!1),[vt,bt,yt]=(0,_s.A)(!1),St=J&&J.length>0,wt=N&&N.length>0,At="gifts"===dt&&St||"stories"===dt&&wt;(0,Yt.vJ)(()=>{St?setTimeout(()=>{ft()},300):It(),wt?setTimeout(()=>{bt()},300):yt()},[St,wt,ft,bt]),(0,Ji.A)("members"===dt?ct:void 0);const Mt=(0,_t.A)(()=>{ze()}),{handleScroll:Ct}=function(e,t,s,a){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6?arguments[6]:void 0;(0,fa.A)(s=>{let[i]=s;if(i&&i!==t&&n||t&&o){const s=e.current,o=s.querySelector(".TabList");r(),s.scrollTop<o.offsetTop&&(a(Yi(t)),Li=!0,(0,nt.Ay)({container:s,element:o,position:"start",forceDuration:300}),setTimeout(()=>{Li=!1},350))}},[t,a,e,o,n,r]),(0,fa.A)(t=>{let[a]=t;if(s!==i.zW.Profile||s===a)return;const o=e.current;if(!o)return;const n=o.querySelector(".TabList");!n||n.offsetTop>o.scrollTop||(Li=!0,(0,nt.Ay)({container:o,element:o.firstElementChild,position:"start",maxDistance:2*o.offsetHeight}),setTimeout(()=>{Li=!1},350))},[s,e]);const d=(0,_t.A)(()=>{const s=e.current;if(!s)return;const o=s.querySelector(".TabList");if(!o)return;let n=i.zW.Profile;Math.ceil(s.scrollTop)>=o.offsetTop&&(n=Yi(t)),a(n)});return(0,Yt.vJ)(()=>{Li||d()},[d,t]),{handleScroll:(0,_t.A)(()=>{Li||Ei(d)})}}(Fe,dt,r,re,ne,je,Mt),{applyTransitionFix:Pt,releaseTransitionFix:kt}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".Transition.shared-media-transition";return(0,Yt.vJ)(()=>{function s(){const s=e.current,a=s.querySelector(t),o=s.querySelector(".TabList");if(a&&o){const e=s.clientHeight-o.offsetHeight;(0,Ot.RK)(()=>{a.style.minHeight=`${e}px`})}}return s(),window.addEventListener("resize",s,!1),()=>{window.removeEventListener("resize",s,!1)}},[e,t]),{applyTransitionFix:(0,_t.A)(()=>{(0,Ot.YS)(()=>{const t=e.current;if("hidden"===t.style.overflowY)return;const s=t.offsetWidth-t.clientWidth;(0,Ot.RK)(()=>{t.style.overflowY="hidden",t.style.paddingRight=`${s}px`})})}),releaseTransitionFix:(0,_t.A)(()=>{const t=e.current;t.style.overflowY="scroll",t.style.paddingRight="0"})}}(Fe),[Ft,Tt]=(()=>{const[e,t]=(0,Yt.J0)(0);return[e,(0,Yt.hb)(()=>{t(e=>e+1)},[])]})(),{observe:xt}=(0,Jo.BL)({rootRef:Fe,throttleMs:500}),Ut=(0,_t.A)(()=>{kt(),Tt()}),Bt=(0,_t.A)(()=>{fe({newChatMembersProgress:i.D7.InProgress})});(0,Yt.vJ)(()=>{de({mediaType:tt})},[de,tt,o]);const Rt=(0,_t.A)(e=>{me({chatId:Le,threadId:n.l3,messageId:e,origin:i.TQ.SharedMedia})}),Nt=(0,_t.A)(e=>{me({standaloneMedia:E?.flatMap(e=>e?.content.photo||e?.content.video).filter(Boolean),origin:i.TQ.PreviewMedia,mediaIndex:e})}),Jt=(0,_t.A)(e=>{pe({chatId:Le,messageId:e})}),Et=(0,_t.A)(e=>{ue({id:e})}),Lt=(0,_t.A)(e=>{ge({chatId:e.chatId,messageId:e.id})}),Dt=(0,_t.A)(()=>{Re(void 0)});(0,fa.A)(e=>{let[t]=e;if(void 0===t||0===Ke||t===x)return;const s=Ke+(x?1:-1);We(Math.min(s,Ge.length-1))},[x,Ke,Ge]);const Vt=(0,_t.A)(()=>{Me({peerId:t})});let jt;(0,Yt.vJ)(()=>{if(Te.current&&d.TF)return(0,Es.wJ)(Te.current,{selectorToPreventScroll:".Profile",onSwipe:(e,t)=>t===Es.ez.Left?(We(Math.min(et+1,Ge.length-1)),!0):t===Es.ez.Right&&(We(Math.max(0,et-1)),!0)})},[et,Ge.length]),mt?jt=K?0:1e3:(!ct&&!E||!R?.length&&"gifts"===dt)&&(jt=a.jhd);const qt=(0,Yn.A)([t,o,dt,et,A,S],jt);const zt="stories"===dt||"gifts"===dt,Kt="stories"===dt?"all"===S?0:S:"gifts"===dt?"all"===A?0:A:0,Wt=(0,_t.A)(()=>{Oe(De+1)});function $t(e,s){const a=function(e,s){if(e){const e=Boolean("members"===dt&&L);return(0,ns.FD)("div",{className:"content empty-list",children:[!s&&!e&&(0,ns.Y)(sa.A,{}),e&&(0,ns.Y)(Zi.A,{text:Ue("ChatMemberListNoAccess")})]})}const a=ct&&!ct?.length;if(a&&"gifts"===dt)return(0,ns.FD)("div",{className:"nothing-found-gifts",children:[(0,ns.Y)(an.A,{size:160,tgsUrl:sn.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,ns.Y)("div",{className:"description",children:Ue("GiftSearchEmpty")}),(0,ns.Y)(Po.A,{className:"date",onClick:Vt,children:Ue("GiftSearchReset")})]});if(a){let e;switch(dt){case"members":e=Ue(L?"ChatMemberListNoAccess":"NoMembersFound");break;case"commonChats":e=xe("NoGroupsInCommon");break;case"documents":e=xe("lng_media_file_empty");break;case"links":e=xe("lng_media_link_empty");break;case"audio":e=xe("lng_media_song_empty");break;case"voice":e=xe("lng_media_audio_empty");break;case"stories":e=xe("StoryList.SavedEmptyState.Title");break;case"storiesArchive":e=xe("StoryList.ArchivedEmptyState.Title");break;default:e=xe("SharedMedia.EmptyTitle")}return(0,ns.Y)("div",{className:"content empty-list",children:(0,ns.Y)(Zi.A,{text:e})})}if(!p)return;const o="gifts"===dt?gt:"stories"===dt&&vt;return(0,ns.Y)("div",{className:(0,Gt.A)(`content ${dt}-list`,At&&"showContentPanel",o&&"noTransition"),dir:xe.isRtl&&"media"===dt?"rtl":void 0,teactFastList:!0,children:"media"===dt?ct.map(e=>p[e]&&(0,ns.Y)(Qi.A,{message:p[e],isProtected:_||p[e].isProtected,observeIntersection:xt,onClick:Rt},e)):"stories"===dt||"storiesArchive"===dt?ct.map((e,t)=>b?.[e]&&(0,ns.Y)(rr,{teactOrderKey:t,story:b[e],isArchive:"storiesArchive"===dt},`${dt}_${e}`)):"documents"===dt?ct.map(e=>p[e]&&(0,ns.Y)(ji.A,{document:(0,y.zC)(p[e]),withDate:!0,smaller:!0,className:"scroll-item",isDownloading:(0,y.$r)(H,(0,y.zC)(p[e])),observeIntersection:xt,onDateClick:Lt,message:p[e],shouldWarnAboutFiles:Q},e)):"links"===dt?ct.map(e=>p[e]&&(0,ns.Y)(or.A,{message:p[e],isProtected:_||p[e].isProtected,observeIntersection:xt,onMessageClick:Lt},e)):"audio"===dt?ct.map(e=>p[e]&&(0,ns.Y)(Vi.Ay,{theme:c,message:p[e],origin:i.d9.SharedMedia,date:p[e].date,className:"scroll-item",onPlay:Jt,onDateClick:Lt,canDownload:!_&&!p[e].isProtected,isDownloading:(0,y.$r)(H,p[e].content.audio)},e)):"voice"===dt?ct.map(e=>{const t=(0,w.mS)(),s=p[e];if(!s)return;const a=(0,ut.iS)(t,s);return p[e]&&(0,ns.Y)(Vi.Ay,{theme:c,message:s,senderTitle:(0,Ri.N)(xe,s,z,j),origin:i.d9.SharedMedia,date:s.date,className:"scroll-item",onPlay:Jt,onDateClick:Lt,canDownload:!_&&!s.isProtected,isDownloading:(0,y.$r)(H,a)},e)}):"members"===dt?ct.map((e,t)=>{return(0,ns.Y)(cr.A,{teactOrderKey:t,className:"chat-item-clickable contact-list-item scroll-item small-icon",onClick:()=>Et(e),contextActions:(s=e,s!==m&&D?[{title:xe("lng_context_remove_from_group"),icon:"stop",handler:()=>{Re(s)}}]:void 0),children:(0,ns.Y)(pn.A,{userId:e,adminMember:V?.[e],forceShowSelf:!0,withStory:!0})},e);var s}):"commonChats"===dt?ct.map((e,t)=>(0,ns.Y)(cr.A,{teactOrderKey:t,className:"chat-item-clickable scroll-item small-icon",onClick:()=>ue({id:e}),children:(0,ns.Y)(mn.A,{chatId:e})},e)):"previewMedia"===dt?E.map((e,t)=>(0,ns.Y)(tr,{media:e,isProtected:_,observeIntersection:xt,onClick:Nt,index:t},e.date)):"similarChannels"===dt?(0,ns.FD)("div",{children:[ct.map((e,t)=>(0,ns.Y)(cr.A,{teactOrderKey:t,className:(0,Gt.A)("chat-item-clickable search-result",!te&&t===Z.length-1&&"blured"),onClick:()=>ue({id:e}),children:(0,ns.Y)(mn.A,{avatarSize:"large",chatId:e,withFullInfo:!0})},e)),!te&&(0,ns.FD)(ns.FK,{children:[(0,ns.FD)(xs.A,{className:"show-more-channels",onClick:()=>be(),children:[xe("UnlockSimilar"),(0,ns.Y)(Us.A,{name:"unlock-badge"})]}),(0,ns.Y)("div",{className:"more-similar",children:(0,wo.A)(xe("MoreSimilarText",se),["simple_markdown"])})]})]},dt):"similarBots"===dt?(0,ns.FD)("div",{children:[ct.map((e,t)=>(0,ns.Y)(cr.A,{teactOrderKey:t,className:(0,Gt.A)("chat-item-clickable search-result",!te&&t===ee.length-1&&"blured"),onClick:()=>ue({id:e}),children:(0,k.L8)(e)?(0,ns.Y)(pn.A,{userId:e,avatarSize:"medium"}):(0,ns.Y)(mn.A,{chatId:e,avatarSize:"medium"})},e)),!te&&(0,ns.FD)(ns.FK,{children:[(0,ns.FD)(xs.A,{className:"show-more-bots",onClick:()=>be(),children:[Ue("UnlockMoreSimilarBots"),(0,ns.Y)(Us.A,{name:"unlock-badge"})]}),(0,ns.Y)("div",{className:"more-similar",children:(0,wo.A)(Ue("MoreSimilarBotsDescription",{count:se},{withNodes:!0,withMarkdown:!0,pluralValue:se}))})]})]},dt):"gifts"===dt?_e?.map(e=>(0,ns.Y)(Xi,{peerId:t,style:Qe?`view-transition-name: vt${(0,Bi.p)(e)}`:void 0,gift:e,observeIntersection:xt},(0,Bi.p)(e))):void 0})}(e,s),o=e&&!s;return zt?(0,ns.Y)(Ms.Ay,{className:`${dt}-list`,activeKey:Kt,name:(0,vs.P)("slideOptimized",X,void 0,xe.isRtl),shouldCleanup:!0,shouldRestoreHeight:!0,restoreHeightKey:De,contentSelector:".Transition > .Transition_slide-active > .content",children:(0,ns.Y)(Ms.Ay,{activeKey:o?0:1,name:"fade",shouldCleanup:!0,shouldRestoreHeight:!0,restoreHeightKey:De,contentSelector:".content",onStop:Wt,children:a})}):(0,ns.Y)(Ms.Ay,{activeKey:o?0:1,name:"fade",shouldCleanup:!0,shouldRestoreHeight:!0,children:a})}const Xt=".shared-media-transition > .Transition_slide-active",Qt=zt?`${Xt} > .Transition > .Transition_slide-active > .Transition > .Transition_slide-active > .gifts-list > .scroll-item`:`${Xt} .${dt}-list > .scroll-item`;return(0,ns.FD)(dr.A,{ref:Fe,className:"Profile custom-scroll",itemSelector:Qt,items:qt?ct:void 0,cacheBuster:Ft,sensitiveArea:a.ZhW,preloadBackwards:qt?"members"===dt?a.nnT:a.Um:0,noScrollRestoreOnTop:!0,noFastList:!0,onLoadMore:lt,onScroll:Ct,children:[!ht&&!Ye&&vr(l?.id||Le,K&&qt,oe,Boolean(l)),!W&&(0,ns.FD)("div",{className:"shared-media",children:[(0,ns.Y)(Ms.Ay,{ref:Te,name:(0,vs.P)("slideOptimized",X,void 0,xe.isRtl),activeKey:pt,renderCount:Ge.length,shouldRestoreHeight:!0,className:"shared-media-transition",onStart:Pt,onStop:Ut,restoreHeightKey:zt?De:void 0,contentSelector:zt?".Transition > .Transition_slide-active > .Transition > .Transition_slide-active > .content":void 0,children:function(){if("dialogs"===dt)return(0,ns.Y)(js.A,{className:"saved-dialogs",folderType:"saved",isActive:!0});const e=!ct&&!E||!qt||!p,s=mt&&!qt;return(0,ns.FD)("div",{children:["gifts"===dt?(0,ns.Y)("div",{className:(0,Gt.A)("contentCategoriesPanel",!At&&"hiddenPanel",gt&&"noTransition"),children:(0,ns.Y)(gr,{peerId:t})}):"stories"===dt?(0,ns.Y)("div",{className:(0,Gt.A)("contentCategoriesPanel",!At&&"hiddenPanel",vt&&"noTransition"),children:(0,ns.Y)(fr,{peerId:t})}):void 0,$t(e,s)]})}()}),(0,ns.Y)(Vs.A,{activeTab:et,tabs:Ge,onSwitchTab:He})]}),Y&&(0,ns.Y)(Mi.A,{className:(0,Gt.A)(!s&&"hidden"),isShown:qt,onClick:Bt,ariaLabel:xe("lng_channel_add_users"),children:(0,ns.Y)(Us.A,{name:"add-user-filled"})}),D&&(0,ns.Y)(lr.A,{isOpen:Boolean(Be),userId:Be,onClose:Dt})]})})),yr=450+a.xB5;var Sr=function(e){return e[e.Profile=0]="Profile",e[e.MemberList=1]="MemberList",e[e.GiftList=2]="GiftList",e[e.SharedMedia=3]="SharedMedia",e[e.StoryList=4]="StoryList",e[e.Search=5]="Search",e[e.Statistics=6]="Statistics",e[e.MessageStatistics=7]="MessageStatistics",e[e.StoryStatistics=8]="StoryStatistics",e[e.BoostStatistics=9]="BoostStatistics",e[e.MonetizationStatistics=10]="MonetizationStatistics",e[e.Management=11]="Management",e[e.ManageInitial=12]="ManageInitial",e[e.ManageChannelSubscribers=13]="ManageChannelSubscribers",e[e.ManageChatAdministrators=14]="ManageChatAdministrators",e[e.ManageChatPrivacyType=15]="ManageChatPrivacyType",e[e.ManageDiscussion=16]="ManageDiscussion",e[e.ManageGroupPermissions=17]="ManageGroupPermissions",e[e.ManageGroupRemovedUsers=18]="ManageGroupRemovedUsers",e[e.ManageChannelRemovedUsers=19]="ManageChannelRemovedUsers",e[e.ManageGroupUserPermissionsCreate=20]="ManageGroupUserPermissionsCreate",e[e.ManageGroupUserPermissions=21]="ManageGroupUserPermissions",e[e.ManageGroupRecentActions=22]="ManageGroupRecentActions",e[e.ManageGroupAdminRights=23]="ManageGroupAdminRights",e[e.ManageGroupNewAdminRights=24]="ManageGroupNewAdminRights",e[e.ManageGroupMembers=25]="ManageGroupMembers",e[e.ManageGroupAddAdmins=26]="ManageGroupAddAdmins",e[e.StickerSearch=27]="StickerSearch",e[e.GifSearch=28]="GifSearch",e[e.PollResults=29]="PollResults",e[e.AddingMembers=30]="AddingMembers",e[e.ManageInvites=31]="ManageInvites",e[e.ManageEditInvite=32]="ManageEditInvite",e[e.ManageReactions=33]="ManageReactions",e[e.ManageInviteInfo=34]="ManageInviteInfo",e[e.ManageJoinRequests=35]="ManageJoinRequests",e[e.CreateTopic=36]="CreateTopic",e[e.EditTopic=37]="EditTopic",e[e.SavedDialogs=38]="SavedDialogs",e[e.NewDiscussionGroup=39]="NewDiscussionGroup",e}(Sr||{});const wr=(0,w.EK)((e,t)=>{let{chatId:s,isProfile:a,isManagement:o,threadId:i}=t;const r=(0,C.nTw)(e),{query:d}=(0,C.BmE)(e)||{},{query:c}=(0,C.Wy7)(e)||{},l=s?(0,C.hds)(e,s):void 0,u=a&&s&&(0,k.L8)(s)?(0,C.mBe)(e,s):void 0,h=l&&(0,y.WX)(l),m=l?.isForum&&Boolean(i&&i!==n.l3),p=m?(0,C.S0q)(e,s,i):void 0,g=m&&p&&(0,y.l1)(l,p),f=u&&(0,y.tv)(u),I=s?(0,C.nZ4)(e,s):void 0,v=f&&u?.canEditBot,b=u&&(0,y.Gh)(u),S=Boolean(!o&&a&&s&&(0,C.e5V)(e,s)),w=Boolean(s&&r.management.byChatId[s]?.editingInvite),A=!m&&s?(0,C.AWZ)(e,s)?.canViewStatistics:void 0,M=s?r.management.byChatId[s]?.inviteInfo?.invite:void 0,P=r.savedGifts.filter,F=!!s&&(0,C.rtZ)(e,s),T=!!s&&(0,C.ERc)(e,s);return{canManage:S,canAddContact:b,canViewStatistics:A,isChannel:h,isBot:f,isInsideTopic:m,canEditTopic:g,userId:u?.id,isSelf:u?.isSelf,stickerSearchQuery:d,gifSearchQuery:c,isEditingInvite:w,currentInviteInfo:M,isSavedMessages:I,shouldSkipHistoryAnimations:r.shouldSkipHistoryAnimations,canEditBot:v,giftProfileFilter:P,canUseGiftFilter:F,canUseGiftAdminFilter:T}})(e=>{let{chatId:t,threadId:s,isColumnOpen:o,isProfile:n,isManagement:r,isStatistics:c,isMessageStatistics:l,isStoryStatistics:u,isMonetizationStatistics:h,isBoostStatistics:m,isStickerSearch:p,isGifSearch:g,isPollResults:f,isCreatingTopic:I,isEditingTopic:v,isAddingChatMembers:b,profileState:y,managementScreen:S,canAddContact:A,userId:M,isSelf:C,canManage:P,isChannel:k,stickerSearchQuery:F,gifSearchQuery:T,isEditingInvite:x,canViewStatistics:U,currentInviteInfo:B,shouldSkipHistoryAnimations:R,isBot:N,isInsideTopic:J,canEditTopic:E,isSavedMessages:L,canEditBot:Y,giftProfileFilter:O,canUseGiftFilter:G,canUseGiftAdminFilter:V,onClose:j,onScreenSelect:q}=e;const{setStickerSearchQuery:z,setGifSearchQuery:K,toggleManagement:W,openAddContactDialog:H,toggleStatistics:_,setEditingExportedInvite:$,deleteExportedChatInvite:X,openEditTopicPanel:Q,updateGiftProfileFilter:Z}=(0,w.ko)(),[ee,te,se]=(0,_s.A)(),{isMobile:ae}=(0,D.Ay)(),{sortType:oe,shouldIncludeUnlimited:ne,shouldIncludeLimited:ie,shouldIncludeUpgradable:re,shouldIncludeUnique:de,shouldIncludeDisplayed:ce,shouldIncludeHidden:le}=O,ue=(0,gs.g5)(),he=(0,_t.A)(()=>{$({chatId:t,invite:B}),q(i.je.EditInvite)}),me=(0,_t.A)(()=>{X({chatId:t,link:B.link}),q(i.je.Invites),se()}),pe=(0,_t.A)(e=>{z({query:e})}),ge=(0,_t.A)(e=>{K({query:e})}),fe=(0,_t.A)(()=>{H({userId:M})}),Ie=(0,_t.A)(()=>{t&&s&&Q({chatId:t,topicId:Number(s)})}),ve=(0,_t.A)(()=>{W()}),be=(0,_t.A)(()=>{_()}),ye=(0,_t.A)(()=>{j(!L)}),[Se,we]=(0,Yt.J0)(!o);(0,Yt.vJ)(()=>{setTimeout(()=>{we(!o)},yr)},[o]);const Ae=(0,Fs.A)(),Me=(0,Ht.A)(),Ce=n?y===i.zW.Profile?Sr.Profile:y===i.zW.SharedMedia?Sr.SharedMedia:y===i.zW.MemberList?Sr.MemberList:y===i.zW.GiftList?Sr.GiftList:y===i.zW.StoryList?Sr.StoryList:y===i.zW.SavedDialogs?Sr.SavedDialogs:-1:f?Sr.PollResults:p?Sr.StickerSearch:g?Sr.GifSearch:b?Sr.AddingMembers:r?S===i.je.Initial?Sr.ManageInitial:S===i.je.ChatPrivacyType?Sr.ManageChatPrivacyType:S===i.je.Discussion?Sr.ManageDiscussion:S===i.je.ChannelSubscribers?Sr.ManageChannelSubscribers:S===i.je.GroupPermissions?Sr.ManageGroupPermissions:S===i.je.ChatAdministrators?Sr.ManageChatAdministrators:S===i.je.GroupRemovedUsers?Sr.ManageGroupRemovedUsers:S===i.je.ChannelRemovedUsers?Sr.ManageChannelRemovedUsers:S===i.je.GroupUserPermissionsCreate?Sr.ManageGroupUserPermissionsCreate:S===i.je.GroupUserPermissions?Sr.ManageGroupUserPermissions:S===i.je.GroupRecentActions?Sr.ManageGroupRecentActions:S===i.je.ChatAdminRights?Sr.ManageGroupAdminRights:S===i.je.ChatNewAdminRights?Sr.ManageGroupNewAdminRights:S===i.je.GroupMembers?Sr.ManageGroupMembers:S===i.je.Invites?Sr.ManageInvites:S===i.je.EditInvite?Sr.ManageEditInvite:S===i.je.GroupAddAdmins?Sr.ManageGroupAddAdmins:S===i.je.Reactions?Sr.ManageReactions:S===i.je.InviteInfo?Sr.ManageInviteInfo:S===i.je.JoinRequests?Sr.ManageJoinRequests:S===i.je.NewDiscussionGroup?Sr.NewDiscussionGroup:void 0:c?Sr.Statistics:l?Sr.MessageStatistics:u?Sr.StoryStatistics:m?Sr.BoostStatistics:I?Sr.CreateTopic:v?Sr.EditTopic:h?Sr.MonetizationStatistics:void 0,Pe=(0,yn.A)(Ce,!0)??-1,ke=(0,Yt.Kr)(()=>e=>{let{onTrigger:t,isOpen:s}=e;return(0,ns.Y)(xs.A,{round:!0,ripple:!ae,size:"smaller",color:"translucent",className:s?"active":"",onClick:t,ariaLabel:Me("AccDescrOpenMenu2"),children:(0,ns.Y)(Us.A,{name:"more"})})},[ae,Me]),Fe=ae||!L&&(Ce===Sr.SharedMedia||Ce===Sr.GiftList||Ce===Sr.MemberList||Ce===Sr.StoryList||Ce===Sr.AddingMembers||Ce===Sr.MessageStatistics||Ce===Sr.StoryStatistics||r),Te=(0,Gt.A)("animated-close-icon",Fe&&"state-back",(Se||R)&&"no-transition");return(0,ns.FD)("div",{className:"RightHeader","data-tauri-drag-region":!(!gt.Vq||!d.MP)||void 0,children:[(0,ns.Y)(xs.A,{className:"close-button",round:!0,color:"translucent",size:"smaller",onClick:ye,ariaLabel:Ae(Fe?"Common.Back":"Common.Close"),children:(0,ns.Y)("div",{className:Te})}),(0,ns.Y)(Ms.Ay,{name:Se||R?"none":"slideFade",activeKey:Pe,children:function(){if(-1!==Pe)switch(Pe){case Sr.PollResults:return(0,ns.Y)("h3",{className:"title",children:Ae("PollResults")});case Sr.AddingMembers:return(0,ns.Y)("h3",{className:"title",children:Ae(k?"ChannelAddSubscribers":"GroupAddMembers")});case Sr.ManageInitial:return(0,ns.Y)("h3",{className:"title",children:Ae("Edit")});case Sr.ManageChatPrivacyType:return(0,ns.Y)("h3",{className:"title",children:Ae(k?"ChannelTypeHeader":"GroupTypeHeader")});case Sr.ManageDiscussion:return(0,ns.Y)("h3",{className:"title",children:Ae("Discussion")});case Sr.ManageChatAdministrators:return(0,ns.Y)("h3",{className:"title",children:Ae("ChannelAdministrators")});case Sr.ManageGroupRecentActions:return(0,ns.Y)("h3",{className:"title",children:Ae("Group.Info.AdminLog")});case Sr.ManageGroupAdminRights:return(0,ns.Y)("h3",{className:"title",children:Ae("EditAdminRights")});case Sr.ManageGroupNewAdminRights:return(0,ns.Y)("h3",{className:"title",children:Ae("SetAsAdmin")});case Sr.ManageGroupPermissions:return(0,ns.Y)("h3",{className:"title",children:Ae("ChannelPermissions")});case Sr.ManageGroupRemovedUsers:return(0,ns.Y)("h3",{className:"title",children:Ae("BlockedUsers")});case Sr.ManageChannelRemovedUsers:return(0,ns.Y)("h3",{className:"title",children:Ae("ChannelBlockedUsers")});case Sr.ManageGroupUserPermissionsCreate:return(0,ns.Y)("h3",{className:"title",children:Ae("ChannelAddException")});case Sr.ManageGroupUserPermissions:return(0,ns.Y)("h3",{className:"title",children:Ae("UserRestrictions")});case Sr.ManageInvites:return(0,ns.Y)("h3",{className:"title",children:Ae("lng_group_invite_title")});case Sr.ManageEditInvite:return(0,ns.Y)("h3",{className:"title",children:Ae(x?"EditLink":"NewLink")});case Sr.ManageInviteInfo:return(0,ns.FD)(ns.FK,{children:[(0,ns.Y)("h3",{className:"title",children:Ae("InviteLink")}),(0,ns.FD)("section",{className:"tools",children:[B&&!B.isRevoked&&(0,ns.Y)(xs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ae("Edit"),onClick:he,children:(0,ns.Y)(Us.A,{name:"edit"})}),B&&B.isRevoked&&(0,ns.FD)(ns.FK,{children:[(0,ns.Y)(xs.A,{round:!0,color:"danger",size:"smaller",ariaLabel:Ae("Delete"),onClick:te,children:(0,ns.Y)(Us.A,{name:"delete"})}),(0,ns.Y)(Vn.A,{isOpen:ee,onClose:se,title:Ae("DeleteLink"),text:Ae("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:Ae("Delete"),confirmHandler:me})]})]})]});case Sr.ManageJoinRequests:return(0,ns.Y)("h3",{className:"title",children:Ae(k?"SubscribeRequests":"MemberRequests")});case Sr.ManageGroupAddAdmins:return(0,ns.Y)("h3",{className:"title",children:Ae("Channel.Management.AddModerator")});case Sr.StickerSearch:return(0,ns.Y)(ea.A,{value:F,placeholder:Ae("SearchStickersHint"),autoFocusSearch:!0,onChange:pe});case Sr.GifSearch:return(0,ns.Y)(ea.A,{value:T,placeholder:Ae("SearchGifsTitle"),autoFocusSearch:!0,onChange:ge});case Sr.Statistics:return(0,ns.Y)("h3",{className:"title",children:Ae(k?"ChannelStats.Title":"GroupStats.Title")});case Sr.MessageStatistics:return(0,ns.Y)("h3",{className:"title",children:Ae("Stats.MessageTitle")});case Sr.StoryStatistics:return(0,ns.Y)("h3",{className:"title",children:Ae("Stats.StoryTitle")});case Sr.BoostStatistics:return(0,ns.Y)("h3",{className:"title",children:Ae("Boosts")});case Sr.MonetizationStatistics:return(0,ns.Y)("h3",{className:"title",children:Ae("lng_channel_earn_title")});case Sr.SharedMedia:return(0,ns.Y)("h3",{className:"title",children:Ae("SharedMedia")});case Sr.ManageChannelSubscribers:return(0,ns.Y)("h3",{className:"title",children:Ae("ChannelSubscribers")});case Sr.MemberList:case Sr.ManageGroupMembers:return(0,ns.Y)("h3",{className:"title",children:Ae("GroupMembers")});case Sr.StoryList:return(0,ns.Y)("h3",{className:"title",children:Ae(C?"Settings.MyStories":"PeerInfo.PaneStories")});case Sr.SavedDialogs:return(0,ns.FD)("div",{className:"header",children:[(0,ns.Y)("h3",{className:"title",children:Ae("SavedMessagesTab")}),(0,ns.Y)("div",{className:"subtitle",children:Ae("Chats",ue[a.pX9])})]});case Sr.ManageReactions:return(0,ns.Y)("h3",{className:"title",children:Ae("Reactions")});case Sr.CreateTopic:return(0,ns.Y)("h3",{className:"title",children:Ae("NewTopic")});case Sr.EditTopic:return(0,ns.Y)("h3",{className:"title",children:Ae("EditTopic")});case Sr.GiftList:return(0,ns.FD)(ns.FK,{children:[(0,ns.Y)("h3",{className:"title",children:Me("ProfileTabGifts")}),G&&t&&(0,ns.Y)("section",{className:"tools",children:(0,ns.FD)(Zs.A,{trigger:ke,positionX:"right",autoClose:!1,children:[(0,ns.Y)(Rs.A,{icon:"byDate"===oe?"cash-circle":"calendar-filter",onClick:()=>Z({peerId:t,filter:{sortType:"byDate"===oe?"byValue":"byDate"}}),children:Me("byDate"===oe?"GiftSortByValue":"GiftSortByDate")}),(0,ns.Y)(ra.A,{}),(0,ns.Y)(Rs.A,{icon:ne?"check":"placeholder",onClick:()=>Z({peerId:t,filter:{shouldIncludeUnlimited:!ne}}),children:Me("GiftFilterUnlimited")}),(0,ns.Y)(Rs.A,{icon:ie?"check":"placeholder",onClick:()=>Z({peerId:t,filter:{shouldIncludeLimited:!ie}}),children:Me("GiftFilterLimited")}),(0,ns.Y)(Rs.A,{icon:re?"check":"placeholder",onClick:()=>Z({peerId:t,filter:{shouldIncludeUpgradable:!re}}),children:Me("GiftFilterUpgradable")}),(0,ns.Y)(Rs.A,{icon:de?"check":"placeholder",onClick:()=>Z({peerId:t,filter:{shouldIncludeUnique:!de}}),children:Me("GiftFilterUnique")}),V&&(0,ns.FD)(ns.FK,{children:[(0,ns.Y)(ra.A,{}),(0,ns.Y)(Rs.A,{icon:ce?"check":"placeholder",onClick:()=>Z({peerId:t,filter:{shouldIncludeDisplayed:!ce}}),children:Me("GiftFilterDisplayed")}),(0,ns.Y)(Rs.A,{icon:le?"check":"placeholder",onClick:()=>Z({peerId:t,filter:{shouldIncludeHidden:!le}}),children:Me("GiftFilterHidden")})]})]})})]});case Sr.NewDiscussionGroup:return(0,ns.Y)("h3",{className:"title",children:Ae("NewGroup")});default:return(0,ns.FD)(ns.FK,{children:[(0,ns.Y)("h3",{className:"title",children:Ae(L?"SavedMessages":J?"AccDescrTopic":k?"Channel.TitleInfo":M?N?"lng_info_bot_title":"lng_info_user_title":"GroupInfo.Title")}),(0,ns.FD)("section",{className:"tools",children:[A&&(0,ns.Y)(xs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ae("AddContact"),onClick:fe,children:(0,ns.Y)(Us.A,{name:"add-user"})}),P&&!J&&(0,ns.Y)(xs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ae("Edit"),onClick:ve,children:(0,ns.Y)(Us.A,{name:"edit"})}),Y&&(0,ns.Y)(xs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ae("Edit"),onClick:ve,children:(0,ns.Y)(Us.A,{name:"edit"})}),E&&(0,ns.Y)(xs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ae("EditTopic"),onClick:Ie,children:(0,ns.Y)(Us.A,{name:"edit"})}),U&&(0,ns.Y)(xs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ae("Statistics"),onClick:be,children:(0,ns.Y)(Us.A,{name:"stats"})})]})]})}}()})]})});var Ar=s(55317),Mr=s(47058),Cr=s(20333),Pr=s(71950);const kr={root:"gk6pIryJ",noResults:"WP4wRUbm","section-header":"LWcgK3OX",sectionHeader:"LWcgK3OX",section:"C8KF95yU",user:"oMy5KOFr",stats:"GOzrl0zF",down:"QuLtxDUV",loadMoreSpinner:"ln5zB7KK",status:"r3zLiaXx",info:"Eo1qQlxx",month:"McSPvm0N",quantity:"s1yf_GJa",floatingBadge:"oSCjRZtx",floatingBadgeButtonColor:"duVpAT_e",floatingBadgeWarning:"DsJMXNNk",floatingBadgeButton:"urrWJVYB",floatingBadgeIcon:"hcA9VPeV",floatingBadgeValue:"hHkCO4Ge",content:"SG00REIA",boostSection:"ETgjBS4d",giveawayButton:"wOCtp5Kk",giveawayIcon:"B9GF4NDB",primaryLink:"GXmXwIbx",copy:"rB0gc1GX",boostInfo:"BhoA3MT6"};var Fr=s(72078),Tr=s(68153),xr=s(65741),Ur=s(45318);const Br={3:Tr,6:Fr,12:xr},Rr={isCustomPeer:!0,avatarIcon:"star",peerColorId:1},Nr={isCustomPeer:!0,titleKey:"BoostingToBeDistributed",avatarIcon:"user",withPremiumGradient:!0},Jr=(0,Yt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e).boostStatistics,s=(0,C.hc)(e),a=t&&t.chatId,o=a?(0,C.hds)(e,a):void 0,n=o&&(0,y.WX)(o),i=e.appConfig.giveawayBoostsPerPremium,{animationLevel:r}=(0,je.l)(e);return{boostStatistics:t,isGiveawayAvailable:s,chatId:a,giveawayBoostsPerPremium:i,isChannel:n,animationLevel:r}})(e=>{let{boostStatistics:t,isGiveawayAvailable:s,chatId:o,giveawayBoostsPerPremium:n,isChannel:i,animationLevel:r}=e;const{openChat:d,loadMoreBoosters:c,closeBoostStatistics:l,openGiveawayModal:u,showNotification:h}=(0,w.ko)(),m=(0,Fs.A)(),p=(0,Yt.li)(),g=t?.boostStatus,f=g?t.boostStatus:void 0,I=!(t&&t?.boosts?.count===t?.giftedBoosts?.count)&&t?.giftedBoosts&&t?.giftedBoosts?.list?.length>0,{currentLevel:v,hasNextLevel:b,boosts:y,levelProgress:S,remainingBoosts:A}=(0,Yt.Kr)(()=>f?(0,Ar.z)(f):{currentLevel:0,hasNextLevel:!1,boosts:0,levelProgress:0,remainingBoosts:0,prepaidGiveaways:[]},[f]),M=(0,Yt.Kr)(()=>{if(f)return{level:v,boosts:y,premiumSubscribers:f.premiumSubscribers,remainingBoosts:A,prepaidGiveaways:f.prepaidGiveaways}},[f,y,v,A]),C=(0,Yt.Kr)(()=>I?[{type:"boostList",title:m("BoostingBoostsCount",t?.boosts?.count,"i")},{type:"giftedBoostList",title:m("BoostingGiftsCount",t?.giftedBoosts?.count,"i")}]:[],[I,m,t?.boosts?.count,t?.giftedBoosts?.count]),P=(0,Yt.Kr)(()=>t?.boosts&&t.boosts?.list.length>0?1:0,[t]),[k,F]=(0,Yt.J0)(P),T=k>C.length-1?C.length-1:k,x=C[T]?.type,U=C.findIndex(e=>{let{type:t}=e;return t===x}),B=(0,Yt.Kr)(()=>{if(!t)return;const e=I?"boostList"===x?t.boosts:t.giftedBoosts:t.boosts;if(!e?.count)return;const s=e.list.reduce((e,t)=>e+(t.multiplier||1),0),a=e.count-s;return a>0?a:void 0},[I,t,x]),R=(0,_t.A)(e=>(0,ns.Y)("div",{className:kr.quantity,children:(0,ns.FD)("div",{className:(0,Gt.A)(kr.floatingBadge,kr.floatingBadgeButtonColor),children:[(0,ns.Y)(Us.A,{name:"boost",className:kr.floatingBadgeIcon}),(0,ns.Y)("div",{className:kr.floatingBadgeValue,children:e})]})})),N=(0,_t.A)(e=>{if(e.isFromGiveaway||e.isGift)return(0,ns.Y)("div",{className:kr.quantity,children:(0,ns.FD)("div",{className:(0,Gt.A)(kr.floatingBadge,!e.isFromGiveaway&&kr.floatingBadgeWarning,kr.floatingBadgeButtonColor,kr.floatingBadgeButton),children:[(0,ns.Y)(Us.A,{name:"gift",className:kr.floatingBadgeIcon}),(0,ns.Y)("div",{className:kr.floatingBadgeValue,children:m(e.isFromGiveaway?"BoostingGiveaway":"BoostingGift")})]})})}),J=(0,_t.A)(e=>{e?(d({id:e}),l()):h({message:m("BoostingRecipientWillBeSelected")})}),E=(0,_t.A)(e=>{let t;return Boolean(e?.stars)&&(t={...Rr,title:m("Stars",e.stars)}),e.userId||(t=Nr),(0,ns.Y)(cr.A,{className:(0,Gt.A)(kr.boostInfo,"chat-item-clickable"),onClick:()=>J(e.userId),children:(0,ns.Y)(pn.A,{className:kr.user,userId:e.userId,customPeer:t,status:m("BoostExpireOn",(0,Se.U)(m,1e3*e.expires)),noEmojiStatus:!0,forceShowSelf:!0,noFake:!0,noVerified:!0,iconElement:e.multiplier?R(e.multiplier):void 0,rightElement:N(e)})})}),L=(0,_t.A)(()=>{u({chatId:o})}),Y=(0,_t.A)(e=>{e.preventDefault(),c({isGifts:"giftedBoostList"===x})}),D=(0,_t.A)(e=>{u({chatId:o,prepaidGiveaway:e})});return(0,ns.FD)("div",{className:(0,Gt.A)(kr.root,"panel-content custom-scroll"),children:[!g&&(0,ns.Y)(Cs.A,{}),g&&M&&(0,ns.FD)(ns.FK,{children:[(0,ns.FD)("div",{className:kr.section,children:[(0,ns.Y)(Cr.A,{leftText:m("BoostsLevel",v),rightText:b?m("BoostsLevel",v+1):void 0,progress:S,floatingBadgeText:(0,ps.Sm)(y),floatingBadgeIcon:"boost"}),(0,ns.Y)(Pr.A,{className:kr.stats,statistics:M,type:"boost"})]}),M.prepaidGiveaways&&(0,ns.FD)("div",{className:kr.section,children:[(0,ns.Y)("h4",{className:kr.sectionHeader,dir:m.isRtl?"rtl":void 0,children:m("BoostingPreparedGiveaways")}),M?.prepaidGiveaways?.map(e=>{const t="stars"in e;return(0,ns.Y)(cr.A,{className:"chat-item-clickable",onClick:()=>D(e),children:(0,ns.FD)("div",{className:(0,Gt.A)(kr.status,"status-clickable"),children:[(0,ns.Y)("div",{children:t?(0,ns.Y)("img",{src:Ur,className:kr.giveawayIcon,alt:m("GiftStar")}):(0,ns.Y)("img",{src:Br[e.months]||Br[3],className:kr.giveawayIcon,alt:m("Giveaway")})}),(0,ns.FD)("div",{className:kr.info,children:[(0,ns.Y)("h3",{children:t?m("Giveaway.Stars.Prepaid.Title",e.stars):m("BoostingTelegramPremiumCountPlural",e.quantity)}),(0,ns.Y)("p",{className:kr.month,children:t?m("Giveaway.Stars.Prepaid.Desc",e.quantity):m("PrepaidGiveawayMonths",e.months)})]}),(0,ns.Y)("div",{className:kr.quantity,children:(0,ns.FD)("div",{className:(0,Gt.A)(kr.floatingBadge,kr.floatingBadgeButtonColor,kr.floatingBadgeButton),children:[(0,ns.Y)(Us.A,{name:"boost",className:kr.floatingBadgeIcon}),(0,ns.Y)("div",{className:kr.floatingBadgeValue,dir:m.isRtl?"rtl":void 0,children:t?e.boosts:e.quantity*(n??a.CQG)})]})})]})},e.id)}),(0,ns.Y)("p",{className:"text-muted hint",children:m("BoostingSelectPaidGiveaway")},"links-hint")]}),(0,ns.FD)("div",{className:kr.section,children:[I?(0,ns.FD)("div",{className:(0,Gt.A)(kr.boostSection,kr.content),children:[(0,ns.Y)(Ms.Ay,{ref:p,name:(0,vs.P)("slideOptimized",r,void 0,m.isRtl),activeKey:U,renderCount:C.length,shouldRestoreHeight:!0,children:function(){let e;if("boostList"===x?e=t?.boosts?.list:"giftedBoostList"===x&&(e=t?.giftedBoosts?.list),!e||e?.length)return(0,ns.Y)("div",{className:kr.section,children:e?.map(e=>E(e))})}()}),(0,ns.Y)(Vs.A,{activeTab:T,tabs:C,onSwitchTab:F})]}):(0,ns.FD)(ns.FK,{children:[(0,ns.Y)("h4",{className:kr.sectionHeader,dir:m.isRtl?"rtl":void 0,children:m("BoostingBoostsCount",t?.boosts?.count)}),!t?.boosts?.list?.length&&(0,ns.Y)("div",{className:kr.noResults,children:m(i?"NoBoostersHint":"NoBoostersGroupHint")}),t?.boosts?.list?.map(e=>E(e))]}),Boolean(B)&&(0,ns.FD)(cr.A,{className:kr.showMore,disabled:t?.isLoadingBoosters,onClick:Y,children:[t?.isLoadingBoosters?(0,ns.Y)(sa.A,{className:kr.loadMoreSpinner}):(0,ns.Y)(Us.A,{name:"down",className:kr.down}),m("ShowVotes",B,"i")]},"load-more")]}),(0,ns.Y)(Mr.A,{className:kr.section,link:f.boostUrl,withShare:!0,title:m("LinkForBoosting")}),s&&(0,ns.FD)("div",{className:kr.section,children:[(0,ns.Y)(cr.A,{icon:"gift",onClick:L,className:kr.giveawayButton,children:m("BoostingGetBoostsViaGifts")},"load-more"),(0,ns.Y)("p",{className:"text-muted hint",children:m(i?"BoostingGetMoreBoosts":"BoostingGetMoreBoostsGroup")},"links-hint")]})]})]})})),Er=e=>{const t=(0,os.A)(qt.ar.Extra,"MessageStatistics");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})};var Lr=s(75319);const Yr=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"AboutMonetizationModal",!t);return s?(0,ns.Y)(s,{...e}):void 0};var Dr=s(84685);const Or={root:"vBPv6lUS",graph:"EbPbvB1I",hidden:"nsPIlLYL",ready:"s6qyDhkE",section:"cB2IkwY6",topText:"FLOpxZd1",availableReward:"emE6bAD8",rewardValue:"eyDAxGDU",decimalPart:"jkRV_L7b",integer:"xE9kfGi7",decimalUsdPart:"hWMnYdxX",toncoinIcon:"ubDl9CvS",textBottom:"P3qZJJzF"};let Gr,Vr;const jr={topHoursGraph:"ChannelStats.Graph.ViewsByHours",revenueGraph:"lng_channel_earn_chart_revenue"},qr=Object.keys(jr),zr=(0,Yt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{settings:{byKey:{hasPassword:s}}}=e,a=t.monetizationStatistics,o=a&&a.chatId,n=o?(0,C.hds)(e,o):void 0,i=(0,C.AWZ)(e,o)?.statisticsDcId,r=Boolean(n?.isCreator);return{chatId:o,dcId:i,statistics:t.statistics.monetization,isCreator:r,isChannelRevenueWithdrawalEnabled:e.appConfig.isChannelRevenueWithdrawalEnabled,hasPassword:s}})(e=>{let{chatId:t,dcId:a,statistics:o,isCreator:n,isChannelRevenueWithdrawalEnabled:i,hasPassword:r}=e;const{loadChannelMonetizationStatistics:d,openMonetizationVerificationModal:c,loadPasswordInfo:l}=(0,w.ko)(),u=(0,Fs.A)(),h=(0,Ht.A)(),m=(0,Yt.li)(),[p,g]=(0,Yt.J0)(!1),f=(0,Yt.li)(new Set),I=(0,Yt.li)(new Set),v=(0,Wt.A)(),[b,y,S]=(0,_s.A)(!1),[A,M,C]=(0,_s.A)(),P=o?.balances?.availableBalance,k=o?.balances?.isWithdrawalEnabled,F=n&&i&&Boolean(P)&&k;(0,Yt.vJ)(()=>{t&&(d({peerId:t}),l())},[t,d]),(0,Yt.vJ)(()=>{(async()=>{await async function(){return Gr||(Gr=s.e(4810).then(s.bind(s,24810)),Vr=await Gr),Gr}(),p?(m.current&&Array.from(m.current.children).forEach(e=>{e.innerHTML="",e.classList.add(Or.hidden)}),f.current.clear(),I.current.clear(),o&&m.current&&(qr.forEach((e,t)=>{const s=o[e];if(!(0,Lr.R)(s))return;const a="async"===s.graphType,n="error"===s.graphType;if(!a&&!f.current.has(e)){if(n)return f.current.add(e),void I.current.add(e);Vr.create(m.current.children[t],{title:u(jr[e]),...s}),f.current.add(e),m.current.children[t].classList.remove(Or.hidden)}}),v())):g(!0)})()},[p,o,u,t,a,v]);const T=(0,Yt.Kr)(()=>{const e=u("LearnMore");return h("ChannelEarnAbout",{link:(0,ns.FD)(Po.A,{isPrimary:!0,onClick:y,children:[e,(0,ns.Y)(Us.A,{name:"next"})]})},{withNodes:!0})},[h,u]),x=(0,Yt.Kr)(()=>{const e=u("LearnMore");return h("MonetizationBalanceZeroInfo",{link:(0,ns.FD)(Dr.A,{url:u("MonetizationProceedsInfoLink"),text:e,children:[e,(0,ns.Y)(Us.A,{name:"next"})]})},{withNodes:!0})},[h,u]),U=(0,_t.A)(()=>{r?c({chatId:t}):M()});return p&&o?(0,ns.FD)("div",{className:(0,Gt.A)(Or.root,"custom-scroll",p&&Or.ready),children:[(0,ns.Y)("div",{className:(0,Gt.A)(Or.section,Or.topText),children:T}),(0,ns.Y)(Pr.A,{statistics:o,isToncoin:!0,type:"monetization",title:u("MonetizationOverview"),subtitle:(0,ns.Y)("div",{className:Or.textBottom,children:u("MonetizationProceedsTONInfo")})}),!f.current.size&&(0,ns.Y)(Cs.A,{}),(0,ns.Y)("div",{ref:m,className:Or.section,children:qr.filter(Boolean).map(e=>(0,ns.Y)("div",{className:(0,Gt.A)(Or.graph,Or.hidden)},e))}),(0,ns.FD)("div",{className:Or.section,children:[u("lng_channel_earn_balance_title"),function(){const[e,t]=P?P.toFixed(4).split("."):[0],[s,a]=P&&o?.usdRate?(P*o.usdRate).toFixed(2).split("."):[0];return(0,ns.FD)("div",{className:Or.availableReward,children:[(0,ns.FD)("div",{className:Or.toncoin,children:[(0,ns.Y)(Us.A,{className:Or.toncoinIcon,name:"toncoin"}),(0,ns.FD)("b",{className:Or.rewardValue,children:[e,t?(0,ns.FD)("span",{className:Or.decimalPart,children:[".",t]}):void 0]})]})," ",(0,ns.FD)("span",{className:Or.integer,children:["≈ $",s,a?(0,ns.FD)("span",{className:Or.decimalUsdPart,children:[".",a]}):void 0]})]})}(),(0,ns.Y)(xs.A,{type:"button",onClick:U,disabled:!F,children:u("MonetizationWithdraw")}),(0,ns.Y)("div",{className:Or.textBottom,children:x})]}),(0,ns.Y)(Yr,{isOpen:b,onClose:S}),(0,ns.Y)(Vn.A,{isOnlyConfirm:!0,isOpen:A,onClose:C,confirmHandler:C,confirmLabel:h("OK"),children:(0,ns.Y)("p",{children:(0,wo.A)(u("Monetization.Withdraw.Error.Text"),["br"])})})]}):(0,ns.Y)(Cs.A,{})})),Kr=e=>{const t=(0,os.A)(qt.ar.Extra,"Statistics");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})},Wr=e=>{const t=(0,os.A)(qt.ar.Extra,"StoryStatistics");return t?(0,ns.Y)(t,{...e}):(0,ns.Y)(Cs.A,{})},Hr=()=>{const e=(0,os.A)(qt.ar.Extra,"StickerSearch");return e?(0,ns.Y)(e,{}):(0,ns.Y)(Cs.A,{})},_r=450+a.xB5,$r=Object.keys(i.Ul).length/2,Xr=Object.keys(i.je).length/2;function Qr(){const e=document.querySelector(".RightHeader .SearchInput input");e&&e.blur()}const Zr=(0,Yt.ph)((0,w.EK)((e,t)=>{let{isMobile:s}=t;const{chatId:a,threadId:o}=(0,C.Xf0)(e)||{},n=(0,C.bE$)(e),{animationLevel:i}=(0,je.l)(e),{management:r,shouldSkipHistoryAnimations:d,nextProfileTab:c,shouldCloseRightColumn:l}=(0,C.nTw)(e),u=a?r.byChatId[a]?.nextScreen:void 0,h=a?(0,C.nZ4)(e,a):void 0,m=a?(0,y.cG)(a,o,e.currentUserId):void 0;return{contentKey:(0,C.t75)(e,s),chatId:a,threadId:o,isChatSelected:Boolean(a&&n),animationLevel:i,shouldSkipHistoryAnimations:d,nextManagementScreen:u,nextProfileTab:c,shouldCloseRightColumn:l,isSavedMessages:h,isSavedDialog:m}})(e=>{let{contentKey:t,chatId:s,threadId:o,isMobile:n,isChatSelected:r,animationLevel:d,shouldSkipHistoryAnimations:c,nextManagementScreen:l,nextProfileTab:u,shouldCloseRightColumn:h,isSavedMessages:m,isSavedDialog:p}=e;const{toggleChatInfo:g,toggleManagement:f,setStickerSearchQuery:I,setGifSearchQuery:v,closePollResults:b,addChatMembers:y,setNewChatMembersDialogState:S,setEditingExportedInvite:A,toggleStatistics:M,toggleMessageStatistics:C,toggleStoryStatistics:P,setOpenedInviteInfo:k,requestNextManagementScreen:F,resetNextProfileTab:T,closeCreateTopicPanel:x,closeEditTopicPanel:U,closeBoostStatistics:B,setShouldCloseRightColumn:R,closeMonetizationStatistics:N}=(0,w.ko)(),J=(0,Yt.li)(),{width:E}=(0,Oa.A)(),[L,Y]=(0,Yt.J0)(m&&!p?i.zW.SavedDialogs:i.zW.Profile),[D,O]=(0,Yt.J0)(i.je.Initial),[G,V]=(0,Yt.J0)(),[j,q]=(0,Yt.J0)(),z=L!==i.zW.Profile,K=void 0!==t,W=t===i.Ul.ChatInfo,H=t===i.Ul.Management,_=t===i.Ul.Statistics,$=t===i.Ul.MessageStatistics,X=t===i.Ul.StoryStatistics,Q=t===i.Ul.BoostStatistics,Z=t===i.Ul.MonetizationStatistics,ee=t===i.Ul.StickerSearch,te=t===i.Ul.GifSearch,se=t===i.Ul.PollResults,ae=t===i.Ul.AddingMembers,oe=t===i.Ul.CreateTopic,ne=t===i.Ul.EditTopic,ie=E<=a.gQx,[re,de]=(0,Yt.J0)(!K),ce=(0,yn.A)(t,!0,!r)??-1;(0,Si.A)({containerRef:J,selector:":scope .custom-scroll, :scope .panel-content"},[t,D,s,o]);const le=(0,_t.A)(function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];switch(t){case i.Ul.AddingMembers:S({newChatMembersProgress:i.D7.Closed});break;case i.Ul.ChatInfo:if(z&&e&&!m){Y(i.zW.Profile);break}g({force:!1},{forceSyncOnIOs:!0});break;case i.Ul.Management:switch(D){case i.je.Initial:f();break;case i.je.ChatPrivacyType:case i.je.Discussion:case i.je.GroupPermissions:case i.je.GroupType:case i.je.ChatAdministrators:case i.je.ChannelSubscribers:case i.je.GroupMembers:case i.je.Invites:case i.je.Reactions:case i.je.JoinRequests:case i.je.ChannelRemovedUsers:O(i.je.Initial);break;case i.je.GroupUserPermissionsCreate:case i.je.GroupRemovedUsers:case i.je.GroupUserPermissions:O(i.je.GroupPermissions),V(void 0),q(void 0);break;case i.je.NewDiscussionGroup:O(i.je.Discussion);break;case i.je.ChatAdminRights:case i.je.ChatNewAdminRights:case i.je.GroupAddAdmins:case i.je.GroupRecentActions:O(i.je.ChatAdministrators);break;case i.je.EditInvite:case i.je.InviteInfo:O(i.je.Invites),k({chatId:s,invite:void 0}),A({chatId:s,invite:void 0})}break;case i.Ul.MessageStatistics:C();break;case i.Ul.StoryStatistics:P();break;case i.Ul.Statistics:M();break;case i.Ul.BoostStatistics:B();break;case i.Ul.MonetizationStatistics:N();break;case i.Ul.StickerSearch:Qr(),I({query:void 0});break;case i.Ul.GifSearch:Qr(),v({query:void 0});break;case i.Ul.PollResults:b();break;case i.Ul.CreateTopic:x();break;case i.Ul.EditTopic:U()}}),ue=(0,_t.A)((e,t)=>{V(e),q(t)}),he=(0,_t.A)(e=>{y({chatId:s,memberIds:e})});return(0,Yt.vJ)(()=>K&&s?(0,Is.A)(le):void 0,[K,le,s]),(0,Yt.vJ)(()=>{setTimeout(()=>{de(!K)},_r)},[K]),(0,Yt.vJ)(()=>{l&&(O(l),F(void 0))},[l]),(0,Yt.vJ)(()=>{u&&T()},[u]),(0,Yt.vJ)(()=>{h&&(le(),R({value:void 0}))},[h]),(0,Yt.vJ)(()=>{K&&ie&&le()},[ie]),(0,mo.A)(e=>{let[t,a]=e;t===s&&a===o||(Y(m&&!p?i.zW.SavedDialogs:i.zW.Profile),O(i.je.Initial))},[s,o,p,m]),(0,Os.A)({isActive:r&&(t===i.Ul.ChatInfo||t===i.Ul.Management||t===i.Ul.AddingMembers||t===i.Ul.CreateTopic||t===i.Ul.EditTopic),onBack:()=>le(!1)}),(0,ns.FD)("div",{id:"RightColumn-wrapper",className:r?void 0:"is-hidden",children:[ie&&(0,ns.Y)("div",{className:"overlay-backdrop",onClick:le}),(0,ns.FD)("div",{id:"RightColumn",children:[(0,ns.Y)(wr,{chatId:s,threadId:o,isColumnOpen:K,isProfile:W,isManagement:H,isStatistics:_,isBoostStatistics:Q,isMonetizationStatistics:Z,isMessageStatistics:$,isStoryStatistics:X,isStickerSearch:ee,isGifSearch:te,isPollResults:se,isCreatingTopic:oe,isEditingTopic:ne,isAddingChatMembers:ae,profileState:L,managementScreen:D,onClose:le,onScreenSelect:O}),(0,ns.Y)(Ms.Ay,{ref:J,name:(0,vs.P)("layers",d,re||c),renderCount:$r+Xr,activeKey:H?$r+D:ce,shouldCleanup:!0,cleanupExceptionKey:ce===i.Ul.MessageStatistics||ce===i.Ul.StoryStatistics?i.Ul.Statistics:void 0,children:function(e){if(-1!==ce)switch(ce){case i.Ul.AddingMembers:return(0,ns.Y)(Ci,{chatId:s,isActive:K&&e,onNextStep:he,onClose:le},`add_chat_members_${s}`);case i.Ul.ChatInfo:return(0,ns.Y)(br,{chatId:s,threadId:o,profileState:L,isMobile:n,isActive:K&&e,onProfileStateChange:Y},`profile_${s}_${o}`);case i.Ul.Management:return(0,ns.Y)(Ti,{chatId:s,currentScreen:D,isPromotedByCurrentUser:j,selectedChatMemberId:G,isActive:K&&e,onScreenSelect:O,onChatMemberSelect:ue,onClose:le},`management_${s}_${D}`);case i.Ul.Statistics:return(0,ns.Y)(Kr,{chatId:s});case i.Ul.BoostStatistics:return(0,ns.Y)(Jr,{});case i.Ul.MonetizationStatistics:return(0,ns.Y)(zr,{});case i.Ul.MessageStatistics:return(0,ns.Y)(Er,{chatId:s,isActive:K&&e});case i.Ul.StoryStatistics:return(0,ns.Y)(Wr,{chatId:s,isActive:K&&e});case i.Ul.StickerSearch:return(0,ns.Y)(Hr,{onClose:le,isActive:K&&e});case i.Ul.GifSearch:return(0,ns.Y)(Fi,{onClose:le,isActive:K&&e});case i.Ul.PollResults:return(0,ns.Y)(xi,{onClose:le,isActive:K&&e});case i.Ul.CreateTopic:return(0,ns.Y)(Pi,{onClose:le,isActive:K&&e});case i.Ul.EditTopic:return(0,ns.Y)(ki,{onClose:le,isActive:K&&e})}}})]})]})})),ed=(0,Yt.ph)(e=>{let{isOpen:t}=e;const s=(0,os.A)(qt.ar.Extra,"StoryViewer",!t);return s?(0,ns.Y)(s,{}):void 0}),td=e=>{const{requestedAttachBotInChat:t}=e,s=(0,os.A)(qt.ar.Extra,"AttachBotRecipientPicker",!t);return s?(0,ns.Y)(s,{...e}):void 0},sd=e=>{const{bot:t}=e,s=(0,os.A)(qt.ar.Extra,"BotTrustModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},ad=e=>{const{folder:t}=e,s=(0,os.A)(qt.ar.Extra,"DeleteFolderDialog",!t);return s?(0,ns.Y)(s,{...e}):void 0},od=e=>{let{isOpen:t}=e;const s=(0,os.A)(qt.ar.Extra,"Dialogs",!t);return s?(0,ns.Y)(s,{}):void 0};var nd=s(95362);const id=new Set,rd=new Set,dd=(0,Yt.ph)((0,w.EK)(e=>({activeDownloads:(0,C.nTw)(e).activeDownloads}))(e=>{let{activeDownloads:t}=e;const{cancelMediaHashDownloads:s,showNotification:a}=(0,w.ko)(),o=(0,fo.A)(1e3,!0),i=(0,_t.A)(e=>{rd.add(e),o(()=>{rd.size&&(s({mediaHashes:Array.from(rd)}),rd.clear())})});(0,Yt.vJ)(()=>{Object.keys(t).length?Object.entries(t).forEach(e=>{let[t,s]=e;if(id.has(t))return;id.add(t);const{size:o,filename:r,format:c}=s,l=tt.Ih(t);if(l)return(0,nd.A)(l,r),void i(t);if(o>d.kn&&!d.l5&&!d.Tz)return a({message:"Downloading files bigger than 2GB is not supported in your browser."}),void i(t);const u=()=>{(0,C.nTw)((0,w.mS)()).activeDownloads[t]||tt.ch(u)};tt.hd(t,c,!0,u,(0,ft.A)()).then(e=>{if(c===n.qZ.DownloadUrl){const t=new URL(e,window.document.baseURI);t.searchParams.set("filename",encodeURIComponent(r));const s=window.open(t.toString());s?.addEventListener("beforeunload",()=>{a({message:"Download started. Please, do not close the app before it is finished."})})}else e&&(0,nd.A)(e,r);i(t)})}):id.clear()},[t])})),cd=e=>{const{requestedDraft:t}=e,s=(0,os.A)(qt.ar.Extra,"DraftRecipientPicker",!t);return s?(0,ns.Y)(s,{...e}):void 0},ld=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"ForwardRecipientPicker",!t);return s?(0,ns.Y)(s,{...e}):void 0};var ud=s(73172),hd=s(22337);const md=(0,Yt.ph)((0,w.EK)((e,t)=>{let{openedGame:s}=t;const{chatId:a}=s||{},o=a&&(0,C.hds)(e,a),n=a?(0,C.AWZ)(e,a):void 0;return{canPost:Boolean(o)&&(0,y.__)(o,void 0,void 0,n)}})(e=>{let{openedGame:t,gameTitle:s,canPost:a}=e;const{closeGame:o,openForwardMenu:n}=(0,w.ko)(),i=(0,Fs.A)(),{url:r,chatId:d,messageId:c}=t||{},l=Boolean(r),u=(0,ud.A)(d);(0,zt.A)(()=>{u({type:"playingGame"})},l&&a?5e3:void 0);const h=(0,Yt.hb)(e=>{if(d&&c)try{const t=JSON.parse(e.data);"share_score"===t.eventType&&(n({fromChatId:d,messageIds:[c],withMyScore:!0}),o()),"share_game"===t.eventType&&(n({fromChatId:d,messageIds:[c]}),o())}catch(e){}},[d,o,c,n]),m=(0,Yt.hb)(e=>{e.currentTarget.focus()},[]);return(0,Yt.vJ)(()=>(window.addEventListener("message",h),()=>window.removeEventListener("message",h)),[h]),(0,ns.Y)(hd.A,{className:"GameModal",isOpen:l,onClose:o,title:s,hasCloseButton:!0,children:l&&(0,ns.Y)("iframe",{className:"game-frame",onLoad:m,src:r,title:i("AttachGame"),sandbox:"allow-scripts allow-same-origin allow-orientation-lock",allow:"fullscreen"})})})),pd=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"HistoryCalendar",!t);return s?(0,ns.Y)(s,{...e}):void 0},gd=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"NewContactModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},fd=e=>{let{isOpen:t}=e;const s=(0,os.A)(qt.ar.Extra,"Notifications",!t);return s?(0,ns.Y)(s,{}):void 0},Id=e=>{const{limit:t}=e,s=(0,os.A)(qt.ar.Extra,"PremiumLimitReachedModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},vd=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"GiveawayModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},bd=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Extra,"PremiumMainModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},yd=e=>{const{isOpen:t}=e,s=(0,os.A)(qt.ar.Stars,"StarsGiftingPickerModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},Sd=e=>{const{url:t}=e,s=(0,os.A)(qt.ar.Extra,"SafeLinkModal",!t);return s?(0,ns.Y)(s,{...e}):void 0},wd={root:"YUAfqWPN"},Ad=["#E8BC2C","#D0049E","#02CBFE","#5723FD","#FE8C27","#6CB859"],Md=new Path2D("M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z"),Cd=(0,Yt.ph)((0,w.EK)(e=>(0,h.Up)((0,C.nTw)(e),["confetti"]))(e=>{let{confetti:t}=e;const s=(0,Yt.li)(),a=(0,Yt.li)([]),o=(0,Yt.li)(!1),n=(0,Oa.A)(),i=(0,Wt.A)(),{isMobile:r}=(0,D.Ay)(),d=r?50:100,{lastConfettiTime:c,top:l,width:u,left:h,height:m,style:p="poppers"}=t||{},g=(0,_t.A)(function(e,s){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;for(let n=0;n<o;n++){const{position:o,velocity:i}=Pd(p,e,s,n),r=10+kd(5),d=Ad[Math.floor(Math.random()*Ad.length)];a.current.push({pos:o,size:r,color:d,velocity:i,flicker:r,flickerFrequency:.2*Math.random(),rotation:0,lastDrawnAt:Date.now(),frameCount:0,isStar:t?.withStars&&Math.random()>.8})}}),f=(0,_t.A)(()=>{if(!s.current||!o.current)return;const e=s.current,t=e.getContext("2d");if(!t)return;const{width:n,height:i}=e;t.clearRect(0,0,n,i);const r=[];a.current.forEach((e,s)=>{const{pos:o,velocity:n,size:d,color:c,flicker:l,flickerFrequency:u,rotation:h,lastDrawnAt:m,frameCount:p}=e,g=(Date.now()-m)/1e3,f={x:o.x+n.x*g,y:o.y+n.y*g},I={x:n.x*.5**(g/1),y:n.y+=1e3*g},v=d*Math.abs(Math.sin(p*u)),b=5*p*u*(Math.PI/180),y=p+1,S=Date.now();if(f.y>i+e.size)return void r.push(e);const w={...e,pos:f,velocity:I,flicker:v,rotation:b,lastDrawnAt:S,frameCount:y};a.current[s]=w,t.fillStyle=c,e.isStar?(t.save(),t.translate(o.x,o.y),t.scale(d/10*1.5,d/10*1.5),t.rotate(h),t.fill(Md),t.restore()):(t.beginPath(),t.ellipse(o.x,o.y,d,l,h,0,2*Math.PI),t.fill())}),a.current=a.current.filter(e=>!r.includes(e)),a.current.length?(0,Ot.YS)(f):o.current=!1});if((0,es.A)(e=>{let t,[s]=e;return s!==c&&(g(u||n.width,m||n.height),t=setTimeout(i,1e4),o.current||(o.current=!0,(0,Ot.YS)(f))),()=>{clearTimeout(t)}},[c,i,f]),!c||Date.now()-c>1e4)return;const I=(0,Ea.A)(Boolean(l)&&`top: ${l}px`,Boolean(h)&&`left: ${h}px`,Boolean(u)&&`width: ${u}px`,Boolean(m)&&`height: ${m}px`);return(0,ns.Y)("div",{id:"Confetti",className:wd.root,style:I,children:(0,ns.Y)("canvas",{ref:s,className:wd.canvas,width:n.width,height:n.height})})}));function Pd(e,t,s,a){if("poppers"===e){const e=a%2,o={x:t*(e?-.1:1.1),y:.66*s},n=Math.random()*t;return{position:o,velocity:{x:e?n:-1*n,y:-s-kd(.75*s)}}}return{position:{x:Math.random()*t,y:-20},velocity:{x:kd(t),y:-s*Math.random()*1.25}}}function kd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Math.random()*e-e/2}var Fd=s(15006),Td=s(28470);const xd=s.p+"wave_ripple.5d7d9fa793232bef56c0.jpg",Ud="wave-filter",Bd=(0,Yt.ph)((0,w.EK)(e=>({waveInfo:(0,C.nTw)(e).wave}))(e=>{let{waveInfo:t}=e;const[s,o]=(0,Yt.J0)([]),n=(0,_t.A)(e=>{s.length>=7||o(t=>[...t,e])});return(0,Yt.vJ)(()=>{if(!t)return;const{startX:e,startY:s}=t,{width:a,height:o}=x.A.get(),i=1.73*Math.max(a-e,o-s,e,s),r=s-i/2,d=e-i/2;n({startTime:t.lastWaveTime,waveWidth:i,top:r,left:d})},[t]),(0,Yt.vJ)(()=>((0,Td.z)((0,ns.FD)("filter",{x:"0",y:"0",width:"1",height:"1","color-interpolation-filters":"sRGB",xmlns:a.jNX,children:[(0,ns.Y)("feImage",{href:xd,result:"waveImage"}),(0,ns.Y)("feDisplacementMap",{in:"SourceGraphic",in2:"waveImage",scale:"20",xChannelSelector:"R",yChannelSelector:"B"})]}),Ud),()=>{(0,Td.e)(Ud)}),[]),(0,ns.Y)("div",{className:(0,Gt.A)("RMsQzedH"),teactFastList:!0,children:s.map(e=>(0,ns.Y)("div",{className:"YLR2Oh2f",style:(0,Ea.A)(`--wave-width: ${e.waveWidth}px`,`--wave-pos-top: ${e.top}px`,`--wave-pos-left: ${e.left}px`),onAnimationEnd:()=>o(t=>t.filter(t=>t!==e))},e.startTime))})}));let Rd=!1;const Nd=(0,Yt.ph)((0,w.EK)((e,t)=>{let{isMobile:s}=t;const{currentUserId:a}=e,{botTrustRequest:o,requestedAttachBotInChat:n,requestedDraft:i,safeLinkModalUrl:r,openedStickerSetShortName:d,openedCustomEmojiSetIds:c,shouldSkipHistoryAnimations:l,openedGame:u,isLeftColumnShown:h,historyCalendarSelectedAt:m,notifications:p,dialogs:g,newContact:f,ratingPhoneCall:I,premiumModal:v,giveawayModal:b,deleteMessageModal:y,starsGiftingPickerModal:S,isMasterTab:w,payment:A,limitReachedModal:M,deleteFolderDialogModal:P}=(0,C.nTw)(e),{wasTimeFormatSetManually:k}=(0,je.l)(e),F=u&&(0,C.O5q)(e,u.chatId,u.messageId),T=F?.content.game?.title,{chatId:x}=(0,C.Xf0)(e)||{},U=!(0,C.xYJ)(e,"rightColumnAnimations")||!(0,C.PKK)(e),B=P?(0,C.$aQ)(e,P):void 0,R=(0,C.trm)(e);return{currentUserId:a,isLeftColumnOpen:h,isMiddleColumnOpen:Boolean(x),isRightColumnOpen:(0,C.gjV)(e,s),isMediaViewerOpen:(0,C.F4N)(e),isStoryViewerOpen:(0,C.gd2)(e),isForwardModalOpen:(0,C.p5z)(e),isReactionPickerOpen:(0,C.Ani)(e),hasNotifications:Boolean(p.length),hasDialogs:Boolean(g.length),safeLinkModalUrl:r,isHistoryCalendarOpen:Boolean(m),shouldSkipHistoryAnimations:l,openedStickerSetShortName:d,openedCustomEmojiSetIds:c,isServiceChatReady:(0,C.dqr)(e),activeGroupCallId:w?e.groupCalls.activeGroupCallId:void 0,withInterfaceAnimations:(0,C.PKK)(e),wasTimeFormatSetManually:k,isPhoneCallActive:w?Boolean(e.phoneCall):void 0,addedSetIds:e.stickers.added.setIds,addedCustomEmojiIds:e.customEmojis.added.setIds,newContactUserId:f?.userId,newContactByPhoneNumber:f?.isByPhoneNumber,openedGame:u,gameTitle:T,isRatePhoneCallModalOpen:Boolean(I),botTrustRequest:o,botTrustRequestBot:o&&(0,C.mBe)(e,o.botId),requestedAttachBotInChat:n,isCurrentUserPremium:(0,C.g29)(e),isPremiumModalOpen:v?.isOpen,isGiveawayModalOpen:b?.isOpen,isDeleteMessageModalOpen:Boolean(y),isStarsGiftingPickerModal:S?.isOpen,limitReached:M?.limit,isPaymentModalOpen:A.isPaymentModalOpen,isReceiptModalOpen:Boolean(A.receipt),deleteFolderDialog:B,isMasterTab:w,requestedDraft:i,noRightColumnAnimation:U,isSynced:e.isSynced,isAccountFrozen:R,isAppConfigLoaded:e.isAppConfigLoaded}})(e=>{let{isMobile:t,isLeftColumnOpen:o,isMiddleColumnOpen:n,isRightColumnOpen:i,isMediaViewerOpen:r,isStoryViewerOpen:c,isForwardModalOpen:l,hasNotifications:u,hasDialogs:h,activeGroupCallId:m,safeLinkModalUrl:p,isHistoryCalendarOpen:g,shouldSkipHistoryAnimations:f,limitReached:I,openedStickerSetShortName:v,openedCustomEmojiSetIds:b,isServiceChatReady:y,withInterfaceAnimations:S,wasTimeFormatSetManually:A,addedSetIds:M,addedCustomEmojiIds:C,isPhoneCallActive:P,newContactUserId:k,newContactByPhoneNumber:F,openedGame:T,gameTitle:x,isRatePhoneCallModalOpen:U,botTrustRequest:B,botTrustRequestBot:R,requestedAttachBotInChat:N,requestedDraft:J,isPremiumModalOpen:E,isGiveawayModalOpen:L,isDeleteMessageModalOpen:Y,isStarsGiftingPickerModal:O,isPaymentModalOpen:G,isReceiptModalOpen:V,isReactionPickerOpen:j,isCurrentUserPremium:q,deleteFolderDialog:z,isMasterTab:K,noRightColumnAnimation:W,isSynced:H,currentUserId:_,isAccountFrozen:$,isAppConfigLoaded:X}=e;const{initMain:Q,loadAnimatedEmojis:Z,loadBirthdayNumbersStickers:ee,loadRestrictedEmojiStickers:te,loadNotificationSettings:se,loadNotificationExceptions:ae,updateIsOnline:oe,onTabFocusChange:ne,loadTopInlineBots:ie,loadEmojiKeywords:re,loadCountryList:de,loadAvailableReactions:ce,loadStickerSets:le,loadPremiumGifts:ue,loadTonGifts:he,loadStarGifts:me,loadDefaultTopicIcons:pe,loadAddedStickers:ge,loadFavoriteStickers:fe,loadDefaultStatusIcons:Ie,ensureTimeFormat:ve,closeStickerSetModal:be,closeCustomEmojiSets:ye,checkVersionNotification:Se,loadConfig:we,loadAppConfig:Ae,loadAttachBots:Me,loadContactList:Ce,loadCustomEmojis:Pe,loadGenericEmojiEffects:ke,closePaymentModal:Fe,clearReceipt:Te,checkAppVersion:xe,openThread:Ue,toggleLeftColumn:Be,loadRecentEmojiStatuses:Re,loadUserCollectibleStatuses:Ne,updatePageTitle:Je,loadTopReactions:Ee,loadRecentReactions:Le,loadDefaultTagReactions:Ye,loadFeaturedEmojiStickers:De,loadAuthorizations:Oe,loadPeerColors:Ge,loadSavedReactionTags:Ve,loadTimezones:je,loadQuickReplies:qe,loadStarStatus:ze,loadAvailableEffects:Ke,loadTopBotApps:We,loadPaidReactionPrivacy:He,loadPasswordInfo:_e,loadBotFreezeAppeal:$e,loadAllChats:Xe,loadAllStories:Qe,loadAllHiddenStories:Ze,loadContentSettings:et}=(0,w.ko)();a.Oig&&!Rd&&(Rd=!0,console.log(">>> RENDER MAIN"));const tt=(0,Ht.A)();(0,Kt.A)(()=>{(0,qt.po)(qt.ar.Calls)},5e3);const st=(0,Yt.li)(),at=(0,Yt.li)(),{isDesktop:nt}=(0,D.Ay)();var it,rt;(0,Yt.vJ)(()=>{o||n||nt?o&&n&&t&&Be():Be()},[nt,o,n,t,Be]),(0,zt.A)(xe,K?3e5:void 0,!0),(0,Yt.vJ)(()=>{K&&H&&(oe({isOnline:!0}),we(),Ae(),Ge(),Q(),Ce(),xe(),Oe(),_e())},[K,H]),(0,Yt.vJ)(()=>{K&&H&&X&&!$&&(Xe({listType:"saved"}),Qe(),Ze(),et(),Le(),Ye(),Me(),se(),ae(),ie(),Ee(),ze(),re({language:a.cUY}),De(),Ve(),We(),He(),pe(),Z(),ce(),Ne(),ke(),ue(),he(),me(),Ke(),ee(),te(),qe(),je())},[K,H,X,$]),(0,Yt.vJ)(()=>{K&&q&&X&&!$&&(Ie(),Re())},[q,K,X,$]),(0,Yt.vJ)(()=>{K&&(tt.code!==a.cUY&&re({language:tt.code}),de({langCode:tt.code}))},[tt,K]),(0,Yt.vJ)(()=>{K&&Pe({ids:Object.keys((0,w.mS)().customEmojis.byId),ignoreCache:!0})},[K]),(0,Yt.vJ)(()=>{K&&H&&X&&!$&&(M&&C||(le(),fe()),M&&C&&ge())},[M,C,K,H,X,$]),(0,Yt.vJ)(()=>{$e()},[X]),(0,Yt.vJ)(()=>{y&&K&&Se()},[y,K]),(0,Yt.vJ)(()=>{A||ve()},[A]),(0,Yt.vJ)(()=>{if(!H)return;Je();const e=(0,ot.f4)();e?.tgaddr&&(0,jt._)(decodeURIComponent(e.tgaddr))},[H]),it="deeplink",rt=e=>{try{const t=e.payload||"",s=decodeURIComponent(t);(0,jt._)(s)}catch(e){a.Oig&&console.error("Failed to process deep link",e)}},(0,Yt.vJ)(()=>{if(!gt.Vq)return;let e;return(async()=>{const{listen:t}=await s.e(8925).then(s.bind(s,8925));e=await t(it,e=>{rt(e)})})().catch(e=>{console.error(`Could not set up window event listener. ${e}`)}),()=>{e?.()}},[it,rt]),(0,Yt.vJ)(()=>{const e=(0,ot.xV)(_);e&&Ue({chatId:e.chatId,threadId:e.threadId,type:e.type})},[_]),(0,Yt.Nf)(()=>{const e=st.current;1===e.parentNode.childElementCount&&(0,Dt.YM)(e,"Transition_slide-active")},[]),(0,Zt.A)({ref:st,isOpen:o,noCloseTransition:f,prefix:"left-column-"});const dt=(0,Yt.li)(!1),ct=(0,Wt.A)();(0,es.A)(e=>{let[t]=e;if(void 0===t||o===t||!S)return;dt.current=!0,d.Ni&&(0,Ot.Uz)(()=>{document.body.classList.toggle("android-left-blackout-open",!o)});const s=(0,Yt.VK)();(0,Vt.j)(document.getElementById("MiddleColumn"),()=>{s(),dt.current=!1,ct()})},[o,S,ct]),(0,Zt.A)({ref:st,isOpen:i,noCloseTransition:f,prefix:"right-column-"});const lt=(0,Yt.li)(!1),[ut,ht]=(0,Yt.J0)(i),mt=(0,as.zk)();(0,es.A)(e=>{let[t,s]=e;if(void 0===s||i===s)return;if(!t||W)return void ht(i);lt.current=!0;const a=(0,Yt.VK)();(0,Vt.j)(document.getElementById("RightColumn"),()=>{a(),lt.current=!1,ct(),ht(i)})},[n,i,W,ct]);const pt=(0,Gt.A)(dt.current&&"left-column-animating",lt.current&&"right-column-animating",ut&&"narrow-message-list",f&&"history-animation-disabled",mt&&"is-fullscreen"),ft=(0,_t.A)(()=>{ne({isBlurred:!0})}),It=(0,_t.A)(()=>{ne({isBlurred:!1}),document.title.includes(a.LaL)||Je(),bt(!1)}),vt=(0,_t.A)(()=>{be()}),yt=(0,_t.A)(()=>{ye()});return(0,ts.Ay)(ft,It,gt.Vq),(0,ss.A)(ft),function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,Yt.vJ)(()=>{if(d.TF){if(!e)return $t?.setAttribute("content",Xt),d.pz&&!d._7&&document.addEventListener("gesturestart",Qt),()=>{$t?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no"),d.pz&&!d._7&&document.removeEventListener("gesturestart",Qt)};$t?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover")}},[e])}(r||c),(0,ns.FD)("div",{ref:st,id:"Main",className:pt,children:[(0,ns.Y)(Ba,{ref:at}),(0,ns.Y)(pi,{leftColumnRef:at,isMobile:t}),(0,ns.Y)(Zr,{isMobile:t}),(0,ns.Y)(Ra,{isOpen:r}),(0,ns.Y)(ed,{isOpen:c}),(0,ns.Y)(ld,{isOpen:l}),(0,ns.Y)(cd,{requestedDraft:J}),(0,ns.Y)(fd,{isOpen:u}),(0,ns.Y)(od,{isOpen:h}),(0,ns.Y)(Rn,{noUi:!0}),(0,ns.Y)(vi,{}),(0,ns.Y)(Sd,{url:p}),(0,ns.Y)(pd,{isOpen:g}),(0,ns.Y)(hs,{isOpen:Boolean(v),onClose:vt,stickerSetShortName:v}),(0,ns.Y)(ls,{customEmojiSetIds:b,onClose:yt}),m&&(0,ns.Y)(rs,{groupCallId:m}),(0,ns.Y)(is,{isActive:Boolean(m||P)}),(0,ns.Y)(gd,{isOpen:Boolean(k||F),userId:k,isByPhoneNumber:F}),(0,ns.Y)(md,{openedGame:T,gameTitle:x}),(0,ns.Y)(dd,{}),(0,ns.Y)(Cd,{}),d.J6&&(0,ns.Y)(Bd,{}),(0,ns.Y)(Fd.A,{}),(0,ns.Y)(ds,{isActive:P}),(0,ns.Y)(fs,{isForAppBadge:!0}),(0,ns.Y)(cs,{isOpen:U}),(0,ns.Y)(sd,{bot:R,type:B?.type,shouldRequestWriteAccess:B?.shouldRequestWriteAccess}),(0,ns.Y)(td,{requestedAttachBotInChat:N}),(0,ns.Y)(Ja,{}),(0,ns.Y)(bd,{isOpen:E}),(0,ns.Y)(vd,{isOpen:L}),(0,ns.Y)(yd,{isOpen:O}),(0,ns.Y)(Id,{limit:I}),(0,ns.Y)(bi,{isOpen:G,onClose:Fe}),(0,ns.Y)(yi,{isOpen:V,onClose:Te}),(0,ns.Y)(ad,{folder:z}),(0,ns.Y)(Na,{isOpen:j}),(0,ns.Y)(us,{isOpen:Y})]})}));var Jd=s(15535);var Ed=s(89704);const Ld=(0,Yt.ph)((0,w.EK)(e=>({passcodeSettings:e.passcode}))(e=>{let{isLocked:t,passcodeSettings:s}=e;const{unlockScreen:a,signOut:o,logInvalidUnlockAttempt:n,resetInvalidUnlockAttempts:i}=(0,w.ko)(),{invalidAttemptsCount:r,timeoutUntil:d,isLoading:c}=s,l=(0,Fs.A)(),[u,h]=(0,Yt.J0)(""),[m,p]=(0,Yt.J0)(!1),[g,f,I]=(0,_s.A)(!1),{shouldRender:v}=(0,Ts.A)(t);(0,Kt.A)(i,d?d-Date.now():void 0);const b=(0,Yt.hb)(()=>{h("")},[]),y=(0,Yt.hb)(e=>{void 0===d?(h(""),(0,kt.UQ)(e).then(a,e=>{e instanceof kt.Mv&&o({forceInitApi:!0}),n(),h(l("lng_passcode_wrong"))})):h(l("FloodWait"))},[l,d]);(0,Yt.vJ)(()=>{void 0!==d?h(l("FloodWait")):0===r&&h("")},[d,l,r]);const S=(0,Yt.hb)(()=>{I(),o({forceInitApi:!0})},[I,o]);if(v)return(0,ns.FD)("div",{className:"bdKGCai4",children:[(0,ns.FD)("div",{className:"BIi4Pl4Z",dir:l.isRtl?"rtl":void 0,children:[(0,ns.Y)(an.A,{tgsUrl:sn.w.Lock,previewUrl:Ed,size:160,className:"JwlsF2tF"}),(0,ns.Y)(Jd.A,{shouldShowSubmit:!0,shouldDisablePasswordManager:!0,isLoading:c,error:u,placeholder:l("Passcode.EnterPasscodePlaceholder"),submitLabel:l("Next"),onClearError:b,isPasswordVisible:m,noRipple:!0,onChangePasswordVisibility:p,onSubmit:y},"password-form"),(0,ns.FD)("div",{className:"VlXFyC_a",children:[(0,ns.FD)("p",{children:[(0,ns.Y)(Po.A,{onClick:f,children:"Log out"})," ","if you don't remember your passcode."]}),(0,ns.Y)("p",{children:(0,ns.Y)(xs.A,{color:"translucent",size:"tiny",isText:!0,onClick:f,children:l("AccountSettings.Logout")})})]})]}),(0,ns.Y)(Vn.A,{isOpen:g,onClose:I,text:l("lng_sure_logout"),confirmLabel:l("AccountSettings.Logout"),confirmHandler:S,confirmIsDestructive:!0})]})}));a.Oig&&console.log(">>> FINISH LOAD MAIN BUNDLE")}}]);
//# sourceMappingURL=7768.1a9b7f4d32420f65bf30.js.map