"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[9451],{3178:(e,t,i)=>{i.d(t,{A:()=>p});var s=i(84051),n=i(31481),o=i(36175),a=i(14737),r=i(43874),l=i(37661),c=i(18104),d=i(20021);const h=[0,50],m=[0,20],u=[20,0],p=(0,s.ph)(({isPasswordVisible:e,isBig:t})=>{const[i,p]=(0,l.A)(!1),[v,g]=(0,l.A)(!1),{isMobile:A}=(0,r.Ay)(),f=A?n.UyP:n.H6l;(0,a.A)(g,2e3);const b=(0,s.hb)(p,[p]);return(0,d.FD)("div",{id:"monkey",className:t?"big":"",children:[!i&&(0,d.Y)("div",{className:"monkey-preview"}),(0,d.Y)(c.A,{size:t?n.r2x:f,className:v?"hidden":"shown",tgsUrl:o.w.MonkeyClose,playSegment:h,noLoop:!0,onLoad:b}),(0,d.Y)(c.A,{size:t?n.r2x:f,className:v?"shown":"hidden",tgsUrl:o.w.MonkeyPeek,playSegment:e?m:u,noLoop:!0})]})})},98430:(e,t,i)=>{i.r(t),i.d(t,{AboutAdsModal:()=>pl,AboutMonetizationModal:()=>gl,AgeVerificationModal:()=>zr,ArchivedChats:()=>au,AttachBotInstallModal:()=>so,AttachBotRecipientPicker:()=>Os,AttachmentModal:()=>up,BirthdaySetupModal:()=>cl,BoostModal:()=>Vr,BotCommandMenu:()=>Jp,BotTrustModal:()=>io,CalendarModal:()=>sn,ChatCommandTooltip:()=>Kp,ChatFolderModal:()=>ru,ChatInviteModal:()=>tl,ChatLanguageModal:()=>vc,ChatlistModal:()=>Xr,CollectibleInfoModal:()=>bc,ContactList:()=>$m,ContextMenuContainer:()=>du.A,CountryPickerModal:()=>dc,CreateTopic:()=>bg,CustomEmojiSetsModal:()=>pu,CustomEmojiTooltip:()=>zp,CustomSendMenu:()=>$p,DeleteAccountModal:()=>Gr,DeleteFolderDialog:()=>no,DeleteMessageModal:()=>zl,Dialogs:()=>Ks.A,DraftRecipientPicker:()=>Us,DropArea:()=>qp.A,EditTopic:()=>yg,EmojiInteractionAnimation:()=>pc,EmojiStatusAccessModal:()=>yl,EmojiTooltip:()=>tv,ForwardRecipientPicker:()=>_s,FrozenAccountModal:()=>JA,GifSearch:()=>uv,GiftCodeModal:()=>Kr,GiveawayModal:()=>Ja,HeaderMenuContainer:()=>fu,HistoryCalendar:()=>nn,InlineBotTooltip:()=>lv,InviteViaLinkModal:()=>_A,LeftSearch:()=>bd,LocationAccessModal:()=>Sl,Management:()=>sA,MapModal:()=>zs,MediaViewer:()=>Mt,MentionTooltip:()=>rp,MessageSelectToolbar:()=>Wl,MessageStatistics:()=>Zv,MiddleSearch:()=>Fu,MinimizedWebAppModal:()=>fn,MuteChatModal:()=>cu,NewChat:()=>Zm,NewContactModal:()=>ln,OneTimeMediaModal:()=>OA,PasskeyModal:()=>sl,PaymentModal:()=>BA,PinMessageModal:()=>Hl,PollModal:()=>pp,PollResults:()=>rg,PremiumLimitReachedModal:()=>qa,PremiumMainModal:()=>ua,PreparedMessageModal:()=>Fl,PrivacySettingsNoticeModal:()=>sc,ProfileRatingModal:()=>jA,QuickPreviewModal:()=>WA,ReactionPicker:()=>Eu,ReactorListModal:()=>uc,ReceiptModal:()=>xA,ReportAdModal:()=>kl,ReportModal:()=>Il,SafeLinkModal:()=>Gs,SeenByModal:()=>Ql,SendAsMenu:()=>cv,Settings:()=>Hm,SharePreparedMessageModal:()=>Tl,SponsoredContextMenuContainer:()=>hl.A,Statistics:()=>Jv,StatusPickerMenu:()=>Dr,StealthModeModal:()=>QA,StickerSearch:()=>mv,StickerSetModal:()=>mu,StickerTooltip:()=>Gp,StoryStatistics:()=>ng,StoryViewer:()=>fs,SuggestMessageModal:()=>Rl,SuggestedPostApprovalModal:()=>El,SuggestedStatusModal:()=>Br,SymbolMenu:()=>Up,TextFormatter:()=>Xp,ToDoListModal:()=>gp,UnpinAllMessagesModal:()=>$l,UrlAuthModal:()=>$s,VerificationMonetizationModal:()=>bl,WebAppModal:()=>to,WebAppsCloseConfirmationModal:()=>KA});var s=i(84051),n=i(13439),o=i(89925),a=i(31481),r=i(66644),l=i(90709),c=i(91048),d=i(53827),h=i(63495),m=i(96454),u=i(11778),p=i(14680),v=i(48899),g=i(76023),A=i(49086);function f({message:e,avatarOwner:t,profilePhotos:i,standaloneMedia:s,mediaIndex:n,sponsoredMessage:o}){return t&&i?{type:"avatar",avatarOwner:t,profilePhotos:i,mediaIndex:n}:s?{type:"standalone",media:s,mediaIndex:n}:e?{type:"message",message:e,mediaIndex:n}:o?{type:"sponsoredMessage",message:o,mediaIndex:n}:void 0}function b(e,t,i){if(!i)return;if("standalone"===i.type)return{media:i.media[i.mediaIndex],isSingle:1===i.media.length};if("avatar"===i.type){const e=i.profilePhotos?.photos[i.mediaIndex];return e?{media:e}:void 0}const{action:s,document:n,photo:o,video:a,paidMedia:r}=(0,l.r_)(i.message);if("chatEditPhoto"===s?.type||"suggestProfilePhoto"===s?.type)return{media:s.photo,isSingle:!0};if(n&&((0,l.Ml)(n)||(0,l.hr)(n)))return{media:n};const d=(0,c.Pn$)(e,i.message);if("full"===d?.webpageType){const{photo:e,video:t,document:i}=d,s=i&&((0,l.Ml)(i)||(0,l.hr)(i)),n=t||(s?i:void 0)||e;if(n)return{media:n,isSingle:!0}}if(r){const e=r.extendedMedia[i.mediaIndex||0];if(!("mediaType"in e)){const{photo:t,video:i}=e;return{media:t||i}}}const h=a||o;return h?{media:h}:void 0}var C=i(19822),y=i(83868),S=i(16460),N=i(41512),k=i(43503);function w(e,t){const i=document.createElement("div");i.classList.add("ghost");const s=new Image;if(s.draggable=!1,s.oncontextmenu=y.A,"string"==typeof e?s.src=e:e instanceof HTMLVideoElement?s.src=e.poster:s.src=e.src,i.appendChild(s),t===o.TQ.ProfileAvatar||t===o.TQ.SettingsAvatar){i.classList.add("ProfileInfo"),t===o.TQ.SettingsAvatar&&i.classList.add("self");const e=document.querySelector(t===o.TQ.ProfileAvatar?"#RightColumn .ProfileInfo .info":"#Settings .ProfileInfo .info");e&&i.appendChild(e.cloneNode(!0))}return i}function I(e,t,i){let s,n;switch(e){case o.TQ.Album:case o.TQ.ScheduledAlbum:s=`.Transition_slide-active > .MessageList #album-media-${(0,l.GZ)(t.id,i)}`,n=".full-media";break;case o.TQ.PreviewMedia:s=`#preview-media${i}`,n="img";break;case o.TQ.SharedMedia:s=`#shared-media${(0,l.GZ)(t.id,i)}`,n="img";break;case o.TQ.SearchResult:s=`#search-media${(0,l.GZ)(t.id,i)}`,n="img";break;case o.TQ.MiddleHeaderAvatar:s=".MiddleHeader .Transition_slide-active .ChatInfo .Avatar",n=".avatar-media";break;case o.TQ.SettingsAvatar:s="#Settings .ProfileInfo .Transition_slide-active .ProfilePhoto",n=".avatar-media";break;case o.TQ.ProfileAvatar:s="#RightColumn .ProfileInfo .Transition_slide-active .ProfilePhoto",n=".avatar-media";break;case o.TQ.ChannelAvatar:case o.TQ.SuggestedAvatar:s=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,i)}`,n=".Avatar img";break;case o.TQ.StarsTransaction:s=".transaction-media-preview",n=0===i?`.stars-transaction-media-${i} :is(img, video)`:void 0;break;case o.TQ.SponsoredMessage:s=".Transition_slide-active > .MessageList .sponsored-media-preview",n=`${a.KFG} .full-media,${a.KFG} .thumbnail:not(.blurred-bg)`;break;case o.TQ.ScheduledInline:case o.TQ.Inline:default:s=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,i)}`,n=`${a.KFG} .full-media,${a.KFG} .thumbnail:not(.blurred-bg)`}const r=document.querySelector(s),c=n?r?.querySelectorAll(n):void 0;return{container:r,mediaEl:c?.[0]}}function P(e,t){switch(t){case o.TQ.Album:case o.TQ.ScheduledAlbum:case o.TQ.Inline:case o.TQ.ScheduledInline:case o.TQ.StarsTransaction:case o.TQ.PreviewMedia:e.classList.add("rounded-corners");break;case o.TQ.SharedMedia:case o.TQ.SettingsAvatar:case o.TQ.ProfileAvatar:case o.TQ.SearchResult:e.firstChild.style.objectFit="cover";break;case o.TQ.MiddleHeaderAvatar:case o.TQ.SuggestedAvatar:case o.TQ.ChannelAvatar:e.classList.add("circle")}}var Y=i(43874),F=i(82117),D=i(37661),M=i(30857),T=i(17712),B=i(59030),L=i(41733),R=i(22237);const x=(0,R.n5)(!1),E=x[1],V=x;function _(e){if(e.webkitSupportsPresentationMode&&"function"==typeof e.webkitSetPresentationMode)return e.webkitSetPresentationMode.bind(e)}function U(){if(document.pictureInPictureElement)try{document.exitPictureInPicture()}catch(e){a.Oig&&console.log("[MV] PictureInPicture Error",e)}}var O=i(29886),K=i(73767),J=i(34780),G=i(23174),j=i(32587),z=i(87679);const H=new Map;var $=i(35297);var q=i(62587),W=i(69419);const Q=g.cf,Z=({media:e,isAvatar:t,origin:i,delay:n})=>{const a=t&&"photo"===e?.mediaType&&!e.isVideo,r=t&&"photo"===e?.mediaType&&e.isVideo,c="document"===e?.mediaType,d="video"===e?.mediaType&&!e.isRound||c&&(0,l.hr)(e),h="photo"===e?.mediaType||c&&(0,l.Ml)(e),m="video"===e?.mediaType&&e.isGif,u=i===o.TQ.SharedMedia,p=i===o.TQ.SearchResult,v=e&&(0,l.JU)(e),A=(0,s.Kr)(()=>t=>{if(e)return!a&&!r||t?r&&t?(0,l.Pg)(e):(0,l.VO)(e,t?"full":"preview"):(0,l.mU)(e)},[r,a,e]),f=(0,q.A)(e&&(u||p||c)&&(0,l.VO)(e,"pictogram"),void 0,G.qZ.BlobUrl,n),b=A(),C=(0,q.A)(b,void 0,G.qZ.BlobUrl,n),{mediaData:y,loadProgress:S}=(0,W.A)(A(!0),void 0,e&&(0,l.Cz)(e,"full"),n),N=e&&"blobUrl"in e?e.blobUrl:void 0;let k=!d&&(N||y)||C||f;const w=function(e){const t=(0,s.li)();let i=!1;(0,$.A)(()=>{if(i=!0,t.current=void 0,!e)return;const s=new Image;if(s.src=e,!s.width)return;const n=(0,z.PR)(s);(0,j.A)(n.getContext("2d"),0,0,n.width,n.height,2,2),t.current=n.toDataURL()},[e]);const n=function(e,t=!1,i){const n=(0,s.li)(e?H.get(e):void 0),o=(0,s.li)(),a=(0,M.A)();return o.current&&t&&(clearTimeout(o.current),o.current=void 0),(0,s.vJ)(()=>{if(!e||n.current||t)return;const s=new Image;s.onload=()=>{const t=(0,z.PR)(s);(0,j.A)(t.getContext("2d"),0,0,t.width,t.height,2,2);const i=t.toDataURL();n.current=i,a(),H.size>=1e3&&H.clear(),H.set(e,i)},i?o.current=window.setTimeout(()=>{s.src=e},i):s.src=e},[e,i,a,t]),n.current}(e||void 0,Boolean(t.current));return t.current||!i&&n||e||void 0}(!k&&e&&(0,l.VD)(e));k||i===o.TQ.SearchResult||(k=w),r&&C&&(k=C);const I=N||y||(r||d?void 0:C||f||k),P=e&&(0,l.si)(e),Y=(0,s.Kr)(()=>t?r?g._e:g.cf:c?e.mediaSize||Q:h?(0,l.Xn)(e):d?(0,l.NZ)(e):Q,[t,c,h,d,r,e]);return{getMediaHash:A,media:e,isVideo:d,isPhoto:h,isGif:m,isDocument:c,bestImageData:k,bestData:I,dimensions:Y,contentType:v,isVideoAvatar:r,loadProgress:S,mediaSize:P}};var X=i(64493),ee=i(40664),te=i(22337),ie=i(1087),se=i(20021);const ne=(0,s.ph)(({isOpen:e,peerId:t,photo:i,onClose:o,onCloseAnimationEnd:a})=>{const{reportProfilePhoto:r}=(0,n.ko)(),[l,c]=(0,s.J0)("spam"),[d,h]=(0,s.J0)(""),m=(0,T.A)(()=>{r({chatId:t,photo:i,reason:l,description:d}),o()}),u=(0,T.A)(e=>{c(e)}),p=(0,T.A)(e=>{h(e.target.value)}),v=(0,B.A)(),g=(0,s.Kr)(()=>[{value:"spam",label:v("lng_report_reason_spam")},{value:"violence",label:v("lng_report_reason_violence")},{value:"pornography",label:v("lng_report_reason_pornography")},{value:"childAbuse",label:v("lng_report_reason_child_abuse")},{value:"copyright",label:v("ReportPeer.ReasonCopyright")},{value:"illegalDrugs",label:"Illegal Drugs"},{value:"personalDetails",label:"Personal Details"},{value:"other",label:v("lng_report_reason_other")}],[v]);if(!t||!i)return;const A=v("ReportPeer.Report");return(0,se.FD)(te.A,{isOpen:e,onClose:o,onEnter:e?m:void 0,onCloseAnimationEnd:a,className:"narrow",title:A,children:[(0,se.Y)(ie.A,{className:"dialog-checkbox-group",name:"report-message",options:g,onChange:u,selected:l}),(0,se.Y)(ee.A,{label:v("lng_report_reason_description"),value:d,onChange:p}),(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:m,children:v("lng_report_button")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:o,children:v("Cancel")})]})]})});var oe=i(26607),ae=i(41036);const[re,le]=(0,R.n5)(1);function ce(){return(0,s._W)(()=>{le(1)}),[re,le]}const de=(0,s.ph)(({isOpen:e,photo:t,profileId:i,onClose:o,onConfirm:a})=>{const{deleteProfilePhoto:r,deleteChatPhoto:l}=(0,n.ko)(),c=(0,s.hb)(()=>{a?.(),(0,v.L8)(i)?r({photo:t}):l({photo:t,chatId:i}),o()},[a,i,o,r,t,l]),d=(0,B.A)();return(0,se.Y)(te.A,{isOpen:e,onClose:o,onEnter:c,className:"delete dialog-buttons-column",title:d("AreYouSure"),children:(0,se.FD)("div",{className:"dialog-buttons mt-2",children:[(0,se.Y)(X.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:c,children:d("Preview.DeletePhoto")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:o,children:d("Cancel")})]})})});var he=i(18276),me=i(22699),ue=i(24433),pe=i(35913);const ve=(0,s.ph)((0,n.EK)((e,{item:t,canUpdateMedia:i})=>{const s=(0,c.nTw)(e),{origin:n}=s.mediaViewer,o="message"===t?.type?t.message:void 0,a="avatar"===t?.type?t.avatarOwner:void 0,r="avatar"===t?.type&&t.profilePhotos.photos[t.mediaIndex],l=(0,c.meB)(e),d=(0,c.Xf0)(e),{threadId:h}=(0,c.Xf0)(e)||{},m=(0,c.ynf)(e,o),u=(0,c.yuw)(e),p=o&&(0,c.ryq)(e,o?.chatId),{canDelete:v}=h&&o&&(0,c.WAX)(e,o,h)||{},g=r&&r.id===a?.avatarPhotoId,A=i&&Boolean(r),f=v||A,C=i&&Boolean(r)&&!g,y=d?.type;return{activeDownloads:u,isProtected:m,chat:l,isChatProtected:p,canDelete:f,canUpdate:C,messageListType:y,origin:n,viewableMedia:b(e,0,t)}})(({item:e,mediaData:t,isVideo:i,chat:o,isChatProtected:a,isProtected:r,canReportAvatar:c,canDelete:d,canUpdate:h,messageListType:m,activeDownloads:u,origin:p,viewableMedia:g,onReportAvatar:A,onCloseMediaViewer:f,onBeforeDelete:b,onForward:C})=>{const[y,S,N]=(0,D.A)(!1),[k,w]=ce(),{isMobile:I}=(0,Y.Ay)(),{downloadMedia:P,cancelMediaDownload:F,updateProfilePhoto:M,updateChatPhoto:L,openMediaViewer:R,openDeleteMessageModal:x}=(0,n.ko)(),E="message"===e?.type,{media:V}=g||{},_=V&&(0,l.sd)(V),U=V&&(0,l.$r)(u,V),{loadProgress:O}=(0,W.A)(V&&(0,l.VO)(V,"download"),!U,V&&(0,l.Cz)(V,"download")),K=(0,T.A)(()=>{if(V)if(U)F({media:V});else{const t="message"===e?.type?e.message:void 0;P({media:V,originMessage:t})}}),J=(0,T.A)(()=>{const e=k();w((e<0?e:0)-1)}),G=(0,T.A)(()=>{const e=k();w((e>0?e:0)+1)}),j=(0,T.A)(()=>{if("avatar"!==e?.type)return;const{avatarOwner:t,profilePhotos:i,mediaIndex:s}=e,n=i?.photos[s];(0,v.L8)(t.id)?M({photo:n}):L({chatId:t.id,photo:n}),R({origin:p,chatId:t.id,mediaIndex:0,isAvatarView:!0},{forceOnHeavyAnimation:!0})}),z=(0,B.A)(),H=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",className:t?"active":void 0,onClick:e,ariaLabel:"More actions",iconName:"more"}),[]);function $(){return"avatar"===e?.type?(0,se.Y)(de,{isOpen:y,onClose:N,onConfirm:b,profileId:e.avatarOwner.id,photo:e.profilePhotos.photos[e.mediaIndex]}):void 0}const q=(0,T.A)(()=>{"message"===e?.type&&o?x({chatId:o?.id,messageIds:[e.message.id],isSchedule:"scheduled"===m,onConfirm:b}):S()});if(I){const s=[];if(E&&e.message.isForwardingAllowed&&!e.message.content.action&&!a&&s.push({icon:"forward",onClick:C,children:z("Forward")}),r||(i?s.push({icon:U?"close":"download",onClick:K,children:U?`${Math.round(100*O)}% Downloading...`:"Download"}):s.push({icon:"download",href:t,download:_,children:z("AccActionDownload")})),c&&s.push({icon:"flag",onClick:A,children:z("ReportPeer.Report")}),h&&s.push({icon:"copy-media",onClick:j,children:z("ProfilePhoto.SetMainPhoto")}),d&&s.push({icon:"delete",onClick:q,children:z("Delete"),destructive:!0}),0===s.length)return;return(0,se.FD)("div",{className:"MediaViewerActions-mobile",children:[(0,se.Y)(me.A,{trigger:H,positionX:"right",children:s.map(({icon:e,onClick:t,href:i,download:s,children:n,destructive:o})=>(0,se.Y)(ue.A,{icon:e,href:i,download:s,onClick:t,destructive:o,children:n},e))}),U&&(0,se.Y)(pe.A,{progress:O,size:"s",noCross:!0}),d&&$()]})}return(0,se.FD)("div",{className:"MediaViewerActions",children:[E&&e.message.isForwardingAllowed&&!a&&(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("Forward"),onClick:C,iconName:"forward"}),function(){if(!r&&"standalone"!==e?.type)return"sponsoredMessage"!==e?.type&&(i?(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("AccActionDownload"),onClick:K,children:U?(0,se.Y)(pe.A,{progress:O,size:"s",onClick:K}):(0,se.Y)(he.A,{name:"download"})}):(0,se.Y)(X.A,{href:t,download:_,round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("AccActionDownload"),iconName:"download"}))}(),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("MediaZoomOut"),onClick:J,iconName:"zoom-out"}),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("MediaZoomIn"),onClick:G,iconName:"zoom-in"}),c&&(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z(i?"PeerInfo.ReportProfileVideo":"PeerInfo.ReportProfilePhoto"),onClick:A,iconName:"flag"}),h&&(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("ProfilePhoto.SetMainPhoto"),onClick:j,iconName:"copy-media"}),d&&(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("Delete"),onClick:q,iconName:"delete"}),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("Close"),onClick:f,iconName:"close"}),d&&$()]})}));var ge=i(87357),Ae=i(50442),fe=i(43336),be=i(37836),Ce=i(14737),ye=i(16581),Se=i(19129),Ne=i(26072),ke=i(15283);function we(e){const t=(0,s.li)(e());return(0,ke.A)(()=>e.subscribe(()=>{t.current=e()})),t}var Ie=i(90423),Pe=i(39751),Ye=i(83414);const[Fe,De]=(0,R.n5)(!1),[Me,Te]=(0,R.n5)(!1);function Be(){return[(0,Ye.A)(()=>Fe()&&!Me(),[Fe,Me]),De,Te]}var Le=i(56494);const[Re,xe]=(0,R.n5)(0);function Ee(){return(0,s._W)(()=>{xe(0)}),[Re,xe]}var Ve=i(5718),_e=i(672),Ue=i(57474);const Oe=({text:e="",buttonText:t,isForVideo:i,onClick:n,handleSponsoredClick:o,isProtected:a,isForceMobileVersion:r})=>{const[l,c]=(0,s.J0)(!1),{isMobile:d}=(0,Y.Ay)(),[h]=Be(),u=(0,Se.A)(()=>!!m.TF&&!h(),[h]);(0,s.vJ)(()=>{const e=document.querySelector(".MediaViewerFooter .media-text"),t=()=>{const t=e?e.clientHeight:0;c(t>2*g.$)};t();const i=(0,be.nF)(t,500,!0);return window.addEventListener("resize",i,!1),()=>{window.removeEventListener("resize",i,!1)}},[]);const p=(0,T.A)(()=>{o()}),v=(0,ge.A)("MediaViewerFooter",i&&"is-for-video",u&&"is-hidden",a&&"is-protected",r&&"mobile");return(0,se.FD)("div",{className:v,onClick:function(t){e&&t.stopPropagation()},children:[Boolean(e)&&(0,se.Y)("div",{className:"media-viewer-footer-content",onClick:d?void 0:n,children:(0,se.Y)("p",{className:"media-text custom-scroll allow-selection "+(l?"multiline":""),dir:"auto",children:e})}),Boolean(t)&&(0,se.Y)(X.A,{className:(0,ge.A)("media-viewer-footer-content","media-viewer-button"),size:"default",color:"primary",isRectangular:!0,onClick:p,children:t})]})};var Ke=i(15640),Je=i(84313),Ge=i(71533),je=i(50680),ze=i(73622);const[He,$e]=(0,R.n5)(!1);function qe(){return(0,s._W)(()=>{$e(!1)}),[He,$e]}var We=i(17663),Qe=i(70832),Ze=i(71429),Xe=i(82497),et=i(61433),tt=i(95807);class it{constructor(e){const[t,i,s,...n]=e.split("\n"),o=Number.parseFloat(i.split("=")[1]),a=Number.parseFloat(s.split("=")[1]);if(Number.isNaN(o)||Number.isNaN(a))throw new Error("Invalid storyboard map frame size");if(this.frames=n.map(e=>{if(!e.trim().length)return;const[t,i,s]=e.split(","),n={time:Number.parseFloat(t),left:Number.parseInt(i,10),top:Number.parseInt(s,10),width:o,height:a};if(Number.isNaN(n.time)||Number.isNaN(n.left)||Number.isNaN(n.top))throw new Error("Invalid storyboard map data");return n}).filter(Boolean),0===this.frames.length)throw new Error("Missing frames in storyboard map data")}getNearestPreview(e){let t=0,i=this.frames.length-1;for(;t<=i;){const s=Math.floor((t+i)/2);this.frames[s].time<=e?t=s+1:i=s-1}return this.frames[Math.max(0,t-1)]}}var st=i(63988);const nt="Od9ZSc1U";let ot;const at=(0,s.ph)(({storyboardInfo:e,duration:t,bufferedRanges:i,isReady:n,playbackRate:o,isActive:c,isPlaying:d,onSeek:h,onSeekStart:u})=>{const p=(0,s.li)(),[v]=Ee(),[g]=qe(),A=(0,st.aG)(v,250),[f,b]=(0,s.Ul)(A()),[y,S]=(0,s.Ul)(0),[N,k]=(0,s.Ul)(0),w=(0,s.li)(!1),[I,P]=(0,s.J0)(!1),[Y,F]=(0,s.J0)(!1),D=(0,s.li)(),M=(0,s.li)(),B=(0,s.li)(),L=(0,s.li)(),R=(0,s.li)(),x=e&&(0,l.mr)(e.storyboardFile,"full"),E=e&&(0,l.mr)(e.storyboardMapFile,"full"),V=(0,q.A)(x,!n),_=(0,q.A)(E,!n,G.qZ.Text);(0,s.vJ)(()=>{P(!1)},[c]),(0,s.vJ)(()=>{if(_)try{R.current=new it(_)}catch(e){a.Oig&&console.error("Error parsing storyboard map data",e,_)}},[_]);const U=(0,T.A)(e=>{const t=D.current;if(!R.current||!t)return;const i=R.current.getNearestPreview(e);k(Math.floor(i.time)),(0,r.RK)(()=>{(0,et.Tv)(t,{backgroundPosition:`${-i.left}px ${-i.top}px`})})});return(0,s.vJ)(()=>{if(ot&&ot(),ot=void 0,!w.current&&!Y){const e=A(),i=t-e;ot=(0,C.Hd)({from:e,to:t,duration:1e3*i/o,onUpdate:b})}},[A,Y,b,o,t]),(0,s.vJ)(()=>{d&&!g()||(ot&&ot(),ot=void 0)},[d,f,g]),(0,s.vJ)(()=>{if(d){ot&&ot(),ot=void 0;const e=A(),i=t-e;ot=(0,C.Hd)({from:e,to:t,duration:1e3*i/o,onUpdate:b})}},[d,o,t]),(0,s.Nf)(()=>{if(!B.current)return;const e=(0,fe.LI)(f()/t*100,2);B.current.style.width=`${e}%`},[f,t]),(0,s.Nf)(()=>{M.current&&(M.current.style.left=`${y()}px`)},[y]),(0,s.Nf)(()=>{L.current&&(L.current.innerText=(0,We.QO)(N()))},[N]),(0,s.vJ)(()=>{if(!p.current||!c)return;const i=p.current;let s=i.getBoundingClientRect(),n=0,o=0;const a=n=>{const o=(0,Ke.A)(n).x,a=(0,fe.qE)(t*((o-s.left)/s.width),0,t);if(!e)return[a,0];s.width||(s=i.getBoundingClientRect());const r=M.current;return[a,(0,fe.qE)(o-s.left-r.clientWidth/2,-4,s.width-r.clientWidth+4)]},r=()=>{ot&&ot(),ot=void 0},l=()=>{r(),w.current=!0,P(!1),F(!1),b(n),h(n),setTimeout(()=>{w.current=!1},250)},d=(0,Ae.wJ)(i,{onCapture:()=>{r(),P(!0),F(!0),u()},onRelease:l,onClick:l,onDrag:e=>{r(),P(!0),[n,o]=a(e),U(n),S(o),b(n)}});if(m.TF)return d;const v=e=>{P(!0),[n,o]=a(e),S(o),U(n)},g=()=>{P(!1)};return i.addEventListener("mousemove",v),i.addEventListener("mouseenter",v),i.addEventListener("mouseleave",g),()=>{d(),i.removeEventListener("mousemove",v),i.removeEventListener("mouseenter",v),i.removeEventListener("mouseleave",g)}},[t,U,c,h,u,S,b,F,I,o,e]),(0,se.FD)("div",{className:"ingarEvU",ref:p,children:[e&&(0,se.FD)(oe.A,{isOpen:!0,isHidden:!I,className:"TqpEWfl3",style:`width: ${e.frameSize.width}px; height: ${e.frameSize.height}px`,ref:M,children:[(0,se.Y)("div",{ref:D,style:(0,tt.A)(`background-image: url(${V});`),className:"k3Ytd13f"}),(0,se.Y)("div",{className:"bGiNvx5D",children:(0,se.Y)("span",{className:"mnkqvOMR",ref:L})})]}),(0,se.Y)("div",{className:nt,children:i.map(({start:e,end:t})=>(0,se.Y)("div",{className:"ANe2DKfp",style:`left: ${100*e}%; right: ${100-100*t}%`},`${e}-${t}`))}),(0,se.Y)("div",{className:nt,children:(0,se.Y)("div",{ref:B,className:(0,ge.A)("igaGLblf",Y&&"beUP6SqY")})})]})}),rt=e=>{e.stopPropagation()},lt=[.5,1,1.5,2];function ct(e,t){return(0,se.Y)("div",{className:"player-time",children:`${(0,We.QO)(e)} / ${(0,We.QO)(t)}`})}const dt=(0,s.ph)(({storyboardInfo:e,bufferedRanges:t,bufferedProgress:i,duration:n,isReady:o,fileSize:a,isForceMobileVersion:r,isPlaying:l,isFullscreenSupported:c,isFullscreen:d,isBuffered:h,volume:u,isMuted:p,playbackRate:v,isPictureInPictureSupported:g,onChangeFullscreen:A,onVolumeClick:f,onVolumeChange:b,onPlaybackRateChange:C,onPictureInPictureChange:y,onPlayPause:S,onSeek:N,onSeekingChange:k})=>{const[w,I,P]=(0,D.A)(),[F]=Ee(),M=(0,Se.A)(()=>Math.trunc(F()),[F]),[L,R]=(0,s.Ul)(!1),x=(0,s.li)(),{isMobile:E}=(0,Y.Ay)(),[V,_]=Be(),U=(0,Se.A)(V);(0,s.vJ)(()=>{if(m.TF||r){if(U&&l&&!w&&!L())return x.current=window.setTimeout(()=>{_(!1)},3e3),()=>{x.current&&window.clearTimeout(x.current)};x.current&&window.clearTimeout(x.current)}},[l,U,_,w,L,r]),(0,s.Nf)(()=>(U?document.body.classList.add("video-controls-visible"):document.body.classList.remove("video-controls-visible"),()=>{document.body.classList.remove("video-controls-visible")}),[U]),(0,s.vJ)(()=>{U||P()},[P,U]);const O=(0,B.A)(),K=(0,T.A)(e=>{R(!1),N(e),k(!1)}),J=(0,T.A)(()=>{R(!0),k(!0)}),G=(0,s.Kr)(()=>0===u||p?"muted":u<.3?"volume-1":u<.6?"volume-2":"volume-3",[u,p]);return(0,se.FD)("div",{className:(0,ge.A)("VideoPlayerControls",r&&"mobile",U&&"active"),onClick:rt,children:[(0,se.Y)(at,{storyboardInfo:e,duration:n,isReady:o,isPlaying:l,bufferedRanges:t,playbackRate:v,onSeek:K,onSeekStart:J,isActive:U}),(0,se.FD)("div",{className:"buttons",children:[(0,se.Y)(X.A,{ariaLabel:O("AccActionPlay"),size:"tiny",ripple:!E,color:"translucent-white",className:"play",round:!0,onClick:S,iconName:l?"pause":"play"}),(0,se.Y)(X.A,{ariaLabel:"Volume",size:"tiny",color:"translucent-white",className:"volume",round:!0,onClick:f,iconName:G}),!m.pz&&(0,se.Y)(Xe.A,{bold:!0,className:"volume-slider",value:p?0:100*u,onChange:b}),ct(M,n),!h&&(0,se.Y)("div",{className:"player-file-size",children:(0,se.Y)(Qe.A,{size:a,progress:i})}),(0,se.Y)("div",{className:"spacer"}),(0,se.Y)(X.A,{ariaLabel:"Playback rate",size:"tiny",color:"translucent-white",className:"playback-rate",round:!0,onClick:I,children:`${v}x`}),g&&(0,se.Y)(X.A,{ariaLabel:"Picture in picture",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:y,iconName:"pip"}),c&&(0,se.Y)(X.A,{ariaLabel:"Fullscreen",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:A,iconName:d?"smallscreen":"fullscreen"})]}),(0,se.Y)(Ze.A,{isOpen:w,className:(0,ge.A)("playback-rate-menu",!c&&"no-fullscreen",!g&&"no-pip"),positionX:"right",positionY:"bottom",autoClose:!0,onClose:P,children:lt.map(e=>(0,se.Y)(ue.A,{disabled:v===e,onClick:()=>C(e),children:`${e}x`}))})]})}),ht=(0,s.ph)(({url:e,storyboardInfo:t,isGif:i,posterData:o,posterSize:r,loadProgress:l,fileSize:c,isMediaViewerOpen:d,noPlay:h,volume:u,isMuted:p,playbackRate:v,isForceMobileVersion:g,shouldCloseOnClick:A,isProtected:f,isClickDisabled:b,isSponsoredMessage:C,timestamp:S,handleSponsoredClick:N,onClose:k})=>{const{setMediaViewerVolume:w,setMediaViewerMuted:I,setMediaViewerPlaybackRate:P,setMediaViewerHidden:F}=(0,n.ko)(),D=(0,s.li)(),[M,B]=(0,s.J0)(!m.TF||!m.pz),[R,x,V]=(0,Ie.Ay)(D,B),{isMobile:O}=(0,Y.Ay)(),K=D.current?.duration||0,J=i||K<=30,G=(0,T.A)(()=>{m.Nd||F({isHidden:!0})}),j=(0,T.A)(()=>{m.Nd||F({isHidden:!1})}),[z,H,$]=function(e,t,i){const[n,o]=(0,s.J0)(!1),[r,l]=(0,s.J0)(!1);(0,s.Nf)(()=>{if(m.pz&&m._7||!e.current)return;const s=e.current,n=_(s);if((!document.pictureInPictureEnabled||e.current?.disablePictureInPicture)&&void 0===n)return;s.autoPictureInPicture=!0,o(!0);const a=()=>{t(),l(!0),E(!0)},r=()=>{E(!1),l(!1),i()};return s.addEventListener("enterpictureinpicture",a),s.addEventListener("leavepictureinpicture",r),()=>{s.removeEventListener("enterpictureinpicture",a),s.removeEventListener("leavepictureinpicture",r)}},[e,t,i]);const c=(0,s.hb)(()=>{if(!e.current)return;const t=_(e.current);t?t("inline"):U()},[e]),d=(0,s.hb)(()=>{if(!e.current)return;c();const t=e.current,i=(0,L.e)(t),s=_(t);s?s("picture-in-picture"):function(e){if(e.requestPictureInPicture)try{e.requestPictureInPicture()}catch(e){a.Oig&&console.log("[MV] PictureInPicture Error",e)}}(t),i&&(0,L.A)(t)},[e,c]);return n?[n,d,r]:[!1]}(D,G,j),[,q,W]=Be(),[Q,Z]=(0,s.Ul)(!1),ee=(0,s.li)({x:0,y:0});(0,s.vJ)(()=>{const e=e=>{ee.current=(0,Ke.A)(e)};return window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}},[]);const te=(0,T.A)((e,t)=>{const i=D.current?.getBoundingClientRect();i&&(e<=i.left||e>=i.right||t<=i.top||t>=i.bottom)&&(Q()||q(!1))}),ie=(0,T.A)(()=>{q(!0)}),ne=(0,T.A)(e=>{te(e.clientX,e.clientY)}),oe=(0,T.A)(e=>{if(Z(e),!e){const{x:e,y:t}=ee.current;te(e,t)}}),{isReady:ae,isBuffered:re,bufferedRanges:le,bufferingHandlers:ce,bufferedProgress:de}=(0,Ge.A)(),he=(0,Je.A)(D,void 0,!e),{shouldRender:me,transitionClassNames:ue}=(0,je.A)(!re&&!he,void 0,void 0,"slow"),{shouldRender:ve,transitionClassNames:ge}=(0,je.A)(m.pz&&!M&&!me&&!he,void 0,void 0,"slow"),[,Ae]=Ee(),[,be]=qe();(0,s.vJ)(()=>{W(me)},[W,me]),(0,s.vJ)(()=>{h||!d||he?D.current.pause():e&&!m.TF&&(0,L.A)(D.current)},[h,d,e,I,he]),(0,s.vJ)(()=>{D.current.volume=u},[u]),(0,s.vJ)(()=>{D.current.playbackRate=v},[v]),(0,s.vJ)(()=>{S&&(D.current.currentTime=S,Ae(S))},[Ae,S]);const Ce=(0,T.A)(e=>{e.stopPropagation(),M?(D.current.pause(),B(!1)):((0,L.A)(D.current),B(!0))}),ye=(0,T.A)(e=>{C&&(N?.(!0),k(e)),b||(A?k(e):Ce(e))});(0,ze.A)(D,ce);const Se=(0,T.A)(e=>{const t=e.currentTarget;t.readyState>=4&&(be(!1),Ae(t.currentTime)),J||t.currentTime!==t.duration||(Ae(0),B(!1))}),Ne=(0,T.A)(()=>{J||(Ae(0),B(!1),q(!0))}),ke=(0,T.A)(()=>{R&&V?V():!R&&x&&x()}),we=(0,T.A)(e=>{D.current.currentTime=e}),Pe=(0,T.A)(e=>{w({volume:e/100})}),Ye=(0,T.A)(()=>{D.current.muted=!D.current.muted,I({isMuted:!p})}),Fe=(0,T.A)(e=>{P({playbackRate:e})});(0,s.vJ)(()=>{if(!d)return;const e=e=>{if(!R)return;const t=D.current,i=(0,fe.qE)(t.currentTime+5*e,0,t.duration);Number.isFinite(i)&&(t.currentTime=i)},t=t=>{if(!$)switch(t.key){case" ":case"Enter":t.preventDefault(),Ce(t);break;case"Left":case"ArrowLeft":t.preventDefault(),e(-1);break;case"Right":case"ArrowRight":t.preventDefault(),e(1)}};return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)}},[Ce,d,R,$]);const De=r&&`width: ${r.width}px; height: ${r.height}px`,Me=`background-image: url(${o})`,Te=!m.TF&&!g;return(0,se.FD)("div",{className:"VideoPlayer",onMouseMove:Te?ie:void 0,onMouseLeave:Te?ne:void 0,children:[(0,se.FD)("div",{style:De,children:[f&&(0,se.Y)("div",{onContextMenu:y.A,onDoubleClick:m.TF?void 0:ke,onClick:O?void 0:Ce,className:"protector"}),(0,se.Y)("video",{ref:D,autoPlay:m.TF,controlsList:"nodownload",playsInline:!0,loop:J,muted:i||p,id:"media-viewer-video",style:Me,onWaiting:()=>be(!0),onPlay:()=>B(!0),onEnded:Ne,onClick:O||R?void 0:ye,onDoubleClick:m.TF?void 0:ke,...ce,onPause:e=>{B(!1),ce.onPause(e)},onTimeUpdate:Se,src:e})]}),ve&&(0,se.Y)(X.A,{round:!0,className:`play-button ${ge}`,onClick:Ce,iconName:"play"}),me&&(0,se.FD)("div",{className:["spinner-container",ue].join(" "),children:[!re&&(0,se.Y)("div",{className:"buffering",children:"Buffering..."}),(0,se.Y)(pe.A,{size:"xl",progress:re?1:l,onClick:k})]}),!i&&!C&&!he&&(0,se.Y)(dt,{storyboardInfo:t,isPlaying:M,bufferedRanges:le,bufferedProgress:de,isBuffered:re,isFullscreenSupported:Boolean(x),isPictureInPictureSupported:z,isFullscreen:R,fileSize:c,duration:K,isReady:ae,isForceMobileVersion:g,onSeek:we,onChangeFullscreen:ke,onPictureInPictureChange:H,onPlayPause:Ce,volume:u,playbackRate:v,isMuted:p,onVolumeClick:Ye,onVolumeChange:Pe,onPlaybackRateChange:Fe,onSeekingChange:oe})]})}),mt=(0,s.ph)((0,n.EK)((e,{item:t})=>{const{volume:i,isMuted:s,playbackRate:n,isHidden:o,origin:a,timestamp:r,threadId:l}=(0,c.nTw)(e).mediaViewer,d="message"===t.type?t.message:void 0,h="sponsoredMessage"===t.type?t.message:void 0,m=d||h,u=b(e,0,t),p=d&&(0,Le.me)(e,d,!0);return{origin:a,textMessage:m,isProtected:d&&(0,c.ynf)(e,d),volume:i,isMuted:s,isHidden:o,playbackRate:n,threadId:l,timestamp:r,maxTimestamp:p,viewableMedia:u}})(({item:e,viewableMedia:t,isActive:i,textMessage:s,origin:o,withAnimation:r,isProtected:l,volume:c,playbackRate:d,isMuted:h,isHidden:u,isMoving:p,threadId:v,timestamp:f,maxTimestamp:b,onClose:C,onFooterClick:y,handleSponsoredClick:S})=>{const{updateLastPlaybackTimestamp:N}=(0,n.ko)(),k=(0,B.A)(),w="avatar"===e.type,I="sponsoredMessage"===e.type,{media:P}=t||{},{isVideo:F,isPhoto:D,bestImageData:M,bestData:L,dimensions:R,isGif:x,isVideoAvatar:E,mediaSize:V,loadProgress:_}=Z({media:P,isAvatar:w,origin:o,delay:!!r&&350}),[,U]=Be(),[O]=Ee(),K=Boolean(P),{isMobile:J}=(0,Y.Ay)(),G=(0,T.A)(()=>{U(!0)}),j=(0,_e.A)(()=>{if(!i||!s||"video"!==P?.mediaType)return;if(P.duration<a.u4b)return;const e="id"in s?s:void 0,t=O();if(!t||!e||e.isInAlbum)return;const n=P.duration-t>1?t:void 0;N({chatId:e.chatId,messageId:e.id,timestamp:n})},[O,i,P,s],1e3);if((0,Ve.R)(j,[O]),!P)return;if("avatar"===e.type)return E?(0,se.Y)("div",{className:"MediaViewerContent",children:(0,se.Y)(ht,{url:L,isGif:!0,posterData:M,posterSize:(0,g.sk)(R,!1,!0),loadProgress:_,fileSize:V,isMediaViewerOpen:K&&i,isProtected:l,noPlay:!i,onClose:C,isMuted:!0,shouldCloseOnClick:!0,volume:0,isClickDisabled:p,playbackRate:1,isSponsoredMessage:I,handleSponsoredClick:S},P.id)},P.id):(0,se.Y)("div",{className:"MediaViewerContent",children:ut(L,(0,g.sk)(R,!1),!J&&!l,l)},P.id);const z=s&&(s.content.action?"suggestProfilePhoto"===s.content.action.type?k("Conversation.SuggestedPhotoTitle"):void 0:(0,A.V)({message:s,maxTimestamp:b,threadId:v,forcePlayback:!0,isForMediaViewer:!0})),H=s&&"buttonText"in s?s.buttonText:void 0,$=Boolean(z),q=(0,g.sk)(R,$,F),W=J||function(e){return!!e&&e.width<350}(q);return(0,se.FD)("div",{className:(0,ge.A)("MediaViewerContent",$&&"has-footer"),onMouseMove:W&&!m.TF?G:void 0,children:[D&&ut(L,q,!J&&!l,l),F&&(i?(0,se.Y)(ht,{url:L,storyboardInfo:"storyboardInfo"in P?P.storyboardInfo:void 0,isGif:x,posterData:M,posterSize:q,loadProgress:_,fileSize:V,isMediaViewerOpen:K&&i,noPlay:!i,onClose:C,isMuted:h,isHidden:u,isForceMobileVersion:W,isProtected:l,volume:c,isClickDisabled:p,playbackRate:d,isSponsoredMessage:I,handleSponsoredClick:S,timestamp:f},P.id):pt(M,q,!J&&!l,l)),z&&(0,se.Y)(Oe,{text:z,buttonText:H,onClick:y,isProtected:l,isForceMobileVersion:W,isForVideo:F&&!x,handleSponsoredClick:S})]})}));function ut(e,t,i,s){return e?(0,se.FD)("div",{style:"position: relative;",children:[s&&(0,se.Y)("div",{onContextMenu:y.A,className:"protector"}),(0,se.Y)("img",{src:e,alt:"",className:(0,ge.A)(s&&"is-protected"),style:t?`width: ${t.width}px`:"",draggable:Boolean(i)})]}):(0,se.Y)("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:"",children:(0,se.Y)(Ue.A,{color:"white"})})}function pt(e,t,i,s){const n=t&&`width: ${t.width}px; height: ${t.height}px`,o=`background-image: url(${e})`;return e?(0,se.FD)("div",{className:"VideoPlayer",children:[s&&(0,se.Y)("div",{onContextMenu:y.A,className:"protector"}),(0,se.Y)("div",{style:n,children:(0,se.Y)("video",{style:o,className:(0,ge.A)(s&&"is-protected"),draggable:Boolean(i)})})]}):(0,se.Y)("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:"",children:(0,se.Y)(Ue.A,{color:"white"})})}const{easeOutCubic:vt,easeOutQuart:gt}=C.qM,At=m.TF?40:0,ft=350;let bt,Ct;var yt=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(yt||{});const St=(0,s.ph)(({item:e,isVideo:t,isGif:i,isOpen:n,withAnimation:o,isHidden:a,isLoadingMoreMedia:r,isSynced:l,loadMoreItemsIfNeeded:c,getNextItem:d,selectItem:h,onClose:u,onFooterClick:p,handleSponsoredClick:v})=>{const g=(0,s.li)(),A=(0,s.li)(),f=(0,s.li)(),b=(0,s.li)(),y=(0,s.li)({x:0,y:0,scale:1}),S=(0,s.li)(void 0),N=(0,s.li)(void 0),k=(0,s.li)(!1),[w,I]=(0,s.J0)(!0),[P]=ce(),Y=(0,s.li)(P()),F=(0,Ie.zk)(),[D,M]=(0,s.J0)(!1),[L,R]=(0,s.Ul)({x:0,y:0,scale:1}),x=we(L),[E,V]=(0,s.Ul)(e),_=we(E),U=(0,Se.A)(()=>1!==L().scale,[L]),O=(0,Se.A)(E),{height:K,width:J,isResizing:G}=(0,Pe.A)(),[j,z,H]=Be(),$=(0,B.A)();(0,Ne.A)({isActive:n,onBack:u,shouldBeReplaced:!0});const q=(0,ye.A)(h,[h],350,!0),W=(0,ye.A)(()=>{S.current=void 0},[],500,!0),Q=(0,ye.A)(e=>I(e),[],800,!0),Z=Boolean(i&&!m.pz),X=m.TF?40:J/10,ee=(0,T.A)(e=>{if(!m.TF)return;const t=K-e.pageY<80;!t&&e.pageX<X||!t&&e.pageX>J-X||z(!j())});(0,Ce.A)(()=>z(!0),ft),(0,s.vJ)(()=>{const{scale:t,x:i,y:s}=x.current;0===i&&0===s&&1===t&&V(e)},[e,V,x]),(0,s.vJ)(()=>{l&&O&&!r&&c(O)},[O,c,l,r]),(0,s.Nf)(()=>{const{x:e,y:t,scale:i}=L();H(1!==i),f.current&&(f.current.style.transform=Nt(-J+e-At)),A.current&&(A.current.style.transform=Nt(e,t,i)),b.current&&(b.current.style.transform=Nt(J+e+At))},[L,H,J]),(0,s.vJ)(()=>{if(!g.current||void 0===_.current||a||F)return;let e=y.current;const t={x:0,y:0},i={x:0,y:0},s={x:0,y:0};let n,r=Date.now();const l=(0,be.sg)(()=>{r=Date.now()},500,!1,!0),c=t=>{const i=_.current;if(void 0===i)return!1;const s=d(i,t);if(void 0!==s){const i=(J+At)*t,n=x.current.x+i;return I(!1),V(s),q(s),Q(!0),e={x:0,y:0,scale:1},o?(bt=(0,C.Hd)({from:n,to:0,duration:ft,timing:vt,onUpdate:e=>R({y:0,x:e,scale:1})}),!0):(R(e),!0)}return!1},h=e=>{const{scale:t}=x.current;if(1!==t)return[!1,!1];if(e.target.closest("div.VideoPlayerControls"))return[!1,!1];let i=0;return K-e.pageY<80?[!1,!1]:(e.pageX<X?i=-1:e.pageX>J-X&&(i=1),[0!==i,c(i)])},p=e=>{const{scale:t}=x.current;if(1===t)switch(e.key){case"Left":case"ArrowLeft":c(-1);break;case"Right":case"ArrowRight":c(1)}},v=({x:e,y:t,scale:i},s=0)=>{const n=N.current;if(!n)return[{x:e,y:t,scale:i},!0,!0];let o=!0,a=!0;const r=(J-J*i)/2,l=(K-K*i)/2,c=Math.max(-n.left*i,r),d=J-n.right*i;o=(0,fe.Bt)(e,d,c),e=(0,fe.qE)(e,d,c);const h=Math.max(-n.top*i+s,l),m=K-n.bottom*i;return a=(0,fe.Bt)(t,m,h),[{x:e,y:t=(0,fe.qE)(t,m,h),scale:i},o,a]},f=n=>{if(k.current)return void(k.current=!1);"mouseup"===n.type&&M(!1);const o=x.current,{y:a,scale:l}=o;let c=o.x;const h=Math.abs(c),m=Math.abs(a);if(W(),Q(!0),l<1)return e={x:0,y:0,scale:1},void(bt=(0,C.Hd)({from:[c,a,l],to:[0,0,1],duration:ft,timing:vt,onUpdate:e=>R({x:e[0],y:e[1],scale:e[2]})}));if(l>1){const o=Math.min(l,4),d=o/l;let h=c*d+(i.x-d*i.x),m=a*d+(i.y-d*i.y);const u=.15;if("wheel"!==n.type&&e.scale===l){const e=Math.abs(t.x)/(Date.now()-r),i=Math.abs(t.y)/(Date.now()-r);h-=Math.abs(t.x)*e*u*s.x,m-=Math.abs(t.y)*i*u*s.y}return[e]=v({x:h,y:m,scale:o},60),void(bt=(0,C.Hd)({from:[c,a,l],to:[e.x,e.y,e.scale],duration:ft,timing:vt,onUpdate:e=>R({x:e[0],y:e[1],scale:e[2]})}))}if(e={x:c,y:a,scale:l},m>=50)return void u();if(m>0)return void(bt=(0,C.Hd)({from:a,to:0,duration:ft,timing:vt,onUpdate:e=>R({x:0,y:e,scale:l})}));const p=c<0?1:-1,g=_.current,A=g&&d(g,c<0?1:-1),f=s.x<0?-1:1;void 0!==A&&h>=50&&p===f&&(c+=(J+At)*p,V(A),q(A)),bt=(0,C.Hd)({from:c,to:0,duration:ft,timing:vt,onUpdate:e=>R({y:0,x:e,scale:l??1})})},b=(0,Ae.wJ)(g.current,{isNotPassive:!0,withNativeDrag:!0,excludedClosestSelector:".MediaViewerFooter, .ZoomControls, .VideoPlayerControls",minZoom:1,maxZoom:4,doubleTapZoom:3,withWheelDrag:!0,onCapture:e=>{if(wt(e))return;const{x:t,y:i,scale:s}=x.current;if("mousedown"!==e.type||(M(!0),1===s)){if(r=Date.now(),0===t&&0===i&&1===s){if(!A.current)return;if(n=A.current.querySelector("img, video"),!n)return;N.current=n.getBoundingClientRect()}}else e.preventDefault()},onDrag:(i,n,{dragOffsetX:o,dragOffsetY:a},r)=>{if(k.current||wt(i))return;if(m.pz&&"touchstart"===n.type){const{pageX:e}=n.touches[0];if(e<=Ae.h6||e>=J-Ae.h6)return}bt&&(bt(),bt=void 0),s.x=t.x-o,s.y=t.y-a,t.x=o,t.y=a;const c=Math.abs(o),d=Math.abs(a),{x:h,y:u,scale:p}=x.current;if(l(),1!==p){const t=e.x+o,s=e.y+a;if(["wheel","mousemove"].includes(i.type)){const[e,i,n]=v({x:t,y:s,scale:p},60);return r&&r(!i,!n),void R(e)}return void("touches"in i&&1===i.touches.length&&R({x:t,y:s,scale:p}))}if("mousemove"!==i.type){if(S.current!==yt.Vertical&&(S.current===yt.Horizontal||Math.abs(h)>Ae.no||c/d>Ae.fG)){S.current=yt.Horizontal,I(!1);const e=J+At,t=(0,fe.qE)(o,-e,e);return R({x:t,y:0,scale:p}),void("wheel"===i.type&&Math.abs(t)>100&&(f(i),k.current=!0))}if(S.current===yt.Vertical||Math.abs(u)>Ae.no||d/c>Ae.fG){S.current=yt.Vertical;const e=K,t=(0,fe.qE)(a,-e,e);R({x:0,y:t,scale:p}),"wheel"===i.type&&Math.abs(t)>100&&(f(i),k.current=!0)}}},onZoom:(t,{zoom:s,zoomFactor:n,initialCenterX:o,initialCenterY:a,dragOffsetX:r,dragOffsetY:l,currentCenterX:c,currentCenterY:d})=>{bt&&bt(),o=o||J/2,a=a||K/2,c=c||J/2,d=d||K/2;const h=s??(0,fe.qE)(e.scale*n,.5,12),m=h/e.scale,u=Math.abs(Math.min(e.x,0)),p=Math.abs(Math.min(e.y,0));i.x=c,i.y=d;const g=u+o,A=p+a,f=g-m*g,b=A-m*A,[C]=v({x:e.x+f+r,y:e.y+b+l,scale:h});R(C)},onClick(t){M(!1);const[i,s]=h(t);if(i){if(t.preventDefault(),t.stopPropagation(),m.TF)return;s||u()}else 1!==e.scale||m.TF||!Z&&kt(t.target,".VideoPlayer")||u()},onDoubleClick(t,{centerX:i,centerY:s}){const[n]=h(t);if(n)return t.preventDefault(),void t.stopPropagation();if(!m.TF&&"wheel"!==t.type)return;const{x:o,y:a,scale:r}=x.current;if(1===r){if(0!==o||0!==a)return;e=v({x:i-3*i,y:s-3*s,scale:3})[0]}else e={x:0,y:0,scale:1};bt=(0,C.Hd)({from:[o,a,r],to:[e.x,e.y,e.scale],duration:ft,timing:vt,onUpdate:e=>{const t={x:e[0],y:e[1],scale:e[2]};R(t)}})},onRelease:f});return document.addEventListener("keydown",p,!1),()=>{b(),document.removeEventListener("keydown",p,!1)}},[_,W,X,d,F,a,u,q,V,Q,R,Z,x,K,J,o]),(0,s.vJ)(()=>{const e=P(),t=void 0!==Y.current&&Y.current!==e;if(!g.current||!t||a||F)return;Y.current=e;const{scale:i}=x.current,s=e>0?-1:1;let n=100,o=0;i<=.6&&s>0||i>=12&&s<0||(1===i&&s>0&&(n=20),Ct&&Ct(),Ct=(0,C.Hd)({from:s,to:s*n,duration:ft,timing:gt,onUpdate:e=>{if(!g.current)return;const t=(0,fe.LI)(e-o,2);o=e;const i=new WheelEvent("wheel",{deltaY:t,ctrlKey:!0});g.current.dispatchEvent(i)}}))},[P,a,F,x]);const[te,ie]=(0,s.Kr)(()=>void 0===O?[void 0,void 0]:[d(O,-1),d(O,1)],[O,d]);if(void 0===O)return;const ne=void 0!==te,oe=void 0!==ie,ae=D&&U;return(0,se.FD)("div",{className:"MediaViewerSlides",ref:g,children:[(0,se.Y)("div",{className:"MediaViewerSlide",ref:f,children:ne&&!U&&!G&&(0,se.Y)(mt,{withAnimation:o,isMoving:ae,item:te,onClose:u,onFooterClick:p,handleSponsoredClick:v})}),(0,se.Y)("div",{className:(0,ge.A)("MediaViewerSlide","MediaViewerSlide--active",ae&&"MediaViewerSlide--moving"),onClick:ee,ref:A,children:(0,se.Y)(mt,{item:O,withAnimation:o,isActive:w,isMoving:ae,onClose:u,onFooterClick:p,handleSponsoredClick:v})}),(0,se.Y)("div",{className:"MediaViewerSlide",ref:b,children:oe&&!U&&!G&&(0,se.Y)(mt,{withAnimation:o,isMoving:ae,item:ie,onClose:u,onFooterClick:p,handleSponsoredClick:v})}),ne&&!U&&!m.TF&&(0,se.Y)("button",{type:"button",className:`navigation prev ${t&&!i&&"inline"}`,"aria-label":$("AccDescrPrevious"),dir:$.isRtl?"rtl":void 0}),oe&&!U&&!m.TF&&(0,se.Y)("button",{type:"button",className:`navigation next ${t&&!i&&"inline"}`,"aria-label":$("Next"),dir:$.isRtl?"rtl":void 0})]})});function Nt(e=0,t=0,i=1){return`translate3d(${e.toFixed(3)}px, ${t.toFixed(3)}px, 0px) scale(${i.toFixed(3)})`}function kt(e,t){return!!e&&(!!e.matches(t)||Boolean(e.closest(t)))}function wt(e){const t=e.target;return!!kt(t,".VideoPlayerControls")&&(kt(t,".play, .fullscreen, .volume, .volume-slider, .playback-rate, .playback-rate-menu, .SeekLine")||e.preventDefault(),!0)}var It=i(70636),Pt=i(4961),Yt=i(21849);const Ft=(0,n.EK)((e,{item:t})=>{const i="message"===t?.type?t.message:void 0,s=i&&(0,c.Y7C)(e,i);return{owner:"avatar"===t?.type?t.avatarOwner:s}})(({owner:e,item:t})=>{const{closeMediaViewer:i,focusMessage:o,toggleChatInfo:a}=(0,n.ko)(),{isMobile:r}=(0,Y.Ay)(),c=(0,T.A)(()=>{if(i(),"message"!==t?.type)return;const e=t.message;r?setTimeout(()=>{a({force:!1},{forceSyncOnIOs:!0}),o({chatId:e.chatId,messageId:e.id})},350):o({chatId:e.chatId,messageId:e.id})}),d=(0,B.A)(),h=(0,s.Kr)(()=>{if(!t||"standalone"===t.type)return;const e="avatar"===t.type?t.avatarOwner:void 0,i="avatar"===t.type?t.profilePhotos:void 0,s=i?.photos[t.mediaIndex],n=s?.id===i?.fallbackPhoto?.id,o=s?.id===i?.personalPhoto?.id,a="message"===t.type?t.message.date:s?.date;if(!a)return;const r=(0,We.fS)(d,1e3*a,!0),c=i?.count&&i.count+(i?.fallbackPhoto?1:0),h=t.mediaIndex+1+(i?.personalPhoto?-1:0),m=c&&d("Of",[h,c]),u=[];if(s){const t=(0,v.L8)(e.id)?void 0:e,i=t&&(0,l.WX)(t),s=t&&(0,l.YE)(t);u.push(d(o?"lng_mediaview_profile_photo_by_you":n?"lng_mediaview_profile_public_photo":i?"lng_mediaview_channel_photo":s?"lng_mediaview_group_photo":"lng_mediaview_profile_photo"))}return!m||o||n||u.push(m),u.push(r),u.join(" â€¢ ")},[t,d]);if(!e)return;const m=(0,It.F9)(d,e);return(0,se.FD)("div",{className:"SenderInfo",onClick:c,children:[(0,se.Y)(Yt.A,{size:"medium",peer:e},e.id),(0,se.FD)("div",{className:"meta",children:[(0,se.Y)("div",{className:"title",dir:"auto",children:m&&(0,Pt.A)(m)}),(0,se.Y)("div",{className:"date",dir:"auto",children:h})]})]})}),Dt=250,Mt=(0,s.ph)((0,n.EK)(e=>{const{mediaViewer:t,shouldSkipHistoryAnimations:i}=(0,c.nTw)(e),{chatId:s,threadId:n,messageId:a,origin:r,isHidden:d,withDynamicLoading:h,standaloneMedia:m,mediaIndex:u,isAvatarView:p,isSponsoredMessage:g}=t,A=(0,c.xYJ)(e,"mediaViewerAnimations"),{currentUserId:C,isSynced:y}=e,S=Boolean(s)&&(0,c.nZ4)(e,s);if(p){const t=(0,c.PVB)(e,s);let o=!1;t&&(o=(0,v.L8)(t.id)?t.id===C:(0,l.SJ)(t));const p=(0,c.IVq)(e,s),g=f({avatarOwner:t,standaloneMedia:m,profilePhotos:p,mediaIndex:u}),N=b(e,0,g);return{profilePhotos:p,avatar:p?.photos[u],avatarOwner:t,isLoadingMoreMedia:p?.isLoading,isChatWithSelf:S,canUpdateMedia:o,withAnimation:A,origin:r,shouldSkipHistoryAnimations:i,isHidden:d,standaloneMedia:m,mediaIndex:u,isSynced:y,currentItem:g,viewableMedia:N,chatId:s,threadId:n,messageId:a,message:void 0,collectedMessageIds:void 0,chatMessages:void 0,sponsoredMessage:void 0,withDynamicLoading:h}}let N,k;s&&a&&(N=r&&[o.TQ.ScheduledAlbum,o.TQ.ScheduledInline].includes(r)?(0,c.Jl6)(e,s,a):(0,c.O5q)(e,s,a)),g&&s&&r===o.TQ.SponsoredMessage&&(k=(0,c.v8U)(e,s));const w=f({message:N,standaloneMedia:m,mediaIndex:u,sponsoredMessage:k}),I=b(e,0,w);let P;s&&(P=r&&[o.TQ.ScheduledAlbum,o.TQ.ScheduledInline].includes(r)?(0,c.yFI)(e,s):(0,c.zeq)(e,s));let Y=!1;const F=r===o.TQ.Inline,D=r===o.TQ.Album;let M;if(s&&n&&a)if(h&&(F||D)){const t=(0,c.CuV)(e);Y=Boolean(t?.isLoading);const{foundIds:i}=t?.currentSegment||{};M=i}else if(r===o.TQ.SharedMedia){const t=(0,c.BU_)(e),i=t?.resultsByType,s=I&&(0,l.JU)(I?.media),{foundIds:n}=s&&i?.[s]||{};M=n}else(F||D)&&(M=(0,c.Lzh)(e,s,n,a)||(0,c.gCU)(e,s,n));return{chatId:s,threadId:n,messageId:a,isChatWithSelf:S,origin:r,message:N,chatMessages:P,sponsoredMessage:k,collectedMessageIds:M,withAnimation:A,isHidden:d,shouldSkipHistoryAnimations:i,withDynamicLoading:h,standaloneMedia:m,mediaIndex:u,isLoadingMoreMedia:Y,isSynced:y,currentItem:w,viewableMedia:I,canUpdateMedia:void 0,avatar:void 0,avatarOwner:void 0,profilePhotos:void 0}})(({chatId:e,threadId:t,messageId:i,message:c,collectedMessageIds:f,isChatWithSelf:b,canUpdateMedia:y,origin:L,avatar:R,avatarOwner:x,profilePhotos:E,chatMessages:_,sponsoredMessage:G,standaloneMedia:j,mediaIndex:z,withAnimation:H,isHidden:$,shouldSkipHistoryAnimations:q,withDynamicLoading:W,isLoadingMoreMedia:Q,isSynced:ee,currentItem:te,viewableMedia:ie})=>{const{openMediaViewer:re,closeMediaViewer:le,openForwardMenu:ce,focusMessage:de,toggleChatInfo:he,searchChatMediaMessages:me,loadMoreProfilePhotos:ue,clickSponsored:pe,openUrl:ge}=(0,n.ko)(),Ae=Boolean(x||c||j||G),{isMobile:fe}=(0,Y.Ay)(),{media:be,isSingle:Ce}=ie||{},ye=(0,s.li)(),Se=c?.senderId||x?.id||c?.chatId,Ne=(0,K.A)(Se),ke=H?"slideFade":"none",we=Boolean(H&&!q),[Ie,Pe,Ye]=(0,D.A)(),{isVideo:Fe,isPhoto:De,bestImageData:Me,bestData:Te,dimensions:Be,isGif:Le,contentType:Re}=Z({media:be,isAvatar:Boolean(x),origin:L,delay:we&&Dt}),xe=(()=>{if(b)return!1;if("avatar"!==te?.type||!x)return!1;const e=te.profilePhotos;return be!==e.personalPhoto})(),Ee=(0,s.Kr)(()=>W?f:(0,l.lH)(_||{},f||[],Re||"media"),[_,f,Re,W]);!Ae||Ne&&Ne===Se&&void 0!==ye.current||(ye.current=Ce?0:i||z);const[Ve]=V;(0,s.vJ)(()=>{if(!Ae||Ve())return;(0,p.FD)();const e=(0,J.w4)();return()=>{e(),(0,p.wb)()}},[Ae,Ve]),(0,s.vJ)(()=>{$&&Ae||U()},[$,Ae]),(0,s.vJ)(()=>{fe&&(0,r.RK)(()=>{document.body.classList.toggle("is-media-viewer-open",Ae)})},[fe,Ae]);const _e=(0,M.A)();(0,s.vJ)(()=>{const e=window.matchMedia(g.wy);return e.addEventListener("change",_e),()=>{e.removeEventListener("change",_e)}},[_e]);const Ue=(0,O.A)(c),Oe=(0,O.A)(L),Ke=(0,O.A)(te),Je=(0,O.A)(Me),Ge=c?(0,A.V)({message:c,forcePlayback:!0,isForMediaViewer:!0}):void 0,je=Boolean(Ge);(0,F.A)(([e,t])=>{e===Ae&&t===$||(we&&Ae&&!Ke&&((0,s.VK)(Dt+a.xB5),function(e,t,i,s,n,l,c){const{mediaEl:d}=I(t,l,c);if(!d)return;const{width:h}=k.A.get(),{width:u,height:p}=(0,g.$w)(e,n),{width:v,height:A}=(0,g.ky)(u,p,s.width,s.height),f=(h-v)/2,b=function(e){const t=window.matchMedia(g.wy);let i=4.125;return e&&!m.TF&&(i+=t.matches?.875:2.125),i*g.$}(e)+(p-A)/2;let{top:y,left:S,width:N,height:Y}=d.getBoundingClientRect();if([o.TQ.SharedMedia,o.TQ.Album,o.TQ.ScheduledAlbum,o.TQ.SearchResult].includes(t)){const e=function(e,t,i,s,n,o){if(e===t){const a=Math.max(n,o)*(e/t);s-=(a-n)/2,i-=(a-o)/2,n=a,o=a}else if(e>t){const i=n;s-=((n=o*(e/t))-i)/2}else if(t>e){const s=o;i-=((o=n*(t/e))-s)/2}return{top:i,left:s,width:n,height:o}}(v,A,y,S,N,Y);y=e.top,S=e.left,N=e.width,Y=e.height}const F=S+N/2-(f+v/2),D=y+Y/2-(b+A/2),M=N/v,T=Y/A;(0,r.RK)(()=>{const e=w(i||d);(0,C.ZM)(e,{top:`${b}px`,left:`${f}px`,width:`${v}px`,height:`${A}px`,transform:`translate3d(${F}px, ${D}px, 0) scale(${M}, ${T})`}),P(e,t),document.body.appendChild(e),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{e.style.transform="",function(e){e.firstChild.style.objectFit="default",e.classList.remove("rounded-corners","circle")}(e),setTimeout(()=>{(0,r.RK)(()=>{document.body.contains(e)&&document.body.removeChild(e),document.body.classList.remove("ghost-animating")})},200+a.xB5)})})}(je,L,Me,Be,Fe,c,z)),we&&!Ae&&Ke&&((0,s.VK)(Dt+a.xB5),function(e,t,i,s){const{container:n,mediaEl:l}=I(e,i,s);if(!l)return;const c=document.getElementById("MediaViewer").querySelector(".MediaViewerSlide--active img, .MediaViewerSlide--active video");if(!c)return;const{top:d,left:h,width:m,height:u}=c.getBoundingClientRect(),{top:p,left:v,width:g,height:A}=l.getBoundingClientRect();let f=p;if(!(0,N.Y)(n)){const{height:e}=k.A.get();f=p<d?-A:e}const b=h+m/2-(v+g/2),y=d+u/2-(f+A/2);let Y=m/g,F=u/A;const D=[o.TQ.Inline,o.TQ.ScheduledInline,o.TQ.Album,o.TQ.ScheduledAlbum].includes(e)&&!function(e){const t=document.querySelector(".Transition_slide-active > .MessageList"),{top:i}=(0,S.A)(e,t);return i>t.scrollTop&&i+e.offsetHeight<t.scrollTop+t.offsetHeight}(l);[o.TQ.SharedMedia,o.TQ.Album,o.TQ.ScheduledAlbum,o.TQ.SearchResult].includes(e)&&(Y>F?Y=F:F>Y&&(F=Y));const M=document.getElementsByClassName("ghost")[0],T=M||w(t||l,e);let B;if(M){const{top:e,left:t,width:i,height:s}=M.getBoundingClientRect();B={transition:"none",top:`${f}px`,left:`${v}px`,transformOrigin:"top left",transform:`translate3d(${t-v}px, ${e-f}px, 0) scale(${i/g}, ${s/A})`,width:`${g}px`,height:`${A}px`}}else B={top:`${f}px`,left:`${v}px`,width:`${g}px`,height:`${A}px`,transform:`translate3d(${b}px, ${y}px, 0) scale(${Y}, ${F})`};(0,r.RK)(()=>{(0,C.ZM)(T,B),M||document.body.appendChild(T),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{M&&(M.style.transition=""),T.style.transform="",D&&(T.style.opacity="0"),P(T,e),setTimeout(()=>{(0,r.RK)(()=>{document.body.contains(T)&&document.body.removeChild(T),document.body.classList.remove("ghost-animating")})},200+a.xB5)})})}(Oe,Je,Ue,Ke?.mediaIndex)))},[Ae,$,Me,Be,je,we,Fe,c,L,Je,Ke,Ue,Oe,z]);const ze=(0,T.A)(()=>le()),He=(0,T.A)(s=>{s.target instanceof HTMLElement&&s.target.closest("a")||(ze(),e&&i&&(fe?setTimeout(()=>{he({force:!1},{forceSyncOnIOs:!0}),de({chatId:e,threadId:t,messageId:i})},Dt):de({chatId:e,threadId:t,messageId:i})))}),$e=(0,T.A)(t=>{G&&e&&(pe({isMedia:t,isFullscreen:!0,randomId:G.randomId}),ge({url:G.url}),le())}),qe=(0,T.A)(()=>{ce({fromChatId:e,messageIds:[i]})});(0,s.vJ)(()=>Ae?(0,u.A)(()=>{ze()}):void 0,[ze,Ae]),(0,s.vJ)(()=>{Fe&&!Le&&(0,d._K)()},[Le,Fe]);const We=(0,T.A)(i=>{if(i&&!Q){if("avatar"===i.type){if(!(i.mediaIndex>=i.profilePhotos.photos.length-4))return;ue({peerId:i.avatarOwner.id})}"message"===i.type&&W&&me({chatId:e,threadId:t,currentMediaMessageId:i.message.id})}}),Qe=(0,T.A)((e,t)=>{if(0===t||Ce)return;if("standalone"===e.type){const{media:i,mediaIndex:s}=e,n=s+t;return n>=0&&n<i.length?{type:"standalone",media:i,mediaIndex:n}:void 0}if("avatar"===e.type){const{avatarOwner:i,profilePhotos:s,mediaIndex:n}=e,o=n+t;return o>=0&&s&&o<s.photos.length?{type:"avatar",avatarOwner:i,profilePhotos:s,mediaIndex:o}:void 0}if("sponsoredMessage"===e.type){const{message:i,mediaIndex:s}=e,n=s+t;return n>=0&&i?{type:"sponsoredMessage",message:i,mediaIndex:n}:void 0}const{message:i,mediaIndex:s}=e,n=(0,l.qG)(i);if(n){const e=s+t;if(e>=0&&e<n.extendedMedia.length)return{type:"message",message:i,mediaIndex:e}}const o=Ee?.indexOf(i.id);if(void 0===o||-1===o)return;const a=Ee[o+t],r=_?.[a];return r?{type:"message",message:r}:void 0}),Ze=(0,T.A)(e=>{if(!e)return void ze();const t="avatar"===e.type?e.avatarOwner.id:"message"===e.type?e.message.chatId:void 0,i="message"===e.type?e.message.id:void 0,s="standalone"===e.type?e.media:void 0;re({origin:L,chatId:t,messageId:i,standaloneMedia:s,mediaIndex:e.mediaIndex,isAvatarView:"avatar"===e.type,withDynamicLoading:W},{forceOnHeavyAnimation:!0})}),Xe=(0,T.A)(()=>{if((E?.photos.length||j?.length||Ee?.length||0)<=1||!te)return void ze();const e=Qe(te,-1);e?Ze(e):"avatar"===te.type&&(0,v.L8)(te.avatarOwner.id)||"standalone"===te.type||ze()}),et=(0,B.A)();return(0,se.FD)(oe.A,{id:"MediaViewer",isOpen:Ae,isHidden:$,shouldAnimateFirstRender:!0,noCloseTransition:q,children:[(0,se.FD)("div",{className:"media-viewer-head",dir:et.isRtl?"rtl":void 0,"data-tauri-drag-region":!(!h.Vq||!m.MP)||void 0,children:[fe&&(0,se.Y)(X.A,{className:"media-viewer-close",round:!0,size:"smaller",color:"translucent-white",iconName:"close",ariaLabel:et("Close"),onClick:ze}),(0,se.Y)(ae.Ay,{activeKey:ye.current,name:ke,children:(0,se.Y)(Ft,{item:te},be?.id)}),(0,se.Y)(ve,{mediaData:Te,isVideo:Fe,item:te,canUpdateMedia:y,canReportAvatar:xe,onBeforeDelete:Xe,onReportAvatar:Pe,onCloseMediaViewer:ze,onForward:qe}),(0,se.Y)(ne,{isOpen:Ie,onClose:Ye,photo:R,peerId:x?.id})]}),(0,se.Y)(St,{item:te,loadMoreItemsIfNeeded:We,isLoadingMoreMedia:Q,isSynced:ee,getNextItem:Qe,chatId:e,isPhoto:De,isGif:Le,threadId:t,avatarOwnerId:x?.id,origin:L,isOpen:Ae,hasFooter:je,isVideo:Fe,withAnimation:H,onClose:ze,selectItem:Ze,isHidden:$,onFooterClick:He,handleSponsoredClick:$e})]})}));var Tt=i(2429);const Bt="W9A8SEMl",Lt="gLHHo5k8",Rt="GJVwqV9e",xt="_Yn4SWUB",Et="hGCH03qc",Vt="ZecqXqKy",_t="PVZ8TOWS",Ut="Wi0DXPH2",Ot="Ka1CGfzq",Kt="urTtSsk9",Jt="AjXOHOgE",Gt="uAlXNXJN",jt="g8ypsnnC",zt="hGTnZuar",Ht="TkphaPyQ",$t="CvnxnCxN",qt="nZ30pf4g",Wt="MnNC7VHS",Qt="G8OgmMDJ",Zt=3.5*g.$,Xt=.5*g.$;function ei(e,t=!1,i=!1){const s=document.createElement("div");s.classList.add(i?"TYicp2_K":"fME2l_yv");const n=new Image;if(n.draggable=!1,n.oncontextmenu=y.A,n.classList.add("HjoURJRK"),t){const t=document.createElement("canvas");t.classList.add(Wt),n.onload=()=>{const e=t.getContext("2d",{alpha:!1}),{width:i,height:s}=n;(0,r.RK)(()=>{t.width=i,t.height=s,m.QH&&(e.filter="blur(2px)"),e.drawImage(n,-4,-4,i+8,s+8),m.QH||(0,j.A)(e,0,0,i,s,2,2)})},n.src=e,s.appendChild(t)}else n.src=e,s.appendChild(n);return s}function ti(e,t){let i;const s=`#${(0,l.kR)(t)}`;switch(e){case o.G9.StoryRibbon:i=`#LeftColumn .${Tt.A.root}`;break;case o.G9.MiddleHeaderAvatar:i=".MiddleHeader .Transition_slide-active .ChatInfo";break;case o.G9.ChatList:i="#LeftColumn .chat-list";break;case o.G9.SearchResult:i="#LeftColumn .LeftSearch--container"}const n=document.querySelector(i),a=n&&n.querySelectorAll(`${s} img`);return{container:n,mediaEl:a?.[0]}}function ii({scale:e,slideAmount:t,isActiveSlideSize:i,isMoveThroughActiveSlide:s,isBackward:n}){const o=40+(i?405:135),a=(Math.abs(t)-1)*(40+(s?405:135)),r=(0,fe.Ki)((o+a)*e);return n?-r:r}function si(){const{width:e,height:t}=(0,Pe.A)();return(0,s.Kr)(()=>function(e,t){const i=function(e,t,i,s){const n=i/1200,o=s/800;return Math.min(n,o)}(0,0,e,t),s=(0,fe.Ki)(405*i),n=(0,fe.Ki)(135*i);return{activeSlide:{width:s,height:(0,fe.Ki)(720*i)},slide:{width:n,height:(0,fe.Ki)(240*i)},scale:i,toActiveScale:s/n,fromActiveScale:n/s}}(e,t),[e,t])}function ni(e,t=!1,i=!1){const s=e&&"content"in e,n=e&&"isDeleted"in e,o=!!s&&(0,l.XR)(e),a=s&&Boolean(e.forwardInfo);let r;s&&(e.content.photo?.thumbnail&&(r=e.content.photo.thumbnail.dataUri),e.content.video?.thumbnail?.dataUri&&(r=e.content.video.thumbnail.dataUri));const c=s?(0,l.EN)(e):void 0,d=(0,q.A)(c),h=Boolean(s&&e.content.video),m=s&&e.content.video?.noSound,u=s?(0,l.EN)(e,"full"):void 0,p=(0,q.A)(u,!e,h?G.qZ.Progressive:G.qZ.BlobUrl),v=h&&s?(0,l.EN)(e,"full",!0):void 0,g=(0,q.A)(v,!e,G.qZ.Progressive),A=Boolean(p||g),f=h?d:p||d,b=!d&&!A,C=t&&s&&!e.noForwards,y=s?(0,l.EN)(e,"download"):void 0;return{isLoadedStory:s,isDeletedStory:n,hasText:o,hasForwardInfo:a,thumbnail:r,previewHash:c,previewBlobUrl:d,isVideo:h,noSound:m,fullMediaHash:u,fullMediaData:p,altMediaHash:v,altMediaData:g,hasFullData:A,bestImageData:f,hasThumb:b,canDownload:C,downloadMediaData:(0,q.A)(y,!C&&!i)}}var oi=i(94189);const ai=(0,s.ph)(function({isOpen:e,story:t,onClose:i}){const{deleteStory:o,openNextStory:a}=(0,n.ko)(),r=(0,B.A)(),l=(0,s.hb)(()=>{t&&(a(),o({peerId:t.peerId,storyId:t.id}),i())},[i,t]);return(0,se.Y)(oi.A,{isOpen:e,onClose:i,title:r("DeleteStoryTitle"),text:r("DeleteStorySubtitle"),confirmLabel:r("Delete"),confirmHandler:l,confirmIsDestructive:!0,className:"component-theme-dark"})});var ri=i(21309),li=i(22720),ci=i(63152),di=i(87894),hi=i(79824),mi=i(54960);const ui=(0,s.ph)(function({id:e,contactListIds:t,currentUserId:i,selectedIds:n,lockedIds:o,onSelect:a}){const r=(0,B.A)(),[l,c]=(0,s.J0)(""),d=(0,s.Kr)(()=>{const e=(t||[]).filter(e=>e!==i);return(0,di.Am)((0,It.PU)({ids:[...n||[],...e],query:l,type:"user"}))},[t,i,l,n]);return(0,se.Y)(mi.A,{itemIds:d,selectedIds:n??hi.p,lockedSelectedIds:o,filterValue:l,filterPlaceholder:r("Search"),searchInputId:`${e}-picker-search`,isSearchable:!0,withDefaultPadding:!0,forceShowSelf:!0,onSelectedIdsChange:a,onFilterChange:c,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"},e)});var pi=i(12933);const vi=(0,s.ph)(function({isActive:e,contactListIds:t,usersById:i,currentUserId:o,onClose:a}){const{saveCloseFriends:r}=(0,n.ko)(),l=(0,B.A)(),[c,d]=(0,s.J0)(""),[h,m]=(0,s.J0)(!1),[u,p]=(0,s.J0)([]),v=(0,s.Kr)(()=>(t||[]).filter(e=>i[e]?.isCloseFriend),[t,i]),g=(0,s.Kr)(()=>{const e=(t||[]).filter(e=>e!==o);return(0,di.Am)((0,It.PU)({ids:[...v,...e],query:c,type:"user"}))},[v,t,o,c]);(0,F.A)(([t])=>{!t&&e&&(m(!1),p(v))},[e,v]);const A=(0,s.hb)(e=>{p(e),m(!0)},[]),f=(0,T.A)(()=>{r({userIds:u}),a()});return(0,se.FD)(se.FK,{children:[(0,se.Y)(mi.A,{itemIds:g||[],selectedIds:u,filterValue:c,filterPlaceholder:l("Search"),searchInputId:"close-friends-picker-search",isSearchable:!0,withDefaultPadding:!0,onSelectedIdsChange:A,onFilterChange:d,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),(0,se.Y)("div",{className:(0,ge.A)("BDK_pgpt",h&&"N8ujSwlC"),children:(0,se.Y)(pi.A,{isShown:h,onClick:f,ariaLabel:l("Save"),iconName:"check"})})]})}),gi={modal:"hz7SomkK",header:"NV6Rt2g9",closeButton:"SN1GFS6L",headerTitle:"gi0Y6Ns6",content:"sTaVDkiD",section:"eUiuPoEC",title:"iPPiw9DI",list:"OUP1Ss0W",option:"JL33Sa3b",checked:"qVPo_cVL",input:"zsDaUk0i",icon:"AfYCVlys",action:"njMeBBwY",optionContent:"TUAAnG2w",footer:"r24Qz2bf",info:"ljeRVBOm",submit:"RwNLN_rH"},Ai=[{name:"StoryPrivacyOptionEveryone",value:"everybody",color:["#50ABFF","#007AFF"],icon:"channel-filled",actions:"blockUserIds"},{name:"StoryPrivacyOptionContacts",value:"contacts",color:["#C36EFF","#8B60FA"],icon:"user-filled",actions:"blockContactUserIds"},{name:"StoryPrivacyOptionCloseFriends",value:"closeFriends",color:["#88D93A","#30B73B"],icon:"favorite-filled",actions:"closeFriends"},{name:"StoryPrivacyOptionSelectedContacts",value:"nobody",color:["#FFB743","#F69A36"],icon:"group-filled",actions:"allowUserIds"}];var fi=function(e){return e[e.privacy=0]="privacy",e[e.allowList=1]="allowList",e[e.closeFriends=2]="closeFriends",e[e.denyList=3]="denyList",e}(fi||{});const bi=(0,s.ph)((0,n.EK)(e=>{const{storyViewer:{storyId:t,peerId:i}}=(0,c.nTw)(e),s=i&&t?(0,c.Msb)(e,i,t):void 0;return{story:s&&"content"in s?s:void 0,visibility:s&&"visibility"in s?s.visibility:void 0,contactListIds:e.contactList?.userIds,usersById:e.users.byId,currentUserId:e.currentUserId}})(function({isOpen:e,story:t,visibility:i,contactListIds:o,usersById:a,currentUserId:r,onClose:c}){const{editStoryPrivacy:d,toggleStoryInProfile:h}=(0,n.ko)(),m=(0,B.A)(),[u,p,v]=(0,D.A)(!1),[g,A]=(0,s.J0)(i),[f,b]=(0,s.J0)(t?.isInProfile),[C,S]=(0,s.J0)(fi.privacy),[N,k]=(0,s.J0)("everybody"),w=C!==fi.privacy,I=(0,s.Kr)(()=>(o||[]).filter(e=>a[e]?.isCloseFriend),[o,a]),P=(0,s.Kr)(()=>{if(C===fi.allowList&&(!g?.allowUserIds?.length||g.allowUserIds[0]===r))return[r]},[C,r,g?.allowUserIds]),Y=(0,s.Kr)(()=>N!==g?.visibility?[]:g?.blockUserIds||[],[N,g?.blockUserIds,g?.visibility]),F=(0,T.A)(e=>{A({...g,allowUserIds:e?.length?e?.filter(e=>e!==r):[r]})}),M=(0,T.A)(e=>{A({...g,blockUserIds:e,visibility:N})});(0,s.vJ)(()=>{e&&(S(fi.privacy),p())},[e]),(0,s.vJ)(()=>{A(i)},[i]);const L=(0,T.A)(()=>{C!==fi.privacy?S(fi.privacy):v()}),R=(0,T.A)(()=>{b(!f)}),x=(0,T.A)(()=>{d({peerId:t.peerId,storyId:t.id,privacy:g}),t.isInProfile!==f&&h({peerId:t.peerId,storyId:t.id,isInProfile:f}),v()});return(0,se.FD)(te.A,{isOpen:u,className:(0,ge.A)(gi.modal,"component-theme-dark"),onClose:v,noBackdrop:!0,onCloseAnimationEnd:c,children:[(0,se.FD)("div",{className:gi.header,children:[(0,se.Y)(X.A,{className:(0,ge.A)(gi.closeButton,"close-button"),round:!0,color:"translucent",size:"tiny",onClick:L,ariaLabel:m(w?"Common.Back":"Common.Close"),children:(0,se.Y)("div",{className:(0,ge.A)("animated-close-icon",w&&"state-back")})}),(0,se.Y)(ae.Ay,{name:"slideFade",activeKey:C,children:function(){switch(C){case fi.privacy:return(0,se.Y)("h3",{className:gi.headerTitle,children:m("StoryPrivacyAlertEditTitle")});case fi.allowList:return(0,se.Y)("h3",{className:gi.headerTitle,children:m("StoryPrivacyAlertSelectContactsTitle")});case fi.closeFriends:return(0,se.Y)("h3",{className:gi.headerTitle,children:m("CloseFriends")});case fi.denyList:return(0,se.Y)("h3",{className:gi.headerTitle,children:m("StoryPrivacyAlertExcludedContactsTitle")})}}()})]}),(0,se.Y)(ae.Ay,{activeKey:C,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",className:gi.content,children:function(e){switch(C){case fi.privacy:return function(){const e=t?(0,ri.qZ)(t.expireDate-t.date):0;return(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:gi.section,children:[(0,se.Y)("h3",{className:gi.title,children:m("StoryPrivacyAlertSubtitleProfile")}),(0,se.Y)("div",{className:gi.list,children:Ai.map(e=>{return(0,se.FD)("label",{className:(0,ge.A)(gi.option,e.value===g?.visibility&&gi.checked),children:[(0,se.Y)("input",{type:"radio",name:"story_privacy",className:gi.input,value:e.value,checked:e.value===g?.visibility,onChange:()=>{return t=e.value,void A({...g,visibility:t});var t},teactExperimentControlled:!0}),(0,se.Y)("span",{className:gi.icon,style:`--color-from: ${e.color[0]}; --color-to: ${e.color[1]}`,children:(0,se.Y)(he.A,{name:e.icon})}),(0,se.FD)("div",{className:gi.optionContent,children:[(0,se.Y)("span",{className:(0,ge.A)(gi.option_name),children:m(e.name)}),e.actions&&(0,se.FD)("div",{tabIndex:0,role:"button",className:gi.action,"aria-label":m("Edit"),onClick:t=>{!function(e,t){switch((0,y.A)(e),t){case"closeFriends":S(fi.closeFriends);break;case"allowUserIds":S(fi.allowList);break;case"blockUserIds":S(fi.denyList),k("everybody");break;case"blockContactUserIds":S(fi.denyList),k("contacts")}}(t,e.actions)},children:[(0,se.Y)("span",{className:gi.actionInner,children:(t=e.actions,"closeFriends"===t?0===I.length?m("StoryPrivacyOptionCloseFriendsDetail"):1===I.length?(0,It.F9)(m,a[I[0]]):m("StoryPrivacyOptionPeople",I.length,"i"):"blockUserIds"===t&&"everybody"===g?.visibility||"blockContactUserIds"===t&&"contacts"===g?.visibility?g?.blockUserIds?.length?1===g.blockUserIds.length?m("StoryPrivacyOptionExcludePerson",(0,l.Yg)(a[g.blockUserIds[0]])):m("StoryPrivacyOptionExcludePeople",g.blockUserIds.length,"i"):m("StoryPrivacyOptionContactsDetail"):g?.allowUserIds&&0!==g.allowUserIds.length?1===g.allowUserIds.length?(0,l.Yg)(a[g.allowUserIds[0]]):m("StoryPrivacyOptionPeople",g.allowUserIds.length,"i"):m("StoryPrivacyOptionSelectedContactsDetail"))}),(0,se.Y)(he.A,{name:"next"})]})]})]},e.value);var t})})]}),(0,se.Y)("div",{className:gi.section,children:(0,se.FD)(li.A,{ripple:!0,onClick:R,children:[(0,se.Y)("span",{children:m("StoryKeep")}),(0,se.Y)(ci.A,{id:"group-notifications",label:m("StoryKeep"),checked:f,inactive:!0})]})}),(0,se.FD)("div",{className:gi.footer,children:[(0,se.Y)("div",{className:gi.info,children:m("StoryKeepInfo",e)}),(0,se.Y)("div",{className:gi.submit,children:(0,se.Y)(X.A,{onClick:x,children:m("StoryPrivacyButtonSave")})})]})]})}();case fi.closeFriends:return(0,se.Y)(vi,{isActive:e,contactListIds:o,currentUserId:r,usersById:a,onClose:L},"close-friends");case fi.denyList:return(0,se.Y)(ui,{id:"deny-list",contactListIds:o,currentUserId:r,selectedIds:Y,onSelect:M},"deny-list");case fi.allowList:return(0,se.Y)(ui,{id:"allow-list",contactListIds:o,lockedIds:P,currentUserId:r,selectedIds:g?.allowUserIds,onSelect:F},"allow-list")}}})]})}));var Ci=i(36353),yi=i(73104),Si=i(14),Ni=i(52674),ki=i(95362),wi=i(48775),Ii=i(80140),Pi=i(46051),Yi=i(45470),Fi=i(39351),Di=i(38218),Mi=i(83057),Ti=i(66991),Bi=i(61157),Li=i(92111),Ri=i(2740),xi=i(65843),Ei=i(55158),Vi=i(59816),_i=i(91800),Ui=i(23565),Oi=i(18501),Ki=i(11217),Ji=i(39996),Gi=i(86070),ji=i(39877);const zi=(0,s.ph)((0,n.EK)((e,{forwardInfo:t})=>({sender:t.fromPeerId?(0,c.PVB)(e,t.fromPeerId):void 0,story:t.storyId&&t.fromPeerId?(0,c.Msb)(e,t.fromPeerId,t.storyId):void 0,theme:(0,c.SJA)(e)}))(({className:e,forwardInfo:t,sender:i,story:o,theme:a})=>{const{openStoryViewer:r,loadPeerStoriesByIds:l,openChat:c}=(0,n.ko)(),d=(0,s.li)(),h=(0,B.A)();(0,s.vJ)(()=>{!o&&t.fromPeerId&&t.storyId&&l({peerId:t.fromPeerId,storyIds:[t.storyId]})},[t,o]);const{className:m,style:u}=(0,Ji.Ay)({peer:i,noUserColors:!0,shouldReset:!0,theme:a}),p=i?(0,It.F9)(h,i):t.fromName,g=(0,T.A)(()=>{const{fromPeerId:e,storyId:i}=t;e&&(!o||"isDeleted"in o&&o.isDeleted?c({id:e}):r({peerId:e,storyId:i,isSingleStory:!0}))}),{handleClick:A,handleMouseDown:f}=(0,Ki.Q)(g);return(0,se.FD)(Gi.A,{ref:d,className:(0,ge.A)("EmbeddedMessage",e,m),style:u,dir:h.isRtl?"rtl":void 0,onClick:A,onMouseDown:f,children:[i?.color?.backgroundEmojiId&&(0,se.Y)(ji.A,{emojiDocumentId:i.color.backgroundEmojiId,className:"EmbeddedMessage--background-icons"}),(0,se.FD)("div",{className:"message-text",children:[function(){if(o&&"content"in o&&o.content.text)return(0,se.Y)("p",{className:"embedded-text-wrapper",children:(0,Oi.fd)(o.content.text)})}(),(0,se.Y)("div",{className:"message-title",children:function(){if(!i||!p)return;const e=(0,v.L8)(i.id)?"user-filled":"channel-filled";return(0,se.FD)(se.FK,{children:[e&&(0,se.Y)(he.A,{name:e,className:"embedded-chat-icon"}),p&&(0,Pt.A)(p)]})}()})]})]})}));var Hi=i(57076);const $i=(0,s.ph)(function({story:e,isExpanded:t,className:i,onExpand:n,onFold:o}){const a=(0,B.A)(),l=(0,s.li)(),c=(0,s.li)(),d=(0,s.li)(),h=(0,s.li)(),m=(0,Si.A)(e,!0),u=m?.content.text,[p,v]=(0,s.J0)(!1),g=(0,Ui.A)(t||void 0,400),A=t||g;(0,s.vJ)(()=>{(0,r.RK)(()=>{c.current&&(t?(0,et.YM)(c.current,$t):(0,et.HW)(c.current,$t))})},[t]);const f=p&&!A,{shouldRender:b,transitionClassNames:C}=(0,je.A)(f,void 0,!0,"slow",!0);(0,s.Nf)(()=>{(0,r.YS)(()=>{const e=c.current,t=h.current;if(!e||!t)return;const{offsetWidth:i}=t;(0,r.RK)(()=>{e.style.setProperty("--expand-button-width",`${i}px`)})})},[b,a]),(0,s.Nf)(()=>{(0,r.gm)(()=>{if(!c.current||!d.current)return;const e=c.current,t=d.current,i=t.offsetTop,{lineHeight:s,totalLines:n}=(0,_i.A)(t),o=n>3,a=i+3*s;return()=>{o&&((0,et.YM)(e,"e1gyTmKe"),v(!0)),e.style.setProperty("--_overflow-shift",`${a}px`)}})},[u]),(0,s.vJ)(()=>{t||l.current?.scrollTo({top:0})},[t]);const y=(0,ge.A)("ilyTRZtw",A&&"HIMnUViv",b&&"Vq8pl_kQ");return(0,se.FD)("div",{className:(0,ge.A)("RKedwa0I",i),children:[(0,se.Y)("div",{ref:c,className:y,role:f?"button":void 0,onClick:f?n:o,children:(0,se.FD)("div",{ref:l,className:(0,ge.A)("D_5mWNmi","allow-selection","custom-scroll"),children:[m?.forwardInfo&&(0,se.Y)(zi,{forwardInfo:m.forwardInfo,className:"_M8CgT7s"}),m&&u&&(0,se.Y)("div",{ref:d,className:"hmFA5qb1",children:(0,se.Y)(Hi.A,{messageOrStory:m,withTranslucentThumbs:!0,forcePlayback:!0})})]})}),b&&(0,se.Y)("div",{ref:h,className:(0,ge.A)("bM5rlQtM",C),onClick:n,children:a("Story.CaptionShowMore")})]})});var qi=i(26875),Wi=i(11241);const Qi="YVD19vOP",Zi="vJRk_UUk",Xi="nIv3YAnZ",es=(0,s.ph)(({story:e,className:t})=>{const{openStoryViewModal:i,openForwardMenu:o,sendStoryReaction:r}=(0,n.ko)(),c=(0,B.A)(),{views:d,isOut:h,peerId:m,id:u,sentReaction:p}=e,{viewsCount:g,forwardsCount:A,reactionsCount:f}=d||{},b=!(0,v.L8)(m),C=p&&(0,l.a0)(p,a.tNZ),y=Boolean((h||b)&&e.isPublic&&!e.noForwards),S=(0,l.$_)(m,u),N=(0,s.Kr)(()=>{const{users:{byId:e}}=(0,n.mS)(),t=d&&"recentViewerIds"in d?d.recentViewerIds:void 0;if(t)return t.map(t=>e[t]).filter(Boolean)},[d]),k=(0,T.A)(()=>{i({storyId:u})}),w=(0,T.A)(()=>{o({fromChatId:m,storyId:u})}),I=(0,T.A)(()=>{const e=p?void 0:a.tNZ;r({peerId:m,storyId:u,containerId:S,reaction:e})});return g?(0,se.FD)("div",{className:(0,ge.A)(Qi,t),children:[(0,se.FD)("div",{className:(0,ge.A)("cknL5COh",!b&&"pJAyeGkG"),onClick:b?void 0:k,children:[Boolean(N?.length)&&(0,se.Y)(qi.A,{size:"small",peers:N,className:"Vz_VtJ16"}),b?(0,se.FD)("span",{className:Xi,children:[(0,se.Y)(he.A,{name:"channelviews",className:"WyBiNM6e"}),g]}):(0,se.Y)("span",{className:Xi,children:c("Views",g,"i")}),Boolean(f)&&!b&&(0,se.FD)("span",{className:"sf3u_6Vh",children:[(0,se.Y)(he.A,{name:"heart",className:"Er2XKRqi"}),f]})]}),(0,se.Y)("div",{className:"kKoeDk3Z"}),y&&(0,se.Y)(X.A,{color:"translucent",size:"smaller",round:!0,onClick:w,ariaLabel:c("Forward"),className:Zi,iconName:"forward"}),b&&(0,se.FD)(se.FK,{children:[Boolean(A)&&(0,se.FD)("div",{className:Zi,children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"smaller",nonInteractive:!0,ariaLabel:c("PublicShares"),iconName:"loop"}),(0,se.Y)("span",{children:A})]}),(0,se.FD)("div",{className:Zi,children:[(0,se.FD)(X.A,{round:!0,className:"lpDXVIuf",color:"translucent",size:"smaller",onClick:I,ariaLabel:c("AccDescrLike"),children:[p&&(0,se.Y)(Wi.A,{containerId:S,reaction:p,withEffectOnly:C},(0,l.Jj)(p)),(!p||C)&&(0,se.Y)(he.A,{name:C?"heart":"heart-outline",className:(0,ge.A)(C&&"twgMDT1y")})]}),Boolean(f)&&(0,se.Y)("span",{children:f})]})]})]}):(0,se.Y)("div",{className:(0,ge.A)(Qi,t),children:c("NobodyViewed")})}),ts=(0,s.ph)(function({isActive:e,isViewed:t,isVideo:i,duration:s=6,isPaused:n,onImageComplete:o}){const a=(0,T.A)(e=>{i||"XY98E7VM"!==e.animationName||o()}),r=(0,ge.A)("c1fbGgcx",t&&"xwOKghO2",e&&"ZuByYcIx",n&&"n9V6B7hP");return(0,se.Y)("span",{className:r,"aria-hidden":!0,children:e&&(0,se.Y)("i",{style:`--progress-duration: ${s}s`,className:"qyBCpJct",onAnimationEnd:a})})}),is=m.Yw?4:3,ss=(0,s.ph)((0,n.EK)((e,{peerId:t,storyId:i,isDeleteModalOpen:s})=>{const{appConfig:n}=e,o=(0,c.mBe)(e,t),a=(0,c.hds)(e,t),r=(0,c.vGo)(e,t),l=(0,c.nTw)(e),{storyViewer:{isMuted:d,viewModal:h,isPrivacyModalOpen:m,storyList:u},forwardMessages:{storyId:p},premiumModal:v,safeLinkModalUrl:g,mapModal:A,reportModal:f,giftInfoModal:b,isPaymentMessageConfirmDialogOpen:C,storyStealthModal:y}=l,{isOpen:S}=v||{},N=Boolean(y),k=(0,c.Msb)(e,t,i),w=k&&"content"in k,I=Boolean(C||h||p||l.reactionPicker?.storyId||f||m||S||s||g||N||A||b),P=w?k.forwardInfo:void 0,Y=w?k.mediaAreas:void 0,F=P?.fromPeerId||Y?.find(e=>"channelPost"===e.type)?.channelId,D=F?(0,c.PVB)(e,F):void 0,M=(0,c.xYJ)(e,"mediaViewerAnimations"),T=w&&k.fromId?(0,c.PVB)(e,k.fromId):void 0,B=(0,c.WA9)(e,t),L=(0,c.trm)(e);return{peer:o||a,forwardSender:D,fromPeer:T,story:k,orderedIds:u?.storyIdsByPeerId[t],isMuted:d,isCurrentUserPremium:(0,c.g29)(e),shouldForcePause:I,storyChangelogUserId:n.storyChangelogUserId,viewersExpirePeriod:n.storyViewersExpirePeriod,isChatExist:Boolean(a),arePeerSettingsLoaded:Boolean(r?.settings),stealthMode:e.stories.stealthMode,withHeaderAnimation:M,paidMessagesStars:B,isAccountFrozen:L}})(function({peerId:e,storyId:t,peer:i,forwardSender:o,fromPeer:r,isMuted:c,isArchivedStories:d,isPrivateStories:h,story:m,orderedIds:u,isSingleStory:p,dimensions:g,shouldForcePause:A,storyChangelogUserId:f,viewersExpirePeriod:b,isChatExist:C,arePeerSettingsLoaded:y,getIsAnimating:S,isCurrentUserPremium:N,stealthMode:k,withHeaderAnimation:w,paidMessagesStars:I,isAccountFrozen:P,onDelete:M,onClose:L,onReport:R}){const{viewStory:x,setStoryViewerMuted:E,openPreviousStory:V,openNextStory:_,loadPeerSkippedStories:U,openForwardMenu:O,copyStoryLink:K,toggleStoryInProfile:J,openChat:j,showNotification:z,openStoryPrivacyEditor:H,loadPeerSettings:$,fetchChat:q,loadStoryViews:W,openStealthModal:Q}=(0,n.ko)(),Z=(0,Ii.Fm)(),ee=(0,B.A)(),te=(0,Fi.A)(),{isMobile:ie}=(0,Y.Ay)(),[ne,oe,re]=(0,D.A)(!1),[le,ce,de]=(0,D.A)(!1),[pe,ve,Ae]=(0,D.A)(!1),[be,Ce,ye]=(0,D.A)(!0),[Se,Ne,ke]=(0,D.A)(!1),[we,Ie]=(0,s.J0)(!1),[Pe,Ye,Fe]=(0,D.A)(!1),[De,Me,Te]=(0,D.A)(!1),Be=(0,s.li)(),{isDeletedStory:Le,hasText:Re,hasForwardInfo:xe,thumbnail:Ee,previewBlobUrl:Ve,isVideo:_e,noSound:Ue,fullMediaData:Oe,altMediaHash:Ke,altMediaData:Ge,hasFullData:ze,hasThumb:He,canDownload:$e,downloadMediaData:qe}=ni(m,N,De),Qe=m&&"content"in m,Ze=e===f,Xe=(0,v.L8)(e),et=!Xe,tt=et&&(0,l.WX)(i),it=Qe&&m.isOut,st=Qe&&0===Object.keys(m.content).length,nt=(0,Si.A)(it?!m.isInProfile:void 0,!0),ot=(0,Si.A)(it?m.isInProfile:void 0,!0),at=Boolean(it&&m.date+b<(0,Ii.Fm)()),rt=o?(0,It.F9)(te,o):Qe&&m.forwardInfo?.fromName,lt=Boolean(Qe&&m.isPublic&&!Ze&&i?.hasUsername),ct=Boolean(Qe&&m.isPublic&&!m.noForwards&&!Ze&&!Se),dt=Boolean((ze||st)&&!A&&be&&!ne&&!Se&&!we&&!Pe),ht=Qe&&m.content.video?.duration?m.content.video.duration:void 0,mt=!(it&&Xe||Ze||tt||P),ut=Qe&&!mt&&(it||tt),pt=ie&&w?"slideFade":"none",{shouldRender:vt,transitionClassNames:gt}=(0,je.A)(!ze&&!st),{transitionClassNames:At}=(0,je.A)(Boolean(Oe)&&!st),ft=(0,Yi.A)(Ee,!He),bt=(0,Mi.A)(Ve),{shouldRender:Ct,transitionClassNames:yt}=(0,je.A)(mt),{shouldRender:St,transitionClassNames:Nt}=(0,je.A)(Re&&Se),{transitionClassNames:kt}=(0,je.A)(!0),{shouldRender:wt,transitionClassNames:Ft}=(0,je.A)(Re||xe),Dt=(0,Ti.Y)(Be,Oe,Pi.G);(0,Li.A)(e,t),(0,s.vJ)(()=>{t&&x({peerId:e,storyId:t})},[t,e]),(0,s.vJ)(()=>{U({peerId:e})},[e]),(0,s.vJ)(()=>{const t=(0,v.L8)(e);!C&&t&&q({chatId:e})},[C,e]),(0,s.vJ)(()=>{C&&!y&&$({peerId:e})},[y,C,e]);const Mt=(0,T.A)(()=>{_e&&Be.current?.pause(),Ae(),de()}),Tt=(0,T.A)(()=>{dt&&(ce(),_e||ve())}),Lt=(0,T.A)(()=>{Ye()}),Rt=(0,T.A)(()=>{Fe()}),xt=(0,T.A)(()=>{Me(),Mt()}),Vt=(0,T.A)(()=>{Te(),Tt()}),{onMouseDown:Kt,onMouseUp:Jt,onMouseLeave:Gt,onTouchStart:$t,onTouchEnd:Zt}=(0,Di.A)({onStart:Lt,onEnd:Rt}),Xt=(0,Je.A)(Be,void 0,!_e||!Oe||Dt),ei=Oe&&(!Ke||Ge);(0,s.vJ)(()=>{(ei||Xt||st)&&Tt()},[ei,Xt,st]),(0,Bi.Ay)(ye,Ce),(0,s.vJ)(()=>{ei&&Be.current?.load()},[ei]),(0,s.vJ)(()=>{!Qe||Le||at||(it||tt)&&W({peerId:e,storyId:t})},[Le,at,Qe,e,t,it,tt]),(0,s.vJ)(()=>{A||!be||ne||Se||we||Pe?Mt():Tt()},[Tt,be,Se,ne,A,we,Pe]),(0,s.vJ)(()=>{if(!(ne||A||Se))return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){32===e.keyCode&&(e.preventDefault(),Ie(!we))}},[Se,ne,we,A]),(0,F.A)(([e,t,i,s,n])=>{!we||Se||ne||A||!be||Pe||t===Se&&e===ne&&i===A&&s===be&&n===Pe||Ie(!1)},[ne,Se,A,be,Pe,we]);const ti=(0,T.A)(()=>{L(),j({id:e})}),ii=(0,T.A)(()=>{L(),j({id:o.id})}),si=(0,T.A)(()=>{L(),j({id:r.id})}),oi=(0,T.A)(()=>{V()}),ai=(0,T.A)(()=>{_()}),ri=(0,T.A)(e=>{const t=e.currentTarget;t.readyState>=is?ve():Ae(),ht&&(0,fe.LI)(t.currentTime,2)>=(0,fe.LI)(ht,2)&&ai()});(0,s.vJ)(()=>S()||ne?void 0:(0,Ni.A)({onRight:ai,onLeft:oi}),[S,ne]);const li=(0,T.A)(()=>{K({peerId:e,storyId:t})}),ci=(0,T.A)(()=>{J({peerId:e,storyId:t,isInProfile:!0})}),di=(0,T.A)(()=>{J({peerId:e,storyId:t,isInProfile:!1})}),hi=(0,T.A)(()=>{M(m)}),mi=(0,T.A)(()=>{R()}),ui=(0,T.A)(()=>{O({fromChatId:e,storyId:t})}),pi=(0,T.A)(()=>{H()}),vi=(0,T.A)(()=>{const e=!Qe||m.isPublic?void 0:m.isForContacts?"contacts":m.isForCloseFriends?"closeFriends":"nobody";let t;const s=(0,It.F9)(te,i);switch(e){case"nobody":t=ee("StorySelectedContactsHint",s);break;case"contacts":t=ee("StoryContactsHint",s);break;case"closeFriends":t=ee("StoryCloseFriendsHint",s);break;default:return}z({message:t})}),gi=(0,T.A)(()=>{Ue?z({message:ee("Story.TooltipVideoHasNoSound")}):(Be.current.muted=!Be.current.muted,E({isMuted:!c}))}),Ai=(0,T.A)(()=>{if(k.activeUntil&&(0,Ii.Fm)()<k.activeUntil){const e=k.activeUntil-(0,Ii.Fm)();return void z({title:te("StealthModeOnTitle"),message:te("StealthModeOnHint",{time:(0,We.QO)(e)}),duration:4e3})}Q({})}),fi=(0,T.A)(()=>{qe&&(0,ki.A)(qe,`story-${e}-${t}.${_e?"mp4":"jpg"}`)});(0,s.vJ)(()=>{Le&&z({message:ee("StoryNotFound")})},[ee,Le]);const bi=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.Y)(X.A,{round:!0,ripple:!ie,size:"tiny",color:"translucent-white",onClick:e,className:(0,ge.A)(Ht,t&&"active"),ariaLabel:te("AriaLabelOpenMenu"),iconName:"more"}),[ie,te]);const Ci=I?te("ComposerPlaceholderPaidReply",{amount:(0,wi.U2)(te,I,{asFont:!0,className:"placeholder-star-icon"})},{withNodes:!0}):ee(et?"ReplyToGroupStory":"ReplyPrivately");return(0,se.FD)("div",{className:(0,ge.A)(jt,"component-theme-dark"),onMouseDown:Kt,onMouseUp:Jt,onMouseLeave:Gt,onTouchStart:$t,onTouchEnd:Zt,children:[(0,se.FD)("div",{className:(0,ge.A)("e7HHuS1g",kt),children:[(0,se.Y)("div",{className:"jGDd2sza",children:(p?[t]:u??[]).map(e=>(0,se.Y)(ts,{isActive:e===m?.id,isVideo:_e,isViewed:Boolean(m?.id&&(h||d?e>m?.id:e<m?.id)),isPaused:!pe,duration:ht,onImageComplete:ai},`progress-${e}`))}),(0,se.FD)("div",{className:"eMYhXF_X",children:[(0,se.Y)(ae.Ay,{activeKey:Number(e),name:pt,className:"PXnfXZur",children:(0,se.FD)("div",{className:"WpyVfrsc",children:[(0,se.Y)(Yt.A,{peer:i,size:"tiny",onClick:ti}),(0,se.FD)("div",{className:"jmKI_lhC",children:[(0,se.Y)("span",{onClick:ti,className:"H1uod43o",children:(0,Pt.A)((0,It.F9)(te,i)||"")}),(0,se.FD)("div",{className:"zimpR8Hz",children:[rt&&(0,se.FD)("span",{className:(0,ge.A)(zt,"JJFtefb9",o&&"BsqMBS2I"),onClick:o?ii:void 0,children:[(0,se.Y)(he.A,{name:"loop"}),(0,se.Y)("span",{className:Qt,children:(0,Pt.A)(rt)})]}),r&&(0,se.FD)("span",{className:(0,ge.A)(zt,"nJr8QgYX"),onClick:si,children:[(0,se.Y)(Yt.A,{peer:r,size:"micro"}),(0,se.Y)("span",{className:Qt,children:(0,Pt.A)((0,It.F9)(te,r)||"")})]}),m&&"date"in m&&(0,se.Y)("span",{className:zt,children:(0,We.jy)(ee,Z,m.date)}),Qe&&m.isEdited&&(0,se.Y)("span",{className:zt,children:ee("Story.HeaderEdited")})]})]})]})}),(0,se.FD)("div",{className:"GrsJNw3y",children:[function(){if(!Xe)return;let e="channel-filled";const t={"channel-filled":["#50ABFF","#007AFF"],"user-filled":["#C36EFF","#8B60FA"],"favorite-filled":["#88D93A","#30B73B"],"group-filled":["#FFB743","#F69A36"]};if(it){const{visibility:t}=m&&"visibility"in m&&m.visibility||{};switch(t){case"everybody":e="channel-filled";break;case"contacts":e="user-filled";break;case"closeFriends":e="favorite-filled";break;case"nobody":e="group-filled"}}else{if(!m||!("content"in m)||m.isPublic)return;e=m.isForCloseFriends?"favorite-filled":m.isForContacts?"user-filled":"group-filled"}return(0,se.FD)("div",{className:(0,ge.A)("prxptFFf",it&&"_MVsZpgB"),onClick:it?pi:vi,style:`--color-from: ${t[e][0]}; --color-to: ${t[e][1]}`,children:[(0,se.Y)(he.A,{name:e}),it&&(0,se.Y)(he.A,{name:"next"})]})}(),_e&&(0,se.Y)(X.A,{className:Ht,round:!0,ripple:!ie,size:"tiny",color:"translucent-white",disabled:!ze,onClick:gi,ariaLabel:ee("Volume"),iconName:c||Ue?"speaker-muted-story":"speaker-story"}),(0,se.FD)(me.A,{className:"K0_xAdzf",trigger:bi,positionX:"right",onOpen:xt,onClose:Vt,children:[lt&&(0,se.Y)(ue.A,{icon:"copy",onClick:li,children:ee("CopyLink")}),nt&&(0,se.Y)(ue.A,{icon:"save-story",onClick:ci,children:ee(Xe?"StorySave":"SaveToPosts")}),ot&&(0,se.Y)(ue.A,{icon:"delete",onClick:di,children:ee(Xe?"ArchiveStory":"RemoveFromPosts")}),$e&&(0,se.Y)(ue.A,{icon:"download",disabled:!qe,onClick:fi,children:ee("lng_media_download")}),!it&&Xe&&(0,se.Y)(ue.A,{icon:"eye-crossed-outline",onClick:Ai,children:ee("StealthMode")}),!it&&(0,se.Y)(ue.A,{icon:"flag",onClick:mi,children:ee("lng_report_story")}),it&&(0,se.Y)(ue.A,{icon:"delete",destructive:!0,onClick:hi,children:ee("Delete")})]}),(0,se.Y)(X.A,{className:(0,ge.A)(Ht,"WlLsjJ2Z"),round:!0,size:"tiny",color:"translucent-white",ariaLabel:ee("Close"),onClick:L,iconName:"close"})]})]})]}),(0,se.FD)("div",{className:"YiuvOPgT",style:`width: ${g.width}px; height: ${g.height}px`,children:[(0,se.Y)("canvas",{ref:ft,className:Wt}),Ve&&(0,se.Y)("img",{src:Ve,draggable:!1,alt:"",className:(0,ge.A)(_t,"lQfkulvp",bt)},`preview-${t}`),vt&&(0,se.Y)(Ei.A,{className:(0,ge.A)(gt,Bt)}),!_e&&Oe&&(0,se.Y)("img",{src:Oe,alt:"",className:(0,ge.A)(_t,At),draggable:!1}),_e&&Oe&&(0,se.FD)(xi.A,{ref:Be,className:(0,ge.A)(_t,At),canPlay:le,muted:c,width:720,height:1280,draggable:!1,playsInline:!0,disablePictureInPicture:!0,isPriority:!0,onPause:Ae,onWaiting:Ae,disableRemotePlayback:!0,onTimeUpdate:ri,children:[(0,se.Y)("source",{src:Oe,type:Pi.G,width:"720"}),Ge&&(0,se.Y)("source",{src:Ge,type:Pi.w,width:"480"})]},`video-${t}`),st&&(0,se.Y)("div",{className:(0,ge.A)(_t,"snxbMlts"),children:(0,se.Y)("span",{children:te("StoryUnsupported")})}),!Pe&&!ne&&(0,se.FD)(se.FK,{children:[(0,se.Y)("button",{type:"button",className:(0,ge.A)(qt,"SXpRZiax"),onClick:oi,"aria-label":ee("Previous")}),(0,se.Y)("button",{type:"button",className:(0,ge.A)(qt,"twOBFwUE"),onClick:ai,"aria-label":ee("Next")})]}),Qe&&Oe&&(0,se.Y)(Vi.A,{story:m,isActive:!0,isStoryPlaying:De},`area-overlay-${t}-${e}`),!ie&&(0,se.Y)("div",{className:Et,children:(0,se.FD)("div",{className:Ut,children:[(0,se.Y)(Yt.A,{peer:i,withStory:!0,storyViewerMode:"disabled"}),(0,se.Y)("div",{className:Ot,children:(0,Pt.A)((0,It.F9)(te,i)||"")})]})})]}),ut&&(0,se.Y)(es,{story:m,className:kt}),St&&(0,se.Y)("div",{tabIndex:0,role:"button",className:(0,ge.A)("Jd1DYS6Y",Nt),onClick:()=>ke(),"aria-label":ee("Close")}),Re&&(0,se.Y)("div",{className:(0,ge.A)("sHNAfxzf",Ft)}),wt&&(0,se.Y)($i,{story:m,isExpanded:Se,onExpand:Ne,onFold:ke,className:Ft},`caption-${t}-${e}`),Ct&&(0,se.Y)(Ri.A,{type:"story",chatId:e,threadId:G.l3,storyId:t,isReady:!it,messageListType:"thread",isMobile:(0,Y.Ny)(),editableInputCssSelector:a.iKt,editableInputId:a.YVZ,inputId:"story-input-text",className:(0,ge.A)("FXineBYO",yt),inputPlaceholder:Ci,onForward:ct?ui:void 0,onFocus:oe,onBlur:re})]})})),ns=(0,s.ph)((0,n.EK)((e,{peer:t})=>{const{storyViewer:{lastViewedByPeerId:i,origin:s,storyList:n}}=(0,c.nTw)(e);return{lastViewedId:t?.id?i?.[t.id]:void 0,origin:s,storyIdsForViewer:t?.id?n?.storyIdsByPeerId[t.id]:void 0}})(function({peer:e,peerStories:t,lastViewedId:i,storyIdsForViewer:o,origin:a}){const{openStoryViewer:r,loadPeerSkippedStories:c}=(0,n.ko)(),d=(0,B.A)(),h=(0,s.Kr)(()=>{if(!t)return;const{orderedIds:e,lastReadId:s,byId:n}=t,a=e[e.length-1]!==s,r=i&&o?.includes(i)?i??(a?s??-1:-1):-1;return n[n[r]?.id||o?.[0]||e[0]]},[i,t,o]),m=h&&"content"in h;(0,s.vJ)(()=>{h&&!m&&c({peerId:h.peerId})},[h,m]);const u=m?h.content.video:void 0,p=m?(0,l.EN)(h):void 0,v=(0,q.A)(p)||u?.thumbnail?.dataUri;if(e&&h&&!("isDeleted"in h))return(0,se.FD)("div",{className:jt,onClick:()=>{r({peerId:h.peerId,storyId:h.id,origin:a})},children:[v&&(0,se.Y)("img",{src:v,alt:"",className:_t,draggable:!1}),m&&(0,se.Y)(Vi.A,{story:h}),(0,se.Y)("div",{className:Et,children:(0,se.FD)("div",{className:Ut,children:[(0,se.Y)(Yt.A,{peer:e,withStory:!0,storyViewerMode:"disabled"}),(0,se.Y)("div",{className:Ot,children:(0,Pt.A)((0,It.F9)(d,e)||"")})]})})]})}));var os=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(os||{});const as=(0,s.ph)((0,n.EK)(e=>{const{storyViewer:{peerId:t,storyId:i,isSinglePeer:s,isSingleStory:n,isPrivate:o,isArchive:a,storyList:r}}=(0,c.nTw)(e),{byPeerId:l,orderedPeerIds:{active:d}}=e.stories;return{byPeerId:l,peerIds:r?.peerIds??d,currentPeerId:t,currentStoryId:i,isSinglePeer:s,isSingleStory:n,isPrivate:o,isArchive:a}},e=>(0,c.gd2)(e))(function({peerIds:e,currentPeerId:t,currentStoryId:i,isOpen:o,isSinglePeer:d,isSingleStory:h,isPrivate:u,isArchive:p,byPeerId:v,isDeleteModalOpen:g,onDelete:A,onClose:f,onReport:b}){const{stopActiveReaction:C}=(0,n.ko)(),y=(0,s.li)(),[S,N]=(0,s.J0)(t),[k,w]=(0,s.J0)(i),I=(0,K.A)(t),P=(0,Si.A)(p,!0),F=(0,Si.A)(u,!0),D=(0,Si.A)(d,!0),M=(0,Si.A)(h,!0),B=si(),{height:L,width:R}=(0,Pe.A)(),x=(0,s.li)(void 0),E=(0,s.li)(!1),{isMobile:V}=(0,Y.Ay)(),_=(0,s.li)({}),[U,O]=(0,s.Ul)(!1);function J(e,t){e&&(_.current[t]?_.current[t].current=e:_.current[t]={current:e})}(0,Ne.A)({isActive:o,onBack:f,shouldBeReplaced:!0});const G=(0,s.Kr)(()=>{if(S&&(D||M))return[S];const t=S?e.indexOf(S):-1;if(!S||-1===t)return[];const i=Math.max(t-4,0),s=Math.min(t+5,e.length);return e.slice(i,s)},[M,D,S,e]),j=(0,s.Kr)(()=>G.length&&S?G.indexOf(S):-1,[S,G]),z=(0,s.Kr)(()=>G.length&&t?G.indexOf(t):-1,[t,G]);(0,s.vJ)(()=>{V&&N(t)},[t,V]),(0,s.vJ)(()=>{S===t&&i!==k&&w(i)},[t,i,S,k]),(0,s.vJ)(()=>{if(!V)return I&&I!==t&&O(!0),()=>{O(!1)}},[I,t,O,V]),(0,s.vJ)(()=>()=>{i&&t&&C({containerId:(0,l.$_)(t,i)})},[i,t]);const H=z-j,$=j>z,q=(0,T.A)(()=>e.reduce((i,s,n)=>{if(s===S)i[s]=ii({scale:B.scale,slideAmount:H,isBackward:$,isActiveSlideSize:$});else{let o=!1;!$&&n>0&&e[n-1]===S&&(o=!0),$&&n<e.length-1&&e[n+1]===S&&(o=!0),i[s]=ii({scale:B.scale,slideAmount:H,isBackward:$,isActiveSlideSize:t===s&&!$,isMoveThroughActiveSlide:o})}return i},{}));(0,s.vJ)(()=>{if(!y.current||!o)return;let e=0;const t=()=>S?_.current[S]?.current:void 0,i=i=>{if(E.current)return void(E.current=!1);const s=t();if(s){if(e<-50){const e=document.getElementById(a.YVZ);return void(e&&(0,r.RK)(()=>{(0,Ci.A)(e)}))}e>50?(f(),"wheel"===i.type&&((0,yi.M6)(),setTimeout(yi.v5,1500))):(0,r.RK)(()=>{s.style.setProperty("--slide-translate-y","0px")})}};return(0,Ae.wJ)(y.current,{isNotPassive:!0,withNativeDrag:!0,withWheelDrag:!0,excludedClosestSelector:".Composer",onDrag:(s,n,{dragOffsetX:o,dragOffsetY:a})=>{if(E.current)return;if(m.pz&&"touchstart"===n.type){const{pageX:e}=n.touches[0];if(e<=Ae.h6||e>=R-Ae.h6)return}if("mousemove"===s.type)return;const l=Math.abs(o),c=Math.abs(a),d=t();if(d&&(x.current===os.Vertical||Math.abs(c)>Ae.no||c/l>Ae.fG)){x.current=os.Vertical;const t=L;e=(0,fe.qE)(a,-t,t),e>0&&(0,r.RK)(()=>{d.style.setProperty("--slide-translate-y",e*(V?1:-1)+"px")}),"wheel"===s.type&&Math.abs(e)>100&&(i(s),E.current=!0)}},onRelease:i})},[o,f,R,L,V,S]),(0,s.Nf)(()=>{if(V)return;const e=q();Object.entries(_.current).forEach(([i,{current:s}])=>{if(!s)return;if(!U())return s.classList.remove(Rt,xt,Vt),s.style.setProperty("--slide-translate-x","0px"),s.style.setProperty("--slide-translate-y","0px"),s.style.setProperty("--slide-translate-scale","1"),void s.style.setProperty("--slide-content-scale",String(B.toActiveScale));let n=0;i===S&&(n=-1.75*B.fromActiveScale,s.classList.add(Vt)),i===t&&(n=1.75,s.classList.add(xt)),s.classList.add(Rt),s.style.setProperty("--slide-translate-x",`${e[i]||0}px`),s.style.setProperty("--slide-translate-y",`${n}rem`),s.style.setProperty("--slide-translate-scale",t===i?String(B.toActiveScale):i===S?String(B.fromActiveScale):"1")})},[t,U,S,B,V]);const W=(0,T.A)(e=>{const s=e.target;s&&s.classList.contains(Gt)&&(S!==t?(N(t),w(i)):i!==k&&w(i),O(!1))});return V?(0,se.Y)("div",{className:Lt,ref:y,children:(0,se.Y)("div",{className:Jt,ref:e=>J(e,S),children:(0,se.Y)(ss,{peerId:S,storyId:k,onDelete:A,dimensions:B.activeSlide,isPrivateStories:F,isArchivedStories:P,isDeleteModalOpen:g,isSingleStory:h,getIsAnimating:U,onClose:f,onReport:b})})}):(0,se.FD)("div",{className:Lt,ref:y,style:`--story-viewer-scale: ${B.scale}`,onTransitionEnd:W,children:[(0,se.Y)("div",{className:Bt,onClick:f}),G.length>1&&(0,se.Y)("div",{className:"xe67dhtF",style:`height: ${B.slide.height}px`}),G.map((e,t)=>e===S?function(e){const t=V?void 0:(0,tt.A)(`width: ${B.activeSlide.width}px`,`--slide-media-height: ${B.activeSlide.height}px`);return(0,se.Y)("div",{ref:t=>J(t,e),className:(0,ge.A)(Kt,Gt),style:t,children:(0,se.Y)(ss,{peerId:e,storyId:k,onDelete:A,dimensions:B.activeSlide,isPrivateStories:F,isArchivedStories:P,isDeleteModalOpen:g,isSingleStory:h,getIsAnimating:U,onClose:f,onReport:b})},e)}(S):function(e,t,i){const s=(0,tt.A)(`width: ${B.slide.width}px`,`height: ${B.slide.height}px`),o=(0,ge.A)(Kt,"Sef28wEh",`slide-${i}`);return(0,se.Y)("div",{ref:t=>J(t,e),className:o,style:s,children:(0,se.Y)(ns,{peer:(0,c.PVB)((0,n.mS)(),e),peerStories:v?.[e]})},e)}(e,0,t-j))]})}));var rs=i(47366),ls=i(46222),cs=i(283),ds=i(36393),hs=i(51083),ms=i(17751),us=i(17794);const ps={"views-list":"gpDY8bos",viewsList:"gpDY8bos","views-list-loading":"vuRAfQ5v",viewsListLoading:"vuRAfQ5v",info:"AOSUIChK",centeredInfo:"oGLhkkS7","view-reaction":"MLaabS6n",viewReaction:"MLaabS6n",header:"d3N2bktu",content:"QmRA3HZK","top-button":"Dkv8GAxf",topButton:"Dkv8GAxf","contact-filter":"YpB_9VxE",contactFilter:"YpB_9VxE",selected:"DoUlpdZJ",sort:"axDpgq9G","sort-button":"Bm5VA66f",sortButton:"Bm5VA66f","icon-sort":"YVQiH93R",iconSort:"YVQiH93R","icon-down":"NXP9aMD0",iconDown:"NXP9aMD0",search:"QQQqBLK6","bottom-info":"_CSv6suH",bottomInfo:"_CSv6suH",scrolled:"RYQ0liYe",footer:"dUK7rP37",closeButton:"abPzLiCH","opacity-fade-in":"cX8oY3zb",opacityFadeIn:"cX8oY3zb",fadeIn:"Sx_aeh1o",blocked:"L82sciL8",check:"UqGBKwjg",menuBubble:"dRqemuTA","with-colored-status":"GQ96fta9",withColoredStatus:"GQ96fta9"},vs=1.5*g.$,gs=(0,s.ph)((0,n.EK)((e,{storyView:t})=>({peer:(0,c.PVB)(e,t.peerId),availableReactions:e.reactions.availableReactions}))(({storyView:e,peer:t,availableReactions:i})=>{const{openChat:o,closeStoryViewer:a,unblockUser:r,blockUser:c,deleteContact:d,updateStoryView:h,focusMessage:m,openStoryViewer:u,closeStoryViewModal:p}=(0,n.ko)(),g=(0,B.A)(),A=(0,T.A)(()=>{const{type:t}=e;if("repost"===t)return p(),void u({peerId:e.peerId,storyId:e.storyId});a(),setTimeout(()=>{"user"===t?o({id:e.peerId}):"forward"===t&&m({chatId:e.peerId,messageId:e.messageId})},100)}),f=(0,s.Kr)(()=>{if(!(0,v.L8)(e.peerId))return;const{peerId:i,areStoriesBlocked:s,isUserBlocked:n}=e,o=t,{isContact:a}=o||{},m=(0,l.Yg)(o),u=[];return n||(s?u.push({handler:()=>{r({userId:i,isOnlyStories:!0}),h({userId:i,areStoriesBlocked:!1})},title:g("StoryShowBackTo",m),icon:"play-story"}):u.push({handler:()=>{c({userId:i,isOnlyStories:!0}),h({userId:i,areStoriesBlocked:!0})},title:g("StoryHideFrom",m),icon:"hand-stop"})),a?u.push({handler:()=>{d({userId:i})},title:g("DeleteContact"),icon:"delete-user",destructive:!0}):u.push({handler:()=>{n?(r({userId:i}),h({userId:i,isUserBlocked:!1})):(c({userId:i}),h({userId:i,isUserBlocked:!0}))},title:g(n?"Unblock":"BlockUser"),icon:n?"user":"delete-user",destructive:!n}),u},[g,e,t]),b="user"===e.type?"message-read":"forward"===e.type?"forward":"loop",C="forward"===e.type||"repost"===e.type,y=(0,s.Kr)(()=>{const t="repost"===e.type&&e.story.forwardInfo?.isModified,i=[(0,We.U)(g,1e3*e.date)];return t&&i.push(g("lng_edited")),i.join(" â€¢ ")},[g,e]);return(0,se.Y)(li.A,{className:(0,ge.A)("chat-item-clickable small-icon",ps.opacityFadeIn,(e.isUserBlocked||e.areStoriesBlocked)&&ps.blocked),onClick:A,rightElement:"user"===e.type&&e.reaction?(0,se.Y)(us.A,{reaction:e.reaction,className:ps.viewReaction,size:vs,availableReactions:i,withIconHeart:!0}):void 0,contextActions:f,withPortalForMenu:!0,menuBubbleClassName:ps.menuBubble,children:(0,v.L8)(e.peerId)?(0,se.Y)(ms.A,{className:(0,ge.A)(C&&ps.withColoredStatus),userId:e.peerId,noStatusOrTyping:!0,status:y,statusIcon:b,withStory:!0,forceShowSelf:!0}):(0,se.Y)(hs.A,{className:(0,ge.A)(C&&ps.withColoredStatus),chatId:e.peerId,status:y,statusIcon:b,withStory:!0})},e.peerId)})),As=(0,s.ph)((0,n.EK)(e=>{const{appConfig:t}=e,{storyViewer:{viewModal:i}}=(0,c.nTw)(e),{storyId:s,views:n,nextOffset:o,isLoading:a}=i||{},r=s?(0,c.Msb)(e,e.currentUserId,s):void 0,l="story"===r?.["@type"]?r.expireDate:void 0;return{views:n,viewersExpireDate:l?l+t.storyViewersExpirePeriod:void 0,story:r&&"content"in r?r:void 0,nextOffset:o,isLoading:a,isCurrentUserPremium:(0,c.g29)(e)}})(function({story:e,viewersExpireDate:t,views:i,nextOffset:o,isLoading:r,isCurrentUserPremium:l}){const{loadStoryViewList:c,closeStoryViewModal:d,clearStoryViews:h}=(0,n.ko)(),[m,u,p]=(0,D.A)(!1),[v,g,A]=(0,D.A)(!0),[f,b]=(0,s.J0)(""),C=(0,B.A)(),y=Boolean(e),S=Boolean(t)&&t<(0,Ii.Fm)(),{viewsCount:N=0,reactionsCount:k=0}=e?.views||{},w=e?.isPublic&&N>a.XQO,I=k>a.$4F,P=N>a.frj,Y=w||I||P;(0,s.vJ)(()=>{y||(b(""),p(),g())},[y]);const F=(0,ye.A)(()=>{h({isLoading:!0})},[],250,!0);(0,s.vJ)(()=>{F()},[m,v,f,F]);const M=(0,s.Kr)(()=>i?.sort(function(e){return(t,i)=>{if(e){const e="user"===t.type&&t.reaction,s="user"===i.type&&i.reaction;if(e&&!s)return-1;if(!e&&s)return 1}return i.date-t.date}}(v)),[v,i]),L=M?.length?1:Math.min(N,8),R=Boolean(M?.length)&&M.length<N&&S,x=(0,T.A)(()=>{e?.id&&void 0!==o&&c({peerId:e.peerId,storyId:e.id,offset:o,areReactionsFirst:v||void 0,areJustContacts:m||void 0,query:f})}),{handleScroll:E,isAtBeginning:V}=(0,rs.A)(),_=(0,T.A)(()=>{d()}),U=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.FD)(X.A,{fluid:!0,size:"tiny",color:"translucent",className:(0,ge.A)(!t&&"active",ps.sortButton,ps.topButton),faded:t,onClick:e,ariaLabel:C("SortBy"),children:[(0,se.Y)(he.A,{name:v?"heart-outline":"recent",className:ps.iconSort}),(0,se.Y)(he.A,{name:"down",className:ps.iconDown})]}),[v,C]);return(0,se.FD)(te.A,{isOpen:y,onClose:_,className:"component-theme-dark",contentClassName:ps.viewsList,isSlim:!0,children:[Y&&(0,se.FD)("div",{className:ps.header,children:[w&&(0,se.FD)("div",{className:ps.contactFilter,children:[(0,se.Y)(X.A,{className:(0,ge.A)(!m&&ps.selected,ps.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:p,children:C("AllViewers")}),(0,se.Y)(X.A,{className:(0,ge.A)(m&&ps.selected,ps.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:u,children:C("Contacts")})]}),I&&(0,se.FD)(me.A,{className:ps.sort,trigger:U,positionX:"right",children:[(0,se.FD)(ue.A,{icon:"heart-outline",onClick:g,children:[C("SortByReactions"),v&&(0,se.Y)(he.A,{name:"check",className:ps.check})]}),(0,se.FD)(ue.A,{icon:"recent",onClick:A,children:[C("SortByTime"),!v&&(0,se.Y)(he.A,{name:"check",className:ps.check})]})]}),P&&(0,se.Y)(ds.A,{className:ps.search,value:f,onChange:b})]}),(0,se.FD)("div",{className:(0,ge.A)(ps.content,!V&&ps.topScrolled,"custom-scroll"),onScroll:E,children:[S&&!r&&!f&&Boolean(!M?.length)&&(0,se.Y)("div",{className:(0,ge.A)(ps.info,ps.centeredInfo),children:(0,Pt.A)(C(l?"ServerErrorViewers":"ExpiredViewsStub"),["simple_markdown","emoji"])}),!r&&Boolean(f.length)&&!M?.length&&(0,se.Y)("div",{className:ps.info,children:C("Story.ViewList.EmptyTextSearch")}),(0,se.FD)(ls.A,{items:M,onLoadMore:x,children:[M?.map(e=>{const t="forward"===e.type?e.messageId:"repost"===e.type?e.storyId:"user";return(0,se.Y)(gs,{storyView:e},`${e.peerId}-${e.date}-${t}`)}),r&&Array.from({length:L}).map((e,t)=>(0,se.Y)(li.A,{className:"chat-item-clickable contact-list-item scroll-item small-icon",disabled:!0,children:(0,se.Y)(cs.A,{})},`placeholder-${t}`)),R&&(0,se.Y)("div",{className:(0,ge.A)(ps.info,ps.bottomInfo),children:C("Story.ViewList.NotFullyRecorded")},"not-all-available")]})]}),(0,se.Y)("div",{className:(0,ge.A)(ps.footer,"dialog-buttons"),children:(0,se.Y)(X.A,{className:(0,ge.A)("confirm-dialog-button",ps.close),isText:!0,onClick:_,children:C("Close")})})]})})),fs=(0,s.ph)((0,n.EK)(e=>{const{shouldSkipHistoryAnimations:t,storyViewer:{storyId:i,peerId:s,isPrivacyModalOpen:n,origin:o}}=(0,c.nTw)(e),a=s&&i?(0,c.Msb)(e,s,i):void 0,r=(0,c.xYJ)(e,"mediaViewerAnimations");return{isOpen:(0,c.gd2)(e),shouldSkipHistoryAnimations:t,peerId:s,storyId:i,story:a,origin:o,withAnimation:r,isPrivacyModalOpen:n}})(function({isOpen:e,peerId:t,storyId:i,story:o,origin:l,shouldSkipHistoryAnimations:c,withAnimation:d,isPrivacyModalOpen:h}){const{closeStoryViewer:m,closeStoryPrivacyEditor:v,reportStory:g}=(0,n.ko)(),A=(0,B.A)(),[f,b]=(0,s.J0)(void 0),[y,S,N]=(0,D.A)(!1),{bestImageData:w,thumbnail:I}=ni(o),P=si(),Y=(0,K.A)(e),F=(0,K.A)(w),M=(0,K.A)(t),L=(0,K.A)(l),R=Boolean(d&&!c);(0,s.vJ)(()=>{e||(b(void 0),N())},[e]),(0,s.vJ)(()=>{if(!e)return;(0,p.FD)();const t=(0,J.w4)();return()=>{(0,p.wb)(),t()}},[e]);const x=(0,s.hb)(()=>{m()},[m]),E=(0,T.A)(e=>{b(e),S()}),V=(0,T.A)(()=>{N(),b(void 0)}),_=(0,T.A)(()=>{i&&g({storyId:i,peerId:t})});return(0,s.vJ)(()=>e?(0,u.A)(()=>{x()}):void 0,[x,e]),(0,s.vJ)(()=>{R&&!Y&&e&&t&&I&&void 0!==l&&((0,s.VK)(250+a.xB5),function(e,t,i,s,n){const{mediaEl:o}=ti(t,e);if(!o)return;const{width:l,height:c}=k.A.get();let{width:d,height:h}=n;const m=l<=600;if(m){d=l-2*Xt,h=c-Zt-2*Xt;const e=getComputedStyle(document.documentElement).getPropertyValue("--safe-area-bottom");e&&(h-=parseFloat(e))}const u=m?Xt:(l-d)/2,p=m?Xt:(c-(h+Zt))/2,{top:v,left:g,width:A,height:f}=o.getBoundingClientRect(),b=g+A/2-(u+d/2),y=v+f/2-(p+h/2),S=A/d,N=f/h;(0,r.RK)(()=>{const e=ei(s||i,!s);(0,C.ZM)(e,{top:`${p}px`,left:`${u}px`,width:`${d}px`,height:`${h}px`,transform:`translate3d(${b}px, ${y}px, 0) scale(${S}, ${N})`});const t=document.getElementById("StoryViewer");t.appendChild(e),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{(0,C.ZM)(e,{transform:""}),setTimeout(()=>{(0,r.RK)(()=>{t.contains(e)&&t.removeChild(e),document.body.classList.remove("ghost-animating")})},200+a.xB5)})})}(t,l,I,w,P.activeSlide)),R&&Y&&!e&&M&&F&&void 0!==L&&((0,s.VK)(250+a.xB5),function(e,t,i){const{mediaEl:s}=ti(t,e),n=document.getElementById("StoryViewer").querySelector(`.${Jt} .${_t}, .${Gt} .${_t}`);if(!n||!s)return;const{top:o,left:l,width:c,height:d}=n.getBoundingClientRect(),{top:h,left:m,width:u,height:p}=s.getBoundingClientRect(),v=m+u/2-(l+c/2),g=h+p/2-(o+d/2),A=u/c,f=p/d;(0,r.RK)(()=>{const e=ei(i);(0,C.ZM)(e,{top:`${o}px`,left:`${l}px`,width:`${c}px`,height:`${d}px`});const t=ei(s.src,void 0,!0),n=o+d/2-c/2;(0,C.ZM)(t,{top:`${n}px`,left:`${l}px`,width:`${c}px`,height:`${c}px`});const h=document.getElementById("StoryViewer");h.appendChild(e),document.body.appendChild(t),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{(0,C.ZM)(e,{transform:`translate3d(${v}px, ${g}px, 0) scale(${A}, ${f})`}),(0,C.ZM)(t,{transform:`translate3d(${v}px, ${g}px, 0) scale(${A})`,opacity:"1"}),setTimeout(()=>{(0,r.RK)(()=>{h.contains(e)&&h.removeChild(e),document.body.contains(t)&&document.body.removeChild(t),document.body.classList.remove("ghost-animating")})},200+a.xB5)})})}(M,L,F))},[R,w,F,e,Y,P.activeSlide,I,t,M,l,L]),(0,se.FD)(oe.A,{id:"StoryViewer",className:"bu_hGbaa",isOpen:e,shouldAnimateFirstRender:!0,noCloseTransition:c,children:[(0,se.Y)("div",{className:"OFh6u50Q",onClick:x}),(0,se.Y)(X.A,{className:"Mye8Dwxa",round:!0,size:"tiny",color:"translucent-white",ariaLabel:A("Close"),onClick:x,iconName:"close"}),(0,se.Y)(as,{isOpen:e,isDeleteModalOpen:y,onReport:_,onClose:x,onDelete:E}),(0,se.Y)(ai,{isOpen:y,story:f,onClose:V}),(0,se.Y)(As,{}),(0,se.Y)(bi,{isOpen:h,onClose:v})]})}));var bs=i(64520),Cs=i(79582),ys=i(74984),Ss=i(8247),Ns=i(24680),ks=i(30708),ws=i(31460),Is=i(63527),Ps=i(96374),Ys=i(79174),Fs=i(10328),Ds=i(52745),Ms=i(34431),Ts=i(38102),Bs=i(45780);const Ls=2.75*g.$,Rs="ChatOrUserPicker-item";function xs({isOpen:e,viewportIds:t,maxHeight:i,onLoadMore:n,onSelect:o,onKeyDownHandlerUpdate:a,renderItem:r}){const l=(0,Fi.A)(),c=(0,s.li)(),d=(0,Fs.A)(c,e,o,`.${Rs}`,!0);return(0,s.vJ)(()=>{a(d)},[d,a]),(0,se.Y)(se.FK,{children:t?.length?(0,se.Y)(ls.A,{ref:c,className:"picker-list custom-scroll",items:t,itemSelector:`.${Rs}`,onLoadMore:n,withAbsolutePositioning:!0,maxHeight:i,onKeyDown:d,children:t.map(r)}):t&&!t.length?(0,se.Y)("p",{className:"no-results",children:l("NothingFound")}):(0,se.Y)(Ds.A,{})})}const Es=(0,s.ph)((0,n.EK)(e=>({animationLevel:(0,ks.Vu)(e),shouldSkipHistoryAnimations:(0,c.nTw)(e).shouldSkipHistoryAnimations}))(({isOpen:e,currentUserId:t,chatOrUserIds:i,search:o,searchPlaceholder:r,className:d,isLowStackPriority:h,subheader:m,listActiveKey:u,animationLevel:p,shouldSkipHistoryAnimations:v,loadMore:g,onSearchChange:A,onSelectChatOrUser:f,onClose:b,onCloseAnimationEnd:C})=>{const{loadTopics:y}=(0,n.ko)(),S=(0,B.A)(),N=(0,Fi.A)(),[k,w]=(0,s.J0)(),I=(0,s.li)(),P=(0,s.li)(),Y=(0,s.li)(),[F,D]=(0,Ps.A)(g,i,Boolean(o)),[M,L]=(0,s.J0)(void 0),[R,x]=(0,s.J0)(""),E=M?1:0,V=i.indexOf(F[0]),_=(0,T.A)(()=>{A("")});(0,Ys.A)(P,e&&0===E,_),(0,Ys.A)(Y,e&&1===E);const U=(0,T.A)(e=>{if(M)return(0,c.pSx)(e,M)}),O=(0,Is.A)(U),[K,J]=(0,s.Kr)(()=>{const e=(0,n.mS)(),t=e.chats.byId,i=e.chats.fullInfoById,s=t[M];if(!s||!O)return[void 0,void 0];const o=R.toLowerCase(),a=O?Object.values(O).reduce((e,t)=>(!(0,l.__)(s,t,void 0,i[M])||o&&!t.title.toLowerCase().includes(o)||(e[t.id]=t),e),{}):O;return[Object.keys(a).map(Number),a]},[M,R,O]),G=(0,T.A)(()=>{L(void 0),x("")}),j=(0,T.A)(e=>{A(e.currentTarget.value)}),z=(0,T.A)(e=>{x(e.currentTarget.value)}),H=(0,T.A)(e=>{if(F&&F.length>0){const t=(0,n.mS)().chats.byId,i=F[-1===e?0:e],s=t[i];s?.isForum?(O||y({chatId:i}),L(i)):f(i)}}),$=(0,T.A)(e=>{w(()=>e)}),q=(0,Fs.A)(I,e,e=>{K?.length&&f(M,K[-1===e?0:e])},`.${Rs}`,!0),W=(0,T.A)(e=>{const t=(0,n.mS)().chats.byId,i=t?.[e];i?.isForum?(O||y({chatId:e}),L(e),_()):f(e)}),Q=(0,s.hb)((e,i)=>{const s=(0,n.mS)();let o=(0,c.PVB)(s,e);if(!o)return;const r=(0,c.k2W)(s,e);r&&(o=r);const d=o&&!(0,It.vj)(o)?o.isSelf:void 0,[h,m]=function(){if(!o)return;if(o.id===t)return[S("SavedMessagesInfo")];if((0,It.vj)(o))return[(0,l.sT)(N,o)];const e=(0,c.K0y)(s,o.id);return[(0,l.CD)(S,o,e),(0,ge.A)((0,l.PF)(o,e,!0)&&"online")]}()||[];return(0,se.Y)(Bs.A,{className:Rs,title:(0,se.Y)("div",{className:"title-wrapper",children:(0,se.Y)(Ms.A,{className:"item-title",peer:o,isMonoforum:Boolean(r),isSavedMessages:d})}),avatarElement:(0,se.Y)(Yt.A,{peer:o,asMessageBubble:Boolean(r),isSavedMessages:d,size:"medium"}),subtitle:h,subtitleClassName:m,ripple:!0,style:`top: ${(V+i)*a.xw7}px;`,onClick:()=>W(e)},e)},[t,S,N,V]);return(0,se.Y)(te.A,{isOpen:e,className:(0,ge.A)("ChatOrUserPicker",d),isLowStackPriority:h,onClose:b,onCloseAnimationEnd:C,children:(0,se.Y)(ae.Ay,{activeKey:E,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",children:()=>1===E?(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{className:"modal-header modal-header-condensed",dir:N.isRtl?"rtl":void 0,children:(0,se.FD)("div",{className:"search-wrapper",children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:S("Back"),onClick:G,iconName:"arrow-left"}),(0,se.Y)(ee.A,{ref:Y,value:R,onChange:z,onKeyDown:q,placeholder:r})]})}),K?.length?(0,se.Y)(ls.A,{ref:I,className:"picker-list custom-scroll",items:K,withAbsolutePositioning:!0,maxHeight:56*(K?.length||0),onKeyDown:q,children:K.map((e,t)=>(0,se.Y)(Bs.A,{className:Rs,onClick:()=>f(M,e),style:`top: ${56*t}px;`,avatarElement:(0,se.Y)(Ts.A,{size:Ls,topic:J[e],className:"topic-icon",letterClassName:"topic-icon-letter"}),title:(0,Pt.A)(J[e].title)},`${M}_${e}`))}):K&&!K.length?(0,se.Y)("p",{className:"no-results",children:N("NothingFound")}):(0,se.Y)(Ds.A,{})]}):(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:"modal-header modal-header-condensed",dir:N.isRtl?"rtl":void 0,children:[(0,se.FD)("div",{className:"search-wrapper",children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:S("Close"),onClick:b,iconName:"close"}),(0,se.Y)(ee.A,{ref:P,value:o,onChange:j,onKeyDown:k,placeholder:r})]}),m]}),(0,se.Y)(ae.Ay,{activeKey:u||0,name:(0,ws.P)("slideOptimized",p,v,N.isRtl),slideClassName:"ChatOrUserPicker_slide",children:(0,se.Y)(xs,{isOpen:e,viewportIds:F,maxHeight:i.length*a.xw7,onLoadMore:D,onSelect:H,renderItem:Q,onKeyDownHandlerUpdate:$})})]})})})})),Vs=(0,s.ph)((0,n.EK)(e=>{const{chatFolders:{byId:t,orderedIds:i},chats:{listIds:s,orderedPinnedIds:n},currentUserId:o}=e;return{activeListIds:s.active,archivedListIds:s.archived,pinnedIds:n.active,contactIds:e.contactList?.userIds,currentUserId:o,chatFoldersById:t,orderedFolderIds:i,maxFolders:(0,bs.d)(e,"dialogFilters")}})(({isOpen:e,currentUserId:t,activeListIds:i,archivedListIds:o,pinnedIds:r,contactIds:d,filter:h=a.K_A,className:m,searchPlaceholder:u,isLowStackPriority:p,chatFoldersById:v,orderedFolderIds:g,isForwarding:A,maxFolders:f,withFolders:b,loadMore:C,onSelectRecipient:y,onClose:S,onCloseAnimationEnd:N})=>{const{openLimitReachedModal:k}=(0,n.ko)(),[w,I]=(0,s.J0)(""),[P,Y]=(0,s.J0)(0),{displayedFolders:F,folderTabs:D}=(0,Ss.A)({sidebarMode:!1,orderedFolderIds:g,chatFoldersById:v,maxFolders:f,isReadOnly:!0}),M=b&&D?.length&&!w,B=F?.[P]?.id||a.DSF,L=(0,ys.Rh)(B),R=(0,T.A)(e=>{const t=D?.[e];t&&(t.isBlocked?k({limit:"dialogFilters"}):Y(e))}),x=(0,s.Kr)(()=>{if(!e)return;let s=r||[];t&&(s=(0,di.Am)([t,...s]));const a=(0,n.mS)(),m=(M?L||[]:[...i||[],...w&&o||[]]).filter(e=>{const t=(0,c.hds)(a,e),i=(0,c.mBe)(a,e),s=t&&(0,l.ub)(t,"postMessages"),n=t&&(0,l.WX)(t);if(A&&n&&!s)return!1;if(i&&!(0,l.PL)(i))return!0;if(!t)return!1;if(t.isMonoforum&&(0,c.ODG)(a,e))return!1;const o=(0,c.AWZ)(a,e);return!o||(0,l.__)(t,void 0,void 0,o)}),u=M?m:(0,di.Am)([...t?[t]:[],...m,...d||[]]),p=(0,Cs.A)((0,It.PU)({ids:u,query:w}),void 0,s,t);return(0,c.yMZ)(a,p,h)},[e,r,t,i,w,o,d,h,A,L,M]),E=(0,Si.A)(x,!0),V=(0,s.Kr)(()=>{if(M)return(0,se.Y)(Ns.A,{tabs:D,activeTab:P,onSwitchTab:R})},[D,P,M]);return(0,se.Y)(Es,{isOpen:e,className:m,chatOrUserIds:E,currentUserId:t,searchPlaceholder:u,search:w,subheader:V,listActiveKey:P,onSearchChange:I,loadMore:C,onSelectChatOrUser:y,onClose:S,onCloseAnimationEnd:N,isLowStackPriority:p})})),_s=(0,s.ph)((0,n.EK)(e=>{const{messageIds:t,storyId:i}=(0,c.nTw)(e).forwardMessages,s=t&&t.length>0;return{currentUserId:e.currentUserId,isManyMessages:(t?.length||0)>1,isStory:Boolean(i),isForwarding:s}})(({isOpen:e,currentUserId:t,isManyMessages:i,isStory:o,isForwarding:a})=>{const{openChatOrTopicWithReplyInDraft:r,setForwardChatOrTopic:d,exitForwardMode:h,forwardToSavedMessages:m,forwardStory:u,showNotification:p}=(0,n.ko)(),g=(0,B.A)(),A=(0,K.A)(o,!0),[f,b,C]=(0,D.A)();(0,s.vJ)(()=>{e&&b()},[e,b]);const y=(0,s.hb)((e,s)=>{const h=e===t;if(o){u({toChatId:e});const t=(0,n.mS)();if((0,v.L8)(e))p({message:h?g("Conversation.StoryForwardTooltip.SavedMessages.One"):g("StorySharedTo",(0,l.u0)((0,c.mBe)(t,e)))});else{const i=(0,c.hds)(t,e);if(!i)return;p({message:g("StorySharedTo",(0,l.Js)(g,i))})}return}if(h){const e=g(i?"Conversation.ForwardTooltip.SavedMessages.Many":"Conversation.ForwardTooltip.SavedMessages.One");m(),p({message:e})}else{const t=e,i=s?Number(s):void 0;a?d({chatId:t,topicId:i}):r({chatId:t,topicId:i})}},[t,i,o,g,a]),S=(0,s.hb)(()=>{h()},[h]);if(e||f)return(0,se.Y)(Vs,{isOpen:e,className:A?"component-theme-dark":void 0,searchPlaceholder:g(a?"ForwardTo":"ReplyToDialog"),onSelectRecipient:y,onClose:S,onCloseAnimationEnd:C,isForwarding:a,withFolders:!0})})),Us=(0,s.ph)(({requestedDraft:e})=>{const t=Boolean(e&&!e.chatId),{openChatWithDraft:i,resetOpenChatWithDraft:o}=(0,n.ko)(),a=(0,B.A)(),[r,l,c]=(0,D.A)();(0,s.vJ)(()=>{t&&l()},[t,l]);const d=(0,s.hb)((t,s)=>{i({chatId:t,threadId:s,text:e.text,files:e.files})},[i,e]),h=(0,s.hb)(()=>{o()},[o]);if(t||r)return(0,se.Y)(Vs,{isOpen:t,searchPlaceholder:a("ForwardTo"),filter:e?.filter,onSelectRecipient:d,onClose:h,onCloseAnimationEnd:c})}),Os=(0,s.ph)(({requestedAttachBotInChat:e})=>{const{cancelAttachBotInChat:t,callAttachBot:i}=(0,n.ko)(),o=(0,B.A)(),a=Boolean(e),[r,l,c]=(0,D.A)();(0,s.vJ)(()=>{a&&l()},[a,l]);const{bot:d,filter:h,startParam:m}=e||{},u=(0,s.hb)(e=>{i({bot:d,chatId:e,startParam:m}),t()},[d,i,t,m]);if(a||r)return(0,se.Y)(Vs,{isOpen:a,searchPlaceholder:o("Search"),filter:h,onSelectRecipient:u,onClose:t,onCloseAnimationEnd:c})});var Ks=i(26087),Js=i(24585);const Gs=(0,s.ph)(({url:e})=>{const{toggleSafeLinkModal:t}=(0,n.ko)(),i=(0,Fi.A)(),o=(0,s.hb)(()=>{e&&(window.open((0,Js.Tc)(e),"_blank","noopener noreferrer"),t({url:void 0}))},[t,e]),a=(0,s.hb)(()=>{t({url:void 0})},[t]),r=(0,Si.A)(e);return(0,se.Y)(oi.A,{isOpen:Boolean(e),onClose:a,title:i("OpenUrlTitle"),textParts:(0,Pt.A)(i("OpenUrlText",{url:r},{withNodes:!0,withMarkdown:!0})),confirmLabel:i("OpenUrlConfirm"),confirmHandler:o})});var js=i(47526);const zs=(0,s.ph)(({modal:e})=>{const{closeMapModal:t}=(0,n.ko)(),{point:i,zoom:o}=e||{},a=(0,B.A)(),r=Boolean(i),l=(0,T.A)(()=>{t()}),[c,d,h,u]=(0,s.Kr)(()=>{if(!i)return[];const e=(0,js.zS)("google",i,o),t=(0,js.zS)("bing",i,o),s=(0,js.zS)("osm",i,o);return[e,t,(0,js.zS)("apple",i,o),s]},[i,o]),p=(0,T.A)(e=>{t(),window.open(e,"_blank","noopener")}),v=(0,T.A)(()=>{p(c)}),g=(0,T.A)(()=>{p(d)}),A=(0,T.A)(()=>{p(h)}),f=(0,T.A)(()=>{p(u)});return(0,se.FD)(te.A,{contentClassName:"VJDwJpsF",title:a("OpenMapWith"),isOpen:r,onClose:l,isSlim:!0,children:[(0,se.FD)("div",{className:"aYO2C2Hx",children:[(m.pz||m.MP)&&(0,se.Y)(X.A,{fluid:!0,size:"smaller",onClick:A,children:"Apple Maps"}),(0,se.Y)(X.A,{fluid:!0,size:"smaller",onClick:v,children:"Google Maps"}),(0,se.Y)(X.A,{fluid:!0,size:"smaller",onClick:g,children:"Bing Maps"}),(0,se.Y)(X.A,{fluid:!0,size:"smaller",onClick:f,children:"OpenStreetMap"})]}),(0,se.Y)("div",{className:"dialog-buttons mt-2",children:(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:l,children:a("Cancel")})})]})});var Hs=i(19806);const $s=(0,s.ph)((0,n.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({modal:e,currentUser:t})=>{const{closeUrlAuthModal:i,acceptBotUrlAuth:o,acceptLinkUrlAuth:a}=(0,n.ko)(),[r,c]=(0,s.J0)(!0),[d,h]=(0,s.J0)(!0),m=(0,Si.A)(e,!1),{domain:u,botId:p,shouldRequestWriteAccess:v}=m?.request||{},g=p?(0,n.mS)().users.byId[p]:void 0,A=(0,B.A)(),f=(0,s.hb)(()=>{e?.url&&r?(e.button?o:a)({isWriteAllowed:d}):m?.url&&window.open((0,Js.Tc)(m.url),"_blank","noopener"),i()},[e,r,i,o,a,d,m]),b=(0,s.hb)(()=>{i()},[i]),C=(0,s.hb)(e=>{c(e),h(e)},[c]);return(0,s.vJ)(()=>{u&&(c(!0),h(Boolean(v)))},[v,u]),(0,se.FD)(oi.A,{isOpen:Boolean(e?.url),onClose:b,title:A("OpenUrlTitle"),confirmLabel:A("OpenUrlTitle"),confirmHandler:f,children:[(0,Pt.A)(A("OpenUrlAlert2",m?.url),["links"]),u&&(0,se.Y)(Hs.A,{className:"dialog-checkbox",checked:r,label:(0,se.Y)(se.FK,{children:(0,Pt.A)(A("Conversation.OpenBotLinkLogin",[u,(0,l.Yg)(t)]),["simple_markdown"])}),onCheck:C}),v&&(0,se.Y)(Hs.A,{className:"dialog-checkbox",checked:d,label:(0,se.Y)(se.FK,{children:(0,Pt.A)(A("Conversation.OpenBotLinkAllowMessages",(0,l.Yg)(g)),["simple_markdown"])}),onCheck:h,disabled:!r})]})}));var qs=i(15379),Ws=i(10722);const Qs=1e3*a.fRl,Zs=["lng_weekday1","lng_weekday2","lng_weekday3","lng_weekday4","lng_weekday5","lng_weekday6","lng_weekday7"];function Xs(e,t,i,s,n){const o=new Date(e,t,i),a=s&&(0,We.pU)(s),r=n&&(0,We.pU)(n);return!!(r&&o>r)||!!(a&&o<a)}function en(e){return String(e).padStart(2,"0")}function tn(e,t,i){return`${e}-${t+1}-${i}`}const sn=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.g29)(e);return{isTestServer:e.config?.isTestServer,isCurrentUserPremium:t}})(({selectedAt:e,minAt:t,maxAt:i,isFutureMode:o,isPastMode:a,isOpen:r,withTimePicker:l,withRepeatMode:c,initialRepeatMode:d,submitButtonLabel:h,secondButtonLabel:m,description:u,isTestServer:p,isCurrentUserPremium:v,onClose:g,onSubmit:A,onDateChange:f,onSecondButtonClick:b})=>{const{showNotification:C}=(0,n.ko)(),y=(0,s.li)(),S=(0,s.li)(),N=(0,B.A)(),k=(0,Fi.A)(),w=new Date,{isContextMenuOpen:I,contextMenuAnchor:P,handleContextMenu:Y,handleContextMenuClose:F,handleContextMenuHide:M}=(0,Ws.A)(y),L=(0,T.A)(()=>S.current),R=(0,T.A)(()=>y.current.querySelector(".bubble")),x=(0,T.A)(()=>S.current.querySelector(".repeat-mode-button")),E=(0,s.Kr)(()=>o&&!t?new Date:new Date(Math.max(t||0,0)),[o,t]),V=(0,s.Kr)(()=>a&&!i?new Date:new Date(Math.min(i||Qs,Qs)),[a,i]),_=(0,s.Kr)(()=>e?new Date(e):new Date,[e]),U=(0,K.A)(r),[O,J]=(0,D.A)(!1),[G,j]=(0,s.J0)(_),[z,H]=(0,s.J0)(()=>new Date(G.getFullYear(),G.getMonth(),1)),[$,q]=(0,s.J0)(()=>en(_.getHours())),[W,Q]=(0,s.J0)(()=>en(_.getMinutes())),[Z,ee]=(0,s.J0)(d||"never"),ie=tn(G.getFullYear(),G.getMonth(),G.getDate()),ne=z.getFullYear(),oe=z.getMonth(),ae=o&&G.getTime()<E.getTime()||a&&G.getTime()>V.getTime();(0,s.vJ)(()=>{r||ee("never")},[r]),(0,s.vJ)(()=>{ee(d||"never")},[d]),(0,s.vJ)(()=>{!U&&r&&(j(_),H(new Date(_.getFullYear(),_.getMonth(),1)),l&&(q(en(_.getHours())),Q(en(_.getMinutes()))))},[_,r,U,l]),(0,s.vJ)(()=>{o&&!O&&G.getTime()<E.getTime()&&(j(E),q(en(E.getHours())),Q(en(E.getMinutes())))},[o,O,E,G]),(0,s.vJ)(()=>{a&&!O&&G.getTime()>V.getTime()&&(j(V),q(en(V.getHours())),Q(en(V.getMinutes())))},[o,a,O,V,E,G]),(0,s.vJ)(()=>{if(e){const t=new Date(e);j(t),q(en(t.getHours())),Q(en(t.getMinutes()))}},[e]);const re=a&&ne>=w.getFullYear()&&oe>=w.getMonth()||V&&ne>=V.getFullYear()&&oe>=V.getMonth(),le=o&&ne<=w.getFullYear()&&oe<=w.getMonth(),{prevMonthGrid:ce,currentMonthGrid:de,nextMonthGrid:he}=(0,s.Kr)(()=>function(e,t){const i=[],s=[],n=[],o=new Date;o.setDate(1),o.setMonth(t),o.setFullYear(e);const a=o.getDay()||7,r=new Date(e,t,0).getDate();for(let e=1;e<a;e++)i.push(r-a+e+1);for(;o.getMonth()===t;){const e=o.getDate();s.push(e),o.setDate(e+1)}const l=(s.length+i.length)%7;if(l>0)for(let e=1;e<=7-l;e++)n.push(e);return{prevMonthGrid:i,currentMonthGrid:s,nextMonthGrid:n}}(ne,oe),[oe,ne]),me=(0,s.Kr)(()=>h||function(e,t){const i=(0,We.A)(t,e.code);return i===(0,We.A)(new Date,e.code)?e("Conversation.ScheduleMessage.SendToday",(0,We.fU)(e,t)):e("Conversation.ScheduleMessage.SendOn",[i,(0,We.fU)(e,t)])}(N,G),[N,G,h]),pe=(0,T.A)(e=>{v?Y(e):C({message:k("MessageScheduledRepeatPremium"),action:{action:"openPremiumModal",payload:{}},actionText:k("PremiumMore")})}),ve=(0,s.hb)(()=>{A(o&&G<E?E:a&&G>V?V:G,c&&"never"!==Z?Z:void 0)},[o,a,E,V,A,G,c,Z]),Ae=(0,s.hb)(e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return q(""),void(e.target.value="");const i=Math.max(0,Math.min(Number(t),23)),s=new Date(G.getTime());s.setHours(i),j(s),f?.(s);const n=en(i);q(n),e.target.value=n},[G,f]),fe=(0,s.hb)(e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return Q(""),void(e.target.value="");const i=Math.max(0,Math.min(Number(t),59)),s=new Date(G.getTime());s.setMinutes(i),j(s),f?.(s);const n=en(i);Q(n),e.target.value=n},[G,f]),be=(0,s.hb)(e=>(0,se.Y)(ue.A,{onClick:()=>ee(e),children:(0,qs.j5)(e,k)},e),[k]),Ce=(0,s.Kr)(()=>qs.to.filter(e=>p||!qs.Vb.has(e)),[p]);return(0,se.FD)(te.A,{isOpen:r,onClose:g,className:"CalendarModal",onEnter:ve,dialogRef:S,hasAbsoluteCloseButton:!0,children:[(0,se.Y)("div",{className:"container",children:(0,se.FD)("div",{className:"month-selector",children:[(0,se.FD)("h4",{children:[N(`lng_month${oe+1}`)," ",ne]}),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",iconName:"previous",disabled:le,onClick:le?void 0:function(){H(e=>{const t=new Date(e);return t.setMonth(t.getMonth()-1),t})}}),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",iconName:"next",disabled:re,onClick:re?void 0:function(){H(e=>{const t=new Date(e);return t.setMonth(t.getMonth()+1),t})}})]})}),(0,se.Y)("div",{className:"calendar-wrapper",children:(0,se.FD)("div",{className:"calendar-grid",children:[Zs.map(e=>(0,se.Y)("div",{className:"day-button faded weekday",children:(0,se.Y)("span",{children:N(e)})})),ce.map(e=>(0,se.Y)("div",{className:"day-button disabled",children:(0,se.Y)("span",{children:e})})),de.map(e=>(0,se.Y)("div",{role:"button",tabIndex:0,onClick:()=>{return t=e,void j(e=>{const i=new Date(e);return i.setDate(t),i.setMonth(oe),i.setFullYear(ne),f?.(i),i});var t},className:(0,ge.A)("day-button","div-button",Xs(ne,oe,e,E,V)?"disabled":e?"clickable":"",ie===tn(ne,oe,e)&&"selected"),children:Boolean(e)&&(0,se.Y)("span",{children:e})})),he.map(e=>(0,se.Y)("div",{className:"day-button disabled",children:(0,se.Y)("span",{children:e})}))]})}),l&&(0,se.FD)("div",{className:"timepicker",children:[(0,se.Y)("input",{type:"text",className:"form-control",inputMode:"decimal",value:$,onChange:Ae,onFocus:J}),":",(0,se.Y)("input",{type:"text",className:"form-control",inputMode:"decimal",value:W,onChange:fe,onFocus:J})]}),c&&r&&function(){const e=(0,ge.A)("drop-down-icon",!I&&"expanded-icon");return(0,se.FD)("div",{className:"repeat-mode",ref:y,children:[(0,se.Y)(X.A,{className:"repeat-mode-button",onClick:pe,noForcedUpperCase:!0,isText:!0,iconName:v?"down":"lock-badge",iconClassName:v?e:void 0,iconAlignment:"end",children:k("ScheduleRepeat",{value:(0,qs.j5)(Z,k)})}),(0,se.Y)(Ze.A,{isOpen:I,className:"with-menu-transitions",anchor:P,getTriggerElement:x,getRootElement:L,getMenuElement:R,onClose:F,onCloseAnimationEnd:M,autoClose:!0,children:Ce.map(be)})]})}(),(0,se.FD)("div",{className:"footer",children:[u&&(0,se.Y)("div",{className:"description",children:u}),(0,se.FD)("div",{className:"footer",children:[(0,se.Y)(X.A,{onClick:ve,disabled:ae,children:me}),m&&(0,se.Y)(X.A,{onClick:b,isText:!0,children:m})]})]})]})})),nn=(0,s.ph)((0,n.EK)(e=>({selectedAt:(0,c.nTw)(e).historyCalendarSelectedAt}))(({isOpen:e,selectedAt:t})=>{const{searchMessagesByDate:i,closeHistoryCalendar:o}=(0,n.ko)(),a=(0,s.hb)(e=>{i({timestamp:e.getTime()/1e3}),o()},[o,i]),r=(0,B.A)();return(0,se.Y)(sn,{isOpen:e,selectedAt:t,isPastMode:!0,submitButtonLabel:r("JumpToDate"),onClose:o,onSubmit:a})}));var on=i(64713),an=i(13235),rn=i(94079);const ln=(0,s.ph)((0,n.EK)((e,{userId:t})=>{const i=t?(0,c.mBe)(e,t):void 0,s=t?(0,c.vGo)(e,t):void 0,n=e.appConfig?.contactNoteLimit||an.tI;return{user:i,userStatus:t?(0,c.K0y)(e,t):void 0,phoneCodeList:e.countryList.phoneCodes,contactNoteLimit:n,noteText:s?.note?.text}})(({isOpen:e,userId:t,isByPhoneNumber:i,user:o,userStatus:a,phoneCodeList:r,contactNoteLimit:c,noteText:d})=>{const{updateContact:h,importContact:u,closeNewContactDialog:p}=(0,n.ko)(),v=(0,B.A)(),g=(0,Fi.A)(),A=(0,Si.A)(o),f=(0,Si.A)(i),b=(0,s.li)(),[C,y,S]=(0,D.A)(),[N,k]=(0,s.J0)(A?.firstName??""),[w,I]=(0,s.J0)(A?.lastName??""),[P,Y]=(0,s.J0)(A?.phoneNumber??""),[F,M]=(0,s.J0)(""),[T,L]=(0,s.J0)(!0),R=Boolean(N&&(!i||P)),x=c-F.length,E=(0,s.li)();(0,s.vJ)(()=>{e&&(y(),k(A?.firstName??""),I(A?.lastName??""),Y(A?.phoneNumber??""),M(d??""),L(!0))},[e,y,d,A?.firstName,A?.lastName,A?.phoneNumber]),(0,s.vJ)(()=>{!m.TF&&C&&setTimeout(()=>{b.current?.focus()},200)},[C]);const V=(0,s.hb)(e=>{k(e.target.value)},[]),_=(0,s.hb)(e=>{Y((0,on.Ox)(r,e.target.value))},[r]),U=(0,s.hb)(e=>{I(e.target.value)},[]),O=(0,s.hb)(e=>{M(e.target.value)},[]),K=(0,s.hb)(()=>{p(),k(""),I(""),Y(""),M("")},[p]),J=(0,s.hb)(()=>{const e=F.trim()?{text:F,entities:[]}:void 0;i||!t?u({firstName:N,lastName:w,phoneNumber:P}):h({userId:t,firstName:N,lastName:w,shouldSharePhoneNumber:T,note:e})},[N,u,i,w,F,P,T,h,t]);if(e||C)return(0,se.FD)(te.A,{className:"NewContactModal",title:v("NewContact"),isOpen:e,onClose:K,onCloseAnimationEnd:S,children:[A&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:"NewContactModal__profile",dir:g.isRtl?"rtl":void 0,children:[(0,se.Y)(Yt.A,{size:"jumbo",peer:A,text:`${N} ${w}`}),(0,se.FD)("div",{className:"NewContactModal__profile-info",children:[(0,se.Y)("p",{className:"NewContactModal__phone-number",children:A?.phoneNumber?(0,on.Ox)(r,A.phoneNumber):v("MobileHidden")}),(0,se.Y)("span",{className:"NewContactModal__user-status",dir:"auto",children:(0,l.CD)(v,A,a)})]})]}),(0,se.Y)(ee.A,{ref:b,value:N,label:v("FirstName"),tabIndex:0,onChange:V}),(0,se.Y)(ee.A,{value:w,label:v("LastName"),tabIndex:0,onChange:U}),(0,se.Y)(rn.A,{ref:E,id:"user-note",label:g("UserNoteTitle"),onChange:O,value:F,maxLength:c,maxLengthIndicator:x.toString(),noReplaceNewlines:!0}),(0,se.Y)("p",{className:"NewContactModal__help-text NewContactModal__help-text__edit",children:g("EditUserNoteHint")}),(0,se.Y)("p",{className:"NewContactModal__help-text",children:(0,Pt.A)(v("NewContact.Phone.Hidden.Text",A?.firstName||""),["emoji","simple_markdown"])}),(0,se.Y)(Hs.A,{className:"dialog-checkbox",checked:T,tabIndex:0,onCheck:L,label:v("lng_new_contact_share")}),(0,se.Y)("p",{className:"NewContactModal__help-text NewContactModal__help-text__negative",children:(0,Pt.A)(v("AddContact.SharedContactExceptionInfo",A?.firstName))})]}),f&&(0,se.FD)("div",{className:"NewContactModal__new-contact",dir:g.isRtl?"rtl":void 0,children:[(0,se.Y)(Yt.A,{size:"jumbo",text:`${N} ${w}`}),(0,se.FD)("div",{className:"NewContactModal__new-contact-fieldset",children:[(0,se.Y)(ee.A,{ref:b,value:P,inputMode:"tel",label:v("lng_contact_phone"),tabIndex:0,onChange:_}),(0,se.Y)(ee.A,{value:N,label:v("FirstName"),tabIndex:0,onChange:V}),(0,se.Y)(ee.A,{value:w,label:v("LastName"),tabIndex:0,onChange:U})]})]}),(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",disabled:!R,onClick:J,children:v("Done")}),(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",onClick:K,children:v("Cancel")})]})]})}));var cn=i(20179),dn=i(48894),hn=i(32625);let mn=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.TopLeft=4]="TopLeft",e[e.TopRight=5]="TopRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomRight=7]="BottomRight",e}({});const un={top:mn.Top,bottom:mn.Bottom,left:mn.Left,right:mn.Right,topLeft:mn.TopLeft,topRight:mn.TopRight,bottomLeft:mn.BottomLeft,bottomRight:mn.BottomRight},pn=Object.keys(un);let vn;const gn={x:0,y:0};var An=i(36838);const fn=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.nTw)(e).webApps,{botId:i}=(0,c.ES7)(e)||{},{modalState:s,openedWebApps:n}=t||{},o="minimized"===s;return{activeTabBot:i?(0,c.mBe)(e,i):void 0,isMinimizedState:o,openedWebApps:n}})(({activeTabBot:e,isMinimizedState:t,openedWebApps:i})=>{const{changeWebAppModalState:o,closeWebAppModal:a}=(0,n.ko)(),r=(0,B.A)(),l=(0,Fi.A)(),d=(0,s.li)(),h=(0,s.Kr)(()=>i&&Object.values(i),[i]),m=h?.length,u=(0,s.Kr)(()=>{if(!m)return[];const t=(0,n.mS)(),i=e?.id;return(0,di.Am)([i,...h.map(e=>e.botId)]).map(e=>e&&(0,c.mBe)(t,e)).filter(Boolean).slice(0,3)},[m,e,h]),p=(0,T.A)(()=>{a()}),v=(0,T.A)(()=>{o({state:"maximized"})});if(t)return(0,se.FD)("div",{ref:d,className:(0,ge.A)("kUZmBlnN"),children:[(0,se.Y)(X.A,{className:"SMRJmUuE",round:!0,color:"translucent",size:"tiny",iconName:"close",iconClassName:"P0P4gW6a",ariaLabel:r("Close"),onClick:p}),(0,se.Y)(qi.A,{className:"GP17QhNN",size:"mini",peers:u}),function(){const e=u.length>0&&u[0]?.firstName,t=m&&e&&m>1?l("MiniAppsMoreTabs",{botName:e,count:m-1},{pluralValue:m-1}):e;return(0,se.Y)("div",{className:"TZFjRaG4",children:t})}(),(0,se.Y)(X.A,{className:(0,ge.A)("Rax9j_TK","no-drag"),round:!0,color:"translucent",size:"tiny",iconName:"expand-modal",iconClassName:"sdbTXCxq",onClick:v})]})}));var bn=i(14242),Cn=i(59852),yn=i(84991);const Sn={container:"RFg0Ey2I","user-count-badge":"UZtJ6ZXb",userCountBadge:"UZtJ6ZXb","user-badge-icon":"pTiZFhsG",userBadgeIcon:"pTiZFhsG",name:"TzA5nqCC"},Nn=(0,s.ph)((0,n.EK)((e,{chatId:t})=>({user:(0,c.mBe)(e,t)}))(function({user:e,isPopularApp:t}){const{requestMainWebView:i}=(0,n.ko)(),s=(0,Fi.A)(),o=(0,T.A)(()=>{if(!e)return;const t=e?.id;if(!t)return;const s=(0,Cn.A)();i({botId:t,peerId:t,theme:s})});if(!e)return;const a=e?.firstName,r=e?.botActiveUsers,l=r&&t?(0,bn.Vw)(s,r):void 0;return(0,se.Y)("div",{className:Sn.container,onClick:o,children:(0,se.Y)(yn.A,{className:(0,ge.A)(Sn.avatarContainer,t&&"PopularAppGridItem"),textClassName:Sn.name,badgeClassName:Sn.userCountBadge,badgeIconClassName:Sn.userBadgeIcon,peer:e,text:a,badgeText:l,badgeIcon:"user-filled"})})})),kn={root:"BJV09FsC",search:"bdi8G7GR","section-title":"ex3kxgWX",sectionTitle:"ex3kxgWX","section-content":"uIZzLhEh",sectionContent:"uIZzLhEh",showMoreLink:"h_Zs9ypA"},wn=(0,be.nF)(e=>e(),500,!0),In=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.nTw)(e).globalSearch,i=t.popularBotApps?.peerIds;return{isLoading:!i&&t.fetchingStatus?.botApps,foundIds:i,recentBotIds:e.topBotApps.userIds}})(({foundIds:e,recentBotIds:t})=>{const i=(0,B.A)(),a=(0,Fi.A)(),[r,l]=(0,s.J0)(!1),{searchPopularBotApps:c}=(0,n.ko)(),d=(0,T.A)(()=>{l(e=>!e)}),[h,m]=(0,s.J0)(""),u=(0,s.Kr)(()=>e?(0,It.PU)({ids:e,query:h,type:"user"}):[],[e,h]),p=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&wn(()=>{c()})},[]),v=(0,s.hb)(()=>{m("")},[]);return(0,se.FD)(ls.A,{className:(0,ge.A)(kn.root,"custom-scroll"),items:u,onLoadMore:p,itemSelector:".PopularAppGridItem",noFastList:!0,preloadBackwards:30,children:[(0,se.Y)(ds.A,{className:kn.search,value:h,onChange:m,onReset:v,placeholder:a("SearchApps")}),t&&!h&&(0,se.FD)("div",{className:kn.section,children:[(0,se.FD)("div",{className:kn.sectionTitle,children:[(0,se.Y)("span",{children:i("SearchAppsMine")}),(0,se.Y)("span",{className:kn.showMoreLink,onClick:d,children:i(r?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")})]}),(0,se.Y)("div",{className:kn.sectionContent,children:t.map((e,t)=>{if(r||!(t>=5))return(0,se.Y)(Nn,{chatId:e})})})]}),(0,se.FD)("div",{className:kn.section,children:[(0,se.Y)("div",{className:kn.sectionTitle,children:a(h?"Apps":"PopularApps")}),(0,se.Y)("div",{className:kn.sectionContent,children:u&&u.map(e=>(0,se.Y)(Nn,{chatId:e,isPopularApp:!h}))})]})]})}));var Pn=i(4875);const Yn=3.675*g.$,Fn="jEAibDyh",Dn="ablUg8HU",Mn="Wrl63uWL",Tn="vOFiAq3l",Bn="KwI4XdkC",Ln="oq6HKJur",Rn="a0AI_he5",xn="MvCwTbk_",En=250,Vn=["allow-scripts","allow-same-origin","allow-popups","allow-forms","allow-modals","allow-storage-access-by-user-activation"].join(" "),_n={ok:"OK",cancel:"Cancel",close:"Close"},Un=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:s}=i||{},n=t?.modalState,o=s?e.attachMenu.bots[s]:void 0,a=s?(0,c.mBe)(e,s):void 0,r=s?(0,c.vGo)(e,s):void 0,l=r?.botInfo?.appSettings,d=e.currentUserId?(0,c.mBe)(e,e.currentUserId):void 0,h=(0,c.SJA)(e),{isPaymentModalOpen:m,status:u}=(0,c.nTw)(e).payment,{status:p,inputInvoice:v}=(0,c.nTw)(e).starsPayment,g=a?(0,c.XOs)(e,a.id):void 0,A=p||u;return{attachBot:o,bot:a,currentUser:d,theme:h,isPaymentModalOpen:m||Boolean(v),paymentStatus:A,modalState:n,botAppPermissions:g,botAppSettings:l}})(({modal:e,webApp:t,bot:i,theme:o,isPaymentModalOpen:r,paymentStatus:c,registerSendEventCallback:d,registerReloadFrameCallback:h,isTransforming:u,modalState:p,isMultiTabSupported:v,onContextMenuButtonClick:g,botAppPermissions:A,botAppSettings:f,modalHeight:b})=>{const{closeActiveWebApp:C,sendWebViewData:y,toggleAttachBot:S,openTelegramLink:N,setWebAppPaymentSlug:k,switchBotInline:w,sharePhoneWithBot:I,updateWebApp:P,resetPaymentStatus:M,openChatWithInfo:L,showNotification:R,openEmojiStatusAccessModal:x,openLocationAccessModal:E,changeWebAppModalState:V,closeWebAppModal:_,openPreparedInlineMessageModal:U}=(0,n.ko)(),[O,K]=(0,s.J0)(),[J,G]=(0,s.J0)(),[j,z,H]=(0,D.A)(!1),[q,W]=(0,s.J0)(),Q=(0,Si.A)(q),[Z,ee]=(0,s.J0)(!1),[ie,ne]=(0,s.J0)(!1),[oe,re]=(0,s.J0)(),[le,ce]=(0,s.J0)(),[de,me]=(0,s.J0)(),{unlockPopupsAt:ue,handlePopupOpened:pe,handlePopupClosed:ve}=function(){const[e,t]=(0,s.J0)(0),i=(0,s.li)(0),n=(0,s.li)(0),o=(0,T.A)(()=>{const e=Date.now();e-n.current>2e3&&(i.current=0),i.current+=1,i.current>=3&&t(e+2e3)}),a=(0,T.A)(()=>{e<Date.now()&&(n.current=Date.now())});return{unlockPopupsAt:e,handlePopupOpened:o,handlePopupClosed:a}}(),Ae=(0,s.li)(),fe=(0,s.li)(),be=(0,s.li)(),Ce="fullScreen"===p,ye="minimized"===p,Se=(0,T.A)(()=>{setTimeout(()=>{V({state:"maximized"})},350)}),Ne=(0,s.li)();(0,s.vJ)(()=>{Ne.current=document.querySelector("#portals")},[]);const[,ke,we]=(0,Ie.Ay)(Ne,Se),Ye=e?.activeWebAppKey?e.openedWebApps[e.activeWebAppKey]:void 0,{appName:Fe,backgroundColor:De}=Ye||{},{url:Me,buttonText:Te,isBackButtonVisible:Be}=t||{},{placeholderPath:Le}=f||{},Re=Boolean(t?.isCloseModalOpen),xe=Boolean(t?.isRemoveModalOpen),Ee=t&&(0,cn.rp)(t),Ve=Ye&&(0,cn.rp)(Ye),_e=Ye&&t&&Ve===Ee,Oe=m.H$,Ke=void 0!==A?.geolocation,Je=Boolean(A?.geolocation),Ge=(0,T.A)(e=>{Ee&&P({key:Ee,update:e})}),je=(0,s.Kr)(()=>(0,Cn.A)(),[o]);(0,s.vJ)(()=>{me(je.secondary_bg_color)},[je]);const ze=je.bg_color,[He,$e]=(0,s.J0)(),qe="light"===o?f?.backgroundColor:f?.backgroundDarkColor;(0,s.vJ)(()=>{Ge({backgroundColor:He||qe||ze})},[ze,He,qe]);const We=je.bg_color,[Qe,Ze]=(0,s.J0)(),Xe="light"===o?f?.headerColor:f?.headerDarkColor;(0,s.vJ)(()=>{Ge({headerColor:Qe||Xe||We})},[We,Qe,Xe]);const et=(0,s.li)(),it=(0,B.A)(),st=(0,Fi.A)(),nt=e?.isModalOpen||!1,ot=Boolean(Te),{reloadFrame:at,sendEvent:rt,sendFullScreenChanged:lt,sendViewport:ct,sendSafeArea:dt,sendTheme:ht}=((e,t,i,o,r,c,d)=>{const{showNotification:h,setWebAppPaymentSlug:m,openInvoice:u,closeWebApp:p,openSuggestedStatusModal:v,updateWebApp:g,updateContentSettings:A}=(0,n.ko)(),f=(0,s.li)(!1),b=(0,s.li)(),C=(0,s.li)(!1),y=(0,s.li)(),S=(0,Pe.A)();(0,s.vJ)(()=>{if(!e.current||!t)return;const i=()=>{d?.()},s=e.current;return s.addEventListener("load",i),()=>{s.removeEventListener("load",i)}},[d,e,t]);const N=(0,s.hb)(t=>{e.current?.contentWindow&&e.current.contentWindow.postMessage(JSON.stringify(t),"*")},[e]),k=(0,s.hb)(e=>{N({eventType:"fullscreen_changed",eventData:{is_fullscreen:e}})},[N]),w=(0,T.A)(t=>{if(!e.current)return;const i=e.current;i.src="about:blank",i.addEventListener("load",()=>{i.src=t},{once:!0})}),I=(0,s.hb)(e=>{if(f.current)return N({eventType:"reload_iframe"}),void(b.current=setTimeout(()=>{w(e)},500));w(e)},[N]),P=(0,s.hb)(t=>{if(!e.current)return;const{width:i,height:s}=e.current.getBoundingClientRect();N({eventType:"viewport_changed",eventData:{width:i,height:s,is_expanded:!0,is_state_stable:!t}})},[N,e]),Y=(0,s.hb)(()=>{e.current&&(N({eventType:"safe_area_changed",eventData:{left:0,right:0,top:0,bottom:0}}),N({eventType:"content_safe_area_changed",eventData:{left:0,right:0,top:i?Yn:0,bottom:0}}))},[N,i,e]),F=(0,s.hb)(()=>{N({eventType:"theme_changed",eventData:{theme_params:(0,Cn.A)()}})},[N]),D=(0,s.hb)(e=>{N({eventType:"set_custom_style",eventData:e})},[N]),M=(0,s.hb)(t=>{if(C.current)return;const i=e.current?.contentWindow;if(i===t.source)try{const e=JSON.parse(t.data),{eventType:i,eventData:s}=e;if("web_app_ready"===i&&d?.(),"web_app_close"===i&&c){const e=(0,l.rp)(c);p({key:e,skipClosingConfirmation:!0})}if("web_app_request_viewport"===i&&P(S.isResizing),"web_app_request_safe_area"===i&&Y(),"web_app_request_content_safe_area"===i&&Y(),"web_app_request_theme"===i&&F(),"iframe_ready"===i){const e=getComputedStyle(document.body).getPropertyValue("--color-scrollbar");D("* {\n  scrollbar-width: thin;\n  scrollbar-color: %SCROLLBAR_COLOR% transparent;\n}\n\n*::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n  background-color: transparent;\n}\n\n*::-webkit-scrollbar-thumb {\n  border-radius: 6px;\n  background-color: %SCROLLBAR_COLOR%;\n}\n\n*::-webkit-scrollbar-corner {\n  background-color: transparent;\n}".replace(/%SCROLLBAR_COLOR%/g,e)),f.current=Boolean(s.reload_supported)}if("iframe_will_reload"===i&&clearTimeout(b.current),"web_app_data_send"===i){if(!o)return;C.current=!0}if("web_app_open_scan_qr_popup"===i&&h({message:"Scanning QR code is not supported in this client yet"}),"web_app_open_invoice"===i&&(m({slug:s.slug}),u({type:"slug",slug:s.slug})),"web_app_open_link"===i){const e=s.url;window.open(e,"_blank","noreferrer")}if("web_app_biometry_get_info"===i&&N({eventType:"biometry_info_received",eventData:{available:!1}}),"web_app_device_storage_clear"===i||"web_app_device_storage_get_key"===i||"web_app_device_storage_save_key"===i){const{req_id:e}=s;N({eventType:"device_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_secure_storage_clear"===i||"web_app_secure_storage_get_key"===i||"web_app_secure_storage_restore_key"===i||"web_app_secure_storage_save_key"===i){const{req_id:e}=s;N({eventType:"secure_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_start_accelerometer"===i&&N({eventType:"accelerometer_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_gyroscope"===i&&N({eventType:"gyroscope_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_device_orientation"===i&&N({eventType:"device_orientation_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_add_to_home_screen"===i&&N({eventType:"home_screen_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_check_home_screen"===i&&N({eventType:"home_screen_checked",eventData:{status:"unsupported"}}),"web_app_set_emoji_status"===i){const{custom_emoji_id:e,duration:t}=s;if(!e||"string"!=typeof e)return void N({eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}});if(t)try{BigInt(t)}catch(e){return void N({eventType:"emoji_status_failed",eventData:{error:"DURATION_INVALID"}})}if(!c)return void N({eventType:"emoji_status_failed",eventData:{error:"UNKNOWN_ERROR"}});v({webAppKey:(0,l.rp)(c),customEmojiId:e,duration:Number(t),botId:c.botId})}if("web_app_verify_age"===i){const{passed:e}=s,t=(0,n.mS)().appConfig.verifyAgeMin||a.lYi,i=s.age||0;e&&i>=t?(h({message:{key:"TitleAgeCheckSuccess"}}),A({isSensitiveEnabled:!0})):h({message:{key:"TitleAgeCheckFailed"}})}r(e)}catch(e){}},[o,N,r,D,c,F,P,Y,d,S.isResizing,e]);return(0,s.vJ)(()=>{const{width:e,height:t,isResizing:i}=S;y.current&&y.current.width===e&&y.current.height===t&&!y.current.isResizing||(y.current={width:e,height:t,isResizing:i},P(i))},[P,Y,S]),(0,s.vJ)(()=>{c?.plannedEvents?.length&&(c.plannedEvents.forEach(e=>{N(e)}),g({key:(0,l.rp)(c),update:{plannedEvents:[]}}))},[N,c]),(0,s.vJ)(()=>(window.addEventListener("message",M),()=>window.removeEventListener("message",M)),[M,e]),(0,s.vJ)(()=>{t&&e.current?.contentWindow?(P(),Y(),C.current=!1):y.current=void 0},[t,i,P,Y,e]),{sendEvent:N,sendFullScreenChanged:k,reloadFrame:I,sendViewport:P,sendSafeArea:Y,sendTheme:F}})(et,nt,Ce,ot,function(e){const{eventType:t,eventData:s}=e;if("web_app_request_fullscreen"===t&&((0,Y.cB)()?V({state:"fullScreen"}):rt({eventType:"fullscreen_failed",eventData:{error:"UNSUPPORTED"}})),"web_app_exit_fullscreen"===t&&Nt(),"web_app_open_tg_link"===t){V({state:"minimized"});const e=a.jsp+s.path_full;N({url:e,shouldIgnoreCache:s.force_request})}if("web_app_setup_back_button"===t&&Ge({isBackButtonVisible:s.is_visible}),"web_app_setup_settings_button"===t&&Ge({isSettingsButtonVisible:s.is_visible}),"web_app_set_background_color"===t&&$e((0,Cn.To)(s.color)?s.color:void 0),"web_app_set_header_color"===t){const e=s.color_key;Ze(s.color||(e?je[e]:void 0))}if("web_app_set_bottom_bar_color"===t&&me(s.color),"web_app_data_send"===t&&(C(),y({bot:i,buttonText:Te,data:s.data})),"web_app_setup_main_button"===t){const e=s.color,t=s.text_color;K({isVisible:s.is_visible&&Boolean(s.text?.trim().length),isActive:s.is_active,text:s.text,color:e,textColor:t,isProgressVisible:s.is_progress_visible})}if("web_app_setup_secondary_button"===t){const e=s.color,t=s.text_color;G({isVisible:s.is_visible&&Boolean(s.text?.trim().length),isActive:s.is_active,text:s.text,color:e,textColor:t,isProgressVisible:s.is_progress_visible,position:s.position})}if("web_app_setup_closing_behavior"===t&&Ge({shouldConfirmClosing:s.need_confirmation}),"web_app_open_popup"===t){if(q||!s.message.trim().length||!s.buttons?.length||s.buttons.length>3||Z||ie||ue>Date.now())return void bt(void 0);W(s),pe()}if("web_app_switch_inline_query"===t){const e=s.chat_types?.map(l.Xj).filter(Boolean),t=!e?.length;w({botId:i.id,query:s.query,filter:e,isSamePeer:t}),C()}if("web_app_request_phone"===t){if(q||ie||ue>Date.now())return void Yt();ee(!0),pe()}if("web_app_request_write_access"===t){if(q||Z||ue>Date.now())return void Mt();!async function(){if(!i)return;const e=await(0,Pn.px)("fetchBotCanSendMessage",{bot:i});e&&rt({eventType:"write_access_requested",eventData:{status:"allowed"}}),ne(!e)}(),pe()}if("web_app_invoke_custom_method"===t){const{method:e,params:t,req_id:n}=s;!async function(e,t,s){const n=await(0,Pn.px)("invokeWebViewCustomMethod",{bot:i,customMethod:t,parameters:s});rt({eventType:"custom_method_invoked",eventData:{req_id:e,...n}})}(n,e,JSON.stringify(t))}if("web_app_request_file_download"===t){if(le||ue>Date.now())return void Dt();!async function(e,t){await(0,Pn.px)("checkBotDownloadFileParams",{bot:i,url:e,fileName:t})?(ce({url:e,fileName:t}),pe()):rt({eventType:"file_download_requested",eventData:{status:"cancelled"}})}(s.url,s.file_name)}if("web_app_send_prepared_message"===t){if(!i||!Ee)return;const{id:e}=s;U({botId:i.id,messageId:e,webAppKey:Ee})}if("web_app_request_emoji_status_access"===t){if(!i)return;x({bot:i,webAppKey:Ee})}"web_app_check_location"===t&&rt({eventType:"location_checked",eventData:{available:Oe,access_requested:Ke,access_granted:Je}}),"web_app_request_location"===t&&(async()=>{const e=await(0,m.Bu)(),{accessRequested:t,accessGranted:s,geolocation:n}=e;if(!s||!t)return rt({eventType:"location_requested",eventData:{available:!1}}),R({message:it("PermissionNoLocationPosition")}),void bt(void 0);Oe?Ke?rt({eventType:"location_requested",eventData:{available:Boolean(A?.geolocation),latitude:n?.latitude,longitude:n?.longitude,altitude:n?.altitude,course:n?.heading,speed:n?.speed,horizontal_accuracy:n?.accuracy,vertical_accuracy:n?.altitudeAccuracy}}):E({bot:i,webAppKey:Ee}):(R({message:it("PermissionNoLocationPosition")}),bt(void 0))})(),"web_app_open_location_settings"===t&&xt(),"web_app_read_text_from_clipboard"===t&&re(s.req_id)},t,z);(0,s.vJ)(()=>{_e&&d(rt)},[rt,d,_e]),(0,s.vJ)(()=>{_e&&h(at)},[at,h,_e]);const mt=j&&O?.isVisible&&O.text.trim().length>0,ut=j&&J?.isVisible&&J.text.trim().length>0,pt=(0,T.A)(()=>{Ge({isCloseModalOpen:!1})}),vt=(0,T.A)(()=>{Ge({shouldConfirmClosing:!1,isCloseModalOpen:!1}),setTimeout(()=>{C()},400)}),gt=(0,T.A)(()=>{Ge({isRemoveModalOpen:!1})}),At=(0,T.A)(()=>{rt({eventType:"main_button_pressed"})}),ft=(0,T.A)(()=>{rt({eventType:"secondary_button_pressed"})}),bt=(0,T.A)(e=>{W(void 0),ve(),rt({eventType:"popup_closed",eventData:{button_id:e}})}),Ct=(0,T.A)(()=>{bt()}),yt=(0,T.A)(()=>{ht()});(0,$.A)(()=>{setTimeout(()=>{yt()},400)},[o]);const St=(0,T.A)(()=>{!(0,Ie.j9)()&&_e&&ke?.()}),Nt=(0,T.A)(()=>{(0,Ie.j9)()&&_e&&we?.()}),kt=(0,T.A)(e=>{_e&&lt(e)});(0,s.vJ)(()=>{Ce?(St(),kt(!0)):(Nt(),kt(!1))},[Ce]);const wt=(0,T.A)(e=>{rt({eventType:"visibility_changed",eventData:{is_visible:e}})});(0,s.vJ)(()=>{j&&wt(Boolean(_e))},[_e,j]),(0,F.A)(([e])=>{"minimized"===p&&wt(!1),p&&"minimized"===e&&wt(!0)},[p]),(0,$.A)(([e])=>{r!==e&&t?.slug&&!r&&c&&(rt({eventType:"invoice_closed",eventData:{slug:t.slug,status:c}}),k({slug:void 0}),M())},[r,c,rt,t?.slug]);const It=(0,T.A)(()=>{S({botId:i.id,isEnabled:!1}),C()}),Yt=(0,T.A)(()=>{ee(!1),ve(),rt({eventType:"phone_requested",eventData:{status:"cancelled"}})}),Ft=(0,T.A)(()=>{I({botId:i.id}),ee(!1),ve(),rt({eventType:"phone_requested",eventData:{status:"sent"}})}),Dt=(0,T.A)(e=>{e&&(ce(void 0),ve()),rt({eventType:"file_download_requested",eventData:{status:"cancelled"}})}),Mt=(0,T.A)(()=>{rt({eventType:"write_access_requested",eventData:{status:"cancelled"}}),ne(!1),ve()}),Tt=(0,T.A)(async()=>{i&&(await(0,Pn.px)("allowBotSendMessages",{bot:i})?(rt({eventType:"write_access_requested",eventData:{status:"allowed"}}),ne(!1),ve()):Mt())}),Bt=(0,T.A)(()=>{oe&&(re(void 0),rt({eventType:"clipboard_text_received",eventData:{req_id:oe,data:null}}))}),Lt=(0,T.A)(()=>{const e=oe;e&&(re(void 0),window.navigator.clipboard.readText().then(t=>{rt({eventType:"clipboard_text_received",eventData:{req_id:e,data:t}})}).catch(()=>{rt({eventType:"clipboard_text_received",eventData:{req_id:e,data:null}})}))}),Rt=(0,T.A)(()=>{le&&(ce(void 0),ve(),(0,ki.A)(le.url,le.fileName),rt({eventType:"file_download_requested",eventData:{status:"downloading"}}))});(0,s.vJ)(()=>{nt||(W(void 0),ee(!1),ne(!1),K(void 0),G(void 0),ce(void 0),re(void 0),Ge({isSettingsButtonVisible:!1,shouldConfirmClosing:!1,isBackButtonVisible:!1,isCloseModalOpen:!1,isRemoveModalOpen:!1}),H())},[nt]);const xt=(0,T.A)(()=>{L({id:i.id})}),Et=(0,Si.A)(O?.color,!0),Vt=(0,Si.A)(O?.textColor,!0),_t=(0,Si.A)(O&&Boolean(O.isActive),!0),Ut=(0,Si.A)(O?.text,!0),Ot=(0,Si.A)(J?.position,!0),Kt=(0,Si.A)(J?.color,!0),Jt=(0,Si.A)(J?.textColor,!0),Gt=(0,Si.A)(J&&Boolean(J.isActive),!0),jt=(0,Si.A)(J?.text,!0),[zt,Ht]=(0,s.J0)(!1),[$t,qt]=(0,s.J0)(!0),[Wt,Qt]=(0,s.J0)(!0),[Zt,Xt]=(0,s.J0)(!1),[ei,ti]=(0,s.J0)(!1),[ii,si]=(0,s.J0)(!1),[ni,ai]=(0,s.J0)(0);(0,$.A)(()=>{setTimeout(()=>{ct(),dt()},u?0:400)},[ei,Wt,Zt,Zt,J?.position,ct,u,b,dt]);const ri="top"===Ot||"bottom"===Ot,li=ri&&Zt&&ei?2:Zt||ei?1:0,ci=ri||$t||Wt?"vertical":"horizontal",di=(0,s.li)(),hi=(0,s.li)(),mi=(0,s.li)(),ui=(0,s.li)(),pi=(0,s.li)();(0,s.vJ)(()=>(Ce&&nt&&Boolean(Fe)?(si(!0),pi.current&&clearTimeout(pi.current),pi.current=setTimeout(()=>{si(!1),pi.current=void 0},3800)):(si(!1),pi.current&&(clearTimeout(pi.current),pi.current=void 0)),()=>{pi.current&&clearTimeout(pi.current)}),[Ce,nt,Fe]),(0,s.vJ)(()=>{di.current&&clearTimeout(di.current),hi.current&&clearTimeout(hi.current),mt&&(hi.current=setTimeout(()=>{Xt(!0)},35),qt(!1),di.current=setTimeout(()=>{Ht(!0)},En)),mt||(Xt(!1),di.current=setTimeout(()=>{qt(!0)},En))},[mt]),(0,s.vJ)(()=>{mi.current&&clearTimeout(mi.current),ui.current&&clearTimeout(ui.current),ut&&(ui.current=setTimeout(()=>{ti(!0)},35),Qt(!1),mi.current=setTimeout(()=>{Ht(!0)},En)),ut||(ti(!1),mi.current=setTimeout(()=>{Qt(!0)},En))},[ut]),(0,s.vJ)(()=>{ei||Zt||Ht(!1)},[Ht,ei,Zt]);const vi=(0,tt.A)(`background-color: ${De||"var(--color-background)"}`,u&&"pointer-events: none;"),gi=(0,T.A)(()=>{Be?rt({eventType:"back_button_pressed"}):(Nt(),lt(!1),V({state:"maximized"}),_())}),Ai=(0,T.A)(()=>{Nt()}),fi=(0,T.A)(e=>{g(e)}),bi=(0,ge.A)("BvNtfigU",Be&&"rC2wkMIk"),Ci=ii?Fe:it(Be?"Back":"Close"),yi=be?.current;return(0,s.vJ)(()=>{ai(be?.current?.clientWidth||0)},[Ci,yi]),(0,se.FD)("div",{ref:Ae,className:(0,ge.A)("LeeJZdwH",!_e&&Tn,v&&"ESsGT5OD"),children:[Ce&&(0,Y.cB)()&&(0,se.FD)("div",{className:"eYrhewMy",children:[(0,se.FD)("div",{ref:fe,className:xn,onClick:gi,children:[(0,se.Y)("div",{className:"JXsuZ01s",children:(0,se.Y)("div",{className:bi})}),(0,se.Y)("span",{className:"dpZR3YT7",style:`width: ${ni}px;`,children:(0,se.Y)(ae.Ay,{activeKey:ii?0:Be?1:2,name:"slideFade",children:(0,se.Y)("div",{ref:be,className:"dWDprnWa",children:Ci})})})]}),(0,se.FD)("div",{className:"Tl4_05AQ",children:[(0,se.Y)("div",{className:(0,ge.A)(xn,"emOpAMBm"),tabIndex:0,role:"button","aria-label":st("WebAppCollapse"),onClick:Ai,children:(0,se.Y)(he.A,{name:"down",className:Rn})}),(0,se.Y)("div",{className:(0,ge.A)(xn,"z4C5VD5o"),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":st("AriaMoreButton"),onClick:fi,children:(0,se.Y)(he.A,{name:"more",className:(0,ge.A)(Rn,"T58ozRyW")})})]})]}),!ye&&(Le?(0,se.Y)("svg",{className:(0,ge.A)(Fn,j&&Mn),viewBox:"0 0 512 512",children:(0,se.Y)("path",{className:"Gx1BIECZ",d:Le})}):function(){const e=(0,ge.A)(Fn,"Ig_t1R7i",j&&Mn);return(0,se.FD)("div",{className:e,children:[(0,se.Y)("div",{className:Dn}),(0,se.Y)("div",{className:Dn}),(0,se.Y)("div",{className:Dn}),(0,se.Y)("div",{className:Dn})]})}()),(0,se.Y)("iframe",{className:(0,ge.A)("OmY14FFl",zt&&"liDRl1xT",!j&&Mn),style:vi,src:Me,title:st("AriaMiniApp",{bot:i?.firstName}),sandbox:Vn,allow:"camera; microphone; geolocation; clipboard-write;",allowFullScreen:!0,ref:et}),!ye&&(0,se.FD)("div",{style:`background-color: ${de};`,className:(0,ge.A)("mR_hsBdT","left"===Ot&&"ntESqwQ_","right"===Ot&&"q6IUFEL0","top"===Ot&&"gb4iHJ9H","bottom"===Ot&&"R_bh3GF8","horizontal"===ci&&"oYaRA7u4",1===li&&"YfQO314y",2===li&&"gUldkEoy"),children:[(0,se.FD)(X.A,{className:(0,ge.A)("ypxiUCFQ",ei&&!Wt&&Bn,Wt&&Tn),fluid:!0,style:`background-color: ${Kt}; color: ${Jt}`,disabled:!Gt&&!J?.isProgressVisible,nonInteractive:J?.isProgressVisible,onClick:ft,children:[!J?.isProgressVisible&&jt,J?.isProgressVisible&&(0,se.Y)(Ue.A,{className:Ln,color:"blue"})]}),(0,se.FD)(X.A,{className:(0,ge.A)("U_ggDKn1",Zt&&!$t&&Bn,$t&&Tn),fluid:!0,style:`background-color: ${Et}; color: ${Vt}`,disabled:!_t&&!O?.isProgressVisible,nonInteractive:O?.isProgressVisible,onClick:At,children:[!O?.isProgressVisible&&Ut,O?.isProgressVisible&&(0,se.Y)(Ue.A,{className:Ln,color:"white"})]})]}),(0,se.FD)(te.A,{isOpen:Boolean(q),title:Q?.title||"Â ",className:(0,ge.A)("YEOURXza",!Q?.title?.trim().length&&"gvljUzY9"),hasCloseButton:!0,onClose:Ct,children:[Q?.message,(0,se.Y)("div",{className:"dialog-buttons mt-2",children:Q?.buttons.map(e=>(0,se.Y)(X.A,{className:"confirm-dialog-button",color:"destructive"===e.type?"danger":"primary",isText:!0,onClick:()=>bt(e.id),children:e.text||it(_n[e.type])},e.id||e.type))})]}),(0,se.Y)(oi.A,{isOpen:Z,onClose:Yt,title:st("ShareYouPhoneNumberTitle"),textParts:st("AreYouSureShareMyContactInfoBot",void 0,{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]}),confirmHandler:Ft,confirmLabel:st("ContactShare")}),(0,se.Y)(oi.A,{isOpen:ie,onClose:Mt,title:it("lng_bot_allow_write_title"),text:it("lng_bot_allow_write"),confirmHandler:Tt,confirmLabel:it("lng_bot_allow_write_confirm")}),(0,se.Y)(oi.A,{isOpen:Boolean(le),title:it("BotDownloadFileTitle"),textParts:st("BotDownloadFileDescription",{bot:i?.firstName,filename:le?.fileName},{withNodes:!0,withMarkdown:!0}),confirmLabel:it("BotDownloadFileButton"),onClose:Dt,confirmHandler:Rt}),(0,se.Y)(oi.A,{isOpen:Re,onClose:pt,title:it("lng_bot_close_warning_title"),text:it("lng_bot_close_warning"),confirmHandler:vt,confirmIsDestructive:!0,confirmLabel:it("lng_bot_close_warning_sure")}),(0,se.Y)(oi.A,{isOpen:xe,onClose:gt,title:it("BotRemoveFromMenuTitle"),textParts:(0,Pt.A)(it("BotRemoveFromMenu",i?.firstName),["simple_markdown"]),confirmHandler:It,confirmIsDestructive:!0}),(0,se.Y)(oi.A,{isOpen:Boolean(oe),title:st("BotReadTextFromClipboardTitle"),text:st("BotReadTextFromClipboardDescription",{bot:(0,l.Yg)(i)}),confirmLabel:st("BotReadTextFromClipboardConfirm"),onClose:Bt,confirmHandler:Lt})]})})),On="oHX2d8Or",Kn="O4NxErFX",Jn="dgdyQDsZ",Gn="xGefqS93",jn="f7EicoVH",zn="s6pBIYMI",Hn="txS0KiU0",$n="XpHR_yo0",qn="DoeOewUR",Wn="YRMGpqUS",Qn="b13oE9uA",Zn={width:300,height:40},Xn={width:420,height:730},eo={width:300,height:300},to=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:s}=i||{},n=s?e.attachMenu.bots[s]:void 0,o=s?(0,c.mBe)(e,s):void 0,a=(0,c.meB)(e),r=(0,c.SJA)(e),{miniAppsCachedPosition:l,miniAppsCachedSize:d}=(0,ks.lS)(e);return{attachBot:n,bot:o,chat:a,theme:r,cachedPosition:l,cachedSize:d}})(({modal:e,chat:t,bot:i,attachBot:o,theme:r,cachedSize:l,cachedPosition:c})=>{const{closeActiveWebApp:d,closeWebAppModal:h,prolongWebView:m,toggleAttachBot:u,openChat:p,changeWebAppModalState:v,openWebAppTab:g,updateWebApp:A,openMoreAppsTab:f,closeMoreAppsTab:b,updateMiniAppCachedPosition:C,updateMiniAppCachedSize:y}=(0,n.ko)(),[S,N]=(0,s.Ul)(l||Xn);function w(){return"fullScreen"===e?.modalState?k.A.get():"maximized"===e?.modalState?S():Zn}const{openedWebApps:I,activeWebAppKey:P,openedOrderedKeys:F,sessionKeys:M,isMoreAppsTabActive:L}=e||{},R=P?I?.[P]:void 0,{isBackButtonVisible:x,headerColor:E,backgroundColor:V,isSettingsButtonVisible:_}=R||{},U=(0,s.Kr)(()=>F?.map(e=>{const t=I[e];return{bot:(0,n.mS)().users.byId[t.botId],webApp:t,isOpen:Boolean(R&&e===(0,cn.rp)(R))}}),[F,I,R]),{isMobile:O}=(0,Y.Ay)(),K=e?.isModalOpen||!1,J="maximized"===e?.modalState,G="minimized"===e?.modalState,j="fullScreen"===e?.modalState,z=!O,H=(0,s.li)(),$=(0,s.li)(),q=(0,s.li)(),W=(0,T.A)(()=>H.current),Q=(0,T.A)(()=>H.current),Z=(0,T.A)(()=>q.current),{isContextMenuOpen:ee,contextMenuAnchor:ie,handleContextMenu:ne,handleContextMenuClose:oe,handleContextMenuHide:ae}=(0,Ws.A)(H),[re,le]=(0,s.J0)(!1),ce=$.current,de=H.current;(0,s.vJ)(()=>{le(Boolean(z&&ce&&de&&!j))},[z,ce,de,j]),(0,s.vJ)(()=>{v({state:"maximized"})},[z]);const{isDragging:pe,isResizing:ve,style:fe,size:be,position:Ce}=function(e,t,i=!0,n,o=!1,r={width:0,height:0},l){const[c,d]=(0,s.J0)(l),[h,m]=(0,s.J0)(void 0),[u,p]=(0,s.Ul)({x:0,y:0}),[v,g]=(0,s.Ul)({width:0,height:0}),[A,f]=(0,s.Ul)({x:0,y:0}),b=u(),C=A(),y=e.current,S=t.current,[N,k]=(0,D.A)(!1),[w,I]=(0,D.A)(!1),[P,Y,F]=(0,D.A)(!1),[M,B,L]=(0,D.A)(!1),[R,x,E]=(0,D.A)(!1),[V,_]=(0,s.J0)(void 0);function U(){return{width:window.innerWidth,height:window.innerHeight}}const O=(0,T.A)(e=>{o||d({x:e.x,y:e.y})}),K=(0,T.A)(()=>o?gn:c),J=(0,T.A)(()=>{if(!h)return;const{width:e,height:t}=h,i=U();return{x:(i.width-e)/2,y:(i.height-t)/2}});(0,s.vJ)(()=>{y&&I()},[y]),(0,s.vJ)(()=>{if(!N&&h){const e=J();if(!e)return;O(e),k()}},[h,N,y]);const G=(0,T.A)(e=>{if(e instanceof MouseEvent&&0!==e.button)return;if(e.target.closest(".no-drag")||!y)return;const{x:t,y:i}=(0,Ke.A)(e),{left:s,top:n}=y.getBoundingClientRect();p({x:s,y:n}),f({x:t,y:i}),Y()}),j=(0,T.A)(e=>{if(e instanceof MouseEvent&&0!==e.button)return;const t=e.target;if(!y||!t)return;const i=function(e){const t=t=>e.closest(t);if(t(a.cnh))for(const e of pn)if(t(`.${e}`))return un[e]}(t);if(void 0===i)return;_(i);const{x:s,y:n}=(0,Ke.A)(e),{left:o,right:r,top:l,bottom:c}=y.getBoundingClientRect();p({x:o,y:l}),g({width:r-o,height:c-l}),f({x:s,y:n}),B()}),z=(0,T.A)(()=>{F()}),H=(0,T.A)(()=>{L()});(0,s.vJ)(()=>{i||F()},[i]);const $=(e,t)=>{const i=U(),s=i.width,n=i.height,o=h.width,a=h.height;let r=e,l=t;return r<0&&(r=0),l<0&&(l=0),r+o>s&&(r=s-o),l+a>n&&(l=n-a),{x:r,y:l}},q=(0,T.A)(()=>{if(o)return;const e=w||l?c:J();if(!h||!e)return;const t=$(e.x,e.y);O(t)}),W=(0,T.A)(e=>{const t=e,i=U(),s=n.width,o=n.height;return t.width=Math.min(i.width,Math.max(s,t.width)),t.height=Math.min(i.height,Math.max(o,t.height)),t});(0,s.vJ)(()=>{if(M)return;const e=W({width:n.width,height:n.height});e&&m(e)},[n,M]);const Q=(0,T.A)(()=>{if(!h||M)return;const e=W(h);e&&m(e)});(0,s.vJ)(()=>{M||q()},[h,M]),(0,s.vJ)(()=>{const e=()=>{x(),Q(),q(),vn&&(clearTimeout(vn),vn=void 0),vn=window.setTimeout(()=>{vn=void 0,E()},250)};return window.addEventListener("resize",e),()=>{clearTimeout(vn),vn=void 0,window.removeEventListener("resize",e)}},[q]);const Z=(0,T.A)(e=>{if(!P||!y)return;const{x:t,y:i}=(0,Ke.A)(e),s=t-C.x,n=i-C.y,o=b.x+s,a=b.y+n;h&&d($(o,a))}),X=(0,T.A)(e=>{if(!M||!y||void 0===V)return;const{x:t,y:i}=(0,Ke.A)(e),s=v(),n=Math.min(Math.max(0,t),U().width),o=Math.min(Math.max(0,i),U().height),a=n-C.x,l=o-C.y,c=b.x+s.width-r.width,h=b.y+s.height-r.height,u={x:b.x,y:b.y,width:s.width,height:s.height};V!==mn.Left&&V!==mn.TopLeft&&V!==mn.BottomLeft||(u.width=Math.max(s.width-a,r.width),u.x=Math.min(u.x+a,c)),V!==mn.Right&&V!==mn.TopRight&&V!==mn.BottomRight||(u.width=Math.max(s.width+a,r.width)),V!==mn.Top&&V!==mn.TopLeft&&V!==mn.TopRight||(u.height=Math.max(s.height-l,r.height),u.y=Math.min(u.y+l,h)),V!==mn.Bottom&&V!==mn.BottomLeft&&V!==mn.BottomRight||(u.height=Math.max(s.height+l,r.height)),m({width:u.width,height:u.height}),d({x:u.x,y:u.y})});(0,s.vJ)(()=>{let e;return S&&i&&(e=(0,Ae.wJ)(S,{onCapture:G,onDrag:Z,onRelease:z,onClick:z,onDoubleClick:z})),e},[i,S]),(0,s.vJ)(()=>{const e=[];if(y&&i)for(const t of pn){const i=y.querySelector(`.resizeHandle.${t}`);if(i){const t=(0,Ae.wJ)(i,{onCapture:j,onDrag:X,onRelease:H,onClick:H,onDoubleClick:H});t&&e.push(t)}}return()=>{e.forEach(e=>e())}},[i,y]);const ee=P?"cursor: grabbing !important; ":"",te=K();if(!N||!h||!te)return{isDragging:!1,style:ee};const ie=(0,tt.A)(`left: ${te.x}px;`,`top: ${te.y}px;`,!o&&`max-width: ${h.width}px;`,!o&&`max-height: ${h.height}px;`,"position: fixed;",(P||M||R)&&"transition: none !important;",ee);return{position:c,size:h,isDragging:P,isResizing:M,style:ie}}(H,$,re,w(),j,function(){if("maximized"===e?.modalState)return eo}(),c),ye=Ce?.x,Se=Ce?.y;(0,s.vJ)(()=>{pe||void 0===ye||void 0===Se||C({position:{x:ye,y:Se}})},[pe,ye,Se]),(0,s.vJ)(()=>{!pe&&be&&J&&y({size:be})},[pe,J,be]);const Ne=be||w(),ke=Ne.width,we=Ne.height;(0,s.vJ)(()=>{ve&&N({width:ke,height:we})},[we,ke,ve,N]);const Ie=(0,B.A)(),Pe=(0,Fi.A)(),{queryId:Ye}=R||{},Fe=I?Object.values(I).length:0;(0,hn.A)(()=>{I&&Object.keys(I).forEach(e=>{const i=I[e];i.queryId&&m({botId:i.botId,queryId:i.queryId,peerId:i.peerId||t.id,replyInfo:i.replyInfo})})},Ye?45e3:void 0,!0);const De=(0,s.li)(null),Me=(0,s.li)(null),Te=(0,T.A)(e=>{De.current=e}),Be=(0,T.A)(e=>{De.current&&De.current(e)}),Le=(0,T.A)(e=>{Me.current=e}),Re=(0,T.A)(e=>{Me.current&&Me.current(e)}),xe=(0,T.A)(()=>{Be({eventType:"settings_button_pressed"})}),Ee=(0,T.A)(()=>{Re(R.url)}),Ve=(0,T.A)(()=>{h()}),_e=(0,T.A)(()=>{b()}),Ue=(0,T.A)(()=>{Fe>1?d():h()}),Oe=(0,T.A)(()=>{if(o){const e=(0,cn.rp)(R);return void A({key:e,update:{isRemoveModalOpen:!0}})}u({botId:i.id,isEnabled:!0})}),Je=(0,T.A)(()=>{x?Be({eventType:"back_button_pressed"}):Ve()}),Ge=(0,T.A)(()=>{v({state:"minimized"})}),je=(0,T.A)(()=>{v({state:"fullScreen"})}),ze=(0,T.A)(()=>{f()}),He=(0,T.A)(e=>{g({webApp:e.webApp})}),$e=(0,T.A)(()=>{p({id:i.id})}),qe=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.Y)(X.A,{className:(0,ge.A)(z?"gkji2_RB":"kKPD09tc",t&&"active"),round:!0,ripple:!O,size:z?"tiny":"smaller",color:"translucent",onClick:e,ariaLabel:"More actions",iconName:"more"}),[O,z]);function We(){return(0,se.FD)(se.FK,{children:[t&&i&&t.id!==i.id&&(0,se.Y)(ue.A,{icon:"bots",onClick:$e,children:Ie("BotWebViewOpenBot")}),(0,se.Y)(ue.A,{icon:"reload",onClick:Ee,children:Ie("WebApp.ReloadPage")}),_&&(0,se.Y)(ue.A,{icon:"settings",onClick:xe,children:Ie("Settings")}),i?.isAttachBot&&(0,se.Y)(ue.A,{icon:o?"stop":"install",onClick:Oe,destructive:Boolean(o),children:Ie(o?"WebApp.RemoveBot":"WebApp.AddToAttachmentAdd")})]})}function Qe(){return(0,se.Y)(Ze.A,{isOpen:ee,anchor:ie,ref:q,className:(0,ge.A)(z?Hn:"web-app-more-menu","with-menu-transitions"),getTriggerElement:W,getMenuElement:Z,getRootElement:Q,autoClose:!0,onClose:oe,onCloseAnimationEnd:ae,children:We()})}const Xe=(0,ge.A)("RuJ3d9N6",x&&"IWA50OWU"),et=(0,s.Kr)(()=>{if(L)return"color-text";if(!E)return;const{r:e,g:t,b:i}=(0,dn.hF)(E),s=(0,dn.LS)([e,t,i]);return("dark"===r?255-s:s)>128?"color-text":"color-background"},[E,r,L]);function it(e){return(0,se.Y)("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:(0,se.Y)("path",{className:"bOuMHiVw","fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 16V0C16 12 12 16 0 16H16Z"})})}const st=(0,s.li)();function nt(e){return(0,ge.A)(a.jQ1,e)}return(0,An.A)(st,!K||G||!st.current),(0,se.FD)(te.A,{dialogRef:H,className:(0,ge.A)("XWfkIDLY",z&&"gBVR7Hec",G&&"dJ1Ld_PX",j&&"ciSTWz16"),dialogStyle:z?fe:void 0,dialogContent:re&&!G?(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{className:nt("top")}),(0,se.Y)("div",{className:nt("bottom")}),(0,se.Y)("div",{className:nt("left")}),(0,se.Y)("div",{className:nt("right")}),(0,se.Y)("div",{className:nt("topLeft")}),(0,se.Y)("div",{className:nt("topRight")}),(0,se.Y)("div",{className:nt("bottomLeft")}),(0,se.Y)("div",{className:nt("bottomRight")})]}):void 0,isOpen:K,isLowStackPriority:!0,onClose:Ve,header:(0,se.Y)("div",{ref:$,children:z?J?(0,se.FD)("div",{className:(0,ge.A)("modal-header","multiTab"),style:(0,tt.A)(et&&`--color-header-text: var(--${et})`),children:[(0,se.Y)(X.A,{className:"GE5AkJOU",round:!0,color:"translucent",size:"tiny",ariaLabel:Ie(x?"Back":"Close"),onClick:Je,children:(0,se.Y)("div",{className:Xe})}),(0,se.FD)("div",{className:"X18WbDa5",ref:st,children:[U?.map(e=>e.isOpen?function(){const e=(0,tt.A)(et&&`--color-header-text: var(--${et})`,E&&`--active-tab-background: ${E}`);return(0,se.FD)("div",{className:On,style:e,children:[it(jn),(0,se.FD)("div",{className:Kn,children:[(0,se.FD)("div",{className:"z39ojrWc",children:[(0,se.Y)(Yt.A,{size:"mini",peer:i}),(0,se.Y)(qe,{onTrigger:ne,isOpen:ee})]}),o?.shortName??i?.firstName,(0,se.Y)("div",{className:Jn}),(0,se.Y)(X.A,{className:Gn,round:!0,color:"translucent",size:"tiny",iconName:"close",iconClassName:qn,ariaLabel:Ie("Close"),onClick:Ue})]}),it(zn)]})}():(0,se.Y)(Yt.A,{className:"tI6TE6HP",size:"mini",peer:e.bot,onClick:()=>He(e)})),L&&(0,se.FD)("div",{className:On,children:[it(jn),(0,se.FD)("div",{className:Kn,children:[(0,se.Y)("div",{className:"Obu3ui67",children:(0,se.Y)(he.A,{className:Qn,name:"add"})}),Pe("OpenApp"),(0,se.Y)("div",{className:Jn}),(0,se.Y)(X.A,{className:Gn,round:!0,color:"translucent",size:"tiny",iconName:"close",iconClassName:qn,ariaLabel:Ie("Close"),onClick:_e})]}),it(zn)]})]}),Qe(),(0,se.FD)("div",{className:"qK4q0Sat",children:[!L&&(0,se.Y)(X.A,{className:(0,ge.A)("cEuW1_hJ","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:ze,iconName:"add",iconClassName:Qn}),!L&&(0,se.Y)(X.A,{className:(0,ge.A)($n,"otlJULGy","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:je,iconName:"expand-modal",iconClassName:Wn}),(0,se.Y)(X.A,{className:(0,ge.A)($n,"no-drag"),round:!0,color:"translucent",size:"tiny",onClick:Ge,iconClassName:Wn,iconName:"collapse-modal"})]})]}):(0,se.Y)(fn,{}):(0,se.FD)("div",{className:"modal-header",style:(0,tt.A)(E&&`background-color: ${E}`,et&&`--color-header-text: var(--${et})`),children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ie(x?"Back":"Close"),onClick:Je,children:(0,se.Y)("div",{className:Xe})}),(0,se.Y)("div",{className:"modal-title",children:o?.shortName??i?.firstName}),!L&&(0,se.Y)(me.A,{className:(0,ge.A)(z?Hn:"web-app-more-menu","with-menu-transitions"),trigger:qe,positionX:z?"left":"right",children:We()})]})}),style:`background-color: ${V||"var(--color-background)"}`,noBackdrop:!0,noBackdropClose:!0,children:[j&&Qe(),I&&M?.map(t=>(0,se.Y)(Un,{modal:e,registerSendEventCallback:Te,registerReloadFrameCallback:Le,webApp:I[t],isTransforming:pe||ve,onContextMenuButtonClick:ne,isMultiTabSupported:z,modalHeight:we},t)),L&&(0,se.Y)(In,{})]})})),io=(0,s.ph)(({bot:e,type:t,shouldRequestWriteAccess:i})=>{const{cancelBotTrustRequest:o,markBotTrusted:a}=(0,n.ko)(),[r,c]=(0,s.J0)(i||!1),d=(0,B.A)(),h=(0,s.hb)(()=>{a({botId:e.id,isWriteAllowed:r})},[a,r,e]),m=(0,s.hb)(()=>{o()},[]),u=d("game"===t?"AppName":"BotOpenPageTitle"),p=(0,s.Kr)(()=>{switch(t){case"game":return d("BotPermissionGameAlert",(0,l.Yg)(e));case"webApp":return d("BotOpenPageMessage",(0,l.Yg)(e));default:return d("BotWebViewStartPermission")}},[e,t,d]);return(0,se.FD)(oi.A,{isOpen:Boolean(e),onClose:m,title:u,confirmHandler:h,children:[(0,Pt.A)(p,["simple_markdown"]),i&&(0,se.Y)(Hs.A,{className:"dialog-checkbox",checked:r,label:(0,Pt.A)(d("WebApp.AddToAttachmentAllowMessages",e?.firstName),["simple_markdown"]),onCheck:c})]})}),so=(0,s.ph)(({modal:e})=>{const{confirmAttachBotInstall:t,cancelAttachBotInstall:i}=(0,n.ko)(),o=e?.bot,[r,l]=(0,s.J0)(!1),c=(0,B.A)(),d=(0,s.hb)(()=>{t({isWriteAllowed:Boolean(o?.shouldRequestWriteAccess)})},[t,o]);(0,s.vJ)(()=>{o&&l(!1)},[o]);const h=(0,s.Kr)(()=>{const e=c("lng_mini_apps_disclaimer_button").split("{link}"),t=c("lng_mini_apps_disclaimer_link");return[e[0],(0,se.Y)("a",{href:a.Pje,target:"_blank",rel:"noopener noreferrer",children:t}),e[1]]},[c]);return(0,se.FD)(oi.A,{isOpen:Boolean(o),onClose:i,title:c("lng_mini_apps_disclaimer_title"),confirmHandler:d,isConfirmDisabled:!r,children:[(0,Pt.A)(c("lng_mini_apps_disclaimer_text",o?.shortName),["simple_markdown"]),(0,se.Y)(Hs.A,{className:"dialog-checkbox",checked:r,label:h,onCheck:l}),(0,Pt.A)(c("WebBot.Account.Desclaimer.Desc",o?.shortName),["simple_markdown"])]})}),no=(0,s.ph)(({folder:e})=>{const{closeDeleteChatFolderModal:t,deleteChatFolder:i,openDeleteChatFolderModal:o}=(0,n.ko)(),a=(0,B.A)(),r=Boolean(e),l=(0,K.A)(e)||e,c=l?.hasMyInvites,d=(0,s.hb)(()=>{t(),c?o({folderId:l.id,isConfirmedForChatlist:!0}):i({id:l.id})},[c,l]);return(0,se.Y)(oi.A,{isOpen:r,onClose:t,text:a(c?"FilterDeleteAlertLinks":"FilterDeleteAlert"),confirmLabel:a("Delete"),confirmHandler:d,confirmIsDestructive:!0})});var oo=i(17142),ao=i(66833),ro=i(87412),lo=i(38777);const co={root:"Wn7D2H1e",text:"IQ1U2TrZ",header:"F6qqXRvD",description:"ILLaH6qQ",icon:"DzGwbpu5","font-icon":"Pa9h5mh3",fontIcon:"Pa9h5mh3"},ho=["#F2862D","#EB7B4D","#E46D72","#DD6091","#CC5FBA","#B464E7","#9873FF","#768DFF","#55A5FC","#52B0C9","#4FBC93","#4CC663"].map(dn.hF),mo=(0,s.ph)(({icon:e,isFontIcon:t,title:i,text:s,index:n,count:o,section:a,onClick:r})=>{const l=n/o*ho.length,c=ho[Math.floor(l)],d=ho[Math.ceil(l)]??c,{r:h,g:m,b:u}=(0,dn.R5)(c,d,.5),p=(0,T.A)(()=>{r?.(a)});return(0,se.FD)(li.A,{buttonClassName:co.root,onClick:p,inactive:!r,children:[t?(0,se.Y)(he.A,{name:e,className:co.fontIcon,style:`--item-color: rgb(${h},${m},${u})`}):(0,se.Y)("img",{src:e,className:co.icon,alt:"",style:`--item-color: rgb(${h},${m},${u})`,draggable:!1}),(0,se.FD)("div",{className:co.text,children:[(0,se.Y)("div",{className:co.title,children:(0,Pt.A)(i,["br"])}),(0,se.Y)("div",{className:co.description,children:s})]})]})});var uo=i(57446);const po="cqNhvdib",vo="wDzTWXzO",go=(0,s.ph)(({length:e,active:t,onSelectSlide:i})=>{const n=Math.max(0,Math.min(e-8,t-4)),o=n===e-8-1,a=n===e-8,r=0===n,l=1===n,c=Math.min(e,8),d=(0,s.hb)(()=>{i(t+1)},[t,i]),h=(0,s.hb)(()=>{i(t-1)},[t,i]),u=Math.min(8,e);return(0,se.FD)("div",{children:[!m.TF&&(0,se.Y)(X.A,{className:(0,ge.A)(po,0===t&&vo),color:"translucent",disabled:0===t,round:!0,onClick:h,iconName:"previous"}),(0,se.Y)("div",{className:"HmY1pYD9",style:`--start-from: ${n}; --length: ${e}; --count: ${u};`,children:Array(e).fill(void 0).map((e,s)=>{const d=s,h=s===n+c-1&&!a&&!o,m=s===n+c-2&&!o&&!a||s===n+c-1&&o,u=s===n&&!r&&!l,p=s===n+1&&!r&&!l||s===n&&l,v=s<n||s>=n+c;return(0,se.Y)("div",{onClick:()=>i(s),className:(0,ge.A)("Ac0pMX9w",d===t&&"NYDxCNdz",(m||p)&&"yDo_8Y7X",(h||u||v)&&"bhODNwmU",v&&"O9pyrgj0")})})}),!m.TF&&(0,se.Y)(X.A,{className:(0,ge.A)(po,t===e-1&&vo,"hIgQCprt"),color:"translucent",round:!0,disabled:t===e-1,onClick:d,iconName:"next"})]})}),Ao="Hy5kWx0p",fo=(0,s.ph)(({leftValue:e,rightValue:t,className:i,floatingBadgeIcon:s,rightStyle:n})=>{const o=(0,B.A)();return(0,se.FD)("div",{className:(0,ge.A)("u84X0r2z",i),children:[s&&(0,se.FD)("div",{className:"hPi4fICJ",children:[(0,se.Y)(he.A,{name:s,className:"XkiOXdMP"}),(0,se.Y)("div",{className:"iC3LJrvy",dir:o.isRtl?"rtl":void 0,children:e}),(0,se.Y)("div",{className:"jufjjcX9",children:(0,se.Y)("svg",{width:"26",height:"9",viewBox:"0 0 26 9",fill:"none",children:(0,se.Y)("path",{d:"M0 0H26H24.4853C22.894 0 21.3679 0.632141 20.2426 1.75736L14.4142 7.58579C13.6332 8.36684 12.3668 8.36683 11.5858 7.58579L5.75736 1.75736C4.63214 0.632139 3.10602 0 1.51472 0H0Z",fill:"#7E85FF"})})})]}),(0,se.FD)("div",{className:(0,ge.A)(Ao,"scGr4JS9"),children:[(0,se.Y)("div",{className:"OejVAPj6 YaiSoFKE YaiSoFKE",dir:o.isRtl?"rtl":void 0,children:o("LimitFree")}),!s&&(0,se.Y)("div",{className:"RJosx238 YaiSoFKE",children:e})]}),(0,se.FD)("div",{className:(0,ge.A)(Ao,"nPaUalQf"),style:n,children:[(0,se.Y)("div",{className:"COQdFBQk YaiSoFKE YaiSoFKE",dir:o.isRtl?"rtl":void 0,children:o("LimitPremium")}),(0,se.Y)("div",{className:"BEq3jFlz YaiSoFKE YaiSoFKE",children:t})]})]})}),bo=[91,160,255],Co=[197,100,243],yo=(0,s.ph)(({title:e,description:t,leftValue:i,rightValue:n,colorStepProgress:o})=>{const a=(0,s.Kr)(()=>bo.map((e,t)=>(0,fe.Cc)(e,Co[t],o)),[o]);return(0,se.FD)("div",{className:"ZXp65Wgy",children:[(0,se.Y)("div",{className:"W1xG3pjS",children:e}),(0,se.Y)("div",{className:"b_CBXIkT",children:t}),(0,se.Y)(fo,{leftValue:i,rightValue:n,rightStyle:`background: rgb(${a.join(",")})`})]})});var So=i(67054),No=i(18104);const ko=({size:e,realIndex:t,canPlay:i,sticker:n,index:o,maxLength:a,onClick:r,onEnded:l})=>{const c=(0,q.A)(`sticker${n.id}`),d=(0,q.A)(`sticker${n.id}?size=f`),h=0===o,[m,u,p]=(0,D.A)(h),v=e-.6*e,g=3*v,A=3.2*v,f=o/a*(2*Math.PI),b=h?1:.66,C=Math.cos(f)*g-2.8*v,y=Math.sin(f)*A,S=(0,T.A)(()=>{r(t)}),N=(0,T.A)(()=>{p(),l(t)});return(0,s.vJ)(()=>{h&&u()},[h,u]),(0,se.FD)(se.FK,{children:[h&&(0,se.Y)(No.A,{className:"Stdz4UIW ogaoEAcn",tgsUrl:d,play:i,isLowPriority:!0,noLoop:!0,size:.8*e,style:`--x: calc(${C}px - 10%); --y: ${y}px;`}),(0,se.Y)(No.A,{className:"ogaoEAcn",tgsUrl:c,play:i&&m,noLoop:!0,size:.6*e,style:`--x: ${C}px; --y: ${y}px; --opacity: ${b}`,onClick:S,onEnded:N})]})},wo=(0,s.ph)((0,n.EK)(e=>({stickers:e.stickers.premium.stickers}))(({stickers:e,isActive:t})=>{const i=(0,s.li)(),[n,o]=(0,s.J0)(0),[a,r]=(0,s.J0)(0),l=e?.slice(0,15),c=(0,T.A)(e=>{o(-e)}),d=(0,T.A)(e=>{0===(0,So.A)(l.length,e+n)&&setTimeout(()=>{o(e=>(0,So.A)(l.length,e+1))},150)});return(0,s.vJ)(()=>{const e=i.current;e&&r(e.closest(".modal-dialog").clientWidth)},[]),(0,se.Y)("div",{className:"O1fqNCy0",ref:i,children:Boolean(a)&&l?.map((e,i)=>(0,se.Y)(ko,{size:a,sticker:e,realIndex:i,index:(i+n+l.length)%l.length,maxLength:l.length,onClick:c,onEnded:d,canPlay:t}))})}));var Io=i(38691),Po=i(88554);const Yo=["#A667FF","#55A5FF"],Fo={stories_order:"PremiumStoriesPriority",stories_stealth:"PremiumStoriesStealth",stories_views:"PremiumStoriesViews",stories_timer:"lng_premium_stories_subtitle_expiration",stories_save:"PremiumStoriesSaveToGallery",stories_caption:"lng_premium_stories_subtitle_caption",stories_link:"lng_premium_stories_subtitle_links"},Do={stories_order:"PremiumStoriesPriorityDescription",stories_stealth:"PremiumStoriesStealthDescription",stories_views:"PremiumStoriesViewsDescription",stories_timer:"PremiumStoriesExpirationDescription",stories_save:"PremiumStoriesSaveToGalleryDescription",stories_caption:"PremiumStoriesCaptionDescription",stories_link:"PremiumStoriesFormattingDescription"},Mo={stories_order:"story-priority",stories_stealth:"eye-crossed-outline",stories_views:"eye-outline",stories_timer:"timer",stories_save:"arrow-down-circle",stories_caption:"story-caption",stories_link:"link-badge"},To=Object.keys(Fo),Bo=.25*g.$,Lo=Yt.R.giant+Bo,Ro=(0,s.ph)((0,n.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({currentUser:e})=>{const t=(0,s.li)(),i=(0,B.A)(),n=(0,Io.A)();(0,s.Nf)(()=>{t.current&&(0,Po.$)({canvas:t.current,size:Lo,strokeWidth:Bo,segmentsCount:8,colorStops:Yo,readSegmentsCount:0,readSegmentColor:"transparent",dpr:n})},[n]);const{handleScroll:o,isAtBeginning:a}=(0,rs.A)(),r=Lo;return(0,se.FD)("div",{className:"mFElmm7a",children:[(0,se.FD)("div",{className:"Jjbochk6",children:[(0,se.Y)(Yt.A,{forPremiumPromo:!0,peer:e,size:"giant"}),(0,se.Y)("canvas",{className:"ChteQ9C3",ref:t,style:`max-width: ${r}px; max-height: ${r}px`})]}),(0,se.Y)("div",{className:"d2ayix6L",children:i("UpgradedStories")}),(0,se.FD)("div",{className:(0,ge.A)("ensyCeMe",!a&&"iN1T0a2Y","custom-scroll"),onScroll:o,children:[To.map((e,t)=>(0,se.Y)(mo,{title:i(Fo[e]),text:i(Do[e]),icon:Mo[e],isFontIcon:!0,index:t,count:To.length,section:e},e)),(0,se.Y)("div",{className:"DFbZJafh",children:i("lng_premium_stories_about_mobile")})]})]})}));var xo=i(83240);const Eo="a7IoUtQG",Vo="gubS9KP1",_o="iZLwcL8v",Uo="A7YHY8qF",Oo={double_limits:"PremiumPreviewLimits",infinite_reactions:"PremiumPreviewReactions2",premium_stickers:"PremiumPreviewStickers",animated_emoji:"PremiumPreviewEmoji",no_ads:"PremiumPreviewNoAds",voice_to_text:"PremiumPreviewVoiceToText",profile_badge:"PremiumPreviewProfileBadge",faster_download:"PremiumPreviewDownloadSpeed",more_upload:"PremiumPreviewUploads",advanced_chat_management:"PremiumPreviewAdvancedChatManagement",animated_userpics:"PremiumPreviewAnimatedProfiles",emoji_status:"PremiumPreviewEmojiStatus",translations:"PremiumPreviewTranslations",stories:"PremiumPreviewStories",saved_tags:"PremiumPreviewTags2",last_seen:"PremiumPreviewLastSeen",message_privacy:"PremiumPreviewMessagePrivacy",effects:"Premium.MessageEffects",todo:"PremiumPreviewTodo"},Ko={double_limits:"PremiumPreviewLimitsDescription",infinite_reactions:"PremiumPreviewReactions2Description",premium_stickers:"PremiumPreviewStickersDescription",no_ads:"PremiumPreviewNoAdsDescription",animated_emoji:"PremiumPreviewEmojiDescription",voice_to_text:"PremiumPreviewVoiceToTextDescription",profile_badge:"PremiumPreviewProfileBadgeDescription",faster_download:"PremiumPreviewDownloadSpeedDescription",more_upload:"PremiumPreviewUploadsDescription",advanced_chat_management:"PremiumPreviewAdvancedChatManagementDescription",animated_userpics:"PremiumPreviewAnimatedProfilesDescription",emoji_status:"PremiumPreviewEmojiStatusDescription",translations:"PremiumPreviewTranslationsDescription",stories:"PremiumPreviewStoriesDescription",saved_tags:"PremiumPreviewTagsDescription2",last_seen:"PremiumPreviewLastSeenDescription",message_privacy:"PremiumPreviewMessagePrivacyDescription",effects:"Premium.MessageEffectsInfo",todo:"PremiumPreviewTodoDescription"},Jo={channels:"GroupsAndChannelsLimitTitle",dialogFolderPinned:"PinChatsLimitTitle",channelsPublic:"PublicLinksLimitTitle",savedGifs:"SavedGifsLimitTitle",stickersFaved:"FavoriteStickersLimitTitle",aboutLength:"BioLimitTitle",captionLength:"CaptionsLimitTitle",dialogFilters:"FoldersLimitTitle",dialogFiltersChats:"ChatPerFolderLimitTitle",recommendedChannels:"SimilarChannelsLimitTitle",moreAccounts:"ConnectedAccountsLimitTitle"},Go={channels:"GroupsAndChannelsLimitSubtitle",dialogFolderPinned:"PinChatsLimitSubtitle",channelsPublic:"PublicLinksLimitSubtitle",savedGifs:"SavedGifsLimitSubtitle",stickersFaved:"FavoriteStickersLimitSubtitle",aboutLength:"BioLimitSubtitle",captionLength:"CaptionsLimitSubtitle",dialogFilters:"FoldersLimitSubtitle",dialogFiltersChats:"ChatPerFolderLimitSubtitle",recommendedChannels:"SimilarChannelsLimitSubtitle",moreAccounts:"ConnectedAccountsLimitSubtitle"},jo=(0,s.ph)(({promo:e,initialSection:t,isPremium:i,limits:n,premiumPromoOrder:o,subscriptionOption:l,onBack:c,onClickSubscribe:d})=>{const h=(0,B.A)(),m=(0,Fi.A)(),u=(0,s.li)(),[p,v]=(0,s.J0)(a.O2i.indexOf(t)),[g,A]=(0,s.J0)(0),[f,b,C]=(0,D.A)(),[y,S]=(0,s.J0)(!0),[N,k]=(0,s.J0)(!1),w=(0,K.A)(t),I=(0,s.Kr)(()=>o?o.filter(e=>a.O2i.includes(e)):a.O2i,[o]),P=(0,s.Kr)(()=>{if(!l)return;const{amount:e,months:t,currency:s}=l,n=Math.floor(e/t);return i?m("OK"):m("SubscribeToPremium",{price:(0,oo.vv)(m,n,s)},{withNodes:!0})},[i,m,l]),Y=(0,T.A)(()=>{d(t)});function F(e){const{scrollTop:t,clientHeight:i,scrollHeight:s}=e.currentTarget;S(t<=20),k(t>=s-i-20)}(0,s.vJ)(()=>{const e=u.current;if(!e||w===t)return;const i=I.indexOf(t);v(i),b(),(0,uo.A)(e,e.clientWidth*i,0).then(C)},[p,I,t,w]);const M=(0,T.A)(async e=>{const t=u.current;t&&(v(e),b(),await(0,uo.A)(t,t.clientWidth*e,800),C())}),L=I[p],R="double_limits"!==L&&"stories"!==L;return(0,se.FD)("div",{className:"oyUTEj8I",children:[(0,se.Y)(X.A,{round:!0,size:"tiny",className:(0,ge.A)("njYoMrKM",R&&"SB4pczOo"),color:R?"translucent-white":"translucent",onClick:c,ariaLabel:h("Back"),iconName:"arrow-left"}),(0,se.Y)("div",{className:"dIVBSdWi"}),(0,se.Y)("div",{className:(0,ge.A)("sJubG84j","no-scrollbar"),onScroll:function(e){const t=e.currentTarget,{clientWidth:i,scrollLeft:s}=t,n=Math.round(s),o=n%i/i,a=Math.ceil((n+1)/i);A(a);const l=t.querySelector("#premium_feature_preview_video_"+(a-1)),c=t.querySelector(`#premium_feature_preview_video_${a}`);if((0,r.RK)(()=>{t.style.setProperty("--scroll-progress",o.toString()),t.style.setProperty("--abs-scroll-progress",Math.abs(o).toString()),l&&(0,et.dH)(l,"reverse",!1),c&&(0,et.dH)(c,"reverse",!0)}),f)return;const d=Math.round(n/i);v(d)},ref:u,children:I.map((t,i)=>{if("double_limits"===t)return(0,se.FD)("div",{className:(0,ge.A)(Vo,"U7ePgVBR"),children:[(0,se.Y)("h2",{className:(0,ge.A)("mz2Hmd83",y&&"AgmNOqi7"),children:h(Oo.double_limits)}),(0,se.Y)("div",{className:(0,ge.A)("n_rowVPI","custom-scroll"),onScroll:F,children:a.M$8.map((e,t)=>{const i=n?.[e][0].toString(),s=n?.[e][1].toString();return(0,se.Y)(yo,{title:h(Jo[e]),description:h(Go[e],s),leftValue:i,rightValue:s,colorStepProgress:t/(a.M$8.length-1)})})})]});if("premium_stickers"===t)return(0,se.FD)("div",{className:Vo,children:[(0,se.Y)("div",{className:Eo,children:(0,se.Y)(wo,{isActive:p===i})}),(0,se.Y)("h1",{className:_o,children:h(Oo.premium_stickers)}),(0,se.Y)("div",{className:Uo,children:(0,Pt.A)(h(Ko.premium_stickers),["br"])})]});if("stories"===t)return(0,se.Y)("div",{className:(0,ge.A)(Vo,"J1M6fEdo"),children:(0,se.Y)(Ro,{})});const s=e.videoSections.indexOf(t);if(-1===s)return;const o="todo"===t;return(0,se.FD)("div",{className:Vo,children:[(0,se.Y)("div",{className:Eo,children:(0,se.Y)(xo.A,{isActive:p===i,videoId:e.videos[s].id,videoThumbnail:e.videos[s].thumbnail,isDown:a.jhT.includes(t),index:i,isReverseAnimation:i===g})}),(0,se.Y)("h1",{className:_o,children:o?m(Oo.todo,void 0,{withNodes:!0,renderTextFilters:["br"]}):h(Oo[t])}),(0,se.Y)("div",{className:Uo,children:(0,Pt.A)(o?m(Ko.todo,void 0,{withNodes:!0,renderTextFilters:["br"]}):h(Ko[t]),["br"])})]})})}),(0,se.FD)("div",{className:(0,ge.A)("yN2611rA",(N||0!==p)&&"rCHMABcD"),children:[(0,se.Y)(go,{length:a.O2i.length,active:p,onSelectSlide:M}),Boolean(P)&&(0,se.Y)(X.A,{className:(0,ge.A)("EPfM7AgT"),isShiny:!i,withPremiumGradient:!i,onClick:i?c:Y,children:P})]})]})}),zo=(0,s.ph)(({option:e,checked:t,fullMonthlyAmount:i,onChange:n,className:o,isGiveaway:a})=>{const r=(0,B.A)(),l=(0,Fi.A)(),{months:c,amount:d,currency:h}=e,m="users"in e?e.users:void 0,u=Math.floor(d/c),p=m?m>1:void 0,v=(0,s.Kr)(()=>i&&i>u?Math.ceil(100-u/(i/100)):void 0,[i,u]),g=(0,s.hb)(e=>{e.target.checked&&n(c)},[c,n]);return(0,se.FD)("label",{className:(0,ge.A)(a?"PkseWxFK":"qZA6S2kc",t&&!a&&"EJOQwnRj",o),dir:l.isRtl?"rtl":void 0,children:[(0,se.Y)("input",{className:"WOEkhx6R",type:"radio",name:"subscription_option",value:c,checked:t,onChange:g}),(0,se.FD)("div",{className:"BHUCScsU",children:[(0,se.FD)("div",{className:"DfYCMUkL",children:[Boolean(v)&&(0,se.FD)("span",{className:(0,ge.A)("ublijP0j","uqDlP3Zt"),title:r("GiftDiscount"),children:[" ","âˆ’",v,"%"]}),r("Months",c)]}),(0,se.Y)("div",{className:"poxOXJ2o",children:a||p?`${(0,oo.Ad)(d,h,r.code)} x ${m}`:r("PricePerMonth",(0,oo.Ad)(u,h,r.code))}),(0,se.Y)("div",{className:"IGMrERf_",children:(0,oo.Ad)(d,h,r.code)})]})]})}),Ho="yKm9hKQP",$o=i.p+"PremiumAds.a758f19ece91fe91318e.svg",qo=i.p+"PremiumBadge.1c630afcfd1112ad16d0.svg",Wo=i.p+"PremiumChats.89d9d315638e283ca895.svg",Qo=i.p+"PremiumEffects.4eab9caad8e9c276842d.svg",Zo=i.p+"PremiumEmoji.26515017c8f6dc4f3f67.svg",Xo=i.p+"PremiumFile.884dd3865acfe594fc61.svg",ea=i.p+"PremiumLastSeen.9575a548770d23785846.svg",ta=i.p+"PremiumLimits.08701cb6df3cf756c5f7.svg",ia=i.p+"PremiumMessagePrivacy.950cab3e87c60c5733a6.svg",sa=i.p+"PremiumReactions.7fee56ab6b58c82fd15e.svg",na=i.p+"PremiumSpeed.d0a43b6780c411c2f84a.svg",oa=i.p+"PremiumStatus.c42f9c4b68f9c2c4537a.svg",aa=i.p+"PremiumStickers.7b5a8531a41b43d0da12.svg",ra=i.p+"PremiumTags.3b187054cc90f8e16cb7.svg",la=i.p+"PremiumTranslate.cb2dcbb898d96cb35469.svg",ca=i.p+"PremiumVideo.288cb61931e33d913f0a.svg",da=i.p+"PremiumVoice.b3a2893dbe481108ab94.svg",ha=8*g.$,ma={stories:oa,double_limits:ta,infinite_reactions:sa,premium_stickers:aa,animated_emoji:Zo,no_ads:$o,voice_to_text:da,profile_badge:qo,faster_download:na,more_upload:Xo,advanced_chat_management:Wo,animated_userpics:ca,emoji_status:oa,translations:la,saved_tags:ra,last_seen:ea,message_privacy:ia,effects:Qo,todo:qo},ua=(0,s.ph)((0,n.EK)(e=>{const{premiumModal:t}=(0,c.nTw)(e),i=t?.fromUserId?(0,c.mBe)(e,t.fromUserId):void 0,s=i?.emojiStatus?(0,c.O8F)(e,i.emojiStatus.documentId):void 0,n=s?(0,c.ycM)(e,s.stickerSetInfo):void 0;return{currentUserId:e.currentUserId,promo:t?.promo,isSuccess:t?.isSuccess,isGift:t?.isGift,daysAmount:t?.daysAmount,gift:t?.gift,fromUser:i,fromUserStatusEmoji:s,fromUserStatusSet:n,toUser:t?.toUserId?(0,c.mBe)(e,t.toUserId):void 0,initialSection:t?.initialSection,isPremium:(0,c.g29)(e),limitChannels:(0,bs.B)(e,"channels"),limitFolders:(0,bs.B)(e,"dialogFilters"),limitPins:(0,bs.B)(e,"dialogFolderPinned"),limitLinks:(0,bs.B)(e,"channelsPublic"),limits:e.appConfig.limits,premiumSlug:e.appConfig.premiumInvoiceSlug,premiumBotUsername:e.appConfig.premiumBotUsername,premiumPromoOrder:e.appConfig.premiumPromoOrder}})(({isOpen:e,currentUserId:t,fromUser:i,fromUserStatusEmoji:o,fromUserStatusSet:r,promo:c,initialSection:d,isPremium:h,limitChannels:m,limitLinks:u,limitFolders:p,limitPins:v,limits:g,premiumSlug:A,premiumBotUsername:f,isSuccess:b,isGift:C,toUser:y,daysAmount:S,premiumPromoOrder:N,gift:k})=>{const w=(0,s.li)(),{closePremiumModal:I,openInvoice:P,requestConfetti:Y,openTelegramLink:F,loadStickers:D,openStickerSet:M}=(0,n.ko)(),L=(0,B.A)(),R=(0,Fi.A)(),[x,E]=(0,s.J0)(!0),[V,_]=(0,s.J0)(d),[U,O]=(0,s.J0)();(0,s.vJ)(()=>{e?d&&_(d):(E(!0),_(void 0))},[e,d]);const K=(0,T.A)(e=>{_(e)}),J=(0,T.A)(()=>{_(void 0)}),G=(0,T.A)(e=>{w.current&&(A?P({type:"slug",slug:A}):f&&(F({url:`${a.jsp}${f}?start=${e||"promo"}`}),I()))}),j=(0,T.A)(()=>{U?G(String(U.months)):G()}),z=(0,T.A)(e=>{const t=c?.options.find(t=>t.months===e);O(t)}),H=(0,T.A)(()=>{const t=w.current;if(t&&e){const{top:e,left:i,width:s,height:n}=t.querySelector(".modal-content").getBoundingClientRect();Y({top:e,left:i,width:s,height:n,withStars:!0})}});(0,s.vJ)(()=>{b&&H()},[b,H]),(0,$.A)(([e])=>{e!==h&&H()},[h,H]);const q=(0,s.Kr)(()=>N?N.filter(e=>a.O2i.includes(e)):a.O2i,[N]);(0,s.vJ)(()=>{o&&!r&&D({stickerSetInfo:o.stickerSetInfo})},[D,o,r]),(0,s.vJ)(()=>{const[e]=c?.options??[];O(e)},[c]);const W=(0,T.A)(()=>{r&&M({stickerSetInfo:r})}),Q=(0,s.Kr)(()=>{const e=c?.options.find(e=>1===e.months);if(e)return Number(e.amount)},[c]),Z=(0,s.Kr)(()=>{if(!U)return;const{amount:e,months:t,currency:i}=U,s=Math.floor(e/t);return(0,oo.vv)(R,s,i)},[U,R]);if(c&&(!o||r))return(0,se.Y)(te.A,{className:"sfbpMFHM",onClose:I,isOpen:e,dialogRef:w,hasAbsoluteCloseButton:!V,children:(0,se.Y)(ae.Ay,{name:"slide",activeKey:V?1:0,className:"ELNkgPve",children:V?(0,se.Y)(jo,{initialSection:V,onBack:J,promo:c,onClickSubscribe:G,isPremium:h,limits:g,premiumPromoOrder:N,subscriptionOption:U}):(0,se.FD)("div",{className:(0,ge.A)("ZpOIPrhp","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;E(t<=150)},children:[function(){if(k){const e=(0,ao.yQ)(k);return(0,se.Y)(lo.A,{model:"sticker",sticker:e,color:"purple",title:ee(),description:(0,Pt.A)(ie(),["simple_markdown","emoji"]),className:"lzalivui"})}return o?(0,se.FD)(se.FK,{children:[(0,se.Y)(ro.A,{className:"mQwvY9LA",onClick:W,documentId:o.id,isBig:!0,size:ha}),(0,se.Y)("h2",{className:(0,ge.A)("y71v6ECL",r&&"xw_GbDj7"),children:ee()}),(0,se.Y)("div",{className:"cUcKXV3j",children:(0,Pt.A)(ie(),["simple_markdown","emoji"])})]}):(0,se.Y)(lo.A,{model:"swaying-star",color:"purple",title:ee(),description:(0,Pt.A)(ie(),["simple_markdown","emoji"]),className:"z0zfJObh"})}(),!h&&!C&&(0,se.Y)("div",{className:"xZC_Oajr",children:c?.options.map(e=>(0,se.Y)(zo,{className:"gygsbDbE",option:e,onChange:z,fullMonthlyAmount:Q,checked:U?.months===e.months},e.amount))}),(0,se.Y)("div",{className:(0,ge.A)("Bc_F0RKb",x&&"ltXo0Xi7"),children:(0,se.Y)("h2",{className:"xysPdANX",children:L("TelegramPremium")})}),(0,se.FD)("div",{className:(0,ge.A)("c3Ee2oSo",h&&"yWEHoJOL"),children:[q.map((e,t)=>{const i="todo"===e;return(0,se.Y)(mo,{title:i?R(Oo[e]):L(Oo[e]),text:"double_limits"===e?L(Ko[e],[m,p,v,u,4]):i?R(Ko[e]):L(Ko[e]),icon:ma[e],index:t,count:q.length,section:e,onClick:K},e)}),(0,se.FD)("div",{className:(0,ge.A)(Ho,"l1WlNpmu"),dir:R.isRtl?"rtl":void 0,children:[(0,se.Y)("p",{children:(0,Pt.A)(L("AboutPremiumDescription"),["simple_markdown"])}),(0,se.Y)("p",{children:(0,Pt.A)(L("AboutPremiumDescription2"),["simple_markdown"])})]}),function(){if(c&&(!C||i?.id!==t))return(0,se.Y)("div",{className:Ho,dir:R.isRtl?"rtl":void 0,children:(0,Oi.fd)({text:c.statusText,entities:c.statusEntities})})}()]}),!h&&U&&(0,se.Y)("div",{className:"nCnlO9UZ",children:(0,se.Y)(X.A,{className:"c1tMxuFH",isShiny:!0,withPremiumGradient:!0,onClick:j,children:L("SubscribeToPremium",Z)})})]})})});function ee(){if(k)return R("PremiumGiftHeader");if(C){const e=S?(0,We.w6)(R,S):"";return(0,Pt.A)(i?.id===t?R("DialogTitlePremiumGiftSentTo",{user:(0,l.Yg)(y),amount:e}):R("DialogTitlePremiumGiftReceivedFrom",{user:(0,l.Yg)(i),amount:e}),["simple_markdown","emoji"])}if(r&&i){const e=L("lng_premium_emoji_status_title").replace("{user}",(0,l.Yg)(i)),[t,s]=e.split("{link}"),n=r.thumbCustomEmojiId?(0,se.Y)(ro.A,{className:"Y0jTcadE",documentId:r.thumbCustomEmojiId}):void 0,o=(0,se.FD)("span",{className:"FLzl2ng5",onClick:W,children:[n,(0,Pt.A)(r.title)]});return[(0,Pt.A)(t),o,(0,Pt.A)(s)]}return(0,Pt.A)(i?L("TelegramPremiumUserDialogTitle",(0,l.Yg)(i)):L(h?"TelegramPremiumSubscribedTitle":"TelegramPremium"),["simple_markdown","emoji"])}function ie(){return k&&"starGiftUnique"!==k.type&&k.perUserTotal?R("DescriptionGiftPremiumRequired2",{count:k.perUserTotal},{pluralValue:k.perUserTotal}):C?i?.id===t?L("TelegramPremiumUserGiftedPremiumOutboundDialogSubtitle",(0,l.Yg)(y)):L("TelegramPremiumUserGiftedPremiumDialogSubtitle"):L(r?"TelegramPremiumUserStatusDialogSubtitle":i?"TelegramPremiumUserDialogSubtitle":h?"TelegramPremiumSubscribedSubtitle":"TelegramPremiumSubtitle")}}));var pa=i(80089),va=i(80464);const ga=e=>{const{isOpen:t}=e,i=(0,va.A)(pa.ar.Extra,"CountryPickerModal",!t);return i?(0,se.Y)(i,{...e}):void 0};var Aa=i(1526),fa=i(96530),ba=i(11124),Ca=i(34642);const ya=(0,s.ph)(({isOpen:e,giveawayChatId:t,selectionLimit:i,initialSelectedIds:o,onSelectedIdsConfirmed:a,onClose:r})=>{const{showNotification:c}=(0,n.ko)(),d=(0,B.A)(),[h,m]=(0,s.J0)(void 0),[u,p]=(0,s.J0)(""),[v,g,A]=(0,D.A)(),[f,b]=(0,s.J0)(o);(0,s.vJ)(()=>{b(o)},[o]);const C=(0,s.Kr)(()=>{const e=(0,n.mS)(),i=e.chats.byId,{active:s,archived:o}=e.chats.listIds,a=(s||[]).concat(o||[]);return(0,di.Am)(a).map(e=>i[e]).filter(e=>e&&((0,l.WX)(e)||(0,l.Vs)(e))&&e.id!==t).map(e=>e.id)},[t]),y=(0,s.Kr)(()=>{const e=C?(0,It.PU)({ids:C,query:u,type:"chat"}):[];return(0,Cs.A)(e,!1,f)},[C,u,f]),S=(0,T.A)(e=>{const t=(0,n.mS)().chats.byId,s=e.filter(e=>!f.includes(e)).find(e=>{const i=t[e];return i&&!(0,l.gA)(i)});f?.length>=i?c({message:d("BoostingSelectUpToWarningChannelsPlural",i)}):s?(m(s),g()):b(e)}),N=(0,T.A)(()=>{h&&b((0,di.Am)([...f,h])),A()}),k=(0,T.A)(()=>{a(f),r()});return(0,se.FD)(Ca.A,{isOpen:e,onClose:r,title:d("RequestPeer.ChooseChannelTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Save"),onConfirm:k,onEnter:k,children:[(0,se.Y)(mi.A,{itemIds:y,selectedIds:f,filterValue:u,filterPlaceholder:d("Search"),onSelectedIdsChange:S,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"}),(0,se.Y)(oi.A,{title:d("BoostingGiveawayPrivateChannel"),text:d("BoostingGiveawayPrivateChannelWarning"),confirmLabel:d("Add"),isOpen:v,onClose:A,confirmHandler:N})]})}),Sa=(0,s.ph)(({option:e,checked:t,name:i,text:s,img:n,isLink:o,onChange:a,onClickAction:r,className:l,userNames:c,selectedMemberIds:d})=>{const h=(0,B.A)();let m=h(s);o&&d?.length&&(m=d.length>2?d.length.toString():c);const u=(0,T.A)(t=>{t.target.checked&&a(e)}),p=(0,T.A)(()=>{r?.()});return(0,se.FD)("label",{className:(0,ge.A)("w3OGYFKn",l),dir:h.isRtl?"rtl":void 0,role:"button",tabIndex:0,children:[(0,se.Y)("input",{className:"xy4AclZa",type:"radio",name:"giveaway_option",value:e,checked:t,onChange:u,onClick:e=>e.stopPropagation()}),(0,se.FD)("div",{className:"TTgSI7Xh",children:[(0,se.Y)("img",{className:"lGhZJbMF",src:n,alt:"",draggable:!1}),(0,se.FD)("div",{className:"sEt7TF59",children:[(0,se.Y)("h3",{className:"u4NzVBBi",children:h(i)}),o?(0,se.FD)("div",{className:"y7XfPOoG",onClick:p,children:[(0,se.Y)("span",{children:m}),(0,se.Y)(he.A,{name:"next"})]}):(0,se.Y)("span",{className:"kt2ZKZ6j",children:m})]})]})]})}),Na=(0,s.ph)((0,n.EK)((e,{giveawayChatId:t})=>{const i=t?(0,c.AWZ)(e,t):void 0;return i?{members:i.members,adminMembersById:i.adminMembersById}:{members:void 0,adminMembersById:void 0}})(({isOpen:e,selectionLimit:t,members:i,adminMembersById:o,initialSelectedIds:a,onSelectedIdsConfirmed:r,onClose:c})=>{const{showNotification:d}=(0,n.ko)(),h=(0,B.A)(),[m,u]=(0,s.J0)(""),[p,v]=(0,s.J0)(a);(0,s.vJ)(()=>{v(a)},[a]);const g=(0,s.Kr)(()=>{const e=(0,n.mS)(),{byId:t,statusesById:s}=e.users;if(!i?.length)return[];const a=o&&new Set(Object.keys(o)),r=(0,l.UB)(i.map(({userId:e})=>e),t,s);return a?r.filter(e=>!a.has(e)):r},[o,i]),A=(0,s.Kr)(()=>{const e=(0,n.mS)().users.byId,t=g?(0,It.PU)({ids:g,query:m,type:"user"}):[];return(0,Cs.A)((0,di.Am)(t).filter(t=>{const i=e[t];return!i||!(0,l.tv)(i)}))},[g,m]),f=(0,T.A)(e=>{e.length>t?d({message:h("BoostingSelectUpToWarningUsers",t)}):v(e)}),b=(0,T.A)(()=>{r(p),c()});return(0,se.Y)(Ca.A,{isOpen:e,onClose:c,title:h("BoostingAwardSpecificUsers"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:h("Save"),onConfirm:b,onEnter:b,children:(0,se.Y)(mi.A,{itemIds:A,selectedIds:p,filterValue:m,filterPlaceholder:h("Search"),onSelectedIdsChange:f,onFilterChange:u,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"})})})),ka="rZRDMqUL",wa="JjDLNrKG",Ia="p5Hn4Q6E",Pa="rniPcuiP",Ya="G9H3tm6D",Fa="xKl2UeV8",Da="HLx3wTBD",Ma="Ftr7zf2v",Ta="Ce0Ob2tg",Ba="rDFQAfTt",La="LZ3vPzak",Ra="Z9QJQ6IS",xa="ldn4mh2T";var Ea=i(72078),Va=i(68153),_a=i(65741),Ua=i(45318);const Oa=i.p+"PremiumStar.39c1ff364d35554f4b80.svg",Ka={3:Va,6:Ea,12:_a},Ja=(0,s.ph)((0,n.EK)(e=>{const{giveawayModal:t}=(0,c.nTw)(e),i=t?.chatId,s=i?(0,c.hds)(e,i):void 0,n=s&&(0,l.WX)(s);return{chatId:i,gifts:t?.gifts,selectedMemberList:t?.selectedMemberIds,selectedChannelList:t?.selectedChannelIds,giveawayBoostPerPremiumLimit:e.appConfig.giveawayBoostsPerPremium,isStarsGiftEnabled:e.appConfig.isStarsGiftEnabled,userSelectionLimit:e.appConfig.giveawayAddPeersMax,countrySelectionLimit:e.appConfig.giveawayCountriesMax,countryList:e.countryList.general,prepaidGiveaway:t?.prepaidGiveaway,isChannel:n,starsGiftOptions:t?.starOptions}})(({chatId:e,gifts:t,isOpen:i,isChannel:o,selectedMemberList:r,selectedChannelList:c,giveawayBoostPerPremiumLimit:d=a.CQG,countryList:h,prepaidGiveaway:m,countrySelectionLimit:u=a.y67,userSelectionLimit:p=a.qbC,isStarsGiftEnabled:v,starsGiftOptions:g})=>{const A=(0,s.li)(),{closeGiveawayModal:f,openInvoice:b,openPremiumModal:C,launchPrepaidGiveaway:y,launchPrepaidStarsGiveaway:S}=(0,n.ko)(),N=(0,B.A)(),[k,w,I]=(0,D.A)(),[P,Y,F]=(0,D.A)(),[M,L,R]=(0,D.A)(),[x,E,V]=(0,D.A)(),[_,U,O]=(0,D.A)(),K=[{name:"Premium.Title",text:"BoostingWinnersRandomly",value:"premium_giveaway",img:Ea,actions:"createPremiumGiveaway",isLink:!0,onClickAction:()=>{E()}}];v&&K.push({name:"TelegramStars",text:"BoostingWinnersRandomly",value:"stars_giveaway",img:Ua,actions:"createStarsGiveaway",isLink:!1});const[J,G]=(0,s.J0)(()=>Date.now()+2592e5),[j,z]=(0,s.J0)(!0),[H,$]=(0,s.J0)(5),[q,W]=(0,s.J0)(K[0].value),[Q,Z]=(0,s.J0)(),[ne,oe]=(0,s.J0)("all"),[ae,re]=(0,s.J0)(),[le,ce]=(0,s.J0)([]),[de,me]=(0,s.J0)([]),[ue,pe]=(0,s.J0)([]),[ve,Ae]=(0,s.J0)(!1),[fe,be]=(0,s.J0)(!1),[Ce,ye]=(0,s.J0)(void 0),[Se,Ne]=(0,s.J0)(void 0),[ke,we]=(0,s.J0)(void 0),Ie="premium_giveaway"===q,Pe="stars_giveaway"===q,Ye=Ie&&!le.length?H:le.length,Fe=Ye*d,De=Q?.yearlyBoosts,Me=(0,s.Kr)(()=>[{value:"all",label:N(o?"BoostingAllSubscribers":"BoostingAllMembers"),subLabel:ue&&ue.length>0?N("Giveaway.ReceiverType.Countries",ue.length):N("BoostingFromAllCountries")},{value:"new",label:N(o?"BoostingNewSubscribers":"BoostingNewMembers"),subLabel:ue&&ue.length>0?N("Giveaway.ReceiverType.Countries",ue.length):N("BoostingFromAllCountries")}],[o,N,ue]),Te=N("Months",ae),Be="starsGiveaway"===m?.type,Le="giveaway"===m?.type,Re=(0,s.Kr)(()=>t?.find(e=>e.months===ae&&e.users===Ye),[t,ae,Ye]),xe=(0,s.Kr)(()=>g?.find(e=>Be&&e.stars===ke?.stars),[ke,g,Be]),Ee=(0,s.Kr)(()=>t?.filter(e=>e.users===Ye&&e.currency!==a.OUy),[t,Ye]),Ve=(0,s.Kr)(()=>{const e=Ee?.reduce((e,t)=>t.amount<e.amount?t:e,Ee[0]);return e&&Math.floor(e.amount/e.months)},[Ee]),_e=(0,s.Kr)(()=>(0,di.Am)(t?.filter(e=>e.currency!==a.OUy)?.map(e=>e.users)||[]).sort((e,t)=>e-t),[t]),Ue=(0,s.Kr)(()=>(0,di.Am)(Q?.winners?.map(e=>e.users)||[]).sort((e,t)=>e-t),[Q]);(0,s.vJ)(()=>{i&&t?.length&&!Be&&re(t?.[0].months)},[i,t,Be]),(0,s.vJ)(()=>{i&&g?.length&&!Le&&Z(g?.[0])},[i,g,Le]),(0,s.vJ)(()=>{i&&Be&&($(m.quantity),we(m))},[i,Be,m]),(0,s.vJ)(()=>{i&&Le&&($(m.quantity),Ne(m),re(m.months))},[i,Le,m]),(0,s.vJ)(()=>{r&&ce(r)},[r]),(0,s.vJ)(()=>{c&&me(c)},[c]);const Oe=(0,T.A)(()=>{C()}),Ke=(0,T.A)(()=>{we(void 0),Ne(void 0),Z(void 0),re(void 0),$(5),f()}),Je=(0,T.A)(()=>{b(Ie?le?.length?{type:"giftcode",boostChannelId:e,userIds:le,currency:Re.currency,amount:Re.amount,option:Re}:{type:"giveaway",chatId:e,additionalChannelIds:de,isOnlyForNewSubscribers:"new"===ne,countries:ue,areWinnersVisible:ve,prizeDescription:Ce,untilDate:J/1e3,currency:Re.currency,amount:Re.amount,option:Re}:{type:"starsgiveaway",chatId:e,additionalChannelIds:de,isOnlyForNewSubscribers:"new"===ne,countries:ue,areWinnersVisible:ve,prizeDescription:Ce,untilDate:J/1e3,currency:Q.currency,amount:Q.amount,stars:Q.stars,users:H}),Ke()}),Ge=(0,T.A)(()=>{Be?S({chatId:e,giveawayId:ke.id,paymentPurpose:{additionalChannelIds:de,countries:ue,prizeDescription:Ce,areWinnersVisible:ve,untilDate:J/1e3,stars:ke.stars,currency:xe.currency,amount:xe.amount,users:ke.quantity}}):y({chatId:e,giveawayId:Se.id,paymentPurpose:{additionalChannelIds:de,countries:ue,prizeDescription:Ce,areWinnersVisible:ve,untilDate:J/1e3,currency:Re.currency,amount:Re.amount}}),R(),Ke()}),je=(0,T.A)(e=>{$(e)}),ze=(0,T.A)(e=>{$(e)}),He=(0,T.A)(e=>{ye(e.target.value)}),$e=(0,s.Kr)(()=>{const e=(0,n.mS)().users.byId;return le?.map(t=>(0,l.Yg)(e[t])).join(", ")},[le]),qe=(0,T.A)(e=>{oe(e)}),Qe=(0,T.A)(e=>{W(e),ce([]),$(5)}),Ze=(0,T.A)(e=>{G(e.getTime()),I()}),Xe=(0,T.A)(e=>{pe(e)}),et=(0,T.A)(e=>{ce(e),e.length||W("premium_giveaway")}),tt=(0,T.A)(e=>{me(e)}),it=(0,T.A)(e=>{Ae(e.target.checked)}),st=(0,T.A)(e=>{be(e.target.checked)}),nt=(0,T.A)(()=>{Y()}),ot=(0,T.A)(e=>{Z(e)});function at(){return(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:ka,children:[(0,se.Y)("h2",{className:Ia,children:N("BoostingChannelsGroupsIncludedGiveaway")}),(0,se.Y)(li.A,{inactive:!0,className:"chat-item-clickable contact-list-item",children:(0,se.Y)(hs.A,{chatId:e,status:N(o?"BoostingChannelWillReceiveBoost":"BoostingGroupWillReceiveBoost",Fe||De,"i")})}),de?.map(e=>(0,se.Y)(li.A,{ripple:!0,className:"chat-item-clickable contact-list-item",onClick:()=>function(e){const t=de.filter(t=>t!==e);me(t)}(e),rightElement:(0,se.Y)(he.A,{name:"close",className:"UZdErfVI"}),children:(0,se.Y)(hs.A,{chatId:e.toString()})},e)),de.length<9&&(0,se.Y)(li.A,{icon:"add",ripple:!0,onClick:U,className:"sOXvh85b",iconClassName:"aGbyR60s",children:N("BoostingAddChannelOrGroup")})]}),(0,se.FD)("div",{className:ka,children:[(0,se.Y)("h2",{className:Ia,children:N("BoostingEligibleUsers")}),(0,se.Y)("div",{className:wa,children:(0,se.Y)(ie.A,{name:"subscribers",options:Me,selected:ne,onChange:qe,onClickAction:nt,subLabelClassName:"txXJxVFu",isLink:!0})})]}),(0,se.Y)("div",{className:Pa,children:(0,Pt.A)(N(o?"BoostGift.LimitSubscribersInfo":"lng_giveaway_users_about_group"))}),(0,se.FD)("div",{className:ka,children:[(0,se.FD)("div",{className:Ra,children:[(0,se.Y)("h2",{className:La,children:N("BoostingGiveawayAdditionalPrizes")}),(0,se.Y)(ci.A,{label:N("BoostingGiveawayAdditionalPrizes"),checked:fe,onChange:st})]}),fe&&(0,se.FD)("div",{className:"eQVP0Nx8",children:[(0,se.Y)("h2",{className:La,children:H}),(0,se.Y)(ee.A,{className:"qMYNwiUZ",value:Ce,onChange:He,label:N("BoostingGiveawayEnterYourPrize")})]})]}),fe?Pe||Be?void 0:(0,se.Y)("div",{className:Pa,children:Ce?.length?(0,Pt.A)(N("BoostingGiveawayAdditionPrizeCountNameHint",Se?[Se.quantity,Ce,Te]:[Ye,Ce,Te],void 0,ae),["simple_markdown"]):(0,Pt.A)(N("BoostingGiveawayAdditionPrizeCountHint",Se?[Se.quantity,Te]:[Ye,Te],void 0,ae),["simple_markdown"])}):(0,se.Y)("div",{className:Pa,children:(0,Pt.A)(N("BoostingGiveawayAdditionPrizeHint"))}),(0,se.Y)("div",{className:ka,children:(0,se.FD)("div",{className:Ra,children:[(0,se.Y)("h2",{className:La,children:N("BoostingGiveawayShowWinners")}),(0,se.Y)(ci.A,{label:N("BoostingGiveawayAdditionalPrizes"),checked:ve,onChange:it})]})}),(0,se.Y)("div",{className:Pa,children:(0,Pt.A)(N("BoostingGiveawayShowWinnersHint"))}),(0,se.FD)("div",{className:(0,ge.A)(ka,(Se||ke||Pe)&&Ba),children:[(0,se.Y)("h2",{className:Ia,children:N("BoostingDateWhenGiveawayEnds")}),(0,se.FD)(X.A,{ariaLabel:N("BoostGift.DateEnds"),className:(0,ge.A)("GeKqKRgP","expire-limit"),isText:!0,onClick:w,children:[(0,se.Y)("h3",{className:La,children:N("BoostGift.DateEnds")}),(0,We.L2)(J,N.code)]})]})]})}return(0,se.FD)(te.A,{className:"P0kLOw15",onClose:Ke,isOpen:i,dialogRef:A,onEnter:Se||ke?L:Je,hasAbsoluteCloseButton:!0,children:[(0,se.FD)("div",{className:(0,ge.A)("SqiN63Ef","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;z(t<=150)},children:[(0,se.Y)("img",{className:"Me2hCsMs",src:Oa,alt:"",draggable:!1}),(0,se.Y)("h2",{className:"UVDnB0Wq",children:(0,Pt.A)(N("BoostingBoostsViaGifts"))}),(0,se.Y)("div",{className:"v5yGzV6v",children:(0,Pt.A)(N(o?"BoostingGetMoreBoost":"BoostingGetMoreBoostsGroup"))}),(0,se.Y)("div",{className:(0,ge.A)("U6XNIToQ",j&&"tDZc21ZC"),children:(0,se.Y)("h2",{className:"v6hiGpEn",children:N("BoostingBoostsViaGifts")})}),Se||ke?(0,se.FD)("div",{className:"q1y2qUTn",children:[(0,se.Y)("div",{children:ke?(0,se.Y)("img",{className:xa,src:Ua,alt:""}):(0,se.Y)("img",{className:xa,src:Ka[Se.months]||Ka[3],alt:""})}),(0,se.FD)("div",{className:"IsT38nlq",children:[(0,se.Y)("h3",{className:La,children:ke?N("Giveaway.Stars.Prepaid.Title",ke?.stars):N("BoostingTelegramPremiumCountPlural",Se.quantity)}),(0,se.Y)("p",{className:"TsGuei3B",children:ke?N("Giveaway.Stars.Prepaid.Desc",ke?.quantity):N("PrepaidGiveawayMonths",Se?.months)})]}),(0,se.Y)("div",{className:Ya,children:(0,se.FD)("div",{className:(0,ge.A)(Fa,Da),children:[(0,se.Y)(he.A,{name:"boost",className:Ma}),(0,se.Y)("div",{className:Ta,dir:N.isRtl?"rtl":void 0,children:ke?ke?.boosts:Se.quantity*(d??a.CQG)})]})})]}):(0,se.Y)("div",{className:(0,ge.A)(ka,"sQ5PkKEs"),children:(0,se.Y)("div",{className:wa,children:K.map(e=>(0,se.Y)(Sa,{name:e.name,text:e.text,option:e.value,img:e.img,onChange:Qe,checked:q===e.value,isLink:e.isLink,userNames:$e,selectedMemberIds:le,onClickAction:e.onClickAction},e.name))})}),Ie&&!le?.length&&(0,se.FD)(se.FK,{children:[!Se&&!ke&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:ka,children:[(0,se.FD)("div",{className:Ya,children:[(0,se.Y)("h2",{className:Ia,children:N("BoostingQuantityPrizes")}),(0,se.FD)("div",{className:(0,ge.A)(Fa,Da),children:[(0,se.Y)(he.A,{name:"boost",className:Ma}),(0,se.Y)("div",{className:Ta,dir:N.isRtl?"rtl":void 0,children:Fe})]})]}),(0,se.Y)(ba.A,{rangeCount:Ye,marks:_e,onChange:je})]}),(0,se.Y)("div",{className:Pa,children:(0,Pt.A)(N("BoostingChooseHowMany"))})]}),at()]}),Pe&&(0,se.FD)(se.FK,{children:[!ke&&!Se&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:ka,children:[(0,se.FD)("div",{className:Ya,children:[(0,se.Y)("h2",{className:Ia,children:N("BoostingStarsOptions")}),(0,se.FD)("div",{className:(0,ge.A)(Fa,Da),children:[(0,se.Y)(he.A,{name:"boost",className:Ma}),(0,se.Y)("div",{className:Ta,dir:N.isRtl?"rtl":void 0,children:De})]})]}),(0,se.Y)(Aa.A,{className:"cLhNkYPB",options:g,selectedStarCount:H,selectedStarOption:Q,onClick:ot})]}),(0,se.Y)("div",{className:(0,ge.A)(Pa,"bzRAETfR"),children:(0,Pt.A)(N("BoostGift.Stars.Info"))}),(0,se.FD)("div",{className:ka,children:[(0,se.Y)("h2",{className:Ia,children:N("BoostingStarsQuantityPrizes")}),(0,se.Y)(ba.A,{rangeCount:H,marks:Ue,onChange:ze}),(0,se.Y)("div",{className:Pa,children:(0,Pt.A)(N("BoostingStarsQuantityPrizesInfo"))})]})]}),at()]}),!Se&&!ke&&Ie&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:ka,children:[(0,se.Y)("h2",{className:Ia,children:N("BoostingDurationOfPremium")}),(0,se.Y)("div",{className:wa,children:Ee?.map(e=>(0,se.Y)(zo,{isGiveaway:!0,option:e,fullMonthlyAmount:Ve,checked:e.months===ae,onChange:re},e.months))})]}),(0,se.Y)("div",{className:(0,ge.A)(Pa,Ba),children:function(){const e=N("GiftPremiumListFeaturesAndTerms").match(/([^*]*)\*([^*]+)\*(.*)/);if(e&&!(e.length<4))return(0,se.FD)("p",{className:"eNQ_nrKr",children:[e[1],(0,se.Y)(fa.A,{isPrimary:!0,onClick:Oe,children:e[2]}),e[3]]})}()})]}),q&&(0,se.Y)("div",{className:"hD_AEzjd",children:(0,se.Y)(X.A,{className:"ILuhBsJG",onClick:Se||ke?L:Je,children:N("BoostingStartGiveaway")})})]}),(0,se.Y)(sn,{isOpen:k,isFutureMode:!0,withTimePicker:!0,onClose:I,onSubmit:Ze,selectedAt:J,submitButtonLabel:N("Save")}),(0,se.Y)(ga,{isOpen:P,onClose:F,countryList:h,onSubmit:Xe,selectionLimit:u}),(0,se.Y)(Na,{isOpen:x,onClose:V,onSelectedIdsConfirmed:et,initialSelectedIds:le,selectionLimit:p,giveawayChatId:e}),(0,se.Y)(ya,{isOpen:_,onClose:O,initialSelectedIds:de,onSelectedIdsConfirmed:tt,selectionLimit:a.cgU,giveawayChatId:e}),(0,se.Y)(oi.A,{title:N("BoostingStartGiveawayConfirmTitle"),text:N("BoostingStartGiveawayConfirmText"),confirmLabel:N("Start"),isOpen:M,onClose:R,confirmHandler:Ge})]})})),Ga={dialogFiltersChats:"LimitReachedChatInFolders",uploadMaxFileparts:"LimitReachedFileSize",dialogFilters:"LimitReachedFolders",dialogFolderPinned:"LimitReachedPinDialogs",channelsPublic:"LimitReachedPublicLinks",channels:"LimitReachedCommunities",chatlistInvites:"LimitReachedFolderLinks",chatlistJoined:"LimitReachedSharedFolders",savedDialogsPinned:"LimitReachedPinSavedDialogs"},ja={dialogFiltersChats:"LimitReachedChatInFoldersLocked",uploadMaxFileparts:"LimitReachedFileSizeLocked",dialogFilters:"LimitReachedFoldersLocked",dialogFolderPinned:"LimitReachedPinDialogsLocked",channelsPublic:"LimitReachedPublicLinksLocked",channels:"LimitReachedCommunitiesLocked",chatlistInvites:"LimitReachedFolderLinksLocked",chatlistJoined:"LimitReachedSharedFoldersLocked",savedDialogsPinned:"LimitReachedPinSavedDialogsLocked"},za={dialogFiltersChats:"LimitReachedChatInFoldersPremium",uploadMaxFileparts:"LimitReachedFileSizePremium",dialogFilters:"LimitReachedFoldersPremium",dialogFolderPinned:"LimitReachedPinDialogsPremium",channelsPublic:"LimitReachedPublicLinksPremium",channels:"LimitReachedCommunitiesPremium",chatlistInvites:"LimitReachedFolderLinksPremium",chatlistJoined:"LimitReachedSharedFoldersPremium",savedDialogsPinned:"LimitReachedPinSavedDialogsPremium"},Ha={dialogFiltersChats:"chat-badge",uploadMaxFileparts:"file-badge",dialogFilters:"folder-badge",dialogFolderPinned:"pin-badge",channelsPublic:"link-badge",channels:"chats-badge",chatlistInvites:"link-badge",chatlistJoined:"folder-badge",savedDialogsPinned:"pin-badge"},$a={uploadMaxFileparts:(e,t)=>8e3===t?e("MediaSizeGB",{size:4},{pluralValue:4}):4e3===t?e("MediaSizeGB",{size:2},{pluralValue:2}):(0,bn.v7)(e,t*a.dK5)},qa=(0,s.ph)((0,n.EK)((e,{limit:t})=>{const{limits:i}=e.appConfig,s=(0,c.g29)(e);return{defaultValue:t?i?.[t][0]:void 0,premiumValue:t?i?.[t][1]:void 0,canBuyPremium:!(0,c.n_C)(e),isPremium:s}})(({defaultValue:e,premiumValue:t,limit:i,isPremium:o,canBuyPremium:a})=>{const{closeLimitReachedModal:r,openPremiumModal:l}=(0,n.ko)(),c=(0,Fi.A)(),d=(0,B.A)(),[h,m,u]=(0,D.A)(),p=(0,s.hb)(()=>{l(),m()},[l,m]);(0,s.vJ)(()=>{!i&&h&&u()},[h,i,u]);const v=c("LimitReached"),g=i&&$a[i],A=function({lang:e,oldLang:t,limitType:i,isPremium:s,canBuyPremium:n,defaultValue:o,premiumValue:a,valueFormatter:r}){if(!i)return;const l=r?r(e,o):o,c=r?r(e,a):a;return s?t(za[i],c):n?t(Ga[i],"channelsPublic"===i?c:[l,c]):t(ja[i],l)}({lang:c,oldLang:d,limitType:i,isPremium:o,canBuyPremium:a,defaultValue:e,premiumValue:t,valueFormatter:g}),f=i&&Ha[i],b=a&&!o;return(0,se.FD)(te.A,{onClose:m,onCloseAnimationEnd:r,isOpen:Boolean(i)&&!h,title:v,className:"QAs_iFxO",children:[!b&&(0,se.FD)("div",{className:"Q5d_7bB4",children:[(0,se.Y)("i",{className:(0,ge.A)("rbnU7JVX",f,"icon")}),(0,se.Y)("div",{className:"ArEy3hhB",children:g?.(c,o?t:e)||(o?t:e)})]}),b&&(0,se.Y)(fo,{className:"k0O6Rnjh",leftValue:g?.(c,e)||e?.toString(),rightValue:g?.(c,t)||t?.toString(),floatingBadgeIcon:f}),(0,se.Y)("div",{children:(0,Pt.A)(A||"",["simple_markdown","br"])}),(0,se.FD)("div",{className:"RVM_RSap",children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:m,color:"primary",children:c(b?"Cancel":"OK")}),b&&(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:p,color:"primary",iconName:"double-badge",iconClassName:"esB1OhAF",iconAlignment:"end",children:c("IncreaseLimit")})]})]})}));var Wa=i(93809),Qa=i(81954),Za=i(5912);const Xa=350+a.xB5,er=.5*g.$;function tr(e,t,i,n){const o=(0,s.li)([]),[a,r]=(0,s.J0)(0),{observe:l,freeze:c,unfreeze:d}=(0,Za.BL)({rootRef:e},e=>{const t=o.current;e.forEach(e=>{const s=Number(e.target.id.replace(`${i}-`,""));t[s]=e.isIntersecting});const s=t.reduce((e,t,i)=>t&&i<e?i:e,1/0);s!==1/0&&r(s)}),{observe:h,freeze:m,unfreeze:u}=(0,Za.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:p}=(0,Za.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:v}=(0,Za.BL)({rootRef:t});return(0,$.A)(()=>{n?(c(),m()):setTimeout(()=>{u(),d()},Xa)},[c,m,n,d,u]),{activeSetIndex:a,observeIntersectionForSet:l,observeIntersectionForShowingItems:h,observeIntersectionForPlayingItems:p,observeIntersectionForCovers:v,selectStickerSet:(0,T.A)(t=>{r(s=>{const n=document.getElementById(`${i}-${t}`),o=1===Math.abs(s-t);return(0,Qa.Ay)({container:e.current,element:n,position:"start",margin:er,maxDistance:o?200:80}),t})})}}var ir=i(37479),sr=i(87094),nr=i(94519),or=i(45294);const ar=(0,s.ph)(({stickerSet:e,size:t=a.TBj,noPlay:i,forcePlayback:o,observeIntersection:r,sharedCanvasRef:d})=>{const{loadStickers:h}=(0,n.ko)(),u=(0,s.li)(),{hasThumbnail:p,hasVideoThumb:v,hasAnimatedThumb:g,hasStaticThumb:A,thumbCustomEmojiId:f}=e,{customEmoji:b}=(0,or.A)(f),C=b?.shouldUseTextColor,y=(0,sr.A)(u,void 0,!C),S=(0,ir.A)(y),N=(0,Za.Vz)(u,r),k=N&&!i,w=!p||v&&!m.OF&&!g&&!A,I=w&&e.stickers?.[0]&&(0,l.Mw)(e.stickers[0],"preview"),P=(0,q.A)(I,!N),Y=(p&&!I||g)&&`stickerSet${e.id}`,F=(0,q.A)(Y,!N),D=f||F||P,M=(0,Mi.A)(D),T=(0,nr.A)(u,d);return(0,s.vJ)(()=>{N&&!e.stickers?.length&&h({stickerSetInfo:e})},[N,h,e]),(0,se.Y)("div",{ref:u,className:(0,ge.A)("m6XpTzQX","sticker-set-cover"),style:`--_size: ${t}px`,children:D?f?(0,se.Y)(ro.A,{documentId:f,size:t,observeIntersectionForPlaying:r,noPlay:i}):g?(0,se.Y)(No.A,{className:M,tgsUrl:F,size:t,play:k,isLowPriority:!(0,c.CzR)((0,n.mS)(),e),sharedCanvas:d?.current||void 0,sharedCanvasCoords:T,forceAlways:o}):v&&!w?(0,se.Y)(xi.A,{className:(0,ge.A)("OZHqKbDL",M),src:F,canPlay:k,style:S,isPriority:o,loop:!0,disablePictureInPicture:!0}):(0,se.Y)("img",{src:F||P,style:S,className:(0,ge.A)("enA6c8gc",M),alt:"",draggable:!1}):(0,bn.Qh)(e.title,2)})});var rr=i(54464),lr=i(82855);const cr=[{title:"SetTimeoutFor.Hours",value:1,arg:3600},{title:"SetTimeoutFor.Hours",value:2,arg:7200},{title:"SetTimeoutFor.Hours",value:8,arg:28800},{title:"SetTimeoutFor.Days",value:1,arg:86400},{title:"SetTimeoutFor.Days",value:2,arg:172800}],dr=(0,s.ph)(({sticker:e,size:t,noPlay:i,title:o,className:a,noContextMenu:r,isSavedMessages:l,isStatusPicker:c,canViewSet:d,isSelected:h,isCurrentUserPremium:u,shouldIgnorePremium:p,noShowPremium:v,sharedCanvasRef:g,withTranslucentThumb:A,forcePlayback:f,isEffectEmoji:b,noIcons:C,clickArg:y,onClick:S,observeIntersection:N,observeIntersectionForShowing:k,onFaveClick:w,onUnfaveClick:I,onRemoveRecentClick:P,onDismiss:Y})=>{const{openStickerSet:F,openPremiumModal:D,setEmojiStatus:M}=(0,n.ko)(),L=(0,s.li)(),R=(0,s.li)(),x=(0,B.A)(),E=e.shouldUseTextColor,V=(0,sr.A)(L,void 0,!E),{id:_,stickerSetInfo:U}=e,O=!e.isFree||e.hasEffect,K=e.isCustomEmoji||b,J=!K&&O,G=!u&&O&&!p,j=(0,Za.Vz)(L,N),z=j,H=j&&!i,$=(0,Za.Vz)(L,k),{isContextMenuOpen:q,contextMenuAnchor:W,handleBeforeContextMenu:Q,handleContextMenu:Z,handleContextMenuClose:ee,handleContextMenuHide:te}=(0,Ws.A)(L),ie=Boolean(!r&&W),ne=(0,T.A)(()=>L.current),oe=(0,T.A)(()=>L.current.closest(".custom-scroll, .no-scrollbar")),ae=(0,T.A)(()=>c?R.current:L.current.querySelector(".sticker-context-menu .bubble")),re=(0,T.A)(()=>({withPortal:c,shouldAvoidNegativePosition:!0}));(0,s.vJ)(()=>{j||ee()},[ee,j]);const le=(0,T.A)(t=>{t.stopPropagation(),t.preventDefault(),P(e)}),ce=(0,T.A)(()=>{P(e)}),de=(0,T.A)(()=>{I(e)}),me=(0,T.A)(()=>{w(e)}),pe=(0,T.A)(()=>{S?.(y,!0)}),ve=(0,T.A)(()=>{S?.(y,void 0,!0)}),Ae=(0,T.A)(()=>{F({stickerSetInfo:U})}),fe=(0,T.A)((t,i=0)=>{t.preventDefault(),t.stopPropagation(),ee(),Y?.(),M({emojiStatus:{type:"regular",documentId:e.id,until:(0,Ii.Fm)()+i}})}),be=!m.TF&&P,Ce=(0,ge.A)("StickerButton",S&&"interactive",h&&"selected",K&&"custom-emoji",b&&"effect-emoji",a),ye=(0,s.Kr)(()=>{if(!ie||r||K&&!c)return[];const e=[];return K?(cr.forEach(t=>{e.push((0,se.Y)(ue.A,{onClick:fe,clickArg:t.arg,children:x(t.title,t.value,"i")}))}),e):(I&&e.push((0,se.Y)(ue.A,{icon:"favorite",onClick:de,children:x("Stickers.RemoveFromFavorites")})),w&&e.push((0,se.Y)(ue.A,{icon:"favorite",onClick:me,children:x("Stickers.AddToFavorites")})),!G&&S&&(l||e.push((0,se.Y)(ue.A,{onClick:pe,icon:"muted",children:x("SendWithoutSound")})),e.push((0,se.Y)(ue.A,{onClick:ve,icon:"calendar",children:x(l?"SetReminder":"ScheduleMessage")}))),d&&e.push((0,se.Y)(ue.A,{onClick:Ae,icon:"stickers",children:x("ViewPackPreview")})),P&&e.push((0,se.Y)(ue.A,{icon:"delete",onClick:ce,children:x("DeleteFromRecent")})),e)},[ie,r,K,c,I,w,G,S,d,P,fe,x,de,me,l,ve,pe,Ae,ce]);return(0,se.FD)("div",{ref:L,className:Ce,title:o||e?.emoji,"data-sticker-id":_,onMouseDown:e=>{(0,rr.u)(e),Q(e)},onClick:()=>{if(!q)return G?(D(b?{initialSection:"effects"}:K?{initialSection:"animated_emoji"}:{initialSection:"premium_stickers"}),void Y?.()):void S?.(y)},onContextMenu:Z,children:[$&&(0,se.Y)(lr.A,{containerRef:L,sticker:e,isSmall:!0,size:t,shouldLoop:!0,shouldPreloadPreview:!0,noLoad:!z,noPlay:!H,noVideoOnMobile:!0,withSharedAnimation:!0,sharedCanvasRef:g,withTranslucentThumb:A,customColor:V,forceAlways:f}),!C&&!v&&G&&(0,se.Y)("div",{className:"sticker-locked",children:(0,se.Y)(he.A,{name:"lock-badge"})}),!C&&!v&&J&&!G&&(0,se.Y)("div",{className:"sticker-premium",children:(0,se.Y)(he.A,{name:"star"})}),be&&(0,se.Y)(X.A,{className:"sticker-remove-button",color:"dark",round:!0,noFastClick:!0,onClick:le,iconName:"close"}),Boolean(ye.length)&&(0,se.Y)(Ze.A,{ref:R,isOpen:q,anchor:W,getTriggerElement:ne,getRootElement:oe,getMenuElement:ae,getLayout:re,className:"sticker-context-menu",autoClose:!0,withPortal:c,onClose:ee,onCloseAnimationEnd:te,children:ye})]})});var hr=i(93545),mr=i(95773),ur=i(36175),pr=i(64489);const vr=(0,s.ph)(({reaction:e,availableReactions:t,isSelected:i,loadAndPlay:n,observeIntersection:o,sharedCanvasRef:r,sharedCanvasHqRef:c,forcePlayback:d,onClick:h,onContextMenu:m})=>{const u=(0,s.li)(),p="custom"===e.type,v=(0,s.Kr)(()=>t?.find(t=>(0,l.a0)(t.reaction,e)),[t,e]),g=v?.staticIcon?.thumbnail?.dataUri,A=v?.selectAnimation?.id,f=(0,nr.A)(u,r),b=(0,q.A)(v?.selectAnimation?(0,l.mr)(v.selectAnimation,"full"):void 0,!A),{isContextMenuOpen:C,handleBeforeContextMenu:y,handleContextMenu:S,handleContextMenuClose:N,handleContextMenuHide:k}=(0,Ws.A)(u,"paid"!==e.type,void 0,void 0,void 0,!0);(0,s.vJ)(()=>{C&&(m?.(e),N(),k())},[N,m,k,C,e]);const w="paid"===e.type?ur.w.StarReaction:b,I=(0,T.A)(()=>{h(e)}),P=(0,Mi.A)(b),Y=(0,ge.A)("AVrrYEbM",i&&"QkdO_lz1",!p&&"sticker-reaction");return(0,se.Y)("div",{ref:u,className:Y,onClick:I,title:v?.title,"data-sticker-id":p?e.documentId:void 0,onMouseDown:y,onContextMenu:S,children:p?(0,se.Y)(ro.A,{ref:u,documentId:e.documentId,size:a.g0Q,noPlay:!n,observeIntersectionForPlaying:o,sharedCanvasRef:r,sharedCanvasHqRef:c,withTranslucentThumb:!0,forceAlways:d}):(0,se.Y)(pr.A,{tgsUrl:w,thumbDataUri:g,play:n,noLoop:!1,size:a.g0Q,isLowPriority:!0,className:P,sharedCanvas:r.current||void 0,sharedCanvasCoords:f,forceAlways:d})})});var gr=i(38027);const Ar=(0,s.ph)((0,n.EK)(e=>{const t=e.collectibleEmojiStatuses?.statuses;return{collectibleStatuses:t}})(({stickerSet:e,loadAndPlay:t,index:i,idPrefix:o,isNearActive:r,favoriteStickers:d,availableReactions:h,isSavedMessages:m,isStatusPicker:u,isReactionPicker:p,isCurrentUserPremium:v,shouldHideHeader:g,withDefaultTopicIcon:A,selectedReactionIds:f,withDefaultStatusIcon:b,isChatEmojiSet:C,isChatStickerSet:y,isTranslucent:S,noContextMenus:N,forcePlayback:k,collectibleStatuses:w,observeIntersection:I,observeIntersectionForPlayingItems:P,observeIntersectionForShowingItems:F,onReactionSelect:M,onReactionContext:L,onStickerSelect:R,onStickerUnfave:x,onStickerFave:E,onStickerRemoveRecent:V,onDismiss:_})=>{const{clearRecentStickers:U,clearRecentCustomEmoji:O,clearRecentReactions:K,openPremiumModal:J,toggleStickerSet:G,loadStickers:j}=(0,n.ko)(),z=(0,s.li)(),H=(0,s.li)(),$=(0,s.li)(),q=(0,B.A)(),{width:W}=(0,Pe.A)(),[Q,Z,ee]=(0,D.A)(),{isMobile:te}=(0,Y.Ay)(),[ie,ne]=(0,s.J0)(()=>fr(W)),oe=(0,Za.Vz)(z,I??F),ae=(0,Mi.A)(oe),re=r||oe,le=te?8:4,ce=te?8:10,de=te?8:4,me=e.id===a.sR2,ue=e.id===a.j1l,pe=e.id===a.tRH,ve=e.id===a.EPW,Ae=e.isEmoji,fe=!me&&(0,c.Q31)(e),be=(0,T.A)(()=>{p?K():Ae?O():U(),ee()}),Ce=(0,T.A)(()=>{fe&&!v?J({initialSection:"animated_emoji"}):G({stickerSetId:e.id})}),ye=(0,T.A)(()=>{R?.({mediaType:"sticker",id:a.MyF,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})}),Se=(0,T.A)(()=>{R?.({mediaType:"sticker",id:a.zNY,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})}),Ne=Ae?a.g0Q:a.bkT,ke=Ae?ce:le,we=Ae?de:le,Ie=(0,T.A)(e=>e?Math.floor((e+ke)/(Ne+ke)):fr(W)),Ye=(0,T.A)(e=>{ne(Ie(e.contentRect.width))});(0,hr.A)(z,Ye),(0,s.vJ)(()=>{z.current&&ne(Ie(z.current.clientWidth))},[Ie]),(0,s.vJ)(()=>{re&&!e.stickers?.length&&!e.reactions?.length&&e.accessHash&&j({stickerSetInfo:{id:e.id,accessHash:e.accessHash}})},[re,j,e]);const Fe=!m&&!v&&fe&&!C,De=e.installedDate&&!e.isArchived,Me=!De&&e.id!==a.sR2&&e.id!==a.EPW&&e.id!==a.hfH&&e.id!==a.Kp3&&!C&&!y,[Te,,Be]=(0,D.A)(Me),Le=3*ie-1,Re=A||b?e.count+1:e.count,xe=Ne+we,Ee=Math.ceil(Math.min(Le,Re)/ie)*xe-we,Ve=Te?Ee:Math.ceil(Re/ie)*xe-we,_e=(0,s.Kr)(()=>d?new Set(d.map(({id:e})=>e)):void 0,[d]),Ue=(0,s.Kr)(()=>w?new Set(w.map(({documentId:e})=>e)):void 0,[w]),Oe=!g&&!me&&!ue&&Ae&&!ve&&!C&&(!De||!v&&!m),Ke=(0,s.Kr)(()=>q(Fe?De?"lng_emoji_premium_restore":"Unlock":"Add"),[Fe,q,De]);return(0,se.FD)("div",{ref:z,id:`${o}-${i}`,className:(0,ge.A)("symbol-set",Fe&&"symbol-set-locked"),children:[!g&&(0,se.FD)("div",{className:"symbol-set-header",children:[(0,se.FD)("p",{className:(0,ge.A)("symbol-set-title",Oe&&"symbol-set-title-external"),children:[Fe&&(0,se.Y)(he.A,{name:"lock-badge",className:"symbol-set-locked-icon"}),(0,se.Y)("span",{className:"symbol-set-name",children:e.title}),(C||y)&&(0,se.Y)("span",{className:"symbol-set-chat",children:q(C?"GroupEmoji":"GroupStickers")}),Oe&&Boolean(e.stickers)&&(0,se.Y)("span",{className:"symbol-set-amount",children:q(Ae?"EmojiCount":"Stickers",e.stickers.length,"i")})]}),me&&(0,se.Y)(he.A,{className:"symbol-set-remove",name:"close",onClick:Z}),Oe&&(0,se.Y)(X.A,{className:"symbol-set-add-button",withPremiumGradient:fe&&!v,onClick:Ce,pill:!0,size:"tiny",fluid:!0,children:Ke})]}),(0,se.FD)("div",{className:(0,ge.A)("symbol-set-container shared-canvas-container",ae,e.id===a.hfH&&"effect-emojis"),style:`height: ${Ve}px;`,children:[(0,se.Y)("canvas",{ref:H,className:"shared-canvas",style:Me?`height: ${Ee}px;`:void 0}),(me||pe||Me)&&(0,se.Y)("canvas",{ref:$,className:"shared-canvas"}),A&&(0,se.Y)(X.A,{className:"StickerButton custom-emoji",color:"translucent",onClick:ye,children:(0,se.Y)("img",{src:gr,alt:"Reset",className:"sticker-media",draggable:!1})},"default-topic-icon"),b&&(0,se.Y)(X.A,{className:"StickerButton custom-emoji status-default",color:"translucent",onClick:Se,iconName:"star"},"default-status-icon"),re&&e.reactions?.map(i=>{const s=(0,l.Jj)(i),n=s?f?.includes(s):void 0;return(0,se.Y)(vr,{reaction:i,isSelected:n,loadAndPlay:t,availableReactions:h,observeIntersection:P,onClick:M,onContextMenu:L,sharedCanvasRef:H,sharedCanvasHqRef:$,forcePlayback:k},`${e.id}_${s}`)}),re&&e.stickers?.slice(0,Te?Le:e.stickers.length).map((i,s)=>{const o=(me||pe)&&(0,c.CzR)((0,n.mS)(),i.stickerSetInfo),r=Me&&s>=Le||o?$:H,l=i.isCustomEmoji?i.id:i.emoji,d=l?f?.includes(l):void 0,h=e.id===a.j1l||Ue?.has(i.id),p=(0,se.Y)(dr,{sticker:i,size:Ne,observeIntersection:P,observeIntersectionForShowing:F,noPlay:!t,isSavedMessages:m,isStatusPicker:u,canViewSet:!0,noContextMenu:N,isCurrentUserPremium:v,shouldIgnorePremium:C,sharedCanvasRef:r,withTranslucentThumb:S,onClick:R,clickArg:i,noIcons:Ae&&!me,isSelected:d,onUnfaveClick:pe&&_e?.has(i.id)?x:void 0,onFaveClick:_e?.has(i.id)?void 0:E,onRemoveRecentClick:me?V:void 0,onDismiss:_,forcePlayback:k,isEffectEmoji:e.id===a.hfH,noShowPremium:v&&(e.id===a.Kp3||e.id===a.hfH)},i.id);return h?(0,se.Y)(mr.A,{className:"gift-effect-wrapper",withSparkles:!0,children:p}):p}),Te&&Re>Le&&(0,se.FD)(X.A,{className:"StickerButton custom-emoji set-expand",round:!0,color:"translucent",onClick:Be,children:["+",Re-Le]},"more")]}),me&&(0,se.Y)(oi.A,{text:q(p?"ClearRecentReactionsAlertMessage":"ClearRecentStickersAlertMessage"),isOpen:Q,onClose:ee,confirmHandler:be,confirmIsDestructive:!0})]},e.id)}));function fr(e){return e>440?8:e<362?6:7}const br="p7c8y0LH",Cr="zTGriBHY",yr="Qn3lBUNs",Sr="HMspKpNp",Nr="YKO0Obwy",kr="BZfaP1GD",wr=2.5*g.$,Ir=new Set([a.sR2,a.tRH,a.EPW]),Pr=new Set([a.sR2,a.tRH,a.EPW]),Yr=(0,s.ph)((0,n.EK)((e,{chatId:t,isStatusPicker:i,isReactionPicker:s})=>{const{stickers:{setsById:n},customEmojis:{byId:o,featuredIds:a,statusRecent:{emojis:r}},recentCustomEmojis:l,reactions:{availableReactions:d,recentReactions:h,topReactions:m,defaultTags:u}}=e,p=Boolean(t&&(0,c.nZ4)(e,t)),v=t?(0,c.AWZ)(e,t):void 0,g=e.collectibleEmojiStatuses?.statuses;return{customEmojisById:o,recentCustomEmojiIds:i?void 0:l,recentStatusEmojis:i?r:void 0,collectibleStatuses:i?g:void 0,stickerSetsById:n,addedCustomEmojiIds:e.customEmojis.added.setIds,canAnimate:(0,c.BWX)(e),isSavedMessages:p,isCurrentUserPremium:(0,c.g29)(e),customEmojiFeaturedIds:a,defaultTopicIconsId:e.defaultTopicIconsId,defaultStatusIconsId:e.defaultStatusIconsId,topReactions:s?m:void 0,recentReactions:s?h:void 0,chatEmojiSetId:v?.emojiSet?.id,isWithPaidReaction:s&&v?.isPaidReactionAvailable,availableReactions:s?d:void 0,defaultTagReactions:s?u:void 0}})(({className:e,pickerListClassName:t,isHidden:i,loadAndPlay:o,addedCustomEmojiIds:r,customEmojisById:d,recentCustomEmojiIds:h,selectedReactionIds:u,recentStatusEmojis:p,collectibleStatuses:v,stickerSetsById:g,chatEmojiSetId:A,topReactions:f,recentReactions:b,availableReactions:C,idPrefix:y="custom-emoji-set",customEmojiFeaturedIds:S,canAnimate:N,isReactionPicker:k,isStatusPicker:w,isTranslucent:I,isSavedMessages:P,isCurrentUserPremium:F,withDefaultTopicIcons:D,defaultTopicIconsId:M,defaultStatusIconsId:L,defaultTagReactions:R,isWithPaidReaction:x,onCustomEmojiSelect:E,onReactionSelect:V,onReactionContext:_,onDismiss:U})=>{const O=(0,s.li)(),K=(0,s.li)(),J=(0,s.li)(),G=(0,s.li)(),{isMobile:j}=(0,Y.Ay)(),{handleScroll:z,isAtBeginning:H}=(0,rs.A)(),$=(0,s.Kr)(()=>w?p:Object.values((0,di._E)(d,h)),[d,w,h,p]),q=(0,s.Kr)(()=>{const e=v?.map(e=>e.documentId);return d&&e?.map(e=>d[e]).filter(Boolean)},[d,v]),W=`${y}-custom-emoji`,{activeSetIndex:Q,observeIntersectionForSet:Z,observeIntersectionForPlayingItems:ee,observeIntersectionForShowingItems:te,observeIntersectionForCovers:ie,selectStickerSet:ne}=tr(O,K,W,i),oe=(0,Ui.A)(o||void 0,a.jhd),re=(0,B.A)(),le=(0,Fi.A)(),ce=Boolean(r),de=(0,s.Kr)(()=>{const e=[];if(k&&P&&R?.length&&e.push({id:a.G3A,accessHash:"",title:re("PremiumPreviewTags"),reactions:R,count:R.length,isEmoji:!0}),k&&!P){const t=f?.slice(0,16)||[];x&&t.unshift({type:"paid"}),t?.length&&e.push({id:a.G3A,accessHash:"",title:re("Reactions"),reactions:t,count:t.length,isEmoji:!0});const i=(b||[]).filter(e=>!t.some(t=>(0,l.a0)(t,e))).slice(0,32),s=(C||[]).filter(({isInactive:e})=>!e).map(({reaction:e})=>e).filter(e=>!t.some(t=>(0,l.a0)(t,e))&&!i.some(t=>(0,l.a0)(t,e)));if(s?.length||i?.length){const t=!i?.length,n=i.concat(s);e.push({id:t?a.EPW:a.sR2,accessHash:"",title:re(t?"PopularReactions":"RecentStickers"),reactions:n,count:n.length,isEmoji:!0})}}else if(w){const t=g[L];if(t?.stickers?.length){const i=(0,di.Xd)(t.stickers.slice(0,7).concat($||[]),"id");e.push({...t,stickers:i,count:i.length,id:a.sR2,title:re("RecentStickers"),isEmoji:!0})}q?.length&&e.push({id:a.j1l,accessHash:"",count:q.length,stickers:q,title:le("CollectibleStatusesCategory"),isEmoji:!0})}else if(D){const t=g[M];t.stickers?.length&&e.push({...t,id:a.sR2,title:re("RecentStickers")})}else $?.length&&e.push({id:a.sR2,accessHash:"0",title:re("RecentStickers"),stickers:$,count:$.length,isEmoji:!0});const t=[...r||[]];A&&t.unshift(A);const i=(0,di.Am)(t.concat(S||[])),s=Object.values((0,di._E)(g,i));return[...e,...s]},[r,k,w,D,$,S,g,f,C,re,b,L,M,P,R,A,x,q,le]),me=(0,s.Kr)(()=>ce&&0===de.filter(e=>e.stickers?.length).length,[de,ce]),ue=(0,Wa.A)([],a.jhd),pe=ce&&ue&&!me;(0,An.A)(K,j||!pe),(0,s.vJ)(()=>{if(!ce)return;const e=K.current;if(!e)return;const t=Q*wr-(e.offsetWidth/2-wr/2);(0,uo.A)(e,t)},[ce,Q]);const ve=(0,T.A)(e=>{E(e)}),Ae=(0,ge.A)("StickerPicker","Qk9PEGRE",e),fe=(0,ge.A)(yr,"no-scrollbar",!H&&Sr),be=(0,ge.A)(br,"U0BL1VvK",m.TF?"no-scrollbar":"custom-scroll",t,Cr),Ce=!pe&&!me;return(0,se.Y)(ae.Ay,{className:Ae,name:"fade",activeKey:Ce?0:1,shouldCleanup:!0,children:pe||me?!pe&&me?(0,se.Y)("div",{className:kr,children:re("NoStickers")}):(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{ref:K,className:fe,children:(0,se.FD)("div",{className:"shared-canvas-container",children:[(0,se.Y)("canvas",{ref:J,className:"shared-canvas"}),(0,se.Y)("canvas",{ref:G,className:"shared-canvas"}),de.map(function(e,t){const i=e.stickers?.[0],s=(0,ge.A)(Nr,t===Q&&"WYeuJNQx"),o=t<a.j41,r=(0,c.CzR)((0,n.mS)(),e);if(e.id!==a.G3A){if(Pr.has(e.id)||e.hasThumbnail||!i){const i=e.id===a.sR2||e.id===a.EPW,n=Ir.has(e.id);return(0,se.Y)(X.A,{className:s,ariaLabel:e.title,round:!0,faded:n,color:"translucent",onClick:()=>ne(i?0:t),children:i?(0,se.Y)(he.A,{name:"recent"}):(0,se.Y)(ar,{stickerSet:e,noPlay:!N||!oe,forcePlayback:!0,observeIntersection:ie,sharedCanvasRef:o?r?G:J:void 0})},e.id)}return(0,se.Y)(dr,{sticker:i,size:a.TBj,title:e.title,className:s,noPlay:!N||!oe,observeIntersection:ie,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:o?r?G:J:void 0,withTranslucentThumb:I,onClick:ne,clickArg:t,forcePlayback:!0},e.id)}})]})}),(0,se.Y)("div",{ref:O,onScroll:z,className:be,children:de.map((e,t)=>{const i=e.id===a.G3A||e.id===a.sR2&&(D||w),s=e.id===A;return(0,se.Y)(Ar,{stickerSet:e,loadAndPlay:Boolean(N&&oe),index:t,idPrefix:W,observeIntersection:Z,observeIntersectionForPlayingItems:ee,observeIntersectionForShowingItems:te,isNearActive:Q>=t-1&&Q<=t+1,isSavedMessages:P,isStatusPicker:w,isReactionPicker:k,shouldHideHeader:i,withDefaultTopicIcon:D&&e.id===a.sR2,withDefaultStatusIcon:w&&e.id===a.sR2,isChatEmojiSet:s,isCurrentUserPremium:F,selectedReactionIds:u,availableReactions:C,isTranslucent:I,onReactionSelect:V,onReactionContext:_,onStickerSelect:ve,onDismiss:U,forcePlayback:!0},e.id)})})]}):(0,se.Y)(Ds.A,{})})}));var Fr=i(3325);const Dr=(0,s.ph)((0,n.EK)(e=>({areFeaturedStickersLoaded:Boolean(e.customEmojis.featuredIds?.length),isTranslucent:(0,c.cwE)(e)}))(({isOpen:e,statusButtonRef:t,areFeaturedStickersLoaded:i,isTranslucent:o,onEmojiStatusSelect:a,onClose:r})=>{const{loadFeaturedEmojiStickers:l}=(0,n.ko)(),c=(0,s.li)(0);(0,s.vJ)(()=>{c.current=t.current.getBoundingClientRect().right},[e,t]),(0,s.vJ)(()=>{e&&!i&&l()},[i,e,l]);const d=(0,s.hb)(e=>{a(e),r()},[r,a]);return(0,se.Y)(Fr.A,{children:(0,se.Y)(Ze.A,{isOpen:e,noCompact:!0,positionX:"left",bubbleClassName:"hRzvfaRb",onClose:r,transformOriginX:c.current,children:(0,se.Y)(Yr,{idPrefix:"status-emoji-set-",loadAndPlay:e,isHidden:!e,isStatusPicker:!0,isTranslucent:o,onDismiss:r,onCustomEmojiSelect:d})})})}));var Mr=i(10187);const Tr=6*g.$,Br=(0,s.ph)((0,n.EK)((e,{modal:t})=>({currentUser:(0,c.mBe)(e,e.currentUserId),bot:t?.botId?(0,c.mBe)(e,t.botId):void 0}))(({modal:e,currentUser:t,bot:i})=>{const{setEmojiStatus:o,closeSuggestedStatusModal:a,sendWebAppEvent:r}=(0,n.ko)(),c=(0,Fi.A)(),d=Boolean(e),h=(0,Si.A)(e),m=(0,s.Kr)(()=>{if(t&&h)return{...t,emojiStatus:{type:"regular",documentId:h.customEmojiId}}},[t,h]),u=(0,s.Kr)(()=>{if(!h||!i)return;const e=(0,l.Yg)(i);return h.duration?c("BotSuggestedStatusFor",{bot:e,duration:(0,We.A$)(c,h.duration)},{withNodes:!0,withMarkdown:!0}):c("BotSuggestedStatus",{bot:e},{withNodes:!0,withMarkdown:!0})},[i,c,h]),p=(0,T.A)(()=>{const e=h?.webAppKey;e&&r({webAppKey:e,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}}}),a()}),v=(0,T.A)(()=>{if(!h)return;const e=h.duration?(0,Ii.Fm)()+h.duration:void 0;o({referrerWebAppKey:h.webAppKey,emojiStatus:{type:"regular",documentId:h.customEmojiId,until:e}}),a()});return(0,se.FD)(te.A,{isOpen:d,contentClassName:"C9sWDINB",hasAbsoluteCloseButton:!0,isSlim:!0,onClose:p,children:[h&&(0,se.Y)(ro.A,{className:"gdG3oY21",documentId:h.customEmojiId,size:Tr,loopLimit:1,forceAlways:!0}),(0,se.FD)("div",{children:[(0,se.Y)("h3",{className:"KVpsce1g",children:c("BotSuggestedStatusTitle")}),(0,se.Y)("p",{className:"p7S4AH8A",children:u})]}),m&&(0,se.Y)(Mr.A,{mockPeer:m,withEmojiStatus:!0}),(0,se.Y)(X.A,{onClick:v,children:c("GeneralConfirm")})]})}));var Lr=i(55317),Rr=i(20333);const xr="j6xEoljc";function Er(e,t){return e.find(e=>!e.chatId)||e.filter(e=>t&&e.chatId!==t).sort((e,t)=>e.date-t.date)[0]}const Vr=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=t&&(0,c.hds)(e,t?.chatId),s=i&&(0,c.AWZ)(e,i.id),n=t?.myBoosts&&Er(t.myBoosts,t.chatId);return{chat:i,chatFullInfo:s,prevBoostedChat:n?.chatId?(0,c.hds)(e,n?.chatId):void 0,isCurrentUserPremium:(0,c.g29)(e)}})(({modal:e,chat:t,chatFullInfo:i,prevBoostedChat:o,isCurrentUserPremium:a})=>{const{applyBoost:r,closeBoostModal:c,requestConfetti:d,openPremiumModal:h,loadFullChat:m}=(0,n.ko)(),[u,p,v]=(0,D.A)(),[g,A,f]=(0,D.A)(),[b,C,y]=(0,D.A)(),S=t&&(0,l.WX)(t),N=Boolean(e),k=(0,B.A)(),w=(0,Fi.A)();(0,s.vJ)(()=>{t&&!i&&m({chatId:t.id})},[t,i]);const I=(0,s.Kr)(()=>{if(t)return(0,l.Js)(k,t)},[t,k]),P=(0,s.Kr)(()=>{if(o)return(0,l.Js)(k,o)},[o,k]),{isStatusLoaded:Y,isBoosted:F,boost:M,title:L,leftText:R,rightText:x,value:E,progress:V,descriptionText:_,canBoostMore:U}=(0,s.Kr)(()=>{if(!e?.boostStatus||!t)return{isStatusLoaded:!1,title:k("Loading")};const{hasMyBoost:s}=e.boostStatus,n=e?.myBoosts&&Er(e.myBoosts,t.id),o=e?.myBoosts&&(a=e.myBoosts,r=t.id,!a.every(e=>e.chatId===r));var a,r;const{boosts:c,currentLevel:d,hasNextLevel:h,levelProgress:m,remainingBoosts:u,isMaxLevel:p}=(0,Lr.z)(e.boostStatus,!0),v=s,g=k("BoostsLevel",d),A=h?k("BoostsLevel",d+1):void 0,f=k("ChannelBoost.MoreBoosts",u),b=k(S?"BoostChannel":"BoostGroup"),C=(i?.boostsToUnrestrict||0)-(i?.boostsApplied||0);let y;if(p)y=k("BoostsMaxLevelReached");else if(C>0&&!(0,l.SJ)(t)){const e=k("GroupBoost.BoostToUnrestrict.Times",C);y=k("GroupBoost.BoostToUnrestrict",[e,I])}else y=k("ChannelBoost.MoreBoostsNeeded.Text",[I,f]);return{isStatusLoaded:!0,title:b,leftText:g,rightText:A,value:c.toString(),progress:m,remainingBoosts:u,descriptionText:y,boost:n,isBoosted:v,canBoostMore:o&&!p}},[t,I,e,k,i,S]),O=!e?.myBoosts?.length&&a,K=M?.chatId&&M.chatId!==e?.chatId,J=(0,T.A)(()=>{v(),r({chatId:t.id,slots:[M.slot]}),d({})}),G=(0,T.A)(()=>{h(),y(),c()}),j=(0,T.A)(()=>{if(!M)return a?void c():void C();U?M.cooldownUntil?A():K?p():J():c()}),z=(0,T.A)(()=>{c()});return(0,se.FD)(te.A,{isOpen:N,title:L,className:"IK2mBqbm",contentClassName:"pUyNTysT",onClose:c,children:[Y?(0,se.FD)(se.FK,{children:[(0,se.Y)(Rr.A,{leftText:R,rightText:x,progress:V,floatingBadgeText:E,floatingBadgeIcon:"boost"}),F&&(0,se.Y)("div",{className:(0,ge.A)(xr,"hAA6B1lc"),children:k("ChannelBoost.YouBoostedChannelText",I)}),(0,se.Y)("div",{className:xr,children:(0,Pt.A)(_,["simple_markdown","emoji"])}),(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",disabled:O,onClick:j,children:U?(0,se.FD)(se.FK,{children:[(0,se.Y)(he.A,{name:"boost"}),k(S?"ChannelBoost.BoostChannel":"GroupBoost.BoostGroup")]}):k("OK")}),(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",onClick:z,children:k("Cancel")})]})]}):(0,se.Y)(Ds.A,{className:"zjXCH3pT"}),K&&P&&(0,se.FD)(te.A,{isOpen:u,className:"GIFAjZPY",contentClassName:"Jxyz9TaL",onClose:v,children:[(0,se.FD)("div",{className:"OKp6HS1U",children:[(0,se.FD)("div",{className:"NU9itcIm",children:[(0,se.Y)(Yt.A,{peer:o,size:"large"}),(0,se.Y)(he.A,{name:"boostcircle",className:"upXvhNRY"})]}),(0,se.Y)(he.A,{name:"next",className:"WSJdWV7L"}),(0,se.Y)(Yt.A,{peer:t,size:"large"})]}),(0,se.Y)("div",{children:(0,Pt.A)(k("ChannelBoost.ReplaceBoost",[P,I]),["simple_markdown","emoji"])}),(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",onClick:J,children:k("Replace")}),(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",onClick:v,children:k("Cancel")})]})]}),Boolean(M?.cooldownUntil)&&(0,se.Y)(oi.A,{isOpen:g,isOnlyConfirm:!0,confirmLabel:k("OK"),title:k("ChannelBoost.Error.BoostTooOftenTitle"),onClose:f,confirmHandler:f,children:(0,Pt.A)(k("ChannelBoost.Error.BoostTooOftenText",(0,We.A$)(w,M.cooldownUntil-(0,Ii.Fm)())),["simple_markdown","emoji"])}),!a&&(0,se.Y)(oi.A,{isOpen:b,confirmLabel:k("Common.Yes"),title:k("PremiumNeeded"),onClose:y,confirmHandler:G,children:(0,Pt.A)(k("PremiumNeededForBoosting"),["simple_markdown","emoji"])})]})}));var _r=i(47058),Ur=i(70046);const Or="xVLGjLub",Kr=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const{message:i}=t||{},s=i&&(0,c.O5q)(e,i.chatId,i.messageId),n=s&&(0,c.Y7C)(e,s);return{currentUserId:e.currentUserId,messageSender:n}})(({currentUserId:e,modal:t,messageSender:i})=>{const{closeGiftCodeModal:o,applyGiftCode:r,focusMessage:l}=(0,n.ko)(),c=(0,Fi.A)(),d=(0,B.A)(),h=Boolean(t),m=!(t?.info.toId&&t?.info.toId!==e||t?.info.usedAt),u=(0,T.A)(()=>{t&&t.info.giveawayMessageId&&(l({chatId:t.info.fromId,messageId:t.info.giveawayMessageId}),o())}),p=(0,T.A)(()=>{m?r({slug:t.slug}):o()}),v=(0,s.Kr)(()=>{if(!t)return;const{slug:e,info:s}=t,n=s.fromId||i?.id,o=(0,se.FD)(se.FK,{children:[(0,se.Y)("img",{src:Oa,alt:"",className:"Mtx4SWww"}),(0,se.Y)("p",{className:Or,children:(0,Pt.A)(d("lng_gift_link_about"),["simple_markdown"])}),(0,se.Y)(_r.A,{title:"BoostingGiftLink",link:`${a.jsp}/giftcode/${e}`})]}),r=[[d("BoostingFrom"),n?{chatId:n}:d("BoostingNoRecipient")],[d("BoostingTo"),s.toId?{chatId:s.toId}:d("BoostingNoRecipient")],[d("BoostingGift"),d("BoostingTelegramPremiumFor",(0,We.w6)(c,s.days))]];return s.isFromGiveaway&&r.push([d("BoostingReason"),(0,se.Y)("span",{className:(0,ge.A)(s.giveawayMessageId&&"IzcASdzD"),onClick:u,children:s.isFromGiveaway&&!s.toId?d("BoostingIncompleteGiveaway"):d("BoostingGiveaway")})]),r.push([d("BoostingDate"),(0,We.L2)(1e3*s.date,d.code,!0)]),{header:o,tableData:r,footer:(0,se.Y)("span",{className:Or,children:(0,Pt.A)(s.usedAt?d("BoostingUsedLinkDate",(0,We.L2)(1e3*s.usedAt,d.code,!0)):d("BoostingSendLinkToAnyone"),["simple_markdown"])})}},[c,d,i?.id,t]);if(v)return(0,se.Y)(Ur.A,{isOpen:h,title:d("lng_gift_link_title"),tableData:v.tableData,header:v.header,footer:v.footer,buttonText:d(m?"BoostingUseLink":"Close"),onButtonClick:p,onClose:o})}));function Jr(e,t){return e.reduce((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e)}const Gr=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const{selfDestructAccountDays:i}=t||{};return{selfDestructAccountDays:i}})(({modal:e,selfDestructAccountDays:t})=>{const{closeGiftCodeModal:i,closeDeleteAccountModal:o,setAccountTTL:r}=(0,n.ko)(),l=(0,Fi.A)(),c=Boolean(e),[d,h]=(0,s.J0)(),m=(0,T.A)(e=>30*Number(e)),u=(0,s.Kr)(()=>{if(t)return Jr(a.WF4,t/30).toString()},[t]);(0,s.vJ)(()=>{u&&h(u)},[u]);const p=(0,s.Kr)(()=>a.WF4.map(e=>({value:String(e),label:l("Months",{count:e},{pluralValue:1})})),[l]),v=(0,T.A)(e=>{h(e)}),g=(0,T.A)(()=>{d&&r({days:m(d)})}),A=(0,T.A)(()=>{o()});return(0,se.FD)(te.A,{isOpen:c,title:l("SelfDestructTitle"),onClose:i,className:"X6K5oA8U",children:[(0,se.Y)("p",{children:l("SelfDestructSessionsDescription")}),(0,se.Y)(ie.A,{className:"dialog-checkbox-group",name:"quick-reaction-settings",options:p,selected:d,onChange:v,withIcon:!0}),(0,se.FD)("div",{className:"dialog-buttons mt-2",children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:g,children:l("Save")}),(0,se.Y)(X.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:A,children:l("Cancel")})]})]})})),jr={root:"OviJR58x",content:"BlpqzGYt",header:"b9RUzfpF",iconWrapper:"l1X5kBUM",icon:"qOoRnv_Y",mainText:"s2SOQSml",description:"wiKBjcl2"},zr=(0,s.ph)((0,n.EK)(e=>{const t=e.appConfig;return{verifyAgeBotUsername:t.verifyAgeBotUsername,verifyAgeMin:t.verifyAgeMin||a.lYi}})(({modal:e,verifyAgeBotUsername:t,verifyAgeMin:i})=>{const{closeAgeVerificationModal:s,openChatByUsername:o}=(0,n.ko)(),a=(0,Fi.A)(),r=Boolean(e),l=(0,T.A)(()=>{t&&o({shouldStartMainApp:!0,username:t}),s()}),c=(0,T.A)(()=>{s()});return(0,se.FD)(te.A,{isOpen:r,onClose:c,className:jr.root,children:[(0,se.FD)("div",{className:jr.content,children:[(0,se.Y)("div",{className:jr.header,children:(0,se.Y)("div",{className:jr.iconWrapper,children:(0,se.Y)(he.A,{name:"user",className:jr.icon})})}),(0,se.Y)("h2",{className:jr.title,children:a("TitleAgeVerificationModal")}),(0,se.Y)("p",{className:jr.mainText,children:a("TextAgeVerificationModal",{count:i},{withMarkdown:!0,withNodes:!0,pluralValue:i})}),(0,se.Y)("p",{className:jr.description,children:a("DescriptionAgeVerificationModal")})]}),(0,se.Y)("div",{className:"dialog-buttons mt-2",children:(0,se.Y)(X.A,{onClick:l,children:a("ButtonAgeVerification")})})]})}));var Hr=i(34132),$r=i(24713);const qr={description:"dl10exNi","picker-wrapper":"gxWY5c6x",pickerWrapper:"gxWY5c6x","picker-header":"h8N7eyob",pickerHeader:"h8N7eyob","picker-header-info":"Rth2Qu07",pickerHeaderInfo:"Rth2Qu07","selection-toggle":"B6eAugx8",selectionToggle:"B6eAugx8",foldersWrapper:"mwcvgD2S",folders:"LKavx8ww",folder:"qglLx5Dn","button-text":"bgaRuEMs",buttonText:"bgaRuEMs","button-badge":"rTe14Z22",buttonBadge:"rTe14Z22"},Wr=(0,s.ph)(({invite:e,folder:t})=>{const{closeChatlistModal:i,joinChatlistInvite:o}=(0,n.ko)(),a=(0,Fi.A)(),r=(0,B.A)(),[l,c]=(0,s.J0)(e.missingPeerIds),d=Boolean(e.missingPeerIds.length),h=0===e.alreadyPeerIds.length,m=d?e.missingPeerIds.length:0,u=l.length?l.length.toString():void 0,p=h?a("FolderLinkSubtitleNew"):m?a("FolderLinkSubtitleAdd",{chats:a("FolderLinkSubtitleAddCount",{count:m},{pluralValue:m}),title:(0,Oi.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations})},{withNodes:!0,withMarkdown:!0}):a("FolderLinkSubtitleAlready"),v=(0,s.hb)(()=>{i(),l.length&&o({invite:e,peerIds:l})},[e,l]),g=(0,s.hb)(()=>{const t=l.length===e.missingPeerIds.length;c(t?[]:e.missingPeerIds)},[e.missingPeerIds,l.length]);return(0,se.FD)("div",{className:qr.content,children:[(0,se.Y)("div",{className:qr.description,children:(0,Pt.A)(p,["simple_markdown","emoji"])}),(0,se.FD)("div",{className:(0,ge.A)(qr.pickerWrapper,"custom-scroll"),children:[Boolean(e.missingPeerIds.length)&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:qr.pickerHeader,children:[(0,se.Y)("div",{className:qr.pickerHeaderInfo,children:r("FolderLinkHeaderChatsJoin",l.length,"i")}),(0,se.Y)("div",{className:qr.selectionToggle,role:"button",tabIndex:0,onClick:g,children:l.length===e.missingPeerIds.length?r("DeselectAll"):r("SelectAll")})]}),(0,se.Y)(mi.A,{itemIds:e.missingPeerIds,onSelectedIdsChange:c,selectedIds:l,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,se.Y)("div",{className:qr.pickerHeader,children:(0,se.Y)("div",{className:qr.pickerHeaderInfo,children:r("FolderLinkHeaderAlready")})}),(0,se.Y)(mi.A,{itemIds:e.alreadyPeerIds,lockedSelectedIds:e.alreadyPeerIds,selectedIds:e.alreadyPeerIds,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,se.Y)(X.A,{onClick:v,children:(0,se.FD)("div",{className:qr.buttonText,children:[!l.length&&r("OK"),Boolean(l.length)&&(0,se.FD)(se.FK,{children:[r("FolderLinkButtonJoinPlural",l.length,"i"),(0,se.Y)($r.A,{className:qr.buttonBadge,text:u,isAlternateColor:!0})]})]})})]})}),Qr=(0,s.ph)(({folder:e,suggestedPeerIds:t=hi.p})=>{const{closeChatlistModal:i,leaveChatlist:o}=(0,n.ko)(),a=(0,B.A)(),[r,l]=(0,s.J0)([]),c=r.length?r.length.toString():void 0,d=(0,s.hb)(()=>{const e=r.length===t.length;l(e?[]:t)},[t,r.length]),h=(0,s.hb)(()=>{i(),o({folderId:e.id,peerIds:r})},[e.id,r]);return(0,se.FD)("div",{className:qr.content,children:[Boolean(t?.length)&&(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{className:qr.description,children:(0,Pt.A)(a("FolderLinkSubtitleRemove"),["simple_markdown","emoji"])}),(0,se.FD)("div",{className:(0,ge.A)(qr.pickerWrapper,"custom-scroll"),children:[(0,se.FD)("div",{className:qr.pickerHeader,children:[(0,se.Y)("div",{className:qr.pickerHeaderInfo,children:a("FolderLinkHeaderChatsQuit",r.length,"i")}),(0,se.Y)("div",{className:qr.selectionToggle,role:"button",tabIndex:0,onClick:d,children:r.length===t.length?a("DeselectAll"):a("SelectAll")})]}),(0,se.Y)(mi.A,{itemIds:t,onSelectedIdsChange:l,selectedIds:r,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]})]}),(0,se.Y)(X.A,{onClick:h,children:(0,se.FD)("div",{className:qr.buttonText,children:[!r.length&&a("FolderLinkButtonRemove"),Boolean(r.length)&&(0,se.FD)(se.FK,{children:[a("FolderLinkButtonRemoveChats"),(0,se.Y)($r.A,{className:qr.buttonBadge,text:c,isAlternateColor:!0})]})]})})]})}),Zr=(0,s.ph)(({invite:e})=>{const{closeChatlistModal:t,joinChatlistInvite:i}=(0,n.ko)(),o=(0,Fi.A)(),a=(0,B.A)(),[r,l]=(0,s.J0)(e.peerIds),c=(0,s.Kr)(()=>{const t=(0,n.mS)().chats.byId;return e.peerIds.filter(e=>!t[e].isNotJoined)},[e.peerIds]),d=r.length-c.length,h=d?d.toString():void 0,m=(0,s.hb)(()=>{t(),i({invite:e,peerIds:r})},[e,r]),u=(0,s.hb)(()=>{const t=r.length===e.peerIds.length;l(t?c:e.peerIds)},[e.peerIds,c,r.length]);return(0,se.FD)("div",{className:qr.content,children:[(0,se.Y)("div",{className:qr.description,children:o("FolderLinkSubtitleNew")}),(0,se.FD)("div",{className:(0,ge.A)(qr.pickerWrapper,"custom-scroll"),children:[(0,se.FD)("div",{className:qr.pickerHeader,children:[(0,se.Y)("div",{className:qr.pickerHeaderInfo,children:a("FolderLinkHeaderChatsJoin",d,"i")}),(0,se.Y)("div",{className:qr.selectionToggle,role:"button",tabIndex:0,onClick:u,children:r.length===e.peerIds.length?a("DeselectAll"):a("SelectAll")})]}),(0,se.Y)(mi.A,{itemIds:e.peerIds,lockedSelectedIds:c,onSelectedIdsChange:l,selectedIds:r,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,se.Y)(X.A,{onClick:m,disabled:!r.length,children:(0,se.FD)("div",{className:qr.buttonText,children:[o("FolderLinkAddFolder"),(0,se.Y)($r.A,{className:qr.buttonBadge,text:h,isAlternateColor:!0})]})})]})}),Xr=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const{invite:i,removal:s}=t||{},n=s?.folderId||(i&&"folderId"in i?i.folderId:void 0);return{folder:n?(0,c.$aQ)(e,n):void 0}})(({modal:e,folder:t})=>{const{closeChatlistModal:i}=(0,n.ko)(),o=(0,B.A)(),a=Boolean(e),r=(0,K.A)(e)||e,l=(0,K.A)(t)||t,c=(0,s.Kr)(()=>{if(r){if(r.invite){const e=r.invite;return"alreadyPeerIds"in e?e.missingPeerIds.length?o("FolderLinkTitleAddChats"):o("FolderLinkTitleAlready"):o("FolderLinkTitleAdd")}return r.removal?o("FolderLinkTitleRemove"):void 0}},[o,r]),d=(0,s.Kr)(()=>l?(0,Oi.fd)({text:l.title.text,entities:l.title.entities,noCustomEmojiPlayback:l.noTitleAnimations}):r?.invite&&"title"in r.invite?(0,Oi.fd)({text:r.invite.title.text,entities:r.invite.title.entities,noCustomEmojiPlayback:r.invite.noTitleAnimations}):void 0,[l,r]),h=(0,s.Kr)(()=>{if(r?.invite)return"missingPeerIds"in r.invite?r.invite.missingPeerIds.length:void 0},[r]),m=(0,s.hb)(()=>{if(r){if(r.invite){const e=r.invite;return"alreadyPeerIds"in e?(0,se.Y)(Wr,{invite:e,folder:l}):(0,se.Y)(Zr,{invite:e})}return r.removal?(0,se.Y)(Qr,{folder:l,suggestedPeerIds:r.removal.suggestedPeerIds}):void 0}},[l,r]);return(0,se.FD)(te.A,{isOpen:a,title:c,onClose:i,isSlim:!0,hasCloseButton:!0,children:[d&&(u=d,(0,se.Y)("div",{className:qr.foldersWrapper,children:(0,se.FD)("div",{className:qr.folders,children:[(0,se.Y)(Hr.A,{className:qr.folder,title:o("FolderLinkPreviewLeft")}),(0,se.Y)(Hr.A,{className:qr.folder,isActive:!0,badgeCount:h,isBadgeActive:!0,title:u}),(0,se.Y)(Hr.A,{className:qr.folder,title:o("FolderLinkPreviewRight")})]})})),m()]});var u})),el={content:"MZ0RCecx",title:"ar8XeydN",participantCount:"un00TXYY",participants:"YvkZ6c2D",participant:"DHJSBDeE",buttons:"KFtrPtNr"},tl=(0,s.ph)(({modal:e})=>{const{acceptChatInvite:t,closeChatInviteModal:i,showNotification:o}=(0,n.ko)(),a=(0,s.li)(),r=(0,B.A)(),d=(0,O.A)(e),{hash:h,inviteInfo:m}=e||d||{},{about:u,isBroadcast:p,participantIds:v,participantsCount:g,photo:A,isRequestNeeded:f}=m||{},b=(0,T.A)(()=>{i()}),C=(0,T.A)(()=>{t({hash:h}),f&&o({message:r(p?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")}),b()}),y=p?"ProfileJoinChannel":"JoinGroup",S=p?"MemberRequests.RequestToJoinChannel":"MemberRequests.RequestToJoinGroup",N=(0,s.Kr)(()=>{if(m)return(0,l.nr)(m)},[m]),k=(0,s.Kr)(()=>{if(!v)return;const e=(0,n.mS)();return v.map(t=>(0,c.mBe)(e,t)).filter(Boolean)},[v]);return(0,An.A)(a,!e||!k),(0,se.FD)(te.A,{isOpen:Boolean(e),contentClassName:el.content,isSlim:!0,onClose:b,onEnter:C,children:[N&&(0,se.Y)(Yt.A,{size:"jumbo",photo:A,peer:N,withVideo:!0}),N&&(0,se.Y)(Ms.A,{className:el.title,peer:N}),u&&(0,se.Y)("p",{className:el.about,children:u}),(0,se.Y)("p",{className:el.participantCount,children:r(p?"Subscribers":"Members",g,"i")}),k&&(0,se.Y)("div",{ref:a,className:(0,ge.A)(el.participants,"no-scrollbar"),children:k.map(e=>(0,se.Y)(yn.A,{className:el.participant,peer:e,text:(0,l.Yg)(e)}))}),(0,se.FD)("div",{className:(0,ge.A)("dialog-buttons",el.buttons),children:[(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",onClick:C,children:r(f?S:y)}),(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",onClick:b,children:r("Cancel")})]})]})});var il=i(5463);const sl=(0,s.ph)(({modal:e})=>{const{closePasskeyModal:t,startPasskeyRegistration:i}=(0,n.ko)(),o=(0,Fi.A)(),a=(0,T.A)(()=>{t()}),r=(0,T.A)(()=>{i(),a()}),l=(0,s.Kr)(()=>({header:(0,se.FD)("div",{className:"flex-column-centered",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Passkeys,previewUrl:ur.d.Passkeys,size:120}),(0,se.Y)("h3",{className:"vi6YQWX0",children:o("PasskeyModalTitle")}),(0,se.Y)("p",{children:o("PasskeyModalDescription")})]}),listItemData:[["key",o("PasskeyModalFeature1Title"),o("PasskeyModalFeature1Description")],["animals",o("PasskeyModalFeature2Title"),o("PasskeyModalFeature2Description")],["lock",o("PasskeyModalFeature3Title"),o("PasskeyModalFeature3Description")]]}),[o]);return(0,se.Y)(il.A,{isOpen:Boolean(e),listItemData:l.listItemData,header:l.header,buttonText:o("PasskeyModalButtonText"),onButtonClick:r,onClose:a})}),nl="kiV5YwpR",ol=(new Date).getFullYear(),al=ol-150,rl=Array.from({length:12},(e,t)=>t+1),ll=(e,t)=>e?2===e?t&&(t%4!=0||t%100==0&&t%400!=0)?28:29:4===e||6===e||9===e||11===e?30:31:31,cl=(0,s.ph)(({modal:e})=>{const{closeBirthdaySetupModal:t,openSettingsScreen:i,updateBirthday:a}=(0,n.ko)(),{currentBirthday:r}=e||{},l=(0,s.li)(),[c,d]=(0,s.J0)(r?.day),[h,m]=(0,s.J0)(r?.month),[u,p]=(0,s.J0)(r?.year),v=(0,Fi.A)(),g=(0,T.A)(()=>{t()}),A=(0,T.A)(()=>{a({birthday:void 0}),t()}),f=(0,T.A)(()=>{i({screen:o.VS.PrivacyBirthday}),t()}),b=ll(h,u),C=(0,T.A)(e=>{if(!e.target.value)return void d(void 0);const t=Number(e.target.value.replace(/[^\d]+/g,""));t?d(t>b?b:Math.max(t,1)):e.preventDefault()}),y=(0,T.A)(e=>{m(e),c&&d(Math.min(c,ll(e,u)))}),S=(0,T.A)(e=>{if(!e.target.value)return void p(void 0);const t=Number(e.target.value.replace(/[^\d]+/g,""));t?t>ol?p(ol):(p(t),c&&d(Math.min(c,ll(h,t)))):e.preventDefault()}),N=(0,T.A)(()=>{u?u<100?p(1900+u):u<al&&p(al):p(void 0)}),k=(0,T.A)(()=>{c&&h&&(a({birthday:{day:c,month:h,year:u}}),t())}),w=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.Y)(ee.A,{label:v("BirthdayInputMonth"),className:(0,ge.A)(nl,"xSFFwTx2",t&&"active"),value:h?v(`Month${h}`):"",onClick:e,inputMode:"numeric",teactExperimentControlled:!0}),[v,h]);return(0,se.FD)(te.A,{isOpen:Boolean(e),hasCloseButton:!0,hasAbsoluteCloseButton:!0,isSlim:!0,dialogRef:l,contentClassName:"W0kySiJ6",onClose:g,children:[(0,se.FD)("div",{className:"PpcrztHS",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.DuckCake,size:120,className:"section-icon"}),(0,se.Y)("h3",{className:"lMKiFLTe",children:v("BirthdaySetupTitle")})]}),(0,se.FD)("div",{className:"sje6F_wI",children:[(0,se.Y)(ee.A,{label:v("BirthdayInputDay"),className:nl,value:c?.toString(),onChange:C,maxLength:2,inputMode:"numeric"}),(0,se.Y)(me.A,{className:(0,ge.A)("OMO_wq8N","with-menu-transitions"),bubbleClassName:"JcsMNM0K",autoClose:!0,positionY:"bottom",trigger:w,children:rl.map(e=>(0,se.Y)(ue.A,{onClick:()=>y(e),children:v(`Month${e}`)},e))}),(0,se.Y)(ee.A,{label:v("BirthdayInputYear"),className:nl,value:u?.toString(),onBlur:N,onChange:S,maxLength:4,inputMode:"numeric"})]}),(0,se.FD)("div",{className:"mkIotrno",children:[(0,se.Y)("span",{className:"INQVqP2z",children:v("BirthdayPrivacySuggestion",{link:(0,se.Y)(fa.A,{isPrimary:!0,onClick:f,children:v("BirthdayPrivacySuggestionLink")})},{withNodes:!0})}),r&&(0,se.Y)(X.A,{isText:!0,onClick:A,children:v("BirthdayRemove")}),(0,se.Y)(X.A,{disabled:!c||!h,onClick:k,children:v("Save")})]})]})});var dl=i(84685),hl=i(89873);const ml="La4sUYaq",ul="Bn5kz5br",pl=(0,s.ph)((0,n.EK)(e=>({minLevelToRestrictAds:e.appConfig.channelRestrictAdsLevelMin}))(({modal:e,minLevelToRestrictAds:t})=>{const{closeAboutAdsModal:i}=(0,n.ko)(),o=(0,s.li)(),a=Boolean(e),r=(0,Si.A)(e),{canReport:l,randomId:c,additionalInfo:d,sponsorInfo:h}=r||{},m=l,u=(0,Si.A)(m),p=(0,B.A)(),v=(0,s.Kr)(()=>(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{children:p("SponsoredMessageInfoScreen.Title")}),(0,se.Y)("p",{children:(0,Pt.A)(p("SponsoredMessageInfoDescription1"),["br"])}),(0,se.Y)("p",{children:(0,Pt.A)(p("SponsoredMessageInfoDescription2"),["br"])}),(0,se.Y)("p",{children:(0,Pt.A)(p("SponsoredMessageInfoDescription3"),["br"])}),(0,se.Y)("p",{children:(0,se.Y)(dl.A,{url:p("SponsoredMessageAlertLearnMoreUrl"),text:p("SponsoredMessageAlertLearnMoreUrl")})}),(0,se.Y)("p",{children:(0,Pt.A)(p("SponsoredMessageInfoDescription4"),["br"])})]}),[p]),{isContextMenuOpen:g,contextMenuAnchor:A,handleContextMenu:f,handleContextMenuClose:b,handleContextMenuHide:C}=(0,Ws.A)(o,!u),y=(0,T.A)(()=>{i(),b(),C()}),S=(0,s.Kr)(()=>{if(a)return{header:(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{className:ml,children:p("AboutRevenueSharingAds")}),(0,se.Y)("p",{className:(0,ge.A)(ul,"hbsLlXSH"),children:p("RevenueSharingAdsAlertSubtitle")}),(0,se.Y)(X.A,{ref:o,round:!0,size:"smaller",color:"translucent",className:"JdN5pGTw",onClick:f,iconName:"more"})]}),listItemData:[["lock",p("RevenueSharingAdsInfo1Title"),(0,Pt.A)(p("RevenueSharingAdsInfo1Subtitle"),["simple_markdown"])],["revenue-split",p("RevenueSharingAdsInfo2Title"),(0,Pt.A)(p("RevenueSharingAdsInfo2Subtitle"),["simple_markdown"])],["nochannel",p("RevenueSharingAdsInfo3Title"),(0,Pt.A)(p("RevenueSharingAdsInfo3Subtitle",t),["simple_markdown"])]],footer:(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{className:ml,children:(0,Pt.A)(p("RevenueSharingAdsInfo4Title"),["simple_markdown"])}),(0,se.FD)("p",{className:ul,children:[(0,Pt.A)(p("RevenueSharingAdsInfo4Subtitle2",""),["simple_markdown"]),(0,se.Y)(dl.A,{url:p("PromoteUrl"),text:p("LearnMoreArrow")})]})]})}},[a,p,f,t]);return u?(0,se.FD)(se.FK,{children:[(0,se.Y)(il.A,{isOpen:a,listItemData:S?.listItemData,headerIconName:"channel",headerIconPremiumGradient:!0,withSeparator:!0,header:S?.header,footer:S?.footer,buttonText:p("RevenueSharingAdsUnderstood"),onClose:y}),A&&c&&(0,se.Y)(hl.A,{isOpen:g,anchor:A,triggerRef:o,randomId:c,additionalInfo:d,canReport:l,sponsorInfo:h,shouldSkipAbout:!0,onItemClick:y,onClose:b,onCloseAnimationEnd:C})]}):(0,se.FD)(te.A,{isOpen:a,className:"LFkgLoAk",contentClassName:"TZE15Pt_",onClose:y,children:[v,(0,se.Y)(X.A,{onClick:y,children:p("RevenueSharingAdsUnderstood")})]})})),vl="t9iZUzOj",gl=(0,s.ph)(({isOpen:e,onClose:t})=>{const i=(0,B.A)(),n=(0,Fi.A)(),o=(0,s.Kr)(()=>{const e=i("LearnMore");return n("ChannelEarnLearnCoinAbout",{link:(0,se.FD)(dl.A,{url:i("MonetizationInfoTONLink"),text:e,children:[e,(0,se.Y)(he.A,{name:"next"})]})},{withNodes:!0})},[n,i]),a=(0,s.Kr)(()=>n("MonetizationInfoTONTitle",void 0,{withNodes:!0,specialReplacement:{"ðŸ’Ž":(0,se.Y)(he.A,{className:"ATkOSqJ7",name:"toncoin"})}}),[n]),r=(0,s.Kr)(()=>{if(e)return{header:(0,se.Y)("h3",{className:vl,children:i("lng_channel_earn_learn_title")}),listItemData:[["channel",i("lng_channel_earn_learn_in_subtitle"),(0,Pt.A)(i("lng_channel_earn_learn_in_about"),["simple_markdown"])],["revenue-split",i("lng_channel_earn_learn_split_subtitle"),(0,Pt.A)(i("Monetization.Intro.Split.Text"),["simple_markdown"])],["cash-circle",i("lng_channel_earn_learn_out_subtitle"),(0,Pt.A)(i("lng_channel_earn_learn_out_about"),["simple_markdown"])]],footer:(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{className:vl,children:a}),(0,se.Y)("p",{className:"mjveZmdr",children:o})]})}},[e,i,a,o]);if(r)return(0,se.Y)(il.A,{isOpen:e,listItemData:r.listItemData,headerIconName:"cash-circle",headerIconPremiumGradient:!0,withSeparator:!0,header:r.header,footer:r.footer,buttonText:i("RevenueSharingAdsUnderstood"),onClose:t})});var Al=i(15535);const fl="oofoCYlu",bl=(0,s.ph)((0,n.EK)(e=>{const{twoFaSettings:{hint:t}}=e;return{passwordHint:t}})(({modal:e,passwordHint:t})=>{const{closeMonetizationVerificationModal:i,clearMonetizationVerificationError:o,processMonetizationRevenueWithdrawalUrl:a}=(0,n.ko)(),r=Boolean(e),l=(0,Si.A)(e),c=(0,Fi.A)(),[d,h]=(0,s.J0)(!1),m=(0,T.A)(e=>{l&&a({peerId:l.chatId,currentPassword:e})}),u=(0,T.A)(()=>{o()}),p=(0,T.A)(()=>{i()});return(0,se.Y)(te.A,{isOpen:r,hasCloseButton:!0,title:c("CheckPasswordTitle"),className:"WqeWhMAS",contentClassName:fl,onClose:p,children:(0,se.Y)("div",{className:(0,ge.A)(fl,"settings-content password-form custom-scroll"),children:(0,se.Y)("div",{className:"settings-item pt-0",children:(0,se.Y)(Al.A,{shouldShowSubmit:!0,placeholder:c("CheckPasswordPlaceholder"),error:l?.errorKey&&c.withRegular(l.errorKey),description:c("CheckPasswordDescription"),onClearError:u,isLoading:l?.isLoading,hint:t,isPasswordVisible:d,shouldResetValue:r,onChangePasswordVisibility:h,onSubmit:m})})})})})),Cl={content:"MKdSUg2P",chatItem:"qEIwBtp0"},yl=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.mBe)(e,e.currentUserId),i=(0,c.g29)(e);return{currentUser:t,stickerSet:e.defaultStatusIconsId?(0,c.ycM)(e,e.defaultStatusIconsId):void 0,isPremium:i,isAccountFrozen:(0,c.trm)(e)}})(({modal:e,currentUser:t,stickerSet:i,isPremium:o,isAccountFrozen:a})=>{const{closeEmojiStatusAccessModal:r,toggleUserEmojiStatusPermission:c,sendWebAppEvent:d,openPremiumModal:h,loadDefaultStatusIcons:m}=(0,n.ko)(),u=Boolean(e),p=(0,B.A)(),v=(0,Fi.A)(),g=(0,s.li)(),[A,f]=(0,s.J0)(0);(0,s.vJ)(()=>{!u||i?.stickers||a||m()},[u,i,a]);const b=(0,s.Kr)(()=>{if(t&&i?.stickers)return{...t,emojiStatus:{type:"regular",documentId:i.stickers[A].id}}},[t,i,A]),C=i?.stickers?.length;(0,hn.A)(()=>{C&&f(e=>(e+1)%C)},C?3200:void 0);const y=(0,T.A)(()=>(0,se.Y)(Mr.A,{withEmojiStatus:!0,className:Cl.chatItem,itemClassName:Cl.itemName,mockPeer:b})),S=(0,T.A)(()=>{e?.bot?.id&&(r(),e?.webAppKey&&(o?(d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"allowed"}}}),c({botId:e.bot.id,isEnabled:!0,isBotAccessEmojiGranted:!0})):(h(),d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}))))}),N=(0,T.A)(()=>{e?.bot?.id&&(r(),e?.webAppKey&&d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}),o&&c({botId:e.bot.id,isEnabled:!1}))}),k=(0,T.A)(()=>{if(e?.bot)return v("EmojiStatusAccessText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})});return(0,se.FD)(te.A,{className:(0,ge.A)("confirm"),contentClassName:Cl.content,isOpen:u,onClose:N,children:[y(),(0,se.FD)("div",{children:[k(),(0,se.FD)("div",{className:"dialog-buttons mt-2",ref:g,children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:S,color:"primary",children:p("lng_bot_allow_write_confirm")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:N,children:v("Cancel")})]})]})]})})),Sl=(0,s.ph)((0,n.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({modal:e,currentUser:t})=>{const{closeLocationAccessModal:i,toggleUserLocationPermission:o,sendWebAppEvent:a}=(0,n.ko)(),r=Boolean(e),c=(0,B.A)(),d=(0,Fi.A)(),h=(0,s.li)(),u=(0,T.A)(async()=>{const t=await(0,m.Bu)(),{geolocation:s}=t;e?.bot?.id&&(i(),e?.webAppKey&&(o({botId:e.bot.id,isAccessGranted:!0}),a({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!0,latitude:s?.latitude,longitude:s?.longitude,altitude:s?.altitude,course:s?.heading,speed:s?.speed,horizontal_accuracy:s?.accuracy,vertical_accuracy:s?.accuracy}}})))}),p=(0,T.A)(()=>{e?.bot?.id&&(i(),e?.webAppKey&&(o({botId:e.bot.id,isAccessGranted:!1}),a({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!1}}})))}),v=(0,T.A)(()=>{if(e?.bot)return(0,se.FD)("div",{className:"CGPoDaLo",children:[(0,se.Y)(Yt.A,{size:"large",peer:t}),(0,se.Y)(he.A,{name:"next",className:"pzERgD5x"}),(0,se.Y)(Yt.A,{size:"large",peer:e.bot})]})}),g=(0,T.A)(()=>{if(e?.bot)return d("LocationPermissionText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})});return(0,se.FD)(te.A,{className:(0,ge.A)("confirm"),isOpen:r,onClose:p,children:[v(),(0,se.FD)("div",{children:[g(),(0,se.FD)("div",{className:"dialog-buttons mt-2",ref:h,children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:u,color:"primary",children:c("lng_bot_allow_write_confirm")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:p,children:d("Cancel")})]})]})]})})),Nl="qJDgUtjV",kl=(0,s.ph)(({modal:e})=>{const{reportSponsored:t,closeReportAdModal:i,openPreviousReportAdModal:o}=(0,n.ko)(),a=(0,B.A)(),l=Boolean(e),c=(0,s.li)(),d=(0,T.A)((i,s)=>{const{chatId:n,randomId:o}=e;t({peerId:n,randomId:o,option:s})}),[h,m]=(0,s.Kr)(()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e.sections[t],t]},[e]),u=(0,T.A)(()=>{m?o():i()}),p=(0,s.Kr)(()=>{if(!e)return;const t=a("lng_report_sponsored_reported_learn").split("{link}");return[t[0],(0,se.Y)(dl.A,{text:a("lng_report_sponsored_reported_link"),url:a("ReportAd.Help_URL")}),t[1]]},[a,e]),v=(0,s.Kr)(()=>{if(!e)return;const t=Boolean(h?.subtitle);return(0,se.FD)("div",{className:"modal-header-condensed",children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:a(m?"Back":"Close"),onClick:u,iconName:m?"arrow-left":"close"}),(0,se.FD)("div",{className:(0,ge.A)("modal-title","ZAdG13Ah",t&&"lVVyV0py"),children:[(0,se.Y)("h3",{className:"mMmY6YR4",children:a("ReportAd")}),t&&(0,se.Y)("span",{className:"gSkAFc4u",children:h.subtitle})]})]})},[a,e,m,h?.subtitle]);(0,s.vJ)(()=>{if(!e)return;const t=document.querySelector(`.${ae.uo} > .${Nl}`);if(!t)return;const i=t.scrollHeight;(0,r.RK)(()=>{c.current.style.height=`${i+56}px`})},[e]);const g=(0,T.A)(()=>{const e=document.querySelector(`.${ae.VY} > .${Nl}`);(0,r.YS)(()=>{const t=e.scrollHeight;(0,r.RK)(()=>{c.current.style.height=`${t+56}px`})})});return(0,se.Y)(te.A,{isOpen:l,hasCloseButton:!0,className:"njPBcVYr",header:v,onClose:i,children:(0,se.FD)(ae.Ay,{name:"slide",className:"HjsGIG6e",ref:c,activeKey:m,onStart:g,children:[(0,se.FD)("div",{className:Nl,children:[(0,se.Y)("h3",{className:"jrA2dOiw",children:h?.title}),h?.options.map(e=>(0,se.Y)(li.A,{narrow:!0,secondaryIcon:"next",className:"aFbjDzNo",buttonClassName:"VbE0HzDs",clickArg:e.option,onClick:d,children:(0,se.Y)("div",{className:"oWujoaSC",children:e.text})}))]}),(0,se.Y)("p",{className:"k71Zrc_P",children:p})]})})}),wl="kq9LwNTZ",Il=(0,s.ph)(({modal:e})=>{const{reportMessages:t,reportStory:i,closeReportModal:o,openPreviousReportModal:a}=(0,n.ko)(),l=(0,B.A)(),c=Boolean(e),d=(0,s.li)(),[h,m]=(0,s.J0)(""),u=(0,T.A)((s,n)=>{const{messageIds:o,subject:a,peerId:r,chatId:l}=e;if(o)switch(a){case"message":t({chatId:l,messageIds:o,option:n});break;case"story":i({storyId:o[0],peerId:r,option:n})}}),[p,v]=(0,s.Kr)(()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e?.sections[t],t]},[e]),g=(0,T.A)(()=>{a()}),A=(0,T.A)(()=>{o()}),f=(0,s.Kr)(()=>{if(!e)return;const t=Boolean(p?.subtitle);return(0,se.FD)("div",{className:"modal-header-condensed",children:[v?(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:l("Back"),onClick:g,iconName:"arrow-left"}):(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:l("Close"),onClick:A,iconName:"close"}),(0,se.FD)("div",{className:(0,ge.A)("modal-title","Lj_ezEWU",t&&"OYFbu8fQ"),children:[(0,se.Y)("h3",{className:(0,ge.A)("QawchdxB",v&&"CV7kzv9H"),children:p?.options?l("story"===e?.subject?"ReportStory":"Report"):p?.title}),t&&(0,se.Y)("span",{className:"OUFckTb7",children:p.subtitle})]})]})},[l,e,v,p?.options,p?.subtitle,p?.title]),b=(0,T.A)(e=>{m(e.target.value)});(0,s.vJ)(()=>{if(!e)return;const t=document.querySelector(`.${ae.uo} > .${wl}`);if(!t)return;const i=t.scrollHeight;(0,r.RK)(()=>{d.current.style.height=`${i}px`})},[e]);const C=(0,T.A)(()=>{const e=document.querySelector(`.${ae.VY} > .${wl}`);(0,r.YS)(()=>{const t=e.scrollHeight;(0,r.RK)(()=>{d.current.style.height=`${t+20}px`})})}),y=(0,T.A)(()=>{m(""),o()}),S=(0,T.A)(()=>{const{messageIds:s,subject:n,peerId:o,chatId:a}=e;switch(n){case"message":t({chatId:a,messageIds:s,option:p?.option,description:h});break;case"story":i({storyId:s?.[0],peerId:o,option:p?.option,description:h})}y()});return(0,se.Y)(te.A,{isOpen:c,header:f,onClose:y,contentClassName:"tNysQgHL",className:(0,ge.A)("E1bGWeON","story"===e?.subject&&"component-theme-dark"),children:(0,se.Y)(ae.Ay,{name:"slide",className:"n2VxPirU",ref:d,activeKey:v,onStart:C,children:(0,se.FD)("div",{className:wl,children:[p?.options?(0,se.Y)("h3",{className:"GSfUuTet",children:p?.title}):void 0,p?.options?.map(e=>(0,se.Y)(li.A,{narrow:!0,nonInteractive:!0,secondaryIcon:"next",className:"RoxwMzvA",buttonClassName:"Z6skYdvb",clickArg:e.option,onClick:u,children:(0,se.Y)("div",{className:"FU8m6NUU",children:e.text})})),p?.option?(0,se.FD)("div",{className:"KpptZ3Mk",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Report,size:100,className:"kO8JC4gK",nonInteractive:!0,forceAlways:!0,noLoop:!1}),(0,se.Y)(rn.A,{id:"option",className:"yc3szGcx",label:p.isOptional?l("Report2CommentOptional"):l("Report2Comment"),onChange:b,value:h,maxLength:512,maxLengthIndicator:(512-h.length).toString(),noReplaceNewlines:!0}),(0,se.Y)(X.A,{onClick:S,disabled:p.isOptional?void 0:!h.length,children:l("ReportSend")})]}):void 0]})})})});var Pl=i(65632),Yl=i(89966);const Fl=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=(0,c.SJA)(e),{isBlurred:s,patternColor:n,background:o,backgroundColor:a}=(0,c.Gyz)(e,i)||{};return{theme:i,isBackgroundBlurred:s,patternColor:n,customBackground:o,backgroundColor:a,bot:t?(0,c.mBe)(e,t?.botId):void 0,currentUserId:e.currentUserId}})(({modal:e,theme:t,isBackgroundBlurred:i,patternColor:o,customBackground:a,backgroundColor:r,bot:c})=>{const{closePreparedInlineMessageModal:d,sendWebAppEvent:h,openSharePreparedMessageModal:m}=(0,n.ko)(),u=(0,Fi.A)(),p=Boolean(e),{webAppKey:v,message:g,botId:A}=e||{},f=(0,s.li)(),b=(0,Pl.A)(t,a),C=(0,T.A)(()=>{v&&A&&g&&(m({webAppKey:v,message:g}),d())}),y=(0,T.A)(()=>{d(),v&&h({webAppKey:v,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})}),S=(0,s.Kr)(()=>{if(e)return(0,se.FD)("div",{className:"P1fPh6h8",children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:u("Close"),onClick:y,iconName:"close"}),(0,se.Y)("h3",{className:(0,ge.A)("modal-title","E42tgAwD"),children:u("BotShareMessage")})]})},[u,e]),N=(0,s.Kr)(()=>{if(A&&g&&v)return(0,l.i7)(A,g)},[A,g,v]),k=(0,ge.A)("_6w75ldP","lElCwweL",a&&"CZkpv8n0",r&&"VJAYrDF_",a&&i&&"m8xzfVvU");return(0,se.FD)(te.A,{dialogRef:f,isOpen:p,header:S,onClose:y,className:"Rzj2LMLf",contentClassName:"Ve4u2KVI",children:[(0,se.FD)("div",{className:(0,ge.A)("McJgXCtB","MessageList"),inert:!0,style:(0,tt.A)(`--pattern-color: ${o}`,r&&`--theme-background-color: ${r}`),children:[(0,se.Y)("div",{className:k,style:b?`--custom-background: ${b}`:void 0}),N&&(0,se.Y)(Yl.A,{message:N,threadId:G.l3,messageListType:"thread",noComments:!0,noReplies:!0,appearanceOrder:0,isJustAdded:!1,isFirstInGroup:!0,isLastInGroup:!0,isLastInList:!1,isFirstInDocumentGroup:!1,isLastInDocumentGroup:!1},A)]}),(0,se.FD)("div",{className:"pNSCKAVN",children:[(0,se.Y)("p",{className:"xWnXsG7q",children:u("WebAppShareMessageInfo",{user:(0,l.Yg)(c)})}),(0,se.Y)(X.A,{onClick:C,children:u("BotShareMessageShare")})]})]})}));var Dl=i(20247),Ml=i(48227);const Tl=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.nTw)(e),{isPaymentMessageConfirmDialogOpen:i}=t;return{isPaymentMessageConfirmDialogOpen:i,starsBalance:e.stars?.balance.amount||0,isStarsBalanceModalOpen:Boolean(t.starsBalanceModal)}})(({modal:e,isPaymentMessageConfirmDialogOpen:t,isStarsBalanceModalOpen:i,starsBalance:o})=>{const{closeSharePreparedMessageModal:a,sendInlineBotResult:r,sendWebAppEvent:l,showNotification:d,updateSharePreparedMessageModalSendArgs:h}=(0,n.ko)(),m=(0,B.A)(),u=Boolean(e),[p,v,g]=(0,D.A)();(0,s.vJ)(()=>{u&&v()},[u,v]);const{message:A,filter:f,webAppKey:b,pendingSendArgs:C}=e||{},{starsForSendMessage:y}=C||{},{closeConfirmDialog:S,dialogHandler:N,shouldAutoApprove:k,setAutoApprove:w,handleWithConfirmation:I}=(0,Dl.A)(y||0,i,o),P=(0,T.A)(()=>{a(),b&&l({webAppKey:b,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})}),Y=(0,T.A)((e,t)=>{if(A&&b){const i=(0,n.mS)(),s=(0,c.PVB)(i,e);r({chatId:e,threadId:t||G.l3,id:A.result.id,queryId:A.result.queryId}),y||d({message:m("BotSharedToOne",(0,It.F9)(m,s))}),l({webAppKey:b,event:{eventType:"prepared_message_sent"}}),a(),h({args:void 0})}}),F=(0,T.A)((e,t)=>{h({args:{peerId:e,threadId:t}})}),M=(0,T.A)(()=>{C&&I(Y,C.peerId,C.threadId)}),L=(0,T.A)(()=>{S(),h({args:void 0})});(0,s.vJ)(()=>{C&&M()},[C]);const R=(0,n.mS)(),x=C?(0,c.PVB)(R,C.peerId):void 0,E=x?(0,It.F9)(m,x):void 0;if(u||p)return(0,se.FD)(se.FK,{children:[(0,se.Y)(Vs,{isOpen:u,searchPlaceholder:m("Search"),filter:f,onSelectRecipient:F,onClose:P,onCloseAnimationEnd:g,isLowStackPriority:!0}),(0,se.Y)(Ml.A,{isOpen:t,onClose:L,userName:E,messagePriceInStars:y||0,messagesCount:1,shouldAutoApprove:k,setAutoApprove:w,confirmHandler:N})]})}));var Bl=i(19408);const Ll={content:"iGABsB4C",modalHeader:"Ofq4u4pq",section:"k44LZ99u",form:"VhNBPaMY",label:"anDcU5bi",input:"kYxuUcwe",description:"A_JjwhXv",timeInputIcon:"pHne2E6K",offerButton:"d_PCM2tC",currencySelector:"genSNudF",currencyIcon:"fT5aRs0H"},Rl=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=e.stars?.balance,s=t?(0,c.PVB)(e,t.chatId):void 0,n=t?(0,Bl.GA)(e,t.chatId,G.l3):void 0,{appConfig:o}=e,a=o.starsSuggestedPostAmountMax,r=o.starsSuggestedPostAmountMin,l=o.starsSuggestedPostAgeMin,d=o.starsSuggestedPostFutureMin,h=o.starsSuggestedPostFutureMax,m=o.tonSuggestedPostAmountMax,u=o.tonSuggestedPostAmountMin,p=!!t&&(0,c.ODG)(e,t.chatId);return{peer:s,starBalance:i,tonBalance:e.ton?.balance?.amount,currentDraft:n,maxStarsAmount:a,minStarsAmount:r,tonMaxAmount:m,tonMinAmount:u,ageMinSeconds:l,futureMin:d,futureMax:h,isMonoforumAdmin:p}})(({modal:e,starBalance:t,tonBalance:i,peer:o,currentDraft:r,maxStarsAmount:l,minStarsAmount:c,tonMaxAmount:d,tonMinAmount:h,ageMinSeconds:m,futureMin:u,futureMax:p,isMonoforumAdmin:v})=>{const{closeSuggestMessageModal:g,updateDraftSuggestedPostInfo:A,openStarsBalanceModal:f}=(0,n.ko)(),[b,C,y]=(0,D.A)(),S=r?.suggestedPostInfo,N=r?.replyInfo,k=Boolean(N),[w,I]=(0,s.J0)(S?.price?.amount||void 0),[P,Y]=(0,s.J0)(S?.price?.currency||a.OUy),[F,M]=(0,s.J0)(S?.scheduleDate?1e3*S.scheduleDate:void 0);(0,s.vJ)(()=>{const e=S?.price,t=e?.currency===a.ykW?(0,oo.wD)(e.amount):e?.amount;I(t),Y(S?.price?.currency||a.OUy),M(S?.scheduleDate?1e3*S.scheduleDate:void 0)},[S]);const L=(0,Fi.A)(),R=(0,B.A)(),x=P===a.OUy,E=Math.floor(Date.now()/1e3),V=1e3*(E+u),_=1e3*(E+p),U=1e3*(E+2*u),O=(0,T.A)(e=>{const t=e.target.value,i=parseFloat(t),s=""===t||Number.isNaN(i)?void 0:Math.min(Math.max(i,0),j);I(s)}),K=(0,T.A)(e=>{M(e.getTime()),y()}),J=(0,T.A)(()=>{M(void 0),y()}),G=x?c:(0,oo.wD)(h),j=x?l:(0,oo.wD)(d),z=Boolean(w)&&w<G,H=(0,T.A)(()=>{const e=w?x?w:(0,oo.tT)(w):0;if(!z){if(!v)if(x){if(e>(t?.amount||0))return void f({topup:{balanceNeeded:e}})}else if(e>(i||0))return void f({currency:a.ykW});A({price:{currency:P,amount:e,nanos:0},scheduleDate:F?Math.max(F/1e3,(0,Ii.Fm)()+u+60):void 0}),g()}});return(0,se.Y)(te.A,{headerClassName:Ll.modalHeader,isOpen:Boolean(e),onClose:g,isSlim:!0,isLowStackPriority:!0,hasCloseButton:!0,contentClassName:Ll.content,title:L(k?"TitleSuggestedChanges":"TitleSuggestMessage"),children:(0,se.FD)("div",{className:Ll.form,children:[(0,se.FD)("div",{className:Ll.section,children:[(0,se.FD)("div",{className:Ll.currencySelector,children:[(0,se.FD)(X.A,{className:Ll.currencyButton,color:x?"primary":"translucent",pill:!0,fluid:!0,size:"tiny",noFastClick:!0,onClick:()=>Y(a.OUy),children:[(0,se.Y)(he.A,{name:"star",className:Ll.currencyIcon}),L("CurrencyStars")]}),(0,se.FD)(X.A,{className:Ll.currencyButton,fluid:!0,color:x?"translucent":"primary",pill:!0,size:"tiny",noFastClick:!0,onClick:()=>Y(a.ykW),children:[(0,se.Y)(he.A,{name:"toncoin",className:Ll.currencyIcon}),L("CurrencyTon")]})]}),(0,se.Y)(ee.A,{label:L("InputPlaceholderPrice"),className:(0,ge.A)(Ll.input),value:w?.toString(),onChange:O,inputMode:"numeric",tabIndex:0,teactExperimentControlled:x}),(0,se.Y)("div",{className:Ll.description,children:void 0!==w&&w>0&&w<G?L("DescriptionSuggestedPostMinimumOffer",{amount:x?(0,wi.Kk)(L,G):(0,wi.QH)(L,G)},{withNodes:!0,withMarkdown:!0}):L(x?"SuggestMessagePriceDescriptionStars":"SuggestMessagePriceDescriptionTon")})]}),(0,se.FD)("div",{className:Ll.section,children:[(0,se.FD)("div",{className:(0,ge.A)(Ll.input,"input-group","touched"),children:[(0,se.Y)("input",{type:"text",className:(0,ge.A)("form-control",b&&"focus"),value:F?(0,We.e0)(F/1e3,L,R):L("SuggestMessageAnytime"),autoComplete:"off",onClick:C,onFocus:C,readOnly:!0}),(0,se.Y)("label",{children:L("InputTitleSuggestMessageTime")}),(0,se.Y)(he.A,{name:"down",className:Ll.timeInputIcon})]}),(0,se.Y)("div",{className:Ll.description,children:L("SuggestMessageTimeDescription",{hint:L("SuggestMessageDateTimeHint"),duration:(0,We.A$)(L,m,!0)})})]}),(0,se.Y)(sn,{isOpen:b,isFutureMode:!0,withTimePicker:!0,minAt:V,maxAt:_,onClose:y,onSubmit:K,selectedAt:F||U,submitButtonLabel:L("Save"),secondButtonLabel:L("SuggestMessageAnytime"),onSecondButtonClick:J,description:L("SuggestMessageDateTimeHint")}),(0,se.Y)(X.A,{className:Ll.offerButton,onClick:H,disabled:z,children:k?L("ButtonUpdateTerms"):w?L("ButtonOfferAmount",{amount:x?(0,wi.U2)(L,w,{asFont:!0}):(0,wi.Ms)(L,w)},{withNodes:!0,withMarkdown:!0}):L("ButtonOfferFree")})]})})})),xl="xqyFGV8R",El=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=t&&(0,c.O5q)(e,t.chatId,t.messageId),s=i?(0,c.Y7C)(e,i):void 0,n=t&&(0,c.ODG)(e,t.chatId),{appConfig:o}=e,a=o.starsSuggestedPostCommissionPermille,r=o.tonSuggestedPostCommissionPermille,l=o.starsSuggestedPostAgeMin,d=o.starsSuggestedPostFutureMin,h=o.starsSuggestedPostFutureMax,m=i?.suggestedPostInfo?.scheduleDate;return{minAge:l,futureMin:d,futureMax:h,message:i,sender:s,isAdmin:n,commissionPermille:a,tonCommissionPermille:r,scheduleDate:m}})(({modal:e,message:t,sender:i,isAdmin:o,commissionPermille:r,tonCommissionPermille:l,minAge:c,futureMin:d,futureMax:h,scheduleDate:m})=>{const{closeSuggestedPostApprovalModal:u,approveSuggestedPost:p}=(0,n.ko)(),v=(0,Fi.A)(),g=(0,B.A)(),[A,f,b]=(0,D.A)(),C=Math.floor(Date.now()/1e3),y=1e3*(C+d),S=1e3*(C+h),N=C+2*d,[k,w]=(0,s.J0)(N),I=(0,T.A)(()=>{u()}),P=(0,T.A)(t=>{e&&(p({chatId:e.chatId,messageId:e.messageId,scheduleDate:t}),u())}),Y=(0,T.A)(e=>{const t=Math.floor(e.getTime()/1e3);w(t)}),F=(0,T.A)(e=>{const t=Math.floor(e.getTime()/1e3);b(),P(t)}),M=(0,T.A)(()=>{b(),P()}),L=(0,T.A)(()=>{m?P(m):f()});if(!e||!t)return;const R=i?(0,It.em)(g,i):"";return(0,se.FD)(se.FK,{children:[(0,se.Y)(oi.A,{isOpen:Boolean(e)&&!A,onClose:I,title:v("SuggestedPostConfirmTitle"),confirmHandler:L,confirmLabel:v(m?"ButtonPublish":"Next"),children:(()=>{const e=t?.suggestedPostInfo?.price,i=e?.amount,s=e?.currency||a.OUy,n=v("SuggestedPostConfirmMessage",{peer:R},{withNodes:!0,withMarkdown:!0}),d=(0,Pt.A)(n);if(!i)return d;const h=(s===a.ykW?l:r)/10,u=i/100*h,p=s===a.ykW?(0,wi.QH)(v,(0,oo.wD)(u)):(0,wi.Kk)(v,u),A=c,f=(0,We.A$)(v,A,!0);if(m){const e=(0,We.e0)(m,v,g),t=o?"SuggestedPostConfirmDetailsWithTimeAdmin":"SuggestedPostConfirmDetailsWithTimeUser";return(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{children:d}),(0,se.Y)("div",{className:xl,children:(0,Pt.A)(v(t,{amount:p,commission:h,duration:f,time:e},{withNodes:!0,withMarkdown:!0}))})]})}const b=o?"SuggestedPostConfirmDetailsAdmin":"SuggestedPostConfirmDetailsUser";return(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{children:d}),(0,se.Y)("div",{className:xl,children:(0,Pt.A)(v(b,{amount:p,commission:h,duration:f},{withNodes:!0,withMarkdown:!0}))})]})})()}),(0,se.Y)(sn,{isOpen:A,isFutureMode:!0,withTimePicker:!0,minAt:y,maxAt:S,onClose:b,onSubmit:F,onDateChange:Y,selectedAt:1e3*k,submitButtonLabel:v("ButtonPublishAtTime",{time:(0,We.e0)(k,v,g)}),secondButtonLabel:v("PublishNow"),onSecondButtonClick:M,description:v("SuggestMessageDateTimeHint")})]})})),Vl=["embedLinks","sendPolls","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs","sendStickers","sendGifs"],_l=[...Vl,"sendPlain"];function Ul(e){const[t,i]=(0,s.J0)({}),[n,o]=(0,s.J0)(!1),[a,r]=(0,s.J0)(!1);(0,s.vJ)(()=>{i(e||{}),o(!1),setTimeout(()=>{r(!1)},250)},[e]);const l=(0,s.hb)(s=>{const{name:n}=s.target,a=n;function r(e){return!e||void 0}const l=t;let c={...l,[a]:r(l[a]),..."sendStickers"===a&&{sendGifs:r(l[a])}};const d=()=>{const e=Vl.map(e=>c[e]);e.some(e=>!e)?c={...c,sendMedia:void 0}:e.every(Boolean)&&(c={...c,sendMedia:!0})};"sendMedia"!==a?d():c={...c,...Vl.reduce((e,t)=>Object.assign(e,{[t]:c.sendMedia}),{})},"embedLinks"!==a&&!c.embedLinks&&c.sendPlain&&(c={...c,embedLinks:!0}),"sendPlain"!==a&&!c.embedLinks&&c.sendPlain&&(c={...c,sendPlain:void 0}),"sendMedia"!==a&&d();const h=_l.every(e=>c[e]);c={...c,sendMessages:!!h||void 0},i(c),o(!e||Object.keys(c).some(t=>{const i=t;return Boolean(e[i])!==Boolean(c[i])}))},[e,t]),c=(0,s.hb)(()=>{i(e||{}),o(!1)},[e]);return{permissions:t,isLoading:a,havePermissionChanged:n,handlePermissionChange:l,setIsLoading:r,resetPermissions:c}}const Ol=["sendPhotos","sendVideos","sendStickers","sendAudios","sendDocs","sendVoices","sendRoundvideos","embedLinks","sendPolls"],Kl=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=t?(0,c.hds)(e,t):void 0,s=i&&(0,c.AWZ)(e,i.id);return{chat:i,hasLinkedChat:Boolean(s?.linkedChatId)}})(({chat:e,isMediaDropdownOpen:t,hasLinkedChat:i,permissions:o,className:a,shiftedClassName:r,dropdownClassName:c,withCheckbox:d,permissionGroup:h,setIsMediaDropdownOpen:m,handlePermissionChange:u,getControlIsDisabled:p})=>{const{showNotification:v}=(0,n.ko)(),{isForum:g}=e||{},A=(0,Fi.A)(),f=(0,s.Kr)(()=>e&&(0,l.gA)(e),[e]),b=i||f,C=(0,s.Kr)(()=>Ol.reduce((e,t)=>(o[t]||(e+=1),e),0),[o]),S=(0,T.A)(e=>{(0,y.A)(e),m(!t)}),N=(0,T.A)(()=>{v({message:A("ChatPermissionNotAvailable")})});return(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendPlain",checked:!o.sendPlain,label:A("UserRestrictionsSend"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendPlain")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendMedia",checked:!o.sendMedia,label:A("UserRestrictionsSendMedia"),labelText:`${C}/${Ol.length}`,blocking:!0,permissionGroup:h,rightIcon:t?"up":"down",onChange:u,onClickLabel:S,disabled:p&&p("sendMedia")})}),(0,se.Y)("div",{className:c,children:(0,se.FD)("div",{className:a,children:[(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendPhotos",checked:!o.sendPhotos,label:A("SendMediaPermissionPhotos"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendPhotos")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendVideos",checked:!o.sendVideos,label:A("SendMediaPermissionVideos"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendVideos")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendStickers",checked:!o.sendStickers&&!o.sendGifs,label:A("SendMediaPermissionStickersGifs"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendStickers")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendAudios",checked:!o.sendAudios,label:A("SendMediaPermissionAudios"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendAudios")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendDocs",checked:!o.sendDocs,label:A("SendMediaPermissionFiles"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendDocs")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendVoices",checked:!o.sendVoices,label:A("SendMediaPermissionVoices"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendVoices")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendRoundvideos",checked:!o.sendRoundvideos,label:A("SendMediaPermissionRoundVideos"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendRoundvideos")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"embedLinks",checked:!o.embedLinks,label:A("SendMediaPermissionWebPages"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("embedLinks")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"sendPolls",checked:!o.sendPolls,label:A("SendMediaPermissionPolls"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("sendPolls")})})]})}),(0,se.FD)("div",{className:r,children:[(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"inviteUsers",checked:!o.inviteUsers,label:A("UserRestrictionsInviteUsers"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("inviteUsers")})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),onClick:b?N:void 0,children:(0,se.Y)(Hs.A,{name:"pinMessages",checked:!o.pinMessages,label:A("UserRestrictionsPinMessages"),disabled:p?p("pinMessages"):b,blocking:!0,permissionGroup:h,onChange:u})}),(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),onClick:b?N:void 0,children:(0,se.Y)(Hs.A,{name:"changeInfo",checked:!o.changeInfo,label:A("UserRestrictionsChangeInfo"),blocking:!0,permissionGroup:h,disabled:p?p("changeInfo"):b,onChange:u})}),g&&(0,se.Y)("div",{className:(0,ge.A)("ListItem",d&&"with-checkbox"),children:(0,se.Y)(Hs.A,{name:"manageTopics",checked:!o.manageTopics,label:A("UserRestrictionsCreateTopics"),blocking:!0,permissionGroup:h,onChange:u,disabled:p&&p("manageTopics")})})]})]})}));var Jl=i(77561);const Gl="yGhFKTl5",jl="goI3MITH",zl=(0,s.ph)((0,n.EK)(e=>{const{deleteMessageModal:t}=(0,c.nTw)(e),i=t?.messageIds,s=t?.chatId,{canDeleteForAll:n}=(0,c.jyG)(e,i),o=s?(0,c.hds)(e,s):void 0,a=o&&(0,c.AWZ)(e,o.id),r=a?.linkedChatId,d=Boolean(o)&&(0,l.WX)(o),h=Boolean(o)&&(0,l.Vs)(o),m=t?.isSchedule,u=t?.onConfirm,p=o&&(0,v.L8)(o.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(o))):void 0,g=Boolean(o&&!(0,l.DX)(o.id)&&(0,c.yps)(e,o.id)),A=a?.adminMembersById,f=o&&(0,l.ub)(o,"banUsers")&&!o.isMonoforum,b=o?.isCreator,C=o?(0,c.ALW)(e,o):void 0,y=o&&(0,l.yn)(o)&&!n||C,S=o&&((0,l.Vs)(o)||d);return{chat:o,isChannel:d,isSuperGroup:h,messageIds:i,currentUserId:e.currentUserId,canDeleteForAll:!m&&n,contactName:p,willDeleteForCurrentUserOnly:y,willDeleteForAll:S,adminMembersById:A,chatBot:g,canBanUsers:f,linkedChatId:r,isSchedule:m,isCreator:b,onConfirm:u}})(({isOpen:e,chat:t,isChannel:i,isSuperGroup:o,isSchedule:a,currentUserId:r,messageIds:l,isCreator:d,canDeleteForAll:h,contactName:m,willDeleteForCurrentUserOnly:u,willDeleteForAll:p,chatBot:v,adminMembersById:g,canBanUsers:A,linkedChatId:f,onConfirm:b})=>{const{closeDeleteMessageModal:C,deleteMessages:y,reportChannelSpam:S,deleteChatMember:N,deleteScheduledMessages:k,exitMessageSelectMode:w,updateChatMemberBannedRights:I,deleteParticipantHistory:P}=(0,n.ko)(),Y=(0,K.A)(e),F=(0,B.A)(),D=(0,Fi.A)(),{permissions:M,havePermissionChanged:L,handlePermissionChange:R,resetPermissions:x}=Ul(t?.defaultBannedRights),[E,V]=(0,s.J0)([]),[_,U]=(0,s.J0)([]),[O,J]=(0,s.J0)([]),[G,j]=(0,s.J0)(!1),[z,H]=(0,s.J0)(!1),[$,q]=(0,s.J0)(!0),W=(0,s.Kr)(()=>{if(i||!l||!t)return hi.p;const e=(0,n.mS)(),s=(0,c.SpN)(e,t.id,l);return s?(0,di.Am)(s).filter(e=>e?.id!==t?.id&&e?.id!==f&&e?.id!==t?.linkedMonoforumId):hi.p},[t,i,f,l]),Q=(0,T.A)(()=>W.map(e=>({value:e.id,label:(0,It.F9)(D,e)||"",leftElement:(0,se.Y)(Yt.A,{size:"small",peer:e})}))),Z=(0,s.Kr)(()=>W.filter(e=>e.id!==f&&e.id!==t?.linkedMonoforumId&&e.id!==r),[W,r,f,t?.linkedMonoforumId]),ee=(0,s.Kr)(()=>W.filter(e=>e.id!==r&&e.id!==f&&e.id!==t?.linkedMonoforumId),[W,r,f,t?.linkedMonoforumId]),ie=(0,s.Kr)(()=>{const e=W.some(e=>e.id===r);return!A||e?hi.p:W.filter(e=>{const t=g?.[e.id];return d||!t})},[W,d,r,A,g]),ne=(0,s.Kr)(()=>Boolean(Z.length||ee.length||ie.length),[Z,ee,ie])&&!h&&!a&&o,oe=(0,s.Kr)(()=>!W||a?{}:(0,di.pA)(W,e=>[e.id,(0,It.F9)(D,e)]),[a,D,W]),ae=(0,s.Kr)(()=>[{value:l&&W.length>=2?"spam":W?.[0]?.id,label:F("ReportSpamTitle"),nestedOptions:l&&W.length>=2?[...Q().filter(e=>e.value!==f&&e.value!==t?.linkedMonoforumId&&e.value!==r)]:void 0}],[l,W,F,f,t?.linkedMonoforumId,r]),re=(0,s.Kr)(()=>[{value:l&&W.length>=2?"delete_all":W?.[0]?.id,label:l&&W.length>=2?F("DeleteAllFromUsers"):F("DeleteAllFrom",Object.values(oe)[0]),nestedOptions:l&&W.length>=2?[...Q().filter(e=>e.value!==f&&e.value!==t?.linkedMonoforumId&&e.value!==r)]:void 0}],[l,W,F,oe,f,t?.linkedMonoforumId,r]),le=(0,s.Kr)(()=>[{value:l&&W.length>=2?"ban":W?.[0]?.id,label:l&&W.length>=2?F(z?"DeleteRestrictUsers":"DeleteBanUsers"):z?F("KickFromSupergroup"):F("DeleteBan",Object.values(oe)[0]),nestedOptions:l&&W.length>=2?[...Q()]:void 0}],[z,F,l,W,oe]),ce=(0,T.A)(()=>{H(e=>!e)}),de=(0,T.A)((e,i)=>{if(!t)return hi.p;const s=(0,n.mS)();return i.filter(i=>{const n=(0,c.LM$)(s,t.id,i);return n&&e.includes(n.id)})}),me=(0,T.A)(e=>{Object.entries(e).forEach(([e,i])=>{i.length&&S({participantId:e,chatId:t.id,messageIds:i})})}),ue=(0,T.A)(e=>{y({messageIds:e,shouldDeleteForAll:!0})}),pe=(0,T.A)(e=>{t&&e.forEach(e=>{P({peerId:e,chatId:t.id})})}),ve=(0,T.A)(e=>{e.forEach(e=>{N({chatId:t.id,userId:e})})}),Ae=(0,T.A)(e=>{e.forEach(e=>{I({chatId:t.id,userId:e,bannedRights:M})})}),fe=(0,T.A)(()=>{if(t&&l){if(b?.(),a)k({messageIds:l});else if(ne){if(O?.length){const e=(0,n.mS)(),i=O.filter(e=>!Number.isNaN(Number(e))),s=l.reduce((s,n)=>{const o=(0,c.LM$)(e,t.id,n);return o&&i.includes(o.id)&&(s[o.id]||(s[o.id]=[]),s[o.id].push(Number(n))),s},{});me(s)}if(E?.length){const e=E.filter(e=>!Number.isNaN(Number(e)));pe(e)}if(_?.length&&!L){const e=_.filter(e=>!Number.isNaN(Number(e)));ve(e);const t=de(e,l);ue(t)}if(_?.length&&L){const e=_.filter(e=>!Number.isNaN(Number(e)));Ae(e)}O?.length&&E?.length&&_?.length||y({messageIds:l,shouldDeleteForAll:$})}else y({messageIds:l,shouldDeleteForAll:$});C(),w()}}),be=(0,T.A)(()=>{C()});return(0,s.vJ)(()=>{!e&&Y&&(J([]),V([]),U([]),q(!0),j(!1),H(!1),x())},[e,Y,x]),(0,se.Y)(te.A,{isOpen:e,onClose:be,onEnter:fe,className:"SeaF_shb",children:(0,se.FD)("div",{className:"_YNfwDqt",children:[(0,se.FD)("div",{className:ne&&"axa67kqo",dir:D.isRtl?"rtl":void 0,children:[ne&&(0,se.Y)(qi.A,{size:"small",peers:W}),(0,se.Y)("h3",{className:(0,ge.A)(ne?"U4IFhV0a":"qd6OFHiG"),children:F("Chat.DeleteMessagesConfirmation",l?.length)})]}),ne&&(0,se.FD)(se.FK,{children:[(0,se.Y)("p",{className:Gl,children:F("DeleteAdditionalActions")}),(0,se.FD)("div",{className:"b6847Kh3",children:[(0,se.Y)(Jl.A,{options:ae,onChange:J,selected:O,nestedCheckbox:l&&W.length>=2}),Z?.length>0&&(0,se.Y)(Jl.A,{options:re,onChange:V,selected:E,nestedCheckbox:l&&W.length>=2}),ie?.length>0&&(0,se.Y)(Jl.A,{options:le,onChange:U,selected:_,nestedCheckbox:l&&W.length>=2})]}),(0,se.FD)("div",{className:(0,ge.A)("iv0u9Zw6",z&&"qCQftA04"),children:[(0,se.Y)("h3",{className:(0,ge.A)(Gl,"t3KOsBfm"),children:F("UserRestrictionsCanDoUsers",W.length)}),(0,se.Y)(Kl,{withCheckbox:!0,chatId:t?.id,isMediaDropdownOpen:G,setIsMediaDropdownOpen:j,handlePermissionChange:R,permissions:M,className:(0,ge.A)("czTjjKim",G&&"Ifpyv7Jp")})]}),_?.length&&A?(0,se.FD)(li.A,{narrow:!0,buttonClassName:jl,onClick:ce,children:[F(z?"DeleteToggleBanUsers":"DeleteToggleRestrictUsers"),(0,se.Y)(he.A,{name:z?"up":"down",className:(0,ge.A)(jl,"ml-2")})]}):H(!1)]}),(h||v||!ne)&&(0,se.FD)(se.FK,{children:[(0,se.Y)("p",{children:l&&l.length>1?D("AreYouSureDeleteFewMessages"):D("AreYouSureDeleteSingleMessage")}),u&&(0,se.Y)("p",{children:F("lng_delete_for_me_chat_hint",1,"i")}),p&&(0,se.Y)("p",{children:F("lng_delete_for_everyone_hint",1,"i")})]}),h&&(0,se.Y)(Hs.A,{className:"dialog-checkbox",label:m?(0,Pt.A)(F("DeleteMessagesOptionAlso",m)):F("Conversation.DeleteMessagesForEveryone"),checked:$,onCheck:q}),(0,se.FD)("div",{className:(0,ge.A)("dialog-buttons",G?"JTT_DIRv":"L4YzeG91"),children:[(0,se.Y)(X.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:fe,children:ne?F("DeleteProceedBtn"):D("Delete")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:be,children:F("Cancel")})]})]})})})),Hl=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,v.L8)(t),s=(0,c.nZ4)(e,t),n=(0,c.hds)(e,t),o=Boolean(n)&&(0,l.WX)(n),a=Boolean(n)&&(0,l.yn)(n),r=Boolean(n)&&(0,l.Vs)(n);return{isPrivateChat:i,isChatWithSelf:s,isChannel:o,isGroup:a,isSuperGroup:r,canPinForAll:i&&!s||r||a,contactName:n&&(0,v.L8)(n.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(n))):void 0}})(({isOpen:e,chatId:t,messageId:i,isChannel:o,isGroup:a,isSuperGroup:r,canPinForAll:l,contactName:c,onClose:d})=>{const{pinMessage:h}=(0,n.ko)(),[m,u]=(0,s.J0)(!0),p=(0,T.A)(()=>{h({chatId:t,messageId:i,isUnpin:!1,isOneSide:!m,isSilent:!m}),d()}),v=(0,B.A)();return(0,se.FD)(te.A,{isOpen:e,onClose:d,className:"pin",title:v("PinMessageAlertTitle"),children:[(0,se.Y)("p",{children:v(o?"PinMessageAlertChannel":a||r?"PinMessageAlert":"PinMessageAlertChat")}),l&&(0,se.Y)(Hs.A,{className:"dialog-checkbox",label:c?(0,Pt.A)(v("Conversation.PinMessagesFor",c)):v("Conversation.PinMessageAlert.PinAndNotifyMembers"),checked:m,onCheck:u}),(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:p,children:v("DialogPin")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:v("Cancel")})]})]})})),$l=(0,s.ph)(({isOpen:e,pinnedMessagesCount:t=0,onClose:i,onUnpin:s})=>{const n=(0,B.A)();return(0,se.FD)(te.A,{isOpen:e,onClose:i,className:"unpin-all",title:n("Chat.PanelUnpinAllMessages"),children:[(0,se.Y)("p",{children:n("Chat.UnpinAllMessagesConfirmation",t,"i")}),(0,se.FD)("div",{className:"dialog-buttons mt-2",children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:s,children:n("DialogUnpin")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:i,children:n("Cancel")})]})]})});var ql=i(2178);const Wl=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.nTw)(e),{shouldWarnAboutFiles:i}=(0,ks.lS)(e),s=(0,c.meB)(e),{type:n,chatId:o}=(0,c.Xf0)(e)||{},a="scheduled"===n,{canDelete:r}=(0,c.jyG)(e),l=Boolean(!a&&(0,c.mDG)(e)),d=(0,c.ori)(e),{messageIds:h}=t.selectedMessages||{},m=!!o&&(0,c.o45)(e,o,h),u=!(a||!o)&&(0,c.Y8y)(e,o,h),p=!(!h||!o)&&(0,c.h5w)(e,o,h),v=t.isShareMessageModalShown,g=Boolean(v||t.requestedDraft||t.requestedAttachBotInChat||t.requestedAttachBotInstall||t.reportModal||t.deleteMessageModal);return{chat:s,isSchedule:a,selectedMessagesCount:(0,c.ZZ2)(e),canDeleteMessages:r,canReportMessages:l,canDownloadMessages:d,canForwardMessages:u,selectedMessageIds:h,hasProtectedMessage:m,isAnyModalOpen:g,shouldWarnAboutFiles:i,hasIpRevealingMedia:p}})(({chat:e,canPost:t,isActive:i,messageListType:o,isSchedule:a,selectedMessagesCount:r,canDeleteMessages:l,canReportMessages:c,canDownloadMessages:d,canForwardMessages:h,hasProtectedMessage:m,isAnyModalOpen:u,selectedMessageIds:p,shouldWarnAboutFiles:v,hasIpRevealingMedia:g})=>{const{exitMessageSelectMode:A,openForwardMenuForSelectedMessages:f,downloadSelectedMessages:b,copySelectedMessages:C,showNotification:y,reportMessages:S,openDeleteMessageModal:N,setSharedSettingOption:k}=(0,n.ko)(),w=(0,B.A)();(e=>{function t(e){e.preventDefault(),(0,n.ko)().copySelectedMessages()}(0,ql.v)((0,s.Kr)(()=>e?{"Mod+C":t}:void 0,[e]))})(i);const[I,P,Y]=(0,D.A)(),[F,M]=(0,s.J0)(!1),L=(0,T.A)(()=>{A()}),R=(0,T.A)(()=>{p&&e&&N({chatId:e.id,messageIds:p,isSchedule:a})});(0,s.vJ)(()=>i&&!u?(0,Ni.A)({onBackspace:l?R:void 0,onDelete:l?R:void 0,onEsc:L}):void 0,[i,R,L,u,l]);const x=(0,T.A)(()=>{C(),y({message:w("Share.Link.Copied")}),A()}),E=(0,T.A)(()=>{b(),A()}),V=(0,T.A)(()=>{v&&g?P():E()}),_=(0,T.A)(()=>{k({shouldWarnAboutFiles:!F}),Y(),E()}),U=(0,K.A)(r||void 0,!0),O=w("VoiceOver.Chat.MessagesSelected",i?r:U,"i"),J=(0,T.A)(()=>{p&&e&&(S({chatId:e.id,messageIds:p}),A())}),G=(0,ge.A)("MessageSelectToolbar",t&&"with-composer",i&&"shown"),j=(e,t,i,s)=>(0,se.Y)("div",{role:"button",tabIndex:0,className:(0,ge.A)("div-button","item",s&&"destructive"),onClick:i,title:t,"aria-label":t,children:(0,se.Y)(he.A,{name:e})});return(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{className:G,children:(0,se.FD)("div",{className:"MessageSelectToolbar-inner",children:[(0,se.Y)(X.A,{color:"translucent",round:!0,onClick:L,ariaLabel:"Exit select mode",iconName:"close"}),(0,se.Y)("span",{className:"MessageSelectToolbar-count",title:O,children:O}),Boolean(r)&&(0,se.FD)("div",{className:"MessageSelectToolbar-actions",children:["scheduled"!==o&&h&&j("forward",w("Chat.ForwardActionHeader"),f),c&&j("flag",w("Conversation.ReportMessages"),J),d&&!m&&j("download",w("lng_media_download"),V),!m&&j("copy",w("lng_context_copy_selected_items"),x),l&&j("delete",w("EditAdminGroupDeleteMessages"),R,!0)]})]})}),(0,se.FD)(oi.A,{isOpen:I,onClose:Y,confirmHandler:_,children:[w("lng_launch_svg_warning"),(0,se.Y)(Hs.A,{className:"dialog-checkbox",checked:F,label:w("lng_launch_exe_dont_ask"),onCheck:M})]})]})})),Ql=(0,s.ph)((0,n.EK)(e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).seenByModal||{};return t&&i?{seenByDates:(0,c.O5q)(e,t,i)?.seenByDates}:{seenByDates:void 0}})(function({isOpen:e,seenByDates:t}){const{openChat:i,closeSeenByModal:o}=(0,n.ko)(),a=(0,B.A)(),r=(0,Si.A)(t,!0),l=(0,s.Kr)(()=>{if(!r)return;const e=Object.keys(r);return e.sort((e,t)=>r[t]-r[e]),e},[r]),c=(0,T.A)(e=>{o(),setTimeout(()=>{i({id:e})},100)}),d=(0,T.A)(()=>{o()});return(0,se.FD)(te.A,{isOpen:e,onClose:o,className:(0,ge.A)("slqA9gR2","narrow"),title:`Seen by ${l?.length} users`,children:[(0,se.Y)("div",{dir:a.isRtl?"rtl":void 0,children:l&&l.map(e=>(0,se.Y)(li.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>c(e),children:(0,se.Y)(ms.A,{userId:e,noStatusOrTyping:!0,status:(0,We.U)(a,1e3*r[e]),statusIcon:"message-read"})},e))}),(0,se.Y)("div",{className:"dialog-buttons mt-2",children:(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:a("Close")})})]})}));var Zl=i(32581);const Xl="MQxuEIRA",ec="AEAN1Au4",tc="F7owtTHj",ic=te.U+a.xB5,sc=(0,s.ph)((0,n.EK)(e=>{const{chatId:t,isReadDate:i}=(0,c.nTw)(e).privacySettingsNoticeModal||{};return{user:t?(0,c.mBe)(e,t):void 0,isReadDate:i}})(({isOpen:e,isReadDate:t,user:i})=>{const{updateGlobalPrivacySettings:s,openPremiumModal:o,closePrivacySettingsNoticeModal:a,showNotification:r,setPrivacyVisibility:c,loadUser:d}=(0,n.ko)(),h=(0,B.A)(),m=(0,Fi.A)(),u=(0,l.u0)(i),p=(0,T.A)(()=>{s({shouldHideReadMarks:!1}),a(),setTimeout(()=>{r({message:h("PremiumReadSet")})},ic)}),v=(0,T.A)(()=>{c({privacyKey:"lastSeen",visibility:"everybody",onSuccess:()=>d({userId:i.id})}),a(),setTimeout(()=>{r({message:h("PremiumLastSeenSet")})},ic)}),g=(0,T.A)(()=>{a(),setTimeout(()=>{o({initialSection:"last_seen"})},ic)}),A=(0,T.A)(()=>{a()});return(0,se.Y)(te.A,{isSlim:!0,isOpen:e,onClose:A,children:(0,se.FD)("div",{className:"tauadiDm",dir:m.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{className:"i6iFv9YE",color:"translucent",round:!0,size:"tiny",onClick:A,ariaLabel:"Close",iconName:"close"}),(0,se.Y)(pr.A,{tgsUrl:t?ur.w.ReadTime:ur.w.LastSeen,size:84,className:"i4wZg_0J",nonInteractive:!0,noLoop:!0}),(0,se.Y)("h2",{className:Xl,children:h(t?"PremiumReadHeader1":"PremiumLastSeenHeader1")}),(0,se.Y)("p",{className:ec,children:(0,Pt.A)(h(t?"PremiumReadText1":"PremiumLastSeenText1Locked",u),["simple_markdown"])}),(0,se.Y)(X.A,{onClick:t?p:v,className:tc,children:h(t?"PremiumReadButton1":"PremiumLastSeenButton1")}),(0,se.Y)(Zl.A,{className:"sXXb5yOS",children:h("PremiumOr")}),(0,se.Y)("h2",{className:Xl,children:h("PremiumReadHeader2")}),(0,se.Y)("p",{className:ec,children:(0,Pt.A)(h(t?"PremiumReadText2":"PremiumLastSeenText2",u),["simple_markdown"])}),(0,se.Y)(X.A,{withPremiumGradient:!0,onClick:g,className:tc,children:h("PremiumLastSeenButton2")})]})})}));var nc=i(97822),oc=i(24956),ac=i(31722);const rc="ItemPickerItem",lc=(0,s.ph)(({className:e,isSearchable:t,searchInputId:i,items:n,filterValue:o,notFoundText:a,isLoading:l,noScrollRestore:c,filterPlaceholder:d,isViewOnly:h,itemInputType:m,itemClassName:u,withDefaultPadding:p,forceRenderAllItems:v,onFilterChange:g,onDisabledClick:A,onLoadMore:f,...b})=>{const C=(0,B.A)(),y=(0,s.li)(),S=b.allowMultiple,N=S?b.lockedSelectedValues:void 0,k=S?b.lockedUnselectedValues:void 0;(0,s.vJ)(()=>{t&&(0,r.YS)(()=>{(0,nc.A)(y.current)})},[t]);const w=(0,s.Kr)(()=>S?b.selectedValues:b.selectedValue?[b.selectedValue]:hi.p,[S,b.selectedValue,b.selectedValues]),I=(0,s.Kr)(()=>new Set(N),[N]),P=(0,s.Kr)(()=>new Set(k),[k]),Y=(0,s.Kr)(()=>{if(o)return n.map(e=>e.value);const e=[],t=[],i=[];return n.forEach(s=>{I.has(s.value)?e.push(s):P.has(s.value)?i.push(s):t.push(s)}),e.concat(t,i).map(e=>e.value)},[o,n,I,P]),F=(0,T.A)(e=>{if(S){const t=w.slice(),i=t.indexOf(e);return i>=0?t.splice(i,1):t.push(e),void b.onSelectedValuesChange?.(t)}b.onSelectedValueChange?.(e)}),[D,M]=(0,Ps.A)(f,Y,Boolean(v||o)),L=(0,T.A)(e=>{const{value:t}=e.currentTarget;g?.(t)}),R=(0,s.hb)(e=>{const t=n.find(t=>t.value===e);if(!t)return;const{label:i,subLabel:s,isLoading:o}=t,a=P.has(e),r=I.has(e),l=a||r,c=w.includes(e);return(0,se.Y)(Bs.A,{className:(0,ge.A)(rc,u),title:i,subtitle:s,disabled:l,inactive:h,ripple:!0,inputElement:l?(0,se.Y)(he.A,{name:"lock-badge"}):"radio"===m?(0,se.Y)(oc.A,{checked:c,disabled:l,isLoading:o,onlyInput:!0}):"checkbox"===m?(0,se.Y)(Hs.A,{checked:c,disabled:l,isLoading:o,onlyInput:!0}):void 0,onClick:()=>F(e),onDisabledClick:A&&(()=>A(e,r))},e)},[n,P,I,w,h,A,m,u]);return(0,se.FD)("div",{className:(0,ge.A)(ac.A.container,e),children:[t&&(0,se.Y)("div",{className:(0,ge.A)(ac.A.header,"custom-scroll"),dir:C.isRtl?"rtl":void 0,children:(0,se.Y)(ee.A,{id:i,ref:y,value:o,onChange:L,placeholder:d||C("Search")})}),D?.length?(0,se.Y)(ls.A,{className:(0,ge.A)(ac.A.pickerList,p&&ac.A.padded,"custom-scroll"),items:D,itemSelector:`.${rc}`,onLoadMore:M,noScrollRestore:c,children:D.map(e=>R(e))}):l||!D||D.length?(0,se.Y)(Ds.A,{}):(0,se.Y)("p",{className:ac.A.noResults,children:a||C("SearchEmptyViewTitle")})]})}),cc={root:"wzzA3MFh",pickerSelector:"xhujrq9i",pickerTitle:"YuRK4e7S",picker:"YF9nLkCK",footer:"ATCZ2Q5G"},dc=(0,s.ph)(({isOpen:e,onClose:t,onSubmit:i,countryList:o,selectionLimit:a})=>{const{showNotification:r}=(0,n.ko)(),l=(0,B.A)(),[c,d]=(0,s.J0)([]),h=(0,K.A)(c)===c,m=(0,s.Kr)(()=>o?o.filter(e=>!e.isHidden&&"FT"!==e.iso2).map(({iso2:e,defaultName:t})=>({value:e,label:t})):[],[o]),u=(0,T.A)(e=>{a&&e.length>a?r({message:l("BoostingSelectUpToWarningCountries",a)}):d(e)}),p=(0,T.A)(()=>{i(c),t()});return(0,se.FD)(te.A,{className:cc.root,isOpen:e,onClose:t,onEnter:p,hasAbsoluteCloseButton:!0,children:[(0,se.Y)("div",{className:cc.container,children:(0,se.Y)("div",{className:cc.pickerSelector,children:(0,se.Y)("h4",{className:cc.pickerTitle,children:l("BoostingSelectCountry")})})}),(0,se.Y)("div",{className:(0,ge.A)(cc.main,"custom-scroll"),children:(0,se.Y)(lc,{className:cc.picker,items:m,selectedValues:c,onSelectedValuesChange:u,noScrollRestore:h,allowMultiple:!0,itemInputType:"checkbox"})}),(0,se.Y)("div",{className:cc.footer,children:(0,se.Y)(X.A,{onClick:p,children:l("SelectCountries.OK")})})]})});var hc=i(60406);const mc=1.5*g.$,uc=(0,s.ph)((0,n.EK)(e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).reactorModal||{},s=t&&i?(0,c.O5q)(e,t,i):void 0;return{chatId:t,messageId:i,reactions:s?.reactions,reactors:s?.reactors,seenByDates:s?.seenByDates,availableReactions:e.reactions.availableReactions,animationLevel:(0,ks.lS)(e).animationLevel}})(({isOpen:e,reactors:t,reactions:i,chatId:a,messageId:r,seenByDates:c,availableReactions:d,animationLevel:h})=>{const{loadReactors:m,closeReactorListModal:u,openChat:p}=(0,n.ko)(),v=(0,n.mS)().chats.byId,g=(0,n.mS)().users.byId,A=(0,B.A)(),f=(0,Fi.A)(),[b,C,y]=(0,D.A)(!1),[S,N]=(0,s.J0)(void 0),k=t&&i&&t.count>=10&&i.results.length>1,w=(0,s.li)(),I=(0,s.li)(),P=(0,s.li)();(0,An.A)(I,!k||!e),(0,s.vJ)(()=>{e&&!b&&(w.current=void 0),b&&!e&&(y(),N(void 0))},[b,e,y]);const Y=(0,T.A)(()=>{w.current&&p({id:w.current}),u()}),F=(0,T.A)(()=>{C()}),M=(0,T.A)(e=>{w.current=e,F()}),L=(0,T.A)(()=>{m({chatId:a,messageId:r})}),R=(0,s.Kr)(()=>{const e=[];return t?.reactions?.forEach(({reaction:t})=>{e.some(e=>(0,l.a0)(e,t))||e.push(t)}),e},[t]),x=(0,s.Kr)(()=>S?R.findIndex(e=>(0,l.a0)(e,S))+1:0,[S,R]),E=(0,s.Kr)(()=>{if(S)return t?.reactions.filter(({reaction:e})=>(0,l.a0)(e,S)).map(({peerId:e})=>e);const e=Object.keys(c||{});return(0,di.Am)(t?.reactions.map(({peerId:e})=>e).concat(e||[])||[])},[S,t,c]),[V,_]=(0,Ps.A)(L,E,t&&void 0===t.nextOffset);return(0,hc.A)({containerRef:P,selector:".reactor-list"},[x,e]),(0,s.vJ)(()=>{_?.({direction:o.TN.Backwards})},[_]),(0,se.FD)(te.A,{isOpen:e&&!b,onClose:F,className:"ReactorListModal narrow",title:A("Reactions"),onCloseAnimationEnd:Y,isCondensedHeader:!0,hasCloseButton:!0,children:[k&&(0,se.FD)("div",{ref:I,className:(0,ge.A)("Reactions","no-scrollbar"),dir:f.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{color:S?"adaptive":"primary",size:"tiny",ripple:!0,iconName:"heart",className:S?"not-chosen-button":void 0,pill:!0,fluid:!0,onClick:()=>N(void 0),children:Boolean(t?.count)&&(0,bn.Vw)(f,t.count)}),R.map(e=>{const t=i?.results.find(t=>(0,l.a0)(t.reaction,e))?.count,s=(0,l.a0)(S,e);return(0,se.FD)(X.A,{className:s?void 0:"not-chosen-button",color:s?"primary":"adaptive",size:"tiny",pill:!0,fluid:!0,ripple:!0,onClick:()=>N(e),children:[(0,se.Y)(us.A,{reaction:e,className:"reaction-filter-emoji",availableReactions:d,size:mc}),Boolean(t)&&(0,bn.Vw)(f,t)]},(0,l.Jj)(e))})]}),(0,se.Y)("div",{ref:P,dir:f.isRtl?"rtl":void 0,className:"reactor-list-wrapper",children:(0,se.Y)(ae.Ay,{activeKey:x,name:(0,ws.P)("slide",h,void 0,f.isRtl),children:V?.length?(0,se.Y)(ls.A,{className:"reactor-list custom-scroll",items:V,onLoadMore:_,children:V?.flatMap(e=>{const i=g[e]||v[e],s=t?.reactions.filter(t=>t.peerId===e),n=[],o=c?.[e];return s?.forEach(t=>{S&&!(0,l.a0)(t.reaction,S)||n.push((0,se.FD)(li.A,{className:"chat-item-clickable reactors-list-item",onClick:()=>M(e),children:[(0,se.Y)(Yt.A,{peer:i,size:"medium"}),(0,se.FD)("div",{className:"info",children:[(0,se.Y)(Ms.A,{peer:i,withEmojiStatus:!0}),(0,se.FD)("span",{className:"status",dir:"auto",children:[(0,se.Y)(he.A,{name:"heart-outline",className:"status-icon"}),(0,We.U)(A,1e3*t.addedDate)]})]}),t.reaction&&(0,se.Y)(us.A,{className:"reactors-list-emoji",reaction:t.reaction,availableReactions:d,size:mc})]},`${e}-${(0,l.Jj)(t.reaction)}`))}),S||s?.length||n.push((0,se.Y)(li.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>M(e),children:(0,se.Y)(ms.A,{userId:e,noStatusOrTyping:!0,avatarSize:"medium",status:o?(0,We.U)(A,1e3*o):void 0,statusIcon:"message-read"})},`${e}-seen-by`)),n})}):(0,se.Y)(Ds.A,{})})})]})})),pc=(0,s.ph)((0,n.EK)((e,{activeEmojiInteraction:t})=>{const i=void 0!==t.animatedEffect&&(0,c.Nr8)(e,t.animatedEffect);return{effectAnimationId:i?i.id:void 0}})(({effectAnimationId:e,activeEmojiInteraction:t})=>{const{stopActiveEmojiInteraction:i}=(0,n.ko)(),[o,a]=(0,D.A)(!1),[r,l]=(0,D.A)(!1),c=(0,s.li)(),d=(0,T.A)(()=>{a(),c.current&&clearTimeout(c.current),setTimeout(()=>{i({id:t.id})},250)}),h=(0,T.A)(e=>{e.target?.closest(".AnimatedEmoji")||d()});(0,s.vJ)(()=>(document.addEventListener("touchstart",h),document.addEventListener("touchmove",h),document.addEventListener("mousedown",h),document.addEventListener("wheel",h),()=>{document.removeEventListener("touchstart",h),document.removeEventListener("touchmove",h),document.removeEventListener("mousedown",h),document.removeEventListener("wheel",h)}),[h]),(0,s.Nf)(()=>{const e=(0,s.VK)();c.current=setTimeout(()=>{d(),e()},3e3)},[d]);const u=e&&`sticker${e}`,p=(0,q.A)(u,!e);if(!t.startSize)return;const v=(t.startSize||0)/309;return(0,se.Y)("div",{className:(0,ge.A)("EmojiInteractionAnimation",o&&"hiding",r&&"playing",t.isReversed&&"reversed"),style:`--scale: ${v}; --start-x: ${t.x}px; --start-y: ${t.y}px;`,children:(0,se.Y)(No.A,{size:309,tgsUrl:p,play:!0,quality:m.Ni?.5:void 0,forceAlways:!0,noLoop:!0,onLoad:l},`effect_${e}`)})})),vc=(0,s.ph)((0,n.EK)(e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).chatLanguageModal||{},s=(0,c.wmb)(e);return{chatId:t,messageId:i,activeTranslationLanguage:t?i?(0,c.Rny)(e,t,i):(0,c.qZq)(e,t):void 0,currentLanguageCode:s}})(({isOpen:e,chatId:t,messageId:i,activeTranslationLanguage:o,currentLanguageCode:r})=>{const{requestMessageTranslation:l,closeChatLanguageModal:c,setSettingOption:d,requestChatTranslation:h}=(0,n.ko)(),[m,u]=(0,s.J0)(""),p=(0,B.A)(),v=(0,T.A)(e=>{t&&(i?l({chatId:t,id:i,toLanguageCode:e}):(d({translationLanguage:e}),h({chatId:t,toLanguageCode:e})),c())}),g=(0,T.A)(e=>{u(e.target.value)}),A=(0,s.Kr)(()=>a.N89.map(e=>({langCode:e,translatedName:new Intl.DisplayNames([r],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})),[r]);(0,s.vJ)(()=>{e||u("")},[e]);const f=(0,s.Kr)(()=>m.trim()?A.filter(({langCode:e,translatedName:t,originalName:i})=>t.toLowerCase().includes(m.toLowerCase())||i.toLowerCase().includes(m.toLowerCase())||e.toLowerCase().includes(m.toLowerCase())):A,[A,m]);return(0,se.FD)(te.A,{className:"aMjNU9gm",isSlim:!0,isOpen:e,hasCloseButton:!0,title:p("Language"),onClose:c,children:[(0,se.Y)(ee.A,{value:m,onChange:g,placeholder:p("Search"),teactExperimentControlled:!0},"search"),(0,se.Y)("div",{className:(0,ge.A)("r3YNWDQr","custom-scroll"),children:f.map(({langCode:e,originalName:t,translatedName:i})=>(0,se.FD)(li.A,{className:(0,ge.A)("T3An6Hoz","no-icon"),secondaryIcon:o===e?"check":void 0,disabled:o===e,multiline:!0,narrow:!0,onClick:()=>v(e),children:[(0,se.Y)("span",{className:(0,ge.A)("title","dQ9wwFu1"),children:(0,Pt.A)(t,["highlight"],{highlight:m})}),(0,se.Y)("span",{className:(0,ge.A)("subtitle","m_J41YYl"),children:(0,Pt.A)(i,["highlight"],{highlight:m})})]},e))})]})}));var gc=i(85982),Ac=i(24899);const fc={content:"WEJIbFQj",closeButton:"_vwPuDEM",icon:"BUiGM8qZ",title:"Q3NhXpNI",description:"frZbGQ0G"},bc=(0,s.ph)((0,n.EK)(e=>{const{countryList:t}=e;return{phoneCodeList:t.phoneCodes}})(({modal:e,phoneCodeList:t})=>{const{closeCollectibleInfoModal:i,openChat:o,openUrl:a,showNotification:r}=(0,n.ko)(),l=(0,B.A)(),c="username"===e?.type,d=(0,T.A)(()=>{i()}),h=(0,T.A)(()=>{o({id:e.peerId}),d()}),m=(0,T.A)(()=>{a({url:e.url}),d()}),u=(0,T.A)(()=>{const i=c?(0,Ac.A)(e.collectible):(0,on.Ox)(t,e.collectible);(0,gc.eM)(i),r({message:l(c?"UsernameCopied":"PhoneCopied")}),d()}),p=(0,s.Kr)(()=>{if(!e)return;const i=c?"FragmentUsernameTitle":"FragmentPhoneTitle",s=c?(0,Ac.A)(e.collectible):(0,on.Ox)(t,e.collectible);return l(i,s)},[e,c,t,l]),v=(0,s.Kr)(()=>{if(!e)return;const t=c?"FragmentUsernameMessage":"FragmentPhoneMessage",i=(0,We.U)(l,1e3*e.purchaseDate),s=(0,oo.Ad)(e.amount,e.currency,l.code),n=(0,oo.Ad)(e.cryptoAmount,e.cryptoCurrency,l.code);return l(t,[i,`${n} (${s})`])},[e,c,l]);return(0,se.FD)(te.A,{isOpen:Boolean(e),isSlim:!0,contentClassName:fc.content,onClose:i,hasAbsoluteCloseButton:!0,children:[(0,se.Y)("div",{className:fc.icon,children:(0,se.Y)(pr.A,{tgsUrl:c?ur.w.Mention:ur.w.Fragment,size:60})}),(0,se.Y)("h3",{className:fc.title,children:p&&(0,Pt.A)(p,["simple_markdown"])}),(0,se.Y)(Mr.A,{className:fc.chip,peerId:e?.peerId,forceShowSelf:!0,clickArg:e?.peerId,onClick:h}),(0,se.Y)("p",{className:fc.description,children:v&&(0,Pt.A)(v,["simple_markdown"])}),(0,se.FD)("div",{className:"dialog-buttons dialog-buttons-centered",children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",onClick:m,children:l("FragmentUsernameOpen")}),(0,se.Y)(X.A,{isText:!0,className:"confirm-dialog-button",onClick:u,children:l(c?"FragmentUsernameCopy":"FragmentPhoneCopy")})]})]})}));var Cc=i(57309);function yc(e){return(t,i)=>{const s=(0,c.nTw)(t),{byId:n}=t.chats,{byId:o}=t.users,{fetchingStatus:a,resultsByType:r,chatId:l}=s.globalSearch,{shouldWarnAboutFiles:d}=(0,ks.lS)(t),h="audio"!==e?e:i?.isVoice?"voice":"audio",{byChatId:m}=t.messages,u=r?.[h]?.foundIds,p=s.activeDownloads;return{theme:(0,c.SJA)(t),isLoading:void 0===u||!!a&&Boolean(a.chats||a.messages),chatsById:n,usersById:o,globalMessagesByChatId:m,foundIds:u,searchChatId:l,activeDownloads:p,isChatProtected:l?(0,c.hds)(t,l)?.isProtected:void 0,shouldWarnAboutFiles:d}}}var Sc=i(55429),Nc=i(65240),kc=i(42827);const wc=(0,be.nF)(e=>e(),500,!0),Ic=(0,s.ph)((0,n.EK)(yc("audio"))(({theme:e,isVoice:t,searchQuery:i,isLoading:r,chatsById:c,usersById:d,globalMessagesByChatId:h,foundIds:m,activeDownloads:u})=>{const{searchMessagesGlobal:p,focusMessage:v,openAudioPlayer:g}=(0,n.ko)(),A=(0,B.A)(),f=t?"voice":"audio",b=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&wc(()=>{p({type:f})})},[f,p,i]),C=(0,s.Kr)(()=>m&&h?m.map(e=>{const[t,i]=(0,Cc.a)(e);return h[t]?.byId[i]}).filter(Boolean):hi.p,[h,m]),y=(0,s.hb)(e=>{v({chatId:e.chatId,messageId:e.id})},[v]),S=(0,s.hb)((e,t)=>{g({chatId:t,messageId:e})},[g]),N=(0,Wa.A)([i],a.jhd)&&!r;return(0,se.Y)(ae.Ay,{slideClassName:"LeftSearch--content",name:"fade",activeKey:N?1:0,shouldCleanup:!0,children:(0,se.FD)(ls.A,{className:"search-content documents-list custom-scroll",items:N?C:void 0,onLoadMore:b,noFastList:!0,children:[!N&&(0,se.Y)(Ds.A,{}),N&&(!m||0===m.length)&&(0,se.Y)(kc.A,{withSticker:!0,text:A("ChatList.Search.NoResults"),description:A("ChatList.Search.NoResultsDescription")}),N&&m&&m.length>0&&C.map((t,i)=>{const s=(0,n.mS)(),a=0===i||(0,We.$$)(t.date)!==(0,We.$$)(C[i-1].date),r=(0,Le.iS)(s,t);return(0,se.FD)(se.FK,{children:[a&&(0,se.Y)("p",{className:"section-heading",dir:A.isRtl?"rtl":void 0,children:(0,We.i6)(A,new Date(1e3*t.date))},t.date),(0,se.Y)("div",{className:"ListItem small-icon",children:(0,se.Y)(Nc.Ay,{theme:e,message:t,origin:o.d9.Search,senderTitle:(0,Sc.N)(A,t,c,d),date:t.date,className:"scroll-item",onPlay:S,onDateClick:y,canDownload:!c[t.chatId]?.isProtected&&!t.isProtected,isDownloading:(0,l.$r)(u,r)},t.id)},t.id)]})})]})})}));var Pc=i(27109),Yc=i(75956),Fc=i(47067);const Dc=e=>{const t=(0,s.li)(),i=(0,T.A)(i=>{"Enter"===i.key&&t.current===document.activeElement&&e()});return(0,s.vJ)(()=>(window.addEventListener("keydown",i,!1),()=>window.removeEventListener("keydown",i,!1)),[]),t};var Mc=i(97967),Tc=i(97046);const Bc=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,user:(0,c.mBe)(e,t),isPinned:(0,c.D3D)(e,t),isMuted:i&&(0,Pc.If)(i,(0,c.K52)(e),(0,c.P5N)(e,i.id)),canChangeFolder:Boolean(e.chatFolders.orderedIds?.length)}})(({chatId:e,withUsername:t,chat:i,user:r,isPinned:l,isMuted:c,canChangeFolder:d,withOpenAppButton:h,onClick:m})=>{const{requestMainWebView:u,updateChatMutedState:p,openQuickPreview:g}=(0,n.ko)(),A=(0,Fi.A)(),[f,b,C]=(0,D.A)(),[y,S,N]=(0,D.A)(),[k,w,I]=(0,D.A)(),[P,Y,F]=(0,D.A)(),M=(0,s.hb)(()=>{w(),S()},[w,S]),B=(0,s.hb)(()=>{Y(),b()},[Y,b]),L=(0,T.A)(()=>{p({chatId:e,mutedUntil:a.Os5})}),R=(0,Fc.A)({chat:i,user:r,isPinned:l,isMuted:c,canChangeFolder:d,handleMute:B,handleUnmute:L,handleChatFolderChange:M},!0),x=(0,T.A)(t=>{if(t.altKey&&i&&!i.isForum)return t.preventDefault(),void g({id:e});m(e)}),E=(0,T.A)(t=>{t.stopPropagation();const i=(0,Cn.A)();u({botId:e,peerId:e,theme:i})}),V=(0,T.A)(t=>{t.preventDefault(),(0,Yc.W)(()=>{m(e)},!0)}),_=Dc(()=>{m(e)});return(0,se.FD)(li.A,{className:"chat-item-clickable search-result",contextActions:R,buttonRef:_,onClick:x,onDragEnter:V,onDragLeave:Yc.d,children:[(0,v.L8)(e)?(0,se.Y)(ms.A,{userId:e,withUsername:t,withStory:!0,avatarSize:"medium",storyViewerOrigin:o.G9.SearchResult}):(0,se.Y)(hs.A,{chatId:e,withUsername:t,avatarSize:"medium",withStory:!0,storyViewerOrigin:o.G9.SearchResult}),h&&r?.hasMainMiniApp&&(0,se.Y)(X.A,{className:"search-result-miniapp-button",pill:!0,fluid:!0,size:"tiny",onClick:E,children:A("BotChatMiniAppOpen")}),P&&(0,se.Y)(Tc.A,{isOpen:f,onClose:C,onCloseAnimationEnd:F,chatId:e}),k&&(0,se.Y)(Mc.A,{isOpen:y,onClose:N,onCloseAnimationEnd:I,chatId:e})]})})),Lc=(0,be.nF)(e=>e(),500,!0),Rc=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.nTw)(e).globalSearch,i=t.popularBotApps?.peerIds;return{isLoading:!i&&t.fetchingStatus?.botApps,foundIds:i,recentBotIds:e.topBotApps.userIds}})(({searchQuery:e,isLoading:t,foundIds:i,recentBotIds:r})=>{const{searchPopularBotApps:l,openChatWithInfo:c}=(0,n.ko)(),d=(0,s.li)(),h=(0,B.A)(),[m,u]=(0,s.J0)(!1),p=(0,s.Kr)(()=>{if(!i)return[];const t=new Set(r),s=i.filter(e=>!t.has(e));return(0,It.PU)({ids:s,query:e,type:"user"})},[i,r,e]),v=(0,T.A)(e=>{c({id:e,shouldReplaceHistory:!0})}),g=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&Lc(()=>{l()})},[]),A=(0,T.A)(()=>{u(e=>!e)}),f=(0,Wa.A)([e],a.jhd)&&!t;return(0,se.Y)(ae.Ay,{ref:d,slideClassName:"LeftSearch--content",name:"fade",activeKey:f?1:0,shouldCleanup:!0,children:(0,se.FD)(ls.A,{className:"search-content custom-scroll",items:f?p:void 0,onLoadMore:g,noFastList:!0,children:[!f&&(0,se.Y)(Ds.A,{}),f&&!p?.length&&(0,se.Y)(kc.A,{withSticker:!0,text:h("ChatList.Search.NoResults"),description:h("ChatList.Search.NoResultsDescription")}),f&&!e&&Boolean(r?.length)&&(0,se.FD)("div",{className:"search-section",children:[(0,se.FD)("h3",{className:"section-heading",children:[r.length>5&&(0,se.Y)(fa.A,{className:"Link",onClick:A,children:h(m?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")}),h("SearchAppsMine")]}),r.map((e,t)=>{if(m||!(t>=5))return(0,se.Y)(Bc,{chatId:e,onClick:v,withOpenAppButton:!0})})]}),f&&Boolean(p?.length)&&(0,se.FD)("div",{className:"search-section",children:[(0,se.Y)("h3",{className:"section-heading",children:h("SearchAppsPopular")}),p.map(e=>(0,se.Y)(Bc,{chatId:e,onClick:v,withOpenAppButton:!0}))]})]})})}));var xc=i(35749),Ec=i(2338);function Vc(e,t,i,s,n){if(!i)return(0,A.C)(e,t,void 0,s);const o=(0,l.y2)(t);return(0,se.FD)("span",{className:"media-preview",children:[(0,se.Y)("img",{src:i,alt:"",className:(0,ge.A)("media-preview--image",n&&"round",o&&"media-preview-spoiler"),draggable:!1}),(0,l.zX)(t)&&(0,se.Y)(he.A,{name:"play"}),(0,A.C)(e,t,!0,s)]})}const _c=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);if(!i)return{};const s=(0,l.e7)(i);return{chat:i,privateChatUser:s?(0,c.mBe)(e,s):void 0}})(({message:e,searchQuery:t,chatId:i,chat:s,privateChatUser:o})=>{const{focusMessage:a}=(0,n.ko)(),{isMobile:r}=(0,Y.Ay)(),c=(0,Ec.A)(e),d=(0,l.fP)(e)?void 0:c,h=(0,xc.A)(e,"micro"),m=(0,q.A)(h),u=Boolean((0,l.lk)(e)),p=(0,T.A)(()=>{a({chatId:i,messageId:e.id,shouldReplaceHistory:!0})}),v=(0,Fi.A)(),g=(0,B.A)(),A=Dc(p);if(!s)return;const f=o||s;return(0,se.FD)(li.A,{className:"ChatMessage chat-item-clickable",ripple:!r,onClick:p,buttonRef:A,children:[(0,se.Y)(Yt.A,{peer:f,isSavedMessages:o?.isSelf}),(0,se.FD)("div",{className:"info",children:[(0,se.FD)("div",{className:"info-row",children:[(0,se.Y)(Ms.A,{peer:f,withEmojiStatus:!0,isSavedMessages:i===o?.id&&o?.isSelf}),(0,se.Y)("div",{className:"message-date",children:(0,se.Y)(fa.A,{className:"date",children:(0,We.be)(g,1e3*e.date)})})]}),(0,se.Y)("div",{className:"subtitle",children:(0,se.Y)("div",{className:"message",dir:"auto",children:Vc(v,e,m||d,t,u)})})]})]})})),Uc=(0,s.ph)(({searchDate:e,onSelect:t})=>{const i=(0,s.Kr)(()=>function(e){if(e.match(/^\d{2,4}-\d{2}-\d{2}$/g)){const t=new Date(e);return[{date:t,text:(0,We.A)(t)}]}const t=[],i=new Date,s=i.getFullYear(),n=i.getTime()>new Date(`${s}-${e}`).getTime()?s:s-1;for(let i=0;i<8;i++){const s=new Date(`${n-i}-${e}`);t.push({date:s,text:(0,We.A)(s)})}return t}(e),[e]);return(0,se.Y)("section",{className:"DateSuggest custom-scroll custom-scroll-x",children:i.map(({date:e,text:i})=>(0,se.FD)("div",{onClick:()=>t(e),className:"date-item",children:[(0,se.Y)(he.A,{name:"calendar"}),(0,se.Y)("span",{children:i})]},i))})}),Oc=2*g.$,Kc=(0,s.ph)((0,n.EK)((e,{chatId:t,topicId:i})=>({topic:(0,c.S0q)(e,t,i)}))(({chatId:e,topicId:t,topic:i,onClick:o})=>{const{openQuickPreview:a}=(0,n.ko)(),r=(0,s.hb)(i=>{if(i.altKey)return i.preventDefault(),void a({id:e,threadId:t});o(t)},[e,t,o,a]),l=Dc(()=>o(t));if(i)return(0,se.FD)(li.A,{className:"chat-item-clickable search-result",onClick:r,buttonClassName:"topic-item",buttonRef:l,children:[(0,se.Y)(Ts.A,{size:Oc,topic:i,className:"topic-icon",letterClassName:"topic-icon-letter"}),(0,se.Y)("div",{dir:"auto",className:"fullName",children:(0,Pt.A)(i.title)})]})})),Jc=(0,be.nF)(e=>e(),500,!0),Gc=(0,s.ph)((0,n.EK)(e=>{const{byId:t}=e.chats,{currentUserId:i,messages:{byChatId:s}}=e,{fetchingStatus:n,resultsByType:o,foundTopicIds:a,chatId:r}=(0,c.nTw)(e).globalSearch,{foundIds:l}=o?.text||{};return{currentUserId:i,foundIds:l,globalMessagesByChatId:s,chatsById:t,fetchingStatus:n,foundTopicIds:a,searchChatId:r}})(({searchQuery:e,dateSearchQuery:t,foundIds:i,globalMessagesByChatId:a,chatsById:r,fetchingStatus:l,foundTopicIds:c,searchChatId:d,onSearchDateSelect:h,onReset:m})=>{const{searchMessagesGlobal:u,openThread:p}=(0,n.ko)(),v=(0,Fi.A)(),{isMobile:g}=(0,Y.Ay)(),f=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&Jc(()=>{u({type:"text"})})},[e]),b=(0,s.hb)(e=>{d&&(p({chatId:d,threadId:e,shouldReplaceHistory:!0}),g||m())},[d,g,m]),C=(0,s.Kr)(()=>i&&0!==i.length?i.map(e=>{const[t,i]=(0,Cc.a)(e);return a?.[t]?.byId[i]}).filter(Boolean).sort((e,t)=>t.date-e.date):hi.p,[i,a]),y=l&&!l.chats&&!l.messages&&!C.length&&!c?.length;return(0,se.Y)("div",{className:"LeftSearch--content",children:(0,se.FD)(ls.A,{className:"search-content custom-scroll chat-list",items:C,onLoadMore:f,noFastList:!0,children:[t&&(0,se.Y)("div",{className:"chat-selection no-scrollbar",children:(0,se.Y)(Uc,{searchDate:t,onSelect:h})}),y&&(0,se.Y)(kc.A,{withSticker:!0,text:v("ChatListSearchNoResults"),description:v("ChatListSearchNoResultsDescription")}),Boolean(c?.length)&&(0,se.FD)("div",{className:"pb-2",children:[(0,se.Y)("h3",{className:"section-heading topic-search-heading",dir:v.isRtl?"auto":void 0,children:v("SearchResultTopics")}),c.map(e=>(0,se.Y)(Kc,{chatId:d,topicId:e,onClick:b}))]}),Boolean(C.length)&&(0,se.FD)("div",{className:"pb-2",children:[(0,se.Y)("h3",{className:"section-heading topic-search-heading",dir:v.isRtl?"auto":void 0,children:v("SearchMessages")}),C.map(function(t){const i=(0,A.C)(v,t),s=r[t.chatId];if(i&&s)return(0,se.Y)(_c,{chatId:t.chatId,message:t,searchQuery:e})})]})]})})}));var jc=i(49763),zc=i(81949);const Hc=(0,s.ph)(({sponsoredPeer:e,observeIntersection:t})=>{const i=(0,s.li)(),{clickSponsored:a,viewSponsored:r,openChat:l}=(0,n.ko)(),c=(0,Fi.A)(),{peerId:d,randomId:h,additionalInfo:m,sponsorInfo:u}=e;(0,Za.mv)(i,t,e=>{1===e.intersectionRatio&&r({randomId:h})});const p=(0,T.A)(()=>{a({randomId:h}),l({id:d})}),{isContextMenuOpen:g,contextMenuAnchor:A,handleBeforeContextMenu:f,handleContextMenu:b,handleContextMenuClose:C,handleContextMenuHide:y}=(0,Ws.A)(i),{handleClick:S,handleMouseDown:N}=(0,Ki.Q)(e=>{e.stopPropagation(),b(e)}),k=Dc(p);return(0,se.FD)(li.A,{ref:i,className:"chat-item-clickable search-result",onClick:p,onMouseDown:f,onContextMenu:b,buttonRef:k,children:[(0,v.L8)(d)?(0,se.Y)(ms.A,{userId:d,withUsername:!0,withStory:!0,avatarSize:"medium",storyViewerOrigin:o.G9.SearchResult}):(0,se.Y)(hs.A,{chatId:d,withUsername:!0,avatarSize:"medium",withStory:!0,storyViewerOrigin:o.G9.SearchResult}),(0,se.FD)(zc.A,{className:"search-sponsored-badge",onMouseDown:N,onClick:S,children:[c("SponsoredPeerBadge"),(0,se.Y)(he.A,{name:"more"})]}),A&&(0,se.Y)(hl.A,{isOpen:g,anchor:A,triggerRef:i,randomId:h,additionalInfo:m,canReport:!0,sponsorInfo:u,onClose:C,onCloseAnimationEnd:y})]})}),$c=(0,be.nF)(e=>e(),6e4,!0),qc=(0,s.ph)((0,n.EK)(e=>{const{userIds:t}=e.topPeers,i=e.users.byId,{recentlyFoundChatIds:s}=e;return{topUserIds:t,usersById:i,recentlyFoundChatIds:s}})(({topUserIds:e,usersById:t,recentlyFoundChatIds:i,onReset:o})=>{const{loadTopUsers:a,openChat:r,addRecentlyFoundChatId:c,clearRecentlyFoundChats:d}=(0,n.ko)(),h=(0,s.li)();(0,s.vJ)(()=>{$c(()=>{a()})},[a]),(0,An.A)(h,!e);const m=(0,s.hb)(e=>{r({id:e,shouldReplaceHistory:!0}),o(),setTimeout(()=>{c({id:e})},250)},[r,c,o]),u=(0,s.hb)(()=>{d()},[d]),p=(0,B.A)();return(0,se.FD)("div",{className:"RecentContacts custom-scroll",children:[e&&(0,se.Y)("div",{className:"top-peers-section",dir:p.isRtl?"rtl":void 0,children:(0,se.Y)("div",{ref:h,className:"top-peers",children:e.map(e=>(0,se.FD)("div",{className:"top-peer-item",onClick:()=>m(e),dir:p.isRtl?"rtl":void 0,children:[(0,se.Y)(Yt.A,{peer:t[e]}),(0,se.Y)("div",{className:"top-peer-name",children:(0,Pt.A)((0,l.u0)(t[e])||"Â ")})]},e))})}),i&&(0,se.FD)("div",{className:"search-section pt-1",children:[(0,se.FD)("h3",{className:(0,ge.A)("section-heading mt-0 recent-chats-header",!e&&"without-border"),dir:p.isRtl?"rtl":void 0,children:[p("Recent"),(0,se.Y)(X.A,{className:"clear-recent-chats",round:!0,size:"smaller",color:"translucent",ariaLabel:p("Clear"),onClick:u,isRtl:p.isRtl,iconName:"close"})]}),i.map(e=>(0,se.Y)(Bc,{chatId:e,withOpenAppButton:!0,onClick:m}))]})]})})),Wc=(0,be.nF)(e=>e(),500,!1),Qc=(0,s.ph)((0,n.EK)((e,{isChannelList:t})=>{const{userIds:i}=e.contactList||{},{currentUserId:s,messages:n}=e;if(!i)return{};const{fetchingStatus:o,globalResults:r,localResults:l,resultsByType:d,sponsoredPeer:h}=(0,c.nTw)(e).globalSearch,{peerIds:m}=r||{},{peerIds:u}=l||{},{byChatId:p}=n,v=d?.[t?"channels":"text"]?.foundIds,{similarChannelIds:g}=(0,c.dg4)(e,a.rBM)||{};return{currentUserId:s,contactIds:i,accountPeerIds:u,globalPeerIds:m,foundIds:v,globalMessagesByChatId:p,fetchingStatus:o,sponsoredPeer:h,suggestedChannelIds:g}})(({isChannelList:e,searchQuery:t,searchDate:i,dateSearchQuery:r,currentUserId:c,contactIds:d,accountPeerIds:h,globalPeerIds:m,foundIds:u,globalMessagesByChatId:p,fetchingStatus:v,suggestedChannelIds:g,sponsoredPeer:f,onReset:b,onSearchDateSelect:C})=>{const{openChat:y,addRecentlyFoundChatId:S,searchMessagesGlobal:N,setGlobalSearchChatId:k,loadChannelRecommendations:w}=(0,n.ko)(),I=(0,s.li)(),P=(0,s.li)(),F=(0,Fi.A)(),{isMobile:D}=(0,Y.Ay)(),[M,B]=(0,s.J0)(!1),[L,R]=(0,s.J0)(!1),[x,E]=(0,s.J0)("all"),V=(0,s.li)();(0,ke.A)(()=>{e&&w({})});const _=(0,s.hb)(({direction:t})=>{t===o.TN.Backwards&&Wc(()=>{N({type:e?"channels":"text",context:x})})},[t,x]),U=(0,s.hb)(e=>{y({id:e,shouldReplaceHistory:!0}),e!==c&&S({id:e}),D||b()},[y,c,D,S,b]),O=(0,s.hb)(e=>{k({id:e})},[k]);function K(e){return F("users"===e?"PrivateChatsSearchContext":"groups"===e?"GroupChatsSearchContext":"channels"===e?"ChannelsSearchContext":"AllChatsSearchContext")}const{isContextMenuOpen:J,contextMenuAnchor:G,handleContextMenu:j,handleContextMenuClose:z,handleContextMenuHide:H}=(0,Ws.A)(V),$=(0,T.A)(()=>V.current),q=(0,T.A)(()=>V.current.querySelector(".chatResultsContextMenu .bubble")),W=(0,T.A)(()=>V.current.querySelector(".menuTrigger")),Q=(0,T.A)(e=>{j(e)}),Z=(0,ge.A)("icon","iconPlaceholder"),X=(0,s.Kr)(()=>{if(!e&&(!t||t.startsWith("@")&&t.length<2))return hi.p;const i=(0,n.mS)().chats.byId,s=((0,jc.YA)(a.DSF)??[]).filter(t=>{if(!e)return!0;const s=i[t];return s&&(0,l.WX)(s)}),o=(0,It.PU)({ids:s,query:t,type:"chat"});if(e)return o;const r=[...c?[c]:[],...d||[]],m=[...(0,It.PU)({ids:r,query:t,type:"user"}),...o];return(0,di.Am)([...(0,Cs.A)(m,void 0,c?[c]:void 0),...(0,Cs.A)(h||[])])},[t,c,d,h,e]);(0,An.A)(P,!X.length||e,!0);const ee=(0,s.Kr)(()=>{if(!t||t.length<4||!m)return hi.p;const i=(0,n.mS)().chats.byId,s=m.filter(t=>{if(!e)return!0;const s=i[t];return s&&(0,l.WX)(s)});return(0,Cs.A)(s,!0)},[m,e,t]),te=(0,s.Kr)(()=>{if(!t&&!i||!u||0===u.length)return hi.p;const s=(0,n.mS)().chats.byId;return u.map(t=>{const[i,n]=(0,Cc.a)(t),o=s[i];if(o&&(!e||(0,l.WX)(o)))return p?.[i]?.byId[n]}).filter(Boolean)},[t,i,u,e,p]);(0,s.vJ)(()=>{t&&N({type:e?"channels":"text",context:x,shouldResetResultsByType:!0,shouldCheckFetchingMessagesStatus:!0})},[x]);const ie=(0,s.hb)(()=>{B(!M)},[M]),ne=(0,s.hb)(()=>{R(!L)},[L]),oe=te,re="all"===x&&v&&!v.chats&&!v.messages&&!X.length&&!ee.length&&!oe.length,le=v?.messages,ce=!t&&!i&&!e,{observe:de}=(0,Za.BL)({rootRef:I,throttleMs:200,isDisabled:!ce});if(ce)return(0,se.Y)(qc,{onReset:b});const me="all"!==x||Boolean(oe.length);return(0,se.FD)(ls.A,{ref:I,className:"LeftSearch--content custom-scroll",items:oe,onLoadMore:_,noScrollRestoreOnTop:!0,noFastList:!0,children:[r&&(0,se.Y)("div",{className:"chat-selection no-scrollbar",children:(0,se.Y)(Uc,{searchDate:r,onSelect:C})}),re&&(0,se.Y)(kc.A,{withSticker:!0,text:F("ChatListSearchNoResults"),description:F("ChatListSearchNoResultsDescription")}),Boolean(X.length)&&!e&&(0,se.Y)("div",{className:"chat-selection no-scrollbar",dir:F.isRtl?"rtl":void 0,ref:P,children:X.map(e=>(0,se.Y)(Mr.A,{peerId:e,className:"left-search-local-suggestion",onClick:O,clickArg:e}))}),Boolean(X.length)&&(0,se.FD)("div",{className:"search-section",children:[(0,se.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[X.length>5&&(0,se.Y)(fa.A,{className:"Link",onClick:ie,children:F(M?"ChatListSearchShowLess":"ChatListSearchShowMore")}),F(e?"SearchResultMyChannels":"DialogListSearchSectionDialogs")]}),X.map((e,t)=>{if(M||!(t>=5))return(0,se.Y)(Bc,{withOpenAppButton:!0,chatId:e,onClick:U})})]}),Boolean(ee.length)&&(0,se.FD)("div",{className:"search-section",children:[(0,se.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[ee.length>5&&(0,se.Y)(fa.A,{className:"Link",onClick:ne,children:F(L?"ChatListSearchShowLess":"ChatListSearchShowMore")}),F("DialogListSearchSectionGlobal")]}),f&&(0,se.Y)(Hc,{sponsoredPeer:f,observeIntersection:de}),ee.map((e,t)=>{if(L||!(t>=5))return(0,se.Y)(Bc,{chatId:e,withUsername:!0,onClick:U})})]}),Boolean(g?.length)&&!t&&(0,se.FD)("div",{className:"search-section",children:[(0,se.Y)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:F("SearchResultRecommendedChannels")}),g.map(e=>(0,se.Y)(Bc,{chatId:e,withUsername:!0,onClick:U}))]}),(0,se.FD)("div",{className:"menuOwner",ref:V,children:[(0,se.Y)(Ze.A,{isOpen:J,anchor:G,getTriggerElement:W,getRootElement:$,getMenuElement:q,className:"chatResultsContextMenu",onClose:z,onCloseAnimationEnd:H,autoClose:!0,children:(0,se.FD)(se.FK,{children:[(0,se.Y)(ue.A,{icon:"all"===x?"check":void 0,customIcon:"all"!==x?(0,se.Y)("i",{className:Z}):void 0,onClick:()=>E("all"),children:K("all")}),(0,se.Y)(ue.A,{icon:"users"===x?"check":void 0,customIcon:"users"!==x?(0,se.Y)("i",{className:Z}):void 0,onClick:()=>E("users"),children:K("users")}),(0,se.Y)(ue.A,{icon:"groups"===x?"check":void 0,customIcon:"groups"!==x?(0,se.Y)("i",{className:Z}):void 0,onClick:()=>E("groups"),children:K("groups")}),(0,se.Y)(ue.A,{icon:"channels"===x?"check":void 0,customIcon:"channels"!==x?(0,se.Y)("i",{className:Z}):void 0,onClick:()=>E("channels"),children:K("channels")})]})}),me&&(0,se.FD)("div",{className:"search-section",children:[(0,se.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[!e&&(0,se.FD)(fa.A,{className:"Link menuTrigger dropDownLink",onClick:Q,children:[F("SearchContextCaption",{type:K(x)},{withNodes:!0}),(0,se.FD)(ae.Ay,{name:"fade",shouldCleanup:!0,activeKey:Number(le),className:"iconContainer",slideClassName:"iconContainerSlide",children:[le&&(0,se.Y)(Ds.A,{}),!le&&(0,se.Y)(he.A,{name:"down"})]})]}),F("SearchMessages")]}),oe.map(function(e){const i=(0,n.mS)().chats.byId,s=(0,A.C)(F,e),o=i[e.chatId];if(s&&o)return(0,se.Y)(_c,{chatId:e.chatId,message:e,searchQuery:t})})]})]})]})}));var Zc=i(55723);const Xc="documents",ed=(0,be.nF)(e=>e(),500,!0),td=(0,s.ph)((0,n.EK)(yc(Xc))(({searchQuery:e,isLoading:t,chatsById:i,usersById:r,globalMessagesByChatId:c,foundIds:d,activeDownloads:h,shouldWarnAboutFiles:m})=>{const{searchMessagesGlobal:u,focusMessage:p}=(0,n.ko)(),v=(0,s.li)(),g=(0,B.A)(),{observe:A}=(0,Za.BL)({rootRef:v,throttleMs:500}),f=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&ed(()=>{u({type:Xc})})},[e]),b=(0,s.Kr)(()=>d&&c?d.map(e=>{const[t,i]=(0,Cc.a)(e),s=c[t]?.byId[i];return s&&(0,l.zC)(s)?s:void 0}).filter(Boolean):hi.p,[c,d]),C=(0,s.hb)(e=>{p({chatId:e.chatId,messageId:e.id})},[p]),y=(0,Wa.A)([e],a.jhd)&&!t;return(0,se.Y)(ae.Ay,{ref:v,slideClassName:"LeftSearch--content",name:"fade",activeKey:y?1:0,shouldCleanup:!0,children:(0,se.FD)(ls.A,{className:"search-content documents-list custom-scroll",items:y?b:void 0,onLoadMore:f,noFastList:!0,children:[!y&&(0,se.Y)(Ds.A,{}),y&&(!d||0===d.length)&&(0,se.Y)(kc.A,{withSticker:!0,text:g("ChatList.Search.NoResults"),description:g("ChatList.Search.NoResultsDescription")}),y&&d&&d.length>0&&b.map((e,t)=>{const s=0===t||(0,We.$$)(e.date)!==(0,We.$$)(b[t-1].date);return(0,se.FD)(se.FK,{children:[s&&(0,se.Y)("p",{className:"section-heading",dir:g.isRtl?"rtl":void 0,children:(0,We.i6)(g,new Date(1e3*e.date))},e.date),(0,se.Y)("div",{className:"ListItem small-icon",children:(0,se.Y)(Zc.A,{document:(0,l.zC)(e),message:e,datetime:e.date,smaller:!0,sender:(0,Sc.N)(g,e,i,r),className:"scroll-item",isDownloading:(0,l.$r)(h,e.content.document),shouldWarnAboutFiles:m,observeIntersection:A,onDateClick:C})},e.id)]})})]})})}));var id=i(37378);const sd="links",nd=(0,be.nF)(e=>e(),500,!0),od=(0,s.ph)((0,n.EK)(yc(sd))(({searchQuery:e,isLoading:t,chatsById:i,usersById:r,globalMessagesByChatId:l,foundIds:c,isChatProtected:d})=>{const{searchMessagesGlobal:h,focusMessage:m}=(0,n.ko)(),u=(0,s.li)(),p=(0,B.A)(),{observe:v}=(0,Za.BL)({rootRef:u,throttleMs:500}),g=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&nd(()=>{h({type:sd})})},[e]),A=(0,s.Kr)(()=>c&&l?c.map(e=>{const[t,i]=(0,Cc.a)(e);return l[t]?.byId[i]}).filter(Boolean):hi.p,[l,c]),f=(0,s.hb)(e=>{m({chatId:e.chatId,messageId:e.id})},[m]),b=(0,Wa.A)([e],a.jhd)&&!t;return(0,se.Y)(ae.Ay,{ref:u,slideClassName:"LeftSearch--content",name:"fade",activeKey:b?1:0,shouldCleanup:!0,children:(0,se.FD)(ls.A,{className:"search-content documents-list custom-scroll",items:b?A:void 0,onLoadMore:g,noFastList:!0,children:[!b&&(0,se.Y)(Ds.A,{}),b&&(!c||0===c.length)&&(0,se.Y)(kc.A,{withSticker:!0,text:p("ChatList.Search.NoResults"),description:p("ChatList.Search.NoResultsDescription")}),b&&c&&c.length>0&&A.map((e,t)=>{const s=0===t||(0,We.$$)(e.date)!==(0,We.$$)(A[t-1].date);return(0,se.FD)(se.FK,{children:[s&&(0,se.Y)("p",{className:"section-heading",dir:p.isRtl?"rtl":void 0,children:(0,We.i6)(p,new Date(1e3*e.date))},e.date),(0,se.Y)("div",{className:"ListItem small-icon",dir:p.isRtl?"rtl":void 0,children:(0,se.Y)(id.A,{message:e,senderTitle:(0,Sc.N)(p,e,i,r),isProtected:d||e.isProtected,observeIntersection:v,onMessageClick:f},e.id)},e.id)]})})]})})}));var ad=i(81524);const rd="media",ld=(0,be.nF)(e=>e(),500,!0),cd=(0,s.ph)((0,n.EK)(yc(rd))(({searchQuery:e,isLoading:t,globalMessagesByChatId:i,foundIds:r,isChatProtected:l})=>{const{searchMessagesGlobal:c,openMediaViewer:d}=(0,n.ko)(),h=(0,s.li)(),m=(0,B.A)(),{observe:u}=(0,Za.BL)({rootRef:h,throttleMs:500}),p=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&ld(()=>{c({type:rd})})},[c,e]),v=(0,s.Kr)(()=>r&&i?r.map(e=>{const[t,s]=(0,Cc.a)(e);return i[t]?.byId[s]}).filter(Boolean):hi.p,[i,r]),g=(0,s.hb)((e,t)=>{d({chatId:t,messageId:e,origin:o.TQ.SearchResult})},[d]),A=(0,Wa.A)([e],a.jhd)&&!t,f=A&&r&&r.length>0&&!e,b=A&&r&&r.length>0&&e,C=(0,ge.A)("search-content custom-scroll",b&&"chat-list");return(0,se.Y)(ae.Ay,{ref:h,slideClassName:"LeftSearch--content LeftSearch--media",name:"fade",activeKey:A?1:0,shouldCleanup:!0,children:(0,se.FD)(ls.A,{className:C,items:A?v:void 0,itemSelector:e?".ListItem":".Media",onLoadMore:p,noFastList:!0,children:[!A&&(0,se.Y)(Ds.A,{}),A&&(!r||0===r.length)&&(0,se.Y)(kc.A,{withSticker:!0,text:m("ChatList.Search.NoResults"),description:m("ChatList.Search.NoResultsDescription")}),f&&(0,se.Y)("div",{className:"media-list",dir:m.isRtl?"rtl":void 0,children:v.map(e=>(0,se.Y)(ad.A,{idPrefix:"search-media",message:e,isProtected:l||e.isProtected,observeIntersection:u,onClick:g},`${e.chatId}-${e.id}`))}),b&&v.map(e=>(0,se.Y)(_c,{chatId:e.chatId,message:e},e.id))]})})}));var dd=i(537),hd=i(61361);const md={container:"fHc6WtIe",content:"N8GlyYo0",loadingScreen:"l7JTscdP",searchButtonContent:"dqfofU9e",sticker:"bhaEA7Az",title:"HkiOz0kI",description:"B5FR0TSV",searchButton:"Ii0w2ObZ",remainingSearches:"fYxU7PVl",searchIcon:"NMdA935k",searchIconWithNext:"NqAG2PXY",searchQuery:"eRsI0lkH",limitTitle:"uAggPEqN",limitDescription:"oirV9yqd",paidSearchButton:"LMu5PMXS",freeSearchUnlock:"IdgXsecy",premiumTitle:"SBmNHjsL",premiumDescription:"KoW3G8Sv",subscribePremiumButton:"tGWjYFeK",premiumSubtitle:"o2V6uF3Y"},ud=(0,be.nF)(e=>e(),500,!1),pd=(0,s.ph)((0,n.EK)(e=>({isCurrentUserPremium:(0,c.g29)(e),starsBalance:e.stars?.balance?.amount||0}))(({searchQuery:e,searchFlood:t,onSearch:i,isLoading:o,isCurrentUserPremium:r,starsBalance:l})=>{const{checkSearchPostsFlood:c,openPremiumModal:d,openStarsBalanceModal:h}=(0,n.ko)(),m=(0,Fi.A)(),u=t?.queryIsFree,p=t?.query,v=(0,dd.A)([e?.slice(0,18).trimEnd()]),g=(0,T.A)(()=>{i()});(0,s.vJ)(()=>{u&&e&&p===e&&i()},[u,e,p,i]);const A=(0,T.A)(()=>{const e=t?.starsAmount||0;l<e?h({topup:{balanceNeeded:e}}):i()});(0,s.vJ)(()=>{e&&p!==e&&ud(()=>{c({query:e})})},[e,p]);const f=(0,T.A)(()=>{c({})}),b=(0,T.A)(()=>{d()}),C=(0,Ii.Fm)(),y=0===t?.remains||t?.waitTill&&t.waitTill>C;return(0,se.Y)(ae.Ay,{name:"fade",activeKey:r?o?2:y?0:1:3,children:r?o?(0,se.Y)("div",{className:md.container,children:(0,se.Y)("div",{className:(0,ge.A)(md.content,md.loadingScreen),children:(0,se.Y)(Ds.A,{})})}):y?(()=>{const i=t?.waitTill,s=t?.starsAmount||a._tP,n=t?.totalDaily||a.M3$;return(0,se.Y)("div",{className:md.container,children:(0,se.FD)("div",{className:md.content,children:[(0,se.Y)(pr.A,{className:md.sticker,size:120,tgsUrl:ur.w.Search,previewUrl:ur.d.Search,nonInteractive:!0,noLoop:!1}),(0,se.Y)("div",{className:md.limitTitle,children:m("PublicPostsLimitReached")}),(0,se.Y)("div",{className:md.limitDescription,children:m("HintPublicPostsSearchQuota",{count:n},{pluralValue:n})}),(0,se.Y)(X.A,{className:md.paidSearchButton,color:"primary",disabled:!e,noForcedUpperCase:!0,onClick:A,children:m("PublicPostsSearchForStars",{stars:(0,wi.U2)(m,s,{asFont:!0})},{withNodes:!0})}),Boolean(i)&&(0,se.Y)("div",{className:md.freeSearchUnlock,children:m("UnlockTimerPublicPostsSearch",{time:(0,se.Y)(hd.A,{endsAt:i+2,onEnd:f})},{withNodes:!0})})]})})})():(()=>{const i=t?.remains||0;return(0,se.Y)("div",{className:md.container,children:(0,se.FD)("div",{className:md.content,children:[(0,se.Y)(pr.A,{className:md.sticker,size:120,tgsUrl:ur.w.Search,previewUrl:ur.d.Search,nonInteractive:!0,noLoop:!1}),(0,se.Y)("div",{className:md.title,children:m("GlobalSearch")}),(0,se.Y)("div",{className:md.description,children:m("DescriptionPublicPostsSearch")}),(0,se.Y)(X.A,{className:md.searchButton,color:"primary",noForcedUpperCase:!0,disabled:!e,onClick:g,children:(0,se.Y)(ae.Ay,{name:"fade",activeKey:v,children:(0,se.FD)("div",{className:md.searchButtonContent,children:[(0,se.Y)(he.A,{name:"search",className:(0,ge.A)(md.searchIcon,e&&md.searchIconWithNext)}),m("ButtonSearchPublicPosts",{query:e?(0,se.Y)("span",{className:md.searchQuery,children:e}):""},{withNodes:!0}),e&&(0,se.Y)(he.A,{name:"next",className:md.nextIcon})]})})}),(0,se.Y)("div",{className:md.remainingSearches,children:m("RemainingPublicPostsSearch",{count:i},{pluralValue:i})})]})})})():(0,se.Y)("div",{className:md.container,children:(0,se.FD)("div",{className:md.content,children:[(0,se.Y)("div",{className:md.premiumTitle,children:m("GlobalSearch")}),(0,se.Y)("div",{className:md.premiumDescription,children:m("PublicPostsPremiumFeatureDescription")}),(0,se.Y)(X.A,{className:md.subscribePremiumButton,color:"primary",noForcedUpperCase:!0,onClick:b,children:m("PublicPostsSubscribeToPremium")}),(0,se.Y)("div",{className:md.premiumSubtitle,children:m("PublicPostsPremiumFeatureSubtitle")})]})})})})),vd=(0,be.nF)(e=>e(),500,!0),gd=(0,s.ph)((0,n.EK)(e=>{const{messages:{byChatId:t}}=e,{resultsByType:i,searchFlood:s,fetchingStatus:n}=(0,c.nTw)(e).globalSearch,o=i?.publicPosts,{foundIds:a}=o||{},r=Boolean(n?.publicPosts&&!o),l=!o&&!r,d=o&&!a?.length,{animationLevel:h}=(0,ks.lS)(e);return{foundIds:a,globalMessagesByChatId:t,searchFlood:s,shouldShowSearchLauncher:l,isNothingFound:d,isLoading:r,animationLevel:h}})(({searchQuery:e,foundIds:t,globalMessagesByChatId:i,searchFlood:a,shouldShowSearchLauncher:r,isNothingFound:l,isLoading:c,animationLevel:d})=>{const{searchMessagesGlobal:h}=(0,n.ko)(),m=(0,Fi.A)(),u=(0,T.A)(()=>{e&&h({type:"publicPosts",shouldResetResultsByType:!0})}),p=(0,s.hb)(({direction:e})=>{e===o.TN.Backwards&&vd(()=>{h({type:"publicPosts"})})},[]),v=(0,s.Kr)(()=>t&&0!==t.length?t.map(e=>{const[t,s]=(0,Cc.a)(e);return i?.[t]?.byId[s]}).filter(Boolean):hi.p,[t,i]);return(0,se.Y)(ae.Ay,{name:(0,ws.P)("slideOptimized",d,void 0,m.isRtl),activeKey:r||c?0:1,children:r||c?(0,se.Y)(pd,{searchQuery:e,searchFlood:a,onSearch:u,isLoading:c}):(0,se.Y)("div",{className:"LeftSearch--content",children:(0,se.FD)(ls.A,{className:"search-content custom-scroll chat-list",items:v,onLoadMore:p,noFastList:!0,children:[l&&(0,se.Y)(kc.A,{text:m("ChatListSearchNoResults"),description:m("ChatListSearchNoResultsDescription"),withSticker:!0}),Boolean(v.length)&&(0,se.FD)("div",{className:"pb-2",children:[(0,se.Y)("h3",{className:"section-heading",dir:m.isRtl?"auto":void 0,children:m("PublicPosts")}),v.map(function(t){const i=(0,n.mS)().chats.byId,s=(0,A.C)(m,t),o=i[t.chatId];if(s&&o)return(0,se.Y)(_c,{chatId:t.chatId,message:t,searchQuery:e},`${t.chatId}-${t.id}`)})]})]},e)})})})),Ad=[{type:o.$C.ChatList,key:"SearchTabChats"},{type:o.$C.ChannelList,key:"SearchTabChannels"},{type:o.$C.BotApps,key:"SearchTabApps"},{type:o.$C.PublicPosts,key:"SearchTabPublicPosts"},{type:o.$C.Media,key:"SearchTabMedia"},{type:o.$C.Links,key:"SearchTabLinks"},{type:o.$C.Files,key:"SearchTabFiles"},{type:o.$C.Music,key:"SearchTabMusic"},{type:o.$C.Voice,key:"SearchTabVoice"}],fd=[{type:o.$C.ChatList,key:"SearchTabMessages"},...Ad.slice(3)],bd=(0,s.ph)((0,n.EK)(e=>{const{currentContent:t,chatId:i}=(0,c.nTw)(e).globalSearch,{animationLevel:s}=(0,ks.lS)(e);return{currentContent:t,chatId:i,animationLevel:s}})(({searchQuery:e,searchDate:t,isActive:i,currentContent:a=o.$C.ChatList,chatId:r,animationLevel:l,onReset:c})=>{const{setGlobalSearchContent:d,setGlobalSearchDate:h,checkSearchPostsFlood:m}=(0,n.ko)(),u=(0,Fi.A)(),[p,v]=(0,s.J0)(a),g=(0,s.Kr)(()=>(0,We.Rm)(e),[e]);(0,s.vJ)(()=>{i&&m({})},[i]);const A=(0,s.Kr)(()=>(r?fd:Ad).map(e=>({...e,title:u(e.key)})),[r,u]),f=(0,T.A)(e=>{const t=A[e];d({content:t.type}),v(e)}),b=(0,T.A)(e=>{h({date:e.getTime()/1e3})});(0,Ne.A)({isActive:i,onBack:c});const C=(0,s.li)(),y=(0,Fs.A)(C,i,void 0,".ListItem-button",!0);return(0,se.FD)("div",{className:"LeftSearch",ref:C,onKeyDown:y,children:[(0,se.Y)(Ns.A,{activeTab:p,tabs:A,onSwitchTab:f}),(0,se.Y)(ae.Ay,{name:(0,ws.P)("slideOptimized",l,void 0,u.isRtl),renderCount:A.length,activeKey:a,children:(()=>{switch(a){case o.$C.ChatList:case o.$C.ChannelList:return r?(0,se.Y)(Gc,{searchQuery:e,dateSearchQuery:g,onReset:c,onSearchDateSelect:b}):(0,se.Y)(Qc,{isChannelList:a===o.$C.ChannelList,searchQuery:e,searchDate:t,dateSearchQuery:g,onReset:c,onSearchDateSelect:b});case o.$C.Media:return(0,se.Y)(cd,{searchQuery:e});case o.$C.Links:return(0,se.Y)(od,{searchQuery:e});case o.$C.Files:return(0,se.Y)(td,{searchQuery:e});case o.$C.Music:return(0,se.Y)(Ic,{searchQuery:e},"audio");case o.$C.Voice:return(0,se.Y)(Ic,{isVoice:!0,searchQuery:e},"voice");case o.$C.BotApps:return(0,se.Y)(Rc,{searchQuery:e},"botApps");case o.$C.PublicPosts:return(0,se.Y)(gd,{searchQuery:e},"publicPosts");default:return}})()})]})}));var Cd=i(42215);const yd={currentPassword:"",password:"",hint:"",email:""},Sd=(e,t)=>{switch(t.type){case"setCurrentPassword":return{...e,currentPassword:t.payload};case"setPassword":return{...e,password:t.payload};case"setHint":return{...e,hint:t.payload};case"setEmail":return{...e,email:t.payload};case"reset":return yd;default:return e}};var Nd=i(31880),kd=i(58968);const wd=(0,s.ph)((0,n.EK)(e=>({maxChats:(0,bs.d)(e,"dialogFiltersChats")}))(({mode:e,state:t,dispatch:i,isActive:o,onReset:r,onSaveFilter:l,maxChats:c})=>{const d=(0,B.A)(),{openLimitReachedModal:h}=(0,n.ko)(),{chatFilter:m}=t,{selectedChatIds:u,selectedChatTypes:p}=(0,s.Kr)(()=>(0,Nd.a)(t,e,!0),[e,t]),v="included"===e?kd.V2:kd.LS,[g,A]=(0,s.J0)(!1),f=(0,ys.Rh)(a.DSF),b=(0,ys.Rh)(a._E9),C=t.folder.isChatList;(0,s.vJ)(()=>{o||A(!1)},[o]);const y=(0,s.Kr)(()=>{const e=[...f||[],...b||[]];return(0,di.Am)([...(0,It.PU)({ids:e,query:m,type:"chat"})])},[f,b,m]),S=(0,T.A)(e=>{i({type:"setChatFilter",payload:e}),A(!0)}),N=(0,T.A)(s=>{if("included"===e){if(s.length>=c)return void h({limit:"dialogFiltersChats"});i({type:"setIncludeFilters",payload:{...t.includeFilters,includedChatIds:s}})}else i({type:"setExcludeFilters",payload:{...t.excludeFilters,excludedChatIds:s}});A(!0)}),k=(0,T.A)(t=>{const s={};t.forEach(e=>{s[e]=!0}),i("included"===e?{type:"setIncludeFilters",payload:{includedChatIds:u,...s}}:{type:"setExcludeFilters",payload:{excludedChatIds:u,...s}}),A(!0)});return(0,Ne.A)({isActive:o,onBack:r}),y?(0,se.FD)("div",{className:"Picker settings-folders-chat-list",children:[(0,se.Y)(mi.A,{categories:C?void 0:v,itemIds:y,selectedIds:u,selectedCategories:p,filterValue:m,filterPlaceholder:d("Search"),categoryPlaceholderKey:"FilterChatTypes",searchInputId:"new-group-picker-search",isSearchable:!0,withDefaultPadding:!0,withPeerTypes:!0,allowMultiple:!0,itemInputType:"checkbox",onSelectedIdsChange:N,onSelectedCategoriesChange:k,onFilterChange:S}),(0,se.Y)(pi.A,{isShown:g,onClick:l,ariaLabel:d("Save"),iconName:"check"})]}):(0,se.Y)(Ds.A,{})}));var Id=i(72167),Pd=i(98021);const Yd=(0,s.ph)(({isOpen:e,onEmojiSelect:t,onClose:i})=>{const n=(0,s.hb)(e=>{t(e),i()},[i,t]);return(0,se.Y)(Ze.A,{isOpen:e,positionX:"left",onClose:i,withPortal:!0,className:"settings-folders-icon-picker-menu SymbolMenu",children:(0,se.FD)("div",{className:"SymbolMenu-main",children:[(0,se.Y)("div",{className:"settings-folders-icon-picker-menu-folders",children:Object.keys(Pd.E6).map(e=>(0,se.Y)("div",{className:"EmojiButton",onClick:()=>n(e),children:(0,se.Y)(he.A,{name:Pd.E6[e]})}))}),(0,se.Y)(Yr,{idPrefix:"folder-emoji-set-",loadAndPlay:e,isHidden:!e,onCustomEmojiSelect:e=>n(e),onDismiss:i})]})})}),Fd=[0,1,2,3,4,5,6],Dd="Please provide a title for this folder.",Md="ChatList.Filter.Error.Empty",Td=(0,s.ph)((0,n.EK)((e,{state:t})=>{const{listIds:i}=e.chats,{byId:s,invites:n}=e.chatFolders,o=Object.values(s).reduce((e,t)=>e+(t.isChatList?1:0),0),a=(0,c.g29)(e);return{loadedActiveChatIds:i.active,loadedArchivedChatIds:i.archived,invites:t.folderId?n[t.folderId]||hi.p:void 0,isRemoved:void 0!==t.folderId&&!s[t.folderId],maxInviteLinks:(0,bs.d)(e,"chatlistInvites"),maxChatLists:(0,bs.d)(e,"chatlistJoined"),chatListCount:o,isCurrentUserPremium:a}})(({state:e,dispatch:t,onAddIncludedChats:i,onAddExcludedChats:o,onShareFolder:r,onOpenInvite:l,isActive:d,onReset:h,isRemoved:m,onBack:u,loadedActiveChatIds:p,isOnlyInvites:g,loadedArchivedChatIds:A,invites:f,maxInviteLinks:b,maxChatLists:C,chatListCount:y,onSaveFolder:S,isCurrentUserPremium:N,isMobile:k})=>{const{loadChatlistInvites:w,openLimitReachedModal:I,showNotification:P,openPremiumModal:Y}=(0,n.ko)(),F="create"===e.mode,D=e.folder.isChatList,[M,L]=(0,s.J0)(!1),[R,x]=(0,s.J0)(!1),[E,V]=(0,s.J0)(!1);(0,s.vJ)(()=>{m&&h()},[m,h]),(0,s.vJ)(()=>{d&&e.folderId&&e.folder.isChatList&&w({folderId:e.folderId})},[d,e.folder.isChatList,e.folderId]);const{selectedChatIds:_,selectedChatTypes:U}=(0,s.Kr)(()=>(0,Nd.a)(e,"included"),[e]),{selectedChatIds:O,selectedChatTypes:K}=(0,s.Kr)(()=>(0,Nd.a)(e,"excluded"),[e]);(0,s.vJ)(()=>{L(!1),x(!1)},[e.folderId]);const[J,j]=(0,s.Kr)(()=>{const e=new Set([...p||[],...A||[]]),t=(0,di.$h)(_,e),i=(0,di.$h)(O,e);return[M?t:t.slice(0,5-U.length),R?i:i.slice(0,5-K.length)]},[O,_,U,K,R,M,p,A]),z=(0,B.A)();(0,Ne.A)({isActive:d,onBack:u});const H=(0,s.Kr)(()=>e.folder.title.entities?.find(e=>e.type===G.C7.CustomEmoji&&0===e.offset),[e.folder.title]),$=(0,s.Kr)(()=>a.kGl-(H?H.length:0),[H]),q=(0,s.hb)(i=>{let s=e.folder.title.text;const n=[];let o="ðŸ—‚";if(H){const{offset:e,length:t}=H;s=s.replace(s.substring(e,e+t),"")}if("string"==typeof i)o=i;else{const{id:e,emoji:t}=i;n.push({type:G.C7.CustomEmoji,documentId:e,offset:0,length:t?.length||2}),t&&(s=`${t}${s}`,o=t,s.length>$&&(s=s.slice(0,$)))}t({type:"setEmoticon",payload:o}),t({type:"setTitle",payload:{text:s,entities:n}})},[t,H,e.folder.title,$]),W=(0,s.hb)(e=>{const{currentTarget:i}=e;let s=i.value;if(H){const{emoji:e}=(0,c.O8F)((0,n.mS)(),H.documentId);s=`${e}${s}`}t({type:"setTitle",payload:{text:s,entities:H?[H]:[]}})},[t,H]),Q=(0,s.hb)(()=>{t({type:"setIsLoading",payload:!0}),S(()=>{setTimeout(()=>{h()},500)})},[t,S,h]),Z=(0,s.hb)(()=>{f?(0,c.w5O)((0,n.mS)(),e.folderId)?y>=C&&!e.folder.isChatList?I({limit:"chatlistJoined"}):f.length<b?e.isTouched?S(r):r():I({limit:"chatlistInvites"}):P({message:z("ChatList.Filter.InviteLink.IncludeExcludeError")}):F&&S(r)},[f,e.folderId,e.isTouched,y,b,F,S,r,z,C,e.folder.isChatList]),X=(0,s.hb)((t,i)=>{e.isTouched?S(()=>l(i)):l(i)},[S,l,e.isTouched]);function te(e){const t="included"===e?U:K,i="included"===e?J:j,s="included"===e?M:R,n=("included"===e?_:O).length-i.length,o="included"===e?()=>L(!0):()=>x(!0);return(0,se.FD)(se.FK,{children:[t.map(t=>function(e,t){const i="included"===t?kd.V2.find(({type:t})=>t===e):kd.LS.find(({type:t})=>t===e);if(i)return(0,se.Y)(li.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0,children:(0,se.Y)(ms.A,{avatarSize:"small",customPeer:i})},i.type)}(t,e)),i.map(e=>(0,se.Y)(li.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0,children:(0,v.L8)(e)?(0,se.Y)(ms.A,{avatarSize:"small",userId:e}):(0,se.Y)(hs.A,{avatarSize:"small",chatId:e})})),!s&&n>0&&(0,se.Y)(li.A,{className:"settings-folders-list-item",narrow:!0,onClick:o,icon:"down",children:z("FilterShowMoreChats",n,"i")},"load-more")]})}const ie=(0,T.A)(e=>{q(e)}),ne=(0,T.A)(()=>{V(!1)}),oe=(0,T.A)(()=>{V(!0)}),ae=(0,s.Kr)(()=>{let t=e.folder.title.text;if(H){const{offset:e,length:i}=H;t=t.substring(e+i,t.length)}return t},[e.folder.title.text,H]);return(0,se.FD)("div",{className:"settings-fab-wrapper",children:[(0,se.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header",children:[(0,se.Y)(pr.A,{size:a.fwn,tgsUrl:ur.w.FoldersNew,play:String(e.folderId),className:"settings-content-icon"}),F&&(0,se.Y)("p",{className:"settings-item-description mb-3",dir:z.isRtl?"rtl":void 0,children:z("FilterIncludeInfo")}),(0,se.FD)("div",{className:"settings-folders-input-container",children:[(0,se.Y)(ee.A,{className:(0,ge.A)("mb-0",!k&&"settings-folders-input-with-icon"),label:z("FilterNameHint"),value:ae,maxLength:$,onChange:W,error:e.error&&e.error===Dd?Dd:void 0}),!k&&(0,se.FD)("div",{className:"settings-folders-icon-picker",dir:z.isRtl?"rtl":void 0,children:[(0,se.Y)("div",{className:"settings-folders-icon-picker-button",onClick:oe,children:(0,se.Y)(Id.A,{emoji:e.folder.emoticon,customEmojiId:H?.documentId,shouldAnimate:e.folder.noTitleAnimations})}),(0,se.Y)(Yd,{isOpen:E,onEmojiSelect:ie,onClose:ne})]})]})]}),!g&&(0,se.FD)("div",{className:"settings-item",children:[e.error&&e.error===Md&&(0,se.Y)("p",{className:"settings-item-description color-danger mb-2",dir:z.isRtl?"rtl":void 0,children:z(e.error)}),(0,se.Y)("h4",{className:"settings-item-header mb-3",dir:z.isRtl?"rtl":void 0,children:z("FilterInclude")}),(0,se.Y)(li.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:i,children:z("FilterAddChats")}),te("included")]}),!g&&!D&&(0,se.FD)("div",{className:"settings-item pt-3",children:[(0,se.Y)("h4",{className:"settings-item-header mb-3",dir:z.isRtl?"rtl":void 0,children:z("FilterExclude")}),(0,se.Y)(li.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:o,children:z("FilterAddChats")}),te("excluded")]}),(0,se.FD)("div",{className:"settings-item pt-3",children:[(0,se.FD)("h4",{className:"settings-item-header mb-3 color-picker-header",dir:z.isRtl?"rtl":void 0,children:[(0,se.Y)("span",{className:"color-picker-title-text",children:z("FilterColorTitle")}),(0,se.Y)("div",{className:(0,ge.A)("color-picker-title","color-picker-selected-color",N&&void 0!==e.folder.color&&-1!==e.folder.color?(0,Ji.yp)(e.folder.color):"color-picker-item-disabled"),children:(0,Oi.fd)({text:e.folder.title.text,entities:e.folder.title.entities,noCustomEmojiPlayback:e.folder.noTitleAnimations})})]}),(0,se.FD)("div",{className:"color-picker custom-scroll-x",children:[Fd.map(i=>(0,se.Y)("button",{type:"button",onClick:()=>{N?t({type:"setColor",payload:i}):Y()},className:(0,ge.A)("color-picker-item",(0,Ji.yp)(i),!N&&"color-picker-item-hover-disabled",i===e.folder.color&&N&&"color-picker-item-active")},i)),(0,se.Y)("button",{type:"button",onClick:()=>{N?t({type:"setColor",payload:void 0}):Y()},className:(0,ge.A)("color-picker-item","color-picker-item-none",(void 0===e.folder.color||-1===e.folder.color||!N)&&"color-picker-item-active"),children:N?(0,se.Y)(he.A,{name:"close",className:"color-picker-item-none-icon"}):(0,se.Y)(he.A,{name:"lock-badge",className:"color-picker-item-none-icon"})})]}),(0,se.Y)("p",{className:"settings-item-description mb-0 mt-3",dir:z.isRtl?"rtl":void 0,children:z("FilterColorHint")})]}),(0,se.FD)("div",{className:"settings-item pt-3",children:[(0,se.Y)("h4",{className:"settings-item-header mb-3",dir:z.isRtl?"rtl":void 0,children:z("FolderLinkScreen.Title")}),(0,se.Y)(li.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:Z,children:z("ChatListFilter.CreateLinkNew")}),f?.map(e=>(0,se.FD)(li.A,{className:"settings-folders-list-item",icon:"link",narrow:!0,multiline:!0,onClick:X,clickArg:e.url,children:[(0,se.Y)("span",{className:"title",dir:"auto",children:e.title||e.url}),(0,se.Y)("span",{className:"subtitle",children:z("ChatListFilter.LinkLabelChatCount",e.peerIds.length,"i")})]}))]})]}),(0,se.Y)(pi.A,{isShown:Boolean(e.isTouched),disabled:e.isLoading,onClick:Q,ariaLabel:"edit"===e.mode?"Save changes":"Create folder",iconName:"check",isLoading:e.isLoading})]})}));var Bd=i(80401);const Ld=(0,be.nF)(e=>e(),6e4,!0),Rd=(0,s.ph)((0,n.EK)(e=>{const{orderedIds:t,byId:i,recommended:s,areTagsEnabled:n}=e.chatFolders;return{folderIds:t,foldersById:i,isPremium:(0,c.g29)(e),recommendedChatFolders:s,maxFolders:(0,bs.d)(e,"dialogFilters"),areTagsEnabled:n,foldersPosition:e.sharedState.settings.foldersPosition}})(({isActive:e,foldersById:t,isPremium:i,recommendedChatFolders:o,maxFolders:r,areTagsEnabled:c,foldersPosition:d,isMobile:h,onCreateFolder:m,onEditFolder:u,onReset:p,folderIds:v})=>{const{loadRecommendedChatFolders:g,addChatFolder:A,openLimitReachedModal:f,openDeleteChatFolderModal:b,sortChatFolders:C,toggleDialogFilterTags:y,openPremiumModal:S,setSharedSettingOption:N}=(0,n.ko)(),[k,w]=(0,s.J0)({orderedFolderIds:v,dragOrderIds:v,draggedIndex:void 0}),I=(0,K.A)(v);(0,s.vJ)(()=>{I!==v&&w({orderedFolderIds:v,dragOrderIds:v,draggedIndex:void 0})},[I,v,k.orderedFolderIds?.length]),(0,s.vJ)(()=>{Ld(()=>{g()})},[g]);const P=(0,s.hb)(()=>{Object.keys(t).length>=r-1?f({limit:"dialogFilters"}):m()},[t,r,m,f]),Y=(0,Fi.A)();(0,Ne.A)({isActive:e,onBack:p});const F=(0,ys.g5)(),D=(0,s.Kr)(()=>{if(v)return v.length<=1?hi.p:v.map(e=>{const i=t[e];return e===a.DSF?{id:e,title:{text:Y("FilterAllChats"),entities:[]}}:{id:i.id,title:i.title,subtitle:(0,l.A5)(Y,i,F[i.id]),isChatList:i.isChatList,color:i.color,noTitleAnimations:i.noTitleAnimations}})},[v,t,Y,F]),M=(0,s.hb)(e=>{Object.keys(t).length>=r-1?f({limit:"dialogFilters"}):A({folder:e})},[t,r,A,f]),B=(0,s.hb)(()=>{i&&y({isEnabled:!c})},[c,i,y]),L=(0,s.hb)((e,t)=>{const s=Math.round(e.y/56),n=k.orderedFolderIds?.indexOf(t)||0,o=k.orderedFolderIds?.filter(e=>e!==t);o&&(0,fe.Bt)(n+s,0,v?.length||0)&&(o.splice(n+s+(i?0:1),0,t),w(e=>({...e,draggedIndex:n,dragOrderIds:o})))},[v?.length,i,k.orderedFolderIds]),R=(0,s.hb)(()=>{w(e=>(C({folderIds:e.dragOrderIds}),{...e,orderedFolderIds:e.dragOrderIds,draggedIndex:void 0}))},[C]),x=(0,T.A)(e=>{N({foldersPosition:e})}),E=(0,s.Kr)(()=>!i||Object.keys(t).length<r-1,[t,i,r]);return(0,se.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header",children:[(0,se.Y)(pr.A,{size:a.fwn,tgsUrl:ur.w.FoldersAll,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:Y("CreateNewFilterInfo")}),E&&(0,se.Y)(X.A,{className:"settings-button with-icon",color:"primary",pill:!0,fluid:!0,onClick:P,isRtl:Y.isRtl,iconName:"add",children:Y("CreateNewFilter")})]}),(0,se.FD)("div",{className:"settings-item pt-3",children:[(0,se.Y)("h4",{className:"settings-item-header mb-3",dir:Y.isRtl?"rtl":void 0,children:Y("Filters")}),(0,se.Y)("div",{className:"settings-sortable-container",style:`height: ${56*(v?.length||0)}px`,children:D?.length?D.map((s,n)=>{const o=n>r-1,l=k.draggedIndex===n,d=56*(k.orderedFolderIds?.indexOf(s.id)??0),h=56*(k.dragOrderIds?.indexOf(s.id)??0),m=void 0!==s?.color&&-1!==s.color&&c;return s.id===a.DSF?(0,se.Y)(Bd.A,{id:s.id,onDrag:L,onDragEnd:R,style:`top: ${l?d:h}px;`,knobStyle:(Y.isRtl?"left":"right")+": 0.375rem;",isDisabled:!i||!e,children:(0,se.FD)(li.A,{className:"drag-item no-icon settings-sortable-item",narrow:!0,inactive:!0,multiline:!0,isStatic:!0,allowSelection:!0,children:[(0,se.Y)("span",{className:"title",children:(0,Oi.fd)({text:s.title.text,entities:s.title.entities,noCustomEmojiPlayback:s.noTitleAnimations})}),(0,se.Y)("span",{className:"subtitle",children:Y("FoldersAllChatsDesc")})]},s.id)},s.id):(0,se.Y)(Bd.A,{id:s.id,onDrag:L,onDragEnd:R,style:`top: ${l?d:h}px;`,knobStyle:`${Y.isRtl?"left":"right"}: ${m?"4rem":"2.5rem"};`,isDisabled:o||!e,children:(0,se.FD)(li.A,{className:"drag-item no-icon settings-sortable-item",narrow:!0,secondaryIcon:"more",multiline:!0,contextActions:[{handler:()=>{b({folderId:s.id})},destructive:!0,title:Y("Delete"),icon:"delete"}],onClick:()=>{o?f({limit:"dialogFilters"}):u(t[s.id])},children:[(0,se.FD)("span",{className:"title",children:[(0,Oi.fd)({text:s.title.text,entities:s.title.entities,noCustomEmojiPlayback:s.noTitleAnimations}),o&&(0,se.Y)(he.A,{name:"lock-badge",className:"settings-folders-blocked-icon"})]}),(0,se.FD)("span",{className:"subtitle",children:[s.isChatList&&(0,se.Y)(he.A,{name:"link",className:"mr-1"}),s.subtitle]}),m&&(0,se.Y)("div",{className:(0,ge.A)("settings-folders-color-circle",void 0!==s.color&&-1!==s.color&&(0,Ji.yp)(s.color))})]})},s.id)}):D&&!D.length?(0,se.Y)("p",{className:"settings-item-description my-4",dir:"auto",children:Y("SettingsFoldersEmpty")}):(0,se.Y)(Ds.A,{})})]}),o&&Boolean(o.length)&&(0,se.FD)("div",{className:"settings-item pt-3",children:[(0,se.Y)("h4",{className:"settings-item-header mb-3",dir:Y.isRtl?"rtl":void 0,children:Y("FilterRecommended")}),o.map(e=>(0,se.Y)(li.A,{narrow:!0,onClick:()=>M(e),children:(0,se.FD)("div",{className:"settings-folders-recommended-item",children:[(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:(0,Oi.fd)({text:e.title.text,entities:e.title.entities,noCustomEmojiPlayback:e.noTitleAnimations})}),(0,se.Y)("span",{className:"subtitle",children:e.description})]}),(0,se.Y)(X.A,{className:"px-3",color:"primary",size:"tiny",pill:!0,fluid:!0,isRtl:Y.isRtl,children:Y("Add")})]})}))]}),(0,se.Y)("div",{className:"settings-item pt-3",children:(0,se.FD)("div",{className:"settings-item-relative",children:[(0,se.Y)(Hs.A,{label:Y("ShowFolderTags"),subLabel:Y("ShowFolderTagsHint"),checked:i&&c,onChange:B,onClickLabel:e=>{i||(e.preventDefault(),S())}}),!i&&(0,se.Y)(he.A,{name:"lock-badge",className:"settings-folders-lock-icon"})]})}),!h&&(0,se.FD)("div",{className:"settings-item pt-3",children:[(0,se.Y)("h4",{className:"settings-item-header mb-3",dir:Y.isRtl?"rtl":void 0,children:Y("TabsPosition")}),(0,se.Y)(ie.A,{name:"tabsPosition",options:[{label:Y("TabsPositionLeft"),value:a._C3},{label:Y("TabsPositionTop"),value:a.ATy}],selected:d,onChange:x})]})]})}));var xd=i(4438);const Ed=(0,s.ph)((0,n.EK)(e=>{const{folderId:t,url:i,isLoading:s}=(0,c.nTw)(e).shareFolderScreen||{},n=t?(0,c.$aQ)(e,t):void 0,o=t?e.chatFolders.invites[t]?.find(e=>e.url===i):void 0;return{folderId:t,folder:n,url:i,isLoading:s,peerIds:o?.peerIds}})(({isActive:e,onReset:t,folderId:i,folder:o,peerIds:r,url:d,isLoading:h})=>{const{createChatlistInvite:m,deleteChatlistInvite:u,editChatlistInvite:p,showNotification:v}=(0,n.ko)(),g=(0,Fi.A)(),A=(0,B.A)(),[f,b]=(0,s.J0)(!1);(0,Ne.A)({isActive:e,onBack:t}),(0,s.vJ)(()=>{h||b(!1)},[h]),(0,s.vJ)(()=>{!d&&i&&e&&m({folderId:i})},[i,e,d]);const C=(0,T.A)(()=>{d&&i&&(u({folderId:i,url:d}),t())}),y=(0,s.Kr)(()=>(o?.includedChatIds||[]).concat(o?.pinnedChatIds||[]),[o?.includedChatIds,o?.pinnedChatIds]),[S,N]=(0,s.Kr)(()=>{const e=(0,n.mS)();return(0,di.jB)(y,t=>(0,c.hXb)(e,t))},[y]),[k,w]=(0,s.J0)(r||[]),I=(0,s.li)(!0);(0,F.A)(([e])=>{e!==d&&(I.current=!0),I.current&&(I.current=!1,d?r&&w(r):w(S))},[d,S,r]);const P=(0,T.A)(e=>{const t=(0,n.mS)(),i=(0,c.mBe)(t,e),s=(0,c.hds)(t,e);i&&(0,l.tv)(i)?v({message:A("FolderLinkScreen.AlertTextUnavailableBot")}):i?v({message:A("FolderLinkScreen.AlertTextUnavailableUser")}):s&&(0,l.WX)(s)?v({message:A("FolderLinkScreen.AlertTextUnavailablePublicChannel")}):v({message:A("FolderLinkScreen.AlertTextUnavailablePublicGroup")})}),Y=(0,T.A)(e=>{w(e),b(!0)}),D=(0,T.A)(()=>{i&&d&&f&&p({folderId:i,peerIds:k,url:d})}),M=k.length,L=!M||h;return(0,se.FD)("div",{className:"settings-content no-border custom-scroll SettingsFoldersChatsPicker",children:[(0,se.FD)("div",{className:"settings-content-header",children:[(0,se.Y)(xd.A,{size:a.fwn,tgsUrl:ur.w.FoldersShare,className:"settings-content-icon"}),o&&(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:g("FolderLinkTitleDescription",{folder:(0,Oi.fd)({text:o.title.text,entities:o.title.entities,noCustomEmojiPlayback:o.noTitleAnimations}),chats:g("FolderLinkTitleDescriptionChats",{count:M},{pluralValue:M})},{withMarkdown:!0,withNodes:!0})})]}),(0,se.Y)(_r.A,{className:"settings-item",link:d||A("Loading"),withShare:!0,onRevoke:C,isDisabled:!M||f}),(0,se.Y)("div",{className:"settings-item settings-item-picker",children:(0,se.Y)(mi.A,{itemIds:y,lockedUnselectedIds:N,onSelectedIdsChange:Y,selectedIds:k,onDisabledClick:P,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})}),(0,se.Y)(pi.A,{isShown:h||f,disabled:L,onClick:D,ariaLabel:"Save changes",iconName:"check",isLoading:h})]})})),Vd=(0,s.ph)(({currentScreen:e,shownScreen:t,state:i,dispatch:a,isActive:r,onReset:l})=>{const{isMobile:c}=(0,Y.Ay)(),{openShareChatFolderModal:d,editChatFolder:h,addChatFolder:m,openSettingsScreen:u}=(0,n.ko)(),p=(0,s.hb)(()=>{e!==o.VS.FoldersCreateFolder&&e!==o.VS.FoldersEditFolder&&e!==o.VS.FoldersEditFolderFromChatList&&e!==o.VS.FoldersEditFolderInvites||setTimeout(()=>{a({type:"reset"})},200),e!==o.VS.FoldersIncludedChats&&e!==o.VS.FoldersExcludedChats?l():"create"===i.mode?u({screen:o.VS.FoldersCreateFolder}):u({screen:o.VS.FoldersEditFolder})},[i.mode,a,e,l]),v="create"===i.mode,g=(0,s.hb)(e=>{const{title:{text:t}}=e.folder;if(!t)return a({type:"setError",payload:Dd}),!1;const{selectedChatIds:i,selectedChatTypes:s}=(0,Nd.a)(e,"included");return i.length||Object.keys(s).length?(v?m({folder:e.folder}):h({id:e.folderId,folderUpdate:e.folder}),a({type:"setError",payload:void 0}),a({type:"setIsTouched",payload:!1}),!0):(a({type:"setError",payload:Md}),!1)},[a,v]),A=(0,s.hb)(e=>{g(i)&&e?.()},[g,i]),f=(0,s.hb)(()=>{a({type:"saveFilters"}),p()},[a,p]),b=(0,s.hb)(()=>{a({type:"reset"}),u({screen:o.VS.FoldersCreateFolder})},[a]),C=(0,s.hb)(e=>{a({type:"editFolder",payload:e}),u({screen:o.VS.FoldersEditFolder})},[a]),y=(0,s.hb)(()=>{a({type:"editIncludeFilters"}),u({screen:e===o.VS.FoldersEditFolderFromChatList?o.VS.FoldersIncludedChatsFromChatList:o.VS.FoldersIncludedChats})},[e,a]),S=(0,s.hb)(()=>{a({type:"editExcludeFilters"}),u({screen:e===o.VS.FoldersEditFolderFromChatList?o.VS.FoldersExcludedChatsFromChatList:o.VS.FoldersExcludedChats})},[e,a]),N=(0,s.hb)(()=>{d({folderId:i.folderId,noRequestNextScreen:!0}),a({type:"setIsChatlist",payload:!0}),u({screen:o.VS.FoldersShare})},[a,i.folderId]),k=(0,s.hb)(e=>{d({folderId:i.folderId,url:e,noRequestNextScreen:!0}),u({screen:o.VS.FoldersShare})},[i.folderId]);switch(e){case o.VS.Folders:return(0,se.Y)(Rd,{onCreateFolder:b,onEditFolder:C,isActive:r||[o.VS.FoldersCreateFolder,o.VS.FoldersEditFolder,o.VS.FoldersIncludedChats,o.VS.FoldersExcludedChats].includes(t),onReset:l,isMobile:c});case o.VS.FoldersCreateFolder:case o.VS.FoldersEditFolder:case o.VS.FoldersEditFolderFromChatList:case o.VS.FoldersEditFolderInvites:return(0,se.Y)(Td,{state:i,dispatch:a,onAddIncludedChats:y,onAddExcludedChats:S,onShareFolder:N,onOpenInvite:k,onReset:p,isActive:r||[o.VS.FoldersIncludedChats,o.VS.FoldersExcludedChats].includes(t),isOnlyInvites:e===o.VS.FoldersEditFolderInvites,onBack:l,onSaveFolder:A,isMobile:c});case o.VS.FoldersIncludedChats:case o.VS.FoldersIncludedChatsFromChatList:return(0,se.Y)(wd,{mode:"included",state:i,dispatch:a,onReset:p,onSaveFilter:f,isActive:r});case o.VS.FoldersExcludedChats:case o.VS.FoldersExcludedChatsFromChatList:return(0,se.Y)(wd,{mode:"excluded",state:i,dispatch:a,onReset:p,onSaveFilter:f,isActive:r});case o.VS.FoldersShare:return(0,se.Y)(Ed,{isActive:r,onReset:p});default:return}});var _d=i(70934),Ud=i(3178);const Od=(0,s.ph)(({isActive:e,error:t,isLoading:i,shouldDisablePasswordManager:n,expectedPassword:o,placeholder:a,hint:r,submitLabel:l,onSubmit:c,onClearError:d,onReset:h})=>{const[m,u]=(0,s.J0)(""),[p,v]=(0,s.J0)(!1),g=(0,Fi.A)(),A=(0,s.hb)(e=>{o&&e!==o?u(g("SettingsPasswordEqual")):c(e)},[c,o,g]),f=(0,s.hb)(()=>{d&&d(),u("")},[d]);return(0,Ne.A)({isActive:e,onBack:h}),(0,se.FD)("div",{className:"settings-content password-form custom-scroll",children:[(0,se.Y)("div",{className:"settings-content-header no-border",children:(0,se.Y)(Ud.A,{isBig:!0,isPasswordVisible:p})}),(0,se.Y)("div",{className:"settings-item settings-group",children:(0,se.Y)(Al.A,{error:m||t,hint:r,placeholder:a||g("CurrentPasswordPlaceholder"),shouldDisablePasswordManager:n,submitLabel:l,onClearError:f,isLoading:i,isPasswordVisible:p,shouldResetValue:e,onChangePasswordVisibility:v,onSubmit:A})})]})}),Kd=(0,s.ph)(({isActive:e,onReset:t})=>{const i=(0,B.A)(),n=(0,s.hb)(()=>{t(!0)},[t]);return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(xd.A,{size:a.BYH,tgsUrl:ur.w.Congratulations,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Congratulations!"}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Now you can lock the app with a passcode so that others can't open it."})]}),(0,se.Y)("div",{className:"settings-item settings-group",children:(0,se.Y)(X.A,{onClick:n,children:i("Back")})})]})});var Jd=i(89704);const Gd=(0,s.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,n.ko)(),s=(0,B.A)();return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Lock,previewUrl:Jd,size:160,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Local passcode is enabled."})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{icon:"edit",onClick:()=>i({screen:o.VS.PasscodeChangePasscodeCurrent}),children:s("Passcode.Change")}),(0,se.Y)(li.A,{icon:"password-off",onClick:()=>i({screen:o.VS.PasscodeTurnOff}),children:s("Passcode.TurnOff")})]})]})}),jd=(0,s.ph)(({isActive:e,onReset:t,onStart:i})=>{const s=(0,Fi.A)();return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Lock,previewUrl:Jd,size:a.BYH,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description",dir:"auto",children:s("SettingsPasscodeStart1",void 0,{withNodes:!0,renderTextFilters:["br"]})}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:s("SettingsPasscodeStart2",void 0,{withNodes:!0,renderTextFilters:["br"]})})]}),(0,se.Y)("div",{className:"settings-item settings-group",children:(0,se.Y)(X.A,{onClick:i,children:s("EnablePasscode")})})]})}),zd=(0,s.ph)((0,n.EK)(e=>({...e.passcode}))(({passcode:e,currentScreen:t,shownScreen:i,error:a,isActive:r,isLoading:l,onSetPasscode:c,onReset:d})=>{const{setPasscode:h,clearPasscode:m,setPasscodeError:u,clearPasscodeError:p,openSettingsScreen:v}=(0,n.ko)(),g=(0,B.A)(),A=(0,s.hb)(()=>{c(""),v({screen:o.VS.PasscodeNewPasscode})},[c]),f=(0,s.hb)(e=>{c(e),v({screen:o.VS.PasscodeNewPasscodeConfirm})},[c]),b=(0,s.hb)(()=>{h({passcode:e}),c(""),v({screen:o.VS.PasscodeCongratulations})},[c,e]),C=(0,s.hb)(e=>{c(""),(0,_d.UQ)(e).then(()=>{v({screen:o.VS.PasscodeChangePasscodeNew})},()=>{u({error:g("PasscodeController.Error.Current")})})},[g,c]),y=(0,s.hb)(e=>{c(e),v({screen:o.VS.PasscodeChangePasscodeConfirm})},[c]),S=(0,s.hb)(e=>{(0,_d.UQ)(e).then(()=>{m(),v({screen:o.VS.Privacy})},()=>{u({error:g("PasscodeController.Error.Current")})})},[g]);switch(t){case o.VS.PasscodeDisabled:return(0,se.Y)(jd,{onStart:A,isActive:r||[o.VS.PasscodeNewPasscode,o.VS.PasscodeNewPasscodeConfirm,o.VS.PasscodeCongratulations].includes(i),onReset:d});case o.VS.PasscodeNewPasscode:return(0,se.Y)(Od,{shouldDisablePasswordManager:!0,placeholder:g("EnterNewPasscode"),submitLabel:g("Continue"),onSubmit:f,isActive:r||[o.VS.PasscodeNewPasscodeConfirm,o.VS.PasscodeCongratulations].includes(i),onReset:d});case o.VS.PasscodeNewPasscodeConfirm:return(0,se.Y)(Od,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:g("ReEnterYourPasscode"),submitLabel:g("Continue"),isLoading:l,onSubmit:b,isActive:r||[o.VS.PasscodeCongratulations].includes(i),onReset:d});case o.VS.PasscodeCongratulations:return(0,se.Y)(Kd,{isActive:r,onReset:d});case o.VS.PasscodeEnabled:return(0,se.Y)(Gd,{isActive:r||[o.VS.PasscodeChangePasscodeCurrent,o.VS.PasscodeChangePasscodeNew,o.VS.PasscodeChangePasscodeConfirm,o.VS.PasscodeCongratulations,o.VS.PasscodeTurnOff].includes(i),onReset:d});case o.VS.PasscodeChangePasscodeCurrent:return(0,se.Y)(Od,{shouldDisablePasswordManager:!0,error:a,onClearError:p,placeholder:g("PasscodeController.Current.Placeholder"),onSubmit:C,isActive:r||[o.VS.PasscodeChangePasscodeNew,o.VS.PasscodeChangePasscodeConfirm,o.VS.PasscodeCongratulations].includes(i),onReset:d});case o.VS.PasscodeChangePasscodeNew:return(0,se.Y)(Od,{shouldDisablePasswordManager:!0,placeholder:g("PleaseEnterNewFirstPassword"),onSubmit:y,isActive:r||[o.VS.PasscodeChangePasscodeConfirm,o.VS.PasscodeCongratulations].includes(i),onReset:d});case o.VS.PasscodeChangePasscodeConfirm:return(0,se.Y)(Od,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:g("PasscodeController.ReEnterPasscode.Placeholder"),isLoading:l,onSubmit:b,isActive:r||[o.VS.PasscodeCongratulations].includes(i),onReset:d});case o.VS.PasscodeTurnOff:return(0,se.Y)(Od,{shouldDisablePasswordManager:!0,error:a?g(a):void 0,onClearError:p,placeholder:g("PasscodeController.Current.Placeholder"),onSubmit:S,isActive:r,onReset:d});default:return}})),Hd=[50,100,500,1e3,2e3,5e3,1e4];function $d(e,t){const i=e.findIndex(e=>t<=e),s=e[i-1]||1,n=e[i]||e[e.length-1];return i+(t-s)/(n-s)}function qd(e,t){const i=Math.floor(t),s=e[i-1]||1,n=s+((e[i]||e[e.length-1])-s)*(t-i);return n<100?Math.round(n):10*Math.round(n/10)}const Wd=(0,s.ph)(({min:e=0,max:t,value:i,disabled:n,readOnly:o,bold:a,className:r,defaultValue:l,onChange:c,canChangeChargeForMessages:d})=>{const h=(0,Fi.A)(),m=(0,s.Kr)(()=>{const e=[];for(let i=0;i<Hd.length;i++)if(Hd[i]<t&&e.push(Hd[i]),Hd[i]>=t){e.push(t);break}return e},[t]),u=(0,T.A)(e=>{const t=Number(e.currentTarget.value);c(qd(m,t))}),p=(0,ge.A)(r,"RangeSlider",n&&"disabled",o&&"readOnly",a&&"bold");return(0,se.FD)("div",{className:p,children:[(0,se.FD)("div",{className:"slider-top-row",dir:h.isRtl?"rtl":void 0,children:[(0,se.Y)("span",{className:"value-min",dir:"auto",children:h.number(e)}),(0,se.FD)("span",{className:"settings-range-value",children:[!d&&(0,se.Y)(he.A,{name:"lock-badge"}),(0,wi.Kk)(h,qd(m,$d(m,i)))]}),(0,se.Y)("span",{className:"value-max",dir:"auto",children:h.number(t)})]}),(0,se.FD)("div",{className:"slider-main",children:[(0,se.Y)("div",{className:"slider-fill-track",style:`width: ${$d(m,i)/m.length*100}%`}),(0,se.Y)("input",{min:0,max:m.length,defaultValue:$d(m,l),step:"any",type:"range",className:"RangeSlider__input",onChange:u})]})]})}),Qd=(0,s.ph)((0,n.EK)(e=>{const t=e.appConfig.starsUsdWithdrawRateX1000,i=t?t/1e3:1,s=e.appConfig.starsPaidMessageCommissionPermille;return{starsPaidMessageCommissionPermille:s?s/1e3:100,starsUsdWithdrawRate:i,starsPaidMessageAmountMax:e.appConfig.starsPaidMessageAmountMax||a.$$v}})(function({starsUsdWithdrawRate:e,starsPaidMessageAmountMax:t,starsPaidMessageCommissionPermille:i,canChangeChargeForMessages:s,isGroupChat:o,chargeForMessages:r,onChange:l}){const{openPremiumModal:c}=(0,n.ko)(),d=(0,Fi.A)(),h=(0,T.A)(e=>{l?.(e)}),m=(0,T.A)(()=>{c({initialSection:"message_privacy"})});return(0,se.FD)(se.FK,{children:[(0,se.Y)("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0,children:d("SectionTitleStarsForForMessages")}),(0,se.Y)(Wd,{defaultValue:r,min:a.BSg,max:t,value:r,onChange:h,canChangeChargeForMessages:s,readOnly:!s}),!s&&(0,se.Y)(X.A,{color:"primary",fluid:!0,noForcedUpperCase:!0,className:"settings-unlock-button",onClick:m,children:(0,se.FD)("span",{className:"settings-unlock-button-title",children:[d("UnlockButtonTitle"),(0,se.Y)(he.A,{name:"lock-badge",className:"settings-unlock-button-icon"})]})}),s&&(0,se.Y)("p",{className:"settings-item-description-larger",dir:d.isRtl?"rtl":void 0,children:d(o?"SetPriceGroupDescription":"SectionDescriptionStarsForForMessages",{percent:(0,bn.l9)(100*i),amount:(0,oo.Ad)(r*e*i,"USD",d.code)},{withNodes:!0})})]})}));var Zd=i(9267);const Xd=(0,s.ph)(function({premiumSection:e}){const{openPremiumModal:t}=(0,n.ko)(),i=(0,B.A)(),s=(0,T.A)(()=>t({initialSection:e}));return(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{leftElement:(0,se.Y)(Zd.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:s,children:i("PrivacyLastSeenPremium")}),(0,se.Y)("p",{className:"settings-item-description-larger premium-info",dir:i.isRtl?"rtl":void 0,children:i("lng_messages_privacy_premium_about")})]})}),eh=(0,s.ph)(function({label:e,isChecked:t}){const i=(0,B.A)(),{showNotification:s}=(0,n.ko)();return(0,se.FD)("div",{className:(0,ge.A)("sBptmiga",t&&"U_6O1ebL"),onClick:()=>s({message:i("OptionPremiumRequiredMessage")}),children:[(0,se.Y)("span",{children:e}),(0,se.Y)(he.A,{name:"lock-badge",className:"jWxrRbkh"})]})}),th=(0,s.ph)((0,n.EK)(e=>{const{settings:{privacy:t}}=e,i=(0,c.Iv$)(e),s=e.settings.privacy.noPaidMessages?.allowUserIds.length||0;return{shouldNewNonContactPeersRequirePremium:(0,c.BSN)(e),shouldChargeForMessages:Boolean(i),nonContactPeersPaidStars:i||a.wZe,isCurrentUserPremium:(0,c.g29)(e),canLimitNewMessagesWithoutPremium:e.appConfig.canLimitNewMessagesWithoutPremium,canChargeForMessages:e.appConfig.starsPaidMessagesAvailable,noPaidReactionsForUsersCount:s,privacy:t}})(function({isActive:e,canLimitNewMessagesWithoutPremium:t,canChargeForMessages:i,shouldNewNonContactPeersRequirePremium:a,shouldChargeForMessages:r,nonContactPeersPaidStars:l,isCurrentUserPremium:c,noPaidReactionsForUsersCount:d,onReset:h,privacy:m}){const{updateGlobalPrivacySettings:u,openSettingsScreen:p,showNotification:v}=(0,n.ko)(),g=(0,B.A)(),A=(0,Fi.A)(),f=c||t,b=c&&i,[C,y]=(0,s.J0)(l),[S,N]=(0,s.J0)(!1),k=(0,s.Kr)(()=>r?"charge_for_messages":a?"contacts_and_premium":"everybody",[r,a]);(0,F.A)(([e])=>{S||void 0===e||"everybody"===k||k===e||("everybody"===m.chatInvite?.visibility&&v({message:A("CheckPrivacyInviteText"),action:{action:"openSettingsScreen",payload:{screen:o.VS.PrivacyGroupChats}},actionText:{key:"Review"},duration:8e3}),"everybody"===m.phoneCall?.visibility&&v({message:A("CheckPrivacyCallsText"),action:{action:"openSettingsScreen",payload:{screen:o.VS.PrivacyPhoneCall}},actionText:{key:"Review"},duration:8e3}),N(!0))},[k,r,m,A,S]);const w=(0,s.Kr)(()=>[{value:"everybody",label:g("P2PEverybody")},{value:"contacts_and_premium",label:f?g("PrivacyMessagesContactsAndPremium"):(0,se.Y)(eh,{label:g("PrivacyMessagesContactsAndPremium"),isChecked:"contacts_and_premium"===k}),hidden:!f,isCanCheckedInDisabled:!0},{value:"charge_for_messages",label:b?A("PrivacyChargeForMessages"):(0,se.Y)(eh,{label:A("PrivacyChargeForMessages"),isChecked:"charge_for_messages"===k}),hidden:!b,isCanCheckedInDisabled:!0}],[g,A,f,b,k]),I=(0,T.A)(e=>{u({shouldNewNonContactPeersRequirePremium:"contacts_and_premium"===e,nonContactPeersPaidStars:"charge_for_messages"===e?C:null})}),P=(0,ye.A)(e=>{u({nonContactPeersPaidStars:e})},[u],300,!0),Y=(0,s.hb)(e=>{y(e),P(e)},[y,P]);(0,Ne.A)({isActive:e,onBack:h});const D=(0,s.Kr)(()=>A(r?"PrivacyDescriptionChargeForMessages":"PrivacyDescriptionMessagesContactsAndPremium"),[r,A]);return(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:A.isRtl?"rtl":void 0,children:g("PrivacyMessagesTitle")}),(0,se.Y)(ie.A,{name:"privacy-messages",options:w,onChange:I,selected:k}),(0,se.Y)("p",{className:"settings-item-description-larger",dir:A.isRtl?"rtl":void 0,children:D})]}),"charge_for_messages"===k&&(0,se.Y)("div",{className:"settings-item fluid-container",children:(0,se.Y)(Qd,{canChangeChargeForMessages:b,chargeForMessages:C,onChange:Y})}),b&&"charge_for_messages"===k&&function(){const e=d?g("Users",d,"i"):A("SubtitlePrivacyAddUsers");return(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:A.isRtl?"rtl":void 0,children:A("RemoveFeeTitle")}),(0,se.Y)(li.A,{narrow:!0,icon:"delete-user",onClick:()=>{p({screen:o.VS.PrivacyNoPaidMessages})},children:(0,se.FD)("div",{className:"multiline-item full-size",children:[(0,se.Y)("span",{className:"title",children:A("ExceptionTitlePrivacyChargeForMessages")}),(0,se.Y)("span",{className:"subtitle",children:e})]})})]})}(),!c&&"charge_for_messages"!==k&&(0,se.Y)(Xd,{premiumSection:"message_privacy"})]})}));function ih(e){const t=e.platform.toLowerCase(),i=e.deviceModel.toLowerCase(),s=e.systemVersion.toLowerCase();return i.includes("xbox")?"xbox":i.includes("chrome")&&!i.includes("chromebook")?"chrome":i.includes("brave")?"brave":i.includes("vivaldi")?"vivaldi":i.includes("safari")?"safari":i.includes("firefox")?"firefox":i.includes("opera")?"opera":i.includes("samsungbrowser")?"samsung":t.includes("android")?"android":i.includes("iphone")||i.includes("ipad")||t.includes("ios")||t.includes("macos")||s.includes("macos")?"apple":t.includes("ubuntu")||s.includes("ubuntu")?"ubuntu":t.includes("linux")||s.includes("linux")?"linux":t.includes("windows")||s.includes("windows")?"windows":"unknown"}const sh={SettingsActiveSession:"M84mrPgu",settingsActiveSession:"M84mrPgu",iconDevice:"Add8P_K4",iconDevice__android:"onkXVGY4",iconDeviceAndroid:"onkXVGY4",iconDevice__apple:"xw13aT8u",iconDeviceApple:"xw13aT8u",iconDevice__brave:"HESrGUdv",iconDeviceBrave:"HESrGUdv",iconDevice__chrome:"Vpej7wm7",iconDeviceChrome:"Vpej7wm7",iconDevice__edge:"ueWE77x9",iconDeviceEdge:"ueWE77x9",iconDevice__firefox:"_lMTmvya",iconDeviceFirefox:"_lMTmvya",iconDevice__linux:"cDVfvyG_",iconDeviceLinux:"cDVfvyG_",iconDevice__opera:"nWqlTxZt",iconDeviceOpera:"nWqlTxZt",iconDevice__safari:"ldFLp1Gf",iconDeviceSafari:"ldFLp1Gf",iconDevice__samsung:"VHNORBGL",iconDeviceSamsung:"VHNORBGL",iconDevice__ubuntu:"QBVivtdu",iconDeviceUbuntu:"QBVivtdu",iconDevice__unknown:"GbjIgrwU",iconDeviceUnknown:"GbjIgrwU",iconDevice__vivaldi:"yieVnjoI",iconDeviceVivaldi:"yieVnjoI",iconDevice__windows:"_0dnTFOE",iconDeviceWindows:"_0dnTFOE",iconDevice__xbox:"fbCjjDpU",iconDeviceXbox:"fbCjjDpU",title:"c6edjhlh",note:"lRqTZAYn",date:"oLnN6crs",box:"wVEXuPlZ",actionHeader:"olQS2T1n",actionName:"KuX1APpO",headerButton:"VT8pZfMu"};function nh(e){return[e.region,e.country].filter(Boolean).join(", ")}const oh=(0,s.ph)((0,n.EK)((e,{hash:t})=>({session:t?e.activeSessions.byHash[t]:void 0}))(({isOpen:e,session:t,onClose:i})=>{const{changeSessionSettings:o,terminateAuthorization:a}=(0,n.ko)(),r=(0,Fi.A)(),l=(0,Si.A)(t,!0),c=(0,s.hb)(()=>{o({hash:t.hash,areSecretChatsEnabled:!t.areSecretChatsEnabled})},[o,t]),d=(0,s.hb)(()=>{o({hash:t.hash,areCallsEnabled:!t.areCallsEnabled})},[o,t]),h=(0,s.hb)(()=>{a({hash:t.hash}),i()},[i,t,a]);if(l)return(0,se.FD)(te.A,{header:(0,se.FD)("div",{className:"modal-header-condensed",dir:r.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:r("Close"),onClick:i,iconName:"close"}),(0,se.Y)("div",{className:"modal-title",children:r("SessionPreviewTitle")}),(0,se.Y)(X.A,{color:"danger",onClick:h,className:(0,ge.A)("modal-action-button",sh.headerButton),children:r("SessionPreviewTerminateSession")})]}),isOpen:e,hasCloseButton:!0,onClose:i,className:sh.SettingsActiveSession,children:[(0,se.Y)("div",{className:(0,ge.A)(sh.iconDevice,l&&sh[`iconDevice__${ih(l)}`])}),(0,se.Y)("h3",{className:sh.title,dir:"auto",children:l?.deviceModel}),(0,se.Y)("div",{className:sh.date,"aria-label":r("PrivacySettingsLastSeen"),children:(0,We.L2)(1e3*l.dateActive,r.code)}),(0,se.FD)("dl",{className:sh.box,children:[(0,se.Y)("dt",{children:r("SessionPreviewApp")}),(0,se.FD)("dd",{children:[l?.appName," ",l?.appVersion,","," ",l?.platform," ",l?.systemVersion]}),l?.ip&&(0,se.FD)(se.FK,{children:[(0,se.Y)("dt",{children:r("SessionPreviewIp")}),(0,se.Y)("dd",{children:l.ip})]}),(0,se.Y)("dt",{children:r("SessionPreviewLocation")}),(0,se.Y)("dd",{children:l&&nh(l)})]}),(0,se.Y)("p",{className:sh.note,children:r("SessionPreviewIpDesc")}),(0,se.Y)("h4",{className:sh.actionHeader,children:r("AuthSessionsViewAcceptTitle")}),(0,se.FD)(li.A,{onClick:c,children:[(0,se.Y)("span",{className:sh.actionName,children:r("SessionPreviewAcceptSecret")}),(0,se.Y)(ci.A,{id:"accept_secrets",label:"On",checked:l.areSecretChatsEnabled})]}),(0,se.FD)(li.A,{onClick:d,children:[(0,se.Y)("span",{className:sh.actionName,children:r("SessionPreviewAcceptCalls")}),(0,se.Y)(ci.A,{id:"accept_calls",label:"On",checked:l.areCallsEnabled})]})]})}));function ah(e){return[e.region,e.country].filter(Boolean).join(", ")}const rh=(0,s.ph)((0,n.EK)(e=>e.activeSessions)(({isActive:e,onReset:t,byHash:i,orderedHashes:o,ttlDays:a})=>{const{terminateAuthorization:r,terminateAllAuthorizations:l,changeSessionTtl:c}=(0,n.ko)(),d=(0,B.A)(),h=(0,Fi.A)(),[m,u,p]=(0,D.A)(),[v,g]=(0,s.J0)(),[A,f,b]=(0,D.A)(),C=(0,s.Kr)(()=>{if(void 0!==a)return a<=7?"7":a<=30?"30":a<=93?"90":a<=183?"183":a>183?"365":void 0},[a]),y=(0,s.Kr)(()=>{const e=[{label:h("Weeks",{count:1},{pluralValue:1}),value:"7"},{label:h("Months",{count:1},{pluralValue:1}),value:"30"},{label:h("Months",{count:3},{pluralValue:3}),value:"90"},{label:h("Months",{count:6},{pluralValue:6}),value:"183"}];return a&&a>=365&&e.push({label:h("Years",{count:1},{pluralValue:1}),value:"365"}),e},[h,a]),S=(0,s.hb)(e=>{r({hash:e})},[r]),N=(0,s.hb)(()=>{p(),l()},[p,l]),k=(0,s.hb)(e=>{g(e),f()},[f]),w=(0,s.hb)(()=>{g(void 0),b()},[b]),I=(0,s.hb)(e=>{c({days:Number(e)})},[c]),P=(0,s.Kr)(()=>{const e=o.find(e=>i[e].isCurrent);return e?i[e]:void 0},[i,o]),Y=(0,s.Kr)(()=>o.filter(e=>!i[e].isCurrent),[i,o]),F=Boolean(Y.length);return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content custom-scroll SettingsActiveSessions",children:[P&&(T=P,(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:h.isRtl?"rtl":void 0,children:h("AuthSessionsCurrentSession")}),(0,se.Y)(li.A,{narrow:!0,inactive:!0,icon:`device-${ih(T)}`,iconClassName:"icon-device",children:(0,se.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,se.Y)("span",{className:"title",dir:"auto",children:T.deviceModel}),(0,se.FD)("span",{className:"subtitle black tight",children:[T.appName," ",T.appVersion,","," ",T.platform," ",T.systemVersion]}),(0,se.FD)("span",{className:"subtitle",children:[T.ip," ","-"," ",ah(T)]})]})}),F&&(0,se.Y)(li.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:u,children:h("TerminateAllSessions")})]})),F&&(M=Y,(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:h.isRtl?"rtl":void 0,children:h("OtherSessions")}),M.map(function(e){const t=i[e];return(0,se.Y)(li.A,{ripple:!0,narrow:!0,contextActions:[{title:h("SessionTerminate"),icon:"stop",destructive:!0,handler:()=>{S(t.hash)}}],icon:`device-${ih(t)}`,iconClassName:"icon-device",onClick:()=>{k(t.hash)},children:(0,se.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,se.Y)("span",{className:"date",children:(0,We.be)(d,1e3*t.dateActive)}),(0,se.Y)("span",{className:"title",children:t.deviceModel}),(0,se.FD)("span",{className:"subtitle black tight",children:[t.appName," ",t.appVersion,","," ",t.platform," ",t.systemVersion]}),(0,se.FD)("span",{className:"subtitle",children:[t.ip," ",ah(t)]})]})},t.hash)})]})),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:h.isRtl?"rtl":void 0,children:h("TerminateOldSessionHeader")}),(0,se.Y)("p",{className:"settings-item-description-larger",children:h("IfInactiveFor")}),(0,se.Y)(ie.A,{name:"session_ttl",options:y,selected:C,onChange:I})]}),F&&(0,se.Y)(oi.A,{isOpen:m,onClose:p,text:h("AreYouSureSessions"),confirmLabel:h("TerminateAllSessions"),confirmHandler:N,confirmIsDestructive:!0,areButtonsInColumn:!0}),(0,se.Y)(oh,{isOpen:A,hash:v,onClose:w})]});var M,T})),lh="YRYk96ki",ch=(0,s.ph)((0,n.EK)((e,{hash:t})=>{const i=t?e.activeWebSessions.byHash[t]:void 0;return{session:i,bot:i?e.users.byId[i.botId]:void 0}})(({isOpen:e,session:t,bot:i,onClose:o})=>{const{terminateWebAuthorization:a}=(0,n.ko)(),r=(0,B.A)(),l=(0,Si.A)(t,!0),c=(0,Si.A)(i,!0),d=(0,s.hb)(()=>{a({hash:t.hash}),o()},[o,t,a]);if(l)return(0,se.FD)(te.A,{header:(0,se.FD)("div",{className:"modal-header-condensed",dir:r.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:r("Close"),onClick:o,iconName:"close"}),(0,se.Y)("div",{className:"modal-title",children:r("WebSessionsTitle")}),(0,se.Y)(X.A,{color:"danger",onClick:d,className:(0,ge.A)("modal-action-button","lUf0RJ2h"),children:r("AuthSessions.LogOut")})]}),isOpen:e,hasCloseButton:!0,onClose:o,className:"Wd0fmiSY",children:[(0,se.Y)(Yt.A,{className:"OhZHdRsP",peer:c,size:"large"}),c&&(0,se.Y)(Ms.A,{className:"EQ7__xGn",peer:c}),(0,se.Y)("div",{className:lh,children:l?.domain}),(0,se.FD)("dl",{className:"kmCTIfvf",children:[(0,se.Y)("dt",{children:r("AuthSessions.View.Browser")}),(0,se.Y)("dd",{children:l?.browser}),(0,se.Y)("dt",{children:r("SessionPreview.Ip")}),(0,se.Y)("dd",{children:l?.ip}),(0,se.Y)("dt",{children:r("SessionPreview.Location")}),(0,se.Y)("dd",{children:l?.region})]}),(0,se.Y)("p",{className:lh,children:r("AuthSessions.View.LocationInfo")})]})})),dh={avatar:"v0wP46TR","clear-help":"WnnxcARX",clearHelp:"WnnxcARX",subtitle:"uEUfjByC"},hh=(0,s.ph)((0,n.EK)(e=>{const{byHash:t,orderedHashes:i}=e.activeWebSessions;return{byHash:t,orderedHashes:i}})(({isActive:e,byHash:t,orderedHashes:i,onReset:o})=>{const{terminateWebAuthorization:a,terminateAllWebAuthorizations:r}=(0,n.ko)(),l=(0,B.A)(),[c,d,h]=(0,D.A)(),[m,u]=(0,s.J0)(),[p,v,g]=(0,D.A)(),A=(0,s.hb)(e=>{a({hash:e})},[a]),f=(0,s.hb)(()=>{h(),r()},[h,r]),b=(0,s.hb)(e=>{u(e),v()},[v]),C=(0,s.hb)(()=>{u(void 0),g()},[g]);var y;if((0,s.vJ)(()=>{i.length||o()},[o,i]),(0,Ne.A)({isActive:e,onBack:o}),i.length)return(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:d,children:l("AuthSessions.LogOutApplications")}),(0,se.Y)("p",{className:(0,ge.A)("settings-item-description",dh.clearHelp),children:l("ClearOtherWebSessionsHelp")})]}),(y=i,(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("WebSessionsTitle")}),y.map(function(e){const i=t[e],s=(0,n.mS)().users.byId[i.botId];return(0,se.FD)(li.A,{ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{A(i.hash)}}],onClick:()=>b(i.hash),children:[(0,se.Y)(Yt.A,{className:dh.avatar,peer:s,size:"tiny"}),(0,se.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,se.Y)("span",{className:"date",children:(0,We.be)(l,1e3*i.dateActive)}),s&&(0,se.Y)(Ms.A,{className:dh.title,peer:s}),(0,se.FD)("span",{className:(0,ge.A)("subtitle","black","tight",dh.platform),children:[i.domain,",",i.browser,",",i.platform]}),(0,se.FD)("span",{className:(0,ge.A)("subtitle",dh.subtitle),children:[i.ip," ",i.region]})]})]},i.hash)})]})),(0,se.Y)(oi.A,{isOpen:c,onClose:h,title:l("AuthSessions.LogOutApplications"),text:l("AreYouSureWebSessions"),confirmHandler:f,confirmIsDestructive:!0}),(0,se.Y)(ch,{isOpen:p,hash:m,onClose:C})]})})),mh=(0,s.ph)(({stickerSet:e,noPlay:t,className:i,observeIntersection:s,onClick:n})=>{const o=(0,B.A)(),r=e?.stickers?.[0],l=(0,T.A)(()=>{r&&n(r)});if(e?.stickers)return(0,se.FD)(li.A,{className:(0,ge.A)("StickerSetCard","small-icon",i),inactive:!r,onClick:l,children:[function(){if(e)return e.hasThumbnail||!r?(0,se.Y)(X.A,{ariaLabel:e.title,color:"translucent",isRtl:o.isRtl,children:(0,se.Y)(ar,{stickerSet:e,size:a.RCH,noPlay:t,observeIntersection:s})}):(0,se.Y)(dr,{sticker:r,size:a.RCH,title:e.title,noPlay:t,observeIntersection:s,noContextMenu:!0,isCurrentUserPremium:!0,clickArg:void 0})}(),(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("div",{className:"title",children:e.title}),(0,se.Y)("div",{className:"subtitle",children:o("StickerPack.StickerCount",e.count,"i")})]})]})}),uh=(0,s.ph)((0,n.EK)(e=>({...(0,di.Up)(e.settings.byKey,["shouldSuggestCustomEmoji"]),customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({isActive:e,customEmojiSetIds:t,stickerSetsById:i,shouldSuggestCustomEmoji:o,canPlayAnimatedEmojis:a,onReset:r})=>{const{openStickerSet:l,setSettingOption:c}=(0,n.ko)(),d=(0,B.A)(),h=(0,s.li)(),{observe:m}=(0,Za.BL)({rootRef:h});(0,Ne.A)({isActive:e,onBack:r});const u=(0,s.hb)(e=>{l({stickerSetInfo:e.stickerSetInfo})},[l]),p=(0,s.hb)(e=>{c({shouldSuggestCustomEmoji:e})},[c]),v=(0,s.Kr)(()=>t&&Object.values((0,di.Up)(i,t)),[t,i]);return(0,se.Y)("div",{className:"settings-content custom-scroll",children:v&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(Hs.A,{label:d("SuggestAnimatedEmoji"),checked:o,onCheck:p}),(0,se.Y)("div",{className:"mt-4",ref:h,children:v.map(e=>(0,se.Y)(mh,{stickerSet:e,observeIntersection:m,onClick:u,noPlay:!a},e.id))}),(0,se.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:(0,Pt.A)(d("EmojiBotInfo"),["links"])})]})})}));var ph=i(74824);const vh=(0,s.ph)((0,n.EK)(e=>(0,di.Up)(e.settings.byKey,["canAutoLoadPhotoFromContacts","canAutoLoadPhotoInPrivateChats","canAutoLoadPhotoInGroups","canAutoLoadPhotoInChannels","canAutoLoadVideoFromContacts","canAutoLoadVideoInPrivateChats","canAutoLoadVideoInGroups","canAutoLoadVideoInChannels","canAutoLoadFileFromContacts","canAutoLoadFileInPrivateChats","canAutoLoadFileInGroups","canAutoLoadFileInChannels","autoLoadFileMaxSizeMb"]))(({isActive:e,canAutoLoadPhotoFromContacts:t,canAutoLoadPhotoInPrivateChats:i,canAutoLoadPhotoInGroups:s,canAutoLoadPhotoInChannels:o,canAutoLoadVideoFromContacts:r,canAutoLoadVideoInPrivateChats:l,canAutoLoadVideoInGroups:c,canAutoLoadVideoInChannels:d,canAutoLoadFileFromContacts:h,canAutoLoadFileInPrivateChats:m,canAutoLoadFileInGroups:u,canAutoLoadFileInChannels:p,autoLoadFileMaxSizeMb:v,onReset:g})=>{const{setSettingOption:A,showNotification:f}=(0,n.ko)(),b=(0,Fi.A)();(0,Ne.A)({isActive:e,onBack:g});const C=(0,T.A)(e=>{const t=a.$gx[e];return b("AutodownloadSizeLimitUpTo",{limit:b("MediaSizeMB",{size:t},{pluralValue:t})})}),y=(0,T.A)(e=>{A({autoLoadFileMaxSizeMb:a.$gx[e]})}),S=(0,T.A)(()=>{(0,ph.purgeClearableCache)(),f({message:{key:"SettingsDataClearMediaDone"}})});function N(){const e=a.$gx.indexOf(v);return(0,se.Y)("div",{className:"pt-5",children:(0,se.Y)(Xe.A,{label:b("AutoDownloadMaxFileSize"),min:0,max:5,value:-1!==e?e:2,renderValue:C,onChange:y})})}function k(e,t,i,s,n,o){return(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:b.isRtl?"rtl":void 0,children:e}),(0,se.Y)(Hs.A,{label:b("AutoDownloadSettingsContacts"),checked:i,onCheck:e=>A({[`canAutoLoad${t}FromContacts`]:e})}),(0,se.Y)(Hs.A,{label:b("AutoDownloadSettingsPrivateChats"),checked:s,onCheck:e=>A({[`canAutoLoad${t}InPrivateChats`]:e})}),(0,se.Y)(Hs.A,{label:b("AutoDownloadSettingsGroupChats"),checked:n,onCheck:e=>A({[`canAutoLoad${t}InGroups`]:e})}),(0,se.Y)(Hs.A,{label:b("AutoDownloadSettingsChannels"),checked:o,onCheck:e=>A({[`canAutoLoad${t}InChannels`]:e})}),"File"===t&&N()]})}return(0,se.FD)("div",{className:"settings-content custom-scroll",children:[k(b("AutoDownloadPhotosTitle"),"Photo",t,i,s,o),k(b("AutoDownloadVideosTitle"),"Video",r,l,c,d),k(b("AutoDownloadFilesTitle"),"File",h,m,u,p),(0,se.Y)("div",{className:"settings-item",children:(0,se.FD)(li.A,{onClick:S,icon:"delete",multiline:!0,children:[(0,se.Y)("span",{className:"title",children:b("SettingsDataClearMediaCache")}),(0,se.Y)("span",{className:"subtitle",children:b("SettingsDataClearMediaCacheDescription")})]})})]})})),gh={root:"Ys1i4ssl",item:"skaVPMTF"},Ah=(0,s.ph)((0,n.EK)(e=>{const{doNotTranslate:t}=e.settings.byKey;return{doNotTranslate:t}})(({isActive:e,doNotTranslate:t,onReset:i})=>{const{setSettingOption:o}=(0,n.ko)(),r=(0,Fi.A)().code,[l,c]=(0,s.J0)(""),d=(0,s.Kr)(()=>{const e=new Intl.DisplayNames([r],{type:"language"}),t=a.N89.map(t=>{const i=e.of(t),s=new Intl.DisplayNames([t],{type:"language"}).of(t);if(i&&s)return{value:t,label:i,subLabel:s}}).filter(Boolean);if(!l.trim()){const e=t.find(e=>e.value===r),i=t.filter(e=>e.value!==r);return e?[e,...i]:t}return t?.filter(e=>e.label.toLowerCase().includes(l.toLowerCase())||e.subLabel?.toLowerCase().includes(l.toLowerCase())||e.value.toLowerCase().includes(l.toLowerCase()))},[r,l]),h=(0,T.A)(e=>{o({doNotTranslate:e})});return(0,Ne.A)({isActive:e,onBack:i}),(0,se.Y)("div",{className:(0,ge.A)(gh.root,"settings-content infinite-scroll"),children:(0,se.Y)("div",{className:(0,ge.A)(gh.item),children:(0,se.Y)(lc,{className:gh.picker,items:d,selectedValues:t,onSelectedValuesChange:h,filterValue:l,onFilterChange:c,isSearchable:!0,allowMultiple:!0,withDefaultPadding:!0,itemInputType:"checkbox",searchInputId:"lang-picker-search"})})})})),fh=(0,s.ph)(({chatId:e,usernames:t,onEditUsername:i})=>{const{showNotification:o,toggleUsername:a,toggleChatUsername:r,sortUsernames:l,sortChatUsernames:c}=(0,n.ko)(),d=(0,B.A)(),h=(0,Fi.A)(),[m,u]=(0,s.J0)(),p=(0,s.Kr)(()=>t.map(({username:e})=>e),[t]),v=(0,K.A)(p),[g,A]=(0,s.J0)({orderedUsernames:p,dragOrderUsernames:p,draggedIndex:void 0});(0,s.vJ)(()=>{v!==p&&A({orderedUsernames:p,dragOrderUsernames:p,draggedIndex:void 0})},[v,p]);const f=(0,s.hb)(e=>{(0,gc.eM)(`@${e}`),o({message:d("UsernameCopied")})},[d,o]),b=(0,s.hb)(e=>{e.isEditable?i(e.username):u(e)},[i]),C=(0,s.hb)(()=>{u(void 0)},[]),y=(0,s.hb)(()=>{m&&(e?r({chatId:e,username:m.username,isActive:!m.isActive}):a({username:m.username,isActive:!m.isActive}),C())},[e,C,r,a,m]),S=(0,s.hb)((e,t)=>{const i=Math.round(e.y/56),s=g.orderedUsernames?.indexOf(t)||0,n=g.orderedUsernames?.filter(e=>e!==t);n&&(0,fe.Bt)(s+i,0,p.length)&&(n.splice(s+i,0,t),A(e=>({...e,draggedIndex:s,dragOrderUsernames:n})))},[g.orderedUsernames,p.length]),N=(0,s.hb)(()=>{A(t=>(e?c({chatId:e,usernames:t.dragOrderUsernames}):l({usernames:t.dragOrderUsernames}),{...t,orderedUsernames:t.dragOrderUsernames,draggedIndex:void 0}))},[e,c,l]);return(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:"PaO1MMi5",children:[(0,se.Y)("h4",{className:"wSswdVkR",dir:h.isRtl?"rtl":void 0,children:d("lng_usernames_subtitle")}),(0,se.Y)("div",{className:"lAeeBh9K",style:`height: ${56*t.length}px`,children:t.map((e,t)=>{const i=g.draggedIndex===t,s=56*(g.orderedUsernames?.indexOf(e.username)??0),n=56*(g.dragOrderUsernames?.indexOf(e.username)??0),o=e.isEditable?"lng_usernames_edit":e.isActive?"lng_usernames_active":"lng_usernames_non_active";return(0,se.Y)(Bd.A,{id:e.username,onDrag:S,onDragEnd:N,style:`top: ${i?s:n}px;`,knobStyle:"inset-inline-end: 3rem;",isDisabled:!e.isActive,children:(0,se.FD)(li.A,{className:(0,ge.A)("drag-item no-icon","l04OwRBg"),narrow:!0,secondaryIcon:"more",icon:e.isActive?"link":"link-broken",multiline:!0,contextActions:[{handler:()=>{f(e.username)},title:d("Copy"),icon:"copy"}],onClick:()=>{b(e)},children:[(0,se.FD)("span",{className:"title",children:["@",e.username]}),(0,se.Y)("span",{className:"subtitle",children:d(o)})]},e.username)},e.username)})}),(0,se.Y)("p",{className:"oiJc22Aj",dir:h.isRtl?"rtl":void 0,children:d("lng_usernames_description")})]}),(0,se.Y)(oi.A,{isOpen:Boolean(m),onClose:C,title:d(m?.isActive?"Username.DeactivateAlertTitle":"Username.ActivateAlertTitle"),text:d(m?.isActive?"Username.DeactivateAlertText":"Username.ActivateAlertText"),confirmLabel:d(m?.isActive?"Username.DeactivateAlertHide":"Username.ActivateAlertShow"),confirmHandler:y,confirmIsDestructive:!m?.isActive})]})});var bh=i(11116);const Ch=/https:\/\/t\.me\/?/i,yh=(0,be.sg)(e=>e(),250,!1),Sh=(0,s.ph)(({currentUsername:e,asLink:t,isLoading:i,isUsernameAvailable:o,checkedUsername:r,onChange:l})=>{const{checkUsername:c,checkPublicLink:d}=(0,n.ko)(),[h,m]=(0,s.J0)(e||""),u=(0,B.A)(),p=t?"SetUrl":"Username",v=u(t?"SetUrlPlaceholder":"Username"),g=(0,K.A)(o),A=e!==h?o??g:void 0,f=h&&e!==h&&r!==h,[b,C]=(0,s.Kr)(()=>h.length?h.length<bh.tX?[void 0,u(`${p}InvalidShort`)]:h.length>bh.Tk?[void 0,u(`${p}InvalidLong`)]:bh.Ny.test(h)?void 0===A||f?[]:[A?u(`${p}Available`,v):void 0,!1===A?u(`${p}InUse`):void 0]:[void 0,u(`${p}Invalid`)]:[],[h,A,f,u,p,v]);(0,s.vJ)(()=>{m(e||"")},[t,e]);const y=(0,s.hb)(i=>{const s=i.target.value.trim();if(t&&!s.match(Ch))return void(s.length||(m(""),l?.("")));const n=s.replace(Ch,"");m(n),(""===n||(0,bh.BU)(n,!0))&&(l?.(n),yh(()=>{n!==e&&(t?d:c)({username:n})}))},[t,d,c,e,l]);return(0,se.Y)(ee.A,{value:`${t?a.jsp:""}${h}`,onChange:y,label:f?u("Checking"):v,error:C,success:b,readOnly:i,teactExperimentControlled:!0})});var Nh=i(43434);const kh=(0,be.nF)(e=>e(),6e4,!0),wh="Please provide your first name",Ih=(0,s.ph)((0,n.EK)(e=>{const{currentUserId:t}=e,{progress:i,isUsernameAvailable:s,checkedUsername:n,error:o}=(0,c.nTw)(e).profileEdit||{},a=t?(0,c.mBe)(e,t):void 0,r=(0,bs.d)(e,"aboutLength"),{firstName:d,lastName:h,usernames:m}=a||{},u=t?(0,c.vGo)(e,t):void 0;return{currentAvatarHash:a&&(0,l.cP)(a),currentFirstName:d,currentLastName:h,currentBirthday:u?.birthday,currentBio:u?.bio,progress:i,isUsernameAvailable:s,checkedUsername:n,editUsernameError:o,maxBioLength:r,usernames:m}})(({isActive:e,currentAvatarHash:t,currentFirstName:i,currentLastName:r,currentBirthday:l,currentBio:c,progress:d,checkedUsername:h,editUsernameError:m,isUsernameAvailable:u,maxBioLength:p,usernames:v,onReset:g})=>{const{loadCurrentUser:A,updateProfile:f,openSettingsScreen:b,openBirthdaySetupModal:C}=(0,n.ko)(),y=(0,B.A)(),S=(0,Fi.A)(),N=(0,s.Kr)(()=>v?.find(({isEditable:e})=>e),[v]),k=N?.username||"",[w,I]=(0,s.J0)(!1),[P,Y]=(0,s.J0)(!1),[F,D]=(0,s.J0)(),[M,L]=(0,s.J0)(),[R,x]=(0,s.J0)(i||""),[E,V]=(0,s.J0)(r||""),[_,U]=(0,s.J0)(c||""),[O,J]=(0,s.J0)(k),j=(0,q.A)(t,!1,G.qZ.BlobUrl),z=d===o.DV.InProgress,H=!1===O,$=(0,K.A)(u),W=u??$,Q=v&&v.length>1,Z=(0,s.Kr)(()=>!H&&(Boolean(M)||P||w&&!0===W),[H,M,P,w,W]);(0,Ne.A)({isActive:e,onBack:g}),(0,s.vJ)(()=>{kh(()=>{A()})},[A]),(0,s.vJ)(()=>{L(void 0)},[j]),(0,s.vJ)(()=>{x(i||""),V(r||""),U(c||"")},[i,r,c]),(0,s.vJ)(()=>{J(k||"")},[k]),(0,s.vJ)(()=>{d===o.DV.Complete&&(Y(!1),I(!1),D(void 0))},[d]);const X=(0,s.Kr)(()=>{if(!l)return;const e=new Date(l.year||2024,l.month-1,l.day);return(0,We.A)(e,S.code,!0,"long")},[l,S]),te=(0,T.A)(e=>{L(e)}),ie=(0,T.A)(e=>{x(e.target.value),Y(!0)}),ne=(0,T.A)(e=>{V(e.target.value),Y(!0)}),oe=(0,T.A)(e=>{U(e.target.value),Y(!0)}),ae=(0,T.A)(e=>{J(e),I(k!==e)}),re=(0,T.A)(()=>{b({screen:o.VS.PrivacyBirthday})}),le=(0,T.A)(()=>{C({currentBirthday:l})}),ce=(0,T.A)(()=>{const e=R.trim(),t=E.trim(),i=_.trim();O&&(e.length?f({photo:M,...P&&{firstName:e,lastName:t,bio:i},...w&&{username:O}}):D(wh))});return(0,se.FD)("div",{className:"settings-fab-wrapper",children:[(0,se.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.FD)("div",{className:"settings-input",children:[(0,se.Y)(Nh.A,{currentAvatarBlobUrl:j,onChange:te,title:S("AriaSettingsEditProfilePhoto"),disabled:z}),(0,se.Y)(ee.A,{value:R,onChange:ie,label:y("FirstName"),disabled:z,error:F===wh?F:void 0}),(0,se.Y)(ee.A,{value:E,onChange:ne,label:y("LastName"),disabled:z}),(0,se.Y)(rn.A,{value:_,onChange:oe,label:y("UserBio"),disabled:z,maxLength:p,maxLengthIndicator:p?(p-_.length).toString():void 0})]}),(0,se.Y)("p",{className:"settings-item-description",dir:y.isRtl?"rtl":void 0,children:(0,Pt.A)(y("lng_settings_about_bio"),["br","simple_markdown"])})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{icon:"gift",narrow:!0,rightElement:X?(0,se.Y)("span",{className:"settings-birthday-date",children:X}):void 0,onClick:le,children:(0,se.Y)("span",{className:"flex-grow",children:S("SettingsBirthday")})}),(0,se.Y)("p",{className:"settings-item-description",dir:y.isRtl?"rtl":void 0,children:S("BirthdayPrivacySuggestion",{link:(0,se.Y)(fa.A,{isPrimary:!0,onClick:re,children:S("BirthdayPrivacySuggestionLink")})},{withNodes:!0})})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:y.isRtl?"rtl":void 0,children:y("Username")}),(0,se.Y)("div",{className:"settings-input",children:(0,se.Y)(Sh,{currentUsername:k,isLoading:z,isUsernameAvailable:u,checkedUsername:h,onChange:ae})}),m===a.Y3M&&function(){const e=`${a.jsp}${a.NjX}`;return(0,se.Y)("p",{className:"settings-item-description",dir:y.isRtl?"rtl":void 0,children:y("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map(t=>"PURCHASE_LINK"===t?(0,se.Y)(dl.A,{url:e,text:`@${a.NjX}`}):t)})}(),(0,se.Y)("p",{className:"settings-item-description",dir:y.isRtl?"rtl":void 0,children:(0,Pt.A)(y("UsernameHelp"),["br","simple_markdown"])}),O&&(0,se.FD)("p",{className:"settings-item-description",dir:y.isRtl?"rtl":void 0,children:[y("lng_username_link"),(0,se.Y)("br",{}),(0,se.FD)("span",{className:"username-link",children:[a.jsp,O]})]})]}),Q&&(0,se.Y)(fh,{usernames:v,onEditUsername:J})]}),(0,se.Y)(pi.A,{isShown:Z,onClick:ce,disabled:z,ariaLabel:y("Save"),iconName:"check",isLoading:z})]})}));var Ph=i(61182),Yh=i(4350),Fh=i(93855),Dh=i(15006);const Mh=(0,s.ph)((0,n.EK)(e=>{const{shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:s,shouldDebugExportedSenders:n}=(0,ks.lS)(e);return{shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:s,shouldDebugExportedSenders:n}})(({isActive:e,shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:o,shouldDebugExportedSenders:r,onReset:l})=>{const{requestConfetti:c,setSharedSettingOption:d,requestWave:h}=(0,n.ko)(),u=(0,s.li)(),[p,v]=(0,s.J0)(!1),g=(0,B.A)(),A=(0,Fh.A)();(0,Ne.A)({isActive:e,onBack:l});const f=(0,T.A)(()=>{const e=new File([(0,Ph.F8)()],a.lFE,{type:"text/plain"}),t=URL.createObjectURL(e);(0,ki.A)(t,a.lFE)}),b=(0,T.A)(e=>{h({startX:e.clientX,startY:e.clientY})}),C=(0,T.A)(()=>{c({withStars:!0})}),y=(0,T.A)(()=>{const e=u.current;e&&(0,Dh.U)(e)&&(v(!0),setTimeout(()=>{v(!1)},1500))}),S=(0,s.Kr)(()=>{if(!Object.values(A).length)return;let e=1;for(;A[e];)e+=1;return(0,Yh.Nv)(e,!0,!0)},[A]);return(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Experimental,size:200,className:"experimental-duck",nonInteractive:!0,noLoop:!1}),(0,se.Y)("p",{className:"settings-item-description pt-3",dir:"auto",children:g("lng_settings_experimental_about")})]}),(0,se.Y)("div",{className:"settings-item",children:(0,se.Y)(li.A,{href:S,icon:"add-user",children:(0,se.Y)("div",{className:"title",children:"Login on Test Server"})})}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{onClick:C,icon:"animations",children:(0,se.Y)("div",{className:"title",children:"Launch some confetti!"})}),(0,se.Y)(li.A,{onClick:b,icon:"story-expired",disabled:!m.J6,children:(0,se.Y)("div",{className:"title",children:"Start wave"})}),(0,se.Y)(li.A,{ref:u,onClick:y,icon:"spoiler",disabled:!m.bW,style:p?"visibility: hidden":"",children:(0,se.Y)("div",{className:"title",children:"Vaporize this button"})})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(Hs.A,{label:"Allow HTTP Transport",checked:Boolean(i),onCheck:()=>d({shouldAllowHttpTransport:!i})}),(0,se.Y)(Hs.A,{label:"Force HTTP Transport",disabled:!i,checked:Boolean(t),onCheck:()=>d({shouldForceHttpTransport:!t})})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(Hs.A,{label:g("DebugMenuEnableLogs"),checked:Boolean(o),onCheck:()=>d({shouldCollectDebugLogs:!o})}),(0,se.Y)(Hs.A,{label:"Enable exported senders debug",checked:Boolean(r),onCheck:()=>d({shouldDebugExportedSenders:!r})}),(0,se.Y)(li.A,{onClick:f,icon:"bug",children:(0,se.Y)("div",{className:"title",children:"Download log"})})]})]})}));var Th=i(6e4),Bh=i(84382);const Lh=(0,s.ph)((0,n.EK)(e=>{const{theme:t,shouldUseSystemTheme:i,messageSendKeyCombo:s,messageTextSize:n,timeFormat:o}=(0,ks.lS)(e);return{messageSendKeyCombo:s,messageTextSize:n,timeFormat:o,theme:t,shouldUseSystemTheme:i}})(({isActive:e,messageTextSize:t,messageSendKeyCombo:i,timeFormat:a,theme:r,shouldUseSystemTheme:l,onReset:c})=>{const{setSharedSettingOption:d,openSettingsScreen:h}=(0,n.ko)(),u=(0,Fi.A)(),{isMobile:p}=(0,Y.Ay)(),v=p&&(m.pz||m.Ni),g=[{label:u("SettingsTimeFormat12"),value:"12h"},{label:u("SettingsTimeFormat24"),value:"24h"}],A=[{label:u("EmptyChatAppearanceLight"),value:"light"},{label:u("EmptyChatAppearanceDark"),value:"dark"},{label:u("EmptyChatAppearanceSystem"),value:"auto"}],f=v?void 0:[{value:"enter",label:u("SettingsSendEnter"),subLabel:u("SettingsSendEnterDescription")},{value:"ctrl-enter",label:u(m.MP||m.pz?"SettingsSendCmdenter":"SettingsSendCtrlenter"),subLabel:u("SettingsSendPlusEnterDescription")}],b=(0,s.hb)(e=>{document.documentElement.style.setProperty("--composer-text-size",`${Math.max(e,m.pz?16:15)}px`),document.documentElement.style.setProperty("--message-meta-height",`${Math.floor(1.3125*e)}px`),document.documentElement.style.setProperty("--message-text-size",`${e}px`),document.documentElement.setAttribute("data-message-text-size",e.toString()),d({messageTextSize:e})},[]),C=(0,s.hb)(e=>{const t="auto"===e?(0,Bh.V)():e;d({theme:t}),d({shouldUseSystemTheme:"auto"===e})},[]),y=(0,s.hb)(e=>{d({timeFormat:e}),d({wasTimeFormatSetManually:!0}),(0,Th.bV)(e)},[]),S=(0,s.hb)(e=>{d({messageSendKeyCombo:e})},[]);return(0,Ne.A)({isActive:e,onBack:c}),(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0,children:u("Settings")}),(0,se.Y)(Xe.A,{label:u("TextSize"),min:12,max:20,value:t,onChange:b}),(0,se.Y)(li.A,{icon:"photo",narrow:!0,onClick:()=>h({screen:o.VS.GeneralChatBackground}),children:u("ChatBackground")})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0,children:u("Theme")}),(0,se.Y)(ie.A,{name:"theme",options:A,selected:l?"auto":r,onChange:C})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0,children:u("SettingsTimeFormat")}),(0,se.Y)(ie.A,{name:"timeformat",options:g,selected:a,onChange:y})]}),f&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0,children:u("SettingsKeyboard")}),(0,se.Y)(ie.A,{name:"keyboard-send-settings",options:f,onChange:S,selected:i})]})]})}));var Rh=i(52844);const xh=(0,s.ph)(({wallpaper:e,theme:t,isSelected:i,onClick:n})=>{const{slug:r,document:l}=e,c=`wallpaper${l.id}`,d=l.previewBlobUrl,h=(0,q.A)(`${c}?size=m`),m=(0,Yi.A)(l.thumbnail?.dataUri,Boolean(h),!0),{transitionClassNames:u}=(0,je.A)(Boolean(h||d),void 0,void 0,"slow"),p=(0,s.li)(!1),[v,g]=(0,s.J0)(!1),{mediaData:A,loadProgress:f}=(0,W.A)(c,!v),b=!1===(0,K.A)(v),{shouldRender:C,transitionClassNames:y}=(0,je.A)(v&&!A||r===o.Vw,void 0,b,"slow"),S=(0,s.li)();S.current=t;const N=(0,s.hb)(()=>{(async()=>{const e=await(0,z.sZ)(A);await ph.save(a.nfi,S.current,e),n(r)})()},[A,n,r]);(0,s.vJ)(()=>{A&&p.current&&(N(),p.current=!1)},[A,N]);const k=(0,s.hb)(()=>{A?N():(p.current=!0,g(e=>!e))},[A,N]),w=(0,ge.A)("WallpaperTile",i&&"selected");return(0,se.Y)("div",{className:w,onClick:k,children:(0,se.FD)("div",{className:"media-inner",children:[(0,se.Y)("canvas",{ref:m,className:"thumbnail"}),(0,se.Y)("img",{src:h||d,className:(0,ge.A)("full-media",u),alt:"",draggable:!1}),C&&(0,se.Y)("div",{className:(0,ge.A)("spinner-container",y),children:(0,se.Y)(pe.A,{progress:f,onClick:k})})]})})}),Eh=(0,be.nF)(e=>e(),6e4,!0),Vh=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.SJA)(e),{background:i,isBlurred:s}=(0,c.Gyz)(e,t)||{},{loadedWallpapers:n}=e.settings;return{background:i,isBlurred:s,loadedWallpapers:n,theme:t}})(({isActive:e,onReset:t,background:i,isBlurred:r,loadedWallpapers:l,theme:c})=>{const{loadWallpapers:d,uploadWallpaper:h,setThemeSettings:m,openSettingsScreen:u}=(0,n.ko)(),p=(0,s.li)();p.current=c,(0,s.vJ)(()=>{Eh(()=>{d()})},[d]);const v=(0,s.hb)(e=>{const{files:t}=e.target,i=(0,z.kc)(t);i?.length&&h(i[0])},[h]),g=(0,s.hb)(()=>{(0,Rh.p)("image/jpeg",v,!0)},[v]),A=(0,s.hb)(()=>{u({screen:o.VS.GeneralChatBackgroundColor})},[]),f=(0,s.hb)(()=>{m({theme:c,background:void 0,backgroundColor:void 0,isBlurred:!0,patternColor:"dark"===c?a.MkD:a.be8})},[m,c]),b=(0,s.hb)(e=>{m({theme:p.current,background:e});const t=l&&l.find(t=>t.slug===e);t?.document.thumbnail&&(0,dn.rX)(t.document.thumbnail.dataUri).then(e=>{m({theme:p.current,backgroundColor:(0,dn.v2)(e),patternColor:(0,dn.Yi)(e)})})},[l,m]),C=(0,s.hb)(e=>{m({theme:p.current,isBlurred:e.target.checked})},[m]),y=(0,B.A)();(0,Ne.A)({isActive:e,onBack:t});const S=l?.[0]&&l[0].slug===o.Vw;return(0,se.FD)("div",{className:"SettingsGeneralBackground settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{icon:"camera-add",className:"mb-0",disabled:S,onClick:g,children:y("UploadImage")}),(0,se.Y)(li.A,{icon:"colorize",className:"mb-0",onClick:A,children:y("SetColor")}),(0,se.Y)(li.A,{icon:"favorite",onClick:f,children:y("ThemeResetToDefaults")}),(0,se.Y)(Hs.A,{label:y("BackgroundBlurred"),checked:Boolean(r),onChange:C})]}),l?(0,se.Y)("div",{className:"settings-wallpapers",children:l.map(e=>(0,se.Y)(xh,{wallpaper:e,theme:c,isSelected:i===e.slug,onClick:b},e.slug))}):(0,se.Y)(Ds.A,{})]})})),_h=(0,dn.bi)((0,dn.xp)("e6ebee")),Uh=["#e6ebee","#b2cee1","#008dd0","#c6e7cb","#c4e1a6","#60b16e","#ccd0af","#a6a997","#7a7072","#fdd7af","#fdb76e","#dd8851"];function Oh(e,t){return{colorPosition:[Math.round(e[1]*(t.colorRect.width-1)),Math.round((1-e[2])*(t.colorRect.height-1))],huePosition:Math.round(e[0]*(t.hueRect.width-1))}}function Kh({colorPosition:e,huePosition:t},i){return[t/(i.hueRect.width-1),e[0]/(i.colorRect.width-1),1-e[1]/(i.colorRect.height-1)]}const Jh=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.SJA)(e),{backgroundColor:i}=(0,c.Gyz)(e,t)||{};return{backgroundColor:i,theme:t}})(({isActive:e,onReset:t,theme:i,backgroundColor:o})=>{const{setThemeSettings:a}=(0,n.ko)(),r=(0,s.li)();r.current=i;const l=(0,s.li)(),c=(0,s.li)(),d=(0,s.li)(),h=(0,s.li)(!0),[m,u]=(0,s.J0)(()=>function(e){return e?.startsWith("#")?(0,dn.bi)((0,dn.xp)(e)):_h}(o)),p=(0,s.li)(m);(0,s.vJ)(()=>{p.current=m},[m]);const[v,g,A]=(0,D.A)(),[f,b]=(0,s.J0)(""),[C,y]=(0,s.J0)(""),S=(0,s.li)(),N=(0,s.li)();(0,s.vJ)(()=>{const e={offsetLeft:c.current.offsetLeft,...(0,di.Up)(c.current.getBoundingClientRect(),["top","width","height"])},t={offsetLeft:d.current.offsetLeft,...(0,di.Up)(d.current.getBoundingClientRect(),["width"])};function i(t){const i=[Math.min(Math.max(0,t.pageX-e.offsetLeft),e.width-1),Math.min(Math.max(0,t.pageY-e.top+l.current.scrollTop),e.height-1)],{huePosition:s}=Oh(p.current,S.current);return u(Kh({colorPosition:i,huePosition:s},S.current)),g(),!0}function s(e){const{colorPosition:i}=Oh(p.current,S.current),s=Math.min(Math.max(0,e.pageX-t.offsetLeft),t.width-1);return u(Kh({colorPosition:i,huePosition:s},S.current)),g(),!0}S.current={colorRect:e,hueRect:t},(0,Ae.wJ)(c.current,{onCapture:i,onDrag:i,onRelease:A,onClick:A,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0}),(0,Ae.wJ)(d.current,{onCapture:s,onDrag:s,onRelease:A,onClick:A,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0})},[g,A]);const{colorPosition:k=[0,0],huePosition:w=0}=S.current?Oh(m,S.current):{},I=(0,dn.v2)((0,dn.hT)(m)),P=m[0],Y=(0,dn.v2)((0,dn.hT)([P,1,1]));(0,s.vJ)(()=>{const e=(0,dn.hT)(m),t=(0,dn.v2)(e);if(b(e.join(", ")),y(t),!h.current){const i=(0,dn.Yi)(e);a({theme:r.current,background:void 0,backgroundColor:t,patternColor:i})}h.current=!1},[m,a]),(0,s.vJ)(()=>{!function(e,t,i,s){let n,o,a;i.current&&s.current?(n=s.current.colorRect.width,o=s.current.colorRect.height,a=i.current):(n=e.offsetWidth,o=e.offsetHeight,a=e.getContext("2d"),e.width=n,e.height=o,i.current=a);const r=a.createImageData(n,o),l=r.data,c=(0,dn.hT)([t,1,1]);let d=0;for(let e=0;e<o;e++){const t=1-e/(o-1),i=[255*t,255*t,255*t],s=[c[0]*t,c[1]*t,c[2]*t];for(let e=0;e<n;e++){const t=e/(n-1);l[d++]=i[0]+(s[0]-i[0])*t,l[d++]=i[1]+(s[1]-i[1])*t,l[d++]=i[2]+(s[2]-i[2])*t,l[d++]=255}}a.putImageData(r,0,0)}(c.current.firstChild,P,N,S)},[P]),(0,s.vJ)(()=>{!function(e){const t=e.offsetWidth;e.width=t,e.height=1;const i=e.getContext("2d"),s=i.createImageData(t,1),n=s.data;let o=0;for(let e=0;e<t;e++){const i=e/(t-1),s=(0,dn.hT)([i,1,1]);n[o++]=s[0],n[o++]=s[1],n[o++]=s[2],n[o++]=255}i.putImageData(s,0,0)}(d.current.firstChild)},[]);const F=(0,s.hb)(e=>{const t=e.currentTarget.value.replace(/[^\d, ]/g,"").slice(0,13);if(t.match(/^\d{1,3},\s?\d{1,3},\s?\d{1,3}$/)){const e=t.split(",").map(e=>Number(e.trim()));u((0,dn.bi)(e))}e.currentTarget.value=t},[]),M=(0,s.hb)(e=>{const t=e.currentTarget.value.replace(/[^0-9a-fA-F]/g,"").slice(0,6);t.match(/^#?[0-9a-fA-F]{6}$/)&&u((0,dn.bi)((0,dn.xp)(t))),e.currentTarget.value=t},[]),T=(0,s.hb)(e=>{u((0,dn.bi)((0,dn.xp)(e.currentTarget.dataset.color)))},[]),B=(0,ge.A)("SettingsGeneralBackgroundColor settings-content custom-scroll",v&&"is-dragging");return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{ref:l,className:B,children:[(0,se.FD)("div",{className:"settings-item pt-3",children:[(0,se.FD)("div",{ref:c,className:"color-picker",children:[(0,se.Y)("canvas",{}),(0,se.Y)("div",{className:"handle",style:`transform: translate(${k[0]}px, ${k[1]}px); background-color: ${I};`})]}),(0,se.FD)("div",{ref:d,className:"hue-picker",children:[(0,se.Y)("canvas",{}),(0,se.Y)("div",{className:"handle",style:`transform: translateX(${w}px); background-color: ${Y};`})]}),(0,se.FD)("div",{className:"tools",children:[(0,se.Y)(ee.A,{value:C,label:"HEX",onChange:M}),(0,se.Y)(ee.A,{value:f,label:"RGB",onChange:F})]})]}),(0,se.Y)("div",{className:"predefined-colors",children:Uh.map(e=>(0,se.Y)("div",{className:(0,ge.A)("predefined-color",e===I?"active":void 0),"data-color":e,style:`background-color: ${e};`,onClick:T}))})]})})),Gh=(0,s.ph)(({currentScreen:e,editedFolderId:t,onReset:i})=>{const{signOut:a,openDeleteChatFolderModal:r,openSettingsScreen:l}=(0,n.ko)(),{isMobile:c}=(0,Y.Ay)(),[d,h]=(0,s.J0)(!1),m=function(e,t){const i=(0,s.li)(0),n=(0,s.li)();return(0,s.hb)(()=>{if(i.current++,5===i.current)return i.current=0,void t();n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{i.current=0},300)},[5,t])}(0,()=>{l({screen:o.VS.Experimental})}),u=(0,s.hb)(()=>{h(!0)},[]),p=(0,s.hb)(()=>{h(!1)},[]),v=(0,s.hb)(()=>{t&&r({folderId:t})},[t,r]),g=(0,s.hb)(()=>{p(),a({forceInitApi:!0})},[p,a]),A=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.Y)(X.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",iconName:"more"}),[c]),f=(0,B.A)(),b=(0,Fi.A)();return(0,se.FD)("div",{className:"left-header",children:[(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:i,ariaLabel:f("AccDescrGoBack"),iconName:"arrow-left"}),function(){switch(e){case o.VS.EditProfile:return(0,se.Y)("h3",{children:f("lng_settings_information")});case o.VS.General:return(0,se.Y)("h3",{children:f("General")});case o.VS.QuickReaction:return(0,se.Y)("h3",{children:f("DoubleTapSetting")});case o.VS.CustomEmoji:return(0,se.Y)("h3",{children:f("Emoji")});case o.VS.Notifications:return(0,se.Y)("h3",{children:f("Notifications")});case o.VS.DataStorage:return(0,se.Y)("h3",{children:f("DataSettings")});case o.VS.Privacy:return(0,se.Y)("h3",{children:f("PrivacySettings")});case o.VS.Language:return(0,se.Y)("h3",{children:f("Language")});case o.VS.DoNotTranslate:return(0,se.Y)("h3",{children:f("DoNotTranslate")});case o.VS.Stickers:return(0,se.Y)("h3",{children:f("StickersName")});case o.VS.Experimental:return(0,se.Y)("h3",{children:f("lng_settings_experimental")});case o.VS.GeneralChatBackground:return(0,se.Y)("h3",{children:f("ChatBackground")});case o.VS.GeneralChatBackgroundColor:return(0,se.Y)("h3",{children:f("SetColor")});case o.VS.PrivacyPhoneNumber:return(0,se.Y)("h3",{children:f("PrivacyPhone")});case o.VS.PrivacyLastSeen:return(0,se.Y)("h3",{children:f("PrivacyLastSeen")});case o.VS.PrivacyProfilePhoto:return(0,se.Y)("h3",{children:f("Privacy.ProfilePhoto")});case o.VS.PrivacyBio:return(0,se.Y)("h3",{children:f("PrivacyBio")});case o.VS.PrivacyBirthday:return(0,se.Y)("h3",{children:f("PrivacyBirthday")});case o.VS.PrivacyGifts:return(0,se.Y)("h3",{children:b("PrivacyGifts")});case o.VS.PrivacyForwarding:return(0,se.Y)("h3",{children:f("PrivacyForwards")});case o.VS.PrivacyVoiceMessages:return(0,se.Y)("h3",{children:f("PrivacyVoiceMessages")});case o.VS.PrivacyMessages:return(0,se.Y)("h3",{children:f("PrivacyMessages")});case o.VS.PrivacyGroupChats:return(0,se.Y)("h3",{children:f("AutodownloadGroupChats")});case o.VS.PrivacyPhoneCall:return(0,se.Y)("h3",{children:f("Calls")});case o.VS.PrivacyLastSeenAllowedContacts:case o.VS.PrivacyProfilePhotoAllowedContacts:case o.VS.PrivacyBioAllowedContacts:case o.VS.PrivacyGroupChatsAllowedContacts:return(0,se.Y)("h3",{children:f("AlwaysShareWith")});case o.VS.PrivacyLastSeenDeniedContacts:case o.VS.PrivacyProfilePhotoDeniedContacts:case o.VS.PrivacyBioDeniedContacts:case o.VS.PrivacyGroupChatsDeniedContacts:return(0,se.Y)("h3",{children:f("NeverShareWith")});case o.VS.PrivacyPhoneNumberAllowedContacts:case o.VS.PrivacyBirthdayAllowedContacts:case o.VS.PrivacyGiftsAllowedContacts:case o.VS.PrivacyForwardingAllowedContacts:case o.VS.PrivacyVoiceMessagesAllowedContacts:case o.VS.PrivacyPhoneCallAllowedContacts:case o.VS.PrivacyPhoneP2PAllowedContacts:return(0,se.Y)("h3",{children:f("AlwaysAllow")});case o.VS.PrivacyPhoneNumberDeniedContacts:case o.VS.PrivacyBirthdayDeniedContacts:case o.VS.PrivacyGiftsDeniedContacts:case o.VS.PrivacyForwardingDeniedContacts:case o.VS.PrivacyVoiceMessagesDeniedContacts:case o.VS.PrivacyPhoneCallDeniedContacts:case o.VS.PrivacyPhoneP2PDeniedContacts:return(0,se.Y)("h3",{children:f("NeverAllow")});case o.VS.PrivacyNoPaidMessages:return(0,se.Y)("h3",{children:b("RemoveFeeTitle")});case o.VS.Performance:return(0,se.Y)("h3",{children:b("MenuAnimations")});case o.VS.ActiveSessions:return(0,se.Y)("h3",{children:f("SessionsTitle")});case o.VS.ActiveWebsites:return(0,se.Y)("h3",{children:f("OtherWebSessions")});case o.VS.PrivacyBlockedUsers:return(0,se.Y)("h3",{children:f("BlockedUsers")});case o.VS.TwoFaDisabled:case o.VS.TwoFaEnabled:return(0,se.Y)("h3",{children:f("TwoStepVerification")});case o.VS.TwoFaNewPassword:case o.VS.TwoFaChangePasswordNew:case o.VS.TwoFaChangePasswordConfirm:return(0,se.Y)("h3",{children:f("PleaseEnterCurrentPassword")});case o.VS.TwoFaNewPasswordConfirm:return(0,se.Y)("h3",{children:f("PleaseReEnterPassword")});case o.VS.TwoFaNewPasswordHint:case o.VS.TwoFaChangePasswordHint:return(0,se.Y)("h3",{children:f("PasswordHint")});case o.VS.TwoFaNewPasswordEmail:case o.VS.TwoFaRecoveryEmail:return(0,se.Y)("h3",{children:f("RecoveryEmailTitle")});case o.VS.TwoFaNewPasswordEmailCode:case o.VS.TwoFaRecoveryEmailCode:return(0,se.Y)("h3",{children:"Recovery Email Code"});case o.VS.TwoFaCongratulations:return(0,se.Y)("h3",{children:f("TwoStepVerificationPasswordSet")});case o.VS.TwoFaChangePasswordCurrent:case o.VS.TwoFaTurnOff:case o.VS.TwoFaRecoveryEmailCurrentPassword:return(0,se.Y)("h3",{children:f("PleaseEnterCurrentPassword")});case o.VS.PasscodeDisabled:case o.VS.PasscodeEnabled:case o.VS.PasscodeNewPasscode:case o.VS.PasscodeNewPasscodeConfirm:case o.VS.PasscodeCongratulations:return(0,se.Y)("h3",{children:f("Passcode")});case o.VS.PasscodeTurnOff:return(0,se.Y)("h3",{children:f("PasscodeController.Disable.Title")});case o.VS.PasscodeChangePasscodeCurrent:case o.VS.PasscodeChangePasscodeNew:return(0,se.Y)("h3",{children:f("PasscodeController.Change.Title")});case o.VS.PasscodeChangePasscodeConfirm:return(0,se.Y)("h3",{children:f("PasscodeController.ReEnterPasscode.Placeholder")});case o.VS.Folders:return(0,se.Y)("h3",{children:f("Filters")});case o.VS.FoldersCreateFolder:return(0,se.Y)("h3",{children:f("FilterNew")});case o.VS.FoldersShare:return(0,se.Y)("h3",{children:f("FolderLinkScreen.Title")});case o.VS.FoldersEditFolder:case o.VS.FoldersEditFolderFromChatList:case o.VS.FoldersEditFolderInvites:return(0,se.FD)("div",{className:"settings-main-header",children:[(0,se.Y)("h3",{children:f("FilterEdit")}),Boolean(t)&&(0,se.Y)(me.A,{className:"settings-more-menu",trigger:A,positionX:"right",children:(0,se.Y)(ue.A,{icon:"delete",destructive:!0,onClick:v,children:f("Delete")})})]});case o.VS.FoldersIncludedChats:case o.VS.FoldersIncludedChatsFromChatList:case o.VS.FoldersExcludedChats:case o.VS.FoldersExcludedChatsFromChatList:return(0,se.Y)("h3",{children:f(e===o.VS.FoldersIncludedChats||e===o.VS.FoldersIncludedChatsFromChatList?"FilterInclude":"FilterExclude")});case o.VS.Passkeys:return(0,se.Y)("h3",{children:b("SettingsPasskeyTitle")});default:return(0,se.FD)("div",{className:"settings-main-header",children:[(0,se.Y)("h3",{onClick:m,children:f("SETTINGS")}),(0,se.Y)(X.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",onClick:()=>l({screen:o.VS.EditProfile}),ariaLabel:f("lng_settings_information"),iconName:"edit"}),(0,se.Y)(me.A,{className:"settings-more-menu",trigger:A,positionX:"right",children:(0,se.Y)(ue.A,{icon:"logout",onClick:u,children:f("LogOutTitle")})})]})}}(),(0,se.Y)(oi.A,{isOpen:d,onClose:p,text:f("lng_sure_logout"),confirmLabel:f("AccountSettings.Logout"),confirmHandler:g,confirmIsDestructive:!0})]})}),jh=(0,s.ph)((0,n.EK)(e=>{const{canTranslate:t,canTranslateChats:i,doNotTranslate:s}=e.settings.byKey,{language:n,languages:o}=(0,ks.lS)(e);return{isCurrentUserPremium:(0,c.g29)(e),languages:o,language:n,canTranslate:t,canTranslateChats:i,doNotTranslate:s}})(({isActive:e,isCurrentUserPremium:t,languages:i,language:a,canTranslate:r,canTranslateChats:l,doNotTranslate:c,onReset:d})=>{const{loadLanguages:h,setSettingOption:u,setSharedSettingOption:p,openPremiumModal:v,openSettingsScreen:g}=(0,n.ko)(),[A,f]=(0,s.J0)(a),[b,C,y]=(0,D.A)(),S=t&&l,N=(0,B.A)();(0,s.vJ)(()=>{i?.length||h()},[i]);const k=(0,T.A)(e=>{f(e),C(),(0,Th.wT)(e,()=>{y(),p({language:e})})}),w=(0,s.Kr)(()=>{if(!i)return;const e=(window.navigator.language||"en").toLowerCase(),t=e.substr(0,2);return i.map(({langCode:e,nativeName:t,name:i})=>({value:e,label:t,subLabel:i,isLoading:e===A&&b})).sort(i=>!e||i.value!==e&&i.value!==t?0:-1)},[b,i,A]),I=(0,T.A)(e=>{u({canTranslate:e})}),P=(0,T.A)(e=>{u({canTranslateChats:e})}),Y=(0,T.A)(()=>{t||v({initialSection:"translations"})}),F=(0,s.Kr)(()=>{if(m.CM&&c.length)return 1===c.length?new Intl.DisplayNames([a],{type:"language"}).of(c[0]):N("Languages",c.length)},[c,N,a]),M=(0,T.A)(()=>{g({screen:o.VS.DoNotTranslate})});return(0,Ne.A)({isActive:e,onBack:d}),(0,se.FD)("div",{className:"settings-content settings-language custom-scroll",children:[m.CM&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(Hs.A,{label:N("ShowTranslateButton"),checked:r,onCheck:I}),(0,se.Y)(Hs.A,{label:N("ShowTranslateChatButton"),checked:S,disabled:!t,rightIcon:t?void 0:"lock",onClickLabel:Y,onCheck:P}),(r||S)&&(0,se.FD)(li.A,{narrow:!0,onClick:M,children:[N("DoNotTranslate"),(0,se.Y)("span",{className:"settings-item__current-value",children:F})]}),(0,se.Y)("p",{className:"settings-item-description mb-0 mt-1",children:N("lng_translate_settings_about")})]}),(0,se.FD)("div",{className:"settings-item settings-item-picker",children:[(0,se.Y)("h4",{className:"settings-item-header",children:N("Localization.InterfaceLanguage")}),w?(0,se.Y)(lc,{items:w,selectedValue:A,forceRenderAllItems:!0,onSelectedValueChange:k,itemInputType:"radio",className:"settings-picker"}):(0,se.Y)(Ds.A,{})]})]})}));var zh=i(86046),Hh=i(25301),$h=i(87970);const qh=(0,s.ph)((0,n.EK)(e=>{const{currentUserId:t}=e,i=(0,c.hc)(e),s=e.stars?.balance,n=e.ton?.balance;return{sessionCount:e.activeSessions.orderedHashes.length,currentUserId:t,canBuyPremium:!(0,c.n_C)(e),isGiveawayAvailable:i,starsBalance:s,tonBalance:n}})(({isActive:e,currentUserId:t,sessionCount:i,canBuyPremium:r,isGiveawayAvailable:l,starsBalance:c,tonBalance:d,onReset:h})=>{const{loadMoreProfilePhotos:m,openPremiumModal:u,openSupportChat:p,openUrl:v,openGiftRecipientPicker:g,openStarsBalanceModal:A,openSettingsScreen:f}=(0,n.ko)(),[b,C,y]=(0,D.A)(!1),S=(0,Fi.A)();(0,s.vJ)(()=>{t&&m({peerId:t,isPreload:!0})},[t]),(0,Ne.A)({isActive:e,onBack:h});const N=(0,T.A)(()=>{p(),y()});return(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-main-menu self-profile",children:[t&&(0,se.Y)($h.A,{peerId:t,canPlayVideo:Boolean(e),isForSettings:!0}),t&&(0,se.Y)(Hh.A,{chatOrUserId:t,isInSettings:!0})]}),(0,se.FD)("div",{className:"settings-main-menu",children:[(0,se.Y)(li.A,{icon:"settings",narrow:!0,onClick:()=>f({screen:o.VS.General}),children:S("TelegramGeneralSettingsViewController")}),(0,se.Y)(li.A,{icon:"animations",narrow:!0,onClick:()=>f({screen:o.VS.Performance}),children:S("MenuAnimations")}),(0,se.Y)(li.A,{icon:"unmute",narrow:!0,onClick:()=>f({screen:o.VS.Notifications}),children:S("Notifications")}),(0,se.Y)(li.A,{icon:"data",narrow:!0,onClick:()=>f({screen:o.VS.DataStorage}),children:S("DataSettings")}),(0,se.Y)(li.A,{icon:"lock",narrow:!0,onClick:()=>f({screen:o.VS.Privacy}),children:S("PrivacySettings")}),(0,se.Y)(li.A,{icon:"folder",narrow:!0,onClick:()=>f({screen:o.VS.Folders}),children:S("Filters")}),(0,se.FD)(li.A,{icon:"active-sessions",narrow:!0,onClick:()=>f({screen:o.VS.ActiveSessions}),children:[S("SessionsTitle"),i>0&&(0,se.Y)("span",{className:"settings-item__current-value",children:i})]}),(0,se.FD)(li.A,{icon:"language",narrow:!0,onClick:()=>f({screen:o.VS.Language}),children:[S("Language"),(0,se.Y)("span",{className:"settings-item__current-value",children:S.languageInfo.nativeName})]}),(0,se.Y)(li.A,{icon:"stickers",narrow:!0,onClick:()=>f({screen:o.VS.Stickers}),children:S("MenuStickers")})]}),(0,se.FD)("div",{className:"settings-main-menu",children:[r&&(0,se.Y)(li.A,{leftElement:(0,se.Y)(Zd.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),narrow:!0,onClick:()=>u(),children:S("TelegramPremium")}),(0,se.FD)(li.A,{leftElement:(0,se.Y)(Zd.A,{className:"icon ListItem-main-icon",type:"gold",size:"big"}),narrow:!0,onClick:()=>A({}),children:[S("MenuStars"),Boolean(c)&&(0,se.Y)("span",{className:"settings-item__current-value",children:(0,zh.ZF)(S,c)})]}),(0,se.FD)(li.A,{leftElement:(0,se.Y)(he.A,{className:"icon ListItem-main-icon",name:"toncoin"}),narrow:!0,onClick:()=>A({currency:a.ykW}),children:[S("MenuTon"),Boolean(d)&&(0,se.Y)("span",{className:"settings-item__current-value",children:(0,oo.UL)(d.amount,d.currency)})]}),l&&(0,se.Y)(li.A,{icon:"gift",narrow:!0,onClick:()=>g(),children:S("MenuSendGift")})]}),(0,se.FD)("div",{className:"settings-main-menu",children:[(0,se.Y)(li.A,{icon:"ask-support",narrow:!0,onClick:C,children:S("AskAQuestion")}),(0,se.Y)(li.A,{icon:"help",narrow:!0,onClick:()=>v({url:a.r9K}),children:S("MenuTelegramFaq")}),(0,se.Y)(li.A,{icon:"privacy-policy",narrow:!0,onClick:()=>v({url:a.pkx}),children:S("MenuPrivacyPolicy")})]}),(0,se.Y)(oi.A,{isOpen:b,confirmLabel:S("OK"),title:S("AskAQuestion"),textParts:S("MenuAskText",void 0,{withNodes:!0,renderTextFilters:["br"]}),confirmHandler:N,onClose:y})]})}));var Wh=i(5560),Qh=i(56133);const Zh=(0,s.ph)((0,n.EK)(e=>({hasContactJoinedNotifications:Boolean(e.settings.byKey.hasContactJoinedNotifications),hasWebNotifications:e.settings.byKey.hasWebNotifications,hasPushNotifications:e.settings.byKey.hasPushNotifications,notificationSoundVolume:e.settings.byKey.notificationSoundVolume,notifyDefaults:e.settings.notifyDefaults}))(({isActive:e,onReset:t,notifyDefaults:i,hasContactJoinedNotifications:o,hasPushNotifications:a,hasWebNotifications:r,notificationSoundVolume:l})=>{const{loadNotificationSettings:c,updateContactSignUpNotification:d,updateNotificationSettings:h,updateWebNotificationSettings:m}=(0,n.ko)();(0,s.vJ)(()=>{c()},[c]);const u=(0,Qh.A)(500,!0),p=(0,Wh.M2)(),v=p&&!(0,Wh.Ac)(),g=Boolean(i?.channels?.mutedUntil),A=Boolean(i?.groups?.mutedUntil),f=Boolean(i?.users?.mutedUntil),b=(0,s.hb)((e,t,s)=>{const n=Boolean(i?.[t]?.mutedUntil),o=Boolean(i?.[t]?.shouldShowPreviews);h({peerType:t,isMuted:"mute"===s?!e.target.checked:n,shouldShowPreviews:"showPreviews"===s?e.target.checked:o})},[i]),C=(0,s.hb)(e=>{const t=e.target.checked;m({hasWebNotifications:t,...!t&&{hasPushNotifications:!1}})},[m]),y=(0,s.hb)(e=>{m({hasPushNotifications:e.target.checked})},[m]),S=(0,s.hb)(e=>{b(e,"users","mute")},[b]),N=(0,s.hb)(e=>{b(e,"users","showPreviews")},[b]),k=(0,s.hb)(e=>{b(e,"groups","mute")},[b]),w=(0,s.hb)(e=>{b(e,"groups","showPreviews")},[b]),I=(0,s.hb)(e=>{b(e,"channels","mute")},[b]),P=(0,s.hb)(e=>{b(e,"channels","showPreviews")},[b]),Y=(0,s.hb)(e=>{d({isSilent:!e.target.checked})},[d]),F=(0,s.hb)(e=>{m({notificationSoundVolume:e}),u(()=>(0,Wh.BA)(void 0,e))},[u,m]),D=(0,Fi.A)();return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("NotificationsWeb")}),(0,se.Y)(Hs.A,{label:D("NotificationsWeb"),subLabel:D(r?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:r,disabled:!p,onChange:C}),(0,se.Y)(Hs.A,{label:D("NotificationsOffline"),disabled:!r||!v,subLabel:D(v?a?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled":"SettingsOfflineNotificationUnsupported"),checked:a,onChange:y}),(0,se.Y)("div",{className:"settings-item-slider",children:(0,se.Y)(Xe.A,{label:D("NotificationsSound"),min:0,max:10,disabled:!p,value:l,onChange:F})})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("AutodownloadPrivateChats")}),(0,se.Y)(Hs.A,{label:D("NotificationsForPrivateChats"),subLabel:D(f?"UserInfoNotificationsDisabled":"UserInfoNotificationsEnabled"),checked:!f,onChange:S}),(0,se.Y)(Hs.A,{label:D("MessagePreview"),disabled:f,subLabel:D(i?.users?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.users?.shouldShowPreviews),onChange:N})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("FilterGroups")}),(0,se.Y)(Hs.A,{label:D("NotificationsForGroups"),subLabel:D(A?"UserInfoNotificationsDisabled":"UserInfoNotificationsEnabled"),checked:!A,onChange:k}),(0,se.Y)(Hs.A,{label:D("MessagePreview"),disabled:A,subLabel:D(i?.groups?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.groups?.shouldShowPreviews),onChange:w})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("FilterChannels")}),(0,se.Y)(Hs.A,{label:D("NotificationsForChannels"),subLabel:D(g?"UserInfoNotificationsDisabled":"UserInfoNotificationsEnabled"),checked:!g,onChange:I}),(0,se.Y)(Hs.A,{label:D("MessagePreview"),disabled:g,subLabel:D(i?.channels?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.channels?.shouldShowPreviews),onChange:P})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("PhoneOther")}),(0,se.Y)(Hs.A,{label:D("ContactJoined"),checked:o,onChange:Y})]})]})})),Xh=2*g.$,em=(0,s.ph)((0,n.EK)(e=>({passkeys:e.settings.passkeys,maxPasskeysCount:e.appConfig.passkeysMaxCount}))(({isActive:e,passkeys:t,maxPasskeysCount:i,onReset:o})=>{const{startPasskeyRegistration:a,deletePasskey:r,openPasskeyModal:l}=(0,n.ko)(),c=(0,Fi.A)(),[d,h]=(0,s.J0)(),u=m.DL&&(t?.length??0)<i,p=(0,T.A)(()=>{a()}),v=(0,T.A)(()=>{l()}),g=(0,T.A)(()=>{d&&(r({id:d}),h(void 0))});return(0,s.vJ)(()=>{t&&!t.length&&e&&o()},[t,o,e]),(0,Ne.A)({isActive:e,onBack:o}),(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Passkeys,previewUrl:ur.d.Passkeys,size:120,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description",dir:"auto",children:c("SettingsPasskeyInfo")})]}),(0,se.FD)("div",{className:"settings-item",children:[t?.map(function(e){const{softwareEmojiId:t,id:i,name:s,date:n,lastUsageDate:o}=e;return(0,se.Y)(li.A,{ripple:!0,narrow:!0,contextActions:[{title:c("Delete"),icon:"delete",destructive:!0,handler:()=>{h(i)}}],leftElement:t?(0,se.Y)(ro.A,{size:Xh,className:(0,ge.A)("KYlz_M1L","ListItem-main-icon"),documentId:t,noPlay:!0}):(0,se.Y)(he.A,{name:"lock",className:(0,ge.A)("eHtPi2EI","ListItem-main-icon")}),children:(0,se.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,se.Y)("span",{className:"date",children:(0,We.vm)(c,n)}),(0,se.Y)("span",{className:"title",children:s||c("SettingsPasskeyFallbackTitle")}),Boolean(o)&&(0,se.Y)("span",{className:"subtitle",children:c("SettingsPasskeyUsedAt",{date:(0,We.vm)(c,o)})})]})},i)}),u&&(0,se.Y)(X.A,{className:"settings-button",color:"primary",iconName:"add",isText:!0,noForcedUpperCase:!0,onClick:p,children:c("SettingsPasskeysCreate")}),(0,se.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:c("SettingsPasskeysFooter",{link:(0,se.Y)(fa.A,{isPrimary:!0,onClick:v,children:c("SettingsPasskeysFooterLink")})},{withNodes:!0})})]}),(0,se.Y)(oi.A,{isOpen:Boolean(d),title:c("PasskeyDeleteTitle"),textParts:c("PasskeyDeleteText",void 0,{withNodes:!0,renderTextFilters:["br"]}),confirmHandler:g,confirmIsDestructive:!0,confirmLabel:c("Delete"),onClose:()=>h(void 0)})]})}));var tm=i(20714),im=i(22986);const sm=["SettingsPerformanceSliderLow","SettingsPerformanceSliderMedium","SettingsPerformanceSliderHigh"],nm=["SettingsPerformanceSliderLow","SettingsPerformanceSliderCustom","SettingsPerformanceSliderHigh"],om=[["SettingsPerformanceInterfaceAnimations",[{key:"pageTransitions",label:"SettingsPerformancePageTransitions"},{key:"messageSendingAnimations",label:"SettingsPerformanceSending"},{key:"mediaViewerAnimations",label:"SettingsPerformanceMediaViewer"},{key:"messageComposerAnimations",label:"SettingsPerformanceComposer"},{key:"contextMenuAnimations",label:"SettingsPerformanceContextAnimation"},{key:"contextMenuBlur",label:"SettingsPerformanceContextBlur",disabled:!m.Fy},{key:"rightColumnAnimations",label:"SettingsPerformanceRightColumn"},{key:"snapEffect",label:"SettingsPerformanceThanos"}]],["SettingsPerformanceStickers",[{key:"animatedEmoji",label:"SettingsPerformanceAnimatedEmoji"},{key:"loopAnimatedStickers",label:"SettingsPerformanceLoopStickers"},{key:"reactionEffects",label:"SettingsPerformanceReactionEffects"},{key:"stickerEffects",label:"SettingsPerformanceStickerEffects"}]],["SettingsPerformanceMediaAutoplay",[{key:"autoplayGifs",label:"SettingsPerformanceAutoplayGif"},{key:"autoplayVideos",label:"SettingsPerformanceAutoplayVideo"}]]],am=(0,s.ph)((0,n.EK)(e=>({performanceSettings:(0,c.Cw0)(e)}))(function({isActive:e,performanceSettings:t,onReset:i}){const{setSharedSettingOption:o,updatePerformanceSettings:r}=(0,n.ko)();(0,Ne.A)({isActive:e,onBack:i});const l=(0,Fi.A)(),[c,d]=(0,s.J0)({}),h=(0,s.Kr)(()=>om.reduce((e,[,i],s)=>(e[s]=i.every(({key:e})=>t[e]),e),{}),[t]),u=(0,s.Kr)(()=>(0,im.T)(t,tm.LH)?a.zP3:(0,im.T)(t,tm.PI)?a.dnp:(0,im.T)(t,tm.tS)?a.zHL:a.M8B,[t]),p=(0,s.Kr)(()=>(u===a.M8B?nm:sm).map(e=>l(e)),[u,l]),v=(0,s.hb)((e,t)=>{e.preventDefault();const i=Number(t);d(e=>({...e,[i]:!e[i]}))},[]),g=(0,s.hb)(e=>{const t=e===a.dnp?tm.PI:e===a.zHL?tm.tS:tm.LH;o({animationLevel:e,wasAnimationLevelSetManually:!0}),r(t)},[]),A=(0,s.hb)(e=>{const{name:t,checked:i}=e.target,s=om.find(([e])=>e===t);if(!s)return;const n=s[1].reduce((e,{key:t})=>(e[t]=i,e),{});r(n)},[]),f=(0,s.hb)(e=>{const{name:t,checked:i}=e.target;r({[t]:i})},[]);return(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("SettingsPerformanceSliderTitle")}),(0,se.Y)("p",{className:"settings-item-description",dir:l.isRtl?"rtl":void 0,children:l("SettingsPerformanceSliderSubtitle")}),(0,se.Y)(Xe.A,{options:p,value:u===a.M8B?a.zHL:u,onChange:g})]}),(0,se.FD)("div",{className:"settings-item-simple settings-item__with-shifted-dropdown",children:[(0,se.Y)("h3",{className:"settings-item-header",dir:"auto",children:l("SettingsPerformanceGranularTitle")}),om.map(([e,i],s)=>(0,se.FD)("div",{className:"settings-dropdown-section",children:[(0,se.Y)("div",{className:"ListItem with-checkbox",children:(0,se.Y)(Hs.A,{name:e,value:s.toString(),checked:h[s],label:l(e),rightIcon:c[s]?"up":"down",onChange:A,onClickLabel:v})}),Boolean(c[s])&&(0,se.Y)("div",{className:"DropdownList DropdownList--open",children:i.map(({key:e,label:i,disabled:s})=>{if("snapEffect"!==e||m.bW)return(0,se.Y)(Hs.A,{name:e,checked:t[e],label:l(i),disabled:s,onChange:f},e)})})]},e))]})]})})),rm=(0,s.ph)((0,n.EK)(e=>{const{settings:{byKey:{hasPassword:t,isSensitiveEnabled:i,canChangeSensitive:s,shouldArchiveAndMuteNewNonContact:n,shouldNewNonContactPeersRequirePremium:o,nonContactPeersPaidStars:a},privacy:r,accountDaysTtl:l,passkeys:d},blocked:h,passcode:{hasPasscode:m},appConfig:u}=e,{canDisplayChatInTitle:p}=(0,ks.lS)(e),v=Boolean(a),g=(0,c.trm)(e),A=(0,c.g29)(e);return{isCurrentUserPremium:A,hasPassword:t,hasPasscode:Boolean(m),blockedCount:h.totalCount,webAuthCount:e.activeWebSessions.orderedHashes.length,isSensitiveEnabled:i,canDisplayAutoarchiveSetting:u.canDisplayAutoarchiveSetting||A,shouldArchiveAndMuteNewNonContact:n,canChangeSensitive:s,shouldNewNonContactPeersRequirePremium:o,shouldChargeForMessages:v,needAgeVideoVerification:Boolean(u.needAgeVideoVerification),privacy:r,canDisplayChatInTitle:p,canSetPasscode:(0,c.Ntz)(e),isCurrentUserFrozen:g,accountDaysTtl:l,passkeyCount:d?.length,arePasskeysAvailable:u.arePasskeysAvailable}})(({isActive:e,isCurrentUserPremium:t,hasPassword:i,hasPasscode:r,blockedCount:l,webAuthCount:c,passkeyCount:d,arePasskeysAvailable:h,isSensitiveEnabled:m,canChangeSensitive:u,canDisplayAutoarchiveSetting:p,shouldArchiveAndMuteNewNonContact:v,shouldNewNonContactPeersRequirePremium:g,shouldChargeForMessages:A,canDisplayChatInTitle:f,canSetPasscode:b,needAgeVideoVerification:C,privacy:y,isCurrentUserFrozen:S,accountDaysTtl:N,onReset:k})=>{const{openDeleteAccountModal:w,loadPrivacySettings:I,loadBlockedUsers:P,updateContentSettings:Y,loadGlobalPrivacySettings:F,updateGlobalPrivacySettings:D,loadWebAuthorizations:M,setSharedSettingOption:L,openSettingsScreen:R,loadAccountDaysTtl:x,openAgeVerificationModal:E,loadPasskeys:V,openPasskeyModal:_}=(0,n.ko)();(0,s.vJ)(()=>{S||(P(),I({}),M(),V())},[S]),(0,s.vJ)(()=>{e&&!S&&(F(),x())},[e,S]);const U=(0,B.A)(),O=(0,Fi.A)();(0,Ne.A)({isActive:e,onBack:k});const K=(0,T.A)(e=>{D({shouldArchiveAndMuteNewNonContact:e})}),J=(0,T.A)(e=>{L({canDisplayChatInTitle:e})}),G=(0,T.A)(e=>{Y({isSensitiveEnabled:e})}),j=(0,T.A)(()=>{E()}),z=(0,T.A)(()=>{N&&w({days:N})}),H=(0,T.A)(()=>{h&&void 0!==d&&(0!==d?R({screen:o.VS.Passkeys}):_())}),$=(0,s.Kr)(()=>{if(N)return Jr(a.WF4,N/30).toString()},[N]);function q(e){if(!e)return U("Loading");const{visibility:t,shouldAllowPremium:i,botsPrivacy:s}=e,n="everybody"===t,o="allow"===s&&!n,a=e.blockChatIds.length+e.blockUserIds.length,r=e.allowChatIds.length+e.allowUserIds.length,l=[];a&&l.push(`-${a}`),r&&!n&&l.push(`+${r}`);const c=[o?O("PrivacyValueBots"):"",O.conjunction(l)].filter(Boolean).join(" ");if(o&&!n)return c;if(i)return U(c?"ContactsAndPremium":"PrivacyPremium");switch(t){case"everybody":return`${U("P2PEverybody")} ${c}`;case"contacts":return`${U("P2PContacts")} ${c}`;case"nobody":return`${U("P2PNobody")} ${c}`}}return(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.FD)(li.A,{icon:"delete-user",narrow:!0,onClick:()=>R({screen:o.VS.PrivacyBlockedUsers}),children:[U("BlockedUsers"),(0,se.Y)("span",{className:"settings-item__current-value",children:l||""})]}),b&&(0,se.Y)(li.A,{icon:"lock",narrow:!0,onClick:()=>R({screen:r?o.VS.PasscodeEnabled:o.VS.PasscodeDisabled}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("Passcode")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:O(r?"SettingsItemPrivacyOn":"SettingsItemPrivacyOff")})]})}),(0,se.Y)(li.A,{icon:"admin",narrow:!0,onClick:()=>R({screen:i?o.VS.TwoFaEnabled:o.VS.TwoFaDisabled}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("TwoStepVerification")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:O(i?"SettingsItemPrivacyOn":"SettingsItemPrivacyOff")})]})}),h&&(0,se.Y)(li.A,{icon:"key",narrow:!0,onClick:H,children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:O("SettingsItemPrivacyPasskeys")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:O(void 0===d?"Loading":d>0?"SettingsItemPrivacyOn":"SettingsItemPrivacyOff")})]})}),c>0&&(0,se.FD)(li.A,{icon:"web",narrow:!0,onClick:()=>R({screen:o.VS.ActiveWebsites}),children:[U("PrivacySettings.WebSessions"),(0,se.Y)("span",{className:"settings-item__current-value",children:c})]})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:O.isRtl?"rtl":void 0,children:U("PrivacyTitle")}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyPhoneNumber}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("PrivacyPhoneTitle")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.phoneNumber)})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyLastSeen}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("LastSeenTitle")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.lastSeen)})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyProfilePhoto}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("PrivacyProfilePhotoTitle")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.profilePhoto)})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyBio}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("PrivacyBio")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.bio)})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyBirthday}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("PrivacyBirthday")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.birthday)})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyGifts}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:O("PrivacyGifts")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.gifts)})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyForwarding}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("PrivacyForwardsTitle")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.forwards)})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyPhoneCall}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("WhoCanCallMe")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.phoneCall)})]})}),(0,se.Y)(li.A,{narrow:!0,allowDisabledClick:!0,rightElement:t&&(0,se.Y)(Zd.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyVoiceMessages}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("PrivacyVoiceMessagesTitle")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.voiceMessages)})]})}),(0,se.Y)(li.A,{narrow:!0,rightElement:t&&(0,se.Y)(Zd.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyMessages}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("PrivacyMessagesTitle")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:A?O("PrivacyPaidMessagesValue"):U(g?"PrivacyMessagesContactsAndPremium":"P2PEverybody")})]})}),(0,se.Y)(li.A,{narrow:!0,className:"no-icon",onClick:()=>R({screen:o.VS.PrivacyGroupChats}),children:(0,se.FD)("div",{className:"multiline-item",children:[(0,se.Y)("span",{className:"title",children:U("WhoCanAddMe")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:q(y.chatInvite)})]})})]}),u&&(0,se.FD)("div",{className:"settings-item fluid-container",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:O.isRtl?"rtl":void 0,children:U("lng_settings_sensitive_title")}),(0,se.Y)(Hs.A,{label:U("lng_settings_sensitive_disable_filtering"),subLabel:U("lng_settings_sensitive_about"),checked:Boolean(m),disabled:!u||!m&&C,onCheck:G}),!m&&C&&(0,se.Y)(X.A,{color:"primary",fluid:!0,noForcedUpperCase:!0,className:"settings-unlock-button",onClick:j,children:(0,se.Y)("span",{className:"settings-unlock-button-title",children:O("ButtonAgeVerification")})})]}),p&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:O.isRtl?"rtl":void 0,children:U("NewChatsFromNonContacts")}),(0,se.Y)(Hs.A,{label:U("ArchiveAndMute"),subLabel:U("ArchiveAndMuteInfo"),checked:Boolean(v),onCheck:K})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:O.isRtl?"rtl":void 0,children:U("lng_settings_window_system")}),(0,se.Y)(Hs.A,{label:U("lng_settings_title_chat_name"),checked:Boolean(f),onCheck:J})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:O.isRtl?"rtl":void 0,children:O("DeleteMyAccount")}),(0,se.FD)(li.A,{narrow:!0,onClick:z,children:[O("DeleteAccountIfAwayFor"),(0,se.Y)("span",{className:"settings-item__current-value",children:O("Months",{count:$},{pluralValue:1})})]})]})]})})),lm=(0,s.ph)((0,n.EK)(e=>{const{users:{byId:t},blocked:{ids:i},contactList:s,currentUserId:n}=e;return{usersById:t,blockedIds:i,contactIds:s?.userIds,localContactIds:(0,c.nTw)(e).userSearch.localUserIds,currentUserId:n}})(({usersById:e,blockedIds:t,contactIds:i,localContactIds:o,currentUserId:a,isOpen:r,onClose:c})=>{const{setUserSearchQuery:d,blockUser:h}=(0,n.ko)(),m=(0,B.A)(),[u,p]=(0,s.J0)("");(0,s.vJ)(()=>{d({query:u})},[u,d]);const v=(0,s.Kr)(()=>{const s=(0,di.Am)([...i||[],...o||[]].filter(e=>e!==a&&!t.includes(e)));return(0,It.PU)({ids:s,query:u,type:"user"}).sort((t,i)=>{const s=(0,l.Yg)(e[t])||"",n=(0,l.Yg)(e[i])||"";return s.localeCompare(n)})},[t,i,a,u,o,e]),g=(0,s.hb)(e=>{h({userId:e}),c()},[c]);return(0,se.Y)(Es,{isOpen:r,chatOrUserIds:v,searchPlaceholder:m("BlockedUsers.BlockUser"),search:u,onSearchChange:p,onSelectChatOrUser:g,onClose:c})})),cm=(0,s.ph)((0,n.EK)(e=>{const{chats:{byId:t},users:{byId:i},blocked:{ids:s},countryList:{phoneCodes:n}}=e;return{chatsByIds:t,usersByIds:i,blockedIds:s,phoneCodeList:n}})(({isActive:e,onReset:t,chatsByIds:i,usersByIds:o,blockedIds:r,phoneCodeList:c})=>{const{unblockUser:d}=(0,n.ko)(),h=(0,B.A)(),[m,u,p]=(0,D.A)(),g=(0,s.hb)(e=>{d({userId:e})},[d]);(0,Ne.A)({isActive:e,onBack:t});const A=(0,s.Kr)(()=>r.reduce((e,t)=>{const i=(0,v.L8)(t)?o[t]:void 0,s=i&&!i.phoneNumber&&(0,l.Kl)(i);return s&&(e[t]=s),e},{}),[r,o]);return(0,se.FD)("div",{className:"settings-fab-wrapper",children:[(0,se.FD)("div",{className:"settings-content infinite-scroll",children:[(0,se.Y)("div",{className:"settings-item no-border",children:(0,se.Y)("p",{className:"settings-item-description-larger mt-0 mb-2",dir:h.isRtl?"rtl":void 0,children:h("BlockedUsersInfo")})}),(0,se.Y)("div",{className:"chat-list custom-scroll",children:r?.length?(0,se.Y)("div",{className:"scroll-container settings-item",children:r.map((e,t)=>function(e,t){const s=(0,v.L8)(e),n=o[e],r=i[e],l=n||r,d=(0,ge.A)("Chat chat-item-clickable blocked-list-item small-icon",s?"private":"group"),h=A[e];return(0,se.FD)(li.A,{className:d,ripple:!0,narrow:!0,contextActions:[{title:"Unblock",icon:"unlock",handler:()=>{g(e)}}],style:`top: ${(0+t)*a.yq1}px;`,children:[(0,se.Y)(Yt.A,{size:"medium",peer:l}),(0,se.FD)("div",{className:"contact-info",dir:"auto",children:[l&&(0,se.Y)(Ms.A,{peer:l}),n?.phoneNumber&&(0,se.Y)("div",{className:"contact-phone",dir:"auto",children:(0,on.Ox)(c,n.phoneNumber)}),h&&(0,se.FD)("div",{className:"contact-username",dir:"auto",children:["@",h]})]})]},`blocked_${e}`)}(e,t))}):r&&!r.length?(0,se.Y)("div",{className:"no-results",dir:"auto",children:h("NoBlocked")}):(0,se.Y)(Ds.A,{},"loading")})]}),(0,se.Y)(pi.A,{isShown:!0,className:"block-user-button",onClick:u,ariaLabel:h("BlockContact"),iconName:"add"}),(0,se.Y)(lm,{isOpen:m,onClose:p})]})}));function dm(e){switch(e){case o.VS.PrivacyPhoneNumber:case o.VS.PrivacyPhoneNumberAllowedContacts:case o.VS.PrivacyPhoneNumberDeniedContacts:return"phoneNumber";case o.VS.PrivacyLastSeen:case o.VS.PrivacyLastSeenAllowedContacts:case o.VS.PrivacyLastSeenDeniedContacts:return"lastSeen";case o.VS.PrivacyProfilePhoto:case o.VS.PrivacyProfilePhotoAllowedContacts:case o.VS.PrivacyProfilePhotoDeniedContacts:return"profilePhoto";case o.VS.PrivacyBio:case o.VS.PrivacyBioAllowedContacts:case o.VS.PrivacyBioDeniedContacts:return"bio";case o.VS.PrivacyBirthday:case o.VS.PrivacyBirthdayAllowedContacts:case o.VS.PrivacyBirthdayDeniedContacts:return"birthday";case o.VS.PrivacyGifts:case o.VS.PrivacyGiftsAllowedContacts:case o.VS.PrivacyGiftsDeniedContacts:return"gifts";case o.VS.PrivacyForwarding:case o.VS.PrivacyForwardingAllowedContacts:case o.VS.PrivacyForwardingDeniedContacts:return"forwards";case o.VS.PrivacyVoiceMessages:case o.VS.PrivacyVoiceMessagesAllowedContacts:case o.VS.PrivacyVoiceMessagesDeniedContacts:return"voiceMessages";case o.VS.PrivacyGroupChats:case o.VS.PrivacyGroupChatsAllowedContacts:case o.VS.PrivacyGroupChatsDeniedContacts:return"chatInvite";case o.VS.PrivacyPhoneCall:case o.VS.PrivacyPhoneCallAllowedContacts:case o.VS.PrivacyPhoneCallDeniedContacts:return"phoneCall";case o.VS.PrivacyPhoneP2P:case o.VS.PrivacyPhoneP2PAllowedContacts:case o.VS.PrivacyPhoneP2PDeniedContacts:return"phoneP2P";case o.VS.PrivacyAddByPhone:return"addByPhone";case o.VS.PrivacyNoPaidMessages:return"noPaidMessages"}}const hm=(0,s.ph)((0,n.EK)(e=>{const{settings:{byKey:{disallowedGifts:t}}}=e;return{disallowedGifts:t,isCurrentUserPremium:(0,c.g29)(e)}})(({disallowedGifts:e,isCurrentUserPremium:t})=>{const{showNotification:i,updateGlobalPrivacySettings:s}=(0,n.ko)(),o=(0,Fi.A)(),a=(0,T.A)(()=>{i({message:o("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})}),r=(0,T.A)(()=>{t?s({disallowedGifts:{...e,shouldDisallowLimitedStarGifts:!e?.shouldDisallowLimitedStarGifts||void 0}}):a()}),l=(0,T.A)(()=>{t?s({disallowedGifts:{...e,shouldDisallowUnlimitedStarGifts:!e?.shouldDisallowUnlimitedStarGifts||void 0}}):a()}),c=(0,T.A)(()=>{t?s({disallowedGifts:{...e,shouldDisallowUniqueStarGifts:!e?.shouldDisallowUniqueStarGifts||void 0}}):a()}),d=(0,T.A)(()=>{t?s({disallowedGifts:{...e,shouldDisallowPremiumGifts:!e?.shouldDisallowPremiumGifts||void 0}}):a()});return(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:o.isRtl?"rtl":void 0,children:o("PrivacyAcceptedGiftTitle")}),(0,se.FD)(li.A,{onClick:r,children:[(0,se.Y)("span",{children:o("PrivacyGiftLimitedEdition")}),(0,se.Y)(ci.A,{id:"limited_edition",label:o(e?.shouldDisallowLimitedStarGifts?"PrivacyDisableLimitedEditionStarGifts":"PrivacyEnableLimitedEditionStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowLimitedStarGifts})]}),(0,se.FD)(li.A,{onClick:l,children:[(0,se.Y)("span",{children:o("PrivacyGiftUnlimited")}),(0,se.Y)(ci.A,{id:"unlimited",label:o(e?.shouldDisallowUnlimitedStarGifts?"PrivacyDisableUnlimitedStarGifts":"PrivacyEnableUnlimitedStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUnlimitedStarGifts})]}),(0,se.FD)(li.A,{onClick:c,children:[(0,se.Y)("span",{children:o("PrivacyGiftUnique")}),(0,se.Y)(ci.A,{id:"unique",label:o(e?.shouldDisallowUniqueStarGifts?"PrivacyDisableUniqueStarGifts":"PrivacyEnableUniqueStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUniqueStarGifts})]}),(0,se.FD)(li.A,{onClick:d,children:[(0,se.Y)("span",{children:o("PrivacyGiftPremiumSubscription")}),(0,se.Y)(ci.A,{id:"premium_subscription",label:o(e?.shouldDisallowPremiumGifts?"PrivacyDisablePremiumGifts":"PrivacyEnablePremiumGifts"),disabled:!t,checked:!t||!e?.shouldDisallowPremiumGifts})]}),(0,se.Y)("p",{className:"settings-item-description-larger",dir:o.isRtl?"rtl":void 0,children:o("PrivacyAcceptedGiftInfo")})]})})),mm=(0,s.ph)((0,n.EK)(e=>({isCurrentUserPremium:(0,c.g29)(e),shouldHideReadMarks:Boolean((0,c.KIM)(e))}))(({isCurrentUserPremium:e,shouldHideReadMarks:t,visibility:i})=>{const{updateGlobalPrivacySettings:s,openPremiumModal:o}=(0,n.ko)(),a=(0,B.A)(),r="nobody"===i||"contacts"===i,l=(0,T.A)(e=>s({shouldHideReadMarks:e})),c=(0,T.A)(()=>{o({initialSection:"last_seen"})});return(0,se.FD)(se.FK,{children:[r&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(Hs.A,{label:a("HideReadTime"),checked:t,onCheck:l}),(0,se.Y)("p",{className:"settings-item-description-larger",dir:a.isRtl?"rtl":void 0,children:(0,Pt.A)(a("HideReadTimeInfo"),["br"])})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{leftElement:(0,se.Y)(Zd.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:c,children:a(e?"PrivacyLastSeenPremiumForPremium":"PrivacyLastSeenPremium")}),(0,se.Y)("p",{className:"settings-item-description-larger premium-info",dir:a.isRtl?"rtl":void 0,children:a(e?"PrivacyLastSeenPremiumInfoForPremium":"PrivacyLastSeenPremiumInfo")})]})]})}));var um=i(91356);const pm=(0,s.ph)(({currentUserId:e,hasCurrentUserFullInfo:t,currentUserFallbackPhoto:i})=>{const{loadFullUser:o,uploadProfilePhoto:a,deleteProfilePhoto:r,showNotification:l}=(0,n.ko)(),c=(0,B.A)(),[d,h,m]=(0,D.A)(!1),u=(0,s.li)();(0,s.vJ)(()=>{t||o({userId:e})},[t,e,o]);const p=(0,s.hb)(e=>{a({file:e,isFallback:!0}),l({message:c("Privacy.ProfilePhoto.PublicPhotoSuccess")})},[c,l,a]),v=(0,s.hb)(()=>{m(),r({photo:i})},[m,r,i]),g=(0,s.hb)(()=>{u.current?.click()},[]);return(0,se.FD)("div",{className:"settings-item",children:[(0,se.FD)(li.A,{narrow:!0,icon:"camera-add",onClick:g,children:[(0,se.Y)(um.A,{onChange:p,inputRef:u}),c(i?"Privacy.ProfilePhoto.UpdatePublicPhoto":"Privacy.ProfilePhoto.SetPublicPhoto")]}),i&&(0,se.FD)(li.A,{narrow:!0,leftElement:(0,se.Y)(Yt.A,{photo:i,size:"mini",className:"Qvhl9Jjv"}),onClick:h,destructive:!0,children:[c(i.isVideo?"Privacy.ProfilePhoto.RemovePublicVideo":"Privacy.ProfilePhoto.RemovePublicPhoto"),(0,se.Y)(oi.A,{isOpen:d,onClose:m,text:c("Privacy.ResetPhoto.Confirm"),confirmLabel:c("Delete"),confirmHandler:v,confirmIsDestructive:!0})]}),(0,se.Y)("p",{className:"settings-item-description-larger",dir:c.isRtl?"rtl":void 0,children:c("Privacy.ProfilePhoto.PublicPhotoInfo")})]})});function vm({screen:e,privacy:t,isPremiumRequired:i}){const{setPrivacyVisibility:a,openSettingsScreen:r}=(0,n.ko)(),l=(0,B.A)(),c=(0,Fi.A)(),d=(0,s.Kr)(()=>{const t=e!==o.VS.PrivacyAddByPhone,s=[{value:"everybody",label:l("P2PEverybody")},{value:"contacts",label:i?(0,se.Y)(eh,{label:l("P2PContacts")}):l("P2PContacts"),hidden:i}];return t&&s.push({value:"nobody",label:i?(0,se.Y)(eh,{label:l("P2PNobody")}):l("P2PNobody"),hidden:i}),s},[l,e,i]),h=(0,s.Kr)(()=>e===o.VS.PrivacyAddByPhone?{shouldShowDenied:!1,shouldShowAllowed:!1}:{shouldShowDenied:"nobody"!==t?.visibility,shouldShowAllowed:"everybody"!==t?.visibility},[t,e]),m=dm(e),u=(0,s.Kr)(()=>{switch(e){case o.VS.PrivacyGifts:return c("PrivacyGiftsInfo");case o.VS.PrivacyLastSeen:return l("CustomHelp");case o.VS.PrivacyAddByPhone:return l("everybody"===t?.visibility?"PrivacyPhoneInfo":"PrivacyPhoneInfo3");case o.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesInfo");default:return}},[l,c,e,t]),p=(0,s.Kr)(()=>{switch(e){case o.VS.PrivacyPhoneNumber:return l("PrivacyPhoneTitle");case o.VS.PrivacyAddByPhone:return l("PrivacyPhoneTitle2");case o.VS.PrivacyLastSeen:return l("LastSeenTitle");case o.VS.PrivacyProfilePhoto:return l("PrivacyProfilePhotoTitle");case o.VS.PrivacyBio:return l("PrivacyBioTitle");case o.VS.PrivacyBirthday:return l("PrivacyBirthdayTitle");case o.VS.PrivacyGifts:return c("PrivacyGiftsTitle");case o.VS.PrivacyForwarding:return l("PrivacyForwardsTitle");case o.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesTitle");case o.VS.PrivacyGroupChats:return l("WhoCanAddMe");case o.VS.PrivacyPhoneCall:return l("WhoCanCallMe");case o.VS.PrivacyPhoneP2P:return l("PrivacyP2P");default:return}},[l,c,e]),v=(0,T.A)((e,t,i,s)=>{const n=e?.length||0,o=t?.length||0,a="allow"===s;if(!n&&!o&&!a)return l(i?"PrivacyPremium":"EditAdminAddUsers");if(i)return l("ContactsAndPremium");const r=n>0?l("Users",n):void 0,d=o>0?l("Chats",o):void 0;return[a?c("PrivacyValueBots"):"",c.conjunction([r,d].filter(Boolean))].filter(Boolean).join(" ")}),g=(0,s.Kr)(()=>v(t?.allowUserIds,t?.allowChatIds,t?.shouldAllowPremium,t?.botsPrivacy),[t]),A=(0,s.Kr)(()=>v(t?.blockUserIds,t?.blockChatIds),[t]),f=(0,s.hb)(e=>{a({privacyKey:m,visibility:e})},[m]),b=(()=>{switch(e){case o.VS.PrivacyPhoneNumber:return o.VS.PrivacyPhoneNumberAllowedContacts;case o.VS.PrivacyLastSeen:return o.VS.PrivacyLastSeenAllowedContacts;case o.VS.PrivacyProfilePhoto:return o.VS.PrivacyProfilePhotoAllowedContacts;case o.VS.PrivacyBio:return o.VS.PrivacyBioAllowedContacts;case o.VS.PrivacyBirthday:return o.VS.PrivacyBirthdayAllowedContacts;case o.VS.PrivacyGifts:return o.VS.PrivacyGiftsAllowedContacts;case o.VS.PrivacyForwarding:return o.VS.PrivacyForwardingAllowedContacts;case o.VS.PrivacyPhoneCall:return o.VS.PrivacyPhoneCallAllowedContacts;case o.VS.PrivacyPhoneP2P:return o.VS.PrivacyPhoneP2PAllowedContacts;case o.VS.PrivacyVoiceMessages:return o.VS.PrivacyVoiceMessagesAllowedContacts;default:return o.VS.PrivacyGroupChatsAllowedContacts}})(),C=(()=>{switch(e){case o.VS.PrivacyPhoneNumber:return o.VS.PrivacyPhoneNumberDeniedContacts;case o.VS.PrivacyLastSeen:return o.VS.PrivacyLastSeenDeniedContacts;case o.VS.PrivacyProfilePhoto:return o.VS.PrivacyProfilePhotoDeniedContacts;case o.VS.PrivacyBio:return o.VS.PrivacyBioDeniedContacts;case o.VS.PrivacyBirthday:return o.VS.PrivacyBirthdayDeniedContacts;case o.VS.PrivacyGifts:return o.VS.PrivacyGiftsDeniedContacts;case o.VS.PrivacyForwarding:return o.VS.PrivacyForwardingDeniedContacts;case o.VS.PrivacyPhoneCall:return o.VS.PrivacyPhoneCallDeniedContacts;case o.VS.PrivacyPhoneP2P:return o.VS.PrivacyPhoneP2PDeniedContacts;case o.VS.PrivacyVoiceMessages:return o.VS.PrivacyVoiceMessagesDeniedContacts;default:return o.VS.PrivacyGroupChatsDeniedContacts}})();return(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:c.isRtl?"rtl":void 0,children:p}),(0,se.Y)(ie.A,{name:`visibility-${m}`,options:d,onChange:f,selected:t?.visibility}),u&&(0,se.Y)("p",{className:"settings-item-description-larger",dir:c.isRtl?"rtl":void 0,children:u})]}),!i&&(h.shouldShowAllowed||h.shouldShowDenied)&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:c.isRtl?"rtl":void 0,children:l("PrivacyExceptions")}),h.shouldShowAllowed&&(0,se.Y)(li.A,{narrow:!0,icon:"add-user",onClick:()=>{r({screen:b})},children:(0,se.FD)("div",{className:"multiline-item full-size",children:[(0,se.Y)("span",{className:"title",children:l("AlwaysAllow")}),(0,se.Y)("span",{className:"subtitle",children:g})]})}),h.shouldShowDenied&&(0,se.Y)(li.A,{narrow:!0,icon:"delete-user",onClick:()=>{r({screen:C})},children:(0,se.FD)("div",{className:"multiline-item full-size",children:[(0,se.Y)("span",{className:"title",children:l("NeverAllow")}),(0,se.Y)("span",{className:"subtitle",children:A})]})})]}),i&&(0,se.Y)(Xd,{})]})}const gm=(0,s.ph)((0,n.EK)((e,{screen:t})=>{let i,s;const{currentUserId:n,settings:{privacy:a,byKey:{shouldDisplayGiftsButton:r}}}=e,l=(0,c.vGo)(e,n);switch(t){case o.VS.PrivacyPhoneNumber:i=a.phoneNumber,s=a.addByPhone;break;case o.VS.PrivacyLastSeen:i=a.lastSeen;break;case o.VS.PrivacyProfilePhoto:i=a.profilePhoto;break;case o.VS.PrivacyBio:i=a.bio;break;case o.VS.PrivacyBirthday:i=a.birthday;break;case o.VS.PrivacyGifts:i=a.gifts;break;case o.VS.PrivacyPhoneP2P:case o.VS.PrivacyPhoneCall:i=a.phoneCall,s=a.phoneP2P;break;case o.VS.PrivacyForwarding:i=a.forwards;break;case o.VS.PrivacyVoiceMessages:i=a.voiceMessages;break;case o.VS.PrivacyGroupChats:i=a.chatInvite}return i?{primaryPrivacy:i,secondaryPrivacy:s,currentUserId:n,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto,isPremiumRequired:t===o.VS.PrivacyVoiceMessages&&!(0,c.g29)(e),shouldDisplayGiftsButton:r,isCurrentUserPremium:(0,c.g29)(e)}:{currentUserId:n,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto}})(({screen:e,isActive:t,primaryPrivacy:i,secondaryPrivacy:a,currentUserId:r,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c,isPremiumRequired:d,onReset:h,shouldDisplayGiftsButton:m,isCurrentUserPremium:u})=>{const{updateGlobalPrivacySettings:p,showNotification:v}=(0,n.ko)(),g=(0,Fi.A)();(0,Ne.A)({isActive:t,onBack:h});const A=(0,T.A)(()=>{u?p({shouldDisplayGiftsButton:!m}):v({message:g("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})}),f=(0,s.Kr)(()=>{switch(e){case o.VS.PrivacyPhoneCall:return o.VS.PrivacyPhoneP2P;case o.VS.PrivacyPhoneNumber:return"nobody"===i?.visibility?o.VS.PrivacyAddByPhone:void 0;default:return}},[i,e]);return(0,se.FD)("div",{className:"settings-content custom-scroll",children:[e===o.VS.PrivacyGifts&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.FD)(li.A,{onClick:A,children:[(0,se.Y)("span",{children:g("PrivacyDisplayGiftsButton")}),(0,se.Y)(ci.A,{id:"gift",disabled:!u,label:g(m?"HideGiftsButton":"DisplayGiftsButton"),checked:m})]}),(0,se.Y)("p",{className:"settings-item-description-larger",dir:g.isRtl?"rtl":void 0,children:g("PrivacyDisplayGiftIconInChats",{icon:(0,se.Y)(he.A,{name:"gift",className:"gift-icon"}),gift:g("PrivacyDisplayGift")},{withNodes:!0})})]}),(0,se.Y)(vm,{screen:e,privacy:i,isPremiumRequired:d}),e===o.VS.PrivacyProfilePhoto&&"everybody"!==i?.visibility&&(0,se.Y)(pm,{currentUserId:r,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c}),e===o.VS.PrivacyLastSeen&&(0,se.Y)(mm,{visibility:i?.visibility}),e===o.VS.PrivacyGifts&&(0,se.Y)(hm,{}),Boolean(f)&&(0,se.Y)(vm,{screen:f,privacy:a})]})})),Am=[kd.lw];function fm(e,t){const{privacy:i}=e.settings;switch(t){case o.VS.PrivacyPhoneNumberAllowedContacts:case o.VS.PrivacyPhoneNumberDeniedContacts:return i.phoneNumber;case o.VS.PrivacyLastSeenAllowedContacts:case o.VS.PrivacyLastSeenDeniedContacts:return i.lastSeen;case o.VS.PrivacyProfilePhotoAllowedContacts:case o.VS.PrivacyProfilePhotoDeniedContacts:return i.profilePhoto;case o.VS.PrivacyBioAllowedContacts:case o.VS.PrivacyBioDeniedContacts:return i.bio;case o.VS.PrivacyBirthdayAllowedContacts:case o.VS.PrivacyBirthdayDeniedContacts:return i.birthday;case o.VS.PrivacyGiftsAllowedContacts:case o.VS.PrivacyGiftsDeniedContacts:return i.gifts;case o.VS.PrivacyPhoneCallAllowedContacts:case o.VS.PrivacyPhoneCallDeniedContacts:return i.phoneCall;case o.VS.PrivacyPhoneP2PAllowedContacts:case o.VS.PrivacyPhoneP2PDeniedContacts:return i.phoneP2P;case o.VS.PrivacyForwardingAllowedContacts:case o.VS.PrivacyForwardingDeniedContacts:return i.forwards;case o.VS.PrivacyVoiceMessagesAllowedContacts:case o.VS.PrivacyVoiceMessagesDeniedContacts:return i.voiceMessages;case o.VS.PrivacyGroupChatsDeniedContacts:case o.VS.PrivacyGroupChatsAllowedContacts:return i.chatInvite;case o.VS.PrivacyNoPaidMessages:return i.noPaidMessages}}const bm=(0,s.ph)((0,n.EK)((e,{screen:t})=>({currentUserId:e.currentUserId,settings:fm(e,t)}))(({isAllowList:e,withPremiumCategory:t,withMiniAppsCategory:i,screen:o,isActive:r,currentUserId:c,settings:d,usersOnly:h=!1,onReset:m})=>{const{setPrivacySettings:u}=(0,n.ko)(),p=(0,B.A)(),v=(0,Fi.A)(),g=(0,s.Kr)(()=>({isCustomPeer:!0,type:"bots",title:v("PrivacyValueBots"),avatarIcon:"bots",isAvatarSquare:!0,peerColorId:6}),[v]),A=(0,s.Kr)(()=>[g],[g]),f=(0,s.Kr)(()=>d?e?[...d.allowUserIds,...d.allowChatIds]:[...d.blockUserIds,...d.blockChatIds]:[],[e,d]),b=(0,s.Kr)(()=>d?d.shouldAllowPremium?[kd.lw.type]:"allow"===d.botsPrivacy&&e?[g.type]:[]:[],[d,e,g]),[C,y]=(0,s.J0)(""),[S,N]=(0,s.J0)(!1),[k,w]=(0,s.J0)(f),[I,P]=(0,s.J0)(b);(0,s.vJ)(()=>{r||(w(f),P(b))},[r,b,f]);const Y=(0,ys.Rh)(a.DSF),F=(0,ys.Rh)(a._E9),D=(0,s.Kr)(()=>{const e=(0,n.mS)().chats.byId,t=(0,n.mS)().users.byId,i=(0,di.Am)([...Y||[],...F||[]]).filter(i=>{const s=e[i],n=t[i],o=n&&(0,l.PL)(n),r=s&&(0,l.WX)(s);return(!h||n)&&i!==c&&i!==a.zv8&&!r&&!o}),s=(0,It.PU)({ids:i,query:C});return C?s:(0,di.Am)([...f,...i])},[Y,F,f,C,c,h]),M=(0,s.hb)(e=>{P(e),N(!0)},[]),T=(0,s.hb)(e=>{w(e),N(!0)},[]),L=(0,s.hb)(()=>{u({privacyKey:dm(o),isAllowList:Boolean(e),updatedIds:k,isPremiumAllowed:I.includes(kd.lw.type)||void 0,botsPrivacy:i?I.includes(g.type)?"allow":"disallow":"none"}),m()},[e,i,I,k,m,o,g]);return(0,Ne.A)({isActive:r,onBack:m}),(0,se.FD)("div",{className:"NewChat-inner step-1",children:[(0,se.Y)(mi.A,{categories:t?Am:i&&e?A:void 0,itemIds:D||[],selectedIds:k,selectedCategories:I,filterValue:C,filterPlaceholder:p(e?"AlwaysAllowPlaceholder":"NeverAllowPlaceholder"),categoryPlaceholderKey:"PrivacyUserTypes",searchInputId:"new-group-picker-search",isSearchable:!0,onSelectedIdsChange:T,onSelectedCategoriesChange:M,onFilterChange:y,allowMultiple:!0,itemInputType:"checkbox",withDefaultPadding:!0,withStatus:!0}),(0,se.Y)(pi.A,{isShown:S,onClick:L,ariaLabel:p(e?"AlwaysAllow":"NeverAllow"),iconName:"check"})]})})),Cm=(0,s.ph)((0,n.EK)(e=>{const{config:t,reactions:i}=e;return{availableReactions:i.availableReactions,selectedReaction:t?.defaultReaction}})(({isActive:e,availableReactions:t,selectedReaction:i,onReset:o})=>{const{setDefaultReaction:a}=(0,n.ko)();(0,Ne.A)({isActive:e,onBack:o});const r=(0,s.Kr)(()=>(t||[]).filter(e=>!e.isInactive).map(e=>({label:(0,se.FD)(se.FK,{children:[(0,se.Y)(us.A,{reaction:e.reaction,availableReactions:t}),e.title]}),value:e.reaction.emoticon})),[t]),l=(0,s.hb)(e=>{a({reaction:{type:"emoji",emoticon:e}})},[a]);return(0,se.Y)("div",{className:"settings-content settings-item custom-scroll settings-quick-reaction",children:(0,se.Y)(ie.A,{name:"quick-reaction-settings",options:r,selected:"emoji"===i?.type?i.emoticon:void 0,onChange:l,withIcon:!0})})})),ym=1.5*g.$,Sm=(0,s.ph)((0,n.EK)(e=>({...(0,di.Up)(e.settings.byKey,["shouldSuggestStickers","shouldUpdateStickerSetOrder"]),addedSetIds:e.stickers.added.setIds,customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,defaultReaction:e.config?.defaultReaction,availableReactions:e.reactions.availableReactions,canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({isActive:e,addedSetIds:t,customEmojiSetIds:i,stickerSetsById:a,defaultReaction:r,shouldSuggestStickers:l,shouldUpdateStickerSetOrder:c,availableReactions:d,canPlayAnimatedEmojis:h,onReset:m})=>{const{setSettingOption:u,openStickerSet:p,openSettingsScreen:v}=(0,n.ko)(),g=(0,B.A)(),A=(0,s.li)(),{observe:f}=(0,Za.BL)({rootRef:A}),b=(0,s.hb)(e=>{p({stickerSetInfo:e.stickerSetInfo})},[p]),C=(0,s.hb)(e=>{u({shouldUpdateStickerSetOrder:e})},[u]),y=(0,s.hb)(e=>{u({shouldSuggestStickers:e})},[u]),S=(0,s.Kr)(()=>t&&Object.values((0,di.Up)(a,t)),[t,a]);return(0,Ne.A)({isActive:e,onBack:m}),(0,se.FD)("div",{className:"settings-content custom-scroll",children:[(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(Hs.A,{label:g("SuggestStickers"),checked:l,onCheck:y}),(0,se.FD)(li.A,{narrow:!0,onClick:()=>v({screen:o.VS.CustomEmoji}),icon:"smile",children:[g("StickersList.EmojiItem"),i&&(0,se.Y)("span",{className:"settings-item__current-value",children:i.length})]}),r&&(0,se.FD)(li.A,{className:"SettingsDefaultReaction",narrow:!0,onClick:()=>v({screen:o.VS.QuickReaction}),children:[(0,se.Y)(us.A,{reaction:r,className:"current-default-reaction",size:ym,availableReactions:d}),(0,se.Y)("div",{className:"title",children:g("DoubleTapSetting")})]})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("InstalledStickers.DynamicPackOrder")}),(0,se.Y)(Hs.A,{label:g("InstalledStickers.DynamicPackOrder"),checked:c,onCheck:C}),(0,se.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:g("InstalledStickers.DynamicPackOrderInfo")})]}),S&&(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("ChooseStickerMyStickerSets")}),(0,se.Y)("div",{ref:A,children:S.map(e=>(0,se.Y)(mh,{stickerSet:e,observeIntersection:f,onClick:b,noPlay:!h},e.id))}),(0,se.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:(0,Pt.A)(g("StickersBotInfo"),["links"])})]})]})})),Nm=(0,s.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,n.ko)(),s=(0,B.A)(),r=(0,T.A)(()=>{i({screen:o.VS.Privacy})});return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(xd.A,{size:a.r2x,tgsUrl:ur.w.Congratulations,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:s("TwoStepVerificationPasswordSetInfo")})]}),(0,se.Y)("div",{className:"settings-item settings-group",children:(0,se.Y)(X.A,{onClick:r,children:s("TwoStepVerificationPasswordReturnSettings")})})]})});var km=i(79577);const wm=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.nTw)(e).recoveryEmail;return{animatedEmoji:(0,c.oei)(e,"ðŸ’Œ"),codeLength:e.twoFaSettings.waitingEmailCodeLength,recoveryEmail:t}})(({animatedEmoji:e,codeLength:t,isLoading:i,error:n,clearError:o,onSubmit:a,isActive:r,onReset:l,recoveryEmail:c})=>{const d=(0,s.li)(),{isMobile:h}=(0,Y.Ay)(),u=h?550:400,[p,v]=(0,s.J0)("");(0,s.vJ)(()=>{m.TF||setTimeout(()=>{d.current.focus()},u)},[u]);const g=(0,B.A)();(0,Ne.A)({isActive:r,onBack:l});const A=(0,s.hb)(e=>{n&&o&&o();const i=e.target.value.slice(0,t);i.length===t&&a(i),v(i),e.target.value=i},[o,t,n,a]);return(0,se.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(km.A,{sticker:e,size:160,className:"settings-content-icon"}),c&&(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:g("TwoStepAuth.ConfirmEmailDescription",c)})]}),(0,se.FD)("div",{className:"settings-item settings-group",children:[(0,se.Y)(ee.A,{value:p,ref:d,inputMode:"decimal",label:g("YourEmailCode"),error:n,onChange:A}),i&&(0,se.Y)(Ds.A,{})]})]})})),Im=(0,s.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,n.ko)(),s=(0,B.A)();return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Lock,previewUrl:Jd,size:160,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:(0,Pt.A)(s("EnabledPasswordText"),["br"])})]}),(0,se.FD)("div",{className:"settings-item",children:[(0,se.Y)(li.A,{icon:"edit",onClick:()=>i({screen:o.VS.TwoFaChangePasswordCurrent}),children:s("ChangePassword")}),(0,se.Y)(li.A,{icon:"password-off",onClick:()=>i({screen:o.VS.TwoFaTurnOff}),children:s("TurnPasswordOff")}),(0,se.Y)(li.A,{icon:"email",onClick:()=>i({screen:o.VS.TwoFaRecoveryEmailCurrentPassword}),children:s("SetRecoveryEmail")})]})]})}),Pm=(0,s.ph)((0,n.EK)((e,{icon:t})=>({animatedEmoji:(0,c.oei)(e,"email"===t?"ðŸ’Œ":"ðŸ’¡")}))(({animatedEmoji:e,type:t="text",isLoading:i,error:n,placeholder:o,shouldConfirm:a,clearError:r,onSubmit:l,isActive:c,onReset:d})=>{const h=(0,s.li)(),{isMobile:u}=(0,Y.Ay)(),p=u?550:400,[v,g]=(0,s.J0)(""),[A,f,b]=(0,D.A)(!1);(0,s.vJ)(()=>{m.TF||setTimeout(()=>{h.current.focus()},p)},[p]);const C=(0,s.hb)(e=>{n&&r&&r(),g(e.target.value)},[r,n]),y=(0,s.hb)(()=>{l()},[l]),S=(0,s.hb)(()=>{b(),l()},[l,b]),N=(0,B.A)();return(0,Ne.A)({isActive:c,onBack:d}),(0,se.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(km.A,{sticker:e,size:160,className:"settings-content-icon"}),"email"===t&&(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:N("RecoveryEmailSubtitle")})]}),(0,se.FD)("div",{className:"settings-item settings-group",children:[(0,se.FD)("form",{action:"",onSubmit:e=>{e.preventDefault(),h.current&&l(v)},children:[(0,se.Y)(ee.A,{ref:h,value:v,inputMode:t,label:o,error:n,onChange:C}),v?(0,se.Y)(X.A,{type:"submit",isLoading:i,ripple:!0,children:N("Continue")}):(0,se.Y)(X.A,{isText:!0,isLoading:i,ripple:!0,onClick:a?f:y,children:N("YourEmailSkip")})]}),a&&(0,se.FD)(te.A,{className:"narrow",isOpen:A,title:N("YourEmailSkipWarning"),onClose:b,children:[(0,Pt.A)(N("YourEmailSkipWarningText"),["br","simple_markdown"]),(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{color:"danger",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:S,children:N("YourEmailSkip")}),(0,se.Y)(X.A,{color:"primary",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:b,children:N("Cancel")})]})]})]})]})})),Ym=(0,s.ph)(({isActive:e,onReset:t,onStart:i})=>{const s=(0,B.A)();return(0,Ne.A)({isActive:e,onBack:t}),(0,se.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,se.FD)("div",{className:"settings-content-header no-border",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Lock,previewUrl:Jd,size:160,className:"settings-content-icon"}),(0,se.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:s("SetAdditionalPasswordInfo")})]}),(0,se.Y)("div",{className:"settings-item settings-group",children:(0,se.Y)(X.A,{onClick:i,children:s("EditAdminTransferSetPassword")})})]})}),Fm=(0,s.ph)((0,n.EK)(e=>({...e.twoFaSettings}))(({currentScreen:e,shownScreen:t,state:i,hint:a,isLoading:r,errorKey:l,waitingEmailCodeLength:c,dispatch:d,isActive:h,onReset:m})=>{const{updatePassword:u,checkPassword:p,clearTwoFaError:v,updateRecoveryEmail:g,provideTwoFaEmailCode:A,clearPassword:f,openSettingsScreen:b}=(0,n.ko)(),C=(0,Fi.A)(),y=(0,B.A)();(0,s.vJ)(()=>{c&&(e===o.VS.TwoFaNewPasswordEmail?b({screen:o.VS.TwoFaNewPasswordEmailCode}):e===o.VS.TwoFaRecoveryEmail&&b({screen:o.VS.TwoFaRecoveryEmailCode}))},[e,c,b]);const S=(0,s.hb)(()=>{d({type:"reset"}),b({screen:o.VS.TwoFaNewPassword})},[d,b]),N=(0,s.hb)(e=>{d({type:"setPassword",payload:e}),b({screen:o.VS.TwoFaNewPasswordConfirm})},[d,b]),k=(0,s.hb)(()=>{b({screen:o.VS.TwoFaNewPasswordHint})},[b]),w=(0,s.hb)(e=>{d({type:"setHint",payload:e}),b({screen:o.VS.TwoFaNewPasswordEmail})},[d,b]),I=(0,s.hb)(e=>{d({type:"setEmail",payload:e}),u({...i,email:e,onSuccess:()=>{b({screen:o.VS.TwoFaCongratulations})}})},[d,i,u,b]),P=(0,s.hb)(e=>{d({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{b({screen:o.VS.TwoFaChangePasswordNew})}})},[p,d,b]),Y=(0,s.hb)(e=>{d({type:"setPassword",payload:e}),b({screen:o.VS.TwoFaChangePasswordConfirm})},[d,b]),F=(0,s.hb)(()=>{b({screen:o.VS.TwoFaChangePasswordHint})},[b]),D=(0,s.hb)(e=>{d({type:"setHint",payload:e}),u({...i,hint:e,onSuccess:()=>{b({screen:o.VS.TwoFaCongratulations})}})},[d,i,u,b]),M=(0,s.hb)(e=>{f({currentPassword:e,onSuccess:()=>{b({screen:o.VS.Privacy})}})},[f,b]),T=(0,s.hb)(e=>{d({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{b({screen:o.VS.TwoFaRecoveryEmail})}})},[p,d,b]),L=(0,s.hb)(e=>{d({type:"setEmail",payload:e}),g({...i,email:e,onSuccess:()=>{b({screen:o.VS.TwoFaCongratulations})}})},[d,i,g,b]),R=(0,s.hb)(e=>{A({code:e})},[A]);switch(e){case o.VS.TwoFaDisabled:return(0,se.Y)(Ym,{onStart:S,isActive:h||[o.VS.TwoFaNewPassword,o.VS.TwoFaNewPasswordConfirm,o.VS.TwoFaNewPasswordHint,o.VS.TwoFaNewPasswordEmail,o.VS.TwoFaNewPasswordEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaNewPassword:return(0,se.Y)(Od,{placeholder:y("PleaseEnterPassword"),submitLabel:y("Continue"),onSubmit:N,isActive:h||[o.VS.TwoFaNewPasswordConfirm,o.VS.TwoFaNewPasswordHint,o.VS.TwoFaNewPasswordEmail,o.VS.TwoFaNewPasswordEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaNewPasswordConfirm:return(0,se.Y)(Od,{expectedPassword:i.password,placeholder:y("PleaseReEnterPassword"),submitLabel:y("Continue"),onSubmit:k,isActive:h||[o.VS.TwoFaNewPasswordHint,o.VS.TwoFaNewPasswordEmail,o.VS.TwoFaNewPasswordEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaNewPasswordHint:return(0,se.Y)(Pm,{icon:"hint",placeholder:y("PasswordHintPlaceholder"),onSubmit:w,isActive:h||[o.VS.TwoFaNewPasswordEmail,o.VS.TwoFaNewPasswordEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaNewPasswordEmail:return(0,se.Y)(Pm,{icon:"email",type:"email",isLoading:r,error:l&&C.withRegular(l),clearError:v,placeholder:y("RecoveryEmailTitle"),shouldConfirm:!0,onSubmit:I,isActive:h||[o.VS.TwoFaNewPasswordEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaNewPasswordEmailCode:return(0,se.Y)(wm,{isLoading:r,error:l&&C.withRegular(l),clearError:v,onSubmit:R,isActive:h||t===o.VS.TwoFaCongratulations,onReset:m});case o.VS.TwoFaCongratulations:return(0,se.Y)(Nm,{isActive:h,onReset:m});case o.VS.TwoFaEnabled:return(0,se.Y)(Im,{isActive:h||[o.VS.TwoFaChangePasswordCurrent,o.VS.TwoFaChangePasswordNew,o.VS.TwoFaChangePasswordConfirm,o.VS.TwoFaChangePasswordHint,o.VS.TwoFaTurnOff,o.VS.TwoFaRecoveryEmailCurrentPassword,o.VS.TwoFaRecoveryEmail,o.VS.TwoFaRecoveryEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaChangePasswordCurrent:return(0,se.Y)(Od,{isLoading:r,error:l&&C.withRegular(l),onClearError:v,hint:a,onSubmit:P,isActive:h||[o.VS.TwoFaChangePasswordNew,o.VS.TwoFaChangePasswordConfirm,o.VS.TwoFaChangePasswordHint,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaChangePasswordNew:return(0,se.Y)(Od,{placeholder:y("PleaseEnterNewFirstPassword"),onSubmit:Y,isActive:h||[o.VS.TwoFaChangePasswordConfirm,o.VS.TwoFaChangePasswordHint,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaChangePasswordConfirm:return(0,se.Y)(Od,{expectedPassword:i.password,placeholder:y("PleaseReEnterPassword"),onSubmit:F,isActive:h||[o.VS.TwoFaChangePasswordHint,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaChangePasswordHint:return(0,se.Y)(Pm,{isLoading:r,error:l&&C.withRegular(l),clearError:v,icon:"hint",placeholder:y("PasswordHintPlaceholder"),onSubmit:D,isActive:h||t===o.VS.TwoFaCongratulations,onReset:m});case o.VS.TwoFaTurnOff:return(0,se.Y)(Od,{isLoading:r,error:l&&C.withRegular(l),onClearError:v,hint:a,onSubmit:M,isActive:h,onReset:m});case o.VS.TwoFaRecoveryEmailCurrentPassword:return(0,se.Y)(Od,{isLoading:r,error:l&&C.withRegular(l),onClearError:v,hint:a,onSubmit:T,isActive:h||[o.VS.TwoFaRecoveryEmail,o.VS.TwoFaRecoveryEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaRecoveryEmail:return(0,se.Y)(Pm,{icon:"email",type:"email",placeholder:y("RecoveryEmailTitle"),onSubmit:L,isActive:h||[o.VS.TwoFaRecoveryEmailCode,o.VS.TwoFaCongratulations].includes(t),onReset:m});case o.VS.TwoFaRecoveryEmailCode:return(0,se.Y)(wm,{isLoading:r,error:l&&C.withRegular(l),clearError:v,onSubmit:R,isActive:h||t===o.VS.TwoFaCongratulations,onReset:m});default:return}})),Dm=Object.keys(o.VS).length/2,Mm=[o.VS.TwoFaDisabled,o.VS.TwoFaNewPassword,o.VS.TwoFaNewPasswordConfirm,o.VS.TwoFaNewPasswordHint,o.VS.TwoFaNewPasswordEmail,o.VS.TwoFaNewPasswordEmailCode,o.VS.TwoFaCongratulations,o.VS.TwoFaEnabled,o.VS.TwoFaChangePasswordCurrent,o.VS.TwoFaChangePasswordNew,o.VS.TwoFaChangePasswordConfirm,o.VS.TwoFaChangePasswordHint,o.VS.TwoFaTurnOff,o.VS.TwoFaRecoveryEmailCurrentPassword,o.VS.TwoFaRecoveryEmail,o.VS.TwoFaRecoveryEmailCode],Tm=[o.VS.PasscodeDisabled,o.VS.PasscodeEnabled],Bm=[o.VS.Folders,o.VS.FoldersCreateFolder,o.VS.FoldersEditFolder,o.VS.FoldersEditFolderFromChatList,o.VS.FoldersEditFolderInvites,o.VS.FoldersIncludedChats,o.VS.FoldersIncludedChatsFromChatList,o.VS.FoldersExcludedChats,o.VS.FoldersExcludedChatsFromChatList,o.VS.FoldersShare],Lm=[o.VS.PrivacyBlockedUsers,o.VS.ActiveWebsites,o.VS.Passkeys],Rm=[o.VS.PrivacyPhoneNumberAllowedContacts,o.VS.PrivacyPhoneNumberDeniedContacts],xm=[o.VS.PrivacyLastSeenAllowedContacts,o.VS.PrivacyLastSeenDeniedContacts],Em=[o.VS.PrivacyProfilePhotoAllowedContacts,o.VS.PrivacyProfilePhotoDeniedContacts],Vm=[o.VS.PrivacyBioAllowedContacts,o.VS.PrivacyBioDeniedContacts],_m=[o.VS.PrivacyBirthdayAllowedContacts,o.VS.PrivacyBirthdayDeniedContacts],Um=[o.VS.PrivacyGiftsAllowedContacts,o.VS.PrivacyGiftsDeniedContacts],Om=[o.VS.PrivacyPhoneCallAllowedContacts,o.VS.PrivacyPhoneCallDeniedContacts],Km=[o.VS.PrivacyPhoneP2PAllowedContacts,o.VS.PrivacyPhoneP2PDeniedContacts],Jm=[o.VS.PrivacyForwardingAllowedContacts,o.VS.PrivacyForwardingDeniedContacts],Gm=[o.VS.PrivacyVoiceMessagesAllowedContacts,o.VS.PrivacyVoiceMessagesDeniedContacts],jm=[o.VS.PrivacyGroupChatsAllowedContacts,o.VS.PrivacyGroupChatsDeniedContacts],zm=[o.VS.PrivacyNoPaidMessages],Hm=(0,s.ph)(({isActive:e,currentScreen:t,foldersState:i,foldersDispatch:a,onReset:r,animationLevel:l,shouldSkipTransition:d})=>{const{closeShareChatFolderModal:h,openSettingsScreen:m}=(0,n.ko)(),u=(0,s.li)(),[p,v]=(0,Cd.A)(Sd,yd),[g,A]=(0,s.J0)("");(0,hc.A)({containerRef:u,selector:".settings-content"},[t]);const f=(0,T.A)(e=>{const s=(0,c.nTw)((0,n.mS)()).shareFolderScreen?.isFromSettings;t===o.VS.FoldersShare&&h(),!0===e||void 0!==s&&!s?r(!0):(t!==o.VS.FoldersCreateFolder&&t!==o.VS.FoldersEditFolder&&t!==o.VS.FoldersEditFolderFromChatList&&t!==o.VS.FoldersEditFolderInvites||setTimeout(()=>{a({type:"reset"})},200),t!==o.VS.FoldersIncludedChats&&t!==o.VS.FoldersExcludedChats?r():"create"===i.mode?m({screen:o.VS.FoldersCreateFolder}):m({screen:o.VS.FoldersEditFolder}))});function b(s,n){const r={[o.VS.PrivacyPhoneNumber]:Rm.includes(n),[o.VS.PrivacyLastSeen]:xm.includes(n),[o.VS.PrivacyProfilePhoto]:Em.includes(n),[o.VS.PrivacyBio]:Vm.includes(n),[o.VS.PrivacyBirthday]:_m.includes(n),[o.VS.PrivacyGifts]:Um.includes(n),[o.VS.PrivacyPhoneCall]:Om.includes(n),[o.VS.PrivacyPhoneP2P]:Km.includes(n),[o.VS.PrivacyForwarding]:Jm.includes(n),[o.VS.PrivacyVoiceMessages]:Gm.includes(n),[o.VS.PrivacyGroupChats]:jm.includes(n),[o.VS.PrivacyMessages]:zm.includes(n)},l=Mm.includes(n),c=Tm.includes(n),d=Bm.includes(n),h=Lm.includes(n)||l||c||Object.keys(r).map(Number).includes(n)||Object.values(r).includes(!0);switch(t){case o.VS.Main:return(0,se.Y)(qh,{isActive:e,onReset:f});case o.VS.EditProfile:return(0,se.Y)(Ih,{isActive:e&&s,onReset:f});case o.VS.General:return(0,se.Y)(Lh,{isActive:s||n===o.VS.GeneralChatBackgroundColor||n===o.VS.GeneralChatBackground||n===o.VS.QuickReaction||n===o.VS.CustomEmoji||h||d,onReset:f});case o.VS.QuickReaction:return(0,se.Y)(Cm,{isActive:s,onReset:f});case o.VS.CustomEmoji:return(0,se.Y)(uh,{isActive:s,onReset:f});case o.VS.Notifications:return(0,se.Y)(Zh,{isActive:s,onReset:f});case o.VS.DataStorage:return(0,se.Y)(vh,{isActive:s,onReset:f});case o.VS.Privacy:return(0,se.Y)(rm,{isActive:s||h,onReset:f});case o.VS.Language:return(0,se.Y)(jh,{isActive:s||n===o.VS.DoNotTranslate,onReset:f});case o.VS.DoNotTranslate:return(0,se.Y)(Ah,{isActive:s,onReset:f});case o.VS.Stickers:return(0,se.Y)(Sm,{isActive:s,onReset:f});case o.VS.Experimental:return(0,se.Y)(Mh,{isActive:s,onReset:f});case o.VS.GeneralChatBackground:return(0,se.Y)(Vh,{isActive:s||n===o.VS.GeneralChatBackgroundColor,onReset:f});case o.VS.GeneralChatBackgroundColor:return(0,se.Y)(Jh,{isActive:s,onReset:f});case o.VS.ActiveSessions:return(0,se.Y)(rh,{isActive:s,onReset:f});case o.VS.ActiveWebsites:return(0,se.Y)(hh,{isActive:s,onReset:f});case o.VS.PrivacyBlockedUsers:return(0,se.Y)(cm,{isActive:s,onReset:f});case o.VS.PrivacyPhoneNumber:case o.VS.PrivacyLastSeen:case o.VS.PrivacyProfilePhoto:case o.VS.PrivacyBio:case o.VS.PrivacyBirthday:case o.VS.PrivacyGifts:case o.VS.PrivacyPhoneCall:case o.VS.PrivacyForwarding:case o.VS.PrivacyVoiceMessages:case o.VS.PrivacyGroupChats:return(0,se.Y)(gm,{screen:t,isActive:s||r[t],onReset:f});case o.VS.PrivacyPhoneNumberAllowedContacts:case o.VS.PrivacyLastSeenAllowedContacts:case o.VS.PrivacyProfilePhotoAllowedContacts:case o.VS.PrivacyBioAllowedContacts:case o.VS.PrivacyBirthdayAllowedContacts:case o.VS.PrivacyGiftsAllowedContacts:case o.VS.PrivacyPhoneCallAllowedContacts:case o.VS.PrivacyPhoneP2PAllowedContacts:case o.VS.PrivacyForwardingAllowedContacts:case o.VS.PrivacyVoiceMessagesAllowedContacts:case o.VS.PrivacyGroupChatsAllowedContacts:case o.VS.PrivacyNoPaidMessages:return(0,se.Y)(bm,{isAllowList:!0,usersOnly:t===o.VS.PrivacyNoPaidMessages,withPremiumCategory:t===o.VS.PrivacyGroupChatsAllowedContacts,withMiniAppsCategory:t===o.VS.PrivacyGiftsAllowedContacts,screen:t,isActive:s||r[t],onReset:f});case o.VS.PrivacyPhoneNumberDeniedContacts:case o.VS.PrivacyLastSeenDeniedContacts:case o.VS.PrivacyProfilePhotoDeniedContacts:case o.VS.PrivacyBioDeniedContacts:case o.VS.PrivacyBirthdayDeniedContacts:case o.VS.PrivacyGiftsDeniedContacts:case o.VS.PrivacyPhoneCallDeniedContacts:case o.VS.PrivacyPhoneP2PDeniedContacts:case o.VS.PrivacyForwardingDeniedContacts:case o.VS.PrivacyVoiceMessagesDeniedContacts:case o.VS.PrivacyGroupChatsDeniedContacts:return(0,se.Y)(bm,{screen:t,isActive:s,onReset:f});case o.VS.PrivacyMessages:return(0,se.Y)(th,{isActive:s,onReset:f});case o.VS.Folders:case o.VS.FoldersCreateFolder:case o.VS.FoldersEditFolder:case o.VS.FoldersEditFolderFromChatList:case o.VS.FoldersEditFolderInvites:case o.VS.FoldersIncludedChats:case o.VS.FoldersIncludedChatsFromChatList:case o.VS.FoldersExcludedChats:case o.VS.FoldersExcludedChatsFromChatList:case o.VS.FoldersShare:return(0,se.Y)(Vd,{currentScreen:t,shownScreen:n,state:i,dispatch:a,isActive:s,onReset:f});case o.VS.TwoFaDisabled:case o.VS.TwoFaNewPassword:case o.VS.TwoFaNewPasswordConfirm:case o.VS.TwoFaNewPasswordHint:case o.VS.TwoFaNewPasswordEmail:case o.VS.TwoFaNewPasswordEmailCode:case o.VS.TwoFaCongratulations:case o.VS.TwoFaEnabled:case o.VS.TwoFaChangePasswordCurrent:case o.VS.TwoFaChangePasswordNew:case o.VS.TwoFaChangePasswordConfirm:case o.VS.TwoFaChangePasswordHint:case o.VS.TwoFaTurnOff:case o.VS.TwoFaRecoveryEmailCurrentPassword:case o.VS.TwoFaRecoveryEmail:case o.VS.TwoFaRecoveryEmailCode:return(0,se.Y)(Fm,{currentScreen:t,state:p,dispatch:v,shownScreen:n,isActive:s,onReset:f});case o.VS.PasscodeDisabled:case o.VS.PasscodeNewPasscode:case o.VS.PasscodeNewPasscodeConfirm:case o.VS.PasscodeChangePasscodeCurrent:case o.VS.PasscodeChangePasscodeNew:case o.VS.PasscodeChangePasscodeConfirm:case o.VS.PasscodeCongratulations:case o.VS.PasscodeEnabled:case o.VS.PasscodeTurnOff:return(0,se.Y)(zd,{currentScreen:t,passcode:g,onSetPasscode:A,shownScreen:n,isActive:s,onReset:f});case o.VS.Performance:return(0,se.Y)(am,{isActive:s,onReset:f});case o.VS.Passkeys:return(0,se.Y)(em,{isActive:s,onReset:f});default:return}}return(0,se.Y)(ae.Ay,{ref:u,id:"Settings",name:(0,ws.P)("layers",l,d),activeKey:t,renderCount:Dm,shouldWrap:!0,withSwipeControl:!0,children:function(e,s,n,o){return(0,se.FD)(se.FK,{children:[(0,se.Y)(Gh,{currentScreen:t,onReset:f,editedFolderId:i.folderId}),b(e,o)]})}})}),$m=(0,s.ph)((0,n.EK)(e=>{const{userIds:t}=e.contactList||{},{byId:i,statusesById:s}=e.users;return{usersById:i,userStatusesById:s,contactIds:t}})(({isActive:e,filter:t,usersById:i,userStatusesById:a,contactIds:r,onReset:c})=>{const{openChat:d,openNewContactDialog:h}=(0,n.ko)(),m=(0,B.A)(),{isMobile:u}=(0,Y.Ay)();(0,Ne.A)({isActive:e,onBack:c});const p=(0,s.hb)(e=>{d({id:e,shouldReplaceHistory:!0})},[d]),v=(0,s.Kr)(()=>{if(!r)return;const e=(0,It.PU)({ids:r,query:t,type:"user"});return(0,l.UB)(e,i,a)},[r,t,i,a]),[g,A]=(0,Ps.A)(void 0,v,Boolean(t));return(0,se.FD)(ls.A,{items:g,onLoadMore:A,className:"chat-list custom-scroll",children:[g?.length?g.map(e=>(0,se.Y)(li.A,{className:"chat-item-clickable contact-list-item",onClick:()=>p(e),children:(0,se.Y)(ms.A,{userId:e,forceShowSelf:!0,avatarSize:"large",withStory:!0,storyViewerOrigin:o.G9.ChatList,ripple:!u})},e)):g&&!g.length?(0,se.Y)("p",{className:"no-results",dir:"auto",children:t.length?"No contacts matched your search.":"Contact list is empty."},"no-results"):(0,se.Y)(Ds.A,{},"loading"),(0,se.Y)(pi.A,{isShown:!0,onClick:h,ariaLabel:m("CreateNewContact"),iconName:"add-user-filled"},"create-new-contact")]})})),qm=(0,s.ph)((0,n.EK)(e=>{const{userIds:t}=e.contactList||{},{query:i,fetchingStatus:s,globalResults:n,localResults:o}=(0,c.nTw)(e).globalSearch,{peerIds:a}=n||{},{peerIds:r}=o||{};return{localContactIds:t,searchQuery:i,isSearching:s?.chats,globalPeerIds:a,localPeerIds:r}})(({isChannel:e,isActive:t,selectedMemberIds:i,localContactIds:o,searchQuery:a,isSearching:r,localPeerIds:c,globalPeerIds:d,onSelectedMemberIdsChange:h,onNextStep:m,onReset:u})=>{const{setGlobalSearchQuery:p}=(0,n.ko)(),v=(0,B.A)();(0,Ne.A)({isActive:t,onBack:u});const g=(0,s.hb)(e=>{p({query:e})},[]),A=(0,s.Kr)(()=>{const e=(0,n.mS)().users.byId,t=o?(0,It.PU)({ids:o,query:a,type:"user"}):[];return(0,Cs.A)((0,di.Am)([...t,...c||[],...d||[]]).filter(t=>{const i=e[t];return i&&!i.isSelf&&(i.canBeInvitedToGroup||!(0,l.tv)(i))}),!1,i)},[o,a,c,d,i]),f=(0,s.hb)(()=>{p({query:""}),m()},[m]);return(0,se.FD)("div",{className:"NewChat step-1",children:[(0,se.FD)("div",{className:"left-header",children:[(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:u,ariaLabel:"Return to Chat List",iconName:"arrow-left"}),(0,se.Y)("h3",{children:v("GroupAddMembers")})]}),(0,se.FD)("div",{className:"NewChat-inner step-1",children:[(0,se.Y)(mi.A,{itemIds:A,selectedIds:i,filterValue:a,filterPlaceholder:v("SendMessageTo"),searchInputId:"new-group-picker-search",isLoading:r,isSearchable:!0,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox",withDefaultPadding:!0,onSelectedIdsChange:h,onFilterChange:g}),(0,se.Y)(pi.A,{isShown:!0,onClick:f,ariaLabel:e?"Continue To Channel Info":"Continue To Group Info",iconName:"arrow-right"})]})]})})),Wm=(0,s.ph)((0,n.EK)(e=>{const{progress:t,error:i}=(0,c.nTw)(e).chatCreation||{};return{creationProgress:t,creationError:i,maxGroupSize:e.config?.maxGroupSize}})(({isChannel:e,isActive:t,memberIds:i,maxGroupSize:a,creationProgress:r,creationError:c,onReset:d})=>{const{createGroupChat:h,createChannel:m}=(0,n.ko)(),u=(0,B.A)();(0,Ne.A)({isActive:t,onBack:d});const[p,v]=(0,s.J0)(""),[g,A]=(0,s.J0)(""),[f,b]=(0,s.J0)(),[C,y]=(0,s.J0)(),S="Chat title can't be empty",N="Channel title can't be empty",k=r===o.n7.InProgress;(0,s.vJ)(()=>{if(e)return;if(!i.length||i.length>4)return void v("");const t=(0,n.mS)(),s=t.users.byId,o=[t.currentUserId,...i].map(e=>(0,l.u0)(s[e])).filter(Boolean),a=o.slice(0,-1).join(", ")+u("CreateGroup.PeersTitleLastDelimeter")+o[o.length-1];v(a)},[e,i,u]);const w=(0,s.hb)(e=>{const{value:t}=e.currentTarget,i=t.replace(/^\s+/,"");v(i),i!==t&&(e.currentTarget.value=i)},[]),I=(0,s.hb)(e=>{A(e.currentTarget.value)},[]),P=(0,s.hb)(()=>{p.length?a&&i.length>=a?y("Sorry, creating supergroups is not yet supported"):h({title:p,photo:f,memberIds:i}):y(S)},[p,i,a,h,f]),Y=(0,s.hb)(()=>{p.length?m({title:p,about:g,photo:f,memberIds:i,isChannel:!0}):y(N)},[p,m,g,f,i,N]);(0,s.vJ)(()=>{r===o.n7.Complete&&d(!0)},[r,d]);const F=c&&u(c)||(C!==S&&C!==N?C:void 0);return(0,se.FD)("div",{className:"NewChat",children:[(0,se.FD)("div",{className:"left-header",children:[(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>d(),ariaLabel:"Return to member selection",iconName:"arrow-left"}),(0,se.Y)("h3",{children:u(e?"NewChannel":"NewGroup")})]}),(0,se.FD)("div",{className:"NewChat-inner step-2",children:[(0,se.Y)(Nh.A,{onChange:b,title:u("AddPhoto")}),(0,se.Y)(ee.A,{value:p,onChange:w,label:u(e?"EnterChannelName":"GroupName"),error:C===S||C===N?C:void 0}),e&&(0,se.FD)(se.FK,{children:[(0,se.Y)(ee.A,{value:g,onChange:I,label:u("DescriptionOptionalPlaceholder")}),(0,se.Y)("p",{className:"note",children:u("DescriptionInfo")})]}),F&&(0,se.Y)("p",{className:"error",children:F}),i.length>0&&(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{className:"chat-members-heading",children:u("GroupInfo.ParticipantCount",i.length,"i")}),(0,se.Y)("div",{className:"chat-members-list custom-scroll",children:i.map(e=>(0,se.Y)(li.A,{inactive:!0,className:"chat-item-clickable",children:(0,se.Y)(ms.A,{userId:e})}))})]})]}),(0,se.Y)(pi.A,{isShown:0!==p.length,onClick:e?Y:P,disabled:k,ariaLabel:e?u("ChannelIntro.CreateChannel"):"Create Group",iconName:"arrow-right",isLoading:k})]})})),Qm=Object.keys(o.Bn).length/2,Zm=(0,s.ph)(({isActive:e,isChannel:t=!1,content:i,animationLevel:a,onReset:r})=>{const{openLeftColumnContent:l,setGlobalSearchQuery:c}=(0,n.ko)(),[d,h]=(0,s.J0)([]),m=(0,s.hb)(()=>{l({contentKey:t?o.Bn.NewChannelStep2:o.Bn.NewGroupStep2})},[t]),u=(0,T.A)(e=>{const t=e.length>d.length;h(e),t&&c({query:""})});return(0,se.Y)(ae.Ay,{id:"NewChat",name:(0,ws.P)("layers",a),renderCount:Qm,activeKey:i,children:s=>{switch(i){case o.Bn.NewChannelStep1:case o.Bn.NewGroupStep1:return(0,se.Y)(qm,{isChannel:t,isActive:e,selectedMemberIds:d,onSelectedMemberIdsChange:u,onNextStep:m,onReset:r});case o.Bn.NewChannelStep2:case o.Bn.NewGroupStep2:return(0,se.Y)(Wm,{isChannel:t,isActive:s&&e,memberIds:d,onReset:r});default:return}}})});var Xm=i(34458),eu=i(11462),tu=i(24920),iu=i(75343),su=i(40175),nu=i(13481),ou=i(77018);const au=(0,s.ph)(({isActive:e,isForumPanelOpen:t,archiveSettings:i,isStoryRibbonShown:s,onReset:o,onTopicSearch:r,foldersDispatch:l})=>{const{updateArchiveSettings:c}=(0,n.ko)(),d=(0,B.A)();(0,Ne.A)({isActive:e,onBack:o});const h=(0,T.A)(()=>{c({isHidden:!1})}),{shouldDisableDropdownMenuTransitionRef:m,handleDropdownMenuTransitionEnd:u}=(0,tu.A)(t),{shouldRender:p,transitionClassNames:v}=(0,je.A)(!t,void 0,void 0,!1),{shouldRenderForumPanel:g,handleForumPanelAnimationEnd:A,handleForumPanelAnimationStart:f,isAnimationStarted:b}=(0,eu.A)(t),C=t&&b,{shouldRender:y,transitionClassNames:S,isClosing:N}=(0,je.A)(s,void 0,void 0,"",!1,Xm.UG+a.xB5);return(0,se.FD)("div",{className:"ArchivedChats",children:[(0,se.FD)("div",{className:(0,ge.A)("left-header",!y&&"left-header-shadow"),children:[d.isRtl&&(0,se.Y)("div",{className:"DropdownMenuFiller"}),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:o,ariaLabel:"Return to chat list",className:(0,ge.A)(d.isRtl&&"rtl",C&&d.isRtl&&"right-aligned",m.current&&d.isRtl&&"disable-transition"),onTransitionEnd:u,iconName:"arrow-left"}),p&&(0,se.Y)("h3",{className:v,children:d("ArchivedChats")}),(0,se.Y)("div",{className:"story-toggler-wrapper",children:(0,se.Y)(su.A,{canShow:!0,isArchived:!0})}),i.isHidden&&(0,se.Y)(me.A,{className:"archived-chats-more-menu",positionX:"right",onTransitionEnd:d.isRtl?u:void 0,children:(0,se.Y)(ue.A,{icon:"archive-from-main",onClick:h,children:d("lng_context_archive_to_list")})})]}),(0,se.FD)("div",{className:(0,ge.A)("chat-list-wrapper",y&&"with-story-ribbon",S),children:[y&&(0,se.Y)(iu.A,{isArchived:!0,className:"left-header-shadow",isClosing:N}),(0,se.Y)(nu.A,{folderType:"archived",isActive:e,isForumPanelOpen:C,isMainList:!0,foldersDispatch:l,archiveSettings:i,isStoryRibbonShown:s})]}),g&&(0,se.Y)(ou.A,{isOpen:t,onTopicSearch:r,onOpenAnimationStart:f,onCloseAnimationEnd:A})]})}),ru=(0,s.ph)((0,n.EK)(e=>{const{byId:t,orderedIds:i}=e.chatFolders;return{foldersById:t,folderOrderedIds:i}})(({isOpen:e,chatId:t,foldersById:i,folderOrderedIds:o,onClose:r,onCloseAnimationEnd:l})=>{const{editChatFolders:c}=(0,n.ko)(),d=(0,B.A)(),h=(0,s.Kr)(()=>i?Object.keys(i).reduce((e,s)=>{const{includedChatIds:n,pinnedChatIds:o}=i[Number(s)];return(n.includes(t)||o?.includes(t))&&e.push(s),e},[]):[],[t,i]),[m,u]=(0,s.J0)(h),p=(0,s.Kr)(()=>o?.filter(e=>e!==a.DSF).map(e=>{const t=i?i[e]:void 0;return{label:t?(0,Oi.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}):"",value:String(e)}})||[],[o,i]),v=(0,s.hb)(()=>{const e=h.filter(e=>!m.includes(e)).map(Number),i=m.filter(e=>!h.includes(e)).map(Number);c({chatId:t,idsToRemove:e,idsToAdd:i}),r()},[t,c,h,r,m]);if(i&&o)return(0,se.FD)(te.A,{isOpen:e,onClose:r,onCloseAnimationEnd:l,onEnter:v,className:(0,ge.A)("_fJBBCCE","delete"),contentClassName:"EG5lPWY1",title:d("FilterAddTo"),children:[(0,se.Y)("div",{className:(0,ge.A)("heYMHiUt","custom-scroll"),children:(0,se.Y)(Jl.A,{options:p,selected:m,onChange:u})}),(0,se.Y)("div",{className:"_jtqAaUU",children:(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:v,children:d("FilterAddTo")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:r,children:d("Cancel")})]})})]})}));var lu=function(e){return e.OneHour="3600",e.FourHours="14400",e.EightHours="28800",e.OneDay="86400",e.ThreeDays="259200",e.Forever="-1",e}(lu||{});const cu=(0,s.ph)(({isOpen:e,chatId:t,topicId:i,onClose:o,onCloseAnimationEnd:r})=>{const[l,c]=(0,s.J0)(lu.Forever),{updateChatMutedState:d,updateTopicMutedState:h}=(0,n.ko)(),m=(0,B.A)(),u=(0,s.Kr)(()=>[{label:m("MuteFor.Hours",1),value:lu.OneHour},{label:m("MuteFor.Hours",4),value:lu.FourHours},{label:m("MuteFor.Hours",8),value:lu.EightHours},{label:m("MuteFor.Days",1),value:lu.OneDay},{label:m("MuteFor.Days",3),value:lu.ThreeDays},{label:m("MuteFor.Forever"),value:lu.Forever}],[m]),p=(0,s.hb)(()=>{let e;e=l===lu.Forever?a.xEh:Math.floor(Date.now()/1e3)+Number(l),i?h({chatId:t,topicId:i,mutedUntil:e}):d({chatId:t,mutedUntil:e}),o()},[t,l,o,i]);return(0,se.FD)(te.A,{isOpen:e,onClose:o,onCloseAnimationEnd:r,onEnter:p,className:"delete",title:m("Notifications"),children:[(0,se.Y)(ie.A,{className:"dialog-checkbox-group",name:"muteFor",options:u,selected:l,onChange:c}),(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(X.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:p,children:m("Common.Done")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:o,children:m("Cancel")})]})]})});var du=i(99515),hu=i(24531);const mu=(0,s.ph)((0,n.EK)((e,{fromSticker:t,stickerSetShortName:i})=>{const s=(0,c.Xf0)(e),{chatId:n,threadId:o}=s||{},a=n&&(0,c.hds)(e,n),r=n?(0,c.AWZ)(e,n):void 0,d=n&&(0,c.yps)(e,n),h=n?(0,c.nZ4)(e,n):void 0,m=a?(0,l.Q_)(a,r,Boolean(d),h):void 0,u=n&&o?(0,c.Vw0)(e,n,o):void 0,p=Boolean(!u?.isCommentsInfo&&u?.fromChannelId),v=n&&o?(0,c.S0q)(e,n,o):void 0,g=Boolean(a&&o&&(0,l.__)(a,v,p,r)&&m?.canSendStickers),A=t?t.stickerSetInfo:i?{shortName:i}:void 0,f=A?(0,c.ycM)(e,A):void 0,b=n?(0,c.WA9)(e,n):void 0;return{canScheduleUntilOnline:Boolean(n)&&(0,c.RBq)(e,n),canSendStickers:g,isSavedMessages:h,shouldSchedule:!b&&(0,c.PIP)(e),stickerSet:f,isCurrentUserPremium:(0,c.g29)(e),shouldUpdateStickerSetOrder:e.settings.byKey.shouldUpdateStickerSetOrder,currentMessageList:s}})(({isOpen:e,fromSticker:t,stickerSetShortName:i,stickerSet:o,canSendStickers:r,canScheduleUntilOnline:l,shouldSchedule:c,isSavedMessages:d,isCurrentUserPremium:h,shouldUpdateStickerSetOrder:m,currentMessageList:u,onClose:p})=>{const{loadStickers:v,toggleStickerSet:g,sendMessage:A,showNotification:f}=(0,n.ko)(),b=(0,s.li)(),C=(0,s.li)(),y=(0,B.A)(),{isMobile:S}=(0,Y.Ay)(),N=(0,K.A)(o),k=o||N,w=Boolean(!k?.isArchived&&k?.installedDate),I=k?.isEmoji,[P,F]=(0,hu.A)(l),{handleScroll:D,isAtBeginning:M}=(0,rs.A)(),{observe:T}=(0,Za.BL)({rootRef:b,throttleMs:200,isDisabled:!e});(0,s.vJ)(()=>{e&&!k?.stickers&&v({stickerSetInfo:t?t.stickerSetInfo:{shortName:i}})},[e,t,v,i,k]);const L=(0,s.hb)((e,t,i)=>{u&&(e={...e,isPreloadedGlobally:!0},c||i?P((i,s)=>{A({messageList:u,sticker:e,isSilent:t,scheduledAt:i,scheduleRepeatPeriod:s}),p()}):(A({messageList:u,sticker:e,isSilent:t,shouldUpdateStickerSetOrder:m&&w}),p()))},[u,c,P,p,m,w]),R=(0,s.hb)(()=>{k&&(g({stickerSetId:k.id}),p())},[p,k,g]),x=(0,s.hb)(()=>{if(!k)return;const{shortName:e}=k,t=I?"addemoji":"addstickers",i=`${a.jsp}${t}/${e}`;(0,gc.eM)(i),f({message:y("LinkCopied")})},[I,y,k,f]),E=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.Y)(X.A,{round:!0,ripple:!S,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",iconName:"more"}),[S]);return(0,se.FD)(te.A,{className:(0,ge.A)("StickerSetModal",I&&"custom-emoji"),isOpen:e,onClose:p,header:function(){const e=(0,ge.A)("modal-header",!M&&"with-top-border");return(0,se.FD)("div",{className:e,dir:y.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:y("Close"),onClick:p,iconName:"close"}),(0,se.Y)("div",{className:"modal-title",children:k?(0,Pt.A)(k.title,["emoji","links"]):y("AccDescrStickerSet")}),(0,se.Y)(me.A,{className:"stickers-more-menu with-menu-transitions",trigger:E,positionX:"right",children:(0,se.Y)(ue.A,{icon:"copy",onClick:x,children:y("StickersCopy")})})]})}(),children:[k?.stickers?(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{ref:b,className:"stickers custom-scroll",onScroll:D,children:(0,se.FD)("div",{className:"shared-canvas-container stickers-grid",children:[(0,se.Y)("canvas",{ref:C,className:"shared-canvas"}),k.stickers.map(e=>(0,se.Y)(dr,{sticker:e,size:I?a.$nk:a.GhT,observeIntersection:T,onClick:r&&!I?L:void 0,clickArg:e,isSavedMessages:d,isCurrentUserPremium:h,sharedCanvasRef:C}))]})}),(0,se.Y)("div",{className:"button-wrapper",children:(0,se.Y)(X.A,{fluid:!0,color:w?"danger":"primary",onClick:R,children:(()=>{if(!k)return y("Loading");const e=I?"Emoji":"Sticker";return y(w?`StickerPack.Remove${e}Count`:`StickerPack.Add${e}Count`,k.count,"i")})()})})]}):(0,se.Y)(Ds.A,{}),F]})})),uu={root:"nZYT4vJ3",sets:"JzkmXjFF"},pu=(0,s.ph)((0,n.EK)(e=>({canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({customEmojiSetIds:e,canPlayAnimatedEmojis:t,onClose:i})=>{const{openStickerSet:o}=(0,n.ko)(),a=(0,B.A)(),r=(0,s.Kr)(()=>e?.map(e=>(0,n.mS)().stickers.setsById[e]),[e]),l=(0,s.li)(),{observe:c}=(0,Za.BL)({rootRef:l,isDisabled:!r}),d=(0,K.A)(r),h=r||d,m=(0,T.A)(e=>{o({stickerSetInfo:e.stickerSetInfo})});return(0,se.Y)(te.A,{isOpen:Boolean(r),className:uu.root,onClose:i,hasCloseButton:!0,title:a("lng_custom_emoji_used_sets"),children:(0,se.Y)("div",{className:(0,ge.A)(uu.sets,"custom-scroll"),ref:l,teactFastList:!0,children:h?.map(e=>(0,se.Y)(mh,{className:uu.setCard,stickerSet:e,onClick:m,observeIntersection:c,noPlay:!t},e.id))})})}));var vu=i(54314),gu=i(60859);const Au={settings:{icon:"bots",label:"BotSettings"},help:{icon:"help",label:"BotHelp"}},fu=(0,s.ph)((0,n.EK)((e,{chatId:t,threadId:i})=>{const s=(0,c.hds)(e,t),n=(0,c._ls)(e,t);if(!s||n)return{};const o=(0,v.L8)(s.id),a=o?(0,c.mBe)(e,t):void 0,r=a&&(0,l.Gh)(a),d=i===G.l3,h=(0,c.nZ4)(e,t),{chatId:m,threadId:u}=(0,c.Xf0)(e)||{},p=d&&!a&&((0,l.WX)(s)||(0,l.YE)(s))&&!(0,l.SJ)(s),g=(0,l.DX)(t)?void 0:(0,c.yps)(e,t),A=o?(0,c.vGo)(e,t):void 0,f=o?void 0:(0,c.AWZ)(e,t),b=A||f,C=(0,c.X2D)(e,t),y=(0,c.S0q)(e,t,i),S=s.isForum&&!s.isBotForum&&(s.isCreator||!(0,l.Sq)(s,"manageTopics")||(0,l.ub)(s,"manageTopics")),N=y&&(0,l.l1)(s,y),k=(0,c.e5V)(e,t),w=(0,c.jGY)(e,t)&&b?.isTranslationDisabled,I=(0,l.cG)(t,i,e.currentUserId)?(0,c.hds)(e,String(i)):void 0,P=(0,c.trm)(e),Y=(0,c.nTw)(e).chatInfo;return{chat:s,isMuted:(0,Pc.If)(s,(0,c.K52)(e),(0,c.P5N)(e,s.id)),isPrivate:o,isTopic:s?.isForum&&!d,isForum:s?.isForum,isForumAsMessages:s?.isForumAsMessages,canAddContact:r,canDeleteChat:(0,l.IC)(s),canReportChat:p,canGift:C,hasLinkedChat:Boolean(f?.linkedChatId),botCommands:g?A?.botInfo?.commands:void 0,botPrivacyPolicyUrl:g?A?.botInfo?.privacyPolicyUrl:void 0,isChatInfoShown:Y.isOpen&&m===t&&u===i,canCreateTopic:S,canEditTopic:N,canManage:k,isRightColumnShown:(0,c.gjV)(e),canTranslate:w,isBlocked:A?.isBlocked,isBot:Boolean(g),isChatWithSelf:h,savedDialog:I,disallowedGifts:A?.disallowedGifts,isAccountFrozen:P}})(({chatId:e,threadId:t,isOpen:i,withExtraActions:o,anchor:r,isChannel:l,botCommands:c,botPrivacyPolicyUrl:d,withForumActions:h,isTopic:m,isForum:u,isForumAsMessages:p,isChatInfoShown:v,canStartBot:g,canSubscribe:A,canReportChat:f,canSearch:b,canCall:C,canMute:y,canViewStatistics:S,canViewMonetization:N,canViewBoosts:k,pendingJoinRequests:w,canLeave:I,canEnterVoiceChat:P,canCreateVoiceChat:F,chat:M,isPrivate:L,isMuted:R,canDeleteChat:x,canGift:E,hasLinkedChat:V,canAddContact:_,canCreateTopic:U,canEditTopic:O,canManage:K,isRightColumnShown:J,canTranslate:G,isBlocked:j,isBot:z,isChatWithSelf:H,savedDialog:$,canShowBoostModal:q,disallowedGifts:W,isAccountFrozen:Q,channelMonoforumId:Z,onJoinRequestsClick:X,onSubscribeChannel:ee,onSearchClick:te,onAsMessagesClick:ie,onClose:ne,onCloseAnimationEnd:oe})=>{const{updateChatMutedState:ae,enterMessageSelectMode:re,sendBotCommand:le,restartBot:ce,requestMasterAndJoinGroupCall:de,createGroupCall:he,openLinkedChat:me,openAddContactDialog:pe,openFrozenAccountModal:ve,requestMasterAndRequestCall:ge,toggleStatistics:Ae,openMonetizationStatistics:fe,openBoostStatistics:be,openGiftModal:Ce,openThreadWithInfo:ye,openCreateTopicPanel:Se,openEditTopicPanel:Ne,openChat:ke,openUrl:we,toggleManagement:Ie,togglePeerTranslations:Pe,blockUser:Ye,unblockUser:Fe,setViewForumAsMessages:De,openBoostModal:Me,reportMessages:Te,showNotification:Be}=(0,n.ko)(),Le=(0,B.A)(),Re=(0,Fi.A)(),{isMobile:xe}=(0,Y.Ay)(),[Ee,Ve]=(0,s.J0)(!0),[_e,Ue]=(0,s.J0)(!1),[Oe,Ke]=(0,s.J0)(!1),[Je,Ge]=(0,s.J0)(!1),[ze,He,$e]=(0,D.A)(),{x:qe,y:We}=r;(0,je.A)(i,oe,void 0,!1);const Qe=(0,Ui.A)(!(v||!u)||void 0,200),Xe=(0,s.Kr)(()=>{if(W)return Object.values(W).every(Boolean)},[W]),et=(0,T.A)(()=>{Ge(!1),ne()}),tt=(0,T.A)(()=>{Q?ve():(Ve(!1),Te({chatId:e,messageIds:[]})),ne()}),it=(0,T.A)(()=>{Q?(ve(),ne()):Ke(!0),Ve(!1)}),st=(0,T.A)(()=>{Ve(!1),ne()}),nt=(0,T.A)(()=>{ye({chatId:e,threadId:t}),Ue(!J),st()}),ot=(0,T.A)(()=>{Ke(!1),ne()}),at=(0,T.A)(()=>{Q?ve():le({command:"/start"})}),rt=(0,T.A)(()=>{Q?ve():ce({chatId:e})}),lt=(0,T.A)(()=>{Q?ve():ae({chatId:e,mutedUntil:a.Os5}),st()}),ct=(0,T.A)(()=>{Q?(ve(),st()):(He(),Ge(!0)),Ve(!1)}),dt=(0,T.A)(()=>{Q?ve():(Se({chatId:e}),Ue(!J)),st()}),ht=(0,T.A)(()=>{Q?ve():(Ie({force:!0}),Ue(!J)),st()}),mt=(0,T.A)(()=>{Q?ve():(Ne({chatId:e,topicId:Number(t)}),Ue(!J)),st()}),ut=(0,T.A)(()=>{ke({id:void 0}),De({chatId:e,isEnabled:!1}),st()}),pt=(0,T.A)(()=>{Q?ve():F?he({chatId:e}):de({chatId:e}),st()}),vt=(0,T.A)(()=>{me({id:e}),st()}),gt=(0,T.A)(()=>{Xe&&M?Be({message:Re("SendDisallowError")}):(Ce({forUserId:e}),Q?ve():Ce({forUserId:e}),st())}),At=(0,T.A)(()=>{Q?ve():pe({userId:e}),st()}),ft=(0,T.A)(()=>{Q?ve():ee(),st()}),bt=(0,T.A)(()=>{Q?ve():ge({userId:e,isVideo:!0}),st()}),Ct=(0,T.A)(()=>{Q?ve():ge({userId:e}),st()}),yt=(0,T.A)(()=>{te(),st()}),St=(0,T.A)(()=>{Ae(),Ue(!J),st()}),Nt=(0,T.A)(()=>{fe({chatId:e}),Ue(!J),st()}),kt=(0,T.A)(()=>{Q?ve():k?(be({chatId:e}),Ue(!J)):Me({chatId:e}),st()}),wt=(0,T.A)(()=>{Pe({chatId:e,isEnabled:!0}),st()}),It=(0,T.A)(()=>{Q?ve():re(),st()}),Pt=(0,T.A)(()=>{ie(),st()}),Yt=(0,T.A)(()=>{Q?ve():Ye({userId:e}),st()}),Ft=(0,T.A)(()=>{Q?ve():Fe({userId:e}),st()}),Dt=(0,T.A)(()=>{ke({id:Z}),st()});(0,s.vJ)(yi.M6,[]);const Mt=(0,s.Kr)(()=>{const e=c?.map(({command:e})=>{const t=Au[e];if(t)return(0,se.Y)(ue.A,{icon:t.icon,onClick:()=>{le({command:`/${e}`}),st()},children:Le(t.label)},e)}),t=c?.some(({command:e})=>"privacy"===e);return[...e||[],z&&(0,se.Y)(ue.A,{icon:"privacy-policy",onClick:()=>{t&&!d?le({command:"/privacy"}):we({url:d||Le("BotDefaultPrivacyPolicy")}),st()},children:Le("BotPrivacyPolicy")})].filter(Boolean)},[c,Le,d,z]),Tt=(0,s.Kr)(()=>{if(M)return Le($?"Delete":L?"DeleteChatUser":x?"GroupInfo.DeleteAndExit":l?"LeaveChannel":"Group.LeaveGroup")},[x,M,l,L,$,Le]);return(0,se.Y)(Fr.A,{children:(0,se.FD)("div",{className:"HeaderMenuContainer",children:[(0,se.FD)(Ze.A,{isOpen:Ee,positionX:"right",style:`left: ${qe}px;top: ${We}px;`,onClose:st,shouldCloseFast:_e,children:[xe&&b&&(0,se.Y)(ue.A,{icon:"search",onClick:yt,children:Le("Search")}),h&&U&&(0,se.FD)(se.FK,{children:[(0,se.Y)(ue.A,{icon:"comments",onClick:dt,children:Le("lng_forum_create_topic")}),(0,se.Y)(gu.A,{})]}),Z&&(0,se.Y)(ue.A,{icon:"message",onClick:Dt,children:Re("ChannelSendMessage")}),Qe&&(0,se.Y)(ue.A,{icon:"info",onClick:nt,children:Le(m?"lng_context_view_topic":"lng_context_view_group")}),K&&!O&&(0,se.Y)(ue.A,{icon:"edit",onClick:ht,children:Le("Edit")}),O&&(0,se.Y)(ue.A,{icon:"edit",onClick:mt,children:Le("lng_forum_topic_edit")}),xe&&!h&&u&&!m&&(0,se.Y)(ue.A,{icon:"forums",onClick:ut,children:Le("Chat.ContextViewAsTopics")}),h&&Boolean(w)&&(0,se.FD)(ue.A,{icon:"user",onClick:X,children:[Le(l?"SubscribeRequests":"MemberRequests"),(0,se.Y)("div",{className:"right-badge",children:w})]}),h&&!m&&!p&&(0,se.Y)(ue.A,{icon:"message",onClick:Pt,children:Le("lng_forum_view_as_messages")}),o&&g&&(0,se.Y)(ue.A,{icon:"bots",onClick:at,children:Le("BotStart")}),o&&A&&(0,se.Y)(ue.A,{icon:l?"channel":"group",onClick:ft,children:Le(l?"ProfileJoinChannel":"ProfileJoinGroup")}),q&&!k&&(0,se.Y)(ue.A,{icon:"boost-outline",onClick:kt,children:Le(l?"BoostingBoostChannelMenu":"BoostingBoostGroupMenu")}),_&&(0,se.Y)(ue.A,{icon:"add-user",onClick:At,children:Le("AddContact")}),xe&&C&&(0,se.Y)(ue.A,{icon:"phone",onClick:Ct,children:Le("Call")}),C&&(0,se.Y)(ue.A,{icon:"video-outlined",onClick:bt,children:Le("VideoCall")}),y&&(R?(0,se.Y)(ue.A,{icon:"unmute",onClick:lt,children:Le("ChatsUnmute")}):(0,se.FD)(ue.A,{icon:"mute",onClick:ct,children:[Le("ChatsMute"),"..."]})),(P||F)&&(0,se.Y)(ue.A,{icon:"voice-chat",onClick:pt,children:Le(F?"StartVoipChat":"VoipGroupJoinCall")}),V&&(0,se.Y)(ue.A,{icon:l?"comments":"channel",onClick:vt,children:Le(l?"ViewDiscussion":"lng_profile_view_channel")}),!h&&(0,se.Y)(ue.A,{icon:"select",onClick:It,children:Le("ReportSelectMessages")}),k&&(0,se.Y)(ue.A,{icon:"boost-outline",onClick:kt,children:Le("Boosts")}),S&&(0,se.Y)(ue.A,{icon:"stats",onClick:St,children:Le("Statistics")}),l&&N&&(0,se.Y)(ue.A,{icon:"cash-circle",onClick:Nt,children:Le("lng_channel_earn_title")}),G&&(0,se.Y)(ue.A,{icon:"language",onClick:wt,children:Le("lng_context_translate")}),f&&(0,se.Y)(ue.A,{icon:"flag",onClick:tt,children:Le("ReportPeer.Report")}),Mt,E&&(0,se.Y)(ue.A,{icon:"gift",onClick:gt,children:Le("ProfileSendAGift")}),z&&(0,se.Y)(ue.A,{icon:j?"bots":"hand-stop",onClick:j?rt:Yt,children:Le(j?"BotRestart":"Bot.Stop")}),L&&!H&&!z&&(0,se.Y)(ue.A,{icon:j?"user":"hand-stop",onClick:j?Ft:Yt,children:Le(j?"Unblock":"BlockUser")}),I&&(0,se.FD)(se.FK,{children:[(0,se.Y)(gu.A,{}),(0,se.Y)(ue.A,{destructive:!0,icon:"delete",onClick:it,children:Tt})]})]}),M&&(0,se.Y)(vu.A,{isOpen:Oe,onClose:ot,chat:$||M,isSavedDialog:Boolean($)}),y&&ze&&M?.id&&(0,se.Y)(Tc.A,{isOpen:Je,onClose:et,onCloseAnimationEnd:$e,chatId:M.id})]})})}));var bu=i(87306),Cu=i(92915),yu=i(81642),Su=i(18653);const Nu={root:"vv5ppXel",active:"FVgqrSSK",info:"DboxqiZd",topRow:"Ymu2m1PR",meta:"A2rsvUBm",subtitle:"qUzmwaIn"},ku=(0,s.ph)(({isActive:e,message:t,peer:i,messageChat:s,shouldShowChat:n,query:o,className:a,onClick:r})=>{const c=(0,Fi.A)();if(i&&!t){const t=(0,l.Kl)(i),s=()=>{r(i.id)};return(0,se.FD)("div",{role:"button",tabIndex:0,className:(0,ge.A)(Nu.root,e&&Nu.active,a),onClick:s,children:[(0,se.Y)(Yt.A,{className:Nu.avatar,peer:i,size:"medium"}),(0,se.FD)("div",{className:Nu.info,children:[(0,se.Y)("div",{className:Nu.topRow,children:(0,se.Y)(Ms.A,{peer:i,withEmojiStatus:!0})}),((0,It.vj)(i)||t)&&(0,se.Y)("div",{className:Nu.subtitle,dir:"auto",children:t?`@${t}`:(0,l.sT)(c,i)})]})]})}if(!t)return;const d=t.forwardInfo?.hiddenUserName,h=n?s:i,m=n&&i?(0,It.Q5)(c,t.chatId,i):void 0,u=(0,T.A)(()=>{r(t)});return(0,se.FD)("div",{role:"button",tabIndex:0,className:(0,ge.A)(Nu.root,e&&Nu.active,a),onClick:u,children:[(0,se.Y)(Yt.A,{className:Nu.avatar,peer:h,text:d,size:"medium"}),(0,se.FD)("div",{className:Nu.info,children:[(0,se.FD)("div",{className:Nu.topRow,children:[h&&(0,se.Y)(Ms.A,{peer:h,withEmojiStatus:!0})||d,(0,se.Y)(yu.A,{className:Nu.meta,message:t})]}),(0,se.FD)("div",{className:Nu.subtitle,dir:"auto",children:[m&&(0,se.FD)(se.FK,{children:[(0,se.Y)("span",{className:"sender-name",children:(0,Pt.A)(m)}),(0,se.Y)("span",{className:"colon",children:":"})]}),(0,se.Y)(Su.A,{message:t,highlight:o,truncateLength:200})]})]})]})}),wu={root:"FTMljUuX",header:"OvmjSMwA",active:"DEIUzXQd",avatar:"mp1PmoMq",input:"z2K8Q7ib",mobile:"u0fb78AA",focused:"dqF8dYNx",withDropdown:"AqhBggrp",adaptSearchBorders:"Q9RZQaTu",dropdown:"MFGvbICO",dropdownHidden:"Alee0CKy",results:"RtfTOE72",placeholder:"O1HoZFge",separator:"_Yy43QLl",savedTags:"BcvAfv1E",wrap:"JkESCST6",searchTags:"rO3pH3LI",savedSearchTag:"qA4gov4D",hash:"q5NOmUAM",fromTag:"xh4OgYEH",searchTypes:"rVYZG__K",searchType:"nE1Xwoo7",selectedType:"i29dP8iT",icons:"Mx8TXRsg",footer:"jyS1l9yn","keyboard-visible":"ao05jKHW",keyboardVisible:"ao05jKHW",counter:"NmmL_cO3",mobileNavigation:"dLO1hlHU",navigationButton:"Z4vLAlsu",navigationDisabled:"IqA7R2xO",memberItem:"BEPRQhWE",jumpIn:"n9kXbTu6"},Iu={isCustomPeer:!0,avatarIcon:"channel-filled",titleKey:"SearchPublicPosts"},Pu="MiddleSearchResult",Yu=(0,be.sg)(e=>e(),200,!1),Fu=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.Xf0)(e);if(!t)return{};const{chatId:i,threadId:s}=t,n=(0,c.hds)(e,i);if(!n)return{};const{requestedQuery:o,savedTag:a,results:r,fetchingQuery:d,isHashtag:h,type:m,fromPeerId:u}=(0,c.TCk)(e)||{},{totalCount:p,foundIds:v,query:g}=r||{},A=e.currentUserId,f=(0,c.nZ4)(e,i),b=(0,l.cG)(i,s,A),C=f&&!b?e.savedReactionTags?.byKey:void 0;return{chat:n,monoforumChat:(0,c.k2W)(e,i),requestedQuery:o,totalCount:p,threadId:s,foundIds:v,isHistoryCalendarOpen:Boolean((0,c.nTw)(e).historyCalendarSelectedAt),savedTags:C,savedTag:a,isCurrentUserPremium:(0,c.g29)(e),isSavedMessages:f,fetchingQuery:d,isHashtagQuery:h,currentUserId:A,searchType:m,lastSearchQuery:g,fromPeerId:u,isGroupChat:(0,l.YE)(n)}})(({isActive:e,chat:t,monoforumChat:i,threadId:o,requestedQuery:d,savedTags:h,savedTag:p,totalCount:v,lastSearchQuery:g,foundIds:A,isHistoryCalendarOpen:f,isCurrentUserPremium:b,isSavedMessages:C,fetchingQuery:y,isHashtagQuery:S,searchType:N="chat",currentUserId:k,fromPeerId:w,isGroupChat:I})=>{const{updateMiddleSearch:P,resetMiddleSearch:M,performMiddleSearch:L,focusMessage:R,closeMiddleSearch:x,openHistoryCalendar:E,openPremiumModal:V,loadSavedReactionTags:_}=(0,n.ko)(),U=(0,s.li)(),O=(0,s.li)(),K=(0,s.li)(),J=(0,s.li)(!1),{isMobile:G}=(0,Y.Ay)(),j=(0,B.A)(),z=(0,Fi.A)(),[H,$]=(0,s.J0)(d||""),[q,W]=(0,s.J0)(0),Q=A&&q>0,Z=A&&q<A.length-1,[ee,te]=(0,s.J0)(!e),ie=(0,s.li)(),ne=(0,s.li)(!0),[oe,ae,re]=(0,D.A)(),[le,ce]=(0,s.J0)(!0),[de,he]=(0,s.J0)(!1),[me,ue]=(0,s.J0)(Boolean(w)),[pe,ve]=(0,s.J0)("");(0,s.vJ)(()=>{w&&(ue(!0),De())},[w]);const Ae=(0,s.Kr)(()=>t&&I?(0,bu.qS)(t):void 0,[t,I]),fe=me&&!w,{result:Ce,isLoading:ye}=(0,bu.Ay)({query:fe?pe||" ":H,queryFn:Ae,isDisabled:!I||Boolean(w)||!me&&(!H||S)});!function(e,t){const i=(0,T.A)(i=>{e.every(e=>e.current&&!e.current.contains(i.target))&&t(i)});(0,s.vJ)(()=>(document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}),[i])}([U],(0,T.A)(e=>{ne.current||e.target.closest(".Modal")||re()}));const Se=Boolean((H||w)&&A||S),ke=S&&!H,we="myChats"===N||"channels"===N,Ie=!S&&Boolean(Ce?.length),Pe=Boolean(H&&!ke||p||w),Ye="chat"===N&&Boolean(A?.length),Fe=(0,T.A)(()=>{x()}),De=(0,T.A)(()=>{(0,r.YS)(()=>{(0,nc.A)(O.current)})}),Me=(0,T.A)(()=>{O.current?.blur()});(0,s.vJ)(()=>{const{visualViewport:e}=window;if(!e)return;const t=document.getElementById("Main"),i=()=>{const{activeElement:i}=document;if(i&&i===O.current){const{pageTop:i,height:s}=e;(0,r.RK)(()=>{t.style.transform=`translateY(${i}px)`,t.style.height=`${s}px`,document.documentElement.scrollTop=i})}else(0,r.RK)(()=>{t.style.transform="",t.style.height=""})};return e.addEventListener("resize",i),()=>{e.removeEventListener("resize",i)}},[]),(0,s.vJ)(()=>{W(-1)},[g]),(0,s.Nf)(()=>{m.pz&&Array.from(document.querySelectorAll("input")).forEach(t=>{t.disabled=Boolean(e&&t!==O.current)})},[e]),(0,s.vJ)(()=>{e?(te(!1),clearTimeout(ie.current)):(O.current.blur(),ce(!0),W(0),$(""),ue(!1),ve(""),ie.current=window.setTimeout(()=>te(!0),200))},[e]),(0,s.vJ)(()=>{d&&t?.id&&($(d),P({chatId:t.id,threadId:o,update:{requestedQuery:void 0}}),he(!0),(0,r.Uz)(()=>{const e=O.current;e&&((0,Ci.A)(e,!0,!0),ae())}))},[t?.id,d,o]),(0,F.A)(([t])=>{e!==t&&!H&&g&&$(g)},[e,g,H]),(0,F.A)(([t])=>{e&&t!==f&&(f?(Me(),re()):De())},[f,e]);const Te=(0,T.A)(()=>{H?.length||p||w||me?($(""),he(!1),ue(!1),ve(""),M(),De()):Fe()});(0,s.vJ)(()=>e?(0,u.A)(Te):void 0,[e,Fe]);const Be=(0,s.Kr)(()=>{if(h)return Object.values(h)},[h]),Le=Boolean(Be?.length),Re=Le&&!b;(0,s.vJ)(()=>{C&&e&&_()},[C,e]);const xe=(0,T.A)(()=>{const e=t?.id;e&&Yu(()=>{J.current||L({chatId:e,threadId:o,query:H})})}),Ee=(0,T.A)(e=>{if(J.current=!1,e.startsWith("#")&&!S)return P({chatId:t.id,threadId:o,update:{isHashtag:!0}}),$(e.slice(1)),void xe();if(I&&e.toLowerCase().startsWith("from:")&&!w&&!me){ue(!0);const t=e.slice(5).trim();return void ve(t)}!me||w?($(e),e||w||(he(!1),M(),J.current=!0)):ve(e)});(0,s.vJ)(()=>{e&&(H||w)&&xe()},[e,H,w]),(0,s.vJ)(()=>{he(Boolean(y))},[y]),(0,s.vJ)(()=>{A?.length&&A.length-q<5&&xe()},[q,A?.length]),(0,s.vJ)(()=>{if(e)return ne.current=!0,window.addEventListener("touchend",t),window.addEventListener("mouseup",t),window.addEventListener("touchstart",i),window.addEventListener("mousedown",i),()=>{i(),window.removeEventListener("touchstart",i),window.removeEventListener("mousedown",i)};function t(){O.current?.focus(),ae(),(0,be.IJ)(()=>{ne.current=!1})}function i(){window.removeEventListener("touchend",t),window.removeEventListener("mouseup",t),(0,be.IJ)(()=>{ne.current=!1})}},[e]),(0,Ne.A)({isActive:e,onBack:Fe});const[Ve,_e,Ue=0]=(0,Ps.A)(xe,A),[Oe,Ke]=(0,Ps.A)(void 0,fe?Ce:void 0),Je=Ie&&(fe?Oe:Ce.slice(0,5))||void 0,Ge=(0,s.Kr)(()=>{if(!H&&!p&&!w||!Ve?.length)return hi.p;const e=(0,n.mS)();return Ve.map(t=>{const[i,s]=(0,Cc.a)(t),n=(0,c.O5q)(e,i,s);if(!n)return;const o=C||(0,l.DX)(i)||i===a.Ckz?(0,c.Szq)(e,n):void 0,r=(0,c.Y7C)(e,n);return{searchResultKey:t,message:n,messageChat:(0,c.hds)(e,n.chatId),senderPeer:o||r}}).filter(Boolean)},[H,p,w,Ve,C]),je=Boolean((H||w)&&!de&&!Ge.length&&!ke&&!Ie),ze=e&&(le||!G)&&(oe||we)&&Boolean(Se||je||ke||h||Ie),He=(0,T.A)(e=>{const t=(0,Cc.D)(e),i=A?.indexOf(t)||0;W(i+Ue),"chat"===N&&ce(!1),R({chatId:e.chatId,messageId:e.id,threadId:S?void 0:o}),re()}),$e=(0,T.A)(()=>{ce(e=>!e),ae()}),qe=(0,Fs.A)(K,Se||Ie,e=>{const t=-1===e?0:e,i=Je?.length||0;if(t<i&&Je){const e=Je[t];return void(e&&st(e))}const s=t-i,n=Ge?.[s];n&&(He(n.message),W(s+Ue))},`.${Pu}`,!0),Qe=(0,T.A)(e=>{P({chatId:t.id,threadId:o,update:e}),xe()}),Ze=(0,T.A)(e=>{Re?V({initialSection:"saved_tags"}):Qe({savedTag:e})}),Xe=(0,T.A)(()=>{Qe({savedTag:void 0})}),et=(0,T.A)(()=>w?(Qe({fromPeerId:void 0}),void ve("")):me?(ue(!1),void ve("")):void(S?Qe({isHashtag:!1}):p&&Xe())),tt=(0,T.A)(e=>{Qe({type:e}),ce(!0)}),it=(0,T.A)(()=>{ue(!0),ve(""),De()}),st=(0,T.A)(e=>{P({chatId:t.id,threadId:o,update:{fromPeerId:e}}),ve(""),$(""),De()}),nt=(0,T.A)(()=>{if("chat"===N&&(re(),Me(),A)){const e=q+1,[t,i]=(0,Cc.a)(A[e]);R({chatId:t,messageId:i,threadId:o}),W(e)}}),ot=(0,T.A)(()=>{if("chat"===N&&(re(),Me(),A)){const e=q-1,[t,i]=(0,Cc.a)(A[e]);R({chatId:t,messageId:i,threadId:o}),W(e)}});function at(e,i){const s=!i&&N===e;switch(e){case"chat":return(0,se.Y)(Mr.A,{className:(0,ge.A)(wu.searchType,s&&wu.selectedType),peerId:t?.id,title:j("SearchThisChat"),clickArg:"chat",onClick:i?et:tt});case"myChats":return(0,se.Y)(Mr.A,{className:(0,ge.A)(wu.searchType,s&&wu.selectedType),peerId:k,forceShowSelf:!0,title:j("SearchMyMessages"),clickArg:"myChats",onClick:i?et:tt});case"channels":return(0,se.Y)(Mr.A,{className:(0,ge.A)(wu.searchType,s&&wu.selectedType),customPeer:Iu,title:j("SearchPublicPosts"),clickArg:"channels",onClick:i?et:tt})}}function rt(e){const t=(0,c.PVB)((0,n.mS)(),e);if(t)return(0,se.Y)(ku,{className:Pu,peer:t,onClick:st},`member-${e}`)}function lt(){return(0,se.FD)("div",{className:(0,ge.A)(wu.dropdown,!ze&&wu.dropdownHidden),children:[!G&&(0,se.Y)("div",{className:wu.separator}),Le&&!S&&!fe&&(0,se.Y)("div",{className:(0,ge.A)(wu.savedTags,!G&&wu.wrap,"no-scrollbar"),children:Be.map(e=>{const t=(0,l.a0)(e.reaction,p);return(0,se.Y)(Cu.A,{containerId:"local-search",reaction:e.reaction,tag:e,withCount:!0,isDisabled:Re,isChosen:t,onClick:t?Xe:Ze},(0,l.Jj)(e.reaction))})}),S&&!fe&&(0,se.FD)("div",{className:(0,ge.A)(wu.searchTypes,"no-scrollbar"),children:[at("chat"),at("myChats"),at("channels")]}),Boolean(Se||Ie)&&(0,se.FD)(ls.A,{ref:K,className:(0,ge.A)(wu.results,"custom-scroll"),items:fe?Je:Ge,itemSelector:`.${Pu}`,preloadBackwards:0,onLoadMore:fe?Ke:_e,onKeyDown:qe,children:[ye&&fe&&(0,se.Y)(Ds.A,{}),Je?.map(rt),fe&&!ye&&!Ce?.length&&(0,se.Y)("span",{className:wu.placeholder,children:j("NoResult")}),je&&(0,se.Y)("span",{className:wu.placeholder,children:j("NoResultFoundFor",H)},"nothing"),ke&&(0,se.Y)("span",{className:wu.placeholder,children:j("HashtagSearchPlaceholder")},"enterhash"),!fe&&Ge?.map(({message:e,senderPeer:t,messageChat:i,searchResultKey:s},n)=>(0,se.Y)(ku,{teactOrderKey:-e.date,className:Pu,query:H,message:e,peer:t,messageChat:i,shouldShowChat:S,isActive:q-Ue===n,onClick:He},s))]})]})}return(0,se.FD)("div",{id:"MiddleSearch",className:(0,ge.A)(wu.root,e&&wu.active,!e&&ee&&"visually-hidden",oe&&wu.focused,G&&wu.mobile),ref:U,children:[(0,se.FD)("div",{className:wu.header,children:[!G&&(0,se.Y)(Yt.A,{className:wu.avatar,peer:i||t,size:"medium",isSavedMessages:C}),(0,se.FD)(ds.A,{ref:O,value:me&&!w?pe:H,className:(0,ge.A)(wu.input,ze&&wu.withDropdown,ze&&!G&&wu.adaptSearchBorders),canClose:!G,isLoading:de,resultsItemSelector:`.${wu.results} .${Pu}`,hasUpButton:Ye&&!G,hasDownButton:Ye&&!G,placeholder:j(S?"SearchHashtagsHint":"Search"),teactExperimentControlled:!0,onChange:Ee,onStartBackspace:et,onReset:Te,withBackIcon:G,onFocus:ae,focused:oe,onUpClick:Z?nt:void 0,onDownClick:Q?ot:void 0,children:[(0,se.FD)("div",{className:wu.searchTags,children:[p&&(0,se.Y)(Cu.A,{containerId:"local-search-tags",className:wu.savedSearchTag,reaction:p,tag:h[(0,l.Jj)(p)],onClick:Xe}),S&&(0,se.Y)("div",{className:wu.hash,children:"#"}),(me||w)&&(0,se.FD)("div",{className:wu.fromTag,children:[z("SearchFilterFrom"),w&&(0,se.Y)(Mr.A,{peerId:w,forceShowSelf:!0,canClose:!0,onClick:et})]})]}),!G&&lt()]}),!G&&(0,se.FD)("div",{className:wu.icons,children:[I&&!me&&!w&&(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:it,ariaLabel:j("FilterByUser"),iconName:"user"}),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>E({selectedAt:(0,We.CS)(Date.now())}),ariaLabel:j("JumpToDate"),iconName:"calendar"})]})]}),G&&lt(),G&&(0,se.FD)("div",{className:wu.footer,children:[I&&!me&&!w&&(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:it,ariaLabel:j("FilterByUser"),iconName:"user"}),(0,se.Y)(X.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>E({selectedAt:(0,We.CS)(Date.now())}),ariaLabel:j("JumpToDate"),iconName:"calendar"}),(0,se.Y)("div",{className:wu.counter,children:Pe&&(A?.length?j("Of",[Math.max(q+1,1),v]):A&&!A.length&&j("NoResult"))}),"chat"===N&&Boolean(A?.length)&&(0,se.Y)(X.A,{className:wu.viewStyle,size:"smaller",isText:!0,fluid:!0,noForcedUpperCase:!0,onClick:$e,children:j(le?"SearchAsChat":"SearchAsList")}),Ye&&!ze&&(0,se.FD)("div",{className:wu.mobileNavigation,children:[(0,se.Y)(X.A,{className:(0,ge.A)(wu.navigationButton,!Z&&wu.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:nt,nonInteractive:!Z,ariaLabel:z("AriaSearchOlderResult"),iconName:"up"}),(0,se.Y)(X.A,{className:(0,ge.A)(wu.navigationButton,!Q&&wu.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:ot,nonInteractive:!Q,ariaLabel:z("AriaSearchNewerResult"),iconName:"down"})]})]})]})}));var Du=i(80539),Mu=i(58734),Tu=i(73172);const Bu=2.5*g.$,Lu=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{setsById:i,added:s,recent:n,favorite:o,effect:a}=e.stickers,r=(0,c.nZ4)(e,t),l=(0,c.hds)(e,t),d=(0,v.L8)(t)?void 0:(0,c.AWZ)(e,t)?.stickerSet?.id;return{chat:l,effectStickers:a?.stickers,effectEmojis:a?.emojis,recentStickers:n.stickers,favoriteStickers:o.stickers,stickerSetsById:i,addedSetIds:s.setIds,canAnimate:(0,c.ML4)(e),isSavedMessages:r,isCurrentUserPremium:(0,c.g29)(e),chatStickerSetId:d}})(({chat:e,threadId:t,className:i,isHidden:o,isTranslucent:r,loadAndPlay:l,canSendStickers:c,recentStickers:d,favoriteStickers:h,effectStickers:u,effectEmojis:p,addedSetIds:v,stickerSetsById:g,chatStickerSetId:A,canAnimate:f,isSavedMessages:b,isCurrentUserPremium:C,noContextMenus:y,idPrefix:S,onStickerSelect:N,isForEffects:k})=>{const{loadRecentStickers:w,addRecentSticker:I,unfaveSticker:P,faveSticker:Y,removeRecentSticker:F}=(0,n.ko)(),D=(0,s.li)(),M=(0,s.li)(),L=(0,s.li)(),{handleScroll:R,isAtBeginning:x}=(0,rs.A)(),E=(0,Tu.A)(e?.id,t),V=`${S}-sticker-set`,{activeSetIndex:_,observeIntersectionForSet:U,observeIntersectionForPlayingItems:O,observeIntersectionForShowingItems:K,observeIntersectionForCovers:J,selectStickerSet:G}=tr(D,M,V,o),j=(0,B.A)(),z=Boolean(v),H=(0,s.Kr)(()=>{if(k&&u){const e=[];return p?.length&&e.push({id:a.hfH,accessHash:"0",title:"",stickers:p,count:p.length,isEmoji:!0}),u?.length&&e.push({id:a.Kp3,accessHash:"0",title:j("StickerEffects"),stickers:u,count:u.length}),e}if(!v)return hi.p;const e=[];h.length&&e.push({id:a.tRH,accessHash:"0",title:j("FavoriteStickers"),stickers:h,count:h.length}),d.length&&e.push({id:a.sR2,accessHash:"0",title:j("RecentStickers"),stickers:d,count:d.length});const t=[...v||[]];A&&t.unshift(A);const i=Object.values((0,di._E)(g,t));return[...e,...i]},[v,g,h,d,A,j,u,k,p]),$=(0,s.Kr)(()=>z&&0===H.filter(e=>e.stickers?.length).length,[H,z]);(0,s.vJ)(()=>{l&&(w(),c&&E({type:"chooseSticker"}))},[c,l,w,E]);const q=(0,Wa.A)([],a.jhd),W=z&&q&&!$&&(c||k);(0,An.A)(M,!W||!M.current),(0,s.vJ)(()=>{if(!z)return;const e=M.current;if(!e)return;const t=_*Bu-(e.offsetWidth/2-Bu/2);(0,uo.A)(e,t)},[z,_]);const Q=(0,T.A)((e,t,i)=>{N(e,t,i,!0),I({sticker:e})}),Z=(0,T.A)(e=>{P({sticker:e})}),ee=(0,T.A)(e=>{Y({sticker:e})}),te=(0,T.A)(()=>{c&&E({type:"chooseSticker"})}),ie=(0,T.A)(e=>{F({sticker:e})});if(!e)return;const ne=(0,ge.A)("lq8BD6Hc",i),oe=(0,ge.A)(yr,"no-scrollbar",!x&&Sr),re=!W&&(c||k)&&!$;return(0,se.Y)(ae.Ay,{className:ne,activeKey:re?0:1,name:"fade",shouldCleanup:!0,children:W?(0,se.FD)(se.FK,{children:[!k&&(0,se.Y)("div",{ref:M,className:oe,children:(0,se.FD)("div",{className:"shared-canvas-container",children:[(0,se.Y)("canvas",{ref:L,className:"shared-canvas"}),H.map(function(t,i){const s=t.stickers?.[0],n=(0,ge.A)(Nr,i===_&&"y02WwQk6"),o=i<a.j41;return t.id===a.sR2||t.id===a.tRH||t.id===a.eKB||t.hasThumbnail||!s?(0,se.Y)(X.A,{className:n,ariaLabel:t.title,round:!0,faded:t.id===a.sR2||t.id===a.tRH,color:"translucent",onClick:()=>G(i),children:t.id===a.sR2?(0,se.Y)(he.A,{name:"recent"}):t.id===a.tRH?(0,se.Y)(he.A,{name:"favorite"}):t.id===a.eKB?(0,se.Y)(Yt.A,{peer:e,size:"small"}):(0,se.Y)(ar,{stickerSet:t,noPlay:!f||!l,observeIntersection:J,sharedCanvasRef:o?L:void 0,forcePlayback:!0})},t.id):(0,se.Y)(dr,{sticker:s,size:a.TBj,title:t.title,className:n,noPlay:!f||!l,observeIntersection:J,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:o?L:void 0,withTranslucentThumb:r,onClick:G,clickArg:i,forcePlayback:!0},t.id)})]})}),(0,se.Y)("div",{ref:D,onMouseMove:te,onScroll:R,className:(0,ge.A)(br,m.TF?"no-scrollbar":"custom-scroll",!k&&Cr),children:H.map((e,t)=>(0,se.Y)(Ar,{stickerSet:e,loadAndPlay:Boolean(f&&l),noContextMenus:y,index:t,idPrefix:V,observeIntersection:U,observeIntersectionForPlayingItems:O,observeIntersectionForShowingItems:K,isNearActive:_>=t-1&&_<=t+1,favoriteStickers:h,isSavedMessages:b,isCurrentUserPremium:C,isTranslucent:r,isChatStickerSet:e.id===A,onStickerSelect:Q,onStickerUnfave:Z,onStickerFave:ee,onStickerRemoveRecent:ie,forcePlayback:!0,shouldHideHeader:e.id===a.hfH},e.id))})]}):c||k?$?(0,se.Y)("div",{className:kr,children:j("NoStickers")}):(0,se.Y)(Ds.A,{}):(0,se.Y)("div",{className:kr,children:j("ErrorSendRestrictedStickersAll")})})})),Ru=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{availableReactions:i,topReactions:s}=e.reactions,{maxUniqueReactions:n}=e.appConfig,{enabledReactions:o,isPaidReactionAvailable:a}=(0,c.AWZ)(e,t)||{};return{enabledReactions:o,availableReactions:i,topReactions:s,reactionsLimit:n,isWithPaidReaction:a}})(({loadAndPlay:e,enabledReactions:t,availableReactions:i,topReactions:n,selectedReactionIds:o,isWithPaidReaction:a,message:r,reactionsLimit:c,onReactionSelect:d,onReactionContext:h})=>{const m=(0,s.li)(),u=(0,s.li)(),{width:p}=(0,Pe.A)(),{isTouchScreen:v}=(0,Y.Ay)(),A=r?.reactions?.results,f=c&&A&&A.length>=c,b=(0,s.Kr)(()=>{if(f){const e=A.map(({reaction:e})=>e);return a&&e.unshift({type:"paid"}),e}if(!t)return[];if("all"===t.type){const e=(i||[]).map(({reaction:e})=>e);return a&&e.unshift({type:"paid"}),(0,l.fu)(e,n)}const e=t.allowed.slice();return a&&e.unshift({type:"paid"}),(0,l.fu)(e,n)},[i,t,n,f,A,a]),C=(0,s.Kr)(()=>{const e=Math.min(26.25*g.$,p),t=(p>600?.625:.5)*g.$,i=e-.5*g.$,s=Math.floor((i+t)/(36+t)),n=Math.ceil(b.length/s),o=36*n+(n-1)*t+.5*g.$*2;return Math.min(18*g.$,o)},[b.length,p]);return(0,se.Y)("div",{className:"MhpiTAwi",style:`height: ${C}px`,children:(0,se.Y)("div",{className:(0,ge.A)("NIaqmosK",v?"no-scrollbar":"custom-scroll"),children:(0,se.FD)("div",{className:"symbol-set-container shared-canvas-container",children:[(0,se.Y)("canvas",{ref:m,className:"shared-canvas"}),(0,se.Y)("canvas",{ref:u,className:"shared-canvas"}),b.map(t=>{const s=(0,l.Jj)(t),n=s?o?.includes(s):void 0;return(0,se.Y)(vr,{reaction:t,isSelected:n,loadAndPlay:e,availableReactions:i,onClick:d,onContextMenu:h,sharedCanvasRef:m,sharedCanvasHqRef:u},s)})]})})})})),xu=16.375*g.$,Eu=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.nTw)(e),i=e.availableEffectById,{chatId:s,messageId:n,storyPeerId:o,storyId:a,position:r,sendAsMessage:l,isForEffects:d}=t.reactionPicker||{},h=o&&a?(0,c.Msb)(e,o,a):void 0,m=s?(0,c.hds)(e,s):void 0,u=s?(0,c.AWZ)(e,s):void 0,p=s&&n?(0,c.O5q)(e,s,n):void 0,g=(0,v.L8)(s||o||""),A="some"===u?.enabledReactions?.type,{maxUniqueReactions:f}=e.appConfig,b="all"===u?.enabledReactions?.type&&u?.enabledReactions?.areCustomAllowed,C=p?.reactions?.results,y=Boolean(f&&C&&C.length>=f);return{message:p,story:h,position:r,shouldUseFullPicker:!(m?.isForbidden||A||y)&&(b||g),isTranslucent:(0,c.cwE)(e),isCurrentUserPremium:(0,c.g29)(e),sendAsMessage:l,isForEffects:d,chatId:s,availableEffectById:i}})(({isOpen:e,message:t,story:i,position:o,isTranslucent:a,isCurrentUserPremium:r,shouldUseFullPicker:c,sendAsMessage:d,chatId:h,isForEffects:m,availableEffectById:u})=>{const{toggleReaction:p,closeReactionPicker:v,sendMessage:g,showNotification:A,sendStoryReaction:f,saveEffectInDraft:b,requestEffectInComposer:C,addLocalPaidReaction:y,openPaidReactionModal:S}=(0,n.ko)(),N=(0,B.A)(),k=(0,Si.A)(t?.id,!0),w=(0,Si.A)(t?.chatId,!0),I=(0,Si.A)(i?.peerId,!0),P=(0,Si.A)(i?.id),F=(0,Si.A)(o,!0),D=(0,s.li)(),M=(0,s.Kr)(()=>{if(F)return P?F:{x:F.x+(c?-23:-21),y:F.y+(c?-64:-10)}},[P,F,c]),L=(0,T.A)(()=>D.current),R=(0,T.A)(()=>({withPortal:!0,isDense:!I,deltaX:!(0,Y.Ny)()&&D.current?-(D.current.offsetWidth-xu)/2- -11.5:0})),x=(0,T.A)(e=>{if(!w||!k)return;const t=e.isCustomEmoji?{type:"custom",documentId:e.id}:{type:"emoji",emoticon:e.emoji};p({chatId:w,messageId:k,reaction:t,shouldAddToRecent:!0}),v()}),E=(0,T.A)(e=>{w&&k&&("paid"===e.type?y({chatId:w,messageId:k,count:1}):p({chatId:w,messageId:k,reaction:e,shouldAddToRecent:!0}),v())}),V=(0,T.A)(e=>{"paid"===e.type&&(S({chatId:w,messageId:k}),v())}),_=(0,T.A)(e=>{if("type"in e&&"paid"===e.type)return;const t="id"in e?{type:"custom",documentId:e.id}:e,i="type"in e&&"custom"===e.type?(0,n.mS)().customEmojis.byId[e.documentId]:"id"in e?e:void 0;if(i&&!i.isFree&&!r)return A({message:N("UnlockPremiumEmojiHint"),action:{action:"openPremiumModal",payload:{initialSection:"animated_emoji"}},actionText:N("PremiumMore")}),void v();if(!d)return f({peerId:I,storyId:P,containerId:(0,l.$_)(I,P),reaction:t,shouldAddToRecent:!0}),void v();let s,o;if("type"in e&&"emoji"===e.type)s=e.emoticon;else{const e=(0,Du.Ay)((0,Mu.hB)(i));s=e.text,o=e.entities}g({text:s,entities:o,isReaction:!0}),v()}),U=(0,T.A)(e=>{const t=Object.values(u),i=t.find(t=>t.effectStickerId===e.id)?.id;h&&b({chatId:h,threadId:G.l3,effectId:i}),i&&C({}),v()}),O=(0,s.Kr)(()=>(t?.reactions?.results||[]).reduce((e,{chosenOrder:t,reaction:i})=>(void 0!==t&&e.push((0,l.Jj)(i)),e),[]),[t?.reactions?.results]);return(0,se.Y)(Ze.A,{isOpen:e,ref:D,className:(0,ge.A)("gBh4WvBC","ReactionPicker"),bubbleClassName:(0,ge.A)("qSfKwMzX",!c&&!P&&"dRNSqkOC",P&&"srpBMrqr"),withPortal:!0,noCompact:!0,anchor:M,positionY:i&&"bottom",getTriggerElement:Vu,getRootElement:_u,getMenuElement:L,getLayout:R,backdropExcludedSelector:".Modal.confirm",onClose:v,children:m&&h?(0,se.Y)(Lu,{className:"",isHidden:!e,loadAndPlay:Boolean(e&&c),idPrefix:"message-effect",canSendStickers:!1,noContextMenus:!1,chatId:h,isTranslucent:a,onStickerSelect:U,isForEffects:m}):(0,se.FD)(se.FK,{children:[(0,se.Y)(Yr,{chatId:w,idPrefix:"message-emoji-set-",isHidden:!e||!(c||P),loadAndPlay:Boolean(e&&c),isReactionPicker:!0,className:c||P?void 0:"KVwgF6DG",selectedReactionIds:O,isTranslucent:a,onCustomEmojiSelect:P?_:x,onReactionSelect:P?_:E,onReactionContext:V}),!c&&Boolean(w)&&(0,se.Y)(Ru,{chatId:w,loadAndPlay:e,onReactionSelect:P?_:E,onReactionContext:V,selectedReactionIds:O,message:t})]})})}));function Vu(){return document.querySelector("body")}function _u(){return document.querySelector("body")}var Uu=i(39074),Ou=i(45761);const Ku=document.createElement("div");var Ju=i(41316),Gu=i(3225),ju=i(25498),zu=i(9442),Hu=i(91525),$u=i(52988),qu=i(27860);const Wu="SHoF85Vw",Qu="Zo7u5epf",Zu=15*g.$,Xu=(0,s.ph)(({attachment:e,className:t,isSingle:i,shouldDisplayCompressed:n,shouldDisplayGrouped:o,index:r,onDelete:l,onToggleSpoiler:c})=>{const d=function(e,t){if(t&&e.quick){if(a.gex.has(e.mimeType))return"photo";if(a.fNs.has(e.mimeType))return"video"}return"file"}(e,n),h=(0,T.A)(()=>{c?.(r)}),m=(0,s.Kr)(()=>{switch(d){case"photo":return(0,se.Y)("img",{className:Wu,src:e.blobUrl,alt:"",draggable:!1});case"video":return(0,se.FD)(se.FK,{children:[Boolean(e.quick?.duration)&&(0,se.Y)("div",{className:"nI2M1SBH",children:(0,We.QO)(e.quick.duration)}),(0,se.Y)("video",{className:Wu,src:e.blobUrl,autoPlay:!0,muted:!0,loop:!0,disablePictureInPicture:!0})]});default:return(0,se.FD)(se.FK,{children:[(0,se.Y)($u.A,{className:"B6f6GcvN",name:e.filename,extension:(0,Hu.QC)(e.filename,e.mimeType),previewData:e.previewBlobUrl,size:e.size,smaller:!0}),l&&(0,se.Y)(he.A,{name:"delete",className:(0,ge.A)(Qu,"CYJwy9T_"),onClick:()=>l(r)})]})}},[e,d,r,l]),u="file"===d||!o,p=Boolean("file"!==d&&e.shouldSendAsSpoiler),v="file"!==d,g=(0,ge.A)(t,"QucaiGVU",i&&"FjrnqGba",u&&"g0cTsM9d");return(0,se.FD)("div",{className:g,children:[m,(0,se.Y)(qu.A,{isVisible:p,thumbDataUri:e.previewBlobUrl||e.blobUrl,width:Zu,height:Zu}),v&&(0,se.FD)("div",{className:"bX7LdgxW",children:[(0,se.Y)(he.A,{name:e.shouldSendAsSpoiler?"spoiler-disable":"spoiler",className:Qu,onClick:h}),l&&(0,se.Y)(he.A,{name:"delete",className:Qu,onClick:()=>l(r)})]})]})});var ep=i(25897),tp=i(6070),ip=i(49068);function sp(e,t,i=!1){const s=e[i?"scrollLeft":"scrollTop"],n=s+e[i?"offsetWidth":"offsetHeight"],o=t[i?"offsetLeft":"offsetTop"],a=o+t[i?"offsetWidth":"offsetHeight"];return o>s&&a<n}function np(e,t,i=0,s=!1,n=!1,o=!1){const a=e[o?"scrollLeft":"scrollTop"],r=a+e[o?"offsetWidth":"offsetHeight"],l="string"==typeof t?e.querySelectorAll(t):t,{length:c}=l,d=[];let h=!1;for(let e=0;e<c;e++){const t=l[e],c=t[o?"offsetLeft":"offsetTop"],m=c+t[o?"offsetWidth":"offsetHeight"];if(n?m>=a-i&&m<=r+i:c<=r+i&&m>=a-i)d.push(e),h=!0;else if(h&&!s)break}return{allElements:l,visibleIndexes:d}}function op(e,t,i){const s=i.current;if(!s||t<0)return;const{visibleIndexes:n,allElements:o}=np(s,e,8,!0,!0);if(!o.length||!o[t])return;const a=n[0];if(!n.includes(t)||t===a&&!sp(s,o[a])){const e=t>n[n.length-1]?"start":"end";(0,Qa.Ay)({container:s,element:o[t],position:e,margin:10})}}function ap({isActive:e,isHorizontal:t,shouldSaveSelectionOnUpdateItems:i,shouldRemoveSelectionOnReset:n,noArrowNavigation:o,items:a,shouldSelectOnTab:r,onSelect:l,onClose:c}){const[d,h]=(0,s.J0)(-1),m=(0,T.A)(e=>a?(0,So.A)(a.length,e):-1),u=(0,T.A)((e,t)=>{t.preventDefault(),h(t=>m(t+e))}),p=(0,T.A)(t=>{if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return!1;if(!e)return!1;if(a&&a.length&&d>-1){const e=a[d];if(e){if(!1===l(e))return!1;t.preventDefault()}}return!0});(0,s.vJ)(()=>{e||h(n?-1:0)},[e,n]);const v=!a||d>a.length-1;return(0,s.vJ)(()=>{i&&!v||h(n?-1:0)},[v,n,i]),(0,s.vJ)(()=>e?(0,Ni.A)({onEsc:c,onUp:o||t?void 0:e=>u(-1,e),onDown:o||t?void 0:e=>u(1,e),onLeft:o||!t?void 0:e=>u(-1,e),onRight:o||!t?void 0:e=>u(1,e),onTab:r?p:void 0,onEnter:p}):void 0,[o,u,p,e,t,c,r]),d}const rp=(0,s.ph)(({isOpen:e,onClose:t,onInsertUserName:i,filteredUsers:o})=>{const a=(0,s.li)(),{shouldRender:r,transitionClassNames:l}=(0,je.A)(e,void 0,void 0,!1),c=(0,T.A)((e,t=!1)=>{const s=(0,n.mS)().users.byId[e];s&&i(s,t)}),d=(0,T.A)((e,t)=>{e.preventDefault(),c(t)}),h=(0,T.A)(e=>{c(e.id,!0)}),m=ap({isActive:e,items:o,onSelect:h,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:t});(0,s.vJ)(()=>{op(".chat-item-clickable",m,a)},[m]),(0,s.vJ)(()=>{o&&!o.length&&t()},[o,t]);const u=(0,K.A)(o?.length?o:void 0,r),p=o&&!o.length?u:o;if(!r||p&&!p.length)return;const v=(0,ge.A)("MentionTooltip composer-tooltip custom-scroll",l);return(0,se.Y)("div",{className:v,ref:a,children:p?.map(({id:e},t)=>(0,se.Y)(li.A,{className:"chat-item-clickable scroll-item smaller-icon",onClick:d,clickArg:e,focus:m===t,children:(0,se.Y)(ms.A,{userId:e,avatarSize:"small",withUsername:!0})},e))})});var lp=i(78407),cp=i(26440);const dp="AT_d9l0W",hp="AnO3BgVv",mp="caption-input-text",up=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{currentUserId:i,recentEmojis:s,customEmojis:n,attachmentSettings:o}=e,{shouldSaveAttachmentsCompression:r}=(0,c.nTw)(e),l=(0,c.AWZ)(e,t),d=(0,c.nZ4)(e,t),{shouldSuggestCustomEmoji:h}=e.settings.byKey,{language:m}=(0,ks.lS)(e),u=e.emojiKeywords[a.cUY],p=m!==a.cUY?e.emojiKeywords[m]:void 0;return{isChatWithSelf:d,currentUserId:i,groupChatMembers:l?.members,recentEmojis:s,baseEmojiKeywords:u?.keywords,emojiKeywords:p?.keywords,shouldSuggestCustomEmoji:h,customEmojiForEmoji:n.forEmoji.stickers,captionLimit:(0,bs.d)(e,"captionLength"),attachmentSettings:o,shouldSaveAttachmentsCompression:r}})(({chatId:e,threadId:t,attachments:i,getHtml:o,editingMessage:c,canShowCustomSendMenu:d,captionLimit:h,isReady:m,isChatWithSelf:p,currentUserId:v,groupChatMembers:g,recentEmojis:A,baseEmojiKeywords:f,emojiKeywords:b,isForMessage:C,shouldSchedule:y,shouldSuggestCustomEmoji:S,customEmojiForEmoji:N,attachmentSettings:k,shouldSaveAttachmentsCompression:w,shouldForceCompression:I,shouldForceAsFile:P,isForCurrentMessageList:F,forceDarkTheme:M,canScheduleUntilOnline:B,canSchedule:L,paidMessagesStars:R,onAttachmentsUpdate:x,onCaptionUpdate:E,onSend:V,onFileAppend:_,onClear:U,onSendSilent:O,onSendScheduled:J,onCustomEmojiSelect:G,onRemoveSymbol:j,onEmojiSelect:H,onSendWhenOnline:$})=>{const q=(0,s.li)(),W=(0,s.li)(),{addRecentCustomEmoji:Q,addRecentEmoji:Z,updateAttachmentSettings:ee}=(0,n.ko)(),ie=(0,Fi.A)(),ne=(0,s.li)(),oe=(0,s.li)(),ae=(0,s.li)(),re=(0,K.A)(i),le=i.length?i:re,{isMobile:ce}=(0,Y.Ay)(),de=c&&Boolean(c),he=c&&c?.groupedId,pe="file"!==(de&&i?.length&&(0,l.ES)(i[0])),[ve,Ae,fe]=(0,D.A)(),be=k.shouldCompress,Ce=Boolean((be||I||he)&&!P),[ye,Ne]=(0,s.J0)(k.shouldSendGrouped),we=k.isInvertedMedia,[Ie,Pe]=(0,s.J0)(k.shouldSendInHighQuality),[Ye,Fe]=(0,s.J0)(Ie),{handleScroll:De,isAtBeginning:Me,isAtEnd:Te}=(0,rs.A)(),{handleScroll:Be,isAtBeginning:Le}=(0,rs.A)(),Re=Boolean(i.length),xe=Boolean(le?.length),[Ee,Ve,_e]=(0,D.A)(),Ue=(0,s.li)();(0,s.vJ)(()=>{Re||(fe(),ee({isInvertedMedia:void 0}))},[fe,Re]);const[Oe,Ke]=(0,s.Kr)(()=>Boolean(le?.every(e=>e.quick||e.audio))?[!0,!0]:[Boolean(le?.some(e=>e.quick||e.audio)),!1],[le]),[Je,Ge]=(0,s.Kr)(()=>Boolean(le?.every(e=>e.shouldSendAsSpoiler))?[!0,!0]:[Boolean(le?.some(e=>e.shouldSendAsSpoiler)),!1],[le]),je=(0,Ju.A)(`#${a.e0F}`),{isEmojiTooltipOpen:ze,filteredEmojis:He,filteredCustomEmojis:$e,insertEmoji:qe,closeEmojiTooltip:We}=(0,ju.A)(Boolean(m&&(F||!C)&&xe),o,E,a.e0F,A,f,b),{isCustomEmojiTooltipOpen:Qe,insertCustomEmoji:Ze,closeCustomEmojiTooltip:Xe}=(0,Gu.A)(Boolean(m&&(F||!C)&&xe&&S),o,E,je,oe,N),{isMentionTooltipOpen:et,closeMentionTooltip:tt,insertMention:it,mentionFilteredUsers:st}=(0,zu.A)(Boolean(m&&F&&xe),o,E,je,oe,g,void 0,v);function nt(e){ee({isInvertedMedia:e})}(0,s.vJ)(()=>Re?(0,u.A)(U):void 0,[Re,U]),(0,s.vJ)(()=>{Re&&(Ne(k.shouldSendGrouped),Pe(k.shouldSendInHighQuality))},[k,Re]),(0,s.vJ)(()=>{Re||ee({isInvertedMedia:void 0})},[ee,Re]),(0,s.vJ)(()=>{Re&&ce&&(0,Uu.DY)()},[ce,Re]);const{isContextMenuOpen:ot,handleContextMenu:at,handleContextMenuClose:rt,handleContextMenuHide:lt}=(0,Ws.A)(ne,!d||!Re),ct=(0,T.A)((e,t)=>{Re&&(((y||t)&&C&&!c?J:e?O:V)(Ce,ye,we),ee({...w&&{defaultAttachmentCompression:k.shouldCompress?"compress":"original"},shouldSendGrouped:ye,isInvertedMedia:we,shouldSendInHighQuality:Ie}))}),dt=(0,T.A)(()=>{ct(!0)}),ht=(0,T.A)(()=>{ct()}),mt=(0,T.A)(()=>{ct(!1,!0)}),ut=(0,T.A)(async e=>{e.preventDefault(),_e();const{dataTransfer:t}=e,i=await(0,Ou.A)(t.items);i?.length&&_(i,Ge)}),pt=(0,T.A)(e=>{const{files:t}=e.target,i=(0,z.kc)(t);i?.length&&_(i,Ge)}),vt=(0,T.A)(()=>{(0,Rh.p)("*",e=>pt(e))}),gt=(0,T.A)(e=>{x(i.filter((t,i)=>i!==e))}),At=(0,T.A)(()=>{x(i.map(e=>({...e,shouldSendAsSpoiler:!0})))}),ft=(0,T.A)(()=>{ee({shouldCompress:!be})}),bt=(0,T.A)(()=>{const e=!Ie;Pe(e),ee({shouldSendInHighQuality:e})}),Ct=(0,T.A)(()=>{x(i.map(e=>({...e,shouldSendAsSpoiler:void 0})))}),yt=(0,T.A)(e=>{x(i.map((t,i)=>i===e?{...t,shouldSendAsSpoiler:!t.shouldSendAsSpoiler||void 0}:t))}),St=(0,T.A)(()=>{const e=W.current;if(!e)return;const{width:t,height:i}=e.getBoundingClientRect();e.viewBox.baseVal.width=t,e.viewBox.baseVal.height=i});(0,hr.A)(q,St),(0,ke.A)(St),(0,s.vJ)(()=>{const e=ne.current,t=document.getElementById(mp);if(!e||!t)return;const{width:i}=e.getBoundingClientRect();(0,r.RK)(()=>{t.style.setProperty("--margin-for-scrollbar",`${i}px`)})},[ie,Re]);const Nt=(0,s.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,se.Y)(X.A,{round:!0,ripple:!ce,size:"tiny",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",iconName:"more"}),[ce]),kt=(0,Se.A)(()=>{if(!xe)return;const e=h-(t=o(),Ku.innerHTML=t,(0,Du.g4)(Ku),Ku.querySelectorAll("br").forEach(e=>{e.replaceWith("\n")}),Ku.textContent?.trim().length||0);var t;return e<=100?e:void 0},[h,o,xe]),wt=Ce&&Ke,[It,Pt,Yt,Ft]=(0,s.Kr)(()=>wt&&le?[le.every(e=>a.gex.has(e.mimeType)),le.every(e=>a.fNs.has(e.mimeType)),le.every(e=>a.IH3.has(e.mimeType)),le.some(e=>a.gex.has(e.mimeType))]:[!1,!1,!1],[le,wt]),Dt=(0,s.Kr)(()=>!!le&&le.some(e=>!a.IH3.has(e.mimeType)),[le]);if((0,s.vJ)(()=>{if(Ie!==Ye)return Ue.current&&clearTimeout(Ue.current),Ue.current=window.setTimeout(()=>{Fe(Ie)},200),()=>{Ue.current&&(clearTimeout(Ue.current),Ue.current=void 0)}},[Ie,Ye]),!le)return;const Mt=le.length>1,Tt=!(de||!Oe||!(P||I||Ce)||Mt&&ye);let Bt="";const Lt=le.length;Bt=ie(It?`Attachment${de?"Replace":"Send"}Photo`:Pt?`Attachment${de?"Replace":"Send"}Video`:Yt?`Attachment${de?"Replace":"Send"}Audio`:`Attachment${de?"Replace":"Send"}File`,{count:Lt},{pluralValue:Lt});const Rt=!Te||!Le,xt=R?(0,wi.U2)(ie,Lt*R,{className:"C1OOt81o",asFont:!0}):ie("Send");return(0,se.Y)(te.A,{isOpen:Re,header:function(){if(le)return(0,se.FD)("div",{className:"modal-header-condensed",dir:ie.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:"Cancel attachments",onClick:U,iconName:"close"}),(0,se.Y)("div",{className:"modal-title",children:Bt}),pe&&!he&&(0,se.FD)(me.A,{className:"with-menu-transitions",trigger:Nt,positionX:"right",children:[Boolean(!c)&&(0,se.Y)(ue.A,{icon:"add",onClick:vt,children:ie("Add")}),Oe&&(0,se.FD)(se.FK,{children:[Tt&&(we?(0,se.Y)(ue.A,{icon:"move-caption-down",onClick:()=>nt(void 0),children:ie("ContextMoveTextDown")}):(0,se.Y)(ue.A,{icon:"move-caption-up",onClick:()=>nt(!0),children:ie("ContextMoveTextUp")})),!P&&!I&&(Ce?(0,se.Y)(ue.A,{icon:"document",onClick:ft,children:ie(Mt?"AttachmentMenuSendAllAsFiles":"AttachmentMenuSendAsFiles")}):(0,se.Y)(ue.A,{icon:"photo",onClick:ft,children:ie(Mt?"AttachmentMenuSendAllAsMedia":"AttachmentMenuSendAsMedia")})),Ce&&!c&&Ft&&(0,se.Y)(ue.A,{icon:Ye?"sd-photo":"hd-photo",onClick:bt,children:ie(Ye?"SendInStandardQuality":"SendInHighQuality")}),Ce&&Dt&&Boolean(!c)&&(Je?(0,se.Y)(ue.A,{icon:"spoiler-disable",onClick:Ct,children:ie("AttachmentMenuDisableSpoiler")}):(0,se.Y)(ue.A,{icon:"spoiler",onClick:At,children:ie("AttachmentMenuEnableSpoiler")}))]}),Mt&&(ye?(0,se.Y)(ue.A,{icon:"grouped-disable",onClick:()=>Ne(!1),children:ie("AttachmentMenuUngroupAllMedia")}):(0,se.Y)(ue.A,{icon:"grouped",onClick:()=>Ne(!0),children:ie("AttachmentMenuGroupAllMedia")}))]})]})}(),className:(0,ge.A)("a27O2Qlr",Ee&&hp,!Me&&"Pc1k8G8s",ce&&"khvUZbGZ",ve&&"ir5kkMy1",M&&"component-theme-dark"),hasAbsoluteCloseButton:Boolean(le),noBackdropClose:!0,isLowStackPriority:!0,onClose:U,children:(0,se.FD)("div",{className:dp,onDragEnter:Ve,onDrop:ut,onDragOver:function(e){e.preventDefault(),ae.current&&(window.clearTimeout(ae.current),ae.current=void 0)},onDragLeave:e=>{const{relatedTarget:t,target:i}=e;i.matches(`.${dp}`)&&!t&&(ae.current=window.setTimeout(_e,150)),i&&i.closest(`.${hp}`)||(t&&e.stopPropagation(),_e())},onClick:_e,"data-attach-description":ie("AttachmentDragAddItems"),"data-dropzone":!0,children:[(0,se.Y)("svg",{className:"d9O65j_I",children:(0,se.Y)("rect",{className:"jzCBDWMw",x:"0",y:"0",width:"100%",height:"100%",rx:"8"})}),(0,se.Y)("div",{className:(0,ge.A)("_bxSIFgj","custom-scroll",Rt&&"RPVunBe2"),onScroll:De,children:le.map((e,t)=>(0,se.Y)(Xu,{attachment:e,shouldDisplayCompressed:Ce,shouldDisplayGrouped:ye,isSingle:1===le.length,index:t,onDelete:gt,onToggleSpoiler:yt},e.uniqueId||t))}),(0,se.FD)("div",{className:(0,ge.A)("EtmiUn2k",Rt&&"FjjSKMYe"),children:[(0,se.Y)(rp,{isOpen:et,filteredUsers:st,onInsertUserName:it,onClose:tt}),(0,se.Y)(ip.A,{isOpen:ze,emojis:He,customEmojis:$e,addRecentEmoji:Z,addRecentCustomEmoji:Q,onEmojiSelect:qe,onCustomEmojiSelect:qe,onClose:We}),(0,se.Y)(ep.A,{chatId:e,isOpen:Qe,addRecentCustomEmoji:Q,onCustomEmojiSelect:Ze,onClose:Xe}),(0,se.FD)("div",{className:"Te7lIfpB",children:[(0,se.Y)(cp.A,{chatId:e,threadId:t,isMobile:ce,isReady:m,isSymbolMenuOpen:ve,openSymbolMenu:Ae,closeSymbolMenu:fe,onCustomEmojiSelect:G,onRemoveSymbol:j,onEmojiSelect:H,isAttachmentModal:!0,canSendPlainText:!0,className:"attachment-modal-symbol-menu with-menu-transitions",idPrefix:"attachment",forceDarkTheme:M}),(0,se.Y)(lp.A,{ref:oe,id:mp,chatId:e,threadId:t,isAttachmentModalInput:!0,customEmojiPrefix:"attachment",isReady:m,isActive:Re,getHtml:o,editableInputId:a.e0F,placeholder:ie("AttachmentCaptionPlaceholder"),onUpdate:E,onSend:ht,onScroll:Be,canAutoFocus:Boolean(m&&F&&i.length),captionLimit:kt,shouldSuppressFocus:ce&&ve,onSuppressedFocus:fe}),(0,se.FD)("div",{className:"wDqWK9MD",children:[(0,se.Y)(X.A,{ref:ne,className:"kNlWmBJI",size:"smaller",onClick:ht,onContextMenu:d?at:void 0,children:y&&!c?ie("Next"):c?ie("Save"):xt}),d&&(0,se.Y)(tp.A,{isOpen:ot,canSchedule:L&&C,onSendSilent:p?void 0:dt,onSendSchedule:mt,onClose:rt,onCloseAnimationEnd:lt,isSavedMessages:p,onSendWhenOnline:$,canScheduleUntilOnline:B})]})]})]})]})})})),pp=(0,s.ph)(({isOpen:e,isQuiz:t,shouldBeAnonymous:i,maxOptionsCount:n=12,onSend:o,onClear:a})=>{const l=(0,s.li)(),c=(0,s.li)(),[d,h]=(0,s.J0)(""),[m,p]=(0,s.J0)([""]),[v,g]=(0,s.J0)(!0),[A,f]=(0,s.J0)(!1),[b,C]=(0,s.J0)(t||!1),[y,S]=(0,s.J0)(""),[N,k]=(0,s.J0)(),[w,I]=(0,s.J0)(!1),P=(0,B.A)(),Y=(0,T.A)(e=>{S(e.target.value)}),F=(0,T.A)(t=>{e&&t.current&&t.current.focus()});(0,s.vJ)(()=>e?(0,u.A)(a):void 0,[e,a]),(0,s.vJ)(()=>{e||(h(""),p([""]),g(!0),f(!1),C(t||!1),S(""),k(void 0),I(!1))},[t,e]),(0,s.vJ)(()=>F(l),[F,e]);const D=(0,T.A)((e=[])=>{p([...e,""]),(0,r.Uz)(()=>{const e=c.current;e&&(0,r.YS)(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})})}),M=(0,T.A)(()=>{if(I(!1),!e)return;const t=b&&(void 0===N||!m[N].trim()),i=m.map((e,t)=>{if(e=e.trim())return{text:{text:e},option:String(t),...t===N&&{correct:!0}}}).filter(Boolean),s=d.trim().substring(0,255);if(!s||i.length<2){if(h(s),i.length){const e=m.map(e=>e.trim().substring(0,100)).filter(Boolean);e.length<2?D(e):p(e)}else D();return void I(!0)}if(t)return void I(!0);const n={summary:{question:{text:s},answers:i,...!v&&{isPublic:!0},...A&&{multipleChoice:!0},...b&&{quiz:!0}}};if(b){const{text:e,entities:t}=y&&(0,Du.Ay)(y.substring(0,200))||{};n.quiz={correctAnswers:[String(N)],...e&&{solution:e},...t&&{solutionEntities:t}}}o(n)}),L=(0,T.A)((e,t)=>{const i=[...m];i[e]=t,i[i.length-1].trim().length&&i.length<n?D(i):p(i)}),R=(0,T.A)(e=>{const t=[...m];t.splice(e,1),p(t),void 0!==N&&(N===e?k(void 0):e<N&&k(N-1)),(0,r.Uz)(()=>{c.current&&c.current.classList.toggle("overflown",c.current.scrollHeight>320)})}),x=(0,T.A)(e=>{k(Number(e))}),E=(0,T.A)(e=>{g(e.target.checked)}),V=(0,T.A)(e=>{f(e.target.checked)}),_=(0,T.A)(e=>{C(e.target.checked)}),U=(0,T.A)(e=>{13===e.keyCode&&M()}),O=(0,T.A)(e=>{h(e.target.value)}),K=(0,T.A)(()=>{if(w&&!d.trim().length)return P("lng_polls_choose_question")}),J=(0,T.A)(e=>{const t=m.map(e=>e.trim()).filter(e=>e.length);if(w&&t.length<2&&!m[e].trim().length)return P("lng_polls_choose_answers")});function G(){return m.map((e,t)=>(0,se.FD)("div",{className:"option-wrapper",children:[(0,se.Y)(ee.A,{maxLength:100,label:t!==m.length-1||m.length===n?P("OptionHint"):P("CreatePoll.AddOption"),error:J(t),value:e,onChange:e=>L(t,e.currentTarget.value),onKeyPress:U}),t!==m.length-1&&(0,se.Y)(X.A,{className:"option-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:P("Delete"),onClick:()=>R(t),iconName:"close"})]}))}return(0,se.FD)(te.A,{isOpen:e,onClose:a,header:(0,se.FD)("div",{className:"modal-header-condensed",children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:"Cancel poll creation",onClick:a,iconName:"close"}),(0,se.Y)("div",{className:"modal-title",children:P("NewPoll")}),(0,se.Y)(X.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:M,children:P("Create")})]}),className:"PollModal",children:[(0,se.Y)(ee.A,{ref:l,label:P("AskAQuestion"),value:d,error:K(),onChange:O,onKeyPress:U}),(0,se.Y)("div",{className:"options-divider"}),(0,se.FD)("div",{className:"options-list custom-scroll",ref:c,children:[(0,se.Y)("h3",{className:"options-header",children:P("PollOptions")}),w&&function(){const e=m.map(e=>e.trim()).filter(e=>e.length);return b&&(void 0===N||!e[N])&&(0,se.Y)("p",{className:"poll-error",children:P("lng_polls_choose_correct")})}(),b?(0,se.Y)(ie.A,{name:"correctOption",options:G().map((e,t)=>({value:String(t),label:e,hidden:!m[t].trim()})),selected:String(N),onChange:x}):G()]}),(0,se.Y)("div",{className:"options-divider"}),(0,se.FD)("div",{className:"quiz-mode",children:[(0,se.FD)("div",{className:"dialog-checkbox-group",children:[!i&&(0,se.Y)(Hs.A,{label:P("PollAnonymous"),checked:v,onChange:E}),(0,se.Y)(Hs.A,{label:P("PollMultiple"),checked:A,disabled:b,onChange:V}),(0,se.Y)(Hs.A,{label:P("PollQuiz"),checked:b,disabled:A||void 0!==t,onChange:_})]}),b&&(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{className:"options-header",children:P("lng_polls_solution_title")}),(0,se.Y)(rn.A,{value:y,onChange:Y,noReplaceNewlines:!0}),(0,se.Y)("div",{className:"note",children:P("CreatePoll.ExplanationInfo")})]})]})]})});var vp=i(14235);const gp=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const{appConfig:i}=e;return{editingMessage:t?.messageId?(0,c.O5q)(e,t.chatId,t.messageId):void 0,maxItemsCount:i.todoItemsMax,maxTitleLength:i.todoTitleLengthMax,maxItemLength:i.todoItemLengthMax}})(({modal:e,maxItemsCount:t,maxTitleLength:i,maxItemLength:o,editingMessage:a,onSend:l,onClear:c})=>{const{editTodo:d,closeTodoListModal:h,appendTodoList:m}=(0,n.ko)(),p=(0,s.li)(),v=(0,s.li)(),[g,A]=(0,s.J0)(""),[f,b]=(0,s.J0)(()=>[{id:(0,vp.t)(),text:""}]),[C,y]=(0,s.J0)(!0),[S,N]=(0,s.J0)(!0),[k,w]=(0,s.J0)(!1),I=(0,Fi.A)(),P=Boolean(e),Y=(0,Si.A)(e),F=Y?.forNewTask&&!a?.isOutgoing,D=a?.content.todo?.todo,M=(0,s.Kr)(()=>F&&D?D.items.map(e=>({id:e.id,text:e.title.text,isDisabled:!0})):hi.p,[F,D]),B=(0,T.A)(e=>{P&&e.current&&e.current.focus()});(0,s.Nf)(()=>{if(D&&(A(D.title.text),y(D.othersCanAppend??!1),N(D.othersCanComplete??!1),!F)){const e=D.items.map(e=>({id:e.id,text:e.title.text}));e.length<t&&e.push({id:(0,vp.t)(),text:""}),b(e)}},[D,F,t]),(0,s.vJ)(()=>P?(0,u.A)(c):void 0,[P,c]),(0,s.vJ)(()=>{P||(A(""),b([{id:(0,vp.t)(),text:""}]),y(!0),N(!0),w(!1))},[P]),(0,s.vJ)(()=>{P&&(0,r.YS)(()=>{if(Y?.forNewTask){const e=v.current?.querySelectorAll("input"),t=e?.[e.length-1];t?.focus()}else B(p)})},[B,P,Y?.forNewTask]);const L=(0,T.A)(e=>{const t=(0,vp.t)();b([...e,{id:t,text:""}]),(0,r.Uz)(()=>{const e=v.current;e&&(0,r.YS)(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})})}),R=(0,T.A)(()=>{if(w(!1),!P)return;const e=f.map(e=>{const t=e.text.trim();if(t)return{id:e.id,title:{text:t.substring(0,o)}}}).filter(Boolean),t=g.trim().substring(0,i);if(!t||0===e.length){if(A(t),e.length){const e=f.map(e=>({...e,text:e.text.trim().substring(0,o)})).filter(e=>e.text.length);0===e.length?L([]):b([...e,{id:(0,vp.t)(),text:""}])}else L([]);return void w(!0)}if(F&&a)return m({chatId:a.chatId,messageId:a.id,items:e}),void h();const s={todo:{title:{text:t},items:e,othersCanAppend:C,othersCanComplete:S}};a?d({chatId:a.chatId,todo:s,messageId:a.id}):l(s),h()}),x=(0,T.A)((e,i)=>{const s=[...f];s[e]={...s[e],text:i},s[s.length-1].text.trim().length&&s.length<t?L(s):b(s)}),E=(0,T.A)(e=>{const t=[...f];t.splice(e,1),b(t),(0,r.Uz)(()=>{v.current&&v.current.classList.toggle("overflown",v.current.scrollHeight>320)})}),V=(0,T.A)(e=>{y(e.target.checked)}),_=(0,T.A)(e=>{N(e.target.checked)}),U=(0,T.A)(e=>{"Enter"===e.key&&R()}),O=(0,T.A)(e=>{A(e.target.value)}),K=(0,T.A)(()=>{if(k&&!g.trim().length)return I("ToDoListErrorChooseTitle")}),J=(0,T.A)(e=>{const t=f.map(e=>e.text.trim()).filter(e=>e.length);if(k&&t.length<1&&!f[e].text.trim().length)return I("ToDoListErrorChooseTasks")}),G=t-f.length-(F&&D?D.items.length:0);return(0,se.FD)(te.A,{isOpen:P,onClose:c,header:function(){const e=F?"TitleAppendToDoList":a?"TitleEditToDoList":"TitleNewToDoList";return(0,se.FD)("div",{className:"modal-header-condensed",children:[(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:I("AriaToDoCancel"),onClick:c,iconName:"close"}),(0,se.Y)("div",{className:"modal-title",children:I(e)}),(0,se.Y)(X.A,{color:"primary",size:"tiny",className:"modal-action-button",onClick:R,children:I(F?"Add":a?"Save":"Create")})]})}(),className:"ToDoListModal",children:[!F&&(0,se.Y)(ee.A,{ref:p,label:I("InputTitle"),value:g,error:K(),onChange:O,onKeyPress:U}),F&&(0,se.Y)("div",{className:"readonly-title",children:g}),(0,se.Y)("div",{className:"options-divider"}),(0,se.FD)("div",{className:"options-list custom-scroll",ref:v,children:[(0,se.Y)("h3",{className:"items-header",children:I("TitleToDoList")}),function(){const e=[...M,...f];return e.map((i,s)=>{const n=s-M.length;return(0,se.FD)("div",{className:"item-wrapper",children:[(0,se.Y)(ee.A,{maxLength:100,label:s!==e.length-1||e.length===t?I("TitleTask"):I("TitleAddTask"),error:J(n),value:i.text,disabled:i.isDisabled,onChange:e=>x(n,e.currentTarget.value),onKeyPress:U}),s!==e.length-1&&!i.isDisabled&&(0,se.Y)(X.A,{className:"item-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:I("Delete"),onClick:()=>E(n),iconName:"close"})]})})}()]}),(0,se.Y)("div",{className:"items-count-hint",children:I("HintTodoListTasksCount2",{count:G},{pluralValue:G})}),(0,se.Y)("div",{className:"options-divider"}),!F&&(0,se.Y)("div",{className:"options-footer",children:(0,se.FD)("div",{className:"dialog-checkbox-group",children:[(0,se.Y)(Hs.A,{label:I("AllowOthersAddTasks"),checked:C,onChange:V}),(0,se.Y)(Hs.A,{label:I("AllowOthersMarkAsDone"),checked:S,onChange:_})]})})]})}));var Ap=i(36680),fp=i(52491);const bp=(0,s.ph)(({emoji:e,focus:t,onClick:i})=>{const s=(0,T.A)(t=>{t.preventDefault(),i(e.native,e.id)}),n=(0,ge.A)("EmojiButton",t&&"focus"),o=`./img-apple-64/${e.image}.png`,a=fp.On.has(o);return(0,se.Y)("div",{className:n,onMouseDown:s,title:`:${e.names[0]}:`,children:m.TL?e.native:(0,se.Y)("img",{src:o,className:a?void 0:"opacity-transition shown",alt:e.native,loading:"lazy","data-path":o,onLoad:a?void 0:fp.P_,draggable:!1})})}),Cp=.625*g.$,yp=.25*g.$,Sp=.5*g.$,Np=.5*g.$,kp=(0,s.ph)(({category:e,index:t,allEmojis:i,observeIntersection:n,shouldRender:o,onEmojiSelect:r})=>{const l=(0,s.li)();(0,Za.mv)(l,n);const c=(0,Mi.A)(o),d=(0,B.A)(),{isMobile:h}=(0,Y.Ay)(),m=h?Math.floor((k.A.get().width-Np+Cp)/(a.g0Q+Cp)):8,u=Math.ceil(e.emojis.length/m)*(a.g0Q+(h?Sp:yp));return(0,se.FD)("div",{ref:l,id:`emoji-category-${t}`,className:"symbol-set",children:[(0,se.Y)("div",{className:"symbol-set-header",children:(0,se.Y)("p",{className:"symbol-set-name",dir:"auto",children:d(e.id===a.sR2?"RecentStickers":`Emoji${t}`)})}),(0,se.Y)("div",{className:(0,ge.A)("symbol-set-container",c),style:`height: ${u}px;`,dir:d.isRtl?"rtl":void 0,children:o&&e.emojis.map(e=>{const t=i[e];if(!t)return;const s="id"in t?t:t[1];return(0,se.Y)(bp,{emoji:s,onClick:r},s.id)})})]},e.id)}),wp={recent:"recent",people:"smile",nature:"animals",foods:"eats",activity:"sport",places:"car",objects:"lamp",symbols:"language",flags:"flag"},Ip=3.25*g.$,Pp=2.625*g.$,Yp=[];let Fp,Dp,Mp;const Tp=(0,s.ph)((0,n.EK)(e=>(0,di.Up)(e,["recentEmojis"]))(({className:e,recentEmojis:t,onEmojiSelect:n})=>{const o=(0,s.li)(),r=(0,s.li)(),[l,c]=(0,s.J0)(),[d,h]=(0,s.J0)(),[u,p]=(0,s.J0)(0),{isMobile:v}=(0,Y.Ay)(),{handleScroll:g,isAtBeginning:A}=(0,rs.A)(),{observe:f}=(0,Za.BL)({rootRef:o,throttleMs:200},e=>{e.forEach(e=>{const{id:t}=e.target;if(!t||!t.startsWith("emoji-category-"))return;const i=Number(t.replace("emoji-category-",""));Yp[i]=e.isIntersecting});const t=Yp.reduce((e,t,i)=>t&&i<e?i:e,1/0);t!==1/0&&p(t)}),b=(0,Wa.A)([],a.vVF),C=d&&b;(0,An.A)(r,!(v&&C)),(0,s.vJ)(()=>{if(!l)return;const e=r.current;if(!e)return;const t=u*Pp-e.offsetWidth/2+Pp/2;(0,uo.A)(e,t)},[l,u]);const y=(0,B.A)(),S=(0,s.Kr)(()=>{if(!l)return hi.p;const e=[...l];return t?.length&&e.unshift({id:a.sR2,name:y("RecentStickers"),emojis:t}),e},[l,y,t]);(0,s.vJ)(()=>{setTimeout(()=>{const e=()=>{c(Mp.categories),h(Mp.emojis)};Mp?e():async function(){return Fp||(Fp=i.e(996).then(i.t.bind(i,20996,19)),Dp=(await Fp).default,Mp=(0,fp.cp)(Dp)),Fp}().then(e)},200)},[]);const N=(0,T.A)(e=>{p(e);const t=o.current.closest(".SymbolMenu-main").querySelector(`#emoji-category-${e}`);(0,Qa.Ay)({container:o.current,element:t,position:"start",margin:Ip,maxDistance:100})}),k=(0,T.A)((e,t)=>{n(e,t)}),w=(0,ge.A)("EmojiPicker",e),I=(0,ge.A)("EmojiPicker-header",!A&&"with-top-border");return(0,se.Y)(ae.Ay,{className:w,activeKey:C?1:0,name:"fade",shouldCleanup:!0,children:C?(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{ref:r,className:I,dir:y.isRtl?"rtl":void 0,children:S.map(function(e,t){const i=wp[e.id];return i&&(0,se.Y)(X.A,{className:"symbol-set-button "+(t===u?"activated":""),round:!0,faded:!0,color:"translucent",onClick:()=>N(t),ariaLabel:e.name,iconName:i})})}),(0,se.Y)("div",{ref:o,onScroll:g,className:(0,ge.A)("EmojiPicker-main",m.TF?"no-scrollbar":"custom-scroll"),children:S.map((e,t)=>(0,se.Y)(kp,{category:e,index:t,allEmojis:d,observeIntersection:f,shouldRender:u>=t-1&&u<=t+1,onEmojiSelect:k}))})]}):(0,se.Y)(Ds.A,{})})})),Bp=(0,s.ph)(({gif:e,isDisabled:t,className:i,observeIntersection:n,onClick:o,onUnsaveClick:a,isSavedMessages:r})=>{const c=(0,s.li)(),d=(0,B.A)(),h=(0,Za.Vz)(c,n)&&!t,u=!e.hasVideoPreview&&e.thumbnail&&(0,l.sC)(e,"pictogram"),p=(0,q.A)(u,!h),[v]=(0,s.J0)(e.thumbnail?.dataUri&&!p),g=(0,Yi.A)(e.thumbnail?.dataUri,!v),A=(0,l.Ct)(e)||(0,l.sC)(e,"full"),f=(0,q.A)(A,!h),b=Boolean(h&&f),{isBuffered:C,bufferingHandlers:y}=(0,Ge.A)(!0),S=h&&!C,N=h&&C,{isContextMenuOpen:k,contextMenuAnchor:w,handleBeforeContextMenu:I,handleContextMenu:P,handleContextMenuClose:Y,handleContextMenuHide:F}=(0,Ws.A)(c),D=(0,T.A)(()=>c.current),M=(0,T.A)(()=>c.current.closest(".custom-scroll, .no-scrollbar")),L=(0,T.A)(()=>c.current.querySelector(".gif-context-menu .bubble")),R=(0,T.A)(()=>{!k&&o&&o({...e,blobUrl:f})}),x=(0,T.A)(t=>{t.stopPropagation(),t.preventDefault(),a(e)}),E=(0,T.A)(()=>{a?.(e)}),V=(0,T.A)(()=>{o({...e,blobUrl:f},!0)}),_=(0,T.A)(()=>{o({...e,blobUrl:f},void 0,!0)}),U=(0,T.A)(e=>{(0,rr.u)(e),I(e)});(0,s.vJ)(()=>{t&&Y()},[Y,t]);const O=(0,ge.A)("GifButton",e.width&&e.height&&e.width<e.height?"vertical":"horizontal",o&&"interactive",i);return(0,se.FD)("div",{ref:c,className:O,onMouseDown:U,onClick:R,onContextMenu:P,children:[!m.TF&&a&&(0,se.Y)(X.A,{className:"gif-unsave-button",color:"dark",pill:!0,iconName:"close",iconClassName:"gif-unsave-button-icon",noFastClick:!0,onClick:x}),v&&(0,se.Y)("canvas",{ref:g,className:"thumbnail"}),p&&!N&&(0,se.Y)("img",{src:p,alt:"",className:"preview",draggable:!1}),b&&(0,se.Y)(xi.A,{canPlay:!0,src:f,autoPlay:!0,loop:!0,muted:!0,disablePictureInPicture:!0,playsInline:!0,preload:"none",...y}),S&&(0,se.Y)(Ue.A,{color:p||v?"white":"black"}),o&&void 0!==w&&(0,se.FD)(Ze.A,{isOpen:k,anchor:w,getTriggerElement:D,getRootElement:M,getMenuElement:L,className:"gif-context-menu",autoClose:!0,onClose:Y,onCloseAnimationEnd:F,children:[!r&&(0,se.Y)(ue.A,{onClick:V,icon:"mute",children:d("SendWithoutSound")}),(0,se.Y)(ue.A,{onClick:_,icon:"calendar",children:d(r?"SetReminder":"ScheduleMessage")}),a&&(0,se.Y)(ue.A,{destructive:!0,icon:"delete",onClick:E,children:d("Delete")})]})]})}),Lp=(0,s.ph)((0,n.EK)(e=>{const{chatId:t}=(0,c.Xf0)(e)||{},i=Boolean(t)&&(0,c.nZ4)(e,t);return{savedGifs:e.gifs.saved.gifs,isSavedMessages:i}})(({className:e,loadAndPlay:t,canSendGifs:i,savedGifs:o,isSavedMessages:r,onGifSelect:l})=>{const{loadSavedGifs:c,saveGif:d}=(0,n.ko)(),h=(0,s.li)(),{observe:u}=(0,Za.BL)({rootRef:h,debounceMs:300});(0,s.vJ)(()=>{t&&c()},[t,c]);const p=(0,T.A)(e=>{d({gif:e,shouldUnsave:!0})}),v=(0,Wa.A)([],a.jhd),g=i&&(!v||!o);return(0,se.Y)(ae.Ay,{ref:h,className:(0,ge.A)("GifPicker",e,m.TF?"no-scrollbar":"custom-scroll"),slideClassName:"GifPickerGrid",activeKey:g?0:1,name:"fade",shouldCleanup:!0,children:i?v&&o&&o.length?o.map(e=>(0,se.Y)(Bp,{gif:e,observeIntersection:u,isDisabled:!t,onClick:i?l:void 0,onUnsaveClick:p,isSavedMessages:r},e.id)):v&&o?(0,se.Y)("div",{className:"picker-disabled",children:"No saved GIFs."}):(0,se.Y)(Ds.A,{color:"yellow"}):(0,se.Y)("div",{className:"picker-disabled",children:"Sending GIFs is not allowed in this chat."})})}));let Rp=function(e){return e[e.Emoji=0]="Emoji",e[e.CustomEmoji=1]="CustomEmoji",e[e.Stickers=2]="Stickers",e[e.GIFs=3]="GIFs",e}({});const xp={[Rp.Emoji]:"Emoji",[Rp.CustomEmoji]:"StickersList.EmojiItem",[Rp.Stickers]:"AccDescrStickers",[Rp.GIFs]:"GifsTab"},Ep={[Rp.Emoji]:"icon-smile",[Rp.CustomEmoji]:"icon-favorite",[Rp.Stickers]:"icon-stickers",[Rp.GIFs]:"icon-gifs"},Vp=(0,s.ph)(({activeTab:e,onSwitchTab:t,onRemoveSymbol:i,onSearchOpen:s,isAttachmentModal:n,canSendPlainText:o,canSearch:a})=>{const r=(0,B.A)();function l(i){return(0,se.Y)(X.A,{className:"symbol-tab-button "+(e===i?"activated":""),onClick:()=>t(i),ariaLabel:r(xp[i]),round:!0,faded:!0,color:"translucent",children:(0,se.Y)("i",{className:(0,ge.A)("icon",Ep[i])})})}const c=(0,T.A)(()=>{s(e===Rp.Stickers?"stickers":"gifs")});return(0,se.FD)("div",{className:"SymbolMenu-footer",onClick:function(e){e.stopPropagation()},dir:r.isRtl?"rtl":void 0,children:[e!==Rp.Emoji&&e!==Rp.CustomEmoji&&a&&(0,se.Y)(X.A,{className:"symbol-search-button",ariaLabel:e===Rp.Stickers?"Search Stickers":"Search GIFs",round:!0,faded:!0,color:"translucent",onClick:c,iconName:"search"}),o&&l(Rp.Emoji),o&&l(Rp.CustomEmoji),!n&&l(Rp.Stickers),!n&&l(Rp.GIFs),(e===Rp.Emoji||e===Rp.CustomEmoji)&&(0,se.Y)(X.A,{className:"symbol-delete-button",onClick:i,ariaLabel:"Remove Symbol",round:!0,faded:!0,color:"translucent",iconName:"delete-left"})]})});let _p=!1;const Up=(0,s.ph)((0,n.EK)(e=>({isLeftColumnShown:(0,c.nTw)(e).isLeftColumnShown,isBackgroundTranslucent:(0,c.cwE)(e),animationLevel:(0,ks.lS)(e).animationLevel}))(({chatId:e,threadId:t,isOpen:i,canSendStickers:n,canSendGifs:o,isMessageComposer:a,idPrefix:l,isAttachmentModal:c,canSendPlainText:d,className:h,onLoad:u,onClose:p,onEmojiSelect:v,onCustomEmojiSelect:g,onStickerSelect:A,onGifSelect:f,onRemoveSymbol:b,onSearchOpen:C,addRecentEmoji:y,addRecentCustomEmoji:S,isLeftColumnShown:N,isBackgroundTranslucent:k,animationLevel:w,...I})=>{const[P,F]=(0,s.J0)(Rp.Emoji),[D,M]=(0,s.J0)([]),[L,R]=(0,s.J0)([]),{isMobile:x}=(0,Y.Ay)(),[E,V]=(0,Ap.A)(i,p,void 0,x),{shouldRender:_,transitionClassNames:U}=(0,je.A)(i,p,!1,!1),O=(0,B.A)();!_p&&i&&(_p=!0),(0,s.vJ)(()=>{u()},[u]),(0,s.vJ)(()=>{d||F(Rp.Stickers)},[d]),(0,s.Nf)(()=>{if(x&&i&&!c)return document.body.classList.add("enable-symbol-menu-transforms"),document.body.classList.add("is-symbol-menu-open"),()=>{document.body.classList.remove("is-symbol-menu-open"),setTimeout(()=>{(0,r.RK)(()=>{document.body.classList.remove("enable-symbol-menu-transforms")})},350)}},[c,x,i]);const K=(0,s.li)(D);K.current=D,(0,s.vJ)(()=>{K.current.length&&!i&&(K.current.forEach(e=>{y({emoji:e})}),M([]))},[i,y]);const J=(0,T.A)((e,t)=>{M(e=>[...e,t]),v(e)}),G=(0,s.li)(L);G.current=L,(0,s.vJ)(()=>{G.current.length&&!i&&(G.current.forEach(e=>{S({documentId:e})}),R([]))},[i,S]);const j=(0,T.A)(e=>{R(t=>[...t,e.id]),g(e)}),z=(0,T.A)(e=>{p(),C(e)}),H=(0,T.A)((e,t,i,s)=>{A?.(e,t,i,!0,s)}),$=(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{className:"SymbolMenu-main",onClick:function(e){e.stopPropagation()},children:_p&&(0,se.Y)(ae.Ay,{name:(0,ws.P)("slide",w),activeKey:P,renderCount:Object.values(xp).length,children:function(s,r){switch(P){case Rp.Emoji:return(0,se.Y)(Tp,{className:"picker-tab",onEmojiSelect:J});case Rp.CustomEmoji:return(0,se.Y)(Yr,{className:"picker-tab",isHidden:!i||!s,idPrefix:l,loadAndPlay:i&&(s||r),chatId:e,isTranslucent:!x&&k,onCustomEmojiSelect:j});case Rp.Stickers:return(0,se.Y)(Lu,{className:"picker-tab",isHidden:!i||!s,loadAndPlay:!!n&&i&&(s||r),idPrefix:l,canSendStickers:n,noContextMenus:!a,chatId:e,threadId:t,isTranslucent:!x&&k,onStickerSelect:H});case Rp.GIFs:return(0,se.Y)(Lp,{className:"picker-tab",loadAndPlay:!!o&&i&&(s||r),canSendGifs:o,onGifSelect:f})}}})}),x&&(0,se.Y)(X.A,{round:!0,faded:!0,color:"translucent",ariaLabel:O("Close"),className:"symbol-close-button",size:"tiny",onClick:p,iconName:"close"}),(0,se.Y)(Vp,{activeTab:P,onSwitchTab:F,onRemoveSymbol:b,canSearch:a,onSearchOpen:z,isAttachmentModal:c,canSendPlainText:d})]});if(x){if(!_)return;const e=(0,ge.A)("SymbolMenu mobile-menu",U,N&&"left-column-open",c&&"in-attachment-modal",a&&"in-middle-column");return c?(0,se.Y)("div",{className:e,children:$}):(0,se.Y)(Fr.A,{children:(0,se.Y)("div",{className:e,children:$})})}return(0,se.Y)(Ze.A,{isOpen:i,onClose:p,withPortal:c,className:(0,ge.A)("SymbolMenu",h),onCloseAnimationEnd:p,onMouseEnter:m.TF?void 0:E,onMouseLeave:m.TF?void 0:V,noCloseOnBackdrop:!m.TF,noCompact:!0,...c?I:{positionX:"left",positionY:"bottom"},children:$})})),Op=(0,s.ph)(({withAvatar:e,focus:t,command:i,description:s,peer:n,clickArg:o,onClick:a})=>{const r=(0,T.A)(()=>{a(o)});return(0,se.FD)(li.A,{className:(0,ge.A)("BotCommand chat-item-clickable scroll-item",e&&"with-avatar"),multiline:!0,onClick:r,focus:t,children:[e&&(0,se.Y)(Yt.A,{size:"small",peer:n}),(0,se.FD)("div",{className:"content-inner",children:[(0,se.FD)("span",{className:"title",children:["/",i]}),(0,se.Y)("span",{className:"subtitle",children:(0,Pt.A)(s)})]})]},i)}),Kp=(0,s.ph)(({isOpen:e,chatId:t,withUsername:i,botCommands:o,quickReplies:a,quickReplyMessages:r,self:c,getHtml:d,onClick:h,onClose:m})=>{const{sendBotCommand:u,sendQuickReply:p}=(0,n.ko)(),v=(0,s.li)(),{shouldRender:g,transitionClassNames:A}=(0,je.A)(e,void 0,void 0,!1),f=(0,T.A)(({botId:e,command:t})=>{const s=(0,n.mS)().users.byId[e];u({command:`/${t}${i&&s?`@${(0,l.Kl)(s)}`:""}`}),h()}),b=(0,T.A)(e=>{p({chatId:t,quickReplyId:e}),h()}),C=(0,s.Kr)(()=>{if(a?.length&&r)return a.map(e=>{const t=r[e.topMessageId];return{id:e.id,command:e.shortcut,description:t?.content.text?.text||""}})},[a,r]),y=(0,T.A)(e=>!!e.command.startsWith(d().slice(1))&&("id"in e?b(e.id):f(e),!0)),S=ap({isActive:e,items:(0,s.Kr)(()=>{if(o||C)return[].concat(C||[],o||[])},[o,C]),onSelect:y,onClose:m}),N=o&&!o.length||a&&!a.length;if((0,s.vJ)(()=>{N&&m()},[N,m]),(0,s.vJ)(()=>{op(".chat-item-clickable",S,v)},[S]),!g||N)return;const k=(0,ge.A)("iaTB59vy","composer-tooltip custom-scroll",A);return(0,se.FD)("div",{className:k,ref:v,children:[C?.map((e,t)=>(0,se.Y)(Op,{command:e.command,description:e.description,peer:c,withAvatar:!0,clickArg:e.id,onClick:b,focus:S===t},`quickReply_${e.id}`)),o?.map((e,t)=>(0,se.Y)(Op,{command:e.command,description:e.description,peer:(0,n.mS)().users.byId[e.botId],withAvatar:!0,clickArg:e,onClick:f,focus:S+(C?.length||0)===t},`${e.botId}_${e.command}`))]})}),Jp=(0,s.ph)(({isOpen:e,botCommands:t,onClose:i})=>{const{sendBotCommand:s}=(0,n.ko)(),{isMobile:o}=(0,Y.Ay)(),[a,r]=(0,Ap.A)(e,i,void 0,o),l=(0,T.A)(e=>{s({command:`/${e}`}),i()});return(0,se.Y)(Ze.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:i,className:"BotCommandMenu",onCloseAnimationEnd:i,onMouseEnter:m.TF?void 0:a,onMouseLeave:m.TF?void 0:r,noCloseOnBackdrop:!m.TF,noCompact:!0,children:t.map(e=>(0,se.Y)(Op,{command:e.command,description:e.description,clickArg:e.command,onClick:l},e.command))})}),Gp=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{stickers:i}=e.stickers.forEmoji;return{stickers:i,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}})(({chatId:e,threadId:t,isOpen:i,onStickerSelect:n,onClose:o,stickers:r,isSavedMessages:l,isCurrentUserPremium:c})=>{const d=(0,s.li)(),{shouldRender:h,transitionClassNames:m}=(0,je.A)(i,void 0,void 0,!1),p=(0,K.A)(r,!0),v=r||p,g=(0,Tu.A)(e,t),{observe:A}=(0,Za.BL)({rootRef:d,throttleMs:200});(0,s.vJ)(()=>i?(0,u.A)(o):void 0,[i,o]);const f=(0,ge.A)("StickerTooltip composer-tooltip custom-scroll",m,!v?.length&&"hidden");return(0,se.Y)("div",{ref:d,className:f,onMouseMove:()=>{g({type:"chooseSticker"})},children:h&&v?v.map(e=>(0,se.Y)(dr,{sticker:e,size:a.bkT,observeIntersection:A,onClick:i?n:void 0,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c},e.id)):h?(0,se.Y)(Ds.A,{}):void 0})})),jp={root:"_8sFuAomM",emojiButton:"crWzZ2jr"},zp=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{stickers:i}=e.customEmojis.forEmoji;return{customEmoji:i,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}})(({isOpen:e,addRecentCustomEmoji:t,onCustomEmojiSelect:i,onClose:o,customEmoji:r,isSavedMessages:l,isCurrentUserPremium:c,noPlay:d})=>{const{clearCustomEmojiForEmoji:h}=(0,n.ko)(),m=(0,s.li)(),{shouldRender:p,transitionClassNames:v}=(0,je.A)(e,void 0,void 0,!1),g=(0,K.A)(r,!0),A=r||g;(0,An.A)(m);const{observe:f}=(0,Za.BL)({rootRef:m,throttleMs:200,isDisabled:!e});(0,s.vJ)(()=>e?(0,u.A)(o):void 0,[e,o]);const b=(0,T.A)(s=>{e&&(i(s),t({documentId:s.id}),h())}),C=(0,ge.A)(jp.root,"composer-tooltip no-scrollbar",v,!A?.length&&jp.hidden);return(0,se.Y)("div",{ref:m,className:C,children:p&&A?A.map(e=>(0,se.Y)(dr,{sticker:e,className:jp.emojiButton,size:a.x6_,observeIntersection:f,onClick:b,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c,noPlay:d},e.id)):p?(0,se.Y)(Ds.A,{}):void 0})}));var Hp=i(76283);const $p=(0,s.ph)(({isOpen:e,isOpenToBottom:t=!1,isSavedMessages:i,canSchedule:o,canScheduleUntilOnline:a,onSendSilent:r,onSendSchedule:l,onSendWhenOnline:c,onRemoveEffect:d,onClose:h,onCloseAnimationEnd:u,chatId:p,withEffects:v,hasCurrentEffect:g,effectReactions:A,allAvailableReactions:f,onToggleReaction:b,canBuyPremium:C,isCurrentUserPremium:y,isInSavedMessages:S,isInStoryViewer:N,canPlayAnimatedEmojis:k})=>{const{openEffectPicker:w}=(0,n.ko)(),[I,P]=(0,Ap.A)(e,h),[Y,M]=(0,s.J0)(!1),L=(0,B.A)(),R=(0,Fi.A)(),[x,E,V]=(0,D.A)();(0,F.A)(([t])=>{e&&!t&&(V(),M(Boolean(a)))},[e,a]);const[_,U,O]=(0,D.A)(),K=(0,T.A)(e=>{E(),p&&w({chatId:p,position:e})});return(0,s.vJ)(()=>{e?setTimeout(()=>{U()},200):O()},[e,U,O]),(0,se.FD)(Ze.A,{isOpen:e,autoClose:!0,positionX:"right",positionY:t?"top":"bottom",className:(0,ge.A)("CustomSendMenu","fluid","with-menu-transitions",v&&"with-effects"),onClose:h,onCloseAnimationEnd:u,onMouseEnter:m.TF?void 0:I,onMouseLeave:m.TF?void 0:P,noCloseOnBackdrop:!m.TF,children:[v&&!N&&(0,se.Y)(Hp.A,{allAvailableReactions:f,effectReactions:A,currentReactions:void 0,onToggleReaction:b,isPrivate:!0,isReady:_,canBuyPremium:C,isCurrentUserPremium:y,isInSavedMessages:S,isForEffects:!0,canPlayAnimatedEmojis:k,onShowMore:K,onClose:h,className:(0,ge.A)(x&&"ReactionSelector-hidden")}),(0,se.FD)("div",{className:(0,ge.A)("CustomSendMenu_items",x&&"CustomSendMenu_items-hidden"),dir:R.isRtl?"rtl":void 0,children:[r&&(0,se.Y)(ue.A,{icon:"mute",onClick:r,children:L("SendWithoutSound")}),o&&l&&(0,se.Y)(ue.A,{icon:"schedule",onClick:l,children:L(i?"SetReminder":"ScheduleMessage")}),o&&l&&Y&&(0,se.Y)(ue.A,{icon:"user-online",onClick:c,children:L("SendWhenOnline")}),v&&g&&(0,se.Y)(ue.A,{icon:"delete",onClick:d,children:R("RemoveEffect")})]})]})});var qp=i(41510),Wp=i(22802);const Qp={B:"bold",STRONG:"bold",I:"italic",EM:"italic",U:"underline",DEL:"strikethrough",CODE:"monospace",SPAN:"spoiler"},Zp=document.createElement("div"),Xp=(0,s.ph)(({isOpen:e,anchorPosition:t,selectedRange:i,setSelectedRange:n,onClose:o})=>{const r=(0,s.li)(),l=(0,s.li)(),{shouldRender:c,transitionClassNames:d}=(0,je.A)(e),[m,p,v]=(0,D.A)(),[g,A]=(0,s.J0)(""),[f,b]=(0,s.J0)(!1),[C,S]=(0,s.J0)(),[N,k]=(0,s.J0)({}),w=(0,Fi.A)();(0,s.vJ)(()=>e?(0,u.A)(o):void 0,[e,o]),(0,Wp.A)(e,r,o,!0),(0,s.vJ)(()=>{m?l.current.focus():(A(""),b(!1))},[m]),(0,s.vJ)(()=>{c||(v(),k({}),S(void 0))},[v,c]),(0,s.vJ)(()=>{if(!e||!i)return;const t={};let{parentElement:s}=i.commonAncestorContainer;for(;s&&s.id!==a.CfG;){const e=Qp[s.tagName];e&&(t[e]=!0),s=s.parentElement}k(t)},[e,i,p]);const I=(0,T.A)(()=>{if(!i)return;const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(i))}),P=(0,T.A)(()=>{const e=window.getSelection();e&&n(e.getRangeAt(0))}),Y=(0,T.A)(e=>{if(i)return Zp.replaceChildren(i.cloneContents()),e&&Zp.querySelectorAll(Mu._p).forEach(e=>{e.replaceWith(e.getAttribute("alt"))}),Zp.innerHTML}),F=(0,T.A)(()=>{if(i)return i.commonAncestorContainer.parentElement});function M(){const e=l.current;if(!e)return;const{offsetWidth:t,scrollWidth:i,scrollLeft:s}=e;if(i<=t)return void S(void 0);let n="";s<i-t&&(n="mask-right"),s>0&&(n+=" mask-left"),S(n)}function B(e){if(N[e])return"active";if("monospace"===e||"strikethrough"===e){if(Object.keys(N).some(t=>t!==e&&Boolean(N[t])))return"disabled"}else if(N.monospace||N.strikethrough)return"disabled"}const L=(0,T.A)(()=>{if(N.spoiler){const e=F();if(!i||!e||e.dataset.entityType!==G.C7.Spoiler||!e.textContent)return;return e.replaceWith(e.textContent),void k(e=>({...e,spoiler:!1}))}const e=Y();document.execCommand("insertHTML",!1,`<span class="spoiler" data-entity-type="${G.C7.Spoiler}">${e}</span>`),o()}),R=(0,T.A)(()=>{k(e=>(document.execCommand(e.bold?"removeFormat":"bold"),Object.keys(e).forEach(t=>{"italic"!==t&&"underline"!==t||!Boolean(e[t])||document.execCommand(t)}),P(),{...e,bold:!e.bold}))}),x=(0,T.A)(()=>{document.execCommand("italic"),P(),k(e=>({...e,italic:!e.italic}))}),E=(0,T.A)(()=>{document.execCommand("underline"),P(),k(e=>({...e,underline:!e.underline}))}),V=(0,T.A)(()=>{if(N.strikethrough){const e=F();if(!i||!e||"DEL"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void k(e=>({...e,strikethrough:!1}))}const e=Y();document.execCommand("insertHTML",!1,`<del>${e}</del>`),o()}),_=(0,T.A)(()=>{if(N.monospace){const e=F();if(!i||!e||"CODE"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void k(e=>({...e,monospace:!1}))}const e=Y(!0);document.execCommand("insertHTML",!1,`<code class="text-entity-code" dir="auto">${e}</code>`),o()}),U=(0,T.A)(()=>{const e=((0,Js.Tc)(g)||"").split("%").map(encodeURI).join("%");if(f){const t=F();if(!t||"A"!==t.tagName)return;return t.href=e,void o()}const t=Y(!0);I(),document.execCommand("insertHTML",!1,`<a href="${e}" class="text-entity-link" dir="auto">${t}</a>`),o()}),O=(0,T.A)(e=>{const t={k:p,b:R,u:E,i:x,m:_,s:V,p:L}[function(e){const t=e.key||e.code;return t.startsWith("Key")?t.slice(3).toLowerCase():t}(e)];!e.altKey&&(e.ctrlKey||e.metaKey)&&t&&(e.preventDefault(),e.stopPropagation(),t())});if((0,s.vJ)(()=>(e&&document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)),[e,O]),!c)return;const K=(0,ge.A)("TextFormatter",d,m&&"link-control-shown"),J=(0,ge.A)("TextFormatter-link-url-confirm",Boolean(g.length)&&"shown"),j=t?`left: ${t.x}px; top: ${t.y}px;--text-formatter-left: ${t.x}px;`:"";return(0,se.FD)("div",{ref:r,className:K,style:j,onKeyDown:function(e){if("Enter"===e.key&&m){if(!g.trim())return;U(),e.preventDefault()}},onMouseDown:y.A,children:[(0,se.FD)("div",{className:"TextFormatter-buttons",children:[(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("FormattingSpoilerAria"),className:B("spoiler"),onClick:L,iconName:"eye-crossed"}),(0,se.Y)("div",{className:"TextFormatter-divider"}),(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("FormattingBoldAria"),className:B("bold"),onClick:R,iconName:"bold"}),(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("FormattingItalicAria"),className:B("italic"),onClick:x,iconName:"italic"}),(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("FormattingUnderlineAria"),className:B("underline"),onClick:E,iconName:"underlined"}),(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("FormattingStrikethroughAria"),className:B("strikethrough"),onClick:V,iconName:"strikethrough"}),(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("FormattingMonospaceAria"),className:B("monospace"),onClick:_,iconName:"monospace"}),(0,se.Y)("div",{className:"TextFormatter-divider"}),(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("FormattingAddLinkAria"),onClick:p,iconName:"link"})]}),(0,se.Y)("div",{className:"TextFormatter-link-control",children:(0,se.FD)("div",{className:"TextFormatter-buttons",children:[(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("Cancel"),onClick:v,iconName:"arrow-left"}),(0,se.Y)("div",{className:"TextFormatter-divider"}),(0,se.Y)("div",{className:(0,ge.A)("TextFormatter-link-url-input-wrapper",C),children:(0,se.Y)("input",{ref:l,className:"TextFormatter-link-url-input",type:"text",value:g,placeholder:w("FormattingEnterUrl"),autoComplete:"off",spellCheck:!h.Vq&&void 0,inputMode:"url",dir:"auto",onChange:function(e){A(e.target.value),M()},onScroll:M})}),(0,se.FD)("div",{className:J,children:[(0,se.Y)("div",{className:"TextFormatter-divider"}),(0,se.Y)(X.A,{color:"translucent",ariaLabel:w("Save"),className:"color-primary",onClick:U,iconName:"check"})]})]})})]})}),ev=(0,s.ph)(({emoji:e,focus:t,onClick:i,observeIntersection:s})=>{const n=(0,T.A)(t=>{t.preventDefault(),i?.(e)}),o=(0,ge.A)("EmojiButton",t&&"focus");return(0,se.Y)("div",{className:o,onMouseDown:n,title:e.emoji,children:(0,se.Y)(ro.A,{documentId:e.id,size:32,withSharedAnimation:!0,shouldPreloadPreview:!0,observeIntersectionForPlaying:s})})}),tv=(0,s.ph)(({isOpen:e,emojis:t,customEmojis:i,onClose:n,onEmojiSelect:o,onCustomEmojiSelect:a,addRecentEmoji:r,addRecentCustomEmoji:l})=>{const c=(0,s.li)(),{shouldRender:d,transitionClassNames:h}=(0,je.A)(e,void 0,void 0,!1),m=(0,Ui.A)(t.length?[...t,...i]:void 0,350)||[];(0,An.A)(c);const{observe:u}=(0,Za.BL)({rootRef:c,throttleMs:200,isDisabled:!e}),p=(0,T.A)(e=>{o(e.native),r({emoji:e.id})}),v=(0,T.A)(e=>{a(e),l({documentId:e.id})}),g=(0,T.A)(e=>{"native"in e?p(e):v(e)}),A=(0,T.A)((e,t)=>{o(e),r({emoji:t})}),f=(0,T.A)(e=>{a(e),l({documentId:e.id})}),b=ap({isActive:e,isHorizontal:!0,items:m,shouldRemoveSelectionOnReset:!0,onSelect:g,onClose:n});(0,F.A)(([e])=>{void 0!==e&&-1!==e&&function(e,t){const i=t.current;if(!i)return;const{visibleIndexes:s,allElements:n}=np(i,".EmojiButton",8,!0,!0,!0);if(!n.length||!n[e])return;const o=s[0];if(!s.includes(e)||e===o&&!sp(i,n[o],!0)){const t="start"==(e>s[s.length-1]?"start":"end")?44*e:0;(0,uo.A)(i,t)}}(b,c)},[b]);const C=(0,ge.A)("EmojiTooltip composer-tooltip no-scrollbar",h);return(0,se.Y)("div",{ref:c,className:C,children:d&&m?m.map((e,t)=>"native"in e?(0,se.Y)(bp,{emoji:e,focus:b===t,onClick:A},e.id):(0,se.Y)(ev,{emoji:e,focus:b===t,onClick:f,observeIntersection:u},e.id)):d?(0,se.Y)(Ds.A,{}):void 0})}),iv=(0,s.ph)(({title:e,description:t,thumbnail:i,thumbUrl:s,focus:n,transitionClassNames:o="",onClick:a})=>{let r;const c=(0,q.A)(i?(0,l.cy)(i):void 0);return(s=s||c)?r=(0,se.Y)("img",{src:s,className:o,alt:"",decoding:"async",draggable:!1}):e&&(r=(0,bn.Qh)(e,1)),(0,se.FD)(li.A,{focus:n,className:(0,ge.A)("BaseResult chat-item-clickable","string"==typeof r&&"with-text"),onMouseDown:rr.u,onClick:a,children:[(0,se.Y)("span",{className:"thumb",children:"string"==typeof r?(0,Pt.A)(r):r}),(0,se.FD)("div",{className:"content-inner",children:[e&&(0,se.Y)("div",{className:"title",children:e}),t&&(0,se.Y)("div",{className:"description",children:t})]})]})}),sv=(0,s.ph)(({focus:e,inlineResult:t,onClick:i})=>{const{title:s,description:n}=t,o="url"in t?t.url:void 0,a="webThumbnail"in t?t.webThumbnail:void 0,r=(0,T.A)(()=>{i(t)});return(0,se.Y)(iv,{focus:e,thumbnail:a,title:s||o,description:n,onClick:r})}),nv=(0,s.ph)(({inlineResult:e,isSavedMessages:t,canSendGifs:i,observeIntersection:s,onClick:n})=>{const{gif:o}=e,a=(0,T.A)((t,i,s)=>{n(e,i,s)});if(o)return(0,se.Y)(Bp,{gif:o,observeIntersection:s,className:"chat-item-clickable",onClick:i?a:void 0,isSavedMessages:t})}),ov=(0,s.ph)(({focus:e,isForGallery:t,inlineResult:i,onClick:s})=>{let n,o,a;"photo"in i&&(n=i.photo),"thumbnail"in i&&(o=i.thumbnail),"webThumbnail"in i&&(a=i.webThumbnail);const r=(0,q.A)((0,l.cy)(a)),c=(0,q.A)(n&&(0,l.rI)(n,"pictogram")),d=(0,Mi.A)(c||r),h=(0,T.A)(()=>{s(i)});if(t)return(0,se.FD)("div",{className:"MediaResult chat-item-clickable",onClick:h,children:[(0,se.Y)("img",{src:n?.thumbnail?.dataUri||r,alt:"",draggable:!1}),(0,se.Y)("img",{src:c,className:(0,ge.A)("full-media",d),alt:"",draggable:!1})]});const{title:m,description:u}=i;return(0,se.Y)(iv,{focus:e,thumbnail:a,thumbUrl:c||o?.dataUri,transitionClassNames:d,title:m,description:u,onClick:h})}),av=(0,s.ph)(({inlineResult:e,isSavedMessages:t,observeIntersection:i,onClick:s,isCurrentUserPremium:n})=>{const{sticker:o}=e;if(o)return(0,se.Y)(dr,{sticker:o,size:a.mD0,observeIntersection:i,title:o.emoji,className:"chat-item-clickable",onClick:s,clickArg:e,isSavedMessages:t,canViewSet:!0,noShowPremium:!0,isCurrentUserPremium:n})}),rv=(0,be.nF)(e=>e(),500,!0),lv=(0,s.ph)(({isOpen:e,botId:t,isGallery:i,inlineBotResults:a,switchPm:r,switchWebview:l,isSavedMessages:c,canSendGifs:d,loadMore:h,onClose:u,onSelectResult:p,isCurrentUserPremium:v})=>{const{openChat:g,startBot:A,requestSimpleWebView:f}=(0,n.ko)(),b=(0,s.li)(),{shouldRender:C,transitionClassNames:y}=(0,je.A)(e,void 0,void 0,!1),S=(0,Si.A)(i,C),{observe:N}=(0,Za.BL)({rootRef:b,debounceMs:200,isDisabled:!e}),k=(0,T.A)(({direction:e})=>{e===o.TN.Backwards&&rv(h)}),w=ap({isActive:e,shouldRemoveSelectionOnReset:S,noArrowNavigation:S,items:a,onSelect:p,onClose:u});(0,s.vJ)(()=>{op(".chat-item-clickable",w,b)},[w]);const I=(0,T.A)(()=>{g({id:t}),A({botId:t,param:r.startParam})}),P=(0,T.A)(()=>{const e=(0,Cn.A)();f({botId:t,url:l.url,buttonText:l.text,theme:e,isFromSwitchWebView:!0})}),Y=(0,K.A)(a?.length?a:void 0,C),F=a?.length?a:Y;if(!C||!(F?.length||r||l))return;const D=(0,ge.A)("InlineBotTooltip composer-tooltip",m.TF?"no-scrollbar":"custom-scroll",S&&"gallery",y);return(0,se.FD)(ls.A,{ref:b,className:D,items:F,itemSelector:".chat-item-clickable",noFastList:!0,onLoadMore:k,sensitiveArea:160,children:[r&&(0,se.Y)(li.A,{ripple:!0,className:"switch-pm scroll-item",onClick:I,children:(0,se.Y)("span",{className:"title",children:r.text})}),l&&(0,se.Y)(li.A,{ripple:!0,className:"switch-pm scroll-item",onClick:P,children:(0,se.Y)("span",{className:"title",children:l.text})}),Boolean(F?.length)&&F.map((e,t)=>{switch(e.type){case"gif":return(0,se.Y)(nv,{inlineResult:e,observeIntersection:N,onClick:p,isSavedMessages:c,canSendGifs:d},e.id);case"photo":return(0,se.Y)(ov,{isForGallery:S,inlineResult:e,onClick:p},e.id);case"sticker":return(0,se.Y)(av,{inlineResult:e,observeIntersection:N,onClick:p,isSavedMessages:c,isCurrentUserPremium:v},e.id);case"video":case"file":case"game":return(0,se.Y)(ov,{focus:w===t,inlineResult:e,onClick:p},e.id);case"article":case"audio":case"voice":return(0,se.Y)(sv,{focus:w===t,inlineResult:e,onClick:p},e.id);default:return}})]})}),cv=(0,s.ph)(({isOpen:e,chatId:t,selectedSendAsId:i,sendAsPeerIds:o,isCurrentUserPremium:a,onClose:r})=>{const{saveDefaultSendAs:l,showNotification:c}=(0,n.ko)(),d=(0,n.mS)().users.byId,h=(0,n.mS)().chats.byId,u=(0,B.A)(),p=(0,s.li)(),[v,g,A]=(0,Ap.A)(e,r,void 0);(0,s.vJ)(()=>{e&&A()},[e,A]);const f=(0,T.A)(e=>{r(),l({chatId:t,sendAsId:e})}),b=ap({isActive:e,items:o,onSelect:f,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:r});return(0,s.vJ)(()=>{op(".chat-item-clickable",b,p)},[b]),(0,s.vJ)(()=>{o&&!o.length&&r()},[o,r]),(0,se.FD)(Ze.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:r,className:"SendAsMenu",onCloseAnimationEnd:r,onMouseEnter:m.TF?void 0:v,onMouseLeave:m.TF?void 0:g,noCloseOnBackdrop:!m.TF,noCompact:!0,children:[(0,se.Y)("div",{className:"send-as-title",dir:"auto",children:u("SendMessageAsTitle")}),d&&h&&o?.map(({id:e,isPremium:t},s)=>{const n=d[e],o=h[e],r=n||o,l=(0,ge.A)(i===e&&"selected");return(0,se.FD)(li.A,{className:"SendAsItem chat-item-clickable scroll-item with-avatar",onClick:()=>{!t||a?f(e):c({message:u("SelectSendAsPeerPremiumHint"),actionText:u("Open"),action:{action:"openPremiumModal",payload:{}}})},focus:b===s,rightElement:!a&&t&&(0,se.Y)(he.A,{name:"lock-badge",className:"send-as-icon-locked"}),children:[(0,se.Y)(Yt.A,{size:"small",peer:r,className:l}),(0,se.FD)("div",{className:"info",children:[r&&(0,se.Y)(Ms.A,{peer:r,noFake:!0}),(0,se.Y)("span",{className:"subtitle",children:n?u("VoipGroupPersonalAccount"):u("Subscribers",o?.membersCount,"i")})]})]},e)})]})}),dv=(0,s.ph)((0,n.EK)((e,{stickerSetId:t})=>({set:(0,c.ycM)(e,t),shouldPlay:(0,c.ML4)(e),isCurrentUserPremium:(0,c.g29)(e)}))(({stickerSetId:e,observeIntersection:t,set:i,shouldPlay:o,isModalOpen:r,isCurrentUserPremium:l})=>{const{loadStickers:c,toggleStickerSet:d,openStickerSet:h}=(0,n.ko)(),m=(0,s.li)(),u=(0,B.A)(),p=i&&!i.isArchived&&Boolean(i.installedDate),v=Boolean(i?.stickers),g=(0,s.Kr)(()=>{if(!i)return[];const e=(i.stickers?.filter(({hasEffect:e})=>e)??[]).slice(0,3),t=(i.covers||[]).map(({id:e})=>e),s=i.stickers?i.stickers.filter(({id:e})=>!t.includes(e)):[];return[...e,...i.covers||[],...s].slice(0,5)},[i]);(0,s.vJ)(()=>{!v&&g.length<5&&i&&c({stickerSetInfo:{shortName:i.shortName}})},[v,g.length,c,i,e]);const A=(0,s.hb)(()=>{d({stickerSetId:e})},[d,e]),f=(0,s.hb)(e=>{h({stickerSetInfo:e.stickerSetInfo})},[h]);if(!i)return;const b=g.length>0;return(0,se.FD)("div",{className:"sticker-set",dir:u.isRtl?"rtl":void 0,children:[(0,se.FD)("div",{className:"sticker-set-header",children:[(0,se.FD)("div",{className:"title-wrapper",children:[(0,se.Y)("h3",{className:"title",dir:"auto",children:i.title}),(0,se.Y)("p",{className:"count",dir:"auto",children:u("Stickers",i.count,"i")})]}),(0,se.Y)(X.A,{className:p?"is-added":void 0,color:"primary",size:"tiny",pill:!0,fluid:!0,onClick:A,children:u(p?"Stickers.Installed":"Stickers.Install")})]}),(0,se.FD)("div",{className:"sticker-set-main shared-canvas-container",children:[(0,se.Y)("canvas",{ref:m,className:"shared-canvas"}),!b&&(0,se.Y)(Ue.A,{}),b&&g.map(e=>(0,se.Y)(dr,{sticker:e,size:a.Rqe,observeIntersection:t,noPlay:!o||r,clickArg:e,onClick:f,noContextMenu:!0,isCurrentUserPremium:l,sharedCanvasRef:m}))]})]},i.id)})),hv=(0,be.nF)(e=>e(),6e4,!0),mv=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.BmE)(e),{query:i,resultIds:s}=t||{},{featured:n}=e.stickers;return{query:i,featuredIds:n.setIds,resultIds:s,isModalOpen:Boolean((0,c.nTw)(e).openedStickerSetShortName)}})(({isActive:e,query:t,featuredIds:i,resultIds:o,isModalOpen:a,onClose:r})=>{const{loadFeaturedStickers:l}=(0,n.ko)(),c=(0,s.li)(),d=(0,B.A)(),{observe:h}=(0,Za.BL)({rootRef:c,throttleMs:200});return(0,s.vJ)(()=>{hv(()=>{l()})}),(0,Ne.A)({isActive:e,onBack:r}),(0,se.Y)("div",{ref:c,className:"StickerSearch custom-scroll",dir:d.isRtl?"rtl":void 0,children:function(){if(void 0!==t)return!t&&i?i.map(e=>(0,se.Y)(dv,{stickerSetId:e,observeIntersection:h,isModalOpen:a},e)):o?o.length?o.map(e=>(0,se.Y)(dv,{stickerSetId:e,observeIntersection:h,isModalOpen:a},e)):(0,se.Y)("p",{className:"helper-text",dir:"auto",children:"Nothing found."}):(0,se.Y)(Ds.A,{})}()})})),uv=(0,s.ph)((0,n.EK)(e=>{const t=(0,c.Wy7)(e),{query:i,results:s}=t||{},{chatId:n,threadId:o}=(0,c.Xf0)(e)||{},a=n?(0,c.hds)(e,n):void 0,r=n?(0,c.AWZ)(e,n):void 0,d=a?(0,c.ALW)(e,a):void 0,h=Boolean(n)&&(0,c.nZ4)(e,n),m=n&&o?(0,c.Vw0)(e,n,o):void 0,u=Boolean(!m?.isCommentsInfo&&m?.fromChannelId),p=n&&o?(0,c.S0q)(e,n,o):void 0;return{query:i,results:s,chat:a,chatFullInfo:r,isChatWithBot:d,isSavedMessages:h,canPostInChat:Boolean(a)&&Boolean(o)&&(0,l.__)(a,p,u,r),canScheduleUntilOnline:Boolean(n)&&(0,c.RBq)(e,n),currentMessageList:(0,c.Xf0)(e)}})(({isActive:e,query:t,results:i,chat:o,chatFullInfo:a,isChatWithBot:r,canScheduleUntilOnline:c,isSavedMessages:d,canPostInChat:h,currentMessageList:u,onClose:p})=>{const{searchMoreGifs:v,sendMessage:g,setGifSearchQuery:A}=(0,n.ko)(),f=(0,s.li)(),[b,C]=(0,hu.A)(c),{observe:y}=(0,Za.BL)({rootRef:f,debounceMs:300}),S=h&&(0,l.Q_)(o,a,r,d).canSendGifs,N=(0,s.hb)((e,t,i)=>{if(S){if(!u)return;i?b((i,s)=>{g({messageList:u,gif:e,scheduledAt:i,scheduleRepeatPeriod:s,isSilent:t})}):g({messageList:u,gif:e,isSilent:t})}m.TF&&A({query:void 0})},[S,u,b]),k=(0,s.hb)(()=>{v()},[v]),w=(0,B.A)();(0,Ne.A)({isActive:e,onBack:p});const I=Boolean(void 0!==t&&i&&i.length);return(0,se.FD)("div",{className:"GifSearch",dir:w.isRtl?"rtl":void 0,children:[(0,se.Y)(ls.A,{ref:f,className:(0,ge.A)("gif-container custom-scroll",I&&"grid"),items:i,itemSelector:".GifButton",preloadBackwards:96,noFastList:!0,onLoadMore:k,children:function(){if(void 0!==t)return i?i.length?i.map(e=>(0,se.Y)(Bp,{gif:e,observeIntersection:y,onClick:S?N:void 0,isSavedMessages:d},e.id)):(0,se.Y)("p",{className:"helper-text",dir:"auto",children:w("NoGIFsFound")}):(0,se.Y)(Ds.A,{})}()}),C]})}));var pv=i(75319),vv=i(71950);const gv="OAKzmAva",Av="BQ6HUOqN",fv="U96CW2I7",bv="vXi2JQlj",Cv="bi3fL59p",yv="GUK4ajPK",Sv="YH6jeZIh",Nv="q1LnuIUn",kv="PJZzyVLK",wv="C7NpG5Y9",Iv=(0,s.ph)(function({postStatistic:e}){const t=(0,B.A)(),i=(0,Fi.A)();return(0,se.FD)("div",{className:Sv,children:[e.reactionsCount>0&&(0,se.FD)("span",{className:Nv,children:[(0,se.Y)(he.A,{name:"heart-outline",className:kv}),(0,bn.Vw)(i,e.reactionsCount)]}),e.forwardsCount>0&&(0,se.FD)("span",{className:Nv,children:[(0,se.Y)(he.A,{name:"forward",className:kv}),(0,bn.Vw)(i,e.forwardsCount)]}),!e.forwardsCount&&!e.reactionsCount&&t("ChannelStats.SharesCount_ZeroValueHolder")]})});function Pv(e,t,i,s){return i?(0,se.FD)("span",{children:[(0,se.Y)("img",{src:i,alt:"",draggable:!1,className:(0,ge.A)(fv,s&&"yxjDeIct")}),(0,l.zX)(t)&&(0,se.Y)(he.A,{name:"play"}),(0,A.C)(e,t,!0)]}):(0,A.C)(e,t)}const Yv=(0,s.ph)(({postStatistic:e,message:t})=>{const i=(0,Fi.A)(),{toggleMessageStatistics:o}=(0,n.ko)(),a=(0,Ec.A)(t),r=(0,xc.A)(t,"micro"),c=(0,q.A)(r),d=Boolean((0,l.lk)(t)),h=(0,s.hb)(()=>{o({messageId:t.id})},[o,t.id]);return(0,se.FD)("div",{className:(0,ge.A)(gv,Boolean(c||a)&&Av),onClick:h,children:[(0,se.FD)("div",{className:Cv,children:[(0,se.Y)("div",{className:bv,children:Pv(i,t,c||a,d)}),(0,se.Y)("div",{className:Sv,children:i("ChannelStatsViewsCount",{count:e.viewsCount},{pluralValue:e.viewsCount})})]}),(0,se.FD)("div",{className:yv,children:[(0,se.Y)("div",{className:wv,children:(0,We.L2)(1e3*t.date,i.code)}),(0,se.Y)(Iv,{postStatistic:e})]})]})});function Fv(e,t,i){return(0,se.FD)("span",{children:[i?(0,se.Y)("span",{className:"TmJvv2A6",children:(0,se.Y)("img",{src:i,alt:"",draggable:!1,className:(0,ge.A)(fv,"cdfiLmXo","BOfHPv20")})}):(0,se.Y)(Yt.A,{peer:t,size:"small",className:fv,withStorySolid:!0,forceUnreadStorySolid:!0}),e("Story")]})}const Dv=(0,s.ph)(function({chat:e,story:t,postStatistic:i}){const s=(0,B.A)(),{toggleStoryStatistics:o}=(0,n.ko)(),a=t&&"content"in t,r=a?t.content.video:void 0,c=a?(0,l.EN)(t):void 0,d=(0,q.A)(c),h=d||r?.thumbnail?.dataUri,m=(0,T.A)(()=>{o({storyId:i.storyId})});return(0,se.FD)("div",{className:(0,ge.A)(gv,Av),onClick:m,children:[(0,se.FD)("div",{className:Cv,children:[(0,se.Y)("div",{className:bv,children:Fv(s,e,d||h)}),(0,se.Y)("div",{className:Sv,children:s("ChannelStats.ViewsCount",i.viewsCount,"i")})]}),(0,se.FD)("div",{className:yv,children:[(0,se.Y)("div",{className:wv,children:a&&Boolean(t.date)&&(0,We.L2)(1e3*t.date,s.code)}),(0,se.Y)(Iv,{postStatistic:i})]})]})}),Mv="T1l_4J8z",Tv="S1x1ovkC",Bv="WxL3i5PM",Lv="aUrozL5_",Rv="QQHwjG88",xv="QGctP1Nk";let Ev,Vv;const _v={growthGraph:"ChannelStats.Graph.Growth",followersGraph:"ChannelStats.Graph.Followers",muteGraph:"ChannelStats.Graph.Notifications",topHoursGraph:"ChannelStats.Graph.ViewsByHours",viewsBySourceGraph:"ChannelStats.Graph.ViewsBySource",newFollowersBySourceGraph:"ChannelStats.Graph.NewFollowersBySource",languagesGraph:"ChannelStats.Graph.Language",interactionsGraph:"ChannelStats.Graph.Interactions",reactionsByEmotionGraph:"ChannelStats.Graph.Reactions",storyInteractionsGraph:"ChannelStats.Graph.Stories",storyReactionsByEmotionGraph:"ChannelStats.Graph.StoriesReactions"},Uv=Object.keys(_v),Ov={growthGraph:"Stats.GroupGrowthTitle",membersGraph:"Stats.GroupMembersTitle",languagesGraph:"Stats.GroupLanguagesTitle",messagesGraph:"Stats.GroupMessagesTitle",actionsGraph:"Stats.GroupActionsTitle",topHoursGraph:"Stats.GroupTopHoursTitle"},Kv=Object.keys(Ov),Jv=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.gqw)(e,t),s=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t)?.statisticsDcId,o="chatTypeSuperGroup"===s?.type,a=(0,c.zeq)(e,t),r=(0,c._bp)(e,t)?.byId;return{statistics:i,dcId:n,isGroup:o,chat:s,messagesById:a,storiesById:r}})(({chatId:e,chat:t,statistics:o,dcId:a,isGroup:r,messagesById:l,storiesById:c})=>{const d=(0,B.A)(),h=(0,s.li)(),[m,u]=(0,s.J0)(!1),p=(0,s.li)(new Set),v=(0,s.li)(new Set),{loadStatistics:g,loadStatisticsAsyncGraph:A}=(0,n.ko)(),f=(0,M.A)();(0,s.vJ)(()=>{g({chatId:e,isGroup:r})},[e,g,r]);const b=(0,s.Kr)(()=>r?Kv:Uv,[r]),C=(0,s.Kr)(()=>r?Ov:_v,[r]);return(0,s.vJ)(()=>{o&&b.forEach(t=>{const i=o[t];(0,pv.R)(i)&&"async"===i.graphType&&A({name:t,chatId:e,token:i.token,isPercentage:"languagesGraph"===t})})},[b,e,o,A]),(0,s.vJ)(()=>{(async()=>{await async function(){return Ev||(Ev=i.e(4810).then(i.bind(i,24810)),Vv=await Ev),Ev}(),m?o&&h.current&&(b.forEach((e,t)=>{const i=o[e];if(!(0,pv.R)(i))return;const s="async"===i.graphType,n="error"===i.graphType;if(s||p.current.has(e))return;if(n)return p.current.add(e),void v.current.add(e);const{zoomToken:r}=i;Vv.create(h.current.children[t],{title:d(C[e]),...r?{onZoom:e=>(0,Pn.px)("fetchStatisticsAsyncGraph",{token:r,x:e,dcId:a}),zoomOutLabel:d("Graph.ZoomOut")}:{},...i}),p.current.add(e),h.current.children[t].classList.remove(xv)}),f()):u(!0)})()},[b,C,m,o,d,e,A,a,f]),(0,se.FD)("div",{className:(0,ge.A)(Mv,"panel-content custom-scroll",m&&Lv),children:[o&&(0,se.Y)(vv.A,{statistics:o,type:r?"group":"channel",title:d("StatisticOverview")}),!p.current.size&&(0,se.Y)(Ds.A,{}),(0,se.Y)("div",{ref:h,children:b.map(e=>{const t=p.current.has(e)&&!v.current.has(e);return(0,se.Y)("div",{className:(0,ge.A)(Rv,!t&&xv)})})}),Boolean(o?.recentPosts?.length)&&(0,se.FD)("div",{className:"suY9dEIz",children:[(0,se.Y)("h2",{className:"evQIkAqx",children:d("ChannelStats.Recent.Header")}),o.recentPosts.map(e=>{if("msgId"in e){const t=l[e.msgId];if(!t||!("content"in t))return;return(0,se.Y)(Yv,{message:t,postStatistic:e},`statistic_message_${e.msgId}`)}if("storyId"in e&&t){const i=c?.[e.storyId];return(0,se.Y)(Dv,{chat:t,story:i,postStatistic:e},`statistic_story_${e.storyId}`)}})]})]})})),Gv="oXLpD4Y4",jv="paQ2VBe_",zv="WvFuOAIf",Hv=(0,s.ph)(({data:e})=>{const t=(0,B.A)(),{openChatByUsername:i}=(0,n.ko)(),o=(0,s.Kr)(()=>e.chat?(0,l.Kl)(e.chat):void 0,[e.chat]),a=(0,s.hb)(()=>{i({username:o,messageId:e.messageId})},[e.messageId,i,o]);return(0,se.FD)("div",{className:(0,ge.A)(Gv,"statistic-public-forward"),onClick:a,children:[(0,se.Y)(Yt.A,{size:"medium",peer:e.chat}),(0,se.FD)("div",{children:[(0,se.Y)("div",{className:jv,children:e.title}),(0,se.Y)("div",{className:zv,children:t("ChannelStats.ViewsCount",e.views,"i")})]})]})});let $v,qv;const Wv={viewsGraph:"Stats.MessageInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Qv=Object.keys(Wv),Zv=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.AWZ)(e,t)?.statisticsDcId,s=(0,c.nTw)(e);return{statistics:s.statistics.currentMessage,dcId:i,messageId:s.statistics.currentMessageId}})(function({chatId:e,isActive:t,statistics:a,dcId:r,messageId:l}){const c=(0,B.A)(),d=(0,s.li)(),[h,m]=(0,s.J0)(!1),u=(0,s.li)(new Set),p=(0,s.li)(new Set),{loadMessageStatistics:v,loadMessagePublicForwards:g,loadStatisticsAsyncGraph:A}=(0,n.ko)(),f=(0,M.A)();(0,s.vJ)(()=>{l&&v({chatId:e,messageId:l})},[e,v,l]),(0,s.vJ)(()=>{t&&!l||(u.current.clear(),p.current.clear(),m(!1))},[t,l]),(0,s.vJ)(()=>{a&&Qv.forEach(t=>{const i=a[t];(0,pv.R)(i)&&"async"===i.graphType&&A({name:t,chatId:e,token:i.token})})},[e,a,A]),(0,s.vJ)(()=>{(async()=>{await async function(){return $v||($v=i.e(4810).then(i.bind(i,24810)),qv=await $v),$v}(),h?a&&d.current&&(Qv.forEach((e,t)=>{const i=a[e];if(!(0,pv.R)(i))return;const s="async"===i.graphType,n="error"===i.graphType;if(s||u.current.has(e))return;if(n)return u.current.add(e),void p.current.add(e);const{zoomToken:o}=i;qv.create(d.current.children[t],{title:c(Wv[e]),...o?{onZoom:e=>(0,Pn.px)("fetchStatisticsAsyncGraph",{token:o,x:e,dcId:r}),zoomOutLabel:c("Graph.ZoomOut")}:{},...i}),u.current.add(e)}),f()):m(!0)})()},[h,a,c,e,l,A,r,f]);const b=(0,T.A)(({direction:t})=>{t===o.TN.Backwards&&l&&g({chatId:e,messageId:l})});return h&&a&&l?(0,se.FD)("div",{className:(0,ge.A)(Mv,"custom-scroll",h&&Lv),children:[(0,se.Y)(vv.A,{statistics:a,type:"message",title:c("StatisticOverview")}),(!u.current.size||!a.publicForwardsData)&&(0,se.Y)(Ds.A,{}),(0,se.Y)("div",{ref:d,children:Qv.map(e=>{const t=u.current.has(e)&&!p.current.has(e);return(0,se.Y)("div",{className:(0,ge.A)(Rv,!t&&xv)})})}),Boolean(a.publicForwards)&&(0,se.FD)("div",{className:Tv,children:[(0,se.Y)("h2",{className:Bv,children:c("Stats.Message.PublicShares")}),(0,se.Y)(ls.A,{items:a.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:b,noFastList:!0,children:a.publicForwardsData.map(e=>(0,se.Y)(Hv,{data:e},e.messageId))})]})]},`${e}-${l}`):(0,se.Y)(Ds.A,{})})),Xv=(0,s.ph)(function({data:e,chatsById:t,usersById:i}){const s=(0,B.A)(),{openChat:o}=(0,n.ko)(),a=i[e.peerId],r=t[e.peerId],c=(0,T.A)(()=>{o({id:a.id})});return(0,se.FD)("div",{className:(0,ge.A)(Gv,"statistic-public-forward"),onClick:c,children:[(0,se.Y)(Yt.A,{size:"medium",peer:a||r,withStorySolid:!0,forceUnreadStorySolid:!0}),(0,se.FD)("div",{children:[(0,se.Y)("div",{className:jv,children:a?(0,l.Yg)(a):(0,l.Js)(s,r)}),(0,se.Y)("div",{className:zv,children:e.viewsCount?s("ChannelStats.ViewsCount",e.viewsCount,"i"):s("NoViews")})]})]})});let eg,tg;const ig={viewsGraph:"Stats.StoryInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},sg=Object.keys(ig),ng=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.AWZ)(e,t)?.statisticsDcId,s=(0,c.nTw)(e),n=s.statistics.currentStory,o=s.statistics.currentStoryId,{byId:a}=e.users,{byId:r}=e.chats;return{statistics:n,dcId:i,storyId:o,usersById:a,chatsById:r}})(function({chatId:e,isActive:t,statistics:o,dcId:a,storyId:r,chatsById:l,usersById:c}){const d=(0,B.A)(),h=(0,s.li)(),[m,u]=(0,s.J0)(!1),p=(0,s.li)(new Set),v=(0,s.li)(new Set),{loadStoryStatistics:g,loadStoryPublicForwards:A,loadStatisticsAsyncGraph:f}=(0,n.ko)(),b=(0,M.A)();(0,s.vJ)(()=>{r&&g({chatId:e,storyId:r})},[e,r]),(0,s.vJ)(()=>{t&&!r||(p.current.clear(),v.current.clear(),u(!1))},[t,r]),(0,s.vJ)(()=>{o&&sg.forEach(t=>{const i=o[t];(0,pv.R)(i)&&"async"===i.graphType&&f({name:t,chatId:e,token:i.token})})},[e,o,f]),(0,s.vJ)(()=>{(async()=>{await async function(){return eg||(eg=i.e(4810).then(i.bind(i,24810)),tg=await eg),eg}(),m?o&&h.current&&(sg.forEach((e,t)=>{const i=o[e];if(!(0,pv.R)(i))return;const s="async"===i.graphType,n="error"===i.graphType;if(s||p.current.has(e))return;if(n)return p.current.add(e),void v.current.add(e);const{zoomToken:r}=i;tg.create(h.current.children[t],{title:d(ig[e]),...r?{onZoom:e=>(0,Pn.px)("fetchStatisticsAsyncGraph",{token:r,x:e,dcId:a}),zoomOutLabel:d("Graph.ZoomOut")}:{},...i}),p.current.add(e)}),b()):u(!0)})()},[m,o,d,e,r,f,a,b]);const C=(0,T.A)(()=>{r&&A({chatId:e,storyId:r})});return m&&o&&r?(0,se.FD)("div",{className:(0,ge.A)(Mv,"custom-scroll",m&&Lv),children:[(0,se.Y)(vv.A,{statistics:o,type:"story",title:d("StatisticOverview")}),!p.current.size&&(0,se.Y)(Ds.A,{}),(0,se.Y)("div",{ref:h,children:sg.map(e=>{const t=p.current.has(e)&&!v.current.has(e);return(0,se.Y)("div",{className:(0,ge.A)(Rv,!t&&xv)})})}),Boolean(o.publicForwards)&&(0,se.FD)("div",{className:Tv,children:[(0,se.Y)("h2",{className:Bv,children:d("Stats.Message.PublicShares")}),(0,se.Y)(ls.A,{items:o.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:C,noFastList:!0,children:o.publicForwardsData.map(e=>"messageId"in e?(0,se.Y)(Hv,{data:e},`message_${e.messageId}`):(0,se.Y)(Xv,{data:e,chatsById:l,usersById:c},`story_${e.storyId}`))})]})]},`${e}-${r}`):(0,se.Y)(Ds.A,{})}));var og=i(55573);const ag=(0,s.ph)((0,n.EK)((e,{answer:t})=>{const{voters:i,offsets:s}=(0,c.nTw)(e).pollResults;return{voters:i?.[t.option],offset:s?.[t.option]||""}})(({chat:e,message:t,answer:i,answerVote:o,totalVoters:a,voters:r,offset:l})=>{const{loadPollOptionResults:c,openChat:d,closePollResults:h}=(0,n.ko)(),m=(0,K.A)(o.votersCount),[u,p]=(0,s.J0)(!0),g=Boolean(r),{option:A,text:f}=i,b=(0,B.A)();(0,s.vJ)(()=>{g&&m===o.votersCount||c({chat:e,messageId:t.id,option:A,offset:l,limit:4,shouldResetVoters:!0})},[o.votersCount,g]);const C=(0,s.hb)(()=>{p(!0),c({chat:e,messageId:t.id,option:A,offset:l,limit:50})},[e,c,t.id,l,A]);(0,s.vJ)(()=>{p(!1)},[r]);const y=(0,s.hb)(e=>{d({id:e}),h()},[h,d]);return(0,se.FD)("div",{className:"PollAnswerResults",children:[(0,se.FD)("div",{className:"poll-voters",children:[r?r.map(e=>(0,se.Y)(li.A,{className:"chat-item-clickable",onClick:()=>y(e),children:(0,v.L8)(e)?(0,se.Y)(ms.A,{avatarSize:"tiny",userId:e,forceShowSelf:!0,noStatusOrTyping:!0}):(0,se.Y)(hs.A,{avatarSize:"tiny",chatId:e,noStatusOrTyping:!0})},e)):(0,se.Y)(Ds.A,{}),r&&function(){const e=o.votersCount-r.length;return o.votersCount>4&&e>0&&(0,se.Y)(og.A,{count:e,itemName:"voter",isLoading:u,onClick:C})}()]}),(0,se.FD)("div",{className:"answer-head",dir:b.isRtl?"rtl":void 0,children:[(0,se.Y)("span",{className:"answer-title",dir:"auto",children:(0,Oi.fd)({text:f.text,entities:f.entities})}),(0,se.FD)("span",{className:"answer-percent",dir:b.isRtl?"auto":void 0,children:[(S=o.votersCount,N=a,N>0?(S/N*100).toFixed():0),"%"]})]})]});var S,N})),rg=(0,s.ph)((0,n.EK)(e=>{const{pollResults:{chatId:t,messageId:i}}=(0,c.nTw)(e),s=t?(0,c.hds)(e,t):void 0,n=t&&i?(0,c.O5q)(e,t,i):void 0;return{chat:s,message:n,poll:n&&(0,c.zcZ)(e,n)}})(({isActive:e,chat:t,message:i,poll:s,onClose:n})=>{const o=(0,B.A)();if((0,Ne.A)({isActive:e,onBack:n}),!i||!s||!t)return(0,se.Y)(Ds.A,{});const{summary:a,results:r}=s;if(!r.results)return;const l=(0,di.dU)(r.results,"option");return(0,se.FD)("div",{className:"PollResults",dir:o.isRtl?"rtl":void 0,children:[(0,se.Y)("h3",{className:"poll-question",dir:"auto",children:(0,Oi.fd)({text:a.question.text,entities:a.question.entities})}),(0,se.Y)("div",{className:"poll-results-list custom-scroll",children:a.answers.map(e=>(0,se.Y)(ag,{chat:t,message:i,answer:e,answerVote:l[e.option],totalVoters:r.totalVoters},`${s.id}-${e.option}`))})]})}));var lg=i(90603);const cg="xrnUE4e6",dg="z7kF7tij",hg="T6wFpdQO",mg="CWsWIKQ1",ug="KBl0ycLl",pg="iJ1U9kDD",vg="Rk6PT_yc",gg="qlo3vSEw",Ag="r06zwL42",fg=5*g.$,bg=(0,s.ph)((0,n.EK)(e=>{const{createTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,createTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}})(({isActive:e,chat:t,createTopicPanel:i,isCurrentUserPremium:o,onClose:r})=>{const{createTopic:l,openPremiumModal:c}=(0,n.ko)(),[d,h]=(0,s.J0)(""),[m,u]=(0,s.J0)(0),[p,v]=(0,s.J0)(void 0),g=(0,B.A)(),A=Boolean(d),f=Boolean(i?.isLoading);(0,Ne.A)({isActive:e,onBack:r}),(0,s.vJ)(()=>{e||(h(""),v(void 0))},[e]);const b=(0,s.hb)(e=>{h(e.target.value)},[]),C=(0,s.hb)(()=>{u(e=>(0,So.A)((0,lg.e$)().length,e+1))},[]),y=(0,s.hb)(()=>{l({chatId:t.id,title:d,iconColor:(0,lg.e$)()[m],iconEmojiId:p})},[t,l,m,p,d]),S=(0,s.hb)(e=>{e.isFree||o||e.id===a.MyF?e.id!==a.MyF?v(e.id):v(void 0):c({initialSection:"animated_emoji"})},[o,c]),N=(0,s.Kr)(()=>({id:0,title:d,iconColor:(0,lg.e$)()[m],iconEmojiId:p}),[m,p,d]);if(t?.isForum)return(0,se.FD)("div",{className:cg,children:[(0,se.FD)("div",{className:(0,ge.A)(dg,"custom-scroll"),children:[(0,se.FD)("div",{className:(0,ge.A)(hg,mg),children:[(0,se.Y)("span",{className:gg,children:g("CreateTopicTitle")}),(0,se.Y)(ae.Ay,{name:"zoomFade",activeKey:Number(N.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:pg,children:(0,se.Y)(Ts.A,{topic:N,className:(0,ge.A)(vg,"K1CTKtBS"),onClick:C,size:fg,noLoopLimit:!0})}),(0,se.Y)(ee.A,{value:d,onChange:b,label:g("lng_forum_topic_title"),disabled:f,teactExperimentControlled:!0})]}),(0,se.Y)("div",{className:(0,ge.A)(hg,ug),children:(0,se.Y)(Yr,{idPrefix:"create-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:S,className:Ag,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})})]}),(0,se.Y)(pi.A,{isShown:A,disabled:f,onClick:y,ariaLabel:g("Save"),iconName:"check",isLoading:f})]})})),Cg=5*g.$,yg=(0,s.ph)((0,n.EK)(e=>{const{editTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,topic:t?.chatId&&t?.topicId?(0,c.S0q)(e,t.chatId,t.topicId):void 0,editTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}})(({isActive:e,chat:t,topic:i,editTopicPanel:o,isCurrentUserPremium:r,onClose:l})=>{const{editTopic:c,openPremiumModal:d}=(0,n.ko)(),[h,m]=(0,s.J0)(""),[u,p]=(0,s.J0)(void 0),v=(0,B.A)(),g=Boolean(o?.isLoading),A=i?.id===a.HxB;(0,Ne.A)({isActive:e,onBack:l}),(0,s.vJ)(()=>{e||(m(""),p(void 0))},[e]),(0,s.vJ)(()=>{(i?.title||i?.iconEmojiId)&&(m(i.title),p(i.iconEmojiId))},[i]);const f=(0,s.Kr)(()=>h!==i?.title||u!==i?.iconEmojiId,[u,h,i?.iconEmojiId,i?.title]),b=(0,s.hb)(e=>{const t=e.target.value;m(t)},[]),C=(0,s.hb)(()=>{c({chatId:t.id,title:h,topicId:i.id,iconEmojiId:u})},[t,c,u,h,i]),y=(0,s.hb)(e=>{e.isFree||r||e.id===a.MyF?e.id!==a.MyF?p(e.id):p("0"):d({initialSection:"animated_emoji"})},[r,d]),S=(0,s.Kr)(()=>({...i,title:h,iconEmojiId:u}),[u,h,i]);if(t?.isForum)return(0,se.FD)("div",{className:cg,children:[(0,se.FD)("div",{className:(0,ge.A)(dg,"custom-scroll"),children:[!i&&(0,se.Y)(Ds.A,{}),i&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:(0,ge.A)(hg,mg,A&&"YftUWqqw"),children:[(0,se.Y)("span",{className:gg,children:v(A?"CreateGeneralTopicTitle":"CreateTopicTitle")}),(0,se.Y)(ae.Ay,{name:"zoomFade",activeKey:Number(S.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:pg,children:(0,se.Y)(Ts.A,{topic:S,className:vg,size:Cg,noLoopLimit:!0})}),(0,se.Y)(ee.A,{value:h,onChange:b,label:v("lng_forum_topic_title"),disabled:g,teactExperimentControlled:!0})]}),!A&&(0,se.Y)("div",{className:(0,ge.A)(hg,ug),children:(0,se.Y)(Yr,{idPrefix:"edit-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:y,className:Ag,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})})]})]}),(0,se.Y)(pi.A,{isShown:f,disabled:g,onClick:C,ariaLabel:v("Save"),iconName:"check",isLoading:g})]})})),Sg="Please provide name",Ng=(0,s.ph)((0,n.EK)((e,{userId:t})=>{const i=(0,c.yps)(e,t),s=(0,c.vGo)(e,t),{progress:n}=(0,c.nTw)(e).management,o=(0,bs.d)(e,"aboutLength");return{userId:t,user:i,progress:n,currentBio:s?.bio,maxBioLength:o}})(({userId:e,user:t,progress:i,currentBio:a,isActive:r,maxBioLength:c,onClose:d})=>{const{setBotInfo:h,uploadProfilePhoto:m,uploadContactProfilePhoto:u,startBotFatherConversation:p}=(0,n.ko)(),[v,g,A]=(0,D.A)(!1),[f,b,C]=(0,D.A)(!1),[y,S]=(0,s.J0)(),N=(0,B.A)(),k=(0,s.Kr)(()=>t?(0,l.Kl)(t):void 0,[t]);(0,Ne.A)({isActive:r,onBack:d});const w=t?(0,l.u0)(t):"",[I,P]=(0,s.J0)(),[Y,F]=(0,s.J0)(w||""),[M,L]=(0,s.J0)(a||""),R=t&&(0,l.cP)(t),x=(0,q.A)(R,!1,G.qZ.BlobUrl);(0,s.vJ)(()=>{A(),C()},[e]),(0,s.vJ)(()=>{F(w||""),L(a||"")},[w,a,t]),(0,s.vJ)(()=>{P(void 0)},[x]),(0,s.vJ)(()=>{i===o.TD.Complete&&(A(),C(),S(void 0))},[i]);const E=(0,T.A)(e=>{F(e.target.value),g(),y===Sg&&S(void 0)}),V=(0,T.A)(e=>{L(e.target.value),g()}),_=(0,T.A)(e=>{P(e),b()}),U=(0,T.A)(()=>{const e=Y.trim(),i=M.trim();e.length?(h({...v&&{bot:t,name:e,description:i}}),I&&m({file:I,...f&&{bot:t}})):S(Sg)}),O=(0,T.A)(()=>{p({param:`${k}-intro`})}),K=(0,T.A)(()=>{p({param:`${k}-commands`})}),J=(0,T.A)(()=>{p({param:k})}),j=(0,s.li)(),z=(0,s.li)(!1),H=(0,T.A)(t=>{b(),u({userId:e,file:t,isSuggest:z.current})});if(!t)return;const $=i===o.TD.InProgress;return(0,se.FD)("div",{className:"Management",children:[(0,se.FD)("div",{className:"custom-scroll",children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(Nh.A,{currentAvatarBlobUrl:x,onChange:_,title:N("ChatSetPhotoOrVideo"),disabled:$}),(0,se.Y)(ee.A,{id:"user-name",label:N("PaymentCheckoutName"),onChange:E,value:Y,error:y===Sg?y:void 0,teactExperimentControlled:!0}),(0,se.Y)(rn.A,{value:M,onChange:V,label:N("DescriptionPlaceholder"),disabled:$,maxLength:c,maxLengthIndicator:c?(c-M.length).toString():void 0})]}),(0,se.Y)("div",{className:"section",children:(0,se.FD)("div",{className:"dialog-buttons",children:[(0,se.Y)(li.A,{icon:"bot-commands-filled",ripple:!0,onClick:O,children:(0,se.Y)("span",{children:N("BotEditIntro")})}),(0,se.Y)(li.A,{icon:"bot-command",ripple:!0,onClick:K,children:(0,se.Y)("span",{children:N("BotEditCommands")})}),(0,se.Y)(li.A,{icon:"bots",ripple:!0,onClick:J,children:(0,se.Y)("span",{children:N("BotChangeSettings")})}),(0,se.Y)("div",{className:"section-info section-info_push",children:(0,Pt.A)(N("BotManageInfo"),["links"])})]})})]}),(0,se.Y)(pi.A,{isShown:v||f,onClick:U,disabled:$,ariaLabel:N("Save"),iconName:"check",isLoading:$}),(0,se.Y)(um.A,{onChange:H,inputRef:j})]})})),kg="Channel title can't be empty",wg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{management:s}=(0,c.nTw)(e),{progress:n}=s,{invites:o}=s.byChatId[t]||{},a=e.appConfig.channelAutoTranslationLevelMin,r=i?.hasAutoTranslation,d=i?.level,h=!(!d||!a)&&d>=a;return{chat:i,chatFullInfo:(0,c.AWZ)(e,t),progress:n,canChangeInfo:(0,l.ub)(i,"changeInfo"),canInvite:(0,l.ub)(i,"inviteUsers"),exportedInvites:o,availableReactions:e.reactions.availableReactions,hasAutoTranslation:r,canToggleAutoTranslation:h}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chatId:e,chat:t,chatFullInfo:i,progress:a,canChangeInfo:r,canInvite:d,exportedInvites:h,isActive:m,availableReactions:u,onScreenSelect:p,onClose:v,hasAutoTranslation:g,canToggleAutoTranslation:A})=>{const{updateChat:f,closeManagement:b,leaveChannel:C,deleteChannel:y,openChat:S,loadExportedChatInvites:N,loadChatJoinRequests:k,toggleAutoTranslation:w}=(0,n.ko)(),I=t?.title||"",P=i?.about||"",Y=Boolean(i?.linkedChatId),[F,M,L]=(0,D.A)(),[R,x]=(0,s.J0)(!1),[E,V]=(0,s.J0)(I),[_,U]=(0,s.J0)(P),[O,K]=(0,s.J0)(),[J,j]=(0,s.J0)(),z=t&&(0,l.cP)(t),H=(0,q.A)(z,!1,G.qZ.BlobUrl),$=(0,B.A)(),W=t&&(0,l.WX)(t),Q=(0,T.A)(()=>{w({chatId:e,isEnabled:!g})});(0,Ne.A)({isActive:m,onBack:v}),(0,s.vJ)(()=>{d&&(N({chatId:e}),N({chatId:e,isRevoked:!0}),k({chatId:e}))},[e,d]),(0,s.vJ)(()=>{a===o.TD.Complete&&(x(!1),j(void 0))},[a]);const Z=(0,s.Kr)(()=>Object.keys(i?.adminMembersById||{}).length,[i?.adminMembersById]),X=i?.kickedMembers?.length||0,te=(0,T.A)(()=>{p(o.je.ChatPrivacyType)}),ie=(0,T.A)(()=>{p(o.je.Discussion)}),ne=(0,T.A)(()=>{p(o.je.Reactions)}),oe=(0,T.A)(()=>{p(o.je.ChatAdministrators)}),ae=(0,T.A)(()=>{p(o.je.Invites)}),re=(0,T.A)(()=>{p(o.je.JoinRequests)}),le=(0,T.A)(e=>{K(e),x(!0)}),ce=(0,T.A)(e=>{V(e.target.value),x(!0)}),de=(0,T.A)(e=>{U(e.target.value),x(!0)}),he=(0,T.A)(()=>{const t=E.trim(),i=_.trim();t.length?f({chatId:e,title:t,about:i,photo:O}):j(kg)}),me=(0,T.A)(()=>{p(o.je.ChannelSubscribers)}),ue=(0,T.A)(()=>{p(o.je.ChannelRemovedUsers)}),pe=(0,T.A)(()=>{t.isCreator?y({chatId:t.id}):C({chatId:t.id}),L(),b(),S({id:void 0})}),ve=(0,s.Kr)(()=>{if(!i?.enabledReactions)return $("ReactionsOff");if("all"===i.enabledReactions.type)return $("ReactionsAll");const e=i.enabledReactions.allowed.length,t=u?.filter(e=>!e.isInactive).length||0;return t?`${e} / ${t}`:e.toString()},[u,i?.enabledReactions,$]),ge=(0,s.Kr)(()=>(0,l.gA)(t),[t]);if((0,c._ls)((0,n.mS)(),e)||t.isForbidden)return;const Ae=a===o.TD.InProgress;return(0,se.FD)("div",{className:"Management",children:[(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(Nh.A,{currentAvatarBlobUrl:H,onChange:le,disabled:!r}),(0,se.FD)("div",{className:"settings-edit",children:[(0,se.Y)(ee.A,{id:"channel-title",label:$("EnterChannelName"),onChange:ce,value:E,error:J===kg?J:void 0,disabled:!r}),(0,se.Y)(rn.A,{id:"channel-about",label:$("DescriptionPlaceholder"),onChange:de,value:_,maxLength:255,maxLengthIndicator:(255-_.length).toString(),disabled:!r,noReplaceNewlines:!0})]}),t.isCreator&&(0,se.FD)(li.A,{icon:"lock",multiline:!0,onClick:te,children:[(0,se.Y)("span",{className:"title",children:$("ChannelType")}),(0,se.Y)("span",{className:"subtitle",children:$(ge?"TypePublic":"TypePrivate")})]}),(0,se.FD)(li.A,{icon:"message",multiline:!0,onClick:ie,disabled:!r,children:[(0,se.Y)("span",{className:"title",children:$("Discussion")}),(0,se.Y)("span",{className:"subtitle",children:$(Y?"DiscussionUnlink":"Add")})]}),d&&(0,se.FD)(li.A,{icon:"link",onClick:ae,multiline:!0,disabled:!h,children:[(0,se.Y)("span",{className:"title",children:$("GroupInfo.InviteLinks")}),(0,se.Y)("span",{className:"subtitle",children:h?(0,bn.Sm)(h.length):$("Loading")})]}),Boolean(t.joinRequests?.length)&&(0,se.FD)(li.A,{icon:"add-user-filled",onClick:re,multiline:!0,children:[(0,se.Y)("span",{className:"title",children:$("SubscribeRequests")}),(0,se.Y)("span",{className:"subtitle",children:(0,bn.Sm)(t.joinRequests.length)})]}),(0,se.FD)(li.A,{icon:"heart-outline",multiline:!0,onClick:ne,disabled:!r,children:[(0,se.Y)("span",{className:"title",children:$("Reactions")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:ve})]}),W&&(0,se.FD)(li.A,{icon:"language",narrow:!0,ripple:!0,disabled:!A,onClick:Q,children:[(0,se.Y)("span",{children:$("AutomaticTranslation")}),(0,se.Y)(ci.A,{id:"auto-translation",label:$("AutomaticTranslation"),checked:g})]})]}),(0,se.FD)("div",{className:"section",children:[(0,se.FD)(li.A,{icon:"admin",multiline:!0,onClick:oe,children:[(0,se.Y)("span",{className:"title",children:$("ChannelAdministrators")}),(0,se.Y)("span",{className:"subtitle",children:Z})]}),(0,se.FD)(li.A,{icon:"group",multiline:!0,onClick:me,children:[(0,se.Y)("span",{className:"title",dir:"auto",children:$("ChannelSubscribers")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:(0,bn.Sm)(t.membersCount)})]}),(0,se.FD)(li.A,{icon:"delete-user",multiline:!0,onClick:ue,children:[(0,se.Y)("span",{className:"title",children:$("ChannelBlockedUsers")}),(0,se.Y)("span",{className:"subtitle",children:X})]})]}),(0,se.Y)("div",{className:"section",children:(0,se.Y)(li.A,{icon:"delete",ripple:!0,destructive:!0,onClick:M,children:t.isCreator?$("ChannelDelete"):$("LeaveChannel")})})]}),(0,se.Y)(pi.A,{isShown:R,onClick:he,disabled:Ae,ariaLabel:$("Save"),iconName:"check",isLoading:Ae}),(0,se.Y)(oi.A,{isOpen:F,onClose:L,text:t.isCreator?$("ChannelDeleteAlert"):$("ChannelLeaveAlert"),confirmLabel:t.isCreator?$("ChannelDelete"):$("LeaveChannel"),confirmHandler:pe,confirmIsDestructive:!0})]})})),Ig=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,currentUserId:e.currentUserId,isChannel:i&&(0,l.WX)(i),adminMembersById:(0,c.AWZ)(e,t)?.adminMembersById}})(({isActive:e,chat:t,isChannel:i,currentUserId:a,adminMembersById:r,onScreenSelect:c,onChatMemberSelect:d,onClose:h})=>{const{toggleSignatures:m}=(0,n.ko)(),u=(0,B.A)();(0,Ne.A)({isActive:e,onBack:h});const p=Boolean(t?.areSignaturesShown),v=Boolean(t?.areProfilesShown),g=Boolean(t?.isCreator||t&&(0,l.ub)(t,"addAdmins")),A=i&&(0,l.ub)(t,"postMessages"),f=(0,s.Kr)(()=>{if(!r)return[];const[e,t]=(0,di.jB)(Object.values(r),e=>e.isOwner);return[...e,...t]},[r]),b=(0,T.A)(e=>{d(e.userId,e.promotedByUserId===a),c(o.je.ChatAdminRights)}),C=(0,T.A)(()=>{m({chatId:t.id,areProfilesEnabled:v,areSignaturesEnabled:!p})}),y=(0,T.A)(()=>{m({chatId:t.id,areProfilesEnabled:!v,areSignaturesEnabled:p})}),S=(0,T.A)(()=>{c(o.je.GroupAddAdmins)}),N=(0,T.A)(e=>{if(e.isOwner)return u("ChannelCreator");const t=(0,n.mS)().users.byId,i=e.promotedByUserId?t[e.promotedByUserId]:void 0;return i?u("EditAdminPromotedBy",(0,l.Yg)(i)):u("ChannelAdmin")});return(0,se.Y)("div",{className:"Management",children:(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.Y)("div",{className:"section",children:(0,se.FD)(li.A,{icon:"recent",multiline:!0,disabled:!0,children:[(0,se.Y)("span",{className:"title",children:u("EventLog")}),(0,se.Y)("span",{className:"subtitle",children:u(i?"EventLogInfoDetailChannel":"EventLogInfoDetail")})]})}),(0,se.FD)("div",{className:"section",dir:u.isRtl?"rtl":void 0,children:[(0,se.Y)("p",{className:"section-help",dir:"auto",children:u(i?"Channel.Management.AddModeratorHelp":"Group.Management.AddModeratorHelp")}),f.map(e=>(0,se.Y)(li.A,{className:"chat-item-clickable",onClick:()=>b(e),children:(0,se.Y)(ms.A,{userId:e.userId,status:N(e),forceShowSelf:!0})},e.userId)),(0,se.Y)(pi.A,{isShown:g,onClick:S,ariaLabel:u("Channel.Management.AddModerator"),iconName:"add-user-filled"})]}),A&&(0,se.FD)("div",{className:"section",children:[(0,se.Y)("div",{className:"ListItem narrow",children:(0,se.Y)(Hs.A,{checked:p,label:u("ChannelSignMessages"),onChange:C})}),p&&(0,se.FD)(se.FK,{children:[(0,se.Y)("div",{className:"ListItem narrow",children:(0,se.Y)(Hs.A,{checked:v,label:u("ChannelSignMessagesWithProfile"),onChange:y})}),(0,se.Y)("p",{className:"section-info section-info_push",children:u("ChannelSignProfilesInfo")})]})]})]})})})),Pg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{isUsernameAvailable:s,checkedUsername:n,error:o}=(0,c.YK)(e,t);return{chat:i,isChannel:(0,l.WX)(i),progress:(0,c.nTw)(e).management.progress,error:o,isUsernameAvailable:s,checkedUsername:n,isProtected:i?.isProtected,maxPublicLinks:(0,bs.d)(e,"channelsPublic"),privateInviteLink:(0,c.AWZ)(e,t)?.inviteLink}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)&&(0,c.YK)(e,t)))(({chat:e,isActive:t,isChannel:i,progress:r,isUsernameAvailable:c,checkedUsername:d,error:h,isProtected:m,maxPublicLinks:u,privateInviteLink:p,onClose:v})=>{const{updatePublicLink:g,updatePrivateLink:A,toggleIsProtected:f,openLimitReachedModal:b,resetManagementError:C}=(0,n.ko)(),y=(0,s.Kr)(()=>e.usernames?.find(({isEditable:e})=>e),[e.usernames]),S=y?.username||"",N=(0,s.Kr)(()=>(0,l.gA)(e),[e]),[k,w]=(0,s.J0)(!1),[I,P]=(0,s.J0)(N?"public":"private"),[Y,F]=(0,s.J0)(),[M,T,L]=(0,D.A)(),[R,x,E]=(0,D.A)(),V=(0,K.A)(c),_=k&&Boolean("public"===I&&(Y||S&&""===Y)&&(c??V)||"private"===I&&N);(0,Ne.A)({isActive:t,onBack:v}),(0,s.vJ)(()=>{w(!1)},[S]),(0,s.vJ)(()=>{I&&!p&&A()},[I,p,A]);const U=(0,s.hb)(t=>{F(t),w(!0),h&&C({chatId:e.id})},[e.id,h]),O=(0,s.hb)((e,t)=>{if(Object.values((0,n.mS)().chats.byId).filter(({isCreator:e,usernames:t})=>e&&t?.some(e=>e.isActive)).length>=u&&"public"===e){b({limit:"channelsPublic"});const e=t.currentTarget.closest(".radio-group");return e.querySelector("[value=public]").checked=!1,void(e.querySelector("[value=private]").checked=!0)}P(e),w(!0)},[u,b]),J=(0,s.hb)(t=>{f({chatId:e.id,isProtected:"protected"===t})},[e.id,f]),G=(0,s.hb)(()=>{N&&"private"===I?x():g({username:"public"===I&&Y||""})},[N,x,I,g,Y]),j=(0,s.hb)(()=>{g({username:"",shouldDisableUsernames:!0}),E()},[E,g]),z=(0,s.hb)(()=>{L(),A()},[L,A]),H=(0,B.A)(),$=i?"Channel":"Mega",q=i?"Channel":"Group",W=[{value:"private",label:H(`${$}Private`),subLabel:H(`${$}PrivateInfo`)},{value:"public",label:H(`${$}Public`),subLabel:H(`${$}PublicInfo`)}],Q=[{value:"allowed",label:H("ChannelVisibility.Forwarding.Enabled")},{value:"protected",label:H("ChannelVisibility.Forwarding.Disabled")}],Z=r===o.TD.InProgress,X="public"===I&&e.usernames&&e.usernames.length>0;return(0,se.FD)("div",{className:"Management",children:[(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.FD)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:[(0,se.Y)("h3",{className:"section-heading",children:H(`${q}Type`)}),(0,se.Y)(ie.A,{selected:I,name:"channel-type",options:W,onChange:O})]}),"private"===I?(0,se.Y)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:p?(0,se.FD)(se.FK,{children:[(0,se.Y)(_r.A,{link:p,className:"invite-link"}),(0,se.Y)("p",{className:"section-info",dir:H.isRtl?"rtl":void 0,children:H(`${$}PrivateLinkHelp`)}),(0,se.Y)(li.A,{icon:"delete",ripple:!0,destructive:!0,onClick:T,children:H("RevokeLink")}),(0,se.Y)(oi.A,{isOpen:M,onClose:L,text:H("RevokeAlert"),confirmLabel:H("RevokeButton"),confirmHandler:z,confirmIsDestructive:!0})]}):(0,se.Y)(Ds.A,{})}):(0,se.FD)("div",{className:"section no-border",children:[(0,se.Y)("div",{className:"settings-input",children:(0,se.Y)(Sh,{asLink:!0,currentUsername:S,isLoading:Z,isUsernameAvailable:c,checkedUsername:d,onChange:U})}),h===a.Y3M&&function(){const e=`${a.jsp}${a.NjX}`;return(0,se.Y)("p",{className:"section-info",dir:"auto",children:H("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map(t=>"PURCHASE_LINK"===t?(0,se.Y)(dl.A,{url:e,text:`@${a.NjX}`}):t)})}(),(0,se.Y)("p",{className:"section-info",dir:"auto",children:H(`${q}.Username.CreatePublicLinkHelp`)})]}),X&&(0,se.Y)(fh,{chatId:e.id,usernames:e.usernames,onEditUsername:U}),(0,se.FD)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:[(0,se.Y)("h3",{className:"section-heading",children:H(i?"ChannelVisibility.Forwarding.ChannelTitle":"ChannelVisibility.Forwarding.GroupTitle")}),(0,se.Y)(ie.A,{selected:m?"protected":"allowed",name:"forwarding-type",options:Q,onChange:J}),(0,se.Y)("p",{className:"section-info section-info_push",children:H(i?"ChannelVisibility.Forwarding.ChannelInfo":"ChannelVisibility.Forwarding.GroupInfo")})]})]}),(0,se.Y)(pi.A,{isShown:_,disabled:Z,ariaLabel:H("Save"),onClick:G,iconName:"check",isLoading:Z}),(0,se.Y)(oi.A,{isOpen:R,onClose:E,text:H("ChannelVisibility.Confirm.MakePrivate.Channel",S),confirmHandler:j,confirmIsDestructive:!0})]})})),Yg=(0,s.ph)((0,n.EK)((e,{chat:t})=>{const{currentUserId:i}=e;return{currentUserId:i,chatMembers:(0,c.AWZ)(e,t.id)?.members}})(({chat:e,currentUserId:t,chatMembers:i,isOpen:o,onClose:a})=>{const{loadMoreMembers:r,deleteChatMember:l}=(0,n.ko)(),c=(0,B.A)(),[d,h]=(0,s.J0)(""),m=(0,s.Kr)(()=>{const e=(i||[]).reduce((e,i)=>(i.isAdmin||i.isOwner||i.userId===t||e.push(i.userId),e),[]);return(0,It.PU)({ids:e,query:d,type:"user"})},[i,t,d]),u=(0,T.A)(()=>{r({chatId:e.id})}),p=(0,T.A)(t=>{l({chatId:e.id,userId:t}),a()});return(0,se.Y)(Es,{isOpen:o,chatOrUserIds:m,searchPlaceholder:c("ChannelBlockUser"),search:d,onSearchChange:h,loadMore:u,onSelectChatOrUser:p,onClose:a})})),Fg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{byId:s}=e.users;return{chat:i,usersById:s,canDeleteMembers:i&&((0,l.ub)(i,"banUsers")||i.isCreator),removedMembers:(0,c.AWZ)(e,t)?.kickedMembers||hi.p,isChannel:i&&(0,l.WX)(i)}})(({chat:e,usersById:t,canDeleteMembers:i,removedMembers:o,isChannel:a,onClose:r,isActive:c})=>{const{updateChatMemberBannedRights:d}=(0,n.ko)(),h=(0,B.A)(),[m,u,p]=(0,D.A)();(0,Ne.A)({isActive:c,onBack:r});const v=(0,s.hb)(e=>{if(!e.kickedByUserId)return;const i=t[e.kickedByUserId];return i?h("UserRemovedBy",(0,l.Yg)(i)):void 0},[h,t]),g=(0,s.hb)(t=>{if(e)return[{title:h("Unblock"),icon:"delete",destructive:!0,handler:()=>d({chatId:e.id,userId:t.userId,bannedRights:{}})}]},[h,e,d]);return(0,se.Y)("div",{className:"Management",children:(0,se.Y)("div",{className:"panel-content custom-scroll",children:(0,se.FD)("div",{className:"section",dir:h.isRtl?"rtl":void 0,children:[(0,se.Y)("p",{className:"section-help",children:h(a?"NoBlockedChannel2":"NoBlockedGroup2")}),o.map(e=>(0,se.Y)(li.A,{className:"chat-item-clickable",ripple:!0,contextActions:g(e),children:(0,se.Y)(ms.A,{userId:e.userId,status:v(e),forceShowSelf:!0})},e.userId)),i&&(0,se.Y)(pi.A,{isShown:!0,onClick:u,ariaLabel:h("Channel.EditAdmin.Permission.BanUsers"),iconName:"add-user-filled"}),e&&i&&(0,se.Y)(Yg,{chat:e,isOpen:m,onClose:p})]})})})})),Dg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{linkedChatId:s}=(0,c.AWZ)(e,t)||{},{forDiscussionIds:n,byId:o}=e.chats;return{chat:i,chatsByIds:o,forDiscussionIds:n,linkedChat:s?(0,c.hds)(e,s):void 0,isChannel:i&&(0,l.WX)(i)}})(({chat:e,onClose:t,isActive:i,chatId:r,chatsByIds:c,linkedChat:d,forDiscussionIds:h,isChannel:m,onScreenSelect:u})=>{const{loadGroupsForDiscussion:p,linkDiscussionGroup:v,unlinkDiscussionGroup:g,toggleJoinRequest:A,toggleJoinToSend:f}=(0,n.ko)(),[b,C]=(0,s.J0)(),[y,S,N]=(0,D.A)(),[k,w,I]=(0,D.A)(),[P,Y]=(0,s.J0)(Boolean(d?.isJoinToSend)),[F,M]=(0,s.J0)(Boolean(d?.isJoinRequest)),L=(0,B.A)(),R=d?.id;(0,Ne.A)({isActive:i,onBack:t}),(0,s.vJ)(()=>{p()},[p]),(0,s.vJ)(()=>{i&&(Y(d?.isJoinToSend||!1),M(d?.isJoinRequest||!1))},[d,i]);const x=(0,s.hb)(()=>{N(),g({channelId:m?r:R}),m||u(o.je.Initial)},[N,g,m,r,R,u]),E=(0,s.hb)(()=>{I(),v({channelId:r,chatId:b})},[I,v,r,b]),V=(0,s.hb)(e=>{Y(e),f({chatId:R,isEnabled:e}),e||M(!1)},[R,f]),_=(0,s.hb)(e=>{M(e),A({chatId:R,isEnabled:e})},[R,A]);const U=(0,T.A)(()=>{u(o.je.NewDiscussionGroup)});return(0,se.Y)("div",{className:"Management",children:(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.DiscussionGroups,size:a.Uyp,className:"section-icon"}),d&&(0,se.FD)("div",{children:[d&&(0,se.Y)(li.A,{className:"chat-item-clickable",inactive:!0,children:(0,se.Y)(hs.A,{chatId:d.id})}),(0,se.Y)(li.A,{icon:"delete",ripple:!0,destructive:!0,onClick:S,children:L(m?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")}),(0,se.Y)(oi.A,{isOpen:y,onClose:N,header:(0,se.FD)("div",{className:"modal-header",children:[(0,se.Y)(Yt.A,{size:"tiny",peer:d}),(0,se.Y)("div",{className:"modal-title",children:L(m?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")})]}),textParts:(0,Pt.A)(L(m?"DiscussionUnlinkChannelAlert":"DiscussionUnlinkGroupAlert",d?.title),["br","simple_markdown"]),confirmLabel:L(m?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel"),confirmHandler:x,confirmIsDestructive:!0})]}),!d&&(0,se.FD)("div",{children:[(0,se.Y)("p",{className:"section-help",dir:"auto",children:L("DiscussionChannelHelp")}),(0,se.FD)("div",{teactFastList:!0,children:[(0,se.Y)(li.A,{icon:"group",ripple:!0,className:"create-item",withPrimaryColor:!0,teactOrderKey:0,onClick:U,children:L("DiscussionCreateGroup")},"create-group"),h?h.map((e,t)=>(0,se.Y)(li.A,{teactOrderKey:t+1,className:"chat-item-clickable scroll-item",onClick:()=>{C(e),w()},children:(0,se.Y)(hs.A,{chatId:e})},e)):(0,se.Y)(kc.A,{teactOrderKey:0,text:"No discussion groups found"},"nothing-found")]}),(0,se.Y)("p",{className:"mt-4 mb-0 section-help",dir:"auto",children:L("DiscussionChannelHelp2")}),(0,se.Y)(oi.A,{isOpen:k,onClose:I,header:function(){if(!b)return;const e=c[b];return e?(0,se.FD)("div",{className:"modal-header",children:[(0,se.Y)(Yt.A,{size:"tiny",peer:e}),(0,se.Y)("div",{className:"modal-title",children:L("Channel.DiscussionGroup.LinkGroup")})]}):void 0}(),textParts:function(){if(!b)return;const t=c[b];return t?(0,l.gA)(t)?(0,Pt.A)(`Do you want to make **${t.title}** the discussion board for **${e?.title}**?`,["br","simple_markdown"]):(0,Pt.A)(`Do you want to make **${t.title}** the discussion board for **${e?.title}**?\n\nAnyone from the channel will be able to see messages in this group.`,["br","simple_markdown"]):void 0}(),confirmLabel:L("DiscussionLinkGroup"),confirmHandler:E})]})]}),d&&(0,se.FD)("div",{className:"section",children:[(0,se.Y)("h3",{className:"section-heading",children:L("ChannelSettingsJoinTitle")}),(0,se.Y)("div",{className:"ListItem narrow",children:(0,se.Y)(Hs.A,{checked:P,onCheck:V,label:L("ChannelSettingsJoinToSend")})}),P&&(0,se.Y)("div",{className:"ListItem narrow",children:(0,se.Y)(Hs.A,{checked:F,onCheck:_,label:L("ChannelSettingsJoinRequest")})}),(0,se.Y)("p",{className:"section-info section-info_push",children:L(P?"ChannelSettingsJoinRequestInfo":"ChannelSettingsJoinToSendInfo")})]})]})})})),Mg="Group title can't be empty",Tg=["sendMessages","embedLinks","sendPolls","changeInfo","inviteUsers","pinMessages","manageTopics","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs"],Bg=Tg.length+1,Lg=(0,be.sg)(e=>e(),500,!1),Rg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t),{management:n,limitReachedModal:o}=(0,c.nTw)(e),{progress:a}=n,r=Boolean(s?.linkedChatId),d=(0,l.yn)(i),{invites:h}=n.byChatId[t]||{},m=!r&&((0,l.ub)(i,"changeInfo")||i.isCreator);return{chat:i,chatFullInfo:s,progress:a,isBasicGroup:d,hasLinkedChannel:r,canChangeInfo:i.isCreator||(0,l.ub)(i,"changeInfo"),canBanUsers:i.isCreator||(0,l.ub)(i,"banUsers"),canInvite:i.isCreator||(0,l.ub)(i,"inviteUsers"),exportedInvites:h,isChannelsPremiumLimitReached:"channels"===o?.limit,availableReactions:e.reactions.availableReactions,canEditForum:m}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chatId:e,chat:t,chatFullInfo:i,progress:a,isBasicGroup:r,hasLinkedChannel:d,canChangeInfo:h,canBanUsers:m,canInvite:u,canEditForum:p,isActive:v,exportedInvites:g,isChannelsPremiumLimitReached:A,availableReactions:f,onScreenSelect:b,onClose:C})=>{const{togglePreHistoryHidden:y,updateChat:S,deleteChat:N,leaveChannel:k,deleteChannel:w,closeManagement:I,openChat:P,loadExportedChatInvites:Y,loadChatJoinRequests:F,toggleForum:M}=(0,n.ko)(),[L,R,x]=(0,D.A)(),E=t.title,V=i?.about||"",[_,U]=(0,s.J0)(!1),[O,K]=(0,s.J0)(E),[J,j]=(0,s.J0)(V),[z,H]=(0,s.J0)(),[$,W]=(0,s.J0)(),[Q,Z]=(0,s.J0)(t.isForum),X=(0,l.cP)(t),te=(0,q.A)(X,!1,G.qZ.BlobUrl),ie=(0,s.Kr)(()=>(0,l.gA)(t),[t]),ne=(0,B.A)(),oe=(0,s.li)();(0,Ne.A)({isActive:v,onBack:C}),(0,s.vJ)(()=>{u&&(Y({chatId:e}),Y({chatId:e,isRevoked:!0}),F({chatId:e}))},[e,u]),(0,s.vJ)(()=>{Z(Boolean(t.isForum))},[t.isForum]),(0,s.vJ)(()=>{a===o.TD.Complete&&(U(!1),W(void 0))},[a]);const ae=(0,T.A)(()=>{b(o.je.ChatPrivacyType)}),re=(0,T.A)(()=>{b(o.je.Discussion)}),le=(0,T.A)(()=>{b(o.je.Reactions)}),ce=(0,T.A)(()=>{b(o.je.GroupPermissions)}),de=(0,T.A)(()=>{b(o.je.ChatAdministrators)}),he=(0,T.A)(()=>{b(o.je.Invites)}),me=(0,T.A)(()=>{b(o.je.JoinRequests)}),ue=(0,T.A)(e=>{H(e),U(!0)}),pe=(0,T.A)(e=>{K(e.target.value),U(!0)}),ve=(0,T.A)(e=>{j(e.target.value),U(!0)}),ge=(0,T.A)(()=>{const t=O.trim(),i=J.trim();t.length?S({chatId:e,title:t,about:i,photo:z}):W(Mg)}),Ae=(0,T.A)(()=>{b(o.je.GroupMembers)}),fe=(0,T.A)(()=>{if(!i)return;const{isPreHistoryHidden:e}=i;y({chatId:t.id,isEnabled:!e})}),be=(0,T.A)(()=>{Z(t=>{const i=!t;return Lg(()=>{M({chatId:e,isEnabled:i})}),i})});(0,s.vJ)(()=>{if(!A)return;const e=oe.current?.querySelector("input");e.checked=!i?.isPreHistoryHidden},[A,i?.isPreHistoryHidden]);const Ce=(0,s.Kr)(()=>{if(!i?.enabledReactions)return ne("ReactionsOff");if("all"===i.enabledReactions.type)return ne("ReactionsAll");const e=i.enabledReactions.allowed.length,t=f?.filter(e=>!e.isInactive).length||0;return t?`${e} / ${t}`:e.toString()},[f,i?.enabledReactions,ne]),ye=(0,s.Kr)(()=>{if(!t.defaultBannedRights)return 0;let e=Tg.filter(e=>!("manageTopics"===e&&!Q||t.defaultBannedRights[e])).length;const{sendStickers:i,sendGifs:s}=t.defaultBannedRights;return i||s||(e+=1),e},[t.defaultBannedRights,Q]),Se=(0,s.Kr)(()=>Object.keys(i?.adminMembersById||{}).length,[i?.adminMembersById]),ke=(0,T.A)(()=>{r?N({chatId:t.id}):t.isCreator?w({chatId:t.id}):k({chatId:t.id}),x(),I(),P({id:void 0})});if((0,c._ls)((0,n.mS)(),e)||t.isForbidden)return;const we=a===o.TD.InProgress;return(0,se.FD)("div",{className:"Management",children:[(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(Nh.A,{isForForum:Q,currentAvatarBlobUrl:te,onChange:ue,disabled:!h}),(0,se.FD)("div",{className:"settings-edit",children:[(0,se.Y)(ee.A,{id:"group-title",label:ne("GroupName"),onChange:pe,value:O,error:$===Mg?$:void 0,disabled:!h}),(0,se.Y)(rn.A,{id:"group-about",label:ne("DescriptionPlaceholder"),maxLength:255,maxLengthIndicator:(255-J.length).toString(),onChange:ve,value:J,disabled:!h,noReplaceNewlines:!0})]}),t.isCreator&&(0,se.FD)(li.A,{icon:"lock",multiline:!0,onClick:ae,children:[(0,se.Y)("span",{className:"title",children:ne("GroupType")}),(0,se.Y)("span",{className:"subtitle",children:ne(ie?"TypePublic":"TypePrivate")})]}),d&&(0,se.FD)(li.A,{icon:"message",multiline:!0,onClick:re,children:[(0,se.Y)("span",{className:"title",children:ne("LinkedChannel")}),(0,se.Y)("span",{className:"subtitle",children:ne("DiscussionUnlink")})]}),(0,se.FD)(li.A,{icon:"permissions",multiline:!0,onClick:ce,disabled:!m,children:[(0,se.Y)("span",{className:"title",children:ne("ChannelPermissions")}),(0,se.FD)("span",{className:"subtitle",dir:"auto",children:[ye,"/",Bg-(Q?0:1)]})]}),(0,se.FD)(li.A,{icon:"heart-outline",multiline:!0,onClick:le,disabled:!h,children:[(0,se.Y)("span",{className:"title",children:ne("Reactions")}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:Ce})]}),(0,se.FD)(li.A,{icon:"admin",multiline:!0,onClick:de,children:[(0,se.Y)("span",{className:"title",children:ne("ChannelAdministrators")}),(0,se.Y)("span",{className:"subtitle",children:(0,bn.Sm)(Se)})]}),u&&(0,se.FD)(li.A,{icon:"link",onClick:he,multiline:!0,disabled:!g,children:[(0,se.Y)("span",{className:"title",children:ne("GroupInfo.InviteLinks")}),(0,se.Y)("span",{className:"subtitle",children:g?(0,bn.Sm)(g.length):ne("Loading")})]}),Boolean(t.joinRequests?.length)&&(0,se.FD)(li.A,{icon:"add-user-filled",onClick:me,multiline:!0,children:[(0,se.Y)("span",{className:"title",children:ne("MemberRequests")}),(0,se.Y)("span",{className:"subtitle",children:(0,bn.Sm)(t.joinRequests.length)})]}),p&&(0,se.FD)(se.FK,{children:[(0,se.FD)(li.A,{icon:"forums",ripple:!0,onClick:be,children:[(0,se.Y)("span",{children:ne("ChannelTopics")}),(0,se.Y)(ci.A,{id:"group-notifications",label:ne("ChannelTopics"),checked:Q,inactive:!0})]}),(0,se.Y)("div",{className:"section-info section-info_push",children:ne("ForumToggleDescription")})]})]}),(0,se.FD)("div",{className:"section",children:[(0,se.FD)(li.A,{icon:"group",multiline:!0,onClick:Ae,children:[(0,se.Y)("span",{className:"title",children:ne("GroupMembers")}),(0,se.Y)("span",{className:"subtitle",children:(0,bn.Sm)(t.membersCount??0)})]}),!ie&&!d&&Boolean(i)&&(0,se.Y)("div",{className:"ListItem narrow",ref:oe,children:(0,se.Y)(Hs.A,{className:"align-checkbox-with-list-buttons",checked:!i.isPreHistoryHidden,label:ne("ChatHistory"),onChange:fe,subLabel:i.isPreHistoryHidden?ne("ChatHistoryHiddenInfo2"):ne("ChatHistoryVisibleInfo"),disabled:!m})})]}),(0,se.Y)("div",{className:"section",children:(0,se.Y)(li.A,{icon:"delete",ripple:!0,destructive:!0,onClick:R,children:ne("DeleteMega")})})]}),(0,se.Y)(pi.A,{isShown:_,onClick:ge,disabled:we,ariaLabel:ne("Save"),iconName:"check",isLoading:we}),(0,se.Y)(oi.A,{isOpen:L,onClose:x,textParts:(0,Pt.A)(r||!t.isCreator?ne("AreYouSureDeleteAndExit"):ne("AreYouSureDeleteThisChatWithGroup",t.title),["br","simple_markdown"]),confirmLabel:r||!t.isCreator?ne("DeleteMega"):ne("DeleteGroupForAll"),confirmHandler:ke,confirmIsDestructive:!0})]})})),xg=(0,s.ph)((0,n.EK)((e,{chatId:t,isPromotedByCurrentUser:i})=>{const s=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t),{byId:o}=e.users,{currentUserId:a}=e;return{chat:s,usersById:o,currentUserId:a,isFormFullyDisabled:!(s.isCreator||i),defaultRights:s.adminRights,hasFullInfo:Boolean(n),adminMembersById:n?.adminMembersById}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({isActive:e,isNewAdmin:t,selectedUserId:i,defaultRights:a,chat:r,usersById:c,currentUserId:d,adminMembersById:h,hasFullInfo:m,isFormFullyDisabled:u,onClose:p,onScreenSelect:v})=>{const{updateChatAdmin:g}=(0,n.ko)(),[A,f]=(0,s.J0)({}),[b,C]=(0,s.J0)(Boolean(t)),[y,S]=(0,s.J0)(!1),[N,k,w]=(0,D.A)(),[I,P]=(0,s.J0)(""),Y=(0,Fi.A)(),F=(0,l.WX)(r),M=r.isForum,T=Boolean(r.linkedMonoforumId);(0,Ne.A)({isActive:e,onBack:p});const B=(0,s.Kr)(()=>{const e=i?h?.[i]:void 0;if(!t||!e&&i){if(t){const e=(0,n.mS)().users.byId[i];return e?{userId:e.id,adminRights:a,customTitle:Y("ChannelAdmin"),isOwner:!1,promotedByUserId:void 0}:void 0}return e}},[h,a,t,Y,i]);(0,s.vJ)(()=>{m&&i&&!B&&v(o.je.ChatAdministrators)},[r,m,v,B,i]),(0,s.vJ)(()=>{f(B?.adminRights||{}),P((B?.customTitle||"").substr(0,16)),C(Boolean(t)),S(!1)},[a,t,B]);const L=(0,s.hb)(e=>{const{name:t}=e.target;f(e=>{return{...e,[t]:(i=e[t],!i||void 0)};var i}),C(!0)},[]),R=(0,s.hb)(()=>{i&&(S(!0),g({chatId:r.id,userId:i,adminRights:A,customTitle:I}))},[i,g,r.id,A,I]),x=(0,s.hb)(()=>{i&&(g({chatId:r.id,userId:i,adminRights:{}}),w())},[r.id,w,i,g]),E=(0,s.hb)(e=>!((0,l.yn)(r)||!u&&r.adminRights&&(r.isCreator||r.adminRights[e])),[r,u]),V=(0,s.Kr)(()=>{if(t||!B)return;if(B.isOwner)return Y("ChannelCreator");const e=B.promotedByUserId?c[B.promotedByUserId]:void 0;return e?Y("EditAdminPromotedBy",{user:(0,l.Yg)(e)}):Y("ChannelAdmin")},[t,B,c,Y]),_=(0,s.hb)(e=>{const{value:t}=e.target;P(t),C(!0)},[]);if(B)return(0,se.FD)("div",{className:"Management",children:[(0,se.Y)("div",{className:"panel-content custom-scroll",children:(0,se.FD)("div",{className:"section",children:[(0,se.Y)(li.A,{inactive:!0,className:"chat-item-clickable",children:(0,se.Y)(ms.A,{userId:B.userId,status:V,forceShowSelf:!0})}),(0,se.Y)("h3",{className:"section-heading mt-4",dir:"auto",children:Y("EditAdminWhatCanDo")}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"changeInfo",checked:Boolean(A.changeInfo),label:Y(F?"EditAdminChangeChannelInfo":"EditAdminChangeGroupInfo"),blocking:!0,disabled:E("changeInfo"),onChange:L})}),F&&(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"postMessages",checked:Boolean(A.postMessages),label:Y("EditAdminPostMessages"),blocking:!0,disabled:E("postMessages"),onChange:L})}),F&&(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"editMessages",checked:Boolean(A.editMessages),label:Y("EditAdminEditMessages"),blocking:!0,disabled:E("editMessages"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"deleteMessages",checked:Boolean(A.deleteMessages),label:Y(F?"EditAdminDeleteMessages":"EditAdminGroupDeleteMessages"),blocking:!0,disabled:E("deleteMessages"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"postStories",checked:Boolean(A.postStories),label:Y("EditAdminPostStories"),blocking:!0,disabled:E("postStories"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"editStories",checked:Boolean(A.editStories),label:Y("EditAdminEditStories"),blocking:!0,disabled:E("editStories"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"deleteStories",checked:Boolean(A.deleteStories),label:Y("EditAdminDeleteStories"),blocking:!0,disabled:E("deleteStories"),onChange:L})}),T&&(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"manageDirectMessages",checked:Boolean(A.manageDirectMessages),label:Y("EditAdminManageDirect"),blocking:!0,disabled:E("manageDirectMessages"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"banUsers",checked:Boolean(A.banUsers),label:Y("EditAdminBanUsers"),blocking:!0,disabled:E("banUsers"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"inviteUsers",checked:Boolean(A.inviteUsers),label:Y("EditAdminAddUsers"),blocking:!0,disabled:E("inviteUsers"),onChange:L})}),!F&&(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"pinMessages",checked:Boolean(A.pinMessages),label:Y("EditAdminPinMessages"),blocking:!0,disabled:E("pinMessages"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"addAdmins",checked:Boolean(A.addAdmins),label:Y("EditAdminAddAdmins"),blocking:!0,disabled:E("addAdmins"),onChange:L})}),(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"manageCall",checked:Boolean(A.manageCall),label:Y("StartVoipChatPermission"),blocking:!0,disabled:E("manageCall"),onChange:L})}),M&&(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"manageTopics",checked:Boolean(A.manageTopics),label:Y("EditAdminManageTopics"),blocking:!0,disabled:E("manageTopics"),onChange:L})}),!F&&(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:"anonymous",checked:Boolean(A.anonymous),label:Y("EditAdminSendAnonymously"),blocking:!0,disabled:E("anonymous"),onChange:L})}),u&&(0,se.Y)("p",{className:"section-info mb-4",dir:"auto",children:Y("EditAdminUnavailable")}),!F&&(0,se.Y)(ee.A,{id:"admin-title",label:Y("EditAdminRank"),className:"input-admin-title",onChange:_,value:I,disabled:u,maxLength:16}),d!==i&&!u&&!t&&(0,se.Y)(li.A,{icon:"delete",ripple:!0,destructive:!0,onClick:k,children:Y("EditAdminRemoveAdmin")})]})}),(0,se.Y)(pi.A,{isShown:b,onClick:R,ariaLabel:Y("Save"),disabled:y,iconName:"check",isLoading:y}),!t&&(0,se.Y)(oi.A,{isOpen:N,onClose:w,text:Y("EditAdminConfirmDismissText"),confirmLabel:Y("EditAdminConfirmDismiss"),confirmHandler:x,confirmIsDestructive:!0})]})}));var Eg=i(23459),Vg=i(285);const _g=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{statusesById:s}=e.users,{members:n,adminMembersById:o,areParticipantsHidden:a}=(0,c.AWZ)(e,t)||{},r=i&&(0,l.WX)(i),{userIds:d}=e.contactList||{},h=e.appConfig.hiddenMembersMinCount,m=i&&(i.isCreator||(0,l.ub)(i,"banUsers")),u=m&&!(0,l.yn)(i)&&void 0!==i.membersCount&&void 0!==h&&i.membersCount>=h,p=i&&((0,l.ub)(i,"inviteUsers")||!r&&!(0,l.Sq)(i,"inviteUsers")||i.isCreator),{query:v,fetchingStatus:g,globalUserIds:A,localUserIds:f}=(0,c.nTw)(e).userSearch;return{areParticipantsHidden:Boolean(i&&a),members:n,canAddMembers:p,adminMembersById:o,userStatusesById:s,isChannel:r,localContactIds:d,searchQuery:v,isSearching:g,globalUserIds:A,localUserIds:f,canDeleteMembers:m,currentUserId:e.currentUserId,canHideParticipants:u}})(({chatId:e,noAdmins:t,members:i,canAddMembers:a,adminMembersById:r,userStatusesById:c,isChannel:d,isActive:h,globalUserIds:m,localContactIds:u,localUserIds:p,isSearching:v,searchQuery:g,currentUserId:A,canDeleteMembers:f,areParticipantsHidden:b,canHideParticipants:C,onClose:y,onScreenSelect:S,onChatMemberSelect:N})=>{const{openChat:k,setUserSearchQuery:w,closeManagement:I,toggleParticipantsHidden:P,setNewChatMembersDialogState:Y,toggleManagement:F}=(0,n.ko)(),D=(0,B.A)(),M=(0,s.li)(),L=(0,s.li)(),[R,x]=(0,s.J0)(),E=(0,s.Kr)(()=>t&&r?Object.keys(r):[],[r,t]),V=(0,s.Kr)(()=>{const e=(0,n.mS)().users.byId;if(!i||!e)return[];const s=(0,l.UB)(i.map(({userId:e})=>e),e,c);return t?s.filter(e=>!E.includes(e)):s},[i,c,t,E]);(0,Eg.A)(V);const _=(0,s.Kr)(()=>{const e=(0,n.mS)().users.byId,i=Boolean(g),s=i?u?(0,It.PU)({ids:u,query:g,type:"user"}):[]:V;return(0,Cs.A)((0,di.Am)([...s,...i&&p||[],...i&&m||[]]).filter(i=>{const s=e[i];return!s||(d||s.canBeInvitedToGroup||!(0,l.tv)(s))&&(!t||!E.includes(i))}),!0)},[V,u,g,p,m,d,t,E]),[U,O]=(0,Ps.A)(void 0,_,Boolean(g)),K=(0,T.A)(e=>{t?(N(e,!0),S(o.je.ChatNewAdminRights)):(I(),k({id:e}))}),J=(0,T.A)(e=>{w({query:e.target.value})}),G=(0,Fs.A)(L,h,e=>{U&&U.length>0&&K(U[-1===e?0:e])},".ListItem-button",!0),j=(0,T.A)(()=>{x(void 0)}),z=(0,T.A)(()=>{P({chatId:e,isEnabled:!b})}),H=(0,T.A)(()=>{F(),Y({newChatMembersProgress:o.D7.InProgress})});return(0,Ne.A)({isActive:h,onBack:y}),(0,se.FD)("div",{className:"Management",children:[t&&(0,se.Y)("div",{className:"Management__filter",dir:D.isRtl?"rtl":void 0,children:(0,se.Y)(ee.A,{ref:M,value:g,onChange:J,placeholder:D("Search")})}),(0,se.FD)("div",{className:"panel-content custom-scroll",children:[C&&!d&&(0,se.FD)("div",{className:"section",children:[(0,se.FD)(li.A,{icon:"group",ripple:!0,onClick:z,children:[(0,se.Y)("span",{children:D("ChannelHideMembers")}),(0,se.Y)(ci.A,{label:D("ChannelHideMembers"),checked:b})]}),(0,se.Y)("p",{className:"section-info",children:D(b?"GroupMembers.MembersHiddenOn":"GroupMembers.MembersHiddenOff")})]}),(0,se.Y)("div",{className:"section",children:U?.length?(0,se.Y)(ls.A,{className:"picker-list custom-scroll",items:_,onLoadMore:O,noScrollRestore:Boolean(g),ref:L,onKeyDown:G,children:U.map(e=>{return(0,se.Y)(li.A,{className:"chat-item-clickable scroll-item",onClick:()=>K(e),contextActions:(t=e,t!==A&&f?[{title:D("lng_context_remove_from_group"),icon:"stop",handler:()=>{x(t)}}]:void 0),withPortalForMenu:!0,children:(0,se.Y)(ms.A,{userId:e,forceShowSelf:!0,withStory:!0})},e);var t})}):v||!U||U.length?(0,se.Y)(Ds.A,{}):(0,se.Y)(kc.A,{teactOrderKey:0,text:d?"No subscribers found":"No members found"},"nothing-found")})]}),a&&(0,se.Y)(pi.A,{isShown:!0,onClick:H,ariaLabel:D("lng_channel_add_users"),iconName:"add-user-filled"}),f&&(0,se.Y)(Vg.A,{isOpen:Boolean(R),userId:R,onClose:j})]})})),Ug=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t),{progress:n}=(0,c.nTw)(e).management,o=i?.paidMessagesStars,r=e.appConfig.starsPaidMessageCommissionPermille;return{chat:i,progress:n,currentUserId:e.currentUserId,removedUsersCount:s?.kickedMembers?.length||0,members:s?.members,arePaidMessagesAvailable:Boolean(s?.arePaidMessagesAvailable&&r),canChargeForMessages:Boolean(o&&r),groupPeersPaidStars:o||a.wZe}})(({onScreenSelect:e,onChatMemberSelect:t,chat:i,progress:a,currentUserId:r,removedUsersCount:l,members:c,onClose:d,isActive:h,arePaidMessagesAvailable:m,canChargeForMessages:u,groupPeersPaidStars:p})=>{const{updateChatDefaultBannedRights:v,updatePaidMessagesPrice:g}=(0,n.ko)(),{permissions:A,havePermissionChanged:f,isLoading:b,handlePermissionChange:C,setIsLoading:y}=Ul(i?.defaultBannedRights),S=(0,B.A)(),N=(0,Fi.A)();(0,Ne.A)({isActive:h,onBack:d});const k=(0,s.hb)(()=>{e(o.je.GroupRemovedUsers)},[e]),w=(0,s.hb)(()=>{e(o.je.GroupUserPermissionsCreate)},[e]),I=(0,s.hb)(i=>{t(i.userId,i.promotedByUserId===r),e(o.je.GroupUserPermissions)},[r,t,e]),[P,Y]=(0,s.J0)(!1),[F,M,L]=(0,D.A)(),[R,x]=(0,s.J0)(u),[E,V]=(0,s.J0)(p);(0,s.vJ)(()=>{a===o.TD.Complete&&L()},[a]);const _=(0,T.A)(()=>{i&&(y(!0),v({chatId:i.id,bannedRights:A}))}),U=(0,T.A)(()=>{i&&g({chatId:i?.id,paidMessagesStars:R?E:0})}),O=(0,T.A)(()=>{F&&U(),f&&_()}),K=(0,s.Kr)(()=>c?c.filter(({bannedRights:e})=>Boolean(e)):[],[c]),J=(0,s.hb)(e=>{const{bannedRights:t}=e;if(!t||!i)return;const{defaultBannedRights:s}=i;return Object.keys(t).reduce((e,i)=>{const n=i;if(!t[n]||s?.[n]||"sendInline"===n||"viewMessages"===n||"sendGames"===n)return e;const o=function(e){switch(e){case"sendMessages":return"UserRestrictionsNoSend";case"sendMedia":return"UserRestrictionsNoSendMedia";case"sendStickers":return"UserRestrictionsNoSendStickers";case"embedLinks":return"UserRestrictionsNoEmbedLinks";case"sendPolls":return"UserRestrictionsNoSendPolls";case"changeInfo":return"UserRestrictionsNoChangeInfo";case"inviteUsers":return"UserRestrictionsInviteUsers";case"pinMessages":return"UserRestrictionsPinMessages";case"manageTopics":return"GroupPermission.NoManageTopics";case"sendPlain":return"UserRestrictionsNoSendText";case"sendDocs":return"UserRestrictionsNoSendDocs";case"sendRoundvideos":return"UserRestrictionsNoSendRound";case"sendVoices":return"UserRestrictionsNoSendVoice";case"sendAudios":return"UserRestrictionsNoSendMusic";case"sendVideos":return"UserRestrictionsNoSendVideos";case"sendPhotos":return"UserRestrictionsNoSendPhotos";default:return}}(n);if(!o)return e;const a=S(o);return`${e}${e.length?`, ${a}`:a}`},"")},[i,S]),G=(0,T.A)(()=>{x(!R),M()}),j=(0,T.A)(e=>{V(e),M()}),z=F||f,H=a===o.TD.InProgress||b;return(0,se.FD)("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 432px;--before-shift-height: 96px;",children:[(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.FD)("div",{className:"section without-bottom-shadow",children:[(0,se.Y)("h3",{className:"section-heading",dir:"auto",children:N("ChannelPermissionsHeader")}),(0,se.Y)(Kl,{chatId:i?.id,isMediaDropdownOpen:P,setIsMediaDropdownOpen:Y,handlePermissionChange:C,permissions:A,dropdownClassName:"DropdownListTrap",className:(0,ge.A)("DropdownList",P&&"DropdownList--open"),shiftedClassName:(0,ge.A)("part",P&&"shifted")})]}),m&&(0,se.FD)("div",{className:(0,ge.A)("section",P&&"shifted"),children:[(0,se.FD)(li.A,{onClick:G,children:[(0,se.Y)("span",{children:N("GroupMessagesChargePrice")}),(0,se.Y)(ci.A,{id:"charge_for_messages",label:N("GroupMessagesChargePrice"),checked:R})]}),(0,se.Y)("p",{className:"settings-item-description-larger",dir:N.isRtl?"rtl":void 0,children:N("RightsChargeStarsAbout")})]}),R&&(0,se.Y)("div",{className:(0,ge.A)("section",P&&"shifted"),children:(0,se.Y)(Qd,{canChangeChargeForMessages:!0,isGroupChat:!0,chargeForMessages:E,onChange:j})}),(0,se.Y)("div",{className:(0,ge.A)("section",P&&"shifted"),children:(0,se.FD)(li.A,{icon:"delete-user",multiline:!0,narrow:!0,onClick:k,children:[(0,se.Y)("span",{className:"title",children:N("ChannelBlockedUsers")}),(0,se.Y)("span",{className:"subtitle",children:l})]})}),(0,se.FD)("div",{className:(0,ge.A)("section",P&&"shifted"),children:[(0,se.Y)("h3",{className:"section-heading",dir:"auto",children:N("PrivacyExceptions")}),(0,se.Y)(li.A,{icon:"add-user",onClick:w,children:N("ChannelAddException")}),K.map(e=>(0,se.Y)(li.A,{className:"chat-item-clickable exceptions-member",onClick:()=>I(e),children:(0,se.Y)(ms.A,{userId:e.userId,status:J(e),forceShowSelf:!0})},e.userId))]})]}),(0,se.Y)(pi.A,{isShown:z,onClick:O,ariaLabel:N("Save"),disabled:H,iconName:"check",isLoading:H})]})})),Og=(0,s.ph)((0,n.EK)((e,{chatId:t,isPromotedByCurrentUser:i})=>{const s=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t);return{chat:s,isFormFullyDisabled:!(s.isCreator||i),hasFullInfo:Boolean(n),members:n?.members}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chat:e,selectedChatMemberId:t,hasFullInfo:i,members:a,onScreenSelect:r,isFormFullyDisabled:l,onClose:c,isActive:d})=>{const{updateChatMemberBannedRights:h}=(0,n.ko)(),m=(0,s.Kr)(()=>{if(a)return a.find(({userId:e})=>e===t)},[a,t]),{permissions:u,havePermissionChanged:p,isLoading:v,handlePermissionChange:g,setIsLoading:A}=Ul(m?.bannedRights||e?.defaultBannedRights),[f,b,C]=(0,D.A)(),y=(0,Fi.A)(),S=(0,B.A)();(0,Ne.A)({isActive:d,onBack:c}),(0,s.vJ)(()=>{i&&t&&!m&&r(o.je.GroupPermissions)},[e,i,r,m,t]);const N=(0,s.hb)(()=>{e&&t&&(A(!0),h({chatId:e.id,userId:t,bannedRights:u}))},[e,t,A,h,u]),k=(0,s.hb)(()=>{e&&t&&h({chatId:e.id,userId:t,bannedRights:{viewMessages:!0}})},[e,t,h]),w=(0,s.hb)(t=>!!l||!(!e||!e.defaultBannedRights)&&e.defaultBannedRights[t],[e,l]),[I,P]=(0,s.J0)(!1);if(m)return(0,se.FD)("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 431px;--before-shift-height: 192px;",children:[(0,se.FD)("div",{className:"custom-scroll",children:[(0,se.FD)("div",{className:"section without-bottom-shadow",children:[(0,se.Y)(li.A,{inactive:!0,className:"chat-item-clickable",children:(0,se.Y)(ms.A,{userId:m.userId,forceShowSelf:!0})}),(0,se.Y)("h3",{className:"section-heading mt-4",dir:"auto",children:S("UserRestrictionsCanDo")}),(0,se.Y)(Kl,{chatId:e?.id,isMediaDropdownOpen:I,setIsMediaDropdownOpen:P,handlePermissionChange:g,permissions:u,className:(0,ge.A)("DropdownList",I&&"DropdownList--open"),dropdownClassName:"DropdownListTrap",shiftedClassName:(0,ge.A)("part",I&&"shifted"),getControlIsDisabled:w})]}),!l&&(0,se.Y)("div",{className:(0,ge.A)("section",I&&"shifted"),children:(0,se.Y)(li.A,{icon:"delete-user",ripple:!0,destructive:!0,onClick:b,children:S("UserRestrictionsBlock")})})]}),(0,se.Y)(pi.A,{isShown:p,onClick:N,ariaLabel:S("Save"),disabled:v,iconName:"check",isLoading:v}),(0,se.Y)(oi.A,{isOpen:f,onClose:C,text:y("GroupManagementBanUserConfirm"),confirmLabel:"Remove",confirmHandler:k,confirmIsDestructive:!0})]})})),Kg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{byId:s,statusesById:n}=e.users,o=(0,c.AWZ)(e,t)?.members;return{members:o,usersById:s,userStatusesById:n,isChannel:i&&(0,l.WX)(i)}})(({usersById:e,userStatusesById:t,members:i,isChannel:n,onScreenSelect:a,onChatMemberSelect:r,onClose:c,isActive:d})=>{(0,Ne.A)({isActive:d,onBack:c});const h=(0,s.Kr)(()=>{if(i&&e)return(0,l.UB)(i.filter(e=>!e.isOwner).map(({userId:e})=>e),e,t)},[i,e,t]),m=(0,s.hb)(e=>{r(e),a(o.je.GroupUserPermissions)},[r,a]);return(0,se.Y)("div",{className:"Management",children:(0,se.Y)("div",{className:"custom-scroll",children:(0,se.Y)("div",{className:"section",teactFastList:!0,children:h?h.map((e,t)=>(0,se.Y)(li.A,{teactOrderKey:t,className:"chat-item-clickable scroll-item",onClick:()=>m(e),children:(0,se.Y)(ms.A,{userId:e,forceShowSelf:!0})},e)):(0,se.Y)(kc.A,{teactOrderKey:0,text:n?"No subscribers found":"No members found"},"nothing-found")})})})})),Jg=[1,10,100],Gg={hour:36e5,day:864e5,week:6048e5},jg=Gg.hour,zg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{editingInvite:i}=(0,c.nTw)(e).management.byChatId[t]||{};return{editingInvite:i}})(({chatId:e,editingInvite:t,isActive:i,onClose:a,onScreenSelect:r})=>{const{editExportedChatInvite:l,exportChatInvite:c}=(0,n.ko)(),d=(0,B.A)(),[h,m,u]=(0,D.A)(),[p,v]=(0,s.J0)(!1),[g,A]=(0,s.J0)(""),[f,b]=(0,s.J0)(()=>Date.now()+jg),[C,y]=(0,s.J0)("unlimited"),[S,N]=(0,s.J0)(10),[k,w]=(0,s.J0)("0"),[I,P]=(0,s.J0)(!1);(0,Ne.A)({isActive:i,onBack:a}),(0,$.A)(([e])=>{if(e!==t)if(t){const{title:e,usageLimit:i,expireDate:s,isRequestNeeded:n}=t;if(e&&A(e),i&&(w(Jg.includes(i)?i.toString():"custom"),N(i)),s){const e=(0,Ii.Fm)()+jg;y("custom"),b(1e3*Math.max(s,e))}n&&v(!0)}else A(""),y("unlimited"),w("0"),b(1e3*(0,Ii.Fm)()+jg),N(10),v(!1)},[t]);const Y=(0,s.hb)(e=>{v(e.target.checked)},[]),F=(0,s.hb)(e=>{A(e.target.value)},[]),M=(0,s.hb)(e=>{N(Number.parseInt(e.target.value,10))},[]),T=(0,s.hb)(e=>{b(e.getTime()),u()},[u]),L=(0,s.hb)(()=>{P(!0);const i="custom"===k?S:Number(k);let s;switch(C){case"custom":s=(0,Ii.Fm)()+(f-Date.now())/1e3;break;case"hour":case"day":case"week":s=(0,Ii.Fm)()+Gg[C]/1e3;break;case"unlimited":s=0;break;default:s=void 0}t?l({link:t.link,chatId:e,title:g,isRequestNeeded:p,expireDate:s,usageLimit:i}):c({chatId:e,title:g,isRequestNeeded:p,expireDate:s,usageLimit:i}),r(o.je.Invites)},[e,f,S,l,t,c,p,C,k,g,r]);return(0,se.FD)("div",{className:"Management ManageInvite",children:[(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.Y)("div",{className:"section",children:(0,se.Y)(Hs.A,{label:d("ApproveNewMembers"),subLabel:d("ApproveNewMembersDescription"),checked:p,onChange:Y})}),(0,se.FD)("div",{className:"section",children:[(0,se.Y)(ee.A,{className:"link-name",placeholder:d("LinkNameHint"),value:g,onChange:F}),(0,se.Y)("p",{className:"section-help hint",children:d("LinkNameHelp")})]}),(0,se.FD)("div",{className:"section",children:[(0,se.Y)("div",{className:"section-heading",children:d("LimitByPeriod")}),(0,se.Y)(ie.A,{name:"expireOptions",options:[{value:"hour",label:d("Hours",1)},{value:"day",label:d("Days",1)},{value:"week",label:d("Weeks",1)},{value:"unlimited",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_expire_custom")}],onChange:y,selected:C}),"custom"===C&&(0,se.FD)(X.A,{className:"expire-limit",isText:!0,onClick:m,children:[(0,We.Lu)(d,f)," ",(0,We.fU)(d,f)]}),(0,se.Y)("p",{className:"section-help hint",children:d("TimeLimitHelp")})]}),!p&&(0,se.FD)("div",{className:"section",children:[(0,se.Y)("div",{className:"section-heading",children:d("LimitNumberOfUses")}),(0,se.Y)(ie.A,{name:"usageOptions",options:[...Jg.map(e=>({value:e.toString(),label:e})),{value:"0",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_usage_custom")}],onChange:w,selected:k}),"custom"===k&&(0,se.Y)("input",{className:"form-control usage-limit",type:"number",min:"1",max:"99999",value:S,onChange:M}),(0,se.Y)("p",{className:"section-help hint",children:d("UsesLimitHelp")})]}),(0,se.Y)(pi.A,{isShown:!0,onClick:L,disabled:I,ariaLabel:d(t?"SaveLink":"CreateLink"),iconName:"check"})]}),(0,se.Y)(sn,{isOpen:h,isFutureMode:!0,withTimePicker:!0,onClose:u,onSubmit:T,selectedAt:f,submitButtonLabel:d("Save")})]})})),Hg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{inviteInfo:i}=(0,c.nTw)(e).management.byChatId[t]||{},{invite:s,importers:n,requesters:o}=i||{},a=(0,c.hds)(e,t);return{invite:s,importers:n,requesters:o,isChannel:a&&(0,l.WX)(a)}})(({chatId:e,invite:t,importers:i,requesters:o,isChannel:a,isActive:r,onClose:l})=>{const{loadChatInviteImporters:c,loadChatInviteRequesters:d,openChat:h}=(0,n.ko)(),m=(0,B.A)(),{usage:u=0,usageLimit:p,link:v,adminId:g}=t||{},A=t?.expireDate&&1e3*(t.expireDate-(0,Ii.Fm)())+Date.now(),f=(t?.expireDate||0)-(0,Ii.Fm)()<0;return(0,s.vJ)(()=>{v&&(c({chatId:e,link:v}),d({chatId:e,link:v}))},[e,v,c,d]),(0,Ne.A)({isActive:r,onBack:l}),(0,se.Y)("div",{className:"Management ManageInviteInfo",children:(0,se.FD)("div",{className:"panel-content custom-scroll",children:[!t&&(0,se.Y)("p",{className:"section-help",children:m("Loading")}),t&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(_r.A,{title:t.title,link:t.link,className:"invite-link"}),Boolean(A)&&(0,se.Y)("p",{className:"section-help",children:f?m("ExpiredLink"):m("LinkExpiresIn",`${(0,We.Lu)(m,A)} ${(0,We.fU)(m,A)}`)})]}),g&&(0,se.FD)("div",{className:"section",children:[(0,se.Y)("p",{className:"section-heading",children:m("LinkCreatedeBy")}),(0,se.Y)(li.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:g}),children:(0,se.Y)(ms.A,{userId:g,status:(0,We.fS)(m,1e3*t.date,!0),forceShowSelf:!0})})]}),(()=>{if(i?.length||!o?.length)return i?(0,se.FD)("div",{className:"section",children:[(0,se.Y)("p",{className:"section-heading",children:i.length?m("PeopleJoined",u):m("NoOneJoined")}),(0,se.FD)("p",{className:"section-help",children:[!i.length&&(p?m("PeopleCanJoinViaLinkCount",p-u):m("NoOneJoinedYet")),i.map(e=>{const t=(0,We.fS)(m,1e3*e.date,!0),i=e.isFromChatList?`${t} â€¢ ${m("JoinedViaFolder")}`:t;return(0,se.Y)(li.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:e.userId}),children:(0,se.Y)(ms.A,{userId:e.userId,status:i,forceShowSelf:!0})})})]})]}):(0,se.Y)(Ue.A,{})})(),(()=>{if(!t?.isRevoked){if(!o&&i)return(0,se.Y)(Ue.A,{});if(o?.length)return(0,se.FD)("div",{className:"section",children:[(0,se.Y)("p",{className:"section-heading",children:m(a?"SubscribeRequests":"MemberRequests")}),(0,se.Y)("p",{className:"section-help",children:o.map(e=>(0,se.Y)(li.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:e.userId}),children:(0,se.Y)(ms.A,{userId:e.userId,status:(0,We.fS)(m,1e3*e.date,!0),forceShowSelf:!0})}))})]})}})()]})]})})})),$g="â€¢";function qg(e,t){const{isPermanent:i,usage:s=0,date:n}=e,{isPermanent:o,usage:a=0,date:r}=t;return i||o?Number(i)-Number(o):s||a?a-s:r-n}const Wg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{invites:i,revokedInvites:s}=(0,c.nTw)(e).management.byChatId[t]||{},n=(0,c.hds)(e,t);return{exportedInvites:i,revokedExportedInvites:s,chat:n,isChannel:n&&(0,l.WX)(n)}})(({chatId:e,chat:t,exportedInvites:i,revokedExportedInvites:r,isActive:c,isChannel:d,onClose:h,onScreenSelect:m})=>{const{setEditingExportedInvite:u,showNotification:p,editExportedChatInvite:v,deleteExportedChatInvite:g,deleteRevokedExportedChatInvites:A,setOpenedInviteInfo:f}=(0,n.ko)(),b=(0,Fi.A)(),C=(0,B.A)(),[y,S,N]=(0,D.A)(),[k,w,I]=(0,D.A)(),[P,Y]=(0,s.J0)(),[F,T,L]=(0,D.A)(),[R,x]=(0,s.J0)();(0,Ne.A)({isActive:c,onBack:h});const E=(0,s.Kr)(()=>{if(i)return i.some(({expireDate:e})=>e&&e-(0,Ii.Fm)()<We.il/1e3)},[i]),V=(0,M.A)();(0,hn.A)(V,E?1e3:void 0);const _=(0,s.Kr)(()=>t&&(0,l.Kl)(t),[t]),U=i?.find(({isPermanent:e})=>e),O=_?`${a.jsp}${_}`:U?.link,K=(0,s.Kr)(()=>{const e=t?.hasUsername?i:i?.filter(({isPermanent:e})=>!e);return e?.sort(qg)},[t?.hasUsername,i]),J=(0,s.hb)(t=>{const{link:i,title:s,isRequestNeeded:n,expireDate:o,usageLimit:a}=t;v({chatId:e,link:i,title:s,isRequestNeeded:n,expireDate:o,usageLimit:a,isRevoked:!0})},[e,v]),G=(0,s.hb)(e=>{Y(e),w()},[w]),j=(0,s.hb)(()=>{P&&(J(P),Y(void 0),I())},[I,J,P]),z=(0,s.hb)(()=>{m(o.je.EditInvite)},[m]),H=(0,s.hb)(()=>{U&&G(U)},[G,U]),$=(0,s.hb)(()=>{A({chatId:e}),N()},[e,N,A]),q=(0,s.hb)(t=>{f({chatId:e,invite:t}),m(o.je.InviteInfo)},[e,m,f]),W=(0,s.hb)(t=>{g({chatId:e,link:t.link})},[e,g]),Q=(0,s.hb)(e=>{x(e),T()},[T]),Z=(0,s.hb)(()=>{R&&(W(R),x(void 0),L())},[L,W,R]),X=(0,s.hb)(e=>{(0,gc.eM)(e),p({message:C("LinkCopied")})},[C,p]),ee=e=>{const{usage:t=0,usageLimit:i,expireDate:s,isPermanent:n,requested:o,isRevoked:a}=e;let r="";if(r=!a&&i&&t<i?C("CanJoin",i-t):t?C("PeopleJoined",t):C("NoOneJoined"),a)return r+=` ${$g} ${C("Revoked")}`,r;if(o&&(r+=` ${$g} ${C("JoinRequests",o)}`),void 0!==i&&t===i)r+=` ${$g} ${C("LinkLimitReached")}`;else if(s){const e=s-(0,Ii.Fm)();r+=` ${$g} `,r+=e>0?C("InviteLink.ExpiresIn",(0,We.zt)(b,e)):C("InviteLink.Expired")}else n&&(r+=` ${$g} ${C("Permanent")}`);return r},te=e=>{const{usage:t=0,usageLimit:i,isRevoked:s,expireDate:n}=e;return s?"link-status-icon-gray":i&&t<i?"link-status-icon-green":n&&1e3*(n-(0,Ii.Fm)())<=0?"link-status-icon-red":"link-status-icon-blue"},ie=t=>{const i=[];return i.push({title:C("Copy"),icon:"copy",handler:()=>X(t.link)}),t.isPermanent||t.isRevoked||i.push({title:C("Edit"),icon:"edit",handler:()=>(t=>{u({chatId:e,invite:t}),m(o.je.EditInvite)})(t)}),t.isRevoked?i.push({title:C("DeleteLink"),icon:"delete",handler:()=>Q(t),destructive:!0}):i.push({title:C("RevokeButton"),icon:"delete",handler:()=>G(t),destructive:!0}),i};return(0,se.FD)("div",{className:"Management ManageInvites",children:[(0,se.FD)("div",{className:"panel-content custom-scroll",children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.Invite,size:a.xMZ,className:"section-icon"}),(0,se.Y)("p",{className:"section-help",children:C(d?"PrimaryLinkHelpChannel":"PrimaryLinkHelp")})]}),O&&(0,se.Y)("div",{className:"section",children:(0,se.Y)(_r.A,{className:"settings-input",link:O,withShare:!0,onRevoke:t?.usernames?void 0:H,title:C(t?.usernames?"PublicLink":"lng_create_permanent_link_title")})}),(0,se.FD)("div",{className:"section",teactFastList:!0,children:[(0,se.Y)(li.A,{icon:"add",withPrimaryColor:!0,className:"create-item",onClick:z,children:C("CreateNewLink")},"create"),(!K||!K.length)&&(0,se.Y)(kc.A,{text:"No links found"},"nothing"),K?.map(e=>(0,se.FD)(li.A,{leftElement:(0,se.Y)(he.A,{name:"link",className:`link-status-icon ${te(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>q(e),contextActions:ie(e),children:[(0,se.Y)("span",{className:"title invite-title",children:e.title||e.link}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:ee(e)})]},e.link)),(0,se.Y)("p",{className:"section-help hint",children:C("ManageLinksInfoHelp")},"links-hint")]}),r&&Boolean(r.length)&&(0,se.FD)("div",{className:"section",teactFastList:!0,children:[(0,se.Y)("p",{className:"section-help",children:C("RevokedLinks")},"title"),(0,se.Y)(li.A,{icon:"delete",destructive:!0,onClick:S,children:(0,se.Y)("span",{className:"title",children:C("DeleteAllRevokedLinks")})},"delete"),r?.map(e=>(0,se.FD)(li.A,{leftElement:(0,se.Y)(he.A,{name:"link",className:`link-status-icon ${te(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>q(e),contextActions:ie(e),children:[(0,se.Y)("span",{className:"title",children:e.title||e.link}),(0,se.Y)("span",{className:"subtitle",dir:"auto",children:ee(e)})]},e.link))]})]}),(0,se.Y)(oi.A,{isOpen:y,onClose:N,title:C("DeleteAllRevokedLinks"),text:C("DeleteAllRevokedLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("DeleteAll"),confirmHandler:$}),(0,se.Y)(oi.A,{isOpen:k,onClose:I,title:C("RevokeLink"),text:C("RevokeAlert"),confirmIsDestructive:!0,confirmLabel:C("RevokeButton"),confirmHandler:j}),(0,se.Y)(oi.A,{isOpen:F,onClose:L,title:C("DeleteLink"),text:C("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("Delete"),confirmHandler:Z})]})})),Qg=(0,s.ph)((0,n.EK)((e,{userId:t})=>({user:(0,c.mBe)(e,t)}))(({userId:e,chatId:t,about:i,date:o,isChannel:a,user:r})=>{const{openChat:c,hideChatJoinRequest:d}=(0,n.ko)(),h=(0,ge.x)("JoinRequest"),m=(0,B.A)(),u=(0,l.Yg)(r),p=1e3*(o-(0,Ii.Fm)())+Date.now(),v=(0,We.cK)(new Date(p))?(0,We.fU)(m,p):(0,We.F5)(m,p,!0,!1,!0),g=(0,s.hb)(()=>{d({chatId:t,userId:e,isApproved:!0})},[t,d,e]),A=(0,s.hb)(()=>{d({chatId:t,userId:e,isApproved:!1})},[t,d,e]);return(0,se.FD)("div",{className:h("&"),children:[(0,se.FD)("div",{className:h("top"),children:[(0,se.FD)("div",{className:h("user"),onClick:()=>{c({id:e})},children:[(0,se.Y)(Yt.A,{size:"medium",peer:r},e),(0,se.FD)("div",{className:h("user-info"),children:[(0,se.Y)("div",{className:h("user-name"),children:u}),(0,se.Y)("div",{className:h("user-subtitle"),children:i})]})]}),(0,se.Y)("div",{className:h("date"),children:v})]}),(0,se.FD)("div",{className:h("buttons"),children:[(0,se.Y)(X.A,{className:h("button"),onClick:g,children:m(a?"ChannelAddToChannel":"ChannelAddToGroup")}),(0,se.Y)(X.A,{className:h("button"),isText:!0,onClick:A,children:m("DismissRequest")})]})]})})),Zg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,isChannel:i&&(0,l.WX)(i)}})(({chat:e,chatId:t,isActive:i,isChannel:o,onClose:r})=>{const{hideAllChatJoinRequests:l,loadChatJoinRequests:c}=(0,n.ko)(),[d,h,m]=(0,D.A)(),[u,p,g]=(0,D.A)(),A=(0,B.A)();(0,Ne.A)({isActive:i,onBack:r}),(0,s.vJ)(()=>{e?.joinRequests||(0,v.L8)(t)||c({chatId:t})},[e,t,c]);const f=(0,s.hb)(()=>{l({chatId:t,isApproved:!0}),m()},[l,t,m]),b=(0,s.hb)(()=>{l({chatId:t,isApproved:!1}),g()},[l,t,g]);return(0,se.FD)("div",{className:"Management ManageJoinRequests",children:[(0,se.FD)("div",{className:"custom-scroll",children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(pr.A,{tgsUrl:ur.w.JoinRequest,size:a.OMf,className:"section-icon"}),Boolean(e?.joinRequests?.length)&&(0,se.FD)("div",{className:"bulk-actions",children:[(0,se.Y)(X.A,{className:"bulk-action-button",onClick:h,children:"Accept all"}),(0,se.Y)(X.A,{className:"bulk-action-button",onClick:p,isText:!0,children:"Dismiss all"})]})]}),(0,se.FD)("div",{className:"section",teactFastList:!0,children:[(0,se.Y)("p",{children:e?.joinRequests?e.joinRequests.length?A("JoinRequests",e.joinRequests.length):A("NoMemberRequests"):A("Loading")},"title"),!e?.joinRequests&&(0,se.Y)(Ue.A,{},"loading"),0===e?.joinRequests?.length&&(0,se.Y)("p",{className:"section-help",children:A(o?"NoSubscribeRequestsDescription":"NoMemberRequestsDescription")},"empty"),e?.joinRequests?.map(({userId:e,about:i,date:s})=>(0,se.Y)(Qg,{userId:e,about:i,date:s,isChannel:o,chatId:t},e))]})]}),(0,se.Y)(oi.A,{isOpen:d,onClose:m,title:"Accept all requests?",text:"Are you sure you want to accept all requests?",confirmHandler:f}),(0,se.Y)(oi.A,{isOpen:u,onClose:g,title:"Reject all requests?",text:"Are you sure you want to reject all requests?",confirmHandler:b})]})})),Xg=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{maxUniqueReactions:s}=e.appConfig,n=(0,c.AWZ)(e,t),o=n?.reactionsLimit||s,a=(0,l.WX)(i);return{enabledReactions:n?.enabledReactions,availableReactions:e.reactions.availableReactions,chat:i,maxUniqueReactions:s,reactionsLimit:o,isChannel:a}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({availableReactions:e,enabledReactions:t,chat:i,isActive:o,onClose:a,maxUniqueReactions:r,reactionsLimit:c,isChannel:d})=>{const{setChatEnabledReactions:h}=(0,n.ko)(),m=(0,B.A)(),[u,p]=(0,s.J0)(!1),[v,g]=(0,s.J0)(!1),[A,f]=(0,s.J0)(t),[b,C]=(0,s.J0)(c);(0,Ne.A)({isActive:o,onBack:a});const y=(0,s.Kr)(()=>[{value:"all",label:m("AllReactions")},{value:"some",label:m("SomeReactions")},{value:"none",label:m("NoReactions")}],[m]),S=(0,s.hb)(()=>{i&&(g(!0),h({chatId:i.id,enabledReactions:A,reactionsLimit:b}))},[i,A,h,b]);(0,s.vJ)(()=>{g(!1),p(!1),f(t),C(c)},[t,c]);const N=(0,s.Kr)(()=>e?.filter(({isInactive:e})=>!e),[e]);(0,s.vJ)(()=>{if(void 0===b||b===c){if("some"===A?.type&&"all"!==t?.type&&"some"!==t?.type&&0===A.allowed.length)return void p(!1);if(A?.type===t?.type){if("some"===A?.type&&"some"===t?.type){const e=A.allowed,i=t?.allowed;if(e.length!==i.length||e.reverse().some(e=>!i.find(t=>(0,l.a0)(e,t))))return void p(!0)}p(!1)}else p(!0)}else p(!0)},[b,c,A,t]);const k=(0,s.hb)(e=>{"all"===e?(f({type:"all"}),C(c)):"some"===e?(f({type:"some",allowed:"some"===t?.type?t.allowed:[]}),C(c)):(f(void 0),C(void 0))},[t,c]),w=(0,s.hb)(e=>{if(!i||!N)return;const{name:t,checked:s}=e.currentTarget;if("some"===A?.type){const e={emoticon:t};f(s?{type:"some",allowed:[...A.allowed,e]}:{type:"some",allowed:A.allowed.filter(t=>!(0,l.a0)(t,e))})}},[N,i,A]),I=(0,s.hb)(e=>{C(e)},[]),P=(0,s.hb)(e=>m("PeerInfo.AllowedReactions.MaxCountValue",e),[m]),Y=d&&("all"===A?.type||"some"===A?.type);return(0,se.FD)("div",{className:"Management",children:[(0,se.FD)("div",{className:"panel-content custom-scroll",children:[Boolean(b&&Y)&&(0,se.FD)("div",{className:"section",children:[(0,se.Y)("h3",{className:"section-heading",children:m("MaximumReactionsHeader")}),(0,se.Y)(Xe.A,{min:1,max:r,value:b,onChange:I,renderValue:P,isCenteredLayout:!0}),(0,se.Y)("p",{className:"section-info section-info_push",children:m("ChannelReactions.MaxCount.Info")})]}),(0,se.FD)("div",{className:"section",children:[(0,se.Y)("h3",{className:"section-heading",children:m("AvailableReactions")}),(0,se.Y)(ie.A,{selected:A?.type||"none",name:"reactions",options:y,onChange:k}),(0,se.FD)("p",{className:"section-info section-info_push",children:["all"===A?.type&&m("EnableAllReactionsInfo"),"some"===A?.type&&m("EnableSomeReactionsInfo"),!A&&m("DisableReactionsInfo")]})]}),"some"===A?.type&&(0,se.FD)("div",{className:"section section-with-fab",children:[(0,se.Y)("h3",{className:"section-heading",children:m("OnlyAllowThisReactions")}),N?.map(({reaction:t,title:i})=>(0,se.Y)("div",{className:"ListItem",children:(0,se.Y)(Hs.A,{name:t.emoticon,checked:A?.allowed.some(e=>(0,l.a0)(t,e)),label:(0,se.FD)("div",{className:"Reaction",children:[(0,se.Y)(us.A,{reaction:t,availableReactions:e}),i]}),withIcon:!0,onChange:w})}))]})]}),(0,se.Y)(pi.A,{isShown:u,onClick:S,ariaLabel:m("Save"),disabled:v,iconName:"check",isLoading:v})]})})),eA="Please provide first name",tA=(0,s.ph)((0,n.EK)((e,{userId:t})=>{const i=(0,c.mBe)(e,t),s=(0,c.hds)(e,t),n=(0,c.vGo)(e,t),{progress:o}=(0,c.nTw)(e).management,a=s&&(0,Pc.If)(s,(0,c.K52)(e),(0,c.P5N)(e,s.id)),r=n?.personalPhoto,l=n?.profilePhoto||n?.fallbackPhoto,d=n?.note?.text;return{user:i,progress:o,isMuted:a,personalPhoto:r,notPersonalPhoto:l,noteText:d,contactNoteLimit:e.appConfig?.contactNoteLimit||an.tI}})(({userId:e,user:t,progress:i,isMuted:r,onClose:c,isActive:d,personalPhoto:h,notPersonalPhoto:m,noteText:u,contactNoteLimit:p})=>{const{updateContact:v,updateContactNote:g,deleteContact:A,closeManagement:f,uploadContactProfilePhoto:b,updateChatMutedState:C}=(0,n.ko)(),[y,S,N]=(0,D.A)(),[k,w,I]=(0,D.A)(),[P,Y,F]=(0,D.A)(),[M,T]=(0,s.J0)(),[L,R,x]=(0,D.A)(),E=(0,B.A)(),V=(0,Fi.A)();(0,Ne.A)({isActive:d,onBack:c});const _=t&&t.firstName||"",U=t&&t.lastName||"",O=u||"",[K,J]=(0,s.J0)(_),[G,j]=(0,s.J0)(U),[z,H]=(0,s.J0)(O),[$,q]=(0,s.J0)(!r);(0,s.vJ)(()=>{q(!r)},[r]),(0,s.vJ)(()=>{F(),x(),N()},[N,e]),(0,s.vJ)(()=>{J(_),j(U),H(O)},[_,U,O]),(0,s.vJ)(()=>{i===o.TD.Complete&&(F(),T(void 0),N())},[N,i]);const W=(0,s.hb)(e=>{J(e.target.value),Y(),M===eA&&T(void 0)},[M]),Q=(0,s.hb)(e=>{j(e.target.value),Y()},[]),Z=(0,s.hb)(e=>{H(e.target.value),Y()},[]),X=(0,s.hb)(e=>{q(e.target.checked),R(),Y()},[]),te=(0,s.hb)(()=>{const t=K.trim(),i=G.trim(),s=z.trim();t.length?(ne.current?.blur(),oe.current?.blur(),ae.current?.blur(),v({userId:e,firstName:t,lastName:i}),s!==O&&g({userId:e,note:{text:s,entities:[]}}),L&&C({chatId:e,mutedUntil:$?a.Os5:a.xEh})):T(eA)},[O,K,$,L,G,z,e]),ie=(0,s.hb)(()=>{A({userId:e}),N(),f()},[N,f,A,e]),ne=(0,s.li)(),oe=(0,s.li)(),ae=(0,s.li)(),re=(0,s.li)(),le=(0,s.li)(!1),ce=(0,s.hb)(()=>{re.current?.click(),le.current=!0},[]),de=(0,s.hb)(()=>{re.current?.click(),le.current=!1},[]),he=(0,s.hb)(()=>{I(),Y(),b({userId:e})},[I,b,e]),me=(0,s.hb)(t=>{Y(),b({userId:e,file:t,isSuggest:le.current})},[b,e]);if(!t)return;const ue=!(0,l.tv)(t)&&t.id!==a.zv8,pe=i===o.TD.InProgress,ve=p-z.length;return(0,se.FD)("div",{className:"Management",children:[(0,se.FD)("div",{className:"custom-scroll",children:[(0,se.FD)("div",{className:"section",children:[(0,se.Y)(ms.A,{userId:t.id,avatarSize:"jumbo",noStatusOrTyping:!0,noEmojiStatus:!0,withFullInfo:!0}),(0,se.FD)("div",{className:"settings-edit",children:[(0,se.Y)(ee.A,{ref:ne,id:"user-first-name",label:E("UserInfo.FirstNamePlaceholder"),onChange:W,value:K,error:M===eA?M:void 0}),(0,se.Y)(ee.A,{ref:oe,id:"user-last-name",label:E("UserInfo.LastNamePlaceholder"),onChange:Q,value:G}),(0,se.Y)(rn.A,{ref:ae,id:"user-note",label:V("UserNoteTitle"),onChange:Z,value:z,maxLength:p,maxLengthIndicator:ve.toString(),noReplaceNewlines:!0})]}),(0,se.Y)("p",{className:"section-edit-info",dir:"auto",children:V("EditUserNoteHint")}),(0,se.Y)("div",{className:"ListItem narrow",children:(0,se.Y)(Hs.A,{checked:$,label:E("Notifications"),subLabel:E($?"UserInfo.NotificationsEnabled":"UserInfo.NotificationsDisabled"),onChange:X})})]}),ue&&(0,se.FD)("div",{className:"section",children:[(0,se.Y)(li.A,{icon:"camera-add",ripple:!0,onClick:ce,children:(0,se.Y)("span",{className:"list-item-ellipsis",children:E("UserInfo.SuggestPhoto",t.firstName)})}),(0,se.Y)(li.A,{icon:"camera-add",ripple:!0,onClick:de,children:(0,se.Y)("span",{className:"list-item-ellipsis",children:E("UserInfo.SetCustomPhoto",t.firstName)})}),h&&(0,se.Y)(li.A,{leftElement:(0,se.Y)(Yt.A,{photo:m,noPersonalPhoto:!0,peer:t,size:"mini",className:"personal-photo"}),ripple:!0,onClick:w,children:E("UserInfo.ResetCustomPhoto")}),(0,se.Y)("p",{className:"section-help",dir:"auto",children:E("UserInfo.CustomPhotoInfo",t.firstName)})]}),(0,se.Y)("div",{className:"section",children:(0,se.Y)(li.A,{icon:"delete",ripple:!0,destructive:!0,onClick:S,children:E("DeleteContact")})})]}),(0,se.Y)(pi.A,{isShown:P,onClick:te,disabled:pe,ariaLabel:E("Save"),iconName:"check",isLoading:pe}),(0,se.Y)(oi.A,{isOpen:y,onClose:N,text:E("AreYouSureDeleteContact"),confirmLabel:E("DeleteContact"),confirmHandler:ie,confirmIsDestructive:!0}),(0,se.Y)(oi.A,{isOpen:k,onClose:I,text:E("UserInfo.ResetToOriginalAlertText",t.firstName),confirmLabel:E("Reset"),confirmHandler:he,confirmIsDestructive:!0}),(0,se.Y)(um.A,{onChange:me,inputRef:re})]})})),iA=(0,s.ph)((0,n.EK)((e,{chatId:t})=>{const{progress:i,error:s}=(0,c.nTw)(e).chatCreation||{};return{chat:(0,c.hds)(e,t),creationProgress:i,creationError:s}})(({chat:e,onClose:t,isActive:i,creationProgress:a,creationError:r})=>{const{createChannel:l}=(0,n.ko)(),c=(0,Fi.A)();(0,Ne.A)({isActive:i,onBack:t});const[d,h]=(0,s.J0)(()=>c("NewDiscussionChatTitle",{name:e?.title})),[m,u]=(0,s.J0)(),[p,v]=(0,s.J0)(),g=a===o.n7.InProgress,A=(0,T.A)(e=>{const{value:t}=e.currentTarget,i=t.trimStart();h(i),i!==t&&(e.currentTarget.value=i)}),f=r&&c("NewChatTitleEmptyError")||(p!==c("NewChatTitleEmptyError")&&p!==c("NewChannelTitleEmptyError")?p:void 0),b=(0,T.A)(()=>{d.length?e&&l({discussionChannelId:e.id,title:d,photo:m,isSuperGroup:!0}):v(c("NewChatTitleEmptyError"))});return(0,se.Y)("div",{className:"Management",children:(0,se.Y)("div",{className:"panel-content custom-scroll",children:(0,se.FD)("div",{className:"NewChat",children:[(0,se.FD)("div",{className:"NewChat-inner step-2",children:[(0,se.Y)(Nh.A,{onChange:u,title:c("AddPhoto")}),(0,se.Y)(ee.A,{value:d,onChange:A,label:c("GroupName"),error:p===c("NewChatTitleEmptyError")||p===c("NewChannelTitleEmptyError")?p:void 0}),f&&(0,se.Y)("p",{className:"error",children:f})]}),(0,se.Y)(pi.A,{isShown:0!==d.length,onClick:b,disabled:g,ariaLabel:c("DiscussionCreateGroup"),iconName:"arrow-right",isLoading:g})]})})})})),sA=(0,s.ph)((0,n.EK)(e=>({managementType:(0,c.vn8)(e)}))(({chatId:e,currentScreen:t,selectedChatMemberId:i,isPromotedByCurrentUser:s,onScreenSelect:n,onChatMemberSelect:a,onClose:r,isActive:l,managementType:c})=>{switch(t){case o.je.Initial:switch(c){case"bot":return(0,se.Y)(Ng,{userId:e,onClose:r,isActive:l},e);case"user":return(0,se.Y)(tA,{userId:e,onClose:r,isActive:l},e);case"group":return(0,se.Y)(Rg,{chatId:e,onScreenSelect:n,onClose:r,isActive:l||[o.je.ChatPrivacyType,o.je.Discussion,o.je.GroupPermissions,o.je.ChatAdministrators,o.je.GroupRemovedUsers,o.je.GroupUserPermissionsCreate,o.je.GroupUserPermissions,o.je.ChatAdminRights,o.je.ChatNewAdminRights,o.je.GroupRecentActions].includes(t)},e);case"channel":return(0,se.Y)(wg,{chatId:e,onScreenSelect:n,onClose:r,isActive:l||[o.je.ChannelSubscribers,o.je.ChatAdministrators,o.je.ChannelRemovedUsers,o.je.Discussion,o.je.ChatPrivacyType,o.je.ChatAdminRights,o.je.ChatNewAdminRights,o.je.GroupRecentActions].includes(t)},e)}break;case o.je.ChatPrivacyType:return(0,se.Y)(Pg,{chatId:e,isActive:l,onClose:r});case o.je.Discussion:return(0,se.Y)(Dg,{chatId:e,onScreenSelect:n,isActive:l,onClose:r});case o.je.GroupPermissions:return(0,se.Y)(Ug,{chatId:e,onScreenSelect:n,onChatMemberSelect:a,isActive:l||[o.je.GroupRemovedUsers,o.je.GroupUserPermissionsCreate,o.je.GroupUserPermissions].includes(t),onClose:r});case o.je.ChannelRemovedUsers:case o.je.GroupRemovedUsers:return(0,se.Y)(Fg,{chatId:e,isActive:l,onClose:r});case o.je.GroupUserPermissionsCreate:return(0,se.Y)(Kg,{chatId:e,onChatMemberSelect:a,onScreenSelect:n,isActive:l||[o.je.GroupUserPermissions].includes(t),onClose:r});case o.je.GroupUserPermissions:return(0,se.Y)(Og,{chatId:e,selectedChatMemberId:i,isPromotedByCurrentUser:s,onScreenSelect:n,isActive:l,onClose:r});case o.je.ChatAdministrators:return(0,se.Y)(Ig,{chatId:e,onScreenSelect:n,onChatMemberSelect:a,isActive:l||[o.je.ChatAdminRights,o.je.ChatNewAdminRights,o.je.GroupRecentActions].includes(t),onClose:r});case o.je.NewDiscussionGroup:return(0,se.Y)(iA,{chatId:e,onScreenSelect:n,isActive:l,onClose:r});case o.je.ChatNewAdminRights:case o.je.ChatAdminRights:return(0,se.Y)(xg,{chatId:e,isNewAdmin:t===o.je.ChatNewAdminRights,selectedUserId:i,isPromotedByCurrentUser:s,onScreenSelect:n,isActive:l,onClose:r});case o.je.ChannelSubscribers:case o.je.GroupMembers:return(0,se.Y)(_g,{chatId:e,isActive:l,onClose:r});case o.je.Invites:return(0,se.Y)(Wg,{chatId:e,isActive:l,onClose:r,onScreenSelect:n});case o.je.EditInvite:return(0,se.Y)(zg,{chatId:e,isActive:l,onClose:r,onScreenSelect:n});case o.je.GroupAddAdmins:return(0,se.Y)(_g,{chatId:e,noAdmins:!0,isActive:l,onClose:r,onScreenSelect:n,onChatMemberSelect:a});case o.je.Reactions:return(0,se.Y)(Xg,{chatId:e,isActive:l,onClose:r});case o.je.InviteInfo:return(0,se.Y)(Hg,{chatId:e,isActive:l,onClose:r});case o.je.JoinRequests:return(0,se.Y)(Zg,{chatId:e,isActive:l,onClose:r})}})),nA=/^4\d/,oA=/^5[1-5]/,aA=/^2[2-7]\d{2}/,rA=/^220[0-4]/;let lA=function(e){return e[e.Default=0]="Default",e[e.Visa=1]="Visa",e[e.Mastercard=2]="Mastercard",e[e.Mir=3]="Mir",e}({});const cA={[lA.Default]:"",[lA.Visa]:"visa",[lA.Mastercard]:"mastercard",[lA.Mir]:"mir"};function dA(e){return e=e.replace(/\s/g,""),nA.test(e)?lA.Visa:rA.test(e)?lA.Mir:oA.test(e)||aA.test(e)?lA.Mastercard:lA.Default}const hA={streetLine1:"",streetLine2:"",city:"",state:"",countryIso2:"",postCode:"",fullName:"",email:"",phone:"",shipping:"",cardNumber:"",cardholder:"",expiry:"",cvv:"",billingCountry:"",billingZip:"",saveInfo:!0,saveCredentials:!1,formErrors:{},tipAmount:0,savedCredentialId:""},mA=(e,t)=>{switch(t.type){case"changeAddress1":return{...e,streetLine1:t.payload,formErrors:{...e.formErrors,streetLine1:void 0}};case"changeAddress2":return{...e,streetLine2:t.payload,formErrors:{...e.formErrors,streetLine2:void 0}};case"changeCity":return{...e,city:t.payload,formErrors:{...e.formErrors,city:void 0}};case"changeState":return{...e,state:t.payload,formErrors:{...e.formErrors,state:void 0}};case"changeCountry":return{...e,countryIso2:t.payload.iso2,billingCountry:t.payload.defaultName,formErrors:{...e.formErrors,countryIso2:void 0}};case"changePostCode":return{...e,postCode:t.payload,formErrors:{...e.formErrors,postCode:void 0}};case"changeFullName":return{...e,fullName:t.payload,formErrors:{...e.formErrors,fullName:void 0}};case"changeEmail":return{...e,email:t.payload,formErrors:{...e.formErrors,email:void 0}};case"changePhone":return{...e,phone:t.payload,formErrors:{...e.formErrors,phone:void 0}};case"changeShipping":return{...e,shipping:t.payload};case"changeCardNumber":return{...e,cardNumber:t.payload,formErrors:{...e.formErrors,cardNumber:void 0}};case"changeCardholder":return{...e,cardholder:t.payload,formErrors:{...e.formErrors,cardholder:void 0}};case"changeExpiryDate":return{...e,expiry:t.payload,formErrors:{...e.formErrors,expiry:void 0}};case"changeCvvCode":return{...e,cvv:t.payload,formErrors:{...e.formErrors,cvv:void 0}};case"changeBillingCountry":return{...e,billingCountry:t.payload,formErrors:{...e.formErrors,billingCountry:void 0}};case"changeBillingZip":return{...e,billingZip:t.payload,formErrors:{...e.formErrors,billingZip:void 0}};case"changeSaveInfo":return{...e,saveInfo:t.payload};case"changeSaveCredentials":return{...e,saveCredentials:t.payload};case"updateUserInfo":return t.payload.country?{...e,...t.payload,billingCountry:t.payload.country}:{...e,...t.payload};case"setFormErrors":return{...e,formErrors:{...e.formErrors,...t.payload}};case"setTipAmount":return{...e,tipAmount:t.payload};case"changeSavedCredentialId":return{...e,savedCredentialId:t.payload};case"resetState":return{...hA};default:return e}};var uA=i(37960);const pA={root:"maC_9u6e",description:"zQ6lEVJ2","checkout-picture":"JgWvLdK2",checkoutPicture:"JgWvLdK2",text:"T2pYH395","checkout-title":"HadolzeF",checkoutTitle:"HadolzeF","checkout-description":"oZW7mUNP",checkoutDescription:"oZW7mUNP","price-info":"P618Q3yr",priceInfo:"P618Q3yr","price-info-item":"XNNG_ajy",priceInfoItem:"XNNG_ajy","price-info-item-main":"D9gYNLVk",priceInfoItemMain:"D9gYNLVk","price-info-item-title":"NtY5Aah7",priceInfoItemTitle:"NtY5Aah7",tipsList:"WHO341eB",tipsItem:"ksLlzBxw",tipsItem_active:"J4yem62L",tipsItemActive:"J4yem62L","invoice-info":"U2IBOLP1",invoiceInfo:"U2IBOLP1",provider:"kqWcdro1",stripe:"xKztZrna",smartglocal:"X_Ge1o4u","checkout-info-item-info-title":"ysWuPklS",checkoutInfoItemInfoTitle:"ysWuPklS","checkout-info-item-info-data":"MpC_P8_c",checkoutInfoItemInfoData:"MpC_P8_c","tos-checkbox":"OrRb0xG7",tosCheckbox:"OrRb0xG7",list:"l_wfiFG0"},vA=(0,s.ph)(({title:e,description:t,photo:i,invoice:a,shippingPrices:r,checkoutInfo:c,totalPrice:d,isTosAccepted:h,dispatch:m,onAcceptTos:u,tipAmount:p,needAddress:v,hasShippingOptions:g,savedCredentials:A,isPaymentFormUrl:f,botName:b})=>{const{setPaymentStep:C}=(0,n.ko)(),y=(0,B.A)(),S=(0,Fi.A)(),N=Boolean(m),{termsUrl:k,suggestedTipAmounts:w,maxTipAmount:I}=a||{},{paymentMethod:P,paymentProvider:Y,shippingAddress:F,name:D,phone:M,shippingMethod:T}=c||{},L=(0,q.A)((0,l.cy)(i)),{ref:R}=(0,uA.A)({hasMediaData:Boolean(L)}),x=(0,s.hb)(e=>{m({type:"setTipAmount",payload:I?Math.min(e,I):e})},[m,I]),E=(0,s.hb)(()=>{C({step:A?.length?o.tn.SavedPayments:o.tn.PaymentInfo})},[A?.length,C]),V=(0,s.hb)(()=>{C({step:o.tn.ShippingInfo})},[C]),_=(0,s.hb)(()=>{C({step:o.tn.Shipping})},[C]);return(0,se.FD)("div",{className:pA.root,children:[(0,se.FD)("div",{className:pA.description,children:[L&&(0,se.Y)("img",{ref:R,className:pA.checkoutPicture,src:L,draggable:!1,width:i.dimensions?.width,height:i.dimensions?.height,alt:""}),!L&&i&&(0,se.Y)(Ei.A,{width:i.dimensions?.width,height:i.dimensions?.height,className:pA.checkoutPicture,forceAspectRatio:!0}),(0,se.FD)("div",{className:pA.text,children:[(0,se.Y)("h5",{className:pA.checkoutTitle,children:e}),t&&(0,se.Y)("div",{className:pA.checkoutDescription,children:(0,Pt.A)(t,["br","links","emoji"])})]})]}),(0,se.FD)("div",{className:pA.priceInfo,children:[a.prices.map(e=>gA(S,e.label,e.amount,a.currency)),r&&r.map(e=>gA(S,e.label,e.amount,a.currency)),w&&w.length>0&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:pA.priceInfoItem,children:[(0,se.Y)("div",{className:pA.priceInfoItemTitle,children:e}),(0,se.Y)("div",{children:(0,oo.vv)(S,p,a.currency)})]}),(0,se.Y)("div",{className:pA.tipsList,children:w.map(e=>(0,se.Y)("div",{className:(0,ge.A)(pA.tipsItem,e===p&&pA.tipsItem_active),onClick:m?()=>x(e===p?0:e):void 0,children:(0,oo.vv)(S,e,a.currency,{shouldOmitFractions:!0})},e))})]}),void 0!==d&&gA(S,y("Checkout.TotalAmount"),d,a.currency,!0)]}),(0,se.FD)("div",{className:pA.invoiceInfo,children:[!f&&AA({title:P||A?.[0].title,label:y("PaymentCheckoutMethod"),icon:"card",onClick:N?E:void 0}),Y&&AA({title:Y,label:y("PaymentCheckoutProvider"),customIcon:(0,ge.A)(pA.provider,pA[Y.toLowerCase()])}),(v||!N&&F)&&AA({title:F,label:y("PaymentShippingAddress"),icon:"location",onClick:N?V:void 0}),D&&AA({title:D,label:y("PaymentCheckoutName"),icon:"user"}),M&&AA({title:M,label:y("PaymentCheckoutPhoneNumber"),icon:"phone"}),(g||!N&&T)&&AA({title:T,label:y("PaymentCheckoutShippingMethod"),icon:"truck",onClick:N?_:void 0}),k&&(U=k,(0,se.Y)(Hs.A,{label:function(e,t){const i=y("PaymentCheckoutAcceptRecurrent",b).split("*");return(0,se.FD)(se.FK,{children:[i[0],(0,se.Y)(dl.A,{url:e,text:i[1],isRtl:t}),i.slice(2)]})}(U,S.isRtl),name:"checkout_tos",checked:Boolean(h),className:pA.tosCheckbox,tabIndex:0,onCheck:u}))]})]});var U});function gA(e,t,i,s,n=!1){return(0,se.FD)("div",{className:(0,ge.A)(pA.priceInfoItem,n&&pA.priceInfoItemMain),children:[(0,se.Y)("div",{className:pA.priceInfoItemTitle,children:t}),(0,se.Y)("div",{children:(0,oo.vv)(e,i,s)})]})}function AA({title:e,label:t,icon:i,customIcon:s,onClick:n}){const o=Boolean(e&&t!==e);return(0,se.FD)(li.A,{className:pA.list,narrow:!0,multiline:o,icon:i,inactive:!n,onClick:n,leftElement:s&&(0,se.Y)("i",{className:(0,ge.A)("icon",s)}),children:[(0,se.Y)("div",{className:pA.checkoutInfoItemInfoTitle,children:e||t}),e&&t!==e&&(0,se.Y)("p",{className:pA.checkoutInfoItemInfoData,children:t})]})}const fA=(0,s.ph)(({url:e,noRedirect:t,onClose:i,onPaymentFormSubmit:o})=>{const{openTelegramLink:r}=(0,n.ko)(),l=(0,B.A)(),c=(0,s.hb)(e=>{try{const s=JSON.parse(e.data),{eventType:n,eventData:l}=s;switch(n){case"web_app_open_tg_link":if(!t){const e=a.jsp+l.path_full;r({url:e})}i();break;case"payment_form_submit":o&&o(l);break;default:i()}}catch(e){}},[i,t,r,o]);return(0,s.vJ)(()=>(window.addEventListener("message",c),()=>window.removeEventListener("message",c)),[c]),(0,se.Y)("div",{className:"ConfirmPayment",children:(0,se.Y)("iframe",{src:e,title:l("Checkout.WebConfirmation.Title"),allow:"payment",sandbox:"allow-modals allow-forms allow-scripts allow-same-origin allow-top-navigation",className:"ConfirmPayment__content"})})}),bA=(0,s.ph)((0,n.EK)(e=>{const{payment:t}=(0,c.nTw)(e);return{errorKey:t.error?.messageKey,passwordHint:e.twoFaSettings.hint,savedCredentials:"regular"===t.form?.type?t.form.savedCredentials:void 0}})(({isActive:e,errorKey:t,state:i,savedCredentials:o,passwordHint:a,onPasswordChange:r})=>{const{clearPaymentError:l}=(0,n.ko)(),c=(0,B.A)(),d=(0,Fi.A)(),[h,m]=(0,s.J0)(!1),u=(0,s.Kr)(()=>o?.length&&i.savedCredentialId?o.find(({id:e})=>e===i.savedCredentialId)?.title:void 0,[o,i.savedCredentialId]);return(0,se.FD)("div",{className:"PaymentInfo",children:[(0,se.Y)(Ud.A,{isBig:!0,isPasswordVisible:h}),(0,se.Y)(Al.A,{error:t&&d.withRegular(t),hint:a,description:c("PaymentConfirmationMessage",u),placeholder:c("Password"),onClearError:l,shouldShowSubmit:!1,shouldResetValue:e,isPasswordVisible:h,onChangePasswordVisibility:m,onInputChange:r})]})}));var CA=i(63173);const yA=i.p+"mastercard.790db81f7978635f77d8.svg",SA=i.p+"mir.e3a390b90e2e3e292621.svg",NA=i.p+"visa.fb39984c9532c0336be9.svg",kA=(0,s.ph)(({value:e,error:t,onChange:i,isActive:n})=>{const o=(0,B.A)(),a=(0,s.li)();(0,s.vJ)(()=>{n&&!m.TF&&(0,r.YS)(()=>{(0,nc.A)(a.current)})},[n]);const[l,c]=(0,s.J0)(lA.Default);(0,s.vJ)(()=>{const t=dA(e);c(t)},[]);const d=(0,s.hb)(e=>{const t=function(e){const t=(e=e.replace(/[^\d]/g,"")).match(/.{1,4}/g);return t?t.join(" "):""}(e.target.value),s=dA(e.target.value);c(s),i(t)},[i]),h=function(e){switch(e){case lA.Mastercard:return(0,se.Y)("img",{src:yA,draggable:!1,alt:""});case lA.Visa:return(0,se.Y)("img",{src:NA,draggable:!1,alt:""});case lA.Mir:return(0,se.Y)("img",{src:SA,draggable:!1,alt:""});default:return}}(l);return(0,se.FD)("div",{className:"CardInput",children:[(0,se.Y)(ee.A,{ref:a,label:o("PaymentCardNumber"),onChange:d,value:e,inputMode:"numeric",className:l?"has-right-addon":"",error:t,tabIndex:0,maxLength:19,teactExperimentControlled:!0}),(0,se.Y)("span",{className:"right-addon",children:h})]})}),wA=(0,s.ph)(({value:e,error:t,onChange:i})=>{const n=(0,B.A)(),o=(0,s.hb)(t=>{const s=t.target.value;e.endsWith("/")&&e.length>s.length?i(s):i(function(e){const t=(e=e.replace(/[^\d]/g,"").slice(0,4)).match(/.{1,2}/g);return t?.[0]&&Number(t[0])>12&&(t[0]="12"),t?.[0]&&2===t[0].length&&!t[1]&&(t[1]=""),t?t.join("/"):""}(t.target.value))},[i,e]);return(0,se.Y)(ee.A,{label:n("PaymentCardExpireDate"),onChange:o,value:e,error:t,inputMode:"numeric",tabIndex:0,maxLength:5,teactExperimentControlled:!0})}),IA=(0,s.ph)(({state:e,canSaveCredentials:t,needCardholderName:i,needCountry:n,needZip:o,countryList:a,dispatch:r,isActive:l})=>{const c=(0,s.li)();(0,s.vJ)(()=>{c.current&&c.current.value!==e.billingCountry&&(c.current.value=e.billingCountry)},[e.billingCountry]);const d=(0,s.hb)(e=>{r({type:"changeCardNumber",payload:e})},[r]),h=(0,s.hb)(e=>{r({type:"changeCardholder",payload:e.target.value.toUpperCase()})},[r]),m=(0,s.hb)(e=>{r({type:"changeExpiryDate",payload:e})},[r]),u=(0,s.hb)(e=>{const t=e.target.value.replace(/[^0-9]/g,"");r({type:"changeCvvCode",payload:t})},[r]),p=(0,s.hb)(e=>{r({type:"changeBillingCountry",payload:e.target.value})},[r]),v=(0,s.hb)(e=>{r({type:"changeBillingZip",payload:e.target.value})},[r]),g=(0,s.hb)(e=>{r({type:"changeSaveCredentials",payload:e.target.value})},[r]),A=(0,B.A)(),f=(0,Fi.A)(),{formErrors:b={}}=e;return(0,se.Y)("div",{className:"PaymentInfo",children:(0,se.FD)("form",{children:[(0,se.Y)("h5",{children:A("PaymentCardTitle")}),(0,se.Y)(kA,{onChange:d,value:e.cardNumber,error:b.cardNumber&&f.withRegular(b.cardNumber),isActive:l}),i&&(0,se.Y)(ee.A,{label:A("Checkout.NewCard.CardholderNamePlaceholder"),onChange:h,value:e.cardholder,inputMode:"text",tabIndex:0,error:b.cardholder&&f.withRegular(b.cardholder)}),(0,se.FD)("section",{className:"inline-inputs",children:[(0,se.Y)(wA,{value:e.expiry,onChange:m,error:b.expiry&&f.withRegular(b.expiry)}),(0,se.Y)(ee.A,{label:A("lng_payments_card_cvc"),onChange:u,value:e.cvv,inputMode:"numeric",maxLength:3,tabIndex:0,error:b.cvv&&f.withRegular(b.cvv),teactExperimentControlled:!0})]}),n||o?(0,se.Y)("h5",{children:A("PaymentBillingAddress")}):void 0,(0,se.FD)("section",{className:"inline-inputs",children:[n&&(0,se.Y)(CA.A,{label:A("PaymentShippingCountry"),onChange:p,value:e.billingCountry,hasArrow:Boolean(!0),id:"billing-country",error:b.billingCountry&&f.withRegular(b.billingCountry),tabIndex:0,ref:c,children:a.map(({defaultName:t,name:i})=>(0,se.Y)("option",{value:t,className:"county-item",selected:t===e.billingCountry,children:t||i}))}),o&&(0,se.Y)(ee.A,{label:A("PaymentShippingZipPlaceholder"),onChange:v,value:e.billingZip,inputMode:"text",tabIndex:0,maxLength:12,error:b.billingZip&&f.withRegular(b.billingZip)})]}),(0,se.Y)("div",{className:"checkbox",children:(0,se.Y)(Hs.A,{label:A("PaymentCardSavePaymentInformation"),checked:!!t&&e.saveCredentials,tabIndex:0,subLabel:A(t?"Checkout.NewCard.SaveInfoHelp":"Checkout.2FA.Text"),onChange:g,disabled:!t})})]})})}),PA=(0,s.ph)(({state:e,savedCredentials:t,dispatch:i,onNewCardClick:n})=>{const o=(0,B.A)(),a=(0,s.Kr)(()=>t?.length?t.map(({id:e,title:t})=>({label:t,value:e})):hi.p,[t]),r=(0,s.hb)(e=>{i({type:"changeSavedCredentialId",payload:e})},[i]);return(0,se.Y)("div",{className:"PaymentInfo",children:(0,se.FD)("form",{children:[(0,se.Y)("h5",{children:o("PaymentCardTitle")}),(0,se.Y)(ie.A,{name:"saved-credentials",options:a,selected:e.savedCredentialId,onChange:r}),(0,se.Y)(X.A,{isText:!0,onClick:n,children:o("PaymentCheckoutMethodNewCard")})]})})}),YA=(0,s.ph)(({state:e,shippingOptions:t,currency:i,dispatch:n})=>{const o=(0,B.A)(),a=(0,Fi.A)();(0,s.vJ)(()=>{t&&t.length&&!e.shipping&&n({type:"changeShipping",payload:t[0].id})},[t,e.shipping,n]);const r=(0,s.hb)(e=>{n({type:"changeShipping",payload:e})},[n]),l=(0,s.Kr)(()=>t.map(({id:e,title:t,amount:s})=>({label:t,subLabel:(0,oo.vv)(a,s,i),value:e})),[t,i,a]);return(0,se.Y)("div",{className:"Shipping",children:(0,se.FD)("form",{children:[(0,se.Y)("p",{children:o("PaymentShippingMethod")}),(0,se.Y)(ie.A,{name:"shipping-options",options:l,onChange:r,selected:e.shipping})]})})}),FA=(0,s.ph)(({state:e,needEmail:t,needPhone:i,needName:n,needAddress:o,countryList:a,dispatch:l})=>{const c=(0,s.li)(),d=(0,s.li)(),h=(0,s.li)();(0,s.vJ)(()=>{h.current&&h.current.value!==e.countryIso2&&(h.current.value=e.countryIso2)},[e.countryIso2]);const u=(0,B.A)(),p=(0,Fi.A)();(0,s.vJ)(()=>{m.TF||(0,r.YS)(()=>{(0,nc.A)(c.current)})},[c]);const v=(0,s.hb)(e=>{l({type:"changeAddress1",payload:e.target.value})},[l]),g=(0,s.hb)(e=>{l({type:"changeAddress2",payload:e.target.value})},[l]),A=(0,s.hb)(e=>{l({type:"changeCity",payload:e.target.value})},[l]),f=(0,s.hb)(e=>{l({type:"changeState",payload:e.target.value})},[l]),b=(0,s.hb)(e=>{l({type:"changeCountry",payload:a.find(t=>t.iso2===e.target.value)})},[a,l]),C=(0,s.hb)(e=>{l({type:"changePostCode",payload:e.target.value})},[l]),y=(0,s.hb)(e=>{l({type:"changeFullName",payload:e.target.value})},[l]),S=(0,s.hb)(e=>{l({type:"changeEmail",payload:e.target.value})},[l]),N=(0,s.hb)(e=>{let{value:t}=e.target;t=`+${t.replace(/\D/g,"")}`,d.current&&(d.current.value=t),l({type:"changePhone",payload:t})},[l]),k=(0,s.hb)(e=>{l({type:"changeSaveInfo",payload:e.target.value})},[l]),{formErrors:w}=e;return(0,se.Y)("div",{className:"ShippingInfo",children:(0,se.FD)("form",{children:[o?(0,se.FD)("div",{children:[(0,se.Y)("h5",{children:u("PaymentShippingAddress")}),(0,se.Y)(ee.A,{ref:c,label:u("PaymentShippingAddress1Placeholder"),onChange:v,value:e.streetLine1,inputMode:"text",tabIndex:0,error:w.streetLine1&&p.withRegular(w.streetLine1)}),(0,se.Y)(ee.A,{label:u("PaymentShippingAddress2Placeholder"),onChange:g,value:e.streetLine2,inputMode:"text",tabIndex:0,error:w.streetLine2&&p.withRegular(w.streetLine2)}),(0,se.Y)(ee.A,{label:u("PaymentShippingCityPlaceholder"),onChange:A,value:e.city,inputMode:"text",tabIndex:0,error:w.city&&p.withRegular(w.city)}),(0,se.Y)(ee.A,{label:u("PaymentShippingStatePlaceholder"),onChange:f,value:e.state,inputMode:"text",error:w.state&&p.withRegular(w.state)}),(0,se.Y)(CA.A,{label:u("PaymentShippingCountry"),onChange:b,value:e.countryIso2,hasArrow:Boolean(!0),id:"shipping-country",error:w.countryIso2&&p.withRegular(w.countryIso2),ref:h,tabIndex:0,children:a.map(({defaultName:t,name:i,iso2:s})=>(0,se.Y)("option",{value:s,className:"county-item",selected:s===e.countryIso2,children:t||i}))}),(0,se.Y)(ee.A,{label:u("PaymentShippingZipPlaceholder"),onChange:C,value:e.postCode,inputMode:"text",tabIndex:0,error:w.postCode&&p.withRegular(w.postCode)})]}):void 0,n||t||i?(0,se.Y)("h5",{children:u("PaymentShippingReceiver")}):void 0,n&&(0,se.Y)(ee.A,{label:u("PaymentShippingName"),onChange:y,value:e.fullName,inputMode:"text",tabIndex:0,error:w.fullName&&p.withRegular(w.fullName)}),t&&(0,se.Y)(ee.A,{label:u("PaymentShippingEmailPlaceholder"),onChange:S,value:e.email,inputMode:"email",tabIndex:0,error:w.email&&p.withRegular(w.email)}),i&&(0,se.Y)(ee.A,{label:u("PaymentShippingPhoneNumber"),onChange:N,value:e.phone,inputMode:"tel",tabIndex:0,error:w.phone&&p.withRegular(w.phone),ref:d}),(0,se.Y)(Hs.A,{label:u("PaymentShippingSave"),subLabel:u("PaymentShippingSaveInfo"),checked:Boolean(e.saveInfo),tabIndex:0,onChange:k})]})})}),DA="stripe",MA="smartglocal",TA=new Set([DA,MA]),BA=(0,s.ph)((0,n.EK)(e=>{const{form:t,step:i,shippingOptions:s,error:n,confirmPaymentUrl:o,inputInvoice:a,requestId:r,stripeCredentials:d,smartGlocalCredentials:h,temporaryPassword:m,isExtendedMedia:u,url:p}=(0,c.nTw)(e).payment,{invoice:v,nativeParams:g,nativeProvider:A}=t||{},f=e.countryList.general;let b=t?.nativeProvider;!b&&p&&(b=p.startsWith("https://payment.smart-glocal.com")?MA:void 0);const C=a&&"chatId"in a?(0,c.hds)(e,a.chatId):void 0,y=Boolean(v&&(!b||!TA.has(b))),{needCardholderName:S,needCountry:N,needZip:k}=g||{},w=t?.botId?(0,c.mBe)(e,t.botId):void 0,I=(0,l.Yg)(w);return{step:i,chat:C,shippingOptions:s,nativeProvider:b,isProviderError:y,form:t,invoice:v,needCardholderName:S,needCountry:N,needZip:k,error:n,confirmPaymentUrl:o??p,isPaymentFormUrl:Boolean(!A&&p),countryList:f,requestId:r,hasShippingOptions:Boolean(s?.length),smartGlocalToken:h?.token,stripeId:d?.id,passwordValidUntil:m?.validUntil,isExtendedMedia:u,botName:I}})(({isOpen:e,onClose:t,step:i,shippingOptions:a,form:r,isProviderError:l,invoice:c,nativeProvider:d,needCardholderName:h,needCountry:m,needZip:u,confirmPaymentUrl:p,error:v,countryList:g,hasShippingOptions:A,requestId:f,smartGlocalToken:b,stripeId:C,passwordValidUntil:y,isExtendedMedia:S,isPaymentFormUrl:N,botName:k})=>{const{loadPasswordInfo:w,validateRequestedInfo:I,sendPaymentForm:P,setPaymentStep:Y,sendCredentialsInfo:F,clearPaymentError:M,validatePaymentPassword:L,setSmartGlocalCardInfo:R}=(0,n.ko)(),x=(0,B.A)(),E=(0,Fi.A)(),[V,_,U]=(0,D.A)(),[O,J]=(0,Cd.A)(mA,hA),[G,j]=(0,s.J0)(!1),[z,H]=(0,s.J0)(!1),[$,q]=(0,s.J0)(""),W=(0,K.A)(i,!0),Q=(0,K.A)(f),Z=i!==o.tn.ConfirmPayment,ee=(0,s.hb)(e=>{Y({step:e})},[Y]);(0,s.vJ)(()=>{e&&(q(""),w(),_())},[e,w,_]),(0,s.vJ)(()=>{!e&&V&&U()},[U,V,e]),(0,s.vJ)(()=>{(void 0!==i||v)&&j(!1)},[i,v,f]),(0,s.vJ)(()=>{i!==o.tn.Checkout||i!==W||f===Q||O.savedCredentialId||O.cardNumber||ee(o.tn.PaymentInfo)},[O.cardNumber,O.savedCredentialId,Q,W,f,ee,i]),(0,s.vJ)(()=>{v?.field&&J({type:"setFormErrors",payload:{[v.field]:v.messageKey}})},[v,J]),(0,s.vJ)(()=>{if(r?.savedInfo){const{name:e,phone:t,email:i,shippingAddress:s}=r.savedInfo,{countryIso2:n,...o}=s||{},a=n&&g.find(({iso2:e})=>e===n).defaultName;J({type:"updateUserInfo",payload:{fullName:e,phone:t&&"+"!==t.charAt(0)?`+${t}`:t,email:i,...a&&{country:a,countryIso2:n,...o}}})}},[r,J,g]),(0,s.vJ)(()=>{r?.savedCredentials?.length&&J({type:"changeSavedCredentialId",payload:r.savedCredentials[0].id})},[J,r?.savedCredentials]);const ie=(0,s.hb)(()=>{M()},[M]),ne=(0,s.Kr)(()=>i!==o.tn.Checkout?0:function(e=[],t,i,s){const n=t?RA(t,i):[];let o=s;return o=e.concat(n||[]).reduce((e,t)=>e+t.amount,o),o}(c?.prices,a,O.shipping,O.tipAmount),[i,c?.prices,a,O.shipping,O.tipAmount]),oe=(0,s.Kr)(()=>{if(i===o.tn.Checkout)return function(e,t,i){const s=function(e){const t=dA(e);return cA[t]||""}(e.cardNumber),n=s&&e.cardNumber?`${s} *${e.cardNumber.slice(-4)}`:void 0,o=e.streetLine1?`${e.streetLine1}, ${e.city}, ${e.countryIso2}`:void 0,{phone:a,fullName:r}=e,l=t?LA(t,e.shipping):void 0,c=l?.title;return{paymentMethod:n,paymentProvider:i,shippingAddress:o,name:r,phone:a,shippingMethod:c}}(O,a,d||"")},[i,O,a,d]),re=(0,s.hb)(()=>{ee(o.tn.PaymentInfo)},[ee]),le=(0,s.hb)(()=>{M()},[M]),ce=(0,s.hb)(()=>{P({shippingOptionId:O.shipping,saveCredentials:O.saveCredentials,savedCredentialId:O.savedCredentialId,tipAmount:O.tipAmount})},[P,O]),de=(0,s.hb)(e=>{const{credentials:t}=e;R(t),ce()},[ce]);function he(e,t){switch(e){case o.tn.Checkout:return(0,se.Y)(vA,{title:r.title,description:r.description,photo:r.photo,dispatch:J,shippingPrices:O.shipping&&a?RA(a,O.shipping):void 0,totalPrice:ne,invoice:c,checkoutInfo:oe,isPaymentFormUrl:N,hasShippingOptions:A,tipAmount:O.tipAmount,needAddress:Boolean(c?.isShippingAddressRequested),savedCredentials:r.savedCredentials,isTosAccepted:z,onAcceptTos:H,botName:k});case o.tn.SavedPayments:return(0,se.Y)(PA,{state:O,savedCredentials:r.savedCredentials,dispatch:J,onNewCardClick:re});case o.tn.ConfirmPassword:return(0,se.Y)(bA,{state:O,savedCredentials:r.savedCredentials,onPasswordChange:q,isActive:e===i});case o.tn.PaymentInfo:return(0,se.Y)(IA,{state:O,dispatch:J,canSaveCredentials:Boolean(!r.isPasswordMissing&&r.canSaveCredentials),needCardholderName:h,needCountry:m,needZip:u,countryList:g,isActive:t});case o.tn.ShippingInfo:return(0,se.Y)(FA,{state:O,dispatch:J,needAddress:Boolean(c?.isShippingAddressRequested),needEmail:Boolean(c?.isEmailRequested||c?.isEmailSentToProvider),needPhone:Boolean(c?.isPhoneRequested||c?.isPhoneSentToProvider),needName:Boolean(c?.isNameRequested),countryList:g});case o.tn.Shipping:return(0,se.Y)(YA,{state:O,dispatch:J,shippingOptions:a||[],currency:c.currency});case o.tn.ConfirmPayment:return(0,se.Y)(fA,{url:p,noRedirect:S,onPaymentFormSubmit:de,onClose:U});default:return}}const me=(0,s.hb)(()=>{const{saveInfo:e}=O,t=function(e){const{streetLine1:t,streetLine2:i,city:s,state:n,countryIso2:o,postCode:a,fullName:r,phone:l,email:c}=e;return{name:r,phone:l,email:c,shippingAddress:{streetLine1:t,streetLine2:i,city:s,state:n,countryIso2:o,postCode:a}}}(O);I({requestInfo:t,saveInfo:e})},[I,O]),ue=(0,s.hb)(()=>{const e=function(e){const{cardNumber:t,cardholder:i,expiry:s,cvv:n,billingCountry:o,billingZip:a}=e,[r,l]=s.split("/");return{data:{cardNumber:t,cardholder:i,expiryMonth:r,expiryYear:l,cvv:n,country:o,zip:a}}}(O);F({credentials:e})},[F,O]),pe=(0,T.A)(()=>{switch(i){case o.tn.ShippingInfo:j(!0),me();break;case o.tn.Shipping:ee(o.tn.Checkout);break;case o.tn.SavedPayments:ee(o.tn.ConfirmPassword);break;case o.tn.ConfirmPassword:if(""===$)return;j(!0),L({password:$});break;case o.tn.PaymentInfo:j(!0),ue(),J({type:"changeSavedCredentialId",payload:""});break;case o.tn.Checkout:{if(N)return j(!0),void ee(o.tn.ConfirmPayment);if(r?.savedInfo&&!f&&!O.shipping)return j(!0),void me();if(O.savedCredentialId&&(!y||y<=Date.now()/1e3-3))return void ee(o.tn.ConfirmPassword);if(!O.savedCredentialId&&(d===DA&&!C||d===MA&&!b))return void ee(o.tn.PaymentInfo);const{phone:e,email:t,fullName:i}=O,s=c?.isEmailRequested&&!t||c?.isPhoneRequested&&!e||c?.isNameRequested&&!i;if(c?.isShippingAddressRequested&&!f||s)return void ee(o.tn.ShippingInfo);if(c?.isShippingAddressRequested&&!O.shipping&&a?.length)return void ee(o.tn.Shipping);j(!0),ce();break}}});(0,s.vJ)(()=>i===o.tn.ConfirmPassword?(0,Ni.A)({onEnter:pe}):void 0,[pe,i]);const ve=(0,s.hb)(()=>{J({type:"resetState"}),H(!1),t()},[t,J]),Ae=(0,s.hb)(()=>{ee(i===o.tn.ConfirmPassword?o.tn.SavedPayments:o.tn.Checkout)},[ee,i]),fe=(0,s.Kr)(()=>{switch(i){case o.tn.Checkout:return x("PaymentCheckout");case o.tn.ShippingInfo:return x("PaymentShippingInfo");case o.tn.Shipping:return x("PaymentShippingMethod");case o.tn.SavedPayments:return x("PaymentCheckoutMethod");case o.tn.ConfirmPassword:return x("Checkout.PasswordEntry.Title");case o.tn.PaymentInfo:return x("PaymentCardInfo");case o.tn.ConfirmPayment:return x("Checkout.WebConfirmation.Title");default:return""}},[i,x]),be=i===o.tn.Checkout?x("Checkout.PayPrice",(0,oo.Ad)(ne,c.currency,x.code)):E("PaymentInfoDone");if(l)return(0,se.FD)(te.A,{className:"error",isOpen:V,onClose:U,onCloseAnimationEnd:ve,children:[(0,se.Y)("p",{children:E("PaymentsProvidesNotSupported",void 0,{withNodes:!0,renderTextFilters:["br"]})}),(0,se.Y)("div",{className:"dialog-buttons mt-2",children:(0,se.Y)(X.A,{isText:!0,onClick:U,children:x("OK")})})]});const Ce=function(){if(G)return!0;switch(i){case o.tn.Checkout:return Boolean(c?.termsUrl)&&!z;case o.tn.PaymentInfo:return Boolean(""===O.cardNumber||h&&""===O.cardholder||""===O.cvv||""===O.expiry);default:return!1}}();return(0,se.FD)(te.A,{className:(0,ge.A)("PaymentModal",c?.isRecurring&&"recurring"),isOpen:V,onClose:U,onCloseAnimationEnd:ve,children:[(0,se.FD)("div",{className:"header",dir:E.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",iconName:i===o.tn.Checkout?"close":"arrow-left",onClick:i===o.tn.Checkout?U:Ae,ariaLabel:E("Close")}),(0,se.Y)("h3",{children:fe})]}),void 0!==i?(0,se.Y)(ae.Ay,{name:"slide",activeKey:i,shouldCleanup:!0,cleanupOnlyKey:o.tn.ConfirmPayment,children:e=>(0,se.Y)("div",{className:"content custom-scroll",children:he(i,e)})}):(0,se.Y)("div",{className:"empty-content",children:(0,se.Y)(Ue.A,{color:"gray"})}),Z&&(0,se.Y)("div",{className:"footer",children:(0,se.Y)(X.A,{className:"button-text",type:"submit",onClick:pe,disabled:Ce,isLoading:G,children:be})}),v&&!v.field&&function(){if(v)return(0,se.FD)(te.A,{className:"error",isOpen:Boolean(v),onClose:ie,children:[(0,se.Y)("h4",{children:v.descriptionKey?E.withRegular(v.descriptionKey):E("ErrorUnspecified")}),(0,se.Y)("div",{className:"dialog-buttons mt-2",children:(0,se.Y)(X.A,{isText:!0,onClick:le,children:E("OK")})})]})}()]})}));function LA(e,t){return e.find(({id:e})=>e===t)}function RA(e,t){const i=LA(e,t);return i?.prices}const xA=(0,s.ph)((0,n.EK)(e=>{const{receipt:t}=(0,c.nTw)(e).payment;return{receipt:t}})(({isOpen:e,onClose:t,receipt:i})=>{const n=(0,Fi.A)(),[o,a,r]=(0,D.A)();(0,s.vJ)(()=>{e&&a()},[e,a]);const l=(0,O.A)(i),c=i||l,d=(0,s.Kr)(()=>{if(c)return function(e,t,i){if(!t)return{paymentMethod:e};const{shippingAddress:s}=t,n=s?.streetLine1?`${s.streetLine1}, ${s.city}, ${s.countryIso2}`:void 0,{phone:o,name:a}=t;return{paymentMethod:e,shippingAddress:n,name:a,phone:o,shippingMethod:i}}(c.credentialsTitle,c.info,c.shippingMethod)},[c]);return(0,se.Y)(te.A,{className:"PaymentModal PaymentModal-receipt",isOpen:o,onClose:r,onCloseAnimationEnd:t,children:c&&(0,se.FD)(se.FK,{children:[(0,se.FD)("div",{className:"header",dir:n.isRtl?"rtl":void 0,children:[(0,se.Y)(X.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:r,ariaLabel:"Close",iconName:"close"}),(0,se.FD)("h3",{children:[" ",n("PaymentReceipt")," "]})]}),(0,se.Y)("div",{className:"receipt-content custom-scroll",children:(0,se.Y)(vA,{shippingPrices:c.shippingPrices,totalPrice:c.totalAmount,tipAmount:c.tipAmount,invoice:c.invoice,checkoutInfo:d,title:c.title,description:c.description,photo:c.photo})})]})})})),EA="Qo4PtFZI",VA="wtfpombl",_A=(0,s.ph)((0,n.EK)((e,{modal:t})=>({chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0}))(({modal:e,chat:t})=>{const{sendInviteMessages:i,closeInviteViaLinkModal:o,openPremiumModal:a}=(0,n.ko)(),{missingUsers:r}=e||{},d=(0,Fi.A)(),[h,m]=(0,s.J0)([]),u=(0,s.Kr)(()=>r?.map(e=>e.id)||hi.p,[r]),[p,v]=(0,s.Kr)(()=>{if(!r?.length)return[[],[]];const[e,t]=(0,di.jB)(r,e=>e.isRequiringPremiumToMessage);return[e.map(e=>e.id),t.map(e=>e.id)]},[r]),g=(0,s.Kr)(()=>{const e=(0,n.mS)();return r?.filter(e=>e.isRequiringPremiumToInvite||e.isRequiringPremiumToMessage).map(t=>(0,c.mBe)(e,t.id)).filter(Boolean)},[r]);(0,s.vJ)(()=>{m(v)},[v]);const A=(0,T.A)(()=>o()),f=(0,T.A)(()=>{i({chatId:t.id,userIds:h}),o()}),b=(0,T.A)(()=>{a()}),C=(0,s.Kr)(()=>{if(t)return Boolean(t?.isCreator||t?.adminRights?.inviteUsers)},[t]),y=(0,s.Kr)(()=>C?d(1===r?.length?"InviteBlockedOneMessage":"InviteBlockedManyMessage"):d("InviteRestrictedUsers",{count:r?.length},{pluralValue:r?.length||0,withMarkdown:!0,withNodes:!0}),[C,d,r?.length]),S=(0,s.Kr)(()=>{if(g?.length){if(1===g.length)return d("InviteRestrictedPremiumReasonSingle",{user:(0,l.Yg)(g[0])},{withMarkdown:!0,withNodes:!0});if(g.length<=3){const e=d.conjunction(g.map(e=>(0,l.Yg)(e)).filter(Boolean));return d("InviteRestrictedPremiumReasonMultiple",{list:e},{withMarkdown:!0,withNodes:!0})}if(g.length>3){const e=g.length-2,t=g.slice(0,2),i=d.conjunction(t.map(e=>(0,l.Yg)(e)).filter(Boolean));return d("InviteRestrictedPremiumReasonMultipleMore",{list:i,count:e},{pluralValue:e,withMarkdown:!0,withNodes:!0})}}},[g,d]),N=Boolean(g?.length),k=Boolean(v?.length);return(0,se.FD)(te.A,{isOpen:Boolean(u&&t),contentClassName:"n8eENbaR",hasAbsoluteCloseButton:!0,onClose:A,isSlim:!0,children:[N&&(0,se.FD)(se.FK,{children:[(0,se.Y)(qi.A,{className:"Nc3SOtKd",peers:g,size:"large"}),(0,se.Y)("h3",{className:VA,children:d(C?"InviteBlockedPremiumTitle":"InviteBlockedNoLinkTitle")}),(0,se.Y)("p",{className:EA,children:S}),(0,se.Y)(X.A,{withPremiumGradient:!0,isShiny:!0,onClick:b,children:d("InviteBlockedPremiumButton")})]}),N&&k&&(0,se.Y)(Zl.A,{className:"UoMeVIyC",children:d("InviteBlockedOr")}),k&&(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{className:VA,children:d("InviteBlockedTitle")}),(0,se.Y)("p",{className:EA,children:y}),(0,se.Y)(mi.A,{className:"nEYyTS_m",itemIds:u,selectedIds:h,lockedUnselectedIds:p,lockedUnselectedSubtitle:d("InviteRestrictedPremiumReason"),onSelectedIdsChange:m,isViewOnly:!C,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),C&&(0,se.Y)(X.A,{className:"Ttkq3nqt",onClick:f,disabled:!h.length,children:d("InviteViaLinkButton")})]})]})}));var UA=i(84555);const OA=(0,s.ph)(({modal:e})=>{const{closeOneTimeMediaModal:t}=(0,n.ko)(),i=(0,B.A)(),s=(0,Si.A)(e?.message,!0),{shouldRender:a,transitionClassNames:r}=(0,je.A)(Boolean(e)),d=(0,T.A)(()=>{}),h=(0,T.A)(()=>{t()});if(!a||!s)return;const m=(0,l.Ie)(s),u=(0,c.SJA)((0,n.mS)()),p=i(m?"Chat.Voice.Single.Close":"Chat.Voice.Single.DeleteAndClose");return(0,se.FD)("div",{className:(0,ge.A)("c3xMWwzW",r),children:[function(){if(!s?.content)return;const{voice:e,video:t}=s.content;return e?(0,se.Y)(Nc.Ay,{className:"VLiJWMs0",theme:u,message:s,origin:o.d9.OneTimeModal,autoPlay:!0,onPlay:d,onPause:h}):t?.isRound?(0,se.Y)(UA.A,{className:"ML2YEpGq",message:s,origin:"oneTimeModal",onStop:h}):void 0}(),(0,se.Y)("div",{className:"VWy1qXJL",children:(0,se.Y)(X.A,{faded:!0,onClick:h,pill:!0,size:"smaller",color:"dark"===u?"dark":"secondary",className:"FfMrCmD9",children:p})})]})}),KA=(0,s.ph)(({modal:e})=>{const{closeWebAppsCloseConfirmationModal:t,closeWebAppModal:i}=(0,n.ko)(),o=(0,B.A)(),a=(0,Fi.A)(),r=Boolean(e),[l,c]=(0,s.J0)(!1),d=(0,s.li)(),h=(0,s.hb)(()=>{t({shouldSkipInFuture:l})},[l]),m=(0,s.hb)(()=>{i({shouldSkipConfirmation:!0}),t({shouldSkipInFuture:l})},[l]),u=(0,s.hb)(e=>{-1===e&&m()},[m]),p=(0,Fs.A)(d,r,u,".Button");return(0,se.FD)(te.A,{className:(0,ge.A)("confirm"),title:a("CloseMiniApps"),isOpen:r,onClose:h,children:[(0,se.Y)("p",{children:a("AreYouSureCloseMiniApps")}),(0,se.Y)(Hs.A,{className:"dialog-checkbox",label:a("DoNotAskAgain"),checked:l,onCheck:c}),(0,se.FD)("div",{className:"dialog-buttons mt-2",ref:d,onKeyDown:p,children:[(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:m,color:"danger",children:o("Confirm")}),(0,se.Y)(X.A,{className:"confirm-dialog-button",isText:!0,onClick:h,children:o("Cancel")})]})]})}),JA=(0,s.ph)((0,n.EK)(e=>{const t=e.appConfig.freezeUntilDate,i=e.appConfig.freezeAppealUrl,s=e.botFreezeAppealId?(0,c.mBe)(e,e.botFreezeAppealId):void 0;return{freezeUntilDate:t,freezeAppealUrl:i,botFreezeAppealUsername:s&&(0,l.Kl)(s)}})(({modal:e,freezeUntilDate:t,freezeAppealUrl:i,botFreezeAppealUsername:o})=>{const{closeFrozenAccountModal:a,openUrl:r}=(0,n.ko)(),l=(0,Fi.A)(),c=Boolean(e),d=(0,T.A)(()=>{a()}),h=(0,T.A)(()=>{a(),i&&r({url:i})}),m=(0,s.Kr)(()=>(0,se.FD)("div",{className:"cW2rtp6M",children:[(0,se.Y)(pr.A,{size:130,tgsUrl:ur.w.BannedDuck,noLoop:!0}),(0,se.Y)("div",{className:"qLSm0uyC",children:l("FrozenAccountModalTitle")})]}),[l]),u=(0,s.Kr)(()=>{if(c)return(0,se.FD)("div",{className:"Vj3QQ_JQ",children:[(0,se.Y)(X.A,{className:"anvg3JaY",onClick:h,children:l("ButtonAppeal")}),(0,se.Y)(X.A,{isText:!0,onClick:d,children:l("ButtonUnderstood")})]})},[l,c]),p=(0,s.Kr)(()=>{if(!t||!o)return;const e=new Date(1e3*t),i=(0,se.Y)(fa.A,{onClick:h,isPrimary:!0,children:(0,Ac.A)(o)});return[["hand-stop",l("FrozenAccountViolationTitle"),l("FrozenAccountViolationSubtitle")],["lock",l("FrozenAccountReadOnlyTitle"),l("FrozenAccountReadOnlySubtitle")],["frozen-time",l("FrozenAccountAppealTitle"),l("FrozenAccountAppealSubtitle",{botLink:i,date:(0,We.A)(e,l.code)},{withNodes:!0})]]},[l,o,t]);if(p)return(0,se.Y)(il.A,{isOpen:c,header:m,listItemData:p,footer:u,onClose:d})})),GA={header:"ChJT6ggP",description:"ravQhVQQ",descriptionPreview:"_K5HhOM0",negative:"X6iX4F56",previewLink:"yY4hj8r_",backLink:"dcNVNCXo",title:"IvsV0tkW",ratingProgress:"XYpzs7CQ",withPreview:"UgviXkNW",footer:"XtZPIDLP",badge:"JdeFDQBI",understoodIcon:"Lwz8rpdL",badgeAdded:"Lr6JUU14",badgeDeducted:"OxZxdqcn"},jA=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=e.currentUserId,s=t?.userId?(0,c.mBe)(e,t.userId):void 0,n=t?.userId?(0,c.vGo)(e,t.userId):void 0,o=n?.starsRating,a=n?.starsMyPendingRating,r=n?.starsMyPendingRatingDate;return{user:s,currentUserId:i,starsRating:o,pendingRating:a,pendingRatingDate:r}})(({modal:e,user:t,currentUserId:i,starsRating:o,pendingRating:a,pendingRatingDate:r})=>{const{closeProfileRatingModal:l}=(0,n.ko)(),c=(0,Fi.A)(),d=Boolean(e),h=(0,Si.A)(t),m=(0,Si.A)(o),u=(0,Si.A)(a),p=(0,Si.A)(r),[v,g]=(0,s.J0)(!1),A=(0,T.A)(()=>{l()});(0,s.vJ)(()=>{d||g(!1)},[d]);const f=(0,T.A)(()=>{g(!0)}),b=(0,T.A)(()=>{g(!1)}),C=e=>{const t="added"===e,i=c(t?"RatingBadgeAdded":"RatingBadgeDeducted"),s=t?GA.badgeAdded:GA.badgeDeducted;return(0,se.Y)("span",{className:(0,ge.A)(GA.badge,s),children:i})},y=(0,s.Kr)(()=>{if(!h||!m)return;const e=v&&u?u:m,t=e.stars,s=e.currentLevelStars,n=e.nextLevelStars,o=e.level,a=o+1,r=o<0,l=!v&&u?u.level:m.level;let d=0;d=n&&n>s?Math.max(.03,(t-s)/(n-s)):1;const g=r?.5:Math.max(0,Math.min(1,d)),A=p?p-(0,Ii.Fm)():0,C=u?u.stars-m.stars:0,y=u&&p;let S="none";o>=0&&l>=0&&o!==l&&(S=o>l?"forward":"backward"),o<0&&l<0&&o!==l&&(S=o<l?"backward":"forward");const N=c("ActionFallbackUser");return(0,se.FD)("div",{className:GA.header,children:[(0,se.Y)(Rr.A,{leftText:r?void 0:c("RatingLevel",{level:o}),rightText:r?c("RatingNegativeLevel"):c("RatingLevel",{level:a}),floatingBadgeIcon:r?"warning":"crown-wear",floatingBadgeText:r?o.toString():`${c.number(t)} / ${c.number(n||t)}`,progress:g,isPrimary:o>=0,isNegative:o<0,animationDirection:S,className:(0,ge.A)(GA.ratingProgress,y&&GA.withPreview)}),(()=>{if(y)return(0,se.Y)(ae.Ay,{name:"fade",className:(0,ge.A)(GA.descriptionPreview,r&&GA.negative),activeKey:v?1:0,shouldCleanup:!0,shouldRestoreHeight:!0,children:v?(0,se.Y)("p",{children:c("DescriptionFutureRating",{time:(0,We.A$)(c,A),points:Math.abs(C),link:(0,se.Y)("span",{className:GA.backLink,onClick:b,children:c("LinkDescriptionRatingBack")})},{pluralValue:Math.abs(C),withNodes:!0})}):(0,se.Y)("p",{children:c("DescriptionPendingRating",{time:(0,We.A$)(c,A),points:Math.abs(C),link:(0,se.Y)("span",{className:GA.previewLink,onClick:f,children:c("LinkDescriptionRatingPreview")})},{pluralValue:Math.abs(C),withNodes:!0})})})})(),(0,se.Y)("div",{className:GA.title,children:c("TitleRating")}),(0,se.Y)("p",{className:GA.description,children:h?.id===i?c("RatingYourReflectsActivity"):c("RatingReflectsActivity",{name:(0,It.F9)(c,h)||N},{withMarkdown:!0,withNodes:!0})})]})},[h,i,m,u,p,v,c,f,b]),S=[["closed-gift",c("RatingGiftsFromTelegram"),(0,se.FD)("span",{children:[C("added"),c("RatingGiftsFromTelegramDesc")]})],["user-stars",c("RatingGiftsAndPostsFromUsers"),(0,se.FD)("span",{children:[C("added"),c("RatingGiftsAndPostsFromUsersDesc")]})],["stars-refund",c("RatingRefundsAndConversions"),(0,se.FD)("span",{children:[C("deducted"),c("RatingRefundsAndConversionsDesc")]})]],N=(0,s.Kr)(()=>(0,se.Y)("div",{className:GA.footer,children:(0,se.Y)(X.A,{onClick:A,iconName:"understood",iconClassName:GA.understoodIcon,children:c("ButtonUnderstood")})}),[c,A]);return(0,se.Y)(il.A,{contentClassName:GA.content,isOpen:d,header:y,listItemData:S,footer:N,onClose:A})}));var zA=i(46442),HA=i(76786);const $A=(0,s.ph)((0,n.EK)((e,{chatId:t,threadId:i})=>{const s=(0,c.hds)(e,t),n=(0,c.C5H)(e,t,i||G.l3,"typingStatus"),o=(0,l.cG)(t,i||G.l3,e.currentUserId),a=s?.isForum&&i?(0,c.S0q)(e,t,i)?.unreadCount:s?.unreadCount;return{chat:s,connectionState:e.connectionState,isSyncing:e.isSyncing,isFetchingDifference:e.isFetchingDifference,typingStatus:n,isSavedDialog:o,unreadCount:a,hasUnreadMark:s?.hasUnreadMark}})(({chatId:e,threadId:t,chat:i,connectionState:s,isSyncing:o,isFetchingDifference:a,typingStatus:r,isSavedDialog:l,unreadCount:c,hasUnreadMark:d,onClose:h})=>{const m=(0,Fi.A)(),u=(0,B.A)(),{markChatMessagesRead:p}=(0,n.ko)(),{connectionStatusText:g}=(0,HA.A)(u,s,o||a,!0),A=(0,T.A)(()=>{p({id:e})}),f=l?m("SavedMessages"):void 0,b=l?String(G.l3):e,C=i?.isMonoforum?i.linkedMonoforumId:b;return(0,se.FD)("div",{className:"LyrhszzE",children:[Boolean(c||d)&&(0,se.Y)(X.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:m("ChatListContextMaskAsRead"),onClick:A,className:"Bp8eDIso",iconName:"readchats"}),(0,se.Y)(X.A,{round:!0,color:"translucent",size:"tiny",ariaLabel:m("Close"),onClick:h,className:"jHVcj192",iconName:"close"}),(0,se.Y)("div",{className:"modal-title",children:(0,se.Y)("div",{className:"FsTceiGs",children:(0,v.L8)(C)?(0,se.Y)(ms.A,{userId:C,typingStatus:r,status:g||f,withDots:Boolean(g),withFullInfo:!1,withMediaViewer:!1,withStory:!1,withUpdatingStatus:!0,isSavedDialog:l,emojiStatusSize:22,noRtl:!0},C):(0,se.Y)(hs.A,{chatId:C,threadId:l?void 0:t,typingStatus:r,withMonoforumStatus:i?.isMonoforum,status:g||f,withDots:Boolean(g),withMediaViewer:!1,withFullInfo:!1,withUpdatingStatus:!0,withStory:!1,isSavedDialog:l,emojiStatusSize:22,noRtl:!0},C)})})]})}));var qA=i(38353);const WA=(0,s.ph)((0,n.EK)((e,{modal:t})=>{const i=(0,c.SJA)(e),{isBlurred:s,background:n,backgroundColor:o,patternColor:a}=(0,c.Gyz)(e,i)||{};return{theme:i,customBackground:n,backgroundColor:o,patternColor:a,isBackgroundBlurred:s}})(({modal:e,theme:t,customBackground:i,backgroundColor:o,patternColor:a,isBackgroundBlurred:r})=>{const{closeQuickPreview:l,openChat:c,openThread:d}=(0,n.ko)(),h=e?.chatId,m=e?.threadId,p=Boolean(h),v=(0,Pl.A)(t,i),g=(0,T.A)(()=>{l()}),A=(0,T.A)(()=>{h&&(m?d({chatId:h,threadId:m,shouldReplaceHistory:!0}):c({id:h,shouldReplaceHistory:!0}),l())});(0,s.vJ)(()=>p?(0,u.A)(g):void 0,[p,g]),(0,Ne.A)({isActive:p,onBack:g});const{chatId:f,threadId:b}=(0,Si.A)(e,!0)||{},C=(0,ge.A)(qA.A.background,i&&qA.A.customBgImage,o&&qA.A.customBgColor,i&&r&&qA.A.blurred);if(f)return(0,se.Y)(te.A,{isOpen:p,onClose:g,header:(0,se.Y)($A,{chatId:f,threadId:b,onClose:g}),className:"hJTLQd8O",contentClassName:"zUonvDbp",children:(0,se.FD)("div",{className:"NYlix6SL",style:(0,tt.A)(`--pattern-color: ${a}`,o&&`--theme-background-color: ${o}`),onClick:A,children:[(0,se.Y)("div",{className:C,style:v?`--custom-background: ${v}`:void 0}),(0,se.Y)("div",{className:"IJ0EBwJk",children:(0,se.Y)(zA.A,{chatId:f,threadId:b||G.l3,type:"thread",canPost:!1,isReady:!0,withDefaultBg:Boolean(!i&&!o),isQuickPreview:!0})})]})})})),QA=(0,s.ph)((0,n.EK)(e=>({isStoryViewerOpen:(0,c.gd2)(e),stealthMode:e.stories.stealthMode,isCurrentUserPremium:(0,c.g29)(e)}))(({modal:e,isStoryViewerOpen:t,stealthMode:i,isCurrentUserPremium:o})=>{const{closeStealthModal:a,activateStealthMode:r,showNotification:l,openPremiumModal:c,openStoryViewer:d}=(0,n.ko)(),h=(0,Fi.A)(),m=(0,M.A)(),u=Boolean(i?.cooldownUntil&&i.cooldownUntil>(0,Ii.Fm)()),p=Boolean(e),v=(0,Si.A)(e),{targetPeerId:g}=v||{},A=(0,T.A)(()=>{m()}),f=(0,T.A)(()=>{a()}),b=(0,T.A)(()=>{if(!o)return c({initialSection:"stories"}),void f();r(),l({title:{key:"StealthModeOnTitle"},message:{key:"StealthModeOnHintEnabled"}}),g&&d({peerId:g}),f()}),C=(0,s.Kr)(()=>(0,se.FD)(se.FK,{children:[(0,se.Y)("h3",{className:"WJuiuEDm",children:h("StealthModeTitle")}),(0,se.Y)("div",{className:"G9N9Bt0G",children:h(o?"StealthModeDescription":"StealthModeDescriptionPremium")})]}),[h,o]),y=(0,s.Kr)(()=>[["stealth-past",h("StealthModeHideRecentTitle"),h("StealthModeHideRecentDescription")],["stealth-future",h("StealthModeHideFutureTitle"),h("StealthModeHideFutureDescription")]],[h]),S=(0,s.Kr)(()=>o?u?h("StealthModeButtonRecharge",{timer:(0,se.Y)(hd.A,{endsAt:i.cooldownUntil,onEnd:A})},{withNodes:!0}):h(g?"StealthModeButtonToStory":"StealthModeButton"):h("StealthModeButtonPremium"),[o,u,h,i,g]);return(0,se.Y)(il.A,{isOpen:p,className:(0,ge.A)(t&&"component-theme-dark"),header:C,headerIconName:"eye-crossed-outline",listItemData:y,buttonText:S,onButtonClick:b,onClose:f})}))}}]);
//# sourceMappingURL=9451.925d4a065666a4f29029.js.map