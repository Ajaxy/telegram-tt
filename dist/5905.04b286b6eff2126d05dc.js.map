{"version":3,"file":"5905.04b286b6eff2126d05dc.js","mappings":"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","sources":["webpack://telegram-t/./node_modules/mp4box/dist/mp4box.all.js"],"sourcesContent":["// file:src/log.js\n/* \n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar Log = (function (){\n\t\tvar start = new Date();\n\t\tvar LOG_LEVEL_ERROR \t= 4;\n\t\tvar LOG_LEVEL_WARNING \t= 3;\n\t\tvar LOG_LEVEL_INFO \t\t= 2;\n\t\tvar LOG_LEVEL_DEBUG\t\t= 1;\n\t\tvar log_level = LOG_LEVEL_ERROR;\n\t\tvar logObject = {\n\t\t\tsetLogLevel : function(level) {\n\t\t\t\tif (level == this.debug) log_level = LOG_LEVEL_DEBUG;\n\t\t\t\telse if (level == this.info) log_level = LOG_LEVEL_INFO;\n\t\t\t\telse if (level == this.warn) log_level = LOG_LEVEL_WARNING;\n\t\t\t\telse if (level == this.error) log_level = LOG_LEVEL_ERROR;\n\t\t\t\telse log_level = LOG_LEVEL_ERROR;\n\t\t\t},\n\t\t\tdebug : function(module, msg) {\n\t\t\t\tif (console.debug === undefined) {\n\t\t\t\t\tconsole.debug = console.log;\n\t\t\t\t}\n\t\t\t\tif (LOG_LEVEL_DEBUG >= log_level) {\n\t\t\t\t\tconsole.debug(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\tlog : function(module, msg) {\n\t\t\t\tthis.debug(module.msg)\n\t\t\t},\n\t\t\tinfo : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_INFO >= log_level) {\n\t\t\t\t\tconsole.info(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\twarn : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_WARNING >= log_level) {\n\t\t\t\t\tconsole.warn(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\terror : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_ERROR >= log_level) {\n\t\t\t\t\tconsole.error(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn logObject;\n\t})();\n\t\n/* Helper function to print a duration value in the form H:MM:SS.MS */\nLog.getDurationString = function(duration, _timescale) {\n\tvar neg;\n\t/* Helper function to print a number on a fixed number of digits */\n\tfunction pad(number, length) {\n\t\tvar str = '' + number;\n\t\tvar a = str.split('.');\t\t\n\t\twhile (a[0].length < length) {\n\t\t\ta[0] = '0' + a[0];\n\t\t}\n\t\treturn a.join('.');\n\t}\n\tif (duration < 0) {\n\t\tneg = true;\n\t\tduration = -duration;\n\t} else {\n\t\tneg = false;\t\n\t}\n\tvar timescale = _timescale || 1;\n\tvar duration_sec = duration/timescale;\n\tvar hours = Math.floor(duration_sec/3600);\n\tduration_sec -= hours * 3600;\n\tvar minutes = Math.floor(duration_sec/60);\n\tduration_sec -= minutes * 60;\t\t\n\tvar msec = duration_sec*1000;\n\tduration_sec = Math.floor(duration_sec);\n\tmsec -= duration_sec*1000;\n\tmsec = Math.floor(msec);\n\treturn (neg ? \"-\": \"\")+hours+\":\"+pad(minutes,2)+\":\"+pad(duration_sec,2)+\".\"+pad(msec,3);\n}\n\t\n/* Helper function to stringify HTML5 TimeRanges objects */\t\nLog.printRanges = function(ranges) {\n\tvar length = ranges.length;\n\tif (length > 0) {\n\t\tvar str = \"\";\n\t\tfor (var i = 0; i < length; i++) {\n\t\t  if (i > 0) str += \",\";\n\t\t  str += \"[\"+Log.getDurationString(ranges.start(i))+ \",\"+Log.getDurationString(ranges.end(i))+\"]\";\n\t\t}\n\t\treturn str;\n\t} else {\n\t\treturn \"(empty)\";\n\t}\n}\n\nif (typeof exports !== 'undefined') {\n\texports.Log = Log;\n}\n// file:src/stream.js\nvar MP4BoxStream = function(arrayBuffer) {\n  if (arrayBuffer instanceof ArrayBuffer) {\n    this.buffer = arrayBuffer;\n    this.dataview = new DataView(arrayBuffer);\n  } else {\n    throw (\"Needs an array buffer\");\n  }\n  this.position = 0;\n};\n\n/*************************************************************************\n  Common API between MultiBufferStream and SimpleStream\n *************************************************************************/\nMP4BoxStream.prototype.getPosition = function() {\n  return this.position;\n}\n\nMP4BoxStream.prototype.getEndPosition = function() {\n  return this.buffer.byteLength;\n}\n\nMP4BoxStream.prototype.getLength = function() {\n  return this.buffer.byteLength;\n}\n\nMP4BoxStream.prototype.seek = function (pos) {\n  var npos = Math.max(0, Math.min(this.buffer.byteLength, pos));\n  this.position = (isNaN(npos) || !isFinite(npos)) ? 0 : npos;\n  return true;\n}\n\nMP4BoxStream.prototype.isEos = function () {\n  return this.getPosition() >= this.getEndPosition();\n}\n\n/*************************************************************************\n  Read methods, simimar to DataStream but simpler\n *************************************************************************/\nMP4BoxStream.prototype.readAnyInt = function(size, signed) {\n  var res = 0;\n  if (this.position + size <= this.buffer.byteLength) {\n    switch (size) {\n      case 1:\n        if (signed) {\n          res = this.dataview.getInt8(this.position);\n        } else {\n          res = this.dataview.getUint8(this.position);\n        }\n        break;\n      case 2:\n        if (signed) {\n          res = this.dataview.getInt16(this.position);\n        } else {\n          res = this.dataview.getUint16(this.position);\n        }\n        break;\n      case 3:\n        if (signed) {\n          throw (\"No method for reading signed 24 bits values\");\n        } else {\n          res = this.dataview.getUint8(this.position) << 16;\n          res |= this.dataview.getUint8(this.position+1) << 8;\n          res |= this.dataview.getUint8(this.position+2);\n        }\n        break;\n      case 4:\n        if (signed) {\n          res = this.dataview.getInt32(this.position);\n        } else {\n          res = this.dataview.getUint32(this.position);\n        }\n        break;\n      case 8:\n        if (signed) {\n          throw (\"No method for reading signed 64 bits values\");\n        } else {\n          res = this.dataview.getUint32(this.position) << 32;\n          res |= this.dataview.getUint32(this.position+4);\n        }\n        break;\n      default:\n        throw (\"readInt method not implemented for size: \"+size);\n    }\n    this.position+= size;\n    return res;\n  } else {\n    throw (\"Not enough bytes in buffer\");\n  }\n}\n\nMP4BoxStream.prototype.readUint8 = function() {\n  return this.readAnyInt(1, false);\n}\n\nMP4BoxStream.prototype.readUint16 = function() {\n  return this.readAnyInt(2, false);\n}\n\nMP4BoxStream.prototype.readUint24 = function() {\n  return this.readAnyInt(3, false);\n}\n\nMP4BoxStream.prototype.readUint32 = function() {\n  return this.readAnyInt(4, false);\n}\n\nMP4BoxStream.prototype.readUint64 = function() {\n  return this.readAnyInt(8, false);\n}\n\nMP4BoxStream.prototype.readString = function(length) {\n  if (this.position + length <= this.buffer.byteLength) {\n    var s = \"\";\n    for (var i = 0; i < length; i++) {\n      s += String.fromCharCode(this.readUint8());\n    }\n    return s;\n  } else {\n    throw (\"Not enough bytes in buffer\");\n  }\n}\n\nMP4BoxStream.prototype.readCString = function() {\n  var arr = [];\n  while(true) {\n    var b = this.readUint8();\n    if (b !== 0) {\n      arr.push(b);\n    } else {\n      break;\n    }\n  }\n  return String.fromCharCode.apply(null, arr); \n}\n\nMP4BoxStream.prototype.readInt8 = function() {\n  return this.readAnyInt(1, true);\n}\n\nMP4BoxStream.prototype.readInt16 = function() {\n  return this.readAnyInt(2, true);\n}\n\nMP4BoxStream.prototype.readInt32 = function() {\n  return this.readAnyInt(4, true);\n}\n\nMP4BoxStream.prototype.readInt64 = function() {\n  return this.readAnyInt(8, false);\n}\n\nMP4BoxStream.prototype.readUint8Array = function(length) {\n  var arr = new Uint8Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint8();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readInt16Array = function(length) {\n  var arr = new Int16Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readInt16();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readUint16Array = function(length) {\n  var arr = new Int16Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint16();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readUint32Array = function(length) {\n  var arr = new Uint32Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint32();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readInt32Array = function(length) {\n  var arr = new Int32Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readInt32();\n  }\n  return arr;\n}\n\nif (typeof exports !== 'undefined') {\n  exports.MP4BoxStream = MP4BoxStream;\n}// file:src/DataStream.js\n/**\n  DataStream reads scalars, arrays and structs of data from an ArrayBuffer.\n  It's like a file-like DataView on steroids.\n\n  @param {ArrayBuffer} arrayBuffer ArrayBuffer to read from.\n  @param {?Number} byteOffset Offset from arrayBuffer beginning for the DataStream.\n  @param {?Boolean} endianness DataStream.BIG_ENDIAN or DataStream.LITTLE_ENDIAN (the default).\n  */\nvar DataStream = function(arrayBuffer, byteOffset, endianness) {\n  this._byteOffset = byteOffset || 0;\n  if (arrayBuffer instanceof ArrayBuffer) {\n    this.buffer = arrayBuffer;\n  } else if (typeof arrayBuffer == \"object\") {\n    this.dataView = arrayBuffer;\n    if (byteOffset) {\n      this._byteOffset += byteOffset;\n    }\n  } else {\n    this.buffer = new ArrayBuffer(arrayBuffer || 0);\n  }\n  this.position = 0;\n  this.endianness = endianness == null ? DataStream.LITTLE_ENDIAN : endianness;\n};\nDataStream.prototype = {};\n\nDataStream.prototype.getPosition = function() {\n  return this.position;\n}\n\n/**\n  Internal function to resize the DataStream buffer when required.\n  @param {number} extra Number of bytes to add to the buffer allocation.\n  @return {null}\n  */\nDataStream.prototype._realloc = function(extra) {\n  if (!this._dynamicSize) {\n    return;\n  }\n  var req = this._byteOffset + this.position + extra;\n  var blen = this._buffer.byteLength;\n  if (req <= blen) {\n    if (req > this._byteLength) {\n      this._byteLength = req;\n    }\n    return;\n  }\n  if (blen < 1) {\n    blen = 1;\n  }\n  while (req > blen) {\n    blen *= 2;\n  }\n  var buf = new ArrayBuffer(blen);\n  var src = new Uint8Array(this._buffer);\n  var dst = new Uint8Array(buf, 0, src.length);\n  dst.set(src);\n  this.buffer = buf;\n  this._byteLength = req;\n};\n\n/**\n  Internal function to trim the DataStream buffer when required.\n  Used for stripping out the extra bytes from the backing buffer when\n  the virtual byteLength is smaller than the buffer byteLength (happens after\n  growing the buffer with writes and not filling the extra space completely).\n\n  @return {null}\n  */\nDataStream.prototype._trimAlloc = function() {\n  if (this._byteLength == this._buffer.byteLength) {\n    return;\n  }\n  var buf = new ArrayBuffer(this._byteLength);\n  var dst = new Uint8Array(buf);\n  var src = new Uint8Array(this._buffer, 0, dst.length);\n  dst.set(src);\n  this.buffer = buf;\n};\n\n\n/**\n  Big-endian const to use as default endianness.\n  @type {boolean}\n  */\nDataStream.BIG_ENDIAN = false;\n\n/**\n  Little-endian const to use as default endianness.\n  @type {boolean}\n  */\nDataStream.LITTLE_ENDIAN = true;\n\n/**\n  Virtual byte length of the DataStream backing buffer.\n  Updated to be max of original buffer size and last written size.\n  If dynamicSize is false is set to buffer size.\n  @type {number}\n  */\nDataStream.prototype._byteLength = 0;\n\n/**\n  Returns the byte length of the DataStream object.\n  @type {number}\n  */\nObject.defineProperty(DataStream.prototype, 'byteLength',\n  { get: function() {\n    return this._byteLength - this._byteOffset;\n  }});\n\n/**\n  Set/get the backing ArrayBuffer of the DataStream object.\n  The setter updates the DataView to point to the new buffer.\n  @type {Object}\n  */\nObject.defineProperty(DataStream.prototype, 'buffer',\n  { get: function() {\n      this._trimAlloc();\n      return this._buffer;\n    },\n    set: function(v) {\n      this._buffer = v;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._buffer.byteLength;\n    } });\n\n/**\n  Set/get the byteOffset of the DataStream object.\n  The setter updates the DataView to point to the new byteOffset.\n  @type {number}\n  */\nObject.defineProperty(DataStream.prototype, 'byteOffset',\n  { get: function() {\n      return this._byteOffset;\n    },\n    set: function(v) {\n      this._byteOffset = v;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._buffer.byteLength;\n    } });\n\n/**\n  Set/get the backing DataView of the DataStream object.\n  The setter updates the buffer and byteOffset to point to the DataView values.\n  @type {Object}\n  */\nObject.defineProperty(DataStream.prototype, 'dataView',\n  { get: function() {\n      return this._dataView;\n    },\n    set: function(v) {\n      this._byteOffset = v.byteOffset;\n      this._buffer = v.buffer;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._byteOffset + v.byteLength;\n    } });\n\n/**\n  Sets the DataStream read/write position to given position.\n  Clamps between 0 and DataStream length.\n\n  @param {number} pos Position to seek to.\n  @return {null}\n  */\nDataStream.prototype.seek = function(pos) {\n  var npos = Math.max(0, Math.min(this.byteLength, pos));\n  this.position = (isNaN(npos) || !isFinite(npos)) ? 0 : npos;\n};\n\n/**\n  Returns true if the DataStream seek pointer is at the end of buffer and\n  there's no more data to read.\n\n  @return {boolean} True if the seek pointer is at the end of the buffer.\n  */\nDataStream.prototype.isEof = function() {\n  return (this.position >= this._byteLength);\n};\n\n\n/**\n  Maps a Uint8Array into the DataStream buffer.\n\n  Nice for quickly reading in data.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint8Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint8Array = function(length) {\n  this._realloc(length * 1);\n  var arr = new Uint8Array(this._buffer, this.byteOffset+this.position, length);\n  this.position += length * 1;\n  return arr;\n};\n\n\n/**\n  Reads an Int32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int32Array.\n */\nDataStream.prototype.readInt32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Int32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads an Int16Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int16Array.\n */\nDataStream.prototype.readInt16Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 2) : length;\n  var arr = new Int16Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads an Int8Array of desired length from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int8Array.\n */\nDataStream.prototype.readInt8Array = function(length) {\n  length = length == null ? (this.byteLength-this.position) : length;\n  var arr = new Int8Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint32Array.\n */\nDataStream.prototype.readUint32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Uint32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint16Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint16Array.\n */\nDataStream.prototype.readUint16Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 2) : length;\n  var arr = new Uint16Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint8Array of desired length from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint8Array.\n */\nDataStream.prototype.readUint8Array = function(length) {\n  length = length == null ? (this.byteLength-this.position) : length;\n  var arr = new Uint8Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Float64Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Float64Array.\n */\nDataStream.prototype.readFloat64Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 8) : length;\n  var arr = new Float64Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Float32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Float32Array.\n */\nDataStream.prototype.readFloat32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Float32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n\n/**\n  Reads a 32-bit int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readInt32 = function(e) {\n  var v = this._dataView.getInt32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 16-bit int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readInt16 = function(e) {\n  var v = this._dataView.getInt16(this.position, e == null ? this.endianness : e);\n  this.position += 2;\n  return v;\n};\n\n/**\n  Reads an 8-bit int from the DataStream.\n\n  @return {number} The read number.\n */\nDataStream.prototype.readInt8 = function() {\n  var v = this._dataView.getInt8(this.position);\n  this.position += 1;\n  return v;\n};\n\n/**\n  Reads a 32-bit unsigned int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readUint32 = function(e) {\n  var v = this._dataView.getUint32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 16-bit unsigned int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readUint16 = function(e) {\n  var v = this._dataView.getUint16(this.position, e == null ? this.endianness : e);\n  this.position += 2;\n  return v;\n};\n\n/**\n  Reads an 8-bit unsigned int from the DataStream.\n\n  @return {number} The read number.\n */\nDataStream.prototype.readUint8 = function() {\n  var v = this._dataView.getUint8(this.position);\n  this.position += 1;\n  return v;\n};\n\n/**\n  Reads a 32-bit float from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readFloat32 = function(e) {\n  var v = this._dataView.getFloat32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 64-bit float from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readFloat64 = function(e) {\n  var v = this._dataView.getFloat64(this.position, e == null ? this.endianness : e);\n  this.position += 8;\n  return v;\n};\n\n/**\n  Native endianness. Either DataStream.BIG_ENDIAN or DataStream.LITTLE_ENDIAN\n  depending on the platform endianness.\n\n  @type {boolean}\n */\nDataStream.endianness = new Int8Array(new Int16Array([1]).buffer)[0] > 0;\n\n/**\n  Copies byteLength bytes from the src buffer at srcOffset to the\n  dst buffer at dstOffset.\n\n  @param {Object} dst Destination ArrayBuffer to write to.\n  @param {number} dstOffset Offset to the destination ArrayBuffer.\n  @param {Object} src Source ArrayBuffer to read from.\n  @param {number} srcOffset Offset to the source ArrayBuffer.\n  @param {number} byteLength Number of bytes to copy.\n */\nDataStream.memcpy = function(dst, dstOffset, src, srcOffset, byteLength) {\n  var dstU8 = new Uint8Array(dst, dstOffset, byteLength);\n  var srcU8 = new Uint8Array(src, srcOffset, byteLength);\n  dstU8.set(srcU8);\n};\n\n/**\n  Converts array to native endianness in-place.\n\n  @param {Object} array Typed array to convert.\n  @param {boolean} arrayIsLittleEndian True if the data in the array is\n                                       little-endian. Set false for big-endian.\n  @return {Object} The converted typed array.\n */\nDataStream.arrayToNative = function(array, arrayIsLittleEndian) {\n  if (arrayIsLittleEndian == this.endianness) {\n    return array;\n  } else {\n    return this.flipArrayEndianness(array);\n  }\n};\n\n/**\n  Converts native endianness array to desired endianness in-place.\n\n  @param {Object} array Typed array to convert.\n  @param {boolean} littleEndian True if the converted array should be\n                                little-endian. Set false for big-endian.\n  @return {Object} The converted typed array.\n */\nDataStream.nativeToEndian = function(array, littleEndian) {\n  if (this.endianness == littleEndian) {\n    return array;\n  } else {\n    return this.flipArrayEndianness(array);\n  }\n};\n\n/**\n  Flips typed array endianness in-place.\n\n  @param {Object} array Typed array to flip.\n  @return {Object} The converted typed array.\n */\nDataStream.flipArrayEndianness = function(array) {\n  var u8 = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\n  for (var i=0; i<array.byteLength; i+=array.BYTES_PER_ELEMENT) {\n    for (var j=i+array.BYTES_PER_ELEMENT-1, k=i; j>k; j--, k++) {\n      var tmp = u8[k];\n      u8[k] = u8[j];\n      u8[j] = tmp;\n    }\n  }\n  return array;\n};\n\n/**\n  Seek position where DataStream#readStruct ran into a problem.\n  Useful for debugging struct parsing.\n\n  @type {number}\n */\nDataStream.prototype.failurePosition = 0;\n\nString.fromCharCodeUint8 = function(uint8arr) {\n    var arr = [];\n    for (var i = 0; i < uint8arr.length; i++) {\n      arr[i] = uint8arr[i];\n    }\n    return String.fromCharCode.apply(null, arr);\n}\n/**\n  Read a string of desired length and encoding from the DataStream.\n\n  @param {number} length The length of the string to read in bytes.\n  @param {?string} encoding The encoding of the string data in the DataStream.\n                            Defaults to ASCII.\n  @return {string} The read string.\n */\nDataStream.prototype.readString = function(length, encoding) {\n  if (encoding == null || encoding == \"ASCII\") {\n    return String.fromCharCodeUint8.apply(null, [this.mapUint8Array(length == null ? this.byteLength-this.position : length)]);\n  } else {\n    return (new TextDecoder(encoding)).decode(this.mapUint8Array(length));\n  }\n};\n\n/**\n  Read null-terminated string of desired length from the DataStream. Truncates\n  the returned string so that the null byte is not a part of it.\n\n  @param {?number} length The length of the string to read.\n  @return {string} The read string.\n */\nDataStream.prototype.readCString = function(length) {\n  var blen = this.byteLength-this.position;\n  var u8 = new Uint8Array(this._buffer, this._byteOffset + this.position);\n  var len = blen;\n  if (length != null) {\n    len = Math.min(length, blen);\n  }\n  for (var i = 0; i < len && u8[i] !== 0; i++); // find first zero byte\n  var s = String.fromCharCodeUint8.apply(null, [this.mapUint8Array(i)]);\n  if (length != null) {\n    this.position += len-i;\n  } else if (i != blen) {\n    this.position += 1; // trailing zero if not at end of buffer\n  }\n  return s;\n};\n\n/* \n   TODO: fix endianness for 24/64-bit fields\n   TODO: check range/support for 64-bits numbers in JavaScript\n*/\nvar MAX_SIZE = Math.pow(2, 32);\n\nDataStream.prototype.readInt64 = function () {\n  return (this.readInt32()*MAX_SIZE)+this.readUint32();\n}\nDataStream.prototype.readUint64 = function () {\n\treturn (this.readUint32()*MAX_SIZE)+this.readUint32();\n}\n\nDataStream.prototype.readInt64 = function () {\n  return (this.readUint32()*MAX_SIZE)+this.readUint32();\n}\n\nDataStream.prototype.readUint24 = function () {\n\treturn (this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8();\n}\n\nif (typeof exports !== 'undefined') {\n  exports.DataStream = DataStream;  \n}\n// file:src/DataStream-write.js\n/**\n  Saves the DataStream contents to the given filename.\n  Uses Chrome's anchor download property to initiate download.\n \n  @param {string} filename Filename to save as.\n  @return {null}\n  */\nDataStream.prototype.save = function(filename) {\n  var blob = new Blob([this.buffer]);\n  if (window.URL && URL.createObjectURL) {\n      var url = window.URL.createObjectURL(blob);\n      var a = document.createElement('a');\n      // Required in Firefox:\n      document.body.appendChild(a);\n      a.setAttribute('href', url);\n      a.setAttribute('download', filename);\n      // Required in Firefox:\n      a.setAttribute('target', '_self');\n      a.click();\n      window.URL.revokeObjectURL(url);\n  } else {\n      throw(\"DataStream.save: Can't create object URL.\");\n  }\n};\n\n/**\n  Whether to extend DataStream buffer when trying to write beyond its size.\n  If set, the buffer is reallocated to twice its current size until the\n  requested write fits the buffer.\n  @type {boolean}\n  */\nDataStream.prototype._dynamicSize = true;\nObject.defineProperty(DataStream.prototype, 'dynamicSize',\n  { get: function() {\n      return this._dynamicSize;\n    },\n    set: function(v) {\n      if (!v) {\n        this._trimAlloc();\n      }\n      this._dynamicSize = v;\n    } });\n\n/**\n  Internal function to trim the DataStream buffer when required.\n  Used for stripping out the first bytes when not needed anymore.\n\n  @return {null}\n  */\nDataStream.prototype.shift = function(offset) {\n  var buf = new ArrayBuffer(this._byteLength-offset);\n  var dst = new Uint8Array(buf);\n  var src = new Uint8Array(this._buffer, offset, dst.length);\n  dst.set(src);\n  this.buffer = buf;\n  this.position -= offset;\n};\n\n/**\n  Writes an Int32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeInt32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Int32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt32(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes an Int16Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeInt16Array = function(arr, e) {\n  this._realloc(arr.length * 2);\n  if (arr instanceof Int16Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt16Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt16(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes an Int8Array to the DataStream.\n\n  @param {Object} arr The array to write.\n */\nDataStream.prototype.writeInt8Array = function(arr) {\n  this._realloc(arr.length * 1);\n  if (arr instanceof Int8Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt8Array(arr.length);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt8(arr[i]);\n    }\n  }\n};\n\n/**\n  Writes a Uint32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeUint32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Uint32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint32(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Uint16Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeUint16Array = function(arr, e) {\n  this._realloc(arr.length * 2);\n  if (arr instanceof Uint16Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint16Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint16(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Uint8Array to the DataStream.\n\n  @param {Object} arr The array to write.\n */\nDataStream.prototype.writeUint8Array = function(arr) {\n  this._realloc(arr.length * 1);\n  if (arr instanceof Uint8Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint8Array(arr.length);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint8(arr[i]);\n    }\n  }\n};\n\n/**\n  Writes a Float64Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeFloat64Array = function(arr, e) {\n  this._realloc(arr.length * 8);\n  if (arr instanceof Float64Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapFloat64Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeFloat64(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Float32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeFloat32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Float32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapFloat32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeFloat32(arr[i], e);\n    }\n  }\n};\n\n\n/**\n  Writes a 32-bit int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeInt32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setInt32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 16-bit int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeInt16 = function(v, e) {\n  this._realloc(2);\n  this._dataView.setInt16(this.position, v, e == null ? this.endianness : e);\n  this.position += 2;\n};\n\n/**\n  Writes an 8-bit int to the DataStream.\n\n  @param {number} v Number to write.\n */\nDataStream.prototype.writeInt8 = function(v) {\n  this._realloc(1);\n  this._dataView.setInt8(this.position, v);\n  this.position += 1;\n};\n\n/**\n  Writes a 32-bit unsigned int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeUint32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setUint32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 16-bit unsigned int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeUint16 = function(v, e) {\n  this._realloc(2);\n  this._dataView.setUint16(this.position, v, e == null ? this.endianness : e);\n  this.position += 2;\n};\n\n/**\n  Writes an 8-bit unsigned  int to the DataStream.\n\n  @param {number} v Number to write.\n */\nDataStream.prototype.writeUint8 = function(v) {\n  this._realloc(1);\n  this._dataView.setUint8(this.position, v);\n  this.position += 1;\n};\n\n/**\n  Writes a 32-bit float to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeFloat32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setFloat32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 64-bit float to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeFloat64 = function(v, e) {\n  this._realloc(8);\n  this._dataView.setFloat64(this.position, v, e == null ? this.endianness : e);\n  this.position += 8;\n};\n\n/**\n  Write a UCS-2 string of desired endianness to the DataStream. The\n  lengthOverride argument lets you define the number of characters to write.\n  If the string is shorter than lengthOverride, the extra space is padded with\n  zeroes.\n\n  @param {string} str The string to write.\n  @param {?boolean} endianness The endianness to use for the written string data.\n  @param {?number} lengthOverride The number of characters to write.\n */\nDataStream.prototype.writeUCS2String = function(str, endianness, lengthOverride) {\n  if (lengthOverride == null) {\n    lengthOverride = str.length;\n  }\n  for (var i = 0; i < str.length && i < lengthOverride; i++) {\n    this.writeUint16(str.charCodeAt(i), endianness);\n  }\n  for (; i<lengthOverride; i++) {\n    this.writeUint16(0);\n  }\n};\n\n/**\n  Writes a string of desired length and encoding to the DataStream.\n\n  @param {string} s The string to write.\n  @param {?string} encoding The encoding for the written string data.\n                            Defaults to ASCII.\n  @param {?number} length The number of characters to write.\n */\nDataStream.prototype.writeString = function(s, encoding, length) {\n  var i = 0;\n  if (encoding == null || encoding == \"ASCII\") {\n    if (length != null) {\n      var len = Math.min(s.length, length);\n      for (i=0; i<len; i++) {\n        this.writeUint8(s.charCodeAt(i));\n      }\n      for (; i<length; i++) {\n        this.writeUint8(0);\n      }\n    } else {\n      for (i=0; i<s.length; i++) {\n        this.writeUint8(s.charCodeAt(i));\n      }\n    }\n  } else {\n    this.writeUint8Array((new TextEncoder(encoding)).encode(s.substring(0, length)));\n  }\n};\n\n/**\n  Writes a null-terminated string to DataStream and zero-pads it to length\n  bytes. If length is not given, writes the string followed by a zero.\n  If string is longer than length, the written part of the string does not have\n  a trailing zero.\n\n  @param {string} s The string to write.\n  @param {?number} length The number of characters to write.\n */\nDataStream.prototype.writeCString = function(s, length) {\n  var i = 0;\n  if (length != null) {\n    var len = Math.min(s.length, length);\n    for (i=0; i<len; i++) {\n      this.writeUint8(s.charCodeAt(i));\n    }\n    for (; i<length; i++) {\n      this.writeUint8(0);\n    }\n  } else {\n    for (i=0; i<s.length; i++) {\n      this.writeUint8(s.charCodeAt(i));\n    }\n    this.writeUint8(0);\n  }\n};\n\n/**\n  Writes a struct to the DataStream. Takes a structDefinition that gives the\n  types and a struct object that gives the values. Refer to readStruct for the\n  structure of structDefinition.\n\n  @param {Object} structDefinition Type definition of the struct.\n  @param {Object} struct The struct data object.\n  */\nDataStream.prototype.writeStruct = function(structDefinition, struct) {\n  for (var i = 0; i < structDefinition.length; i+=2) {\n    var t = structDefinition[i+1];\n    this.writeType(t, struct[structDefinition[i]], struct);\n  }\n};\n\n/**\n  Writes object v of type t to the DataStream.\n\n  @param {Object} t Type of data to write.\n  @param {Object} v Value of data to write.\n  @param {Object} struct Struct to pass to write callback functions.\n  */\nDataStream.prototype.writeType = function(t, v, struct) {\n  var tp;\n  if (typeof t == \"function\") {\n    return t(this, v);\n  } else if (typeof t == \"object\" && !(t instanceof Array)) {\n    return t.set(this, v, struct);\n  }\n  var lengthOverride = null;\n  var charset = \"ASCII\";\n  var pos = this.position;\n  if (typeof(t) == 'string' && /:/.test(t)) {\n    tp = t.split(\":\");\n    t = tp[0];\n    lengthOverride = parseInt(tp[1]);\n  }\n  if (typeof t == 'string' && /,/.test(t)) {\n    tp = t.split(\",\");\n    t = tp[0];\n    charset = parseInt(tp[1]);\n  }\n\n  switch(t) {\n    case 'uint8':\n      this.writeUint8(v);\n      break;\n    case 'int8':\n      this.writeInt8(v);\n      break;\n\n    case 'uint16':\n      this.writeUint16(v, this.endianness);\n      break;\n    case 'int16':\n      this.writeInt16(v, this.endianness);\n      break;\n    case 'uint32':\n      this.writeUint32(v, this.endianness);\n      break;\n    case 'int32':\n      this.writeInt32(v, this.endianness);\n      break;\n    case 'float32':\n      this.writeFloat32(v, this.endianness);\n      break;\n    case 'float64':\n      this.writeFloat64(v, this.endianness);\n      break;\n\n    case 'uint16be':\n      this.writeUint16(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'int16be':\n      this.writeInt16(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'uint32be':\n      this.writeUint32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'int32be':\n      this.writeInt32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'float32be':\n      this.writeFloat32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'float64be':\n      this.writeFloat64(v, DataStream.BIG_ENDIAN);\n      break;\n\n    case 'uint16le':\n      this.writeUint16(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'int16le':\n      this.writeInt16(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'uint32le':\n      this.writeUint32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'int32le':\n      this.writeInt32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'float32le':\n      this.writeFloat32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'float64le':\n      this.writeFloat64(v, DataStream.LITTLE_ENDIAN);\n      break;\n\n    case 'cstring':\n      this.writeCString(v, lengthOverride);\n      break;\n\n    case 'string':\n      this.writeString(v, charset, lengthOverride);\n      break;\n\n    case 'u16string':\n      this.writeUCS2String(v, this.endianness, lengthOverride);\n      break;\n\n    case 'u16stringle':\n      this.writeUCS2String(v, DataStream.LITTLE_ENDIAN, lengthOverride);\n      break;\n\n    case 'u16stringbe':\n      this.writeUCS2String(v, DataStream.BIG_ENDIAN, lengthOverride);\n      break;\n\n    default:\n      if (t.length == 3) {\n        var ta = t[1];\n        for (var i=0; i<v.length; i++) {\n          this.writeType(ta, v[i]);\n        }\n        break;\n      } else {\n        this.writeStruct(t, v);\n        break;\n      }\n  }\n  if (lengthOverride != null) {\n    this.position = pos;\n    this._realloc(lengthOverride);\n    this.position = pos + lengthOverride;\n  }\n};\n\n\nDataStream.prototype.writeUint64 = function (v) {\n\tvar h = Math.floor(v / MAX_SIZE);\n\tthis.writeUint32(h);\n\tthis.writeUint32(v & 0xFFFFFFFF);\n}\n\nDataStream.prototype.writeUint24 = function (v) {\n\tthis.writeUint8((v & 0x00FF0000)>>16);\n\tthis.writeUint8((v & 0x0000FF00)>>8);\n\tthis.writeUint8((v & 0x000000FF));\n}\n\nDataStream.prototype.adjustUint32 = function(position, value) {\n\tvar pos = this.position;\n\tthis.seek(position);\n\tthis.writeUint32(value);\n\tthis.seek(pos);\n}\n// file:src/DataStream-map.js\n/**\n  Maps an Int32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Int32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n\n/**\n  Maps an Int16Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int16Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt16Array = function(length, e) {\n  this._realloc(length * 2);\n  var arr = new Int16Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 2;\n  return arr;\n};\n\n/**\n  Maps an Int8Array into the DataStream buffer.\n\n  Nice for quickly reading in data.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int8Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt8Array = function(length) {\n  this._realloc(length * 1);\n  var arr = new Int8Array(this._buffer, this.byteOffset+this.position, length);\n  this.position += length * 1;\n  return arr;\n};\n\n/**\n  Maps a Uint32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Uint32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n\n/**\n  Maps a Uint16Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint16Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint16Array = function(length, e) {\n  this._realloc(length * 2);\n  var arr = new Uint16Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 2;\n  return arr;\n};\n\n/**\n  Maps a Float64Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Float64Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapFloat64Array = function(length, e) {\n  this._realloc(length * 8);\n  var arr = new Float64Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 8;\n  return arr;\n};\n\n/**\n  Maps a Float32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Float32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapFloat32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Float32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n// file:src/buffer.js\n/**\n * MultiBufferStream is a class that acts as a SimpleStream for parsing \n * It holds several, possibly non-contiguous ArrayBuffer objects, each with a fileStart property \n * containing the offset for the buffer data in an original/virtual file \n *\n * It inherits also from DataStream for all read/write/alloc operations\n */\n\n/**\n * Constructor\n */\nvar MultiBufferStream = function(buffer) {\n\t/* List of ArrayBuffers, with a fileStart property, sorted in fileStart order and non overlapping */\n\tthis.buffers = [];\t\n\tthis.bufferIndex = -1;\n\tif (buffer) {\n\t\tthis.insertBuffer(buffer);\n\t\tthis.bufferIndex = 0;\n\t}\n}\nMultiBufferStream.prototype = new DataStream(new ArrayBuffer(), 0, DataStream.BIG_ENDIAN);\n\n/************************************************************************************\n  Methods for the managnement of the buffers (insertion, removal, concatenation, ...)\n ***********************************************************************************/\n\nMultiBufferStream.prototype.initialized = function() {\n\tvar firstBuffer;\n\tif (this.bufferIndex > -1) {\n\t\treturn true;\n\t} else if (this.buffers.length > 0) {\n\t\tfirstBuffer = this.buffers[0];\n\t\tif (firstBuffer.fileStart === 0) {\n\t\t\tthis.buffer = firstBuffer;\n\t\t\tthis.bufferIndex = 0;\n\t\t\tLog.debug(\"MultiBufferStream\", \"Stream ready for parsing\");\n\t\t\treturn true;\n\t\t} else {\n\t\t\tLog.warn(\"MultiBufferStream\", \"The first buffer should have a fileStart of 0\");\n\t\t\tthis.logBufferLevel();\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\tLog.warn(\"MultiBufferStream\", \"No buffer to start parsing from\");\n\t\tthis.logBufferLevel();\n\t\treturn false;\n\t}\t\t\t\n}\n\n/**\n * helper functions to concatenate two ArrayBuffer objects\n * @param  {ArrayBuffer} buffer1 \n * @param  {ArrayBuffer} buffer2 \n * @return {ArrayBuffer} the concatenation of buffer1 and buffer2 in that order\n */\nArrayBuffer.concat = function(buffer1, buffer2) {\n  Log.debug(\"ArrayBuffer\", \"Trying to create a new buffer of size: \"+(buffer1.byteLength + buffer2.byteLength));\n  var tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);\n  tmp.set(new Uint8Array(buffer1), 0);\n  tmp.set(new Uint8Array(buffer2), buffer1.byteLength);\n  return tmp.buffer;\n};\n\n/**\n * Reduces the size of a given buffer, but taking the part between offset and offset+newlength\n * @param  {ArrayBuffer} buffer    \n * @param  {Number}      offset    the start of new buffer\n * @param  {Number}      newLength the length of the new buffer\n * @return {ArrayBuffer}           the new buffer\n */\nMultiBufferStream.prototype.reduceBuffer = function(buffer, offset, newLength) {\n\tvar smallB;\n\tsmallB = new Uint8Array(newLength);\n\tsmallB.set(new Uint8Array(buffer, offset, newLength));\n\tsmallB.buffer.fileStart = buffer.fileStart+offset;\n\tsmallB.buffer.usedBytes = 0;\n\treturn smallB.buffer;\t\n}\n\n/**\n * Inserts the new buffer in the sorted list of buffers,\n *  making sure, it is not overlapping with existing ones (possibly reducing its size).\n *  if the new buffer overrides/replaces the 0-th buffer (for instance because it is bigger), \n *  updates the DataStream buffer for parsing \n*/\nMultiBufferStream.prototype.insertBuffer = function(ab) {\t\n\tvar to_add = true;\n\t/* TODO: improve insertion if many buffers */\n\tfor (var i = 0; i < this.buffers.length; i++) {\n\t\tvar b = this.buffers[i];\n\t\tif (ab.fileStart <= b.fileStart) {\n\t\t\t/* the insertion position is found */\n\t\t\tif (ab.fileStart === b.fileStart) {\n\t\t\t\t/* The new buffer overlaps with an existing buffer */\n\t\t\t\tif (ab.byteLength >  b.byteLength) {\n\t\t\t\t\t/* the new buffer is bigger than the existing one\n\t\t\t\t\t   remove the existing buffer and try again to insert \n\t\t\t\t\t   the new buffer to check overlap with the next ones */\n\t\t\t\t\tthis.buffers.splice(i, 1);\n\t\t\t\t\ti--; \n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\t/* the new buffer is smaller than the existing one, just drop it */\n\t\t\t\t\tLog.warn(\"MultiBufferStream\", \"Buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\") already appended, ignoring\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t/* The beginning of the new buffer is not overlapping with an existing buffer\n\t\t\t\t   let's check the end of it */\n\t\t\t\tif (ab.fileStart + ab.byteLength <= b.fileStart) {\n\t\t\t\t\t/* no overlap, we can add it as is */\n\t\t\t\t} else {\n\t\t\t\t\t/* There is some overlap, cut the new buffer short, and add it*/\n\t\t\t\t\tab = this.reduceBuffer(ab, 0, b.fileStart - ab.fileStart);\n\t\t\t\t}\n\t\t\t\tLog.debug(\"MultiBufferStream\", \"Appending new buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\")\");\n\t\t\t\tthis.buffers.splice(i, 0, ab);\n\t\t\t\t/* if this new buffer is inserted in the first place in the list of the buffer, \n\t\t\t\t   and the DataStream is initialized, make it the buffer used for parsing */\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tthis.buffer = ab;\n\t\t\t\t}\n\t\t\t}\n\t\t\tto_add = false;\n\t\t\tbreak;\n\t\t} else if (ab.fileStart < b.fileStart + b.byteLength) {\n\t\t\t/* the new buffer overlaps its beginning with the end of the current buffer */\n\t\t\tvar offset = b.fileStart + b.byteLength - ab.fileStart;\n\t\t\tvar newLength = ab.byteLength - offset;\n\t\t\tif (newLength > 0) {\n\t\t\t\t/* the new buffer is bigger than the current overlap, drop the overlapping part and try again inserting the remaining buffer */\n\t\t\t\tab = this.reduceBuffer(ab, offset, newLength);\n\t\t\t} else {\n\t\t\t\t/* the content of the new buffer is entirely contained in the existing buffer, drop it entirely */\n\t\t\t\tto_add = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t/* if the buffer has not been added, we can add it at the end */\n\tif (to_add) {\n\t\tLog.debug(\"MultiBufferStream\", \"Appending new buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\")\");\n\t\tthis.buffers.push(ab);\n\t\t/* if this new buffer is inserted in the first place in the list of the buffer, \n\t\t   and the DataStream is initialized, make it the buffer used for parsing */\n\t\tif (i === 0) {\n\t\t\tthis.buffer = ab;\n\t\t}\n\t}\n}\n\n/**\n * Displays the status of the buffers (number and used bytes)\n * @param  {Object} info callback method for display\n */\nMultiBufferStream.prototype.logBufferLevel = function(info) {\n\tvar i;\n\tvar buffer;\n\tvar used, total;\n\tvar ranges = [];\n\tvar range;\n\tvar bufferedString = \"\";\n\tused = 0;\n\ttotal = 0;\n\tfor (i = 0; i < this.buffers.length; i++) {\n\t\tbuffer = this.buffers[i];\n\t\tif (i === 0) {\n\t\t\trange = {};\n\t\t\tranges.push(range);\n\t\t\trange.start = buffer.fileStart;\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t\tbufferedString += \"[\"+range.start+\"-\";\n\t\t} else if (range.end === buffer.fileStart) {\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t} else {\n\t\t\trange = {};\n\t\t\trange.start = buffer.fileStart;\n\t\t\tbufferedString += (ranges[ranges.length-1].end-1)+\"], [\"+range.start+\"-\";\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t\tranges.push(range);\n\t\t}\n\t\tused += buffer.usedBytes;\n\t\ttotal += buffer.byteLength;\n\t}\n\tif (ranges.length > 0) {\n\t\tbufferedString += (range.end-1)+\"]\";\n\t}\n\tvar log = (info ? Log.info : Log.debug)\n\tif (this.buffers.length === 0) {\n\t\tlog(\"MultiBufferStream\", \"No more buffer in memory\");\n\t} else {\n\t\tlog(\"MultiBufferStream\", \"\"+this.buffers.length+\" stored buffer(s) (\"+used+\"/\"+total+\" bytes), continuous ranges: \"+bufferedString);\n\t}\n}\n\nMultiBufferStream.prototype.cleanBuffers = function () {\n\tvar i;\n\tvar buffer;\n\tfor (i = 0; i < this.buffers.length; i++) {\n\t\tbuffer = this.buffers[i];\n\t\tif (buffer.usedBytes === buffer.byteLength) {\n\t\t\tLog.debug(\"MultiBufferStream\", \"Removing buffer #\"+i);\n\t\t\tthis.buffers.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n}\n\nMultiBufferStream.prototype.mergeNextBuffer = function() {\n\tvar next_buffer;\n\tif (this.bufferIndex+1 < this.buffers.length) {\n\t\tnext_buffer = this.buffers[this.bufferIndex+1];\n\t\tif (next_buffer.fileStart === this.buffer.fileStart + this.buffer.byteLength) {\n\t\t\tvar oldLength = this.buffer.byteLength;\n\t\t\tvar oldUsedBytes = this.buffer.usedBytes;\n\t\t\tvar oldFileStart = this.buffer.fileStart;\n\t\t\tthis.buffers[this.bufferIndex] = ArrayBuffer.concat(this.buffer, next_buffer);\n\t\t\tthis.buffer = this.buffers[this.bufferIndex];\n\t\t\tthis.buffers.splice(this.bufferIndex+1, 1);\n\t\t\tthis.buffer.usedBytes = oldUsedBytes; /* TODO: should it be += ? */\n\t\t\tthis.buffer.fileStart = oldFileStart;\n\t\t\tLog.debug(\"ISOFile\", \"Concatenating buffer for box parsing (length: \"+oldLength+\"->\"+this.buffer.byteLength+\")\");\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n}\n\n\n/*************************************************************************\n  Seek-related functions\n *************************************************************************/\n\n/**\n * Finds the buffer that holds the given file position\n * @param  {Boolean} fromStart    indicates if the search should start from the current buffer (false) \n *                                or from the first buffer (true)\n * @param  {Number}  filePosition position in the file to seek to\n * @param  {Boolean} markAsUsed   indicates if the bytes in between the current position and the seek position \n *                                should be marked as used for garbage collection\n * @return {Number}               the index of the buffer holding the seeked file position, -1 if not found.\n */\nMultiBufferStream.prototype.findPosition = function(fromStart, filePosition, markAsUsed) {\n\tvar i;\n\tvar abuffer = null;\n\tvar index = -1;\n\n\t/* find the buffer with the largest position smaller than the given position */\n\tif (fromStart === true) {\n\t   /* the reposition can be in the past, we need to check from the beginning of the list of buffers */\n\t\ti = 0;\n\t} else {\n\t\ti = this.bufferIndex;\n\t}\n\n\twhile (i < this.buffers.length) {\n\t\tabuffer = this.buffers[i];\n\t\tif (abuffer.fileStart <= filePosition) {\n\t\t\tindex = i;\n\t\t\tif (markAsUsed) {\n\t\t\t\tif (abuffer.fileStart + abuffer.byteLength <= filePosition) {\n\t\t\t\t\tabuffer.usedBytes = abuffer.byteLength;\t\n\t\t\t\t} else {\n\t\t\t\t\tabuffer.usedBytes = filePosition - abuffer.fileStart;\n\t\t\t\t}\t\t\n\t\t\t\tthis.logBufferLevel();\t\n\t\t\t}\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t\ti++;\n\t}\n\n\tif (index !== -1) {\n\t\tabuffer = this.buffers[index];\n\t\tif (abuffer.fileStart + abuffer.byteLength >= filePosition) {\t\t\t\n\t\t\tLog.debug(\"MultiBufferStream\", \"Found position in existing buffer #\"+index);\n\t\t\treturn index;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t} else {\n\t\treturn -1;\n\t}\n}\n\n/**\n * Finds the largest file position contained in a buffer or in the next buffers if they are contiguous (no gap)\n * starting from the given buffer index or from the current buffer if the index is not given\n *\n * @param  {Number} inputindex Index of the buffer to start from\n * @return {Number}            The largest file position found in the buffers\n */\nMultiBufferStream.prototype.findEndContiguousBuf = function(inputindex) {\n\tvar i;\n\tvar currentBuf;\n\tvar nextBuf;\n\tvar index = (inputindex !== undefined ? inputindex : this.bufferIndex);\n\tcurrentBuf = this.buffers[index];\n\t/* find the end of the contiguous range of data */\n\tif (this.buffers.length > index+1) {\n\t\tfor (i = index+1; i < this.buffers.length; i++) {\n\t\t\tnextBuf = this.buffers[i];\n\t\t\tif (nextBuf.fileStart === currentBuf.fileStart + currentBuf.byteLength) {\n\t\t\t\tcurrentBuf = nextBuf;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t/* return the position of last byte in the file that we have */\n\treturn currentBuf.fileStart + currentBuf.byteLength;\n}\n\n/**\n * Returns the largest file position contained in the buffers, larger than the given position\n * @param  {Number} pos the file position to start from\n * @return {Number}     the largest position in the current buffer or in the buffer and the next contiguous \n *                      buffer that holds the given position\n */\nMultiBufferStream.prototype.getEndFilePositionAfter = function(pos) {\n\tvar index = this.findPosition(true, pos, false);\n\tif (index !== -1) {\n\t\treturn this.findEndContiguousBuf(index);\n\t} else {\n\t\treturn pos;\n\t}\n}\n\n/*************************************************************************\n  Garbage collection related functions\n *************************************************************************/\n\n/**\n * Marks a given number of bytes as used in the current buffer for garbage collection\n * @param {Number} nbBytes \n */\nMultiBufferStream.prototype.addUsedBytes = function(nbBytes) {\n\tthis.buffer.usedBytes += nbBytes;\n\tthis.logBufferLevel();\n}\n\n/**\n * Marks the entire current buffer as used, ready for garbage collection\n */\nMultiBufferStream.prototype.setAllUsedBytes = function() {\n\tthis.buffer.usedBytes = this.buffer.byteLength;\n\tthis.logBufferLevel();\n}\n\n/*************************************************************************\n  Common API between MultiBufferStream and SimpleStream\n *************************************************************************/\n\n/**\n * Tries to seek to a given file position\n * if possible, repositions the parsing from there and returns true \n * if not possible, does not change anything and returns false \n * @param  {Number}  filePosition position in the file to seek to\n * @param  {Boolean} fromStart    indicates if the search should start from the current buffer (false) \n *                                or from the first buffer (true)\n * @param  {Boolean} markAsUsed   indicates if the bytes in between the current position and the seek position \n *                                should be marked as used for garbage collection\n * @return {Boolean}              true if the seek succeeded, false otherwise\n */\nMultiBufferStream.prototype.seek = function(filePosition, fromStart, markAsUsed) {\n\tvar index;\n\tindex = this.findPosition(fromStart, filePosition, markAsUsed);\n\tif (index !== -1) {\n\t\tthis.buffer = this.buffers[index];\n\t\tthis.bufferIndex = index;\n\t\tthis.position = filePosition - this.buffer.fileStart;\n\t\tLog.debug(\"MultiBufferStream\", \"Repositioning parser at buffer position: \"+this.position);\n\t\treturn true;\n\t} else {\n\t\tLog.debug(\"MultiBufferStream\", \"Position \"+filePosition+\" not found in buffered data\");\n\t\treturn false;\n\t}\n}\n\n/**\n * Returns the current position in the file\n * @return {Number} the position in the file\n */\nMultiBufferStream.prototype.getPosition = function() {\n\tif (this.bufferIndex === -1 || this.buffers[this.bufferIndex] === null) {\n\t\tthrow \"Error accessing position in the MultiBufferStream\";\n\t}\n\treturn this.buffers[this.bufferIndex].fileStart+this.position;\n}\n\n/**\n * Returns the length of the current buffer\n * @return {Number} the length of the current buffer\n */\nMultiBufferStream.prototype.getLength = function() {\n\treturn this.byteLength;\n}\n\nMultiBufferStream.prototype.getEndPosition = function() {\n\tif (this.bufferIndex === -1 || this.buffers[this.bufferIndex] === null) {\n\t\tthrow \"Error accessing position in the MultiBufferStream\";\n\t}\n\treturn this.buffers[this.bufferIndex].fileStart+this.byteLength;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.MultiBufferStream = MultiBufferStream;\n}// file:src/descriptor.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar MPEG4DescriptorParser = function () {\n\tvar ES_DescrTag \t\t\t= 0x03;\n\tvar DecoderConfigDescrTag \t= 0x04;\n\tvar DecSpecificInfoTag \t\t= 0x05;\n\tvar SLConfigDescrTag \t\t= 0x06;\n\n\tvar descTagToName = [];\n\tdescTagToName[ES_DescrTag] \t\t\t\t= \"ES_Descriptor\";\n\tdescTagToName[DecoderConfigDescrTag] \t= \"DecoderConfigDescriptor\";\n\tdescTagToName[DecSpecificInfoTag] \t\t= \"DecoderSpecificInfo\";\n\tdescTagToName[SLConfigDescrTag] \t\t= \"SLConfigDescriptor\";\n\n\tthis.getDescriptorName = function(tag) {\n\t\treturn descTagToName[tag];\n\t}\n\n\tvar that = this;\n\tvar classes = {};\n\n\tthis.parseOneDescriptor = function (stream) {\n\t\tvar hdrSize = 0;\n\t\tvar size = 0;\n\t\tvar tag;\n\t\tvar desc;\n\t\tvar byteRead;\n\t\ttag = stream.readUint8();\n\t\thdrSize++;\n\t\tbyteRead = stream.readUint8();\n\t\thdrSize++;\n\t\twhile (byteRead & 0x80) {\n\t\t\tsize = (size << 7) + (byteRead & 0x7F);\n\t\t\tbyteRead = stream.readUint8();\n\t\t\thdrSize++;\n\t\t}\n\t\tsize = (size << 7) + (byteRead & 0x7F);\n\t\tLog.debug(\"MPEG4DescriptorParser\", \"Found \"+(descTagToName[tag] || \"Descriptor \"+tag)+\", size \"+size+\" at position \"+stream.getPosition());\n\t\tif (descTagToName[tag]) {\n\t\t\tdesc = new classes[descTagToName[tag]](size);\n\t\t} else {\n\t\t\tdesc = new classes.Descriptor(size);\n\t\t}\n\t\tdesc.parse(stream);\n\t\treturn desc;\n\t}\n\n\tclasses.Descriptor = function(_tag, _size) {\n\t\tthis.tag = _tag;\n\t\tthis.size = _size;\n\t\tthis.descs = [];\n\t}\n\n\tclasses.Descriptor.prototype.parse = function (stream) {\n\t\tthis.data = stream.readUint8Array(this.size);\n\t}\n\n\tclasses.Descriptor.prototype.findDescriptor = function (tag) {\n\t\tfor (var i = 0; i < this.descs.length; i++) {\n\t\t\tif (this.descs[i].tag == tag) {\n\t\t\t\treturn this.descs[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclasses.Descriptor.prototype.parseRemainingDescriptors = function (stream) {\n\t\tvar start = stream.position;\n\t\twhile (stream.position < start+this.size) {\n\t\t\tvar desc = that.parseOneDescriptor(stream);\n\t\t\tthis.descs.push(desc);\n\t\t}\n\t}\n\n\tclasses.ES_Descriptor = function (size) {\n\t\tclasses.Descriptor.call(this, ES_DescrTag, size);\n\t}\n\n\tclasses.ES_Descriptor.prototype = new classes.Descriptor();\n\n\tclasses.ES_Descriptor.prototype.parse = function(stream) {\n\t\tthis.ES_ID = stream.readUint16();\n\t\tthis.flags = stream.readUint8();\n\t\tthis.size -= 3;\n\t\tif (this.flags & 0x80) {\n\t\t\tthis.dependsOn_ES_ID = stream.readUint16();\n\t\t\tthis.size -= 2;\n\t\t} else {\n\t\t\tthis.dependsOn_ES_ID = 0;\n\t\t}\n\t\tif (this.flags & 0x40) {\n\t\t\tvar l = stream.readUint8();\n\t\t\tthis.URL = stream.readString(l);\n\t\t\tthis.size -= l+1;\n\t\t} else {\n\t\t\tthis.URL = \"\";\n\t\t}\n\t\tif (this.flags & 0x20) {\n\t\t\tthis.OCR_ES_ID = stream.readUint16();\n\t\t\tthis.size -= 2;\n\t\t} else {\n\t\t\tthis.OCR_ES_ID = 0;\n\t\t}\n\t\tthis.parseRemainingDescriptors(stream);\n\t}\n\n\tclasses.ES_Descriptor.prototype.getOTI = function(stream) {\n\t\tvar dcd = this.findDescriptor(DecoderConfigDescrTag);\n\t\tif (dcd) {\n\t\t\treturn dcd.oti;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tclasses.ES_Descriptor.prototype.getAudioConfig = function(stream) {\n\t\tvar dcd = this.findDescriptor(DecoderConfigDescrTag);\n\t\tif (!dcd) return null;\n\t\tvar dsi = dcd.findDescriptor(DecSpecificInfoTag);\n\t\tif (dsi && dsi.data) {\n\t\t\tvar audioObjectType = (dsi.data[0]& 0xF8) >> 3;\n\t\t\tif (audioObjectType === 31 && dsi.data.length >= 2) {\n\t\t\t\taudioObjectType = 32 + ((dsi.data[0] & 0x7) << 3) + ((dsi.data[1] & 0xE0) >> 5);\n\t\t\t}\n\t\t\treturn audioObjectType;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tclasses.DecoderConfigDescriptor = function (size) {\n\t\tclasses.Descriptor.call(this, DecoderConfigDescrTag, size);\n\t}\n\tclasses.DecoderConfigDescriptor.prototype = new classes.Descriptor();\n\n\tclasses.DecoderConfigDescriptor.prototype.parse = function(stream) {\n\t\tthis.oti = stream.readUint8();\n\t\tthis.streamType = stream.readUint8();\n\t\tthis.upStream = ((this.streamType >> 1) & 1) !== 0;\n\t\tthis.streamType = this.streamType >>> 2;\n\t\tthis.bufferSize = stream.readUint24();\n\t\tthis.maxBitrate = stream.readUint32();\n\t\tthis.avgBitrate = stream.readUint32();\n\t\tthis.size -= 13;\n\t\tthis.parseRemainingDescriptors(stream);\n\t}\n\n\tclasses.DecoderSpecificInfo = function (size) {\n\t\tclasses.Descriptor.call(this, DecSpecificInfoTag, size);\n\t}\n\tclasses.DecoderSpecificInfo.prototype = new classes.Descriptor();\n\n\tclasses.SLConfigDescriptor = function (size) {\n\t\tclasses.Descriptor.call(this, SLConfigDescrTag, size);\n\t}\n\tclasses.SLConfigDescriptor.prototype = new classes.Descriptor();\n\n\treturn this;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.MPEG4DescriptorParser = MPEG4DescriptorParser;\n}\n// file:src/box.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar BoxParser = {\n\tERR_INVALID_DATA : -1,\n\tERR_NOT_ENOUGH_DATA : 0,\n\tOK : 1,\n\n\t// Boxes to be created with default parsing\n\tBASIC_BOXES: [\n\t\t{type: \"mdat\", name: \"MediaDataBox\"},\n\t\t{type: \"idat\", name: \"ItemDataBox\"},\n\t\t{type: \"free\", name: \"FreeSpaceBox\"},\n\t\t{type: \"skip\", name: \"FreeSpaceBox\"},\n\t\t{type: \"meco\", name: \"AdditionalMetadataContainerBox\"},\n\t\t{type: \"strk\", name: \"SubTrackBox\"}\n\t],\n\tFULL_BOXES: [\n\t\t{type: \"hmhd\", name: \"HintMediaHeaderBox\"},\n\t\t{type: \"nmhd\", name: \"NullMediaHeaderBox\"},\n\t\t{type: \"iods\", name: \"ObjectDescriptorBox\"},\n\t\t{type: \"xml \", name: \"XMLBox\"},\n\t\t{type: \"bxml\", name: \"BinaryXMLBox\"},\n\t\t{type: \"ipro\", name: \"ItemProtectionBox\"},\n\t\t{type: \"mere\", name: \"MetaboxRelationBox\"}\n\t],\n\tCONTAINER_BOXES: [\n\t\t[{type: \"moov\", name: \"CompressedMovieBox\"}, [\"trak\", \"pssh\"]],\n\t\t[{type: \"trak\", name: \"TrackBox\"}],\n\t\t[{type: \"edts\", name: \"EditBox\"}],\n\t\t[{type: \"mdia\", name: \"MediaBox\"}],\n\t\t[{type: \"minf\", name: \"MediaInformationBox\"}],\n\t\t[{type: \"dinf\", name: \"DataInformationBox\"}],\n\t\t[{type: \"stbl\", name: \"SampleTableBox\"}, [\"sgpd\", \"sbgp\"]],\n\t\t[{type: \"mvex\", name: \"MovieExtendsBox\"}, [\"trex\"]],\n\t\t[{type: \"moof\", name: \"CompressedMovieFragmentBox\"}, [\"traf\"]],\n\t\t[{type: \"traf\", name: \"TrackFragmentBox\"}, [\"trun\", \"sgpd\", \"sbgp\"]],\n\t\t[{type: \"vttc\", name: \"VTTCueBox\"}],\n\t\t[{type: \"tref\", name: \"TrackReferenceBox\"}],\n\t\t[{type: \"iref\", name: \"ItemReferenceBox\"}],\n\t\t[{type: \"mfra\", name: \"MovieFragmentRandomAccessBox\"}, [\"tfra\"]],\n\t\t[{type: \"meco\", name: \"AdditionalMetadataContainerBox\"}],\n\t\t[{type: \"hnti\", name: \"trackhintinformation\"}],\n\t\t[{type: \"hinf\", name: \"hintstatisticsbox\"}],\n\t\t[{type: \"strk\", name: \"SubTrackBox\"}],\n\t\t[{type: \"strd\", name: \"SubTrackDefinitionBox\"}],\n\t\t[{type: \"sinf\", name: \"ProtectionSchemeInfoBox\"}],\n\t\t[{type: \"rinf\", name: \"RestrictedSchemeInfoBox\"}],\n\t\t[{type: \"schi\", name: \"SchemeInformationBox\"}],\n\t\t[{type: \"trgr\", name: \"TrackGroupBox\"}],\n\t\t[{type: \"udta\", name: \"UserDataBox\"}, [\"kind\"]],\n\t\t[{type: \"iprp\", name: \"ItemPropertiesBox\"}, [\"ipma\"]],\n\t\t[{type: \"ipco\", name: \"ItemPropertyContainerBox\"}],\n\t\t[{type: \"grpl\", name: \"GroupsListBox\"}],\n\t\t[{type: \"j2kH\", name: \"J2KHeaderInfoBox\"}],\n\t\t[{type: \"etyp\", name: \"ExtendedTypeBox\"}, [\"tyco\"]]\n\t],\n\t// Boxes effectively created\n\tboxCodes : [],\n\tfullBoxCodes : [],\n\tcontainerBoxCodes : [],\n\tsampleEntryCodes : {},\n\tsampleGroupEntryCodes: [],\n\ttrackGroupTypes: [],\n\tUUIDBoxes: {},\n\tUUIDs: [],\n\tinitialize: function() {\n\t\tBoxParser.FullBox.prototype = new BoxParser.Box();\n\t\tBoxParser.ContainerBox.prototype = new BoxParser.Box();\n\t\tBoxParser.SampleEntry.prototype = new BoxParser.Box();\n\t\tBoxParser.TrackGroupTypeBox.prototype = new BoxParser.FullBox();\n\n\t\t/* creating constructors for simple boxes */\n\t\tBoxParser.BASIC_BOXES.forEach(function(box) {\n\t\t\tBoxParser.createBoxCtor(box.type, box.name)\n\t\t});\n\t\tBoxParser.FULL_BOXES.forEach(function(box) {\n\t\t\tBoxParser.createFullBoxCtor(box.type, box.name);\n\t\t});\n\t\tBoxParser.CONTAINER_BOXES.forEach(function(boxes) {\n\t\t\tBoxParser.createContainerBoxCtor(boxes[0].type, boxes[0].name, null, boxes[1]);\n\t\t});\n\t},\n\tBox: function(_type, _size, _name, _uuid) {\n\t\tthis.type = _type;\n\t\tthis.box_name = _name;\n\t\tthis.size = _size;\n\t\tthis.uuid = _uuid;\n\t},\n\tFullBox: function(type, size, name, uuid) {\n\t\tBoxParser.Box.call(this, type, size, name, uuid);\n\t\tthis.flags = 0;\n\t\tthis.version = 0;\n\t},\n\tContainerBox: function(type, size, name, uuid) {\n\t\tBoxParser.Box.call(this, type, size, name, uuid);\n\t\tthis.boxes = [];\n\t},\n\tSampleEntry: function(type, size, hdr_size, start) {\n\t\tBoxParser.ContainerBox.call(this, type, size);\n\t\tthis.hdr_size = hdr_size;\n\t\tthis.start = start;\n\t},\n\tSampleGroupEntry: function(type) {\n\t\tthis.grouping_type = type;\n\t},\n\tTrackGroupTypeBox: function(type, size) {\n\t\tBoxParser.FullBox.call(this, type, size);\n\t},\n\tcreateBoxCtor: function(type, name, parseMethod){\n\t\tBoxParser.boxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.Box.call(this, type, size, name);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.Box();\n\t\tif (parseMethod) BoxParser[type+\"Box\"].prototype.parse = parseMethod;\n\t},\n\tcreateFullBoxCtor: function(type, name, parseMethod) {\n\t\t//BoxParser.fullBoxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.FullBox.call(this, type, size, name);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.FullBox();\n\t\tBoxParser[type+\"Box\"].prototype.parse = function(stream) {\n\t\t\tthis.parseFullHeader(stream);\n\t\t\tif (parseMethod) {\n\t\t\t\tparseMethod.call(this, stream);\n\t\t\t}\n\t\t};\n\t},\n\taddSubBoxArrays: function(subBoxNames) {\n\t\tif (subBoxNames) {\n\t\t\tthis.subBoxNames = subBoxNames;\n\t\t\tvar nbSubBoxes = subBoxNames.length;\n\t\t\tfor (var k = 0; k<nbSubBoxes; k++) {\n\t\t\t\tthis[subBoxNames[k]+\"s\"] = [];\n\t\t\t}\n\t\t}\n\t},\n\tcreateContainerBoxCtor: function(type, name, parseMethod, subBoxNames) {\n\t\t//BoxParser.containerBoxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.ContainerBox.call(this, type, size, name);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.ContainerBox();\n\t\tif (parseMethod) BoxParser[type+\"Box\"].prototype.parse = parseMethod;\n\t},\n\tcreateMediaSampleEntryCtor: function(mediaType, parseMethod, subBoxNames) {\n\t\tBoxParser.sampleEntryCodes[mediaType] = [];\n\t\tBoxParser[mediaType+\"SampleEntry\"] = function(type, size) {\n\t\t\tBoxParser.SampleEntry.call(this, type, size);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t};\n\t\tBoxParser[mediaType+\"SampleEntry\"].prototype = new BoxParser.SampleEntry();\n\t\tif (parseMethod) BoxParser[mediaType+\"SampleEntry\"].prototype .parse = parseMethod;\n\t},\n\tcreateSampleEntryCtor: function(mediaType, type, parseMethod, subBoxNames) {\n\t\tBoxParser.sampleEntryCodes[mediaType].push(type);\n\t\tBoxParser[type+\"SampleEntry\"] = function(size) {\n\t\t\tBoxParser[mediaType+\"SampleEntry\"].call(this, type, size);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t};\n\t\tBoxParser[type+\"SampleEntry\"].prototype = new BoxParser[mediaType+\"SampleEntry\"]();\n\t\tif (parseMethod) BoxParser[type+\"SampleEntry\"].prototype.parse = parseMethod;\n\t},\n\tcreateEncryptedSampleEntryCtor: function(mediaType, type, parseMethod) {\n\t\tBoxParser.createSampleEntryCtor.call(this, mediaType, type, parseMethod, [\"sinf\"]);\n\t},\n\tcreateSampleGroupCtor: function(type, parseMethod) {\n\t\t//BoxParser.sampleGroupEntryCodes.push(type);\n\t\tBoxParser[type+\"SampleGroupEntry\"] = function(size) {\n\t\t\tBoxParser.SampleGroupEntry.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"SampleGroupEntry\"].prototype = new BoxParser.SampleGroupEntry();\n\t\tif (parseMethod) BoxParser[type+\"SampleGroupEntry\"].prototype.parse = parseMethod;\n\t},\n\tcreateTrackGroupCtor: function(type, parseMethod) {\n\t\t//BoxParser.trackGroupTypes.push(type);\n\t\tBoxParser[type+\"TrackGroupTypeBox\"] = function(size) {\n\t\t\tBoxParser.TrackGroupTypeBox.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"TrackGroupTypeBox\"].prototype = new BoxParser.TrackGroupTypeBox();\n\t\tif (parseMethod) BoxParser[type+\"TrackGroupTypeBox\"].prototype.parse = parseMethod;\n\t},\n\tcreateUUIDBox: function(uuid, name, isFullBox, isContainerBox, parseMethod) {\n\t\tBoxParser.UUIDs.push(uuid);\n\t\tBoxParser.UUIDBoxes[uuid] = function(size) {\n\t\t\tif (isFullBox) {\n\t\t\t\tBoxParser.FullBox.call(this, \"uuid\", size, name, uuid);\n\t\t\t} else {\n\t\t\t\tif (isContainerBox) {\n\t\t\t\t\tBoxParser.ContainerBox.call(this, \"uuid\", size, name, uuid);\n\t\t\t\t} else {\n\t\t\t\t\tBoxParser.Box.call(this, \"uuid\", size, name, uuid);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tBoxParser.UUIDBoxes[uuid].prototype = (isFullBox ? new BoxParser.FullBox() : (isContainerBox ? new BoxParser.ContainerBox() : new BoxParser.Box()));\n\t\tif (parseMethod) {\n\t\t\tif (isFullBox) {\n\t\t\t\tBoxParser.UUIDBoxes[uuid].prototype.parse = function(stream) {\n\t\t\t\t\tthis.parseFullHeader(stream);\n\t\t\t\t\tif (parseMethod) {\n\t\t\t\t\t\tparseMethod.call(this, stream);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tBoxParser.UUIDBoxes[uuid].prototype.parse = parseMethod;\n\t\t\t}\n\t\t}\n\t}\n}\n\nBoxParser.initialize();\n\nBoxParser.TKHD_FLAG_ENABLED    = 0x000001;\nBoxParser.TKHD_FLAG_IN_MOVIE   = 0x000002;\nBoxParser.TKHD_FLAG_IN_PREVIEW = 0x000004;\n\nBoxParser.TFHD_FLAG_BASE_DATA_OFFSET\t= 0x01;\nBoxParser.TFHD_FLAG_SAMPLE_DESC\t\t\t= 0x02;\nBoxParser.TFHD_FLAG_SAMPLE_DUR\t\t\t= 0x08;\nBoxParser.TFHD_FLAG_SAMPLE_SIZE\t\t\t= 0x10;\nBoxParser.TFHD_FLAG_SAMPLE_FLAGS\t\t= 0x20;\nBoxParser.TFHD_FLAG_DUR_EMPTY\t\t\t= 0x10000;\nBoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF= 0x20000;\n\nBoxParser.TRUN_FLAGS_DATA_OFFSET= 0x01;\nBoxParser.TRUN_FLAGS_FIRST_FLAG\t= 0x04;\nBoxParser.TRUN_FLAGS_DURATION\t= 0x100;\nBoxParser.TRUN_FLAGS_SIZE\t\t= 0x200;\nBoxParser.TRUN_FLAGS_FLAGS\t\t= 0x400;\nBoxParser.TRUN_FLAGS_CTS_OFFSET\t= 0x800;\n\nBoxParser.Box.prototype.add = function(name) {\n\treturn this.addBox(new BoxParser[name+\"Box\"]());\n}\n\nBoxParser.Box.prototype.addBox = function(box) {\n\tthis.boxes.push(box);\n\tif (this[box.type+\"s\"]) {\n\t\tthis[box.type+\"s\"].push(box);\n\t} else {\n\t\tthis[box.type] = box;\n\t}\n\treturn box;\n}\n\nBoxParser.Box.prototype.set = function(prop, value) {\n\tthis[prop] = value;\n\treturn this;\n}\n\nBoxParser.Box.prototype.addEntry = function(value, _prop) {\n\tvar prop = _prop || \"entries\";\n\tif (!this[prop]) {\n\t\tthis[prop] = [];\n\t}\n\tthis[prop].push(value);\n\treturn this;\n}\n\nif (typeof exports !== \"undefined\") {\n\texports.BoxParser = BoxParser;\n}\n// file:src/box-parse.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.parseUUID = function(stream) {\n\treturn BoxParser.parseHex16(stream);\n}\n\nBoxParser.parseHex16 = function(stream) {\n\tvar hex16 = \"\"\n\tfor (var i = 0; i <16; i++) {\n\t\tvar hex = stream.readUint8().toString(16);\n\t\thex16 += (hex.length === 1 ? \"0\"+hex : hex);\n\t}\n\treturn hex16;\n}\n\nBoxParser.parseOneBox = function(stream, headerOnly, parentSize) {\n\tvar box;\n\tvar start = stream.getPosition();\n\tvar hdr_size = 0;\n\tvar diff;\n\tvar uuid;\n\tif (stream.getEndPosition() - start < 8) {\n\t\tLog.debug(\"BoxParser\", \"Not enough data in stream to parse the type and size of the box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t}\n\tif (parentSize && parentSize < 8) {\n\t\tLog.debug(\"BoxParser\", \"Not enough bytes left in the parent box to parse a new box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t}\n\tvar size = stream.readUint32();\n\tvar type = stream.readString(4);\n\tvar box_type = type;\n\tLog.debug(\"BoxParser\", \"Found box of type '\"+type+\"' and size \"+size+\" at position \"+start);\n\thdr_size = 8;\n\tif (type == \"uuid\") {\n\t\tif ((stream.getEndPosition() - stream.getPosition() < 16) || (parentSize -hdr_size < 16)) {\n\t\t\tstream.seek(start);\n\t\t\tLog.debug(\"BoxParser\", \"Not enough bytes left in the parent box to parse a UUID box\");\n\t\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t\t}\n\t\tuuid = BoxParser.parseUUID(stream);\n\t\thdr_size += 16;\n\t\tbox_type = uuid;\n\t}\n\tif (size == 1) {\n\t\tif ((stream.getEndPosition() - stream.getPosition() < 8) || (parentSize && (parentSize - hdr_size) < 8)) {\n\t\t\tstream.seek(start);\n\t\t\tLog.warn(\"BoxParser\", \"Not enough data in stream to parse the extended size of the \\\"\"+type+\"\\\" box\");\n\t\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t\t}\n\t\tsize = stream.readUint64();\n\t\thdr_size += 8;\n\t} else if (size === 0) {\n\t\t/* box extends till the end of file or invalid file */\n\t\tif (parentSize) {\n\t\t\tsize = parentSize;\n\t\t} else {\n\t\t\t/* box extends till the end of file */\n\t\t\tif (type !== \"mdat\") {\n\t\t\t\tLog.error(\"BoxParser\", \"Unlimited box size not supported for type: '\"+type+\"'\");\n\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\treturn { code: BoxParser.OK, box: box, size: box.size };\n\t\t\t}\n\t\t}\n\t}\n\tif (size !== 0 && size < hdr_size) {\n\t\tLog.error(\"BoxParser\", \"Box of type \"+type+\" has an invalid size \"+size+\" (too small to be a box)\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (size !== 0 && parentSize && size > parentSize) {\n\t\tLog.error(\"BoxParser\", \"Box of type '\"+type+\"' has a size \"+size+\" greater than its container size \"+parentSize);\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (size !== 0 && start + size > stream.getEndPosition()) {\n\t\tstream.seek(start);\n\t\tLog.info(\"BoxParser\", \"Not enough data in stream to parse the entire '\"+type+\"' box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (headerOnly) {\n\t\treturn { code: BoxParser.OK, type: type, size: size, hdr_size: hdr_size, start: start };\n\t} else {\n\t\tif (BoxParser[type+\"Box\"]) {\n\t\t\tbox = new BoxParser[type+\"Box\"](size);\n\t\t} else {\n\t\t\tif (type !== \"uuid\") {\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown box type: '\"+type+\"'\");\n\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\tbox.has_unparsed_data = true;\n\t\t\t} else {\n\t\t\t\tif (BoxParser.UUIDBoxes[uuid]) {\n\t\t\t\t\tbox = new BoxParser.UUIDBoxes[uuid](size);\n\t\t\t\t} else {\n\t\t\t\t\tLog.warn(\"BoxParser\", \"Unknown uuid type: '\"+uuid+\"'\");\n\t\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\t\tbox.uuid = uuid;\n\t\t\t\t\tbox.has_unparsed_data = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tbox.hdr_size = hdr_size;\n\t/* recording the position of the box in the input stream */\n\tbox.start = start;\n\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\tLog.info(\"BoxParser\", \"'\"+box_type+\"' box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\tbox.parseDataAndRewind(stream);\n\t}\n\tbox.parse(stream);\n\tdiff = stream.getPosition() - (box.start+box.size);\n\tif (diff < 0) {\n\t\tLog.warn(\"BoxParser\", \"Parsing of box '\"+box_type+\"' did not read the entire indicated box data size (missing \"+(-diff)+\" bytes), seeking forward\");\n\t\tstream.seek(box.start+box.size);\n\t} else if (diff > 0) {\n\t\tLog.error(\"BoxParser\", \"Parsing of box '\"+box_type+\"' read \"+diff+\" more bytes than the indicated box data size, seeking backwards\");\n\t\tif (box.size !== 0) stream.seek(box.start+box.size);\n\t}\n\treturn { code: BoxParser.OK, box: box, size: box.size };\n}\n\nBoxParser.Box.prototype.parse = function(stream) {\n\tif (this.type != \"mdat\") {\n\t\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t} else {\n\t\tif (this.size === 0) {\n\t\t\tstream.seek(stream.getEndPosition());\n\t\t} else {\n\t\t\tstream.seek(this.start+this.size);\n\t\t}\n\t}\n}\n\n/* Used to parse a box without consuming its data, to allow detailled parsing\n   Useful for boxes for which a write method is not yet implemented */\nBoxParser.Box.prototype.parseDataAndRewind = function(stream) {\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.FullBox.prototype.parseDataAndRewind = function(stream) {\n\tthis.parseFullHeader(stream);\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t// restore the header size as if the full header had not been parsed\n\tthis.hdr_size -= 4;\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.FullBox.prototype.parseFullHeader = function (stream) {\n\tthis.version = stream.readUint8();\n\tthis.flags = stream.readUint24();\n\tthis.hdr_size += 4;\n}\n\nBoxParser.FullBox.prototype.parse = function (stream) {\n\tthis.parseFullHeader(stream);\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n}\n\nBoxParser.ContainerBox.prototype.parse = function(stream) {\n\tvar ret;\n\tvar box;\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\t/* store the box in the 'boxes' array to preserve box order (for offset) but also store box in a property for more direct access */\n\t\t\tthis.boxes.push(box);\n\t\t\tif (this.subBoxNames && this.subBoxNames.indexOf(box.type) != -1) {\n\t\t\t\tthis[this.subBoxNames[this.subBoxNames.indexOf(box.type)]+\"s\"].push(box);\n\t\t\t} else {\n\t\t\t\tvar box_type = box.type !== \"uuid\" ? box.type : box.uuid;\n\t\t\t\tif (this[box_type]) {\n\t\t\t\t\tLog.warn(\"Box of type \"+box_type+\" already stored in field of this type\");\n\t\t\t\t} else {\n\t\t\t\t\tthis[box_type] = box;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nBoxParser.Box.prototype.parseLanguage = function(stream) {\n\tthis.language = stream.readUint16();\n\tvar chars = [];\n\tchars[0] = (this.language>>10)&0x1F;\n\tchars[1] = (this.language>>5)&0x1F;\n\tchars[2] = (this.language)&0x1F;\n\tthis.languageString = String.fromCharCode(chars[0]+0x60, chars[1]+0x60, chars[2]+0x60);\n}\n\n// file:src/parsing/sampleentries/sampleentry.js\nBoxParser.SAMPLE_ENTRY_TYPE_VISUAL \t\t= \"Visual\";\nBoxParser.SAMPLE_ENTRY_TYPE_AUDIO \t\t= \"Audio\";\nBoxParser.SAMPLE_ENTRY_TYPE_HINT \t\t= \"Hint\";\nBoxParser.SAMPLE_ENTRY_TYPE_METADATA \t= \"Metadata\";\nBoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE \t= \"Subtitle\";\nBoxParser.SAMPLE_ENTRY_TYPE_SYSTEM \t\t= \"System\";\nBoxParser.SAMPLE_ENTRY_TYPE_TEXT \t\t= \"Text\";\n\nBoxParser.SampleEntry.prototype.parseHeader = function(stream) {\n\tstream.readUint8Array(6);\n\tthis.data_reference_index = stream.readUint16();\n\tthis.hdr_size += 8;\n}\n\nBoxParser.SampleEntry.prototype.parse = function(stream) {\n\tthis.parseHeader(stream);\n\tthis.data = stream.readUint8Array(this.size - this.hdr_size);\n}\n\nBoxParser.SampleEntry.prototype.parseDataAndRewind = function(stream) {\n\tthis.parseHeader(stream);\n\tthis.data = stream.readUint8Array(this.size - this.hdr_size);\n\t// restore the header size as if the sample entry header had not been parsed\n\tthis.hdr_size -= 8;\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.SampleEntry.prototype.parseFooter = function(stream) {\n\tBoxParser.ContainerBox.prototype.parse.call(this, stream);\n}\n\n// Base SampleEntry types with default parsing\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_HINT);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SYSTEM);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_TEXT);\n\n//Base SampleEntry types for Audio and Video with specific parsing\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, function(stream) {\n\tvar compressorname_length;\n\tthis.parseHeader(stream);\n\tstream.readUint16();\n\tstream.readUint16();\n\tstream.readUint32Array(3);\n\tthis.width = stream.readUint16();\n\tthis.height = stream.readUint16();\n\tthis.horizresolution = stream.readUint32();\n\tthis.vertresolution = stream.readUint32();\n\tstream.readUint32();\n\tthis.frame_count = stream.readUint16();\n\tcompressorname_length = Math.min(31, stream.readUint8());\n\tthis.compressorname = stream.readString(compressorname_length);\n\tif (compressorname_length < 31) {\n\t\tstream.readString(31 - compressorname_length);\n\t}\n\tthis.depth = stream.readUint16();\n\tstream.readUint16();\n\tthis.parseFooter(stream);\n});\n\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, function(stream) {\n\tthis.parseHeader(stream);\n\tstream.readUint32Array(2);\n\tthis.channel_count = stream.readUint16();\n\tthis.samplesize = stream.readUint16();\n\tstream.readUint16();\n\tstream.readUint16();\n\tthis.samplerate = (stream.readUint32()/(1<<16));\n\tthis.parseFooter(stream);\n});\n\n// Sample entries inheriting from Audio and Video\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc4\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"av01\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"dav1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hvc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hev1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hvt1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"lhe1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"dvh1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"dvhe\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvi1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvs1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvcN\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vp08\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vp09\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avs3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"j2ki\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"mjp2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"mjpg\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL,\t\"uncv\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mp4a\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ac-3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ac-4\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ec-3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"Opus\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mha1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mha2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mhm1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mhm2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"fLaC\");\n\n// Encrypted sample entries\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \t\"encv\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"enca\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \t\"encu\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SYSTEM, \t\"encs\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_TEXT, \t\t\"enct\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \t\"encm\");\n// file:src/parsing/a1lx.js\nBoxParser.createBoxCtor(\"a1lx\", \"AV1LayeredImageIndexingProperty\", function(stream) {\n\tvar large_size = stream.readUint8() & 1;\n\tvar FieldLength = ((large_size & 1) + 1) * 16;\n\tthis.layer_size = [];\n\tfor (var i = 0; i < 3; i++) {\n\t\tif (FieldLength == 16) {\n\t\t\tthis.layer_size[i] = stream.readUint16();\n\t\t} else {\n\t\t\tthis.layer_size[i] = stream.readUint32();\n\t\t}\n\t}\n});// file:src/parsing/a1op.js\nBoxParser.createBoxCtor(\"a1op\", \"OperatingPointSelectorProperty\", function(stream) {\n\tthis.op_index = stream.readUint8();\n});// file:src/parsing/auxC.js\nBoxParser.createFullBoxCtor(\"auxC\", \"AuxiliaryTypeProperty\", function(stream) {\n\tthis.aux_type = stream.readCString();\n\tvar aux_subtype_length = this.size - this.hdr_size - (this.aux_type.length + 1);\n\tthis.aux_subtype = stream.readUint8Array(aux_subtype_length);\n});// file:src/parsing/av1C.js\nBoxParser.createBoxCtor(\"av1C\", \"AV1CodecConfigurationBox\", function(stream) {\n\tvar i;\n\tvar toparse;\n\tvar tmp = stream.readUint8();\n\tif ((tmp >> 7 & 0x1) !== 1) {\n\t\tLog.error(\"av1C marker problem\");\n\t\treturn;\n\t}\n\tthis.version = tmp & 0x7F;\n\tif (this.version !== 1) {\n\t\tLog.error(\"av1C version \"+this.version+\" not supported\");\n\t\treturn;\n\t}\n\ttmp = stream.readUint8();\n\tthis.seq_profile = (tmp >> 5) & 0x7;\n\tthis.seq_level_idx_0 = tmp & 0x1F;\n\ttmp = stream.readUint8();\n\tthis.seq_tier_0 = (tmp >> 7) & 0x1;\n\tthis.high_bitdepth = (tmp >> 6) & 0x1;\n\tthis.twelve_bit = (tmp >> 5) & 0x1;\n\tthis.monochrome = (tmp >> 4) & 0x1;\n\tthis.chroma_subsampling_x = (tmp >> 3) & 0x1;\n\tthis.chroma_subsampling_y = (tmp >> 2) & 0x1;\n\tthis.chroma_sample_position = (tmp & 0x3);\n\ttmp = stream.readUint8();\n\tthis.reserved_1 = (tmp >> 5) & 0x7;\n\tif (this.reserved_1 !== 0) {\n\t\tLog.error(\"av1C reserved_1 parsing problem\");\n\t\treturn;\n\t}\n\tthis.initial_presentation_delay_present = (tmp >> 4) & 0x1;\n\tif (this.initial_presentation_delay_present === 1) {\n\t\tthis.initial_presentation_delay_minus_one = (tmp & 0xF);\n\t} else {\n\t\tthis.reserved_2 = (tmp & 0xF);\n\t\tif (this.reserved_2 !== 0) {\n\t\t\tLog.error(\"av1C reserved_2 parsing problem\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tvar configOBUs_length = this.size - this.hdr_size - 4;\n\tthis.configOBUs = stream.readUint8Array(configOBUs_length);\n});\n\n// file:src/parsing/avcC.js\nfunction printPS(ps) {\n\tvar str = \"<table class='inner-table'>\";\n\tstr += \"<thead><tr><th>length</th><th>nalu_data</th></tr></thead>\";\n\tstr += \"<tbody>\";\n\n\tfor (var i=0; i < ps.length; i++) {\n\t\tvar nalu = ps[i];\n\t\tstr += \"<tr>\";\n\t\tstr += \"<td>\"+nalu.length+\"</td>\";\n\t\tstr += \"<td>\";\n\t\tstr += nalu.nalu.reduce(function(str, byte) {\n\t\t\treturn str + byte.toString(16).padStart(2, \"0\");\n\t\t}, \"0x\");\n\t\tstr += \"</td></tr>\";\n\t}\n\tstr += \"</tbody></table>\";\n\treturn str;\n}\n\nBoxParser.createBoxCtor(\"avcC\", \"AVCConfigurationBox\", function(stream) {\n\tvar i;\n\tvar toparse;\n\tthis.configurationVersion = stream.readUint8();\n\tthis.AVCProfileIndication = stream.readUint8();\n\tthis.profile_compatibility = stream.readUint8();\n\tthis.AVCLevelIndication = stream.readUint8();\n\tthis.lengthSizeMinusOne = (stream.readUint8() & 0x3);\n\tthis.nb_SPS_nalus = (stream.readUint8() & 0x1F);\n\ttoparse = this.size - this.hdr_size - 6;\n\tthis.SPS = [];\n\tthis.SPS.toString = function () {\n\t\treturn printPS(this);\n\t}\n\tfor (i = 0; i < this.nb_SPS_nalus; i++) {\n\t\tthis.SPS[i] = {};\n\t\tthis.SPS[i].length = stream.readUint16();\n\t\tthis.SPS[i].nalu = stream.readUint8Array(this.SPS[i].length);\n\t\ttoparse -= 2+this.SPS[i].length;\n\t}\n\tthis.nb_PPS_nalus = stream.readUint8();\n\ttoparse--;\n\tthis.PPS = [];\n\tthis.PPS.toString = function () {\n\t\treturn printPS(this);\n\t}\n\tfor (i = 0; i < this.nb_PPS_nalus; i++) {\n\t\tthis.PPS[i] = {};\n\t\tthis.PPS[i].length = stream.readUint16();\n\t\tthis.PPS[i].nalu = stream.readUint8Array(this.PPS[i].length);\n\t\ttoparse -= 2+this.PPS[i].length;\n\t}\n\tif (toparse>0) {\n\t\tthis.ext = stream.readUint8Array(toparse);\n\t}\n});\n\n// file:src/parsing/btrt.js\nBoxParser.createBoxCtor(\"btrt\", \"BitRateBox\", function(stream) {\n\tthis.bufferSizeDB = stream.readUint32();\n\tthis.maxBitrate = stream.readUint32();\n\tthis.avgBitrate = stream.readUint32();\n});\n\n// file:src/parsing/ccst.js\nBoxParser.createFullBoxCtor(\"ccst\", \"CodingConstraintsBox\", function(stream) {\n\tvar flags = stream.readUint8();\n\tthis.all_ref_pics_intra = ((flags & 0x80) == 0x80);\n\tthis.intra_pred_used = ((flags & 0x40) == 0x40);\n\tthis.max_ref_per_pic = ((flags & 0x3f) >> 2);\n\tstream.readUint24();\n});\n\n// file:src/parsing/cdef.js\nBoxParser.createBoxCtor(\"cdef\", \"ComponentDefinitionBox\", function(stream) {\n    var i;\n    this.channel_count = stream.readUint16();\n    this.channel_indexes = [];\n    this.channel_types = [];\n    this.channel_associations = [];\n    for (i = 0; i < this.channel_count; i++) {\n        this.channel_indexes.push(stream.readUint16());\n        this.channel_types.push(stream.readUint16());\n        this.channel_associations.push(stream.readUint16());\n    }\n});\n\n// file:src/parsing/clap.js\nBoxParser.createBoxCtor(\"clap\", \"CleanApertureBox\", function(stream) {\n\tthis.cleanApertureWidthN = stream.readUint32();\n\tthis.cleanApertureWidthD = stream.readUint32();\n\tthis.cleanApertureHeightN = stream.readUint32();\n\tthis.cleanApertureHeightD = stream.readUint32();\n\tthis.horizOffN = stream.readUint32();\n\tthis.horizOffD = stream.readUint32();\n\tthis.vertOffN = stream.readUint32();\n\tthis.vertOffD = stream.readUint32();\n});// file:src/parsing/clli.js\nBoxParser.createBoxCtor(\"clli\", \"ContentLightLevelBox\", function(stream) {\n\tthis.max_content_light_level = stream.readUint16();\n    this.max_pic_average_light_level = stream.readUint16();\n});\n\n// file:src/parsing/cmex.js\nBoxParser.createFullBoxCtor(\"cmex\", \"CameraExtrinsicMatrixProperty\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.pos_x = stream.readInt32();\n\t}\n\tif (this.flags & 0x2) {\n\t\tthis.pos_y = stream.readInt32();\n\t}\n\tif (this.flags & 0x4) {\n\t\tthis.pos_z = stream.readInt32();\n\t}\n\tif (this.flags & 0x8) {\n\t\tif (this.version == 0) {\n\t\t\tif (this.flags & 0x10) {\n\t\t\t\tthis.quat_x = stream.readInt32();\n\t\t\t\tthis.quat_y = stream.readInt32();\n\t\t\t\tthis.quat_z = stream.readInt32();\n\t\t\t} else {\n\t\t\t\tthis.quat_x = stream.readInt16();\n\t\t\t\tthis.quat_y = stream.readInt16();\n\t\t\t\tthis.quat_z = stream.readInt16();\n\t\t\t}\n\t\t} else if (this.version == 1) {\n\t\t\t//ViewpointGlobalCoordinateSysRotationStruct rot;\n\t\t}\n\t}\n\tif (this.flags & 0x20) {\n\t\tthis.id = stream.readUint32();\n\t}\n});\n// file:src/parsing/cmin.js\nBoxParser.createFullBoxCtor(\"cmin\", \"CameraIntrinsicMatrixProperty\", function(stream) {\n\tthis.focal_length_x = stream.readInt32();\n\tthis.principal_point_x = stream.readInt32();\n\tthis.principal_point_y = stream.readInt32();\n\tif (this.flags & 0x1) {\n\t\tthis.focal_length_y = stream.readInt32();\n\t\tthis.skew_factor = stream.readInt32();\n\t}\n});// file:src/parsing/cmpd.js\nBoxParser.createBoxCtor(\"cmpd\", \"ComponentDefinitionBox\", function(stream) {\n\tthis.component_count = stream.readUint32();\n\tthis.component_types = [];\n\tthis.component_type_urls = [];\n\tfor (i = 0; i < this.component_count; i++) {\n\t\tvar component_type = stream.readUint16();\n\t\tthis.component_types.push(component_type);\n\t\tif (component_type >= 0x8000) {\n\t\t\tthis.component_type_urls.push(stream.readCString());\n\t\t}\n\t}\n});// file:src/parsing/co64.js\nBoxParser.createFullBoxCtor(\"co64\", \"ChunkLargeOffsetBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.chunk_offsets = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.chunk_offsets.push(stream.readUint64());\n\t\t}\n\t}\n});\n\n// file:src/parsing/CoLL.js\nBoxParser.createFullBoxCtor(\"CoLL\", \"ContentLightLevelBox\", function(stream) {\n\tthis.maxCLL = stream.readUint16();\n    this.maxFALL = stream.readUint16();\n});\n\n// file:src/parsing/colr.js\nBoxParser.createBoxCtor(\"colr\", \"ColourInformationBox\", function(stream) {\n\tthis.colour_type = stream.readString(4);\n\tif (this.colour_type === 'nclx') {\n\t\tthis.colour_primaries = stream.readUint16();\n\t\tthis.transfer_characteristics = stream.readUint16();\n\t\tthis.matrix_coefficients = stream.readUint16();\n\t\tvar tmp = stream.readUint8();\n\t\tthis.full_range_flag = tmp >> 7;\n\t} else if (this.colour_type === 'rICC') {\n\t\tthis.ICC_profile = stream.readUint8Array(this.size - 4);\n\t} else if (this.colour_type === 'prof') {\n\t\tthis.ICC_profile = stream.readUint8Array(this.size - 4);\n\t}\n});// file:src/parsing/cprt.js\nBoxParser.createFullBoxCtor(\"cprt\", \"CopyrightBox\", function (stream) {\n\tthis.parseLanguage(stream);\n\tthis.notice = stream.readCString();\n});\n\n// file:src/parsing/cslg.js\nBoxParser.createFullBoxCtor(\"cslg\", \"CompositionToDecodeBox\", function(stream) {\n\tvar entry_count;\n\tif (this.version === 0) {\n\t\tthis.compositionToDTSShift = stream.readInt32(); /* signed */\n\t\tthis.leastDecodeToDisplayDelta = stream.readInt32(); /* signed */\n\t\tthis.greatestDecodeToDisplayDelta = stream.readInt32(); /* signed */\n\t\tthis.compositionStartTime = stream.readInt32(); /* signed */\n\t\tthis.compositionEndTime = stream.readInt32(); /* signed */\n\t}\n});\n\n// file:src/parsing/ctts.js\nBoxParser.createFullBoxCtor(\"ctts\", \"CompositionOffsetBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.sample_counts = [];\n\tthis.sample_offsets = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\t/* some files are buggy and declare version=0 while using signed offsets.\n\t\t\t   The likelyhood of using the most significant bit in a 32-bits time offset is very low,\n\t\t\t   so using signed value here as well */\n\t\t\t   var value = stream.readInt32();\n\t\t\t   if (value < 0) {\n\t\t\t   \t\tLog.warn(\"BoxParser\", \"ctts box uses negative values without using version 1\");\n\t\t\t   }\n\t\t\tthis.sample_offsets.push(value);\n\t\t}\n\t} else if (this.version == 1) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\tthis.sample_offsets.push(stream.readInt32()); /* signed */\n\t\t}\n\t}\n});\n\n// file:src/parsing/dac3.js\nBoxParser.createBoxCtor(\"dac3\", \"AC3SpecificBox\", function(stream) {\n\tvar tmp_byte1 = stream.readUint8();\n\tvar tmp_byte2 = stream.readUint8();\n\tvar tmp_byte3 = stream.readUint8();\n\tthis.fscod = tmp_byte1 >> 6;\n\tthis.bsid  = ((tmp_byte1 >> 1) & 0x1F);\n\tthis.bsmod = ((tmp_byte1 & 0x1) <<  2) | ((tmp_byte2 >> 6) & 0x3);\n\tthis.acmod = ((tmp_byte2 >> 3) & 0x7);\n\tthis.lfeon = ((tmp_byte2 >> 2) & 0x1);\n\tthis.bit_rate_code = (tmp_byte2 & 0x3) | ((tmp_byte3 >> 5) & 0x7);\n});\n\n// file:src/parsing/dec3.js\nBoxParser.createBoxCtor(\"dec3\", \"EC3SpecificBox\", function(stream) {\n\tvar tmp_16 = stream.readUint16();\n\tthis.data_rate = tmp_16 >> 3;\n\tthis.num_ind_sub = tmp_16 & 0x7;\n\tthis.ind_subs = [];\n\tfor (var i = 0; i < this.num_ind_sub+1; i++) {\n\t\tvar ind_sub = {};\n\t\tthis.ind_subs.push(ind_sub);\n\t\tvar tmp_byte1 = stream.readUint8();\n\t\tvar tmp_byte2 = stream.readUint8();\n\t\tvar tmp_byte3 = stream.readUint8();\n\t\tind_sub.fscod = tmp_byte1 >> 6;\n\t\tind_sub.bsid  = ((tmp_byte1 >> 1) & 0x1F);\n\t\tind_sub.bsmod = ((tmp_byte1 & 0x1) << 4) | ((tmp_byte2 >> 4) & 0xF);\n\t\tind_sub.acmod = ((tmp_byte2 >> 1) & 0x7);\n\t\tind_sub.lfeon = (tmp_byte2 & 0x1);\n\t\tind_sub.num_dep_sub = ((tmp_byte3 >> 1) & 0xF);\n\t\tif (ind_sub.num_dep_sub > 0) {\n\t\t\tind_sub.chan_loc = ((tmp_byte3 & 0x1) << 8) | stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/dfLa.js\nBoxParser.createFullBoxCtor(\"dfLa\", \"FLACSpecificBox\", function(stream) {\n    var BLOCKTYPE_MASK = 0x7F;\n    var LASTMETADATABLOCKFLAG_MASK = 0x80;\n\n    var boxesFound = [];\n    var knownBlockTypes = [\n        \"STREAMINFO\",\n        \"PADDING\",\n        \"APPLICATION\",\n        \"SEEKTABLE\",\n        \"VORBIS_COMMENT\",\n        \"CUESHEET\",\n        \"PICTURE\",\n        \"RESERVED\"\n    ];\n\n    // for (i=0; ; i++) { // to end of box\n    do {\n        var flagAndType = stream.readUint8();\n\n        var type = Math.min(\n            (flagAndType & BLOCKTYPE_MASK),\n            (knownBlockTypes.length - 1)\n        );\n\n        // if this is a STREAMINFO block, read the true samplerate since this\n        // can be different to the AudioSampleEntry samplerate.\n        if (!(type)) {\n            // read past all the other stuff\n            stream.readUint8Array(13);\n\n            // extract samplerate\n            this.samplerate = (stream.readUint32() >> 12);\n\n            // read to end of STREAMINFO\n            stream.readUint8Array(20);\n        } else {\n            // not interested in other block types so just discard length bytes\n            stream.readUint8Array(stream.readUint24());\n        }\n\n        boxesFound.push(knownBlockTypes[type]);\n\n        if (!!(flagAndType & LASTMETADATABLOCKFLAG_MASK)) {\n            break;\n        }\n    } while (true);\n\n    this.numMetadataBlocks =\n        boxesFound.length + \" (\" + boxesFound.join(\", \") + \")\";\n});\n// file:src/parsing/dimm.js\nBoxParser.createBoxCtor(\"dimm\", \"hintimmediateBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/dmax.js\nBoxParser.createBoxCtor(\"dmax\", \"hintlongestpacket\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/dmed.js\nBoxParser.createBoxCtor(\"dmed\", \"hintmediaBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/dOps.js\nBoxParser.createBoxCtor(\"dOps\", \"OpusSpecificBox\", function(stream) {\n\tthis.Version = stream.readUint8();\n\tthis.OutputChannelCount = stream.readUint8();\n\tthis.PreSkip = stream.readUint16();\n\tthis.InputSampleRate = stream.readUint32();\n\tthis.OutputGain = stream.readInt16();\n\tthis.ChannelMappingFamily = stream.readUint8();\n\tif (this.ChannelMappingFamily !== 0) {\n\t\tthis.StreamCount = stream.readUint8();\n\t\tthis.CoupledCount = stream.readUint8();\n\t\tthis.ChannelMapping = [];\n\t\tfor (var i = 0; i < this.OutputChannelCount; i++) {\n\t\t\tthis.ChannelMapping[i] = stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/dref.js\nBoxParser.createFullBoxCtor(\"dref\", \"DataReferenceBox\", function(stream) {\n\tvar ret;\n\tvar box;\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.entries.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/drep.js\nBoxParser.createBoxCtor(\"drep\", \"hintrepeatedBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/elng.js\nBoxParser.createFullBoxCtor(\"elng\", \"ExtendedLanguageBox\", function(stream) {\n\tthis.extended_language = stream.readString(this.size-this.hdr_size);\n});\n\n// file:src/parsing/elst.js\nBoxParser.createFullBoxCtor(\"elst\", \"EditListBox\", function(stream) {\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry = {};\n\t\tthis.entries.push(entry);\n\t\tif (this.version === 1) {\n\t\t\tentry.segment_duration = stream.readUint64();\n\t\t\tentry.media_time = stream.readInt64();\n\t\t} else {\n\t\t\tentry.segment_duration = stream.readUint32();\n\t\t\tentry.media_time = stream.readInt32();\n\t\t}\n\t\tentry.media_rate_integer = stream.readInt16();\n\t\tentry.media_rate_fraction = stream.readInt16();\n\t}\n});\n\n// file:src/parsing/emsg.js\nBoxParser.createFullBoxCtor(\"emsg\", \"EventMessageBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.timescale \t\t\t\t\t= stream.readUint32();\n\t\tthis.presentation_time \t\t\t= stream.readUint64();\n\t\tthis.event_duration\t\t\t \t= stream.readUint32();\n\t\tthis.id \t\t\t\t\t\t= stream.readUint32();\n\t\tthis.scheme_id_uri \t\t\t\t= stream.readCString();\n\t\tthis.value \t\t\t\t\t\t= stream.readCString();\n\t} else {\n\t\tthis.scheme_id_uri \t\t\t\t= stream.readCString();\n\t\tthis.value \t\t\t\t\t\t= stream.readCString();\n\t\tthis.timescale \t\t\t\t\t= stream.readUint32();\n\t\tthis.presentation_time_delta \t= stream.readUint32();\n\t\tthis.event_duration\t\t\t \t= stream.readUint32();\n\t\tthis.id \t\t\t\t\t\t= stream.readUint32();\n\t}\n\tvar message_size = this.size - this.hdr_size - (4*4 + (this.scheme_id_uri.length+1) + (this.value.length+1));\n\tif (this.version == 1) {\n\t\tmessage_size -= 4;\n\t}\n\tthis.message_data = stream.readUint8Array(message_size);\n});\n\n// file:src/parsing/EntityToGroup.js\n// ISO/IEC 14496-12:2022 Section 8.18.3 Entity to group box\nBoxParser.createEntityToGroupCtor = function(type, parseMethod) {\n    BoxParser[type+\"Box\"] = function(size) {\n        BoxParser.FullBox.call(this, type, size);\n    }\n    BoxParser[type+\"Box\"].prototype = new BoxParser.FullBox();\n    BoxParser[type+\"Box\"].prototype.parse = function(stream) {\n        this.parseFullHeader(stream);\n        if (parseMethod) {\n            parseMethod.call(this, stream);\n        } else {\n            this.group_id = stream.readUint32();\n            this.num_entities_in_group = stream.readUint32();\n            this.entity_ids = [];\n            for (i = 0; i < this.num_entities_in_group; i++) {\n                var entity_id = stream.readUint32();\n                this.entity_ids.push(entity_id);\n            }\n        }\n    };\n};\n\n// Auto exposure bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.2.1)\nBoxParser.createEntityToGroupCtor(\"aebr\");\n\n// Flash exposure bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.5.1)\nBoxParser.createEntityToGroupCtor(\"afbr\");\n\n// Album collection (ISO/IEC 23008-12:2022 Section 6.8.7.1)\nBoxParser.createEntityToGroupCtor(\"albc\");\n\n// Alternative entity (ISO/IEC 14496-12:2022 Section 8.18.3.1)\nBoxParser.createEntityToGroupCtor(\"altr\");\n\n// Burst image entity group (ISO/IEC 23008-12:2022 Section 6.8.2.2)\nBoxParser.createEntityToGroupCtor(\"brst\");\n\n// Depth of field bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.6.1)\nBoxParser.createEntityToGroupCtor(\"dobr\");\n\n// Equivalent entity (ISO/IEC 23008-12:2022 Section 6.8.1.1)\nBoxParser.createEntityToGroupCtor(\"eqiv\");\n\n// Favourites collection (ISO/IEC 23008-12:2022 Section 6.8.7.2)\nBoxParser.createEntityToGroupCtor(\"favc\");\n\n// Focus bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.4.1)\nBoxParser.createEntityToGroupCtor(\"fobr\");\n\n// Audio to image entity group (ISO/IEC 23008-12:2022 Section 6.8.4)\nBoxParser.createEntityToGroupCtor(\"iaug\");\n\n// Panorama (ISO/IEC 23008-12:2022 Section 6.8.8.1)\nBoxParser.createEntityToGroupCtor(\"pano\");\n\n// Slideshow (ISO/IEC 23008-12:2022 Section 6.8.9.1)\nBoxParser.createEntityToGroupCtor(\"slid\");\n\n// Stereo pair (ISO/IEC 23008-12:2022 Section 6.8.5)\nBoxParser.createEntityToGroupCtor(\"ster\");\n\n// Time-synchronised capture entity group (ISO/IEC 23008-12:2022 Section 6.8.3)\nBoxParser.createEntityToGroupCtor(\"tsyn\");\n\n// White balance bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.3.1)\nBoxParser.createEntityToGroupCtor(\"wbbr\");\n\n// Alternative entity (ISO/IEC 23008-12:2022 AMD1 Section 6.8.10)\nBoxParser.createEntityToGroupCtor(\"prgr\");\n\n// Image Pyramid entity group (ISO/IEC 23008-12:20xx Section 6.8.11)\nBoxParser.createEntityToGroupCtor(\"pymd\", function(stream) {\n    this.group_id = stream.readUint32();\n    this.num_entities_in_group = stream.readUint32();\n    this.entity_ids = [];\n    for (var i = 0; i < this.num_entities_in_group; i++) {\n        var entity_id = stream.readUint32();\n        this.entity_ids.push(entity_id);\n    }\n    \n    this.tile_size_x = stream.readUint16();\n    this.tile_size_y = stream.readUint16();\n    this.layer_binning = [];\n    this.tiles_in_layer_column_minus1 = [];\n    this.tiles_in_layer_row_minus1 = [];\n    for (i = 0; i < this.num_entities_in_group; i++) {\n        this.layer_binning[i] = stream.readUint16();\n        this.tiles_in_layer_row_minus1[i] = stream.readUint16();\n        this.tiles_in_layer_column_minus1[i] = stream.readUint16();\n    }\n});\n\n// file:src/parsing/esds.js\nBoxParser.createFullBoxCtor(\"esds\", \"ElementaryStreamDescriptorBox\", function(stream) {\n\tvar esd_data = stream.readUint8Array(this.size-this.hdr_size);\n\tif (typeof MPEG4DescriptorParser !== \"undefined\") {\n\t\tvar esd_parser = new MPEG4DescriptorParser();\n\t\tthis.esd = esd_parser.parseOneDescriptor(new DataStream(esd_data.buffer, 0, DataStream.BIG_ENDIAN));\n\t}\n});\n\n// file:src/parsing/fiel.js\nBoxParser.createBoxCtor(\"fiel\", \"FieldHandlingBox\", function(stream) {\n\tthis.fieldCount = stream.readUint8();\n\tthis.fieldOrdering = stream.readUint8();\n});\n\n// file:src/parsing/frma.js\nBoxParser.createBoxCtor(\"frma\", \"OriginalFormatBox\", function(stream) {\n\tthis.data_format = stream.readString(4);\n});\n\n// file:src/parsing/ftyp.js\nBoxParser.createBoxCtor(\"ftyp\", \"FileTypeBox\", function(stream) {\n\tvar toparse = this.size - this.hdr_size;\n\tthis.major_brand = stream.readString(4);\n\tthis.minor_version = stream.readUint32();\n\ttoparse -= 8;\n\tthis.compatible_brands = [];\n\tvar i = 0;\n\twhile (toparse>=4) {\n\t\tthis.compatible_brands[i] = stream.readString(4);\n\t\ttoparse -= 4;\n\t\ti++;\n\t}\n});\n\n// file:src/parsing/hdlr.js\nBoxParser.createFullBoxCtor(\"hdlr\", \"HandlerBox\", function(stream) {\n\tif (this.version === 0) {\n\t\tstream.readUint32();\n\t\tthis.handler = stream.readString(4);\n\t\tstream.readUint32Array(3);\n\t\tthis.name = stream.readString(this.size-this.hdr_size-20);\n\t\tif (this.name[this.name.length-1]==='\\0') {\n\t\t\tthis.name = this.name.slice(0,-1);\n\t\t}\n\t}\n});\n\n// file:src/parsing/hvcC.js\nBoxParser.createBoxCtor(\"hvcC\", \"HEVCConfigurationBox\", function(stream) {\n\tvar i, j;\n\tvar nb_nalus;\n\tvar length;\n\tvar tmp_byte;\n\tthis.configurationVersion = stream.readUint8();\n\ttmp_byte = stream.readUint8();\n\tthis.general_profile_space = tmp_byte >> 6;\n\tthis.general_tier_flag = (tmp_byte & 0x20) >> 5;\n\tthis.general_profile_idc = (tmp_byte & 0x1F);\n\tthis.general_profile_compatibility = stream.readUint32();\n\tthis.general_constraint_indicator = stream.readUint8Array(6);\n\tthis.general_level_idc = stream.readUint8();\n\tthis.min_spatial_segmentation_idc = stream.readUint16() & 0xFFF;\n\tthis.parallelismType = (stream.readUint8() & 0x3);\n\tthis.chroma_format_idc = (stream.readUint8() & 0x3);\n\tthis.bit_depth_luma_minus8 = (stream.readUint8() & 0x7);\n\tthis.bit_depth_chroma_minus8 = (stream.readUint8() & 0x7);\n\tthis.avgFrameRate = stream.readUint16();\n\ttmp_byte = stream.readUint8();\n\tthis.constantFrameRate = (tmp_byte >> 6);\n\tthis.numTemporalLayers = (tmp_byte & 0XD) >> 3;\n\tthis.temporalIdNested = (tmp_byte & 0X4) >> 2;\n\tthis.lengthSizeMinusOne = (tmp_byte & 0X3);\n\n\tthis.nalu_arrays = [];\n\tthis.nalu_arrays.toString = function () {\n\t\tvar str = \"<table class='inner-table'>\";\n\t\tstr += \"<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>\";\n\t\tstr += \"<tbody>\";\n\n\t\tfor (var i=0; i<this.length; i++) {\n\t\t\tvar nalu_array = this[i];\n\t\t\tstr += \"<tr>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.completeness+\"</td>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.nalu_type+\"</td>\";\n\t\t\tfor (var j=0; j<nalu_array.length; j++) {\n\t\t\t\tvar nalu = nalu_array[j];\n\t\t\t\tif (j !== 0) str += \"<tr>\";\n\t\t\t\tstr += \"<td>\";\n\t\t\t\tstr += nalu.data.reduce(function(str, byte) {\n\t\t\t\t\treturn str + byte.toString(16).padStart(2, \"0\");\n\t\t\t\t}, \"0x\");\n\t\t\t\tstr += \"</td></tr>\";\n\t\t\t}\n\t\t}\n\t\tstr += \"</tbody></table>\";\n\t\treturn str;\n\t}\n\tvar numOfArrays = stream.readUint8();\n\tfor (i = 0; i < numOfArrays; i++) {\n\t\tvar nalu_array = [];\n\t\tthis.nalu_arrays.push(nalu_array);\n\t\ttmp_byte = stream.readUint8()\n\t\tnalu_array.completeness = (tmp_byte & 0x80) >> 7;\n\t\tnalu_array.nalu_type = tmp_byte & 0x3F;\n\t\tvar numNalus = stream.readUint16();\n\t\tfor (j = 0; j < numNalus; j++) {\n\t\t\tvar nalu = {}\n\t\t\tnalu_array.push(nalu);\n\t\t\tlength = stream.readUint16();\n\t\t\tnalu.data   = stream.readUint8Array(length);\n\t\t}\n\t}\n});\n\n// file:src/parsing/iinf.js\nBoxParser.createFullBoxCtor(\"iinf\", \"ItemInfoBox\", function(stream) {\n\tvar ret;\n\tif (this.version === 0) {\n\t\tthis.entry_count = stream.readUint16();\n\t} else {\n\t\tthis.entry_count = stream.readUint32();\n\t}\n\tthis.item_infos = [];\n\tfor (var i = 0; i < this.entry_count; i++) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (ret.box.type !== \"infe\") {\n\t\t\t\tLog.error(\"BoxParser\", \"Expected 'infe' box, got \"+ret.box.type);\n\t\t\t}\n\t\t\tthis.item_infos[i] = ret.box;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/iloc.js\nBoxParser.createFullBoxCtor(\"iloc\", \"ItemLocationBox\", function(stream) {\n\tvar byte;\n\tbyte = stream.readUint8();\n\tthis.offset_size = (byte >> 4) & 0xF;\n\tthis.length_size = byte & 0xF;\n\tbyte = stream.readUint8();\n\tthis.base_offset_size = (byte >> 4) & 0xF;\n\tif (this.version === 1 || this.version === 2) {\n\t\tthis.index_size = byte & 0xF;\n\t} else {\n\t\tthis.index_size = 0;\n\t\t// reserved = byte & 0xF;\n\t}\n\tthis.items = [];\n\tvar item_count = 0;\n\tif (this.version < 2) {\n\t\titem_count = stream.readUint16();\n\t} else if (this.version === 2) {\n\t\titem_count = stream.readUint32();\n\t} else {\n\t\tthrow \"version of iloc box not supported\";\n\t}\n\tfor (var i = 0; i < item_count; i++) {\n\t\tvar item = {};\n\t\tthis.items.push(item);\n\t\tif (this.version < 2) {\n\t\t\titem.item_ID = stream.readUint16();\n\t\t} else if (this.version === 2) {\n\t\t\titem.item_ID = stream.readUint32();\n\t\t} else {\n\t\t\tthrow \"version of iloc box not supported\";\n\t\t}\n\t\tif (this.version === 1 || this.version === 2) {\n\t\t\titem.construction_method = (stream.readUint16() & 0xF);\n\t\t} else {\n\t\t\titem.construction_method = 0;\n\t\t}\n\t\titem.data_reference_index = stream.readUint16();\n\t\tswitch(this.base_offset_size) {\n\t\t\tcase 0:\n\t\t\t\titem.base_offset = 0;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\titem.base_offset = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tcase 8:\n\t\t\t\titem.base_offset = stream.readUint64();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow \"Error reading base offset size\";\n\t\t}\n\t\tvar extent_count = stream.readUint16();\n\t\titem.extents = [];\n\t\tfor (var j=0; j < extent_count; j++) {\n\t\t\tvar extent = {};\n\t\t\titem.extents.push(extent);\n\t\t\tif (this.version === 1 || this.version === 2) {\n\t\t\t\tswitch(this.index_size) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\textent.extent_index = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\textent.extent_index = stream.readUint32();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 8:\n\t\t\t\t\t\textent.extent_index = stream.readUint64();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(this.offset_size) {\n\t\t\t\tcase 0:\n\t\t\t\t\textent.extent_offset = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\textent.extent_offset = stream.readUint32();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\textent.extent_offset = stream.readUint64();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t}\n\t\t\tswitch(this.length_size) {\n\t\t\t\tcase 0:\n\t\t\t\t\textent.extent_length = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\textent.extent_length = stream.readUint32();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\textent.extent_length = stream.readUint64();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/imir.js\nBoxParser.createBoxCtor(\"imir\", \"ImageMirror\", function(stream) {\n\tvar tmp = stream.readUint8();\n\tthis.reserved = tmp >> 7;\n\tthis.axis = tmp & 1;\n});// file:src/parsing/infe.js\nBoxParser.createFullBoxCtor(\"infe\", \"ItemInfoEntry\", function(stream) {\n\tif (this.version === 0 || this.version === 1) {\n\t\tthis.item_ID = stream.readUint16();\n\t\tthis.item_protection_index = stream.readUint16();\n\t\tthis.item_name = stream.readCString();\n\t\tthis.content_type = stream.readCString();\n\t\tthis.content_encoding = stream.readCString();\n\t}\n\tif (this.version === 1) {\n\t\tthis.extension_type = stream.readString(4);\n\t\tLog.warn(\"BoxParser\", \"Cannot parse extension type\");\n\t\tstream.seek(this.start+this.size);\n\t\treturn;\n\t}\n\tif (this.version >= 2) {\n\t\tif (this.version === 2) {\n\t\t\tthis.item_ID = stream.readUint16();\n\t\t} else if (this.version === 3) {\n\t\t\tthis.item_ID = stream.readUint32();\n\t\t}\n\t\tthis.item_protection_index = stream.readUint16();\n\t\tthis.item_type = stream.readString(4);\n\t\tthis.item_name = stream.readCString();\n\t\tif (this.item_type === \"mime\") {\n\t\t\tthis.content_type = stream.readCString();\n\t\t\tthis.content_encoding = stream.readCString();\n\t\t} else if (this.item_type === \"uri \") {\n\t\t\tthis.item_uri_type = stream.readCString();\n\t\t}\n\t}\n});\n// file:src/parsing/ipma.js\nBoxParser.createFullBoxCtor(\"ipma\", \"ItemPropertyAssociationBox\", function(stream) {\n\tvar i, j;\n\tentry_count = stream.readUint32();\n\tthis.associations = [];\n\tfor(i=0; i<entry_count; i++) {\n\t\tvar item_assoc = {};\n\t\tthis.associations.push(item_assoc);\n\t\tif (this.version < 1) {\n\t\t\titem_assoc.id = stream.readUint16();\n\t\t} else {\n\t\t\titem_assoc.id = stream.readUint32();\n\t\t}\n\t\tvar association_count = stream.readUint8();\n\t\titem_assoc.props = [];\n\t\tfor (j = 0; j < association_count; j++) {\n\t\t\tvar tmp = stream.readUint8();\n\t\t\tvar p = {};\n\t\t\titem_assoc.props.push(p);\n\t\t\tp.essential = ((tmp & 0x80) >> 7) === 1;\n\t\t\tif (this.flags & 0x1) {\n\t\t\t\tp.property_index = (tmp & 0x7F) << 8 | stream.readUint8();\n\t\t\t} else {\n\t\t\t\tp.property_index = (tmp & 0x7F);\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/iref.js\nBoxParser.createFullBoxCtor(\"iref\", \"ItemReferenceBox\", function(stream) {\n\tvar ret;\n\tvar entryCount;\n\tvar box;\n\tthis.references = [];\n\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (this.version === 0) {\n\t\t\t\tbox = new BoxParser.SingleItemTypeReferenceBox(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t} else {\n\t\t\t\tbox = new BoxParser.SingleItemTypeReferenceBoxLarge(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t}\n\t\t\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\t\t\tLog.warn(\"BoxParser\", box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.references.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n// file:src/parsing/irot.js\nBoxParser.createBoxCtor(\"irot\", \"ImageRotation\", function(stream) {\n\tthis.angle = stream.readUint8() & 0x3;\n});\n\n// file:src/parsing/ispe.js\nBoxParser.createFullBoxCtor(\"ispe\", \"ImageSpatialExtentsProperty\", function(stream) {\n\tthis.image_width = stream.readUint32();\n\tthis.image_height = stream.readUint32();\n});// file:src/parsing/kind.js\nBoxParser.createFullBoxCtor(\"kind\", \"KindBox\", function(stream) {\n\tthis.schemeURI = stream.readCString();\n\tthis.value = stream.readCString();\n});\n// file:src/parsing/leva.js\nBoxParser.createFullBoxCtor(\"leva\", \"LevelAssignmentBox\", function(stream) {\n\tvar count = stream.readUint8();\n\tthis.levels = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tvar level = {};\n\t\tthis.levels[i] = level;\n\t\tlevel.track_ID = stream.readUint32();\n\t\tvar tmp_byte = stream.readUint8();\n\t\tlevel.padding_flag = tmp_byte >> 7;\n\t\tlevel.assignment_type = tmp_byte & 0x7F;\n\t\tswitch (level.assignment_type) {\n\t\t\tcase 0:\n\t\t\t\tlevel.grouping_type = stream.readString(4);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tlevel.grouping_type = stream.readString(4);\n\t\t\t\tlevel.grouping_type_parameter = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tlevel.sub_track_id = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown leva assignement type\");\n\t\t}\n\t}\n});\n\n// file:src/parsing/lhvC.js\nBoxParser.createBoxCtor(\"lhvC\", \"LHEVCConfigurationBox\", function(stream) {\n\tvar i, j;\n\tvar tmp_byte;\n\tthis.configurationVersion = stream.readUint8();\n\tthis.min_spatial_segmentation_idc = stream.readUint16() & 0xFFF;\n\tthis.parallelismType = (stream.readUint8() & 0x3);\n\ttmp_byte = stream.readUint8();\n\tthis.numTemporalLayers = (tmp_byte & 0XD) >> 3;\n\tthis.temporalIdNested = (tmp_byte & 0X4) >> 2;\n\tthis.lengthSizeMinusOne = (tmp_byte & 0X3);\n\n\tthis.nalu_arrays = [];\n\tthis.nalu_arrays.toString = function () {\n\t\tvar str = \"<table class='inner-table'>\";\n\t\tstr += \"<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>\";\n\t\tstr += \"<tbody>\";\n\n\t\tfor (var i=0; i<this.length; i++) {\n\t\t\tvar nalu_array = this[i];\n\t\t\tstr += \"<tr>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.completeness+\"</td>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.nalu_type+\"</td>\";\n\t\t\tfor (var j=0; j<nalu_array.length; j++) {\n\t\t\t\tvar nalu = nalu_array[j];\n\t\t\t\tif (j !== 0) str += \"<tr>\";\n\t\t\t\tstr += \"<td>\";\n\t\t\t\tstr += nalu.data.reduce(function(str, byte) {\n\t\t\t\t\treturn str + byte.toString(16).padStart(2, \"0\");\n\t\t\t\t}, \"0x\");\n\t\t\t\tstr += \"</td></tr>\";\n\t\t\t}\n\t\t}\n\t\tstr += \"</tbody></table>\";\n\t\treturn str;\n\t}\n\tvar numOfArrays = stream.readUint8();\n\tfor (i = 0; i < numOfArrays; i++) {\n\t\tvar nalu_array = [];\n\t\tthis.nalu_arrays.push(nalu_array);\n\t\ttmp_byte = stream.readUint8()\n\t\tnalu_array.completeness = (tmp_byte & 0x80) >> 7;\n\t\tnalu_array.nalu_type = tmp_byte & 0x3F;\n\t\tvar numNalus = stream.readUint16();\n\t\tfor (j = 0; j < numNalus; j++) {\n\t\t\tvar nalu = {}\n\t\t\tnalu_array.push(nalu);\n\t\t\tvar length = stream.readUint16();\n\t\t\tnalu.data  = stream.readUint8Array(length);\n\t\t}\n\t}\n});\n\n// file:src/parsing/lsel.js\nBoxParser.createBoxCtor(\"lsel\", \"LayerSelectorProperty\", function(stream) {\n\tthis.layer_id = stream.readUint16();\n});// file:src/parsing/maxr.js\nBoxParser.createBoxCtor(\"maxr\", \"hintmaxrate\", function(stream) {\n\tthis.period = stream.readUint32();\n\tthis.bytes = stream.readUint32();\n});\n\n// file:src/parsing/mdcv.js\nfunction ColorPoint(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nColorPoint.prototype.toString = function() {\n    return \"(\"+this.x+\",\"+this.y+\")\";\n}\n\nBoxParser.createBoxCtor(\"mdcv\", \"MasteringDisplayColourVolumeBox\", function(stream) {\n    this.display_primaries = [];\n    this.display_primaries[0] = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.display_primaries[1] = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.display_primaries[2] = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.white_point = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.max_display_mastering_luminance = stream.readUint32();\n    this.min_display_mastering_luminance = stream.readUint32();\n});\n\n// file:src/parsing/mdhd.js\nBoxParser.createFullBoxCtor(\"mdhd\", \"MediaHeaderBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tthis.parseLanguage(stream);\n\tstream.readUint16();\n});\n\n// file:src/parsing/mehd.js\nBoxParser.createFullBoxCtor(\"mehd\", \"MovieExtendsHeaderBox\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tLog.warn(\"BoxParser\", \"mehd box incorrectly uses flags set to 1, converting version to 1\");\n\t\tthis.version = 1;\n\t}\n\tif (this.version == 1) {\n\t\tthis.fragment_duration = stream.readUint64();\n\t} else {\n\t\tthis.fragment_duration = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/meta.js\nBoxParser.createFullBoxCtor(\"meta\", \"MetaBox\", function(stream) {\n\tthis.boxes = [];\n\tBoxParser.ContainerBox.prototype.parse.call(this, stream);\n});\n// file:src/parsing/mfhd.js\nBoxParser.createFullBoxCtor(\"mfhd\", \"MovieFragmentHeaderBox\", function(stream) {\n\tthis.sequence_number = stream.readUint32();\n});\n\n// file:src/parsing/mfro.js\nBoxParser.createFullBoxCtor(\"mfro\", \"MovieFragmentRandomAccessOffsetBox\", function(stream) {\n\tthis._size = stream.readUint32();\n});\n\n// file:src/parsing/mskC.js\nBoxParser.createFullBoxCtor(\"mskC\", \"MaskConfigurationProperty\", function(stream) {\n    this.bits_per_pixel = stream.readUint8();\n});\n\n// file:src/parsing/mvhd.js\nBoxParser.createFullBoxCtor(\"mvhd\", \"MovieHeaderBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tthis.rate = stream.readUint32();\n\tthis.volume = stream.readUint16()>>8;\n\tstream.readUint16();\n\tstream.readUint32Array(2);\n\tthis.matrix = stream.readUint32Array(9);\n\tstream.readUint32Array(6);\n\tthis.next_track_id = stream.readUint32();\n});\n// file:src/parsing/npck.js\nBoxParser.createBoxCtor(\"npck\", \"hintPacketsSent\", function(stream) {\n\tthis.packetssent = stream.readUint32();\n});\n\n// file:src/parsing/nump.js\nBoxParser.createBoxCtor(\"nump\", \"hintPacketsSent\", function(stream) {\n\tthis.packetssent = stream.readUint64();\n});\n\n// file:src/parsing/padb.js\nBoxParser.createFullBoxCtor(\"padb\", \"PaddingBitsBox\", function(stream) {\n\tvar sample_count = stream.readUint32();\n\tthis.padbits = [];\n\tfor (var i = 0; i < Math.floor((sample_count+1)/2); i++) {\n\t\tthis.padbits = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/pasp.js\nBoxParser.createBoxCtor(\"pasp\", \"PixelAspectRatioBox\", function(stream) {\n\tthis.hSpacing = stream.readUint32();\n\tthis.vSpacing = stream.readUint32();\n});// file:src/parsing/payl.js\nBoxParser.createBoxCtor(\"payl\", \"CuePayloadBox\", function(stream) {\n\tthis.text = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/payt.js\nBoxParser.createBoxCtor(\"payt\", \"hintpayloadID\", function(stream) {\n\tthis.payloadID = stream.readUint32();\n\tvar count = stream.readUint8();\n\tthis.rtpmap_string = stream.readString(count);\n});\n\n// file:src/parsing/pdin.js\nBoxParser.createFullBoxCtor(\"pdin\", \"ProgressiveDownloadInfoBox\", function(stream) {\n\tvar count = (this.size - this.hdr_size)/8;\n\tthis.rate = [];\n\tthis.initial_delay = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.rate[i] = stream.readUint32();\n\t\tthis.initial_delay[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/pitm.js\nBoxParser.createFullBoxCtor(\"pitm\", \"PrimaryItemBox\", function(stream) {\n\tif (this.version === 0) {\n\t\tthis.item_id = stream.readUint16();\n\t} else {\n\t\tthis.item_id = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/pixi.js\nBoxParser.createFullBoxCtor(\"pixi\", \"PixelInformationProperty\", function(stream) {\n\tvar i;\n\tthis.num_channels = stream.readUint8();\n\tthis.bits_per_channels = [];\n\tfor (i = 0; i < this.num_channels; i++) {\n\t\tthis.bits_per_channels[i] = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/pmax.js\nBoxParser.createBoxCtor(\"pmax\", \"hintlargestpacket\", function(stream) {\n\tthis.bytes = stream.readUint32();\n});\n\n// file:src/parsing/prdi.js\nBoxParser.createFullBoxCtor(\"prdi\", \"ProgressiveDerivedImageItemInformationProperty\", function(stream) {\n\tthis.step_count = stream.readUint16();\n\tthis.item_count = [];\n\tif (this.flags & 0x2) {\n\t\tfor (var i = 0; i < this.step_count; i++) {\n\t\t\tthis.item_count[i] = stream.readUint16();\n\t\t}\n\t}\n});// file:src/parsing/prft.js\nBoxParser.createFullBoxCtor(\"prft\", \"ProducerReferenceTimeBox\", function(stream) {\n\tthis.ref_track_id = stream.readUint32();\n\tthis.ntp_timestamp = stream.readUint64();\n\tif (this.version === 0) {\n\t\tthis.media_time = stream.readUint32();\n\t} else {\n\t\tthis.media_time = stream.readUint64();\n\t}\n});\n\n// file:src/parsing/pssh.js\nBoxParser.createFullBoxCtor(\"pssh\", \"ProtectionSystemSpecificHeaderBox\", function(stream) {\n\tthis.system_id = BoxParser.parseHex16(stream);\n\tif (this.version > 0) {\n\t\tvar count = stream.readUint32();\n\t\tthis.kid = [];\n\t\tfor (var i = 0; i < count; i++) {\n\t\t\tthis.kid[i] = BoxParser.parseHex16(stream);\n\t\t}\n\t}\n\tvar datasize = stream.readUint32();\n\tif (datasize > 0) {\n\t\tthis.data = stream.readUint8Array(datasize);\n\t}\n});\n\n// file:src/parsing/qt/clef.js\nBoxParser.createFullBoxCtor(\"clef\", \"TrackCleanApertureDimensionsBox\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/enof.js\nBoxParser.createFullBoxCtor(\"enof\", \"TrackEncodedPixelsDimensionsBox\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/prof.js\nBoxParser.createFullBoxCtor(\"prof\", \"TrackProductionApertureDimensionsBox\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/tapt.js\nBoxParser.createContainerBoxCtor(\"tapt\", \"TrackApertureModeDimensionsBox\", null, [ \"clef\", \"prof\", \"enof\"]);// file:src/parsing/rtp.js\nBoxParser.createBoxCtor(\"rtp \", \"rtpmoviehintinformation\", function(stream) {\n\tthis.descriptionformat = stream.readString(4);\n\tthis.sdptext = stream.readString(this.size - this.hdr_size - 4);\n});\n\n// file:src/parsing/saio.js\nBoxParser.createFullBoxCtor(\"saio\", \"SampleAuxiliaryInformationOffsetsBox\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.aux_info_type = stream.readString(4);\n\t\tthis.aux_info_type_parameter = stream.readUint32();\n\t}\n\tvar count = stream.readUint32();\n\tthis.offset = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tif (this.version === 0) {\n\t\t\tthis.offset[i] = stream.readUint32();\n\t\t} else {\n\t\t\tthis.offset[i] = stream.readUint64();\n\t\t}\n\t}\n});\n// file:src/parsing/saiz.js\nBoxParser.createFullBoxCtor(\"saiz\", \"SampleAuxiliaryInformationSizesBox\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.aux_info_type = stream.readString(4);\n\t\tthis.aux_info_type_parameter = stream.readUint32();\n\t}\n\tthis.default_sample_info_size = stream.readUint8();\n\tthis.sample_count = stream.readUint32();\n\tthis.sample_info_size = [];\n\tif (this.default_sample_info_size === 0) {\n\t\tfor (var i = 0; i < this.sample_count; i++) {\n\t\t\tthis.sample_info_size[i] = stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/sampleentries/mett.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"mett\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/metx.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"metx\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.namespace = stream.readCString();\n\tthis.schema_location = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/sbtt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"sbtt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/stpp.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"stpp\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.namespace = stream.readCString();\n\tthis.schema_location = stream.readCString();\n\tthis.auxiliary_mime_types = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/stxt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"stxt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/tx3g.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"tx3g\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.displayFlags = stream.readUint32();\n\tthis.horizontal_justification = stream.readInt8();\n\tthis.vertical_justification = stream.readInt8();\n\tthis.bg_color_rgba = stream.readUint8Array(4);\n\tthis.box_record = stream.readInt16Array(4);\n\tthis.style_record = stream.readUint8Array(12);\n\tthis.parseFooter(stream);\n});\n// file:src/parsing/sampleentries/wvtt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"wvtt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/samplegroups/alst.js\nBoxParser.createSampleGroupCtor(\"alst\", function(stream) {\n\tvar i;\n\tvar roll_count = stream.readUint16();\n\tthis.first_output_sample = stream.readUint16();\n\tthis.sample_offset = [];\n\tfor (i = 0; i < roll_count; i++) {\n\t\tthis.sample_offset[i] = stream.readUint32();\n\t}\n\tvar remaining = this.description_length - 4 - 4*roll_count;\n\tthis.num_output_samples = [];\n\tthis.num_total_samples = [];\n\tfor (i = 0; i < remaining/4; i++) {\n\t\tthis.num_output_samples[i] = stream.readUint16();\n\t\tthis.num_total_samples[i] = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/samplegroups/avll.js\nBoxParser.createSampleGroupCtor(\"avll\", function(stream) {\n\tthis.layerNumber = stream.readUint8();\n\tthis.accurateStatisticsFlag = stream.readUint8();\n\tthis.avgBitRate = stream.readUint16();\n\tthis.avgFrameRate = stream.readUint16();\n});\n\n// file:src/parsing/samplegroups/avss.js\nBoxParser.createSampleGroupCtor(\"avss\", function(stream) {\n\tthis.subSequenceIdentifier = stream.readUint16();\n\tthis.layerNumber = stream.readUint8();\n\tvar tmp_byte = stream.readUint8();\n\tthis.durationFlag = tmp_byte >> 7;\n\tthis.avgRateFlag = (tmp_byte >> 6) & 0x1;\n\tif (this.durationFlag) {\n\t\tthis.duration = stream.readUint32();\n\t}\n\tif (this.avgRateFlag) {\n\t\tthis.accurateStatisticsFlag = stream.readUint8();\n\t\tthis.avgBitRate = stream.readUint16();\n\t\tthis.avgFrameRate = stream.readUint16();\n\t}\n\tthis.dependency = [];\n\tvar numReferences = stream.readUint8();\n\tfor (var i = 0; i < numReferences; i++) {\n\t\tvar dependencyInfo = {};\n\t\tthis.dependency.push(dependencyInfo);\n\t\tdependencyInfo.subSeqDirectionFlag = stream.readUint8();\n\t\tdependencyInfo.layerNumber = stream.readUint8();\n\t\tdependencyInfo.subSequenceIdentifier = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/samplegroups/dtrt.js\nBoxParser.createSampleGroupCtor(\"dtrt\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/mvif.js\nBoxParser.createSampleGroupCtor(\"mvif\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/prol.js\nBoxParser.createSampleGroupCtor(\"prol\", function(stream) {\n\tthis.roll_distance = stream.readInt16();\n});\n\n// file:src/parsing/samplegroups/rap.js\nBoxParser.createSampleGroupCtor(\"rap \", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.num_leading_samples_known = tmp_byte >> 7;\n\tthis.num_leading_samples = tmp_byte & 0x7F;\n});\n\n// file:src/parsing/samplegroups/rash.js\nBoxParser.createSampleGroupCtor(\"rash\", function(stream) {\n\tthis.operation_point_count = stream.readUint16();\n\tif (this.description_length !== 2+(this.operation_point_count === 1?2:this.operation_point_count*6)+9) {\n\t\tLog.warn(\"BoxParser\", \"Mismatch in \"+this.grouping_type+\" sample group length\");\n\t\tthis.data =  stream.readUint8Array(this.description_length-2);\n\t} else {\n\t\tif (this.operation_point_count === 1) {\n\t\t\tthis.target_rate_share = stream.readUint16();\n\t\t} else {\n\t\t\tthis.target_rate_share = [];\n\t\t\tthis.available_bitrate = [];\n\t\t\tfor (var i = 0; i < this.operation_point_count; i++) {\n\t\t\t\tthis.available_bitrate[i] = stream.readUint32();\n\t\t\t\tthis.target_rate_share[i] = stream.readUint16();\n\t\t\t}\n\t\t}\n\t\tthis.maximum_bitrate = stream.readUint32();\n\t\tthis.minimum_bitrate = stream.readUint32();\n\t\tthis.discard_priority = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/samplegroups/roll.js\nBoxParser.createSampleGroupCtor(\"roll\", function(stream) {\n\tthis.roll_distance = stream.readInt16();\n});\n\n// file:src/parsing/samplegroups/samplegroup.js\nBoxParser.SampleGroupEntry.prototype.parse = function(stream) {\n\tLog.warn(\"BoxParser\", \"Unknown Sample Group type: \"+this.grouping_type);\n\tthis.data =  stream.readUint8Array(this.description_length);\n}\n\n// file:src/parsing/samplegroups/scif.js\nBoxParser.createSampleGroupCtor(\"scif\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/scnm.js\nBoxParser.createSampleGroupCtor(\"scnm\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/seig.js\nBoxParser.createSampleGroupCtor(\"seig\", function(stream) {\n\tthis.reserved = stream.readUint8();\n\tvar tmp = stream.readUint8();\n\tthis.crypt_byte_block = tmp >> 4;\n\tthis.skip_byte_block = tmp & 0xF;\n\tthis.isProtected = stream.readUint8();\n\tthis.Per_Sample_IV_Size = stream.readUint8();\n\tthis.KID = BoxParser.parseHex16(stream);\n\tthis.constant_IV_size = 0;\n\tthis.constant_IV = 0;\n\tif (this.isProtected === 1 && this.Per_Sample_IV_Size === 0) {\n\t\tthis.constant_IV_size = stream.readUint8();\n\t\tthis.constant_IV = stream.readUint8Array(this.constant_IV_size);\n\t}\n});\n\n// file:src/parsing/samplegroups/stsa.js\nBoxParser.createSampleGroupCtor(\"stsa\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/sync.js\nBoxParser.createSampleGroupCtor(\"sync\", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.NAL_unit_type = tmp_byte & 0x3F;\n});\n\n// file:src/parsing/samplegroups/tele.js\nBoxParser.createSampleGroupCtor(\"tele\", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.level_independently_decodable = tmp_byte >> 7;\n});\n\n// file:src/parsing/samplegroups/tsas.js\nBoxParser.createSampleGroupCtor(\"tsas\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/tscl.js\nBoxParser.createSampleGroupCtor(\"tscl\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/vipr.js\nBoxParser.createSampleGroupCtor(\"vipr\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/sbgp.js\nBoxParser.createFullBoxCtor(\"sbgp\", \"SampleToGroupBox\", function(stream) {\n\tthis.grouping_type = stream.readString(4);\n\tif (this.version === 1) {\n\t\tthis.grouping_type_parameter = stream.readUint32();\n\t} else {\n\t\tthis.grouping_type_parameter = 0;\n\t}\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry = {};\n\t\tthis.entries.push(entry);\n\t\tentry.sample_count = stream.readInt32();\n\t\tentry.group_description_index = stream.readInt32();\n\t}\n});\n\n// file:src/parsing/sbpm.js\nfunction Pixel(row, col) {\n\tthis.bad_pixel_row = row;\n\tthis.bad_pixel_column = col;\n}\n\nPixel.prototype.toString = function pixelToString() {\n\treturn \"[row: \" + this.bad_pixel_row + \", column: \" + this.bad_pixel_column + \"]\";\n}\n\nBoxParser.createFullBoxCtor(\"sbpm\", \"SensorBadPixelsMapBox\", function(stream) {\n\tvar i;\n\tthis.component_count = stream.readUint16();\n    this.component_index = [];\n    for (i = 0; i < this.component_count; i++) {\n        this.component_index.push(stream.readUint16());\n    }\n\tvar flags = stream.readUint8();\n\tthis.correction_applied = (0x80 == (flags & 0x80));\n\tthis.num_bad_rows = stream.readUint32();\n\tthis.num_bad_cols = stream.readUint32();\n\tthis.num_bad_pixels = stream.readUint32();\n\tthis.bad_rows = [];\n\tthis.bad_columns = [];\n\tthis.bad_pixels = [];\n\tfor (i = 0; i < this.num_bad_rows; i++) {\n\t\tthis.bad_rows.push(stream.readUint32());\n\t}\n\tfor (i = 0; i < this.num_bad_cols; i++) {\n\t\tthis.bad_columns.push(stream.readUint32());\n\t}\n\tfor (i = 0; i < this.num_bad_pixels; i++) {\n\t\tvar row = stream.readUint32();\n\t\tvar col = stream.readUint32();\n\t\tthis.bad_pixels.push(new Pixel(row, col));\n\t}\n});\n\n// file:src/parsing/schm.js\nBoxParser.createFullBoxCtor(\"schm\", \"SchemeTypeBox\", function(stream) {\n\tthis.scheme_type = stream.readString(4);\n\tthis.scheme_version = stream.readUint32();\n\tif (this.flags & 0x000001) {\n\t\tthis.scheme_uri = stream.readString(this.size - this.hdr_size - 8);\n\t}\n});\n\n// file:src/parsing/sdp.js\nBoxParser.createBoxCtor(\"sdp \", \"rtptracksdphintinformation\", function(stream) {\n\tthis.sdptext = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/sdtp.js\nBoxParser.createFullBoxCtor(\"sdtp\", \"SampleDependencyTypeBox\", function(stream) {\n\tvar tmp_byte;\n\tvar count = (this.size - this.hdr_size);\n\tthis.is_leading = [];\n\tthis.sample_depends_on = [];\n\tthis.sample_is_depended_on = [];\n\tthis.sample_has_redundancy = [];\n\tfor (var i = 0; i < count; i++) {\n\t\ttmp_byte = stream.readUint8();\n\t\tthis.is_leading[i] = tmp_byte >> 6;\n\t\tthis.sample_depends_on[i] = (tmp_byte >> 4) & 0x3;\n\t\tthis.sample_is_depended_on[i] = (tmp_byte >> 2) & 0x3;\n\t\tthis.sample_has_redundancy[i] = tmp_byte & 0x3;\n\t}\n});\n\n// file:src/parsing/senc.js\n// Cannot be fully parsed because Per_Sample_IV_Size needs to be known\r\nBoxParser.createFullBoxCtor(\"senc\", \"SampleEncryptionBox\" /*, function(stream) {\r\n\tthis.parseFullHeader(stream);\r\n\tvar sample_count = stream.readUint32();\r\n\tthis.samples = [];\r\n\tfor (var i = 0; i < sample_count; i++) {\r\n\t\tvar sample = {};\r\n\t\t// tenc.default_Per_Sample_IV_Size or seig.Per_Sample_IV_Size\r\n\t\tsample.InitializationVector = this.readUint8Array(Per_Sample_IV_Size*8);\r\n\t\tif (this.flags & 0x2) {\r\n\t\t\tsample.subsamples = [];\r\n\t\t\tsubsample_count = stream.readUint16();\r\n\t\t\tfor (var j = 0; j < subsample_count; j++) {\r\n\t\t\t\tvar subsample = {};\r\n\t\t\t\tsubsample.BytesOfClearData = stream.readUint16();\r\n\t\t\t\tsubsample.BytesOfProtectedData = stream.readUint32();\r\n\t\t\t\tsample.subsamples.push(subsample);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// TODO\r\n\t\tthis.samples.push(sample);\r\n\t}\r\n}*/);\r\n// file:src/parsing/sgpd.js\nBoxParser.createFullBoxCtor(\"sgpd\", \"SampleGroupDescriptionBox\", function(stream) {\n\tthis.grouping_type = stream.readString(4);\n\tLog.debug(\"BoxParser\", \"Found Sample Groups of type \"+this.grouping_type);\n\tif (this.version === 1) {\n\t\tthis.default_length = stream.readUint32();\n\t} else {\n\t\tthis.default_length = 0;\n\t}\n\tif (this.version >= 2) {\n\t\tthis.default_group_description_index = stream.readUint32();\n\t}\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry;\n\t\tif (BoxParser[this.grouping_type+\"SampleGroupEntry\"]) {\n\t\t\tentry = new BoxParser[this.grouping_type+\"SampleGroupEntry\"](this.grouping_type);\n\t\t}  else {\n\t\t\tentry = new BoxParser.SampleGroupEntry(this.grouping_type);\n\t\t}\n\t\tthis.entries.push(entry);\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tentry.description_length = stream.readUint32();\n\t\t\t} else {\n\t\t\t\tentry.description_length = this.default_length;\n\t\t\t}\n\t\t} else {\n\t\t\tentry.description_length = this.default_length;\n\t\t}\n\t\tif (entry.write === BoxParser.SampleGroupEntry.prototype.write) {\n\t\t\tLog.info(\"BoxParser\", \"SampleGroup for type \"+this.grouping_type+\" writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t// storing data\n\t\t\tentry.data = stream.readUint8Array(entry.description_length);\n\t\t\t// rewinding\n\t\t\tstream.position -= entry.description_length;\n\t\t}\n\t\tentry.parse(stream);\n\t}\n});\n\n// file:src/parsing/sidx.js\nBoxParser.createFullBoxCtor(\"sidx\", \"CompressedSegmentIndexBox\", function(stream) {\n\tthis.reference_ID = stream.readUint32();\n\tthis.timescale = stream.readUint32();\n\tif (this.version === 0) {\n\t\tthis.earliest_presentation_time = stream.readUint32();\n\t\tthis.first_offset = stream.readUint32();\n\t} else {\n\t\tthis.earliest_presentation_time = stream.readUint64();\n\t\tthis.first_offset = stream.readUint64();\n\t}\n\tstream.readUint16();\n\tthis.references = [];\n\tvar count = stream.readUint16();\n\tfor (var i = 0; i < count; i++) {\n\t\tvar ref = {};\n\t\tthis.references.push(ref);\n\t\tvar tmp_32 = stream.readUint32();\n\t\tref.reference_type = (tmp_32 >> 31) & 0x1;\n\t\tref.referenced_size = tmp_32 & 0x7FFFFFFF;\n\t\tref.subsegment_duration = stream.readUint32();\n\t\ttmp_32 = stream.readUint32();\n\t\tref.starts_with_SAP = (tmp_32 >> 31) & 0x1;\n\t\tref.SAP_type = (tmp_32 >> 28) & 0x7;\n\t\tref.SAP_delta_time = tmp_32 & 0xFFFFFFF;\n\t}\n});\n\n// file:src/parsing/singleitemtypereference.js\nBoxParser.SingleItemTypeReferenceBox = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.SingleItemTypeReferenceBox.prototype = new BoxParser.Box();\nBoxParser.SingleItemTypeReferenceBox.prototype.parse = function(stream) {\n\tthis.from_item_ID = stream.readUint16();\n\tvar count =  stream.readUint16();\n\tthis.references = [];\n\tfor(var i = 0; i < count; i++) {\n\t\tthis.references[i] = {};\n\t\tthis.references[i].to_item_ID = stream.readUint16();\n\t}\n}\n\n// file:src/parsing/singleitemtypereferencelarge.js\nBoxParser.SingleItemTypeReferenceBoxLarge = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.SingleItemTypeReferenceBoxLarge.prototype = new BoxParser.Box();\nBoxParser.SingleItemTypeReferenceBoxLarge.prototype.parse = function(stream) {\n\tthis.from_item_ID = stream.readUint32();\n\tvar count =  stream.readUint16();\n\tthis.references = [];\n\tfor(var i = 0; i < count; i++) {\n\t\tthis.references[i] = {};\n\t\tthis.references[i].to_item_ID = stream.readUint32();\n\t}\n}\n\n// file:src/parsing/SmDm.js\nBoxParser.createFullBoxCtor(\"SmDm\", \"SMPTE2086MasteringDisplayMetadataBox\", function(stream) {\n\tthis.primaryRChromaticity_x = stream.readUint16();\n    this.primaryRChromaticity_y = stream.readUint16();\n    this.primaryGChromaticity_x = stream.readUint16();\n    this.primaryGChromaticity_y = stream.readUint16();\n    this.primaryBChromaticity_x = stream.readUint16();\n    this.primaryBChromaticity_y = stream.readUint16();\n    this.whitePointChromaticity_x = stream.readUint16();\n    this.whitePointChromaticity_y = stream.readUint16();\n    this.luminanceMax = stream.readUint32();\n    this.luminanceMin = stream.readUint32();\n});\n\n// file:src/parsing/smhd.js\nBoxParser.createFullBoxCtor(\"smhd\", \"SoundMediaHeaderBox\", function(stream) {\n\tthis.balance = stream.readUint16();\n\tstream.readUint16();\n});\n\n// file:src/parsing/ssix.js\nBoxParser.createFullBoxCtor(\"ssix\", \"CompressedSubsegmentIndexBox\", function(stream) {\n\tthis.subsegments = [];\n\tvar subsegment_count = stream.readUint32();\n\tfor (var i = 0; i < subsegment_count; i++) {\n\t\tvar subsegment = {};\n\t\tthis.subsegments.push(subsegment);\n\t\tsubsegment.ranges = [];\n\t\tvar range_count = stream.readUint32();\n\t\tfor (var j = 0; j < range_count; j++) {\n\t\t\tvar range = {};\n\t\t\tsubsegment.ranges.push(range);\n\t\t\trange.level = stream.readUint8();\n\t\t\trange.range_size = stream.readUint24();\n\t\t}\n\t}\n});\n\n// file:src/parsing/stco.js\nBoxParser.createFullBoxCtor(\"stco\", \"ChunkOffsetBox\", function(stream) {\n\tvar entry_count;\n\tentry_count = stream.readUint32();\n\tthis.chunk_offsets = [];\n\tif (this.version === 0) {\n\t\tfor (var i = 0; i < entry_count; i++) {\n\t\t\tthis.chunk_offsets.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stdp.js\nBoxParser.createFullBoxCtor(\"stdp\", \"DegradationPriorityBox\", function(stream) {\n\tvar count = (this.size - this.hdr_size)/2;\n\tthis.priority = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.priority[i] = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/sthd.js\nBoxParser.createFullBoxCtor(\"sthd\", \"SubtitleMediaHeaderBox\");\n\n// file:src/parsing/stri.js\nBoxParser.createFullBoxCtor(\"stri\", \"SubTrackInformationBox\", function(stream) {\n\tthis.switch_group = stream.readUint16();\n\tthis.alternate_group = stream.readUint16();\n\tthis.sub_track_id = stream.readUint32();\n\tvar count = (this.size - this.hdr_size - 8)/4;\n\tthis.attribute_list = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.attribute_list[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/stsc.js\nBoxParser.createFullBoxCtor(\"stsc\", \"SampleToChunkBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.first_chunk = [];\n\tthis.samples_per_chunk = [];\n\tthis.sample_description_index = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.first_chunk.push(stream.readUint32());\n\t\t\tthis.samples_per_chunk.push(stream.readUint32());\n\t\t\tthis.sample_description_index.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsd.js\nBoxParser.createFullBoxCtor(\"stsd\", \"SampleDescriptionBox\", function(stream) {\n\tvar i;\n\tvar ret;\n\tvar entryCount;\n\tvar box;\n\tthis.entries = [];\n\tentryCount = stream.readUint32();\n\tfor (i = 1; i <= entryCount; i++) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (BoxParser[ret.type+\"SampleEntry\"]) {\n\t\t\t\tbox = new BoxParser[ret.type+\"SampleEntry\"](ret.size);\n\t\t\t\tbox.hdr_size = ret.hdr_size;\n\t\t\t\tbox.start = ret.start;\n\t\t\t} else {\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown sample entry type: \"+ret.type);\n\t\t\t\tbox = new BoxParser.SampleEntry(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t}\n\t\t\tif (box.write === BoxParser.SampleEntry.prototype.write) {\n\t\t\t\tLog.info(\"BoxParser\", \"SampleEntry \"+box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.entries.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsg.js\nBoxParser.createFullBoxCtor(\"stsg\", \"SubTrackSampleGroupBox\", function(stream) {\n\tthis.grouping_type = stream.readUint32();\n\tvar count = stream.readUint16();\n\tthis.group_description_index = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.group_description_index[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/stsh.js\nBoxParser.createFullBoxCtor(\"stsh\", \"ShadowSyncSampleBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.shadowed_sample_numbers = [];\n\tthis.sync_sample_numbers = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.shadowed_sample_numbers.push(stream.readUint32());\n\t\t\tthis.sync_sample_numbers.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stss.js\nBoxParser.createFullBoxCtor(\"stss\", \"SyncSampleBox\", function(stream) {\n\tvar i;\n\tvar entry_count;\n\tentry_count = stream.readUint32();\n\tif (this.version === 0) {\n\t\tthis.sample_numbers = [];\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_numbers.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsz.js\nBoxParser.createFullBoxCtor(\"stsz\", \"SampleSizeBox\", function(stream) {\n\tvar i;\n\tthis.sample_sizes = [];\n\tif (this.version === 0) {\n\t\tthis.sample_size = stream.readUint32();\n\t\tthis.sample_count = stream.readUint32();\n\t\tfor (i = 0; i < this.sample_count; i++) {\n\t\t\tif (this.sample_size === 0) {\n\t\t\t\tthis.sample_sizes.push(stream.readUint32());\n\t\t\t} else {\n\t\t\t\tthis.sample_sizes[i] = this.sample_size;\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/stts.js\nBoxParser.createFullBoxCtor(\"stts\", \"TimeToSampleBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tvar delta;\n\tentry_count = stream.readUint32();\n\tthis.sample_counts = [];\n\tthis.sample_deltas = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\tdelta = stream.readInt32();\n\t\t\tif (delta < 0) {\n\t\t\t\tLog.warn(\"BoxParser\", \"File uses negative stts sample delta, using value 1 instead, sync may be lost!\");\n\t\t\t\tdelta = 1;\n\t\t\t}\n\t\t\tthis.sample_deltas.push(delta);\n\t\t}\n\t}\n});\n\n// file:src/parsing/stvi.js\nBoxParser.createFullBoxCtor(\"stvi\", \"StereoVideoBox\", function(stream) {\n\tvar tmp32 = stream.readUint32();\n\tthis.single_view_allowed = tmp32 & 0x3;\n\tthis.stereo_scheme = stream.readUint32();\n\tvar length = stream.readUint32();\n\tthis.stereo_indication_type = stream.readString(length);\n\tvar ret;\n\tvar box;\n\tthis.boxes = [];\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.boxes.push(box);\n\t\t\tthis[box.type] = box;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/styp.js\nBoxParser.createBoxCtor(\"styp\", \"SegmentTypeBox\", function(stream) {\n\tBoxParser.ftypBox.prototype.parse.call(this, stream);\n});\n\n// file:src/parsing/stz2.js\nBoxParser.createFullBoxCtor(\"stz2\", \"CompactSampleSizeBox\", function(stream) {\n\tvar i;\n\tvar sample_size;\n\tvar sample_count;\n\tthis.sample_sizes = [];\n\tif (this.version === 0) {\n\t\tthis.reserved = stream.readUint24();\n\t\tthis.field_size = stream.readUint8();\n\t\tsample_count = stream.readUint32();\n\t\tif (this.field_size === 4) {\n\t\t\tfor (i = 0; i < sample_count; i+=2) {\n\t\t\t\tvar tmp = stream.readUint8();\n\t\t\t\tthis.sample_sizes[i] = (tmp >> 4) & 0xF;\n\t\t\t\tthis.sample_sizes[i+1] = tmp & 0xF;\n\t\t\t}\n\t\t} else if (this.field_size === 8) {\n\t\t\tfor (i = 0; i < sample_count; i++) {\n\t\t\t\tthis.sample_sizes[i] = stream.readUint8();\n\t\t\t}\n\t\t} else if (this.field_size === 16) {\n\t\t\tfor (i = 0; i < sample_count; i++) {\n\t\t\t\tthis.sample_sizes[i] = stream.readUint16();\n\t\t\t}\n\t\t} else {\n\t\t\tLog.error(\"BoxParser\", \"Error in length field in stz2 box\");\n\t\t}\n\t}\n});\n\n// file:src/parsing/subs.js\nBoxParser.createFullBoxCtor(\"subs\", \"SubSampleInformationBox\", function(stream) {\n\tvar i,j;\n\tvar entry_count;\n\tvar subsample_count;\n\tentry_count = stream.readUint32();\n\tthis.entries = [];\n\tfor (i = 0; i < entry_count; i++) {\n\t\tvar sampleInfo = {};\n\t\tthis.entries[i] = sampleInfo;\n\t\tsampleInfo.sample_delta = stream.readUint32();\n\t\tsampleInfo.subsamples = [];\n\t\tsubsample_count = stream.readUint16();\n\t\tif (subsample_count>0) {\n\t\t\tfor (j = 0; j < subsample_count; j++) {\n\t\t\t\tvar subsample = {};\n\t\t\t\tsampleInfo.subsamples.push(subsample);\n\t\t\t\tif (this.version == 1) {\n\t\t\t\t\tsubsample.size = stream.readUint32();\n\t\t\t\t} else {\n\t\t\t\t\tsubsample.size = stream.readUint16();\n\t\t\t\t}\n\t\t\t\tsubsample.priority = stream.readUint8();\n\t\t\t\tsubsample.discardable = stream.readUint8();\n\t\t\t\tsubsample.codec_specific_parameters = stream.readUint32();\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/tenc.js\nBoxParser.createFullBoxCtor(\"tenc\", \"TrackEncryptionBox\", function(stream) {\n\tstream.readUint8(); // reserved\n\tif (this.version === 0) {\n\t\tstream.readUint8();\n\t} else {\n\t\tvar tmp = stream.readUint8();\n\t\tthis.default_crypt_byte_block = (tmp >> 4) & 0xF;\n\t\tthis.default_skip_byte_block = tmp & 0xF;\n\t}\n\tthis.default_isProtected = stream.readUint8();\n\tthis.default_Per_Sample_IV_Size = stream.readUint8();\n\tthis.default_KID = BoxParser.parseHex16(stream);\n\tif (this.default_isProtected === 1 && this.default_Per_Sample_IV_Size === 0) {\n\t\tthis.default_constant_IV_size = stream.readUint8();\n\t\tthis.default_constant_IV = stream.readUint8Array(this.default_constant_IV_size);\n\t}\n});// file:src/parsing/tfdt.js\nBoxParser.createFullBoxCtor(\"tfdt\", \"TrackFragmentBaseMediaDecodeTimeBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.baseMediaDecodeTime = stream.readUint64();\n\t} else {\n\t\tthis.baseMediaDecodeTime = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/tfhd.js\nBoxParser.createFullBoxCtor(\"tfhd\", \"TrackFragmentHeaderBox\", function(stream) {\n\tvar readBytes = 0;\n\tthis.track_id = stream.readUint32();\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET)) {\n\t\tthis.base_data_offset = stream.readUint64();\n\t\treadBytes += 8;\n\t} else {\n\t\tthis.base_data_offset = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC)) {\n\t\tthis.default_sample_description_index = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_description_index = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR)) {\n\t\tthis.default_sample_duration = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_duration = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE)) {\n\t\tthis.default_sample_size = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_size = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS)) {\n\t\tthis.default_sample_flags = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_flags = 0;\n\t}\n});\n\n// file:src/parsing/tfra.js\nBoxParser.createFullBoxCtor(\"tfra\", \"TrackFragmentRandomAccessBox\", function(stream) {\n\tthis.track_ID = stream.readUint32();\n\tstream.readUint24();\n\tvar tmp_byte = stream.readUint8();\n\tthis.length_size_of_traf_num = (tmp_byte >> 4) & 0x3;\n\tthis.length_size_of_trun_num = (tmp_byte >> 2) & 0x3;\n\tthis.length_size_of_sample_num = (tmp_byte) & 0x3;\n\tthis.entries = [];\n\tvar number_of_entries = stream.readUint32();\n\tfor (var i = 0; i < number_of_entries; i++) {\n\t\tif (this.version === 1) {\n\t\t\tthis.time = stream.readUint64();\n\t\t\tthis.moof_offset = stream.readUint64();\n\t\t} else {\n\t\t\tthis.time = stream.readUint32();\n\t\t\tthis.moof_offset = stream.readUint32();\n\t\t}\n\t\tthis.traf_number = stream[\"readUint\"+(8*(this.length_size_of_traf_num+1))]();\n\t\tthis.trun_number = stream[\"readUint\"+(8*(this.length_size_of_trun_num+1))]();\n\t\tthis.sample_number = stream[\"readUint\"+(8*(this.length_size_of_sample_num+1))]();\n\t}\n});\n\n// file:src/parsing/tkhd.js\nBoxParser.createFullBoxCtor(\"tkhd\", \"TrackHeaderBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.track_id = stream.readUint32();\n\t\tstream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.track_id = stream.readUint32();\n\t\tstream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tstream.readUint32Array(2);\n\tthis.layer = stream.readInt16();\n\tthis.alternate_group = stream.readInt16();\n\tthis.volume = stream.readInt16()>>8;\n\tstream.readUint16();\n\tthis.matrix = stream.readInt32Array(9);\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});\n\n// file:src/parsing/tmax.js\nBoxParser.createBoxCtor(\"tmax\", \"hintmaxrelativetime\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/tmin.js\nBoxParser.createBoxCtor(\"tmin\", \"hintminrelativetime\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/totl.js\nBoxParser.createBoxCtor(\"totl\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint32();\n});\n\n// file:src/parsing/tpay.js\nBoxParser.createBoxCtor(\"tpay\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint32();\n});\n\n// file:src/parsing/tpyl.js\nBoxParser.createBoxCtor(\"tpyl\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/TrackGroup.js\nBoxParser.TrackGroupTypeBox.prototype.parse = function(stream) {\n\tthis.parseFullHeader(stream);\n\tthis.track_group_id = stream.readUint32();\n}\n\n// file:src/parsing/trackgroups/msrc.js\nBoxParser.createTrackGroupCtor(\"msrc\");// file:src/parsing/TrakReference.js\nBoxParser.TrackReferenceTypeBox = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.TrackReferenceTypeBox.prototype = new BoxParser.Box();\nBoxParser.TrackReferenceTypeBox.prototype.parse = function(stream) {\n\tthis.track_ids = stream.readUint32Array((this.size-this.hdr_size)/4);\n}\n\n// file:src/parsing/tref.js\nBoxParser.trefBox.prototype.parse = function(stream) {\n\tvar ret;\n\tvar box;\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = new BoxParser.TrackReferenceTypeBox(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\t\t\tLog.info(\"BoxParser\", \"TrackReference \"+box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.boxes.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n// file:src/parsing/trep.js\nBoxParser.createFullBoxCtor(\"trep\", \"TrackExtensionPropertiesBox\", function(stream) {\n\tthis.track_ID = stream.readUint32();\n\tthis.boxes = [];\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.boxes.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/trex.js\nBoxParser.createFullBoxCtor(\"trex\", \"TrackExtendsBox\", function(stream) {\n\tthis.track_id = stream.readUint32();\n\tthis.default_sample_description_index = stream.readUint32();\n\tthis.default_sample_duration = stream.readUint32();\n\tthis.default_sample_size = stream.readUint32();\n\tthis.default_sample_flags = stream.readUint32();\n});\n\n// file:src/parsing/trpy.js\nBoxParser.createBoxCtor(\"trpy\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/trun.js\nBoxParser.createFullBoxCtor(\"trun\", \"TrackRunBox\", function(stream) {\n\tvar readBytes = 0;\n\tthis.sample_count = stream.readUint32();\n\treadBytes+= 4;\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) ) {\n\t\tthis.data_offset = stream.readInt32(); //signed\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.data_offset = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) ) {\n\t\tthis.first_sample_flags = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.first_sample_flags = 0;\n\t}\n\tthis.sample_duration = [];\n\tthis.sample_size = [];\n\tthis.sample_flags = [];\n\tthis.sample_composition_time_offset = [];\n\tif (this.size - this.hdr_size > readBytes) {\n\t\tfor (var i = 0; i < this.sample_count; i++) {\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\t\tthis.sample_duration[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\t\tthis.sample_size[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\t\tthis.sample_flags[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\t\tif (this.version === 0) {\n\t\t\t\t\tthis.sample_composition_time_offset[i] = stream.readUint32();\n\t\t\t\t} else {\n\t\t\t\t\tthis.sample_composition_time_offset[i] = stream.readInt32(); //signed\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/tsel.js\nBoxParser.createFullBoxCtor(\"tsel\", \"TrackSelectionBox\", function(stream) {\n\tthis.switch_group = stream.readUint32();\n\tvar count = (this.size - this.hdr_size - 4)/4;\n\tthis.attribute_list = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.attribute_list[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/txtC.js\nBoxParser.createFullBoxCtor(\"txtC\", \"TextConfigBox\", function(stream) {\n\tthis.config = stream.readCString();\n});\n\n// file:src/parsing/tyco.js\nBoxParser.createBoxCtor(\"tyco\", \"TypeCombinationBox\", function(stream) {\n\tvar count = (this.size - this.hdr_size) / 4;\n\tthis.compatible_brands = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.compatible_brands[i] = stream.readString(4);\n\t}\n});\n\n// file:src/parsing/udes.js\nBoxParser.createFullBoxCtor(\"udes\", \"UserDescriptionProperty\", function(stream) {\n\tthis.lang = stream.readCString();\n\tthis.name = stream.readCString();\n\tthis.description = stream.readCString();\n\tthis.tags = stream.readCString();\n});\n\n// file:src/parsing/uncC.js\nBoxParser.createFullBoxCtor(\"uncC\", \"UncompressedFrameConfigBox\", function(stream) {\n    var i;\n    this.profile = stream.readString(4);\n    if (this.version == 1) {\n        // Nothing - just the profile\n    } else if (this.version == 0) {\n        this.component_count = stream.readUint32();\n        this.component_index = [];\n        this.component_bit_depth_minus_one = [];\n        this.component_format = [];\n        this.component_align_size = [];\n        for (i = 0; i < this.component_count; i++) {\n            this.component_index.push(stream.readUint16());\n            this.component_bit_depth_minus_one.push(stream.readUint8());\n            this.component_format.push(stream.readUint8());\n            this.component_align_size.push(stream.readUint8());\n        }\n        this.sampling_type = stream.readUint8();\n        this.interleave_type = stream.readUint8();\n        this.block_size = stream.readUint8();\n        var flags = stream.readUint8();\n        this.component_little_endian = (flags >> 7) & 0x1;\n        this.block_pad_lsb = (flags >> 6) & 0x1;\n        this.block_little_endian = (flags >> 5) & 0x1;\n        this.block_reversed = (flags >> 4) & 0x1;\n        this.pad_unknown = (flags >> 3) & 0x1;\n        this.pixel_size = stream.readUint32();\n        this.row_align_size = stream.readUint32();\n        this.tile_align_size = stream.readUint32();\n        this.num_tile_cols_minus_one = stream.readUint32();\n        this.num_tile_rows_minus_one = stream.readUint32();\n    }\n});\n\n// file:src/parsing/url.js\nBoxParser.createFullBoxCtor(\"url \", \"DataEntryUrlBox\", function(stream) {\n\tif (this.flags !== 0x000001) {\n\t\tthis.location = stream.readCString();\n\t}\n});\n\n// file:src/parsing/urn.js\nBoxParser.createFullBoxCtor(\"urn \", \"DataEntryUrnBox\", function(stream) {\n\tthis.name = stream.readCString();\n\tif (this.size - this.hdr_size - this.name.length - 1 > 0) {\n\t\tthis.location = stream.readCString();\n\t}\n});\n\n// file:src/parsing/uuid/piff/piffLsm.js\nBoxParser.createUUIDBox(\"a5d40b30e81411ddba2f0800200c9a66\", \"LiveServerManifestBox\", true, false, function(stream) {\n    this.LiveServerManifest = stream.readString(this.size - this.hdr_size)\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\"/g, \"&quot;\")\n        .replace(/'/g, \"&#039;\");\n});// file:src/parsing/uuid/piff/piffPssh.js\nBoxParser.createUUIDBox(\"d08a4f1810f34a82b6c832d8aba183d3\", \"PiffProtectionSystemSpecificHeaderBox\", true, false, function(stream) {\n\tthis.system_id = BoxParser.parseHex16(stream);\n\tvar datasize = stream.readUint32();\n\tif (datasize > 0) {\n\t\tthis.data = stream.readUint8Array(datasize);\n\t}\n});\n\n// file:src/parsing/uuid/piff/piffSenc.js\nBoxParser.createUUIDBox(\"a2394f525a9b4f14a2446c427c648df4\", \"PiffSampleEncryptionBox\", true, false /*, function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.AlgorithmID = stream.readUint24();\n\t\tthis.IV_size = stream.readUint8();\n\t\tthis.KID = BoxParser.parseHex16(stream);\n\t}\n\tvar sample_count = stream.readUint32();\n\tthis.samples = [];\n\tfor (var i = 0; i < sample_count; i++) {\n\t\tvar sample = {};\n\t\tsample.InitializationVector = this.readUint8Array(this.IV_size*8);\n\t\tif (this.flags & 0x2) {\n\t\t\tsample.subsamples = [];\n\t\t\tsample.NumberOfEntries = stream.readUint16();\n\t\t\tfor (var j = 0; j < sample.NumberOfEntries; j++) {\n\t\t\t\tvar subsample = {};\n\t\t\t\tsubsample.BytesOfClearData = stream.readUint16();\n\t\t\t\tsubsample.BytesOfProtectedData = stream.readUint32();\n\t\t\t\tsample.subsamples.push(subsample);\n\t\t\t}\n\t\t}\n\t\tthis.samples.push(sample);\n\t}\n}*/);\n// file:src/parsing/uuid/piff/piffTenc.js\nBoxParser.createUUIDBox(\"8974dbce7be74c5184f97148f9882554\", \"PiffTrackEncryptionBox\", true, false, function(stream) {\n\tthis.default_AlgorithmID = stream.readUint24();\n\tthis.default_IV_size = stream.readUint8();\n\tthis.default_KID = BoxParser.parseHex16(stream);\n});// file:src/parsing/uuid/piff/piffTfrf.js\nBoxParser.createUUIDBox(\"d4807ef2ca3946958e5426cb9e46a79f\", \"TfrfBox\", true, false, function(stream) {\n    this.fragment_count = stream.readUint8();\n    this.entries = [];\n\n    for (var i = 0; i < this.fragment_count; i++) {\n        var entry = {};\n        var absolute_time = 0;\n        var absolute_duration = 0;\n\n        if (this.version === 1) {\n            absolute_time = stream.readUint64();\n            absolute_duration = stream.readUint64();\n        } else {\n            absolute_time = stream.readUint32();\n            absolute_duration = stream.readUint32();\n        }\n\n        entry.absolute_time = absolute_time;\n        entry.absolute_duration = absolute_duration;\n\n        this.entries.push(entry);\n    }\n});// file:src/parsing/uuid/piff/piffTfxd.js\nBoxParser.createUUIDBox(\"6d1d9b0542d544e680e2141daff757b2\", \"TfxdBox\", true, false, function(stream) {\n    if (this.version === 1) {\n       this.absolute_time = stream.readUint64();\n       this.duration = stream.readUint64();\n    } else {\n       this.absolute_time = stream.readUint32();\n       this.duration = stream.readUint32();\n    }\n});// file:src/parsing/vmhd.js\nBoxParser.createFullBoxCtor(\"vmhd\", \"VideoMediaHeaderBox\", function(stream) {\n\tthis.graphicsmode = stream.readUint16();\n\tthis.opcolor = stream.readUint16Array(3);\n});\n\n// file:src/parsing/vpcC.js\nBoxParser.createFullBoxCtor(\"vpcC\", \"VPCodecConfigurationRecord\", function (stream) {\n\tvar tmp;\n\tif (this.version === 1) {\n\t\tthis.profile = stream.readUint8();\n\t\tthis.level = stream.readUint8();\n\t\ttmp = stream.readUint8();\n\t\tthis.bitDepth = tmp >> 4;\n\t\tthis.chromaSubsampling = (tmp >> 1) & 0x7;\n\t\tthis.videoFullRangeFlag = tmp & 0x1;\n\t\tthis.colourPrimaries = stream.readUint8();\n\t\tthis.transferCharacteristics = stream.readUint8();\n\t\tthis.matrixCoefficients = stream.readUint8();\n\t\tthis.codecIntializationDataSize = stream.readUint16();\n\t\tthis.codecIntializationData = stream.readUint8Array(this.codecIntializationDataSize);\n\t} else {\n\t\tthis.profile = stream.readUint8();\n\t\tthis.level = stream.readUint8();\n\t\ttmp = stream.readUint8();\n\t\tthis.bitDepth = (tmp >> 4) & 0xF;\n\t\tthis.colorSpace = tmp & 0xF;\n\t\ttmp = stream.readUint8();\n\t\tthis.chromaSubsampling = (tmp >> 4) & 0xF;\n\t\tthis.transferFunction = (tmp >> 1) & 0x7;\n\t\tthis.videoFullRangeFlag = tmp & 0x1;\n\t\tthis.codecIntializationDataSize = stream.readUint16();\n\t\tthis.codecIntializationData = stream.readUint8Array(this.codecIntializationDataSize);\n\t}\n});// file:src/parsing/vttC.js\nBoxParser.createBoxCtor(\"vttC\", \"WebVTTConfigurationBox\", function(stream) {\n\tthis.text = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/vvcC.js\nBoxParser.createFullBoxCtor(\"vvcC\", \"VvcConfigurationBox\", function (stream) {\n  var i, j;\n\n  // helper object to simplify extracting individual bits\n  var bitReader = {\n    held_bits: undefined,\n    num_held_bits: 0,\n\n    stream_read_1_bytes: function (strm) {\n      this.held_bits = strm.readUint8();\n      this.num_held_bits = 1 * 8;\n    },\n    stream_read_2_bytes: function (strm) {\n      this.held_bits = strm.readUint16();\n      this.num_held_bits = 2 * 8;\n    },\n\n    extract_bits: function (num_bits) {\n      var ret = (this.held_bits >> (this.num_held_bits - num_bits)) & ((1 << num_bits) - 1);\n      this.num_held_bits -= num_bits;\n      return ret;\n    }\n  };\n\n  // VvcDecoderConfigurationRecord\n  bitReader.stream_read_1_bytes(stream);\n  bitReader.extract_bits(5);  // reserved\n  this.lengthSizeMinusOne = bitReader.extract_bits(2);\n  this.ptl_present_flag = bitReader.extract_bits(1);\n\n  if (this.ptl_present_flag) {\n    bitReader.stream_read_2_bytes(stream);\n    this.ols_idx = bitReader.extract_bits(9);\n    this.num_sublayers = bitReader.extract_bits(3);\n    this.constant_frame_rate = bitReader.extract_bits(2);\n    this.chroma_format_idc = bitReader.extract_bits(2);\n\n    bitReader.stream_read_1_bytes(stream);\n    this.bit_depth_minus8 = bitReader.extract_bits(3);\n    bitReader.extract_bits(5);  // reserved\n\n    // VvcPTLRecord\n    {\n      bitReader.stream_read_2_bytes(stream);\n      bitReader.extract_bits(2);  // reserved\n      this.num_bytes_constraint_info = bitReader.extract_bits(6);\n      this.general_profile_idc = bitReader.extract_bits(7);\n      this.general_tier_flag = bitReader.extract_bits(1);\n\n      this.general_level_idc = stream.readUint8();\n\n      bitReader.stream_read_1_bytes(stream);\n      this.ptl_frame_only_constraint_flag = bitReader.extract_bits(1);\n      this.ptl_multilayer_enabled_flag = bitReader.extract_bits(1);\n\n      this.general_constraint_info = new Uint8Array(this.num_bytes_constraint_info);\n      if (this.num_bytes_constraint_info) {\n        for (i = 0; i < this.num_bytes_constraint_info - 1; i++) {\n          var cnstr1 = bitReader.extract_bits(6);\n          bitReader.stream_read_1_bytes(stream);\n          var cnstr2 = bitReader.extract_bits(2);\n\n          this.general_constraint_info[i] = ((cnstr1 << 2) | cnstr2);\n        }\n        this.general_constraint_info[this.num_bytes_constraint_info - 1] = bitReader.extract_bits(6);\n      } else {\n        //forbidden in spec!\n        bitReader.extract_bits(6);\n      }\n\n      if (this.num_sublayers > 1) {\n        bitReader.stream_read_1_bytes(stream);\n        this.ptl_sublayer_present_mask = 0;\n        for (j = this.num_sublayers - 2; j >= 0; --j) {\n          var val = bitReader.extract_bits(1);\n          this.ptl_sublayer_present_mask |= val << j;\n        }\n        for (j = this.num_sublayers; j <= 8 && this.num_sublayers > 1; ++j) {\n          bitReader.extract_bits(1);  // ptl_reserved_zero_bit\n        }\n\n        this.sublayer_level_idc = [];\n        for (j = this.num_sublayers - 2; j >= 0; --j) {\n          if (this.ptl_sublayer_present_mask & (1 << j)) {\n            this.sublayer_level_idc[j] = stream.readUint8();\n          }\n        }\n      }\n\n      this.ptl_num_sub_profiles = stream.readUint8();\n      this.general_sub_profile_idc = [];\n      if (this.ptl_num_sub_profiles) {\n        for (i = 0; i < this.ptl_num_sub_profiles; i++) {\n          this.general_sub_profile_idc.push(stream.readUint32());\n        }\n      }\n    }  // end VvcPTLRecord\n\n    this.max_picture_width = stream.readUint16();\n    this.max_picture_height = stream.readUint16();\n    this.avg_frame_rate = stream.readUint16();\n  }\n\n  var VVC_NALU_OPI = 12;\n  var VVC_NALU_DEC_PARAM = 13;\n\n  this.nalu_arrays = [];\n  var num_of_arrays = stream.readUint8();\n  for (i = 0; i < num_of_arrays; i++) {\n    var nalu_array = [];\n    this.nalu_arrays.push(nalu_array);\n\n    bitReader.stream_read_1_bytes(stream);\n    nalu_array.completeness = bitReader.extract_bits(1);\n    bitReader.extract_bits(2);  // reserved\n    nalu_array.nalu_type = bitReader.extract_bits(5);\n\n    var numNalus = 1;\n    if (nalu_array.nalu_type != VVC_NALU_DEC_PARAM && nalu_array.nalu_type != VVC_NALU_OPI) {\n      numNalus = stream.readUint16();\n    }\n\n    for (j = 0; j < numNalus; j++) {\n      var len = stream.readUint16();\n      nalu_array.push({\n        data: stream.readUint8Array(len),\n        length: len\n      });\n    }\n  }\n});\n// file:src/parsing/vvnC.js\nBoxParser.createFullBoxCtor(\"vvnC\", \"VvcNALUConfigBox\", function (stream) {\n  // VvcNALUConfigBox\n  var tmp = strm.readUint8();\n  this.lengthSizeMinusOne = (tmp & 0x3);\n});\n// file:src/box-codecs.js\nBoxParser.SampleEntry.prototype.isVideo = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isAudio = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isSubtitle = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isMetadata = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isHint = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.getCodec = function() {\n\treturn this.type.replace('.','');\n}\n\nBoxParser.SampleEntry.prototype.getWidth = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getHeight = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getChannelCount = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getSampleRate = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getSampleSize = function() {\n\treturn \"\";\n}\n\nBoxParser.VisualSampleEntry.prototype.isVideo = function() {\n\treturn true;\n}\n\nBoxParser.VisualSampleEntry.prototype.getWidth = function() {\n\treturn this.width;\n}\n\nBoxParser.VisualSampleEntry.prototype.getHeight = function() {\n\treturn this.height;\n}\n\nBoxParser.AudioSampleEntry.prototype.isAudio = function() {\n\treturn true;\n}\n\nBoxParser.AudioSampleEntry.prototype.getChannelCount = function() {\n\treturn this.channel_count;\n}\n\nBoxParser.AudioSampleEntry.prototype.getSampleRate = function() {\n\treturn this.samplerate;\n}\n\nBoxParser.AudioSampleEntry.prototype.getSampleSize = function() {\n\treturn this.samplesize;\n}\n\nBoxParser.SubtitleSampleEntry.prototype.isSubtitle = function() {\n\treturn true;\n}\n\nBoxParser.MetadataSampleEntry.prototype.isMetadata = function() {\n\treturn true;\n}\n\n\nBoxParser.decimalToHex = function(d, padding) {\n\tvar hex = Number(d).toString(16);\n\tpadding = typeof (padding) === \"undefined\" || padding === null ? padding = 2 : padding;\n\twhile (hex.length < padding) {\n\t\thex = \"0\" + hex;\n\t}\n\treturn hex;\n}\n\nBoxParser.avc1SampleEntry.prototype.getCodec =\nBoxParser.avc2SampleEntry.prototype.getCodec =\nBoxParser.avc3SampleEntry.prototype.getCodec =\nBoxParser.avc4SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.avcC) {\n\t\treturn baseCodec+\".\"+BoxParser.decimalToHex(this.avcC.AVCProfileIndication)+\n\t\t\t\t\t\t  \"\"+BoxParser.decimalToHex(this.avcC.profile_compatibility)+\n\t\t\t\t\t\t  \"\"+BoxParser.decimalToHex(this.avcC.AVCLevelIndication);\n\t} else {\n\t\treturn baseCodec;\n\t}\n}\n\nBoxParser.hev1SampleEntry.prototype.getCodec =\nBoxParser.hvc1SampleEntry.prototype.getCodec = function() {\n\tvar i;\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.hvcC) {\n\t\tbaseCodec += '.';\n\t\tswitch (this.hvcC.general_profile_space) {\n\t\t\tcase 0:\n\t\t\t\tbaseCodec += '';\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tbaseCodec += 'A';\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbaseCodec += 'B';\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tbaseCodec += 'C';\n\t\t\t\tbreak;\n\t\t}\n\t\tbaseCodec += this.hvcC.general_profile_idc;\n\t\tbaseCodec += '.';\n\t\tvar val = this.hvcC.general_profile_compatibility;\n\t\tvar reversed = 0;\n\t\tfor (i=0; i<32; i++) {\n\t\t\treversed |= val & 1;\n\t\t\tif (i==31) break;\n\t\t\treversed <<= 1;\n\t\t\tval >>=1;\n\t\t}\n\t\tbaseCodec += BoxParser.decimalToHex(reversed, 0);\n\t\tbaseCodec += '.';\n\t\tif (this.hvcC.general_tier_flag === 0) {\n\t\t\tbaseCodec += 'L';\n\t\t} else {\n\t\t\tbaseCodec += 'H';\n\t\t}\n\t\tbaseCodec += this.hvcC.general_level_idc;\n\t\tvar hasByte = false;\n\t\tvar constraint_string = \"\";\n\t\tfor (i = 5; i >= 0; i--) {\n\t\t\tif (this.hvcC.general_constraint_indicator[i] || hasByte) {\n\t\t\t\tconstraint_string = \".\"+BoxParser.decimalToHex(this.hvcC.general_constraint_indicator[i], 0)+constraint_string;\n\t\t\t\thasByte = true;\n\t\t\t}\n\t\t}\n\t\tbaseCodec += constraint_string;\n\t}\n\treturn baseCodec;\n}\n\nBoxParser.vvc1SampleEntry.prototype.getCodec =\nBoxParser.vvi1SampleEntry.prototype.getCodec = function () {\n\tvar i;\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.vvcC) {\n\t\tbaseCodec += '.' + this.vvcC.general_profile_idc;\n\t\tif (this.vvcC.general_tier_flag) {\n\t\t\tbaseCodec += '.H';\n\t\t} else {\n\t\t\tbaseCodec += '.L';\n\t\t}\n\t\tbaseCodec += this.vvcC.general_level_idc;\n\n\t\tvar constraint_string = \"\";\n\t\tif (this.vvcC.general_constraint_info) {\n\t\t\tvar bytes = [];\n\t\t\tvar byte = 0;\n\t\t\tbyte |= this.vvcC.ptl_frame_only_constraint << 7;\n\t\t\tbyte |= this.vvcC.ptl_multilayer_enabled << 6;\n\t\t\tvar last_nonzero;\n\t\t\tfor (i = 0; i < this.vvcC.general_constraint_info.length; ++i) {\n\t\t\t\tbyte |= (this.vvcC.general_constraint_info[i] >> 2) & 0x3f;\n\t\t\t\tbytes.push(byte);\n\t\t\t\tif (byte) {\n\t\t\t\t\tlast_nonzero = i;\n\t\t\t\t}\n\n\t\t\t\tbyte = (this.vvcC.general_constraint_info[i] >> 2) & 0x03;\n\t\t\t}\n\n\t\t\tif (last_nonzero === undefined) {\n\t\t\t\tconstraint_string = \".CA\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconstraint_string = \".C\"\n\t\t\t\tvar base32_chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567\";\n\t\t\t\tvar held_bits = 0;\n\t\t\t\tvar num_held_bits = 0;\n\t\t\t\tfor (i = 0; i <= last_nonzero; ++i) {\n\t\t\t\t\theld_bits = (held_bits << 8) | bytes[i];\n\t\t\t\t\tnum_held_bits += 8;\n\n\t\t\t\t\twhile (num_held_bits >= 5) {\n\t\t\t\t\t\tvar val = (held_bits >> (num_held_bits - 5)) & 0x1f;\n\t\t\t\t\t\tconstraint_string += base32_chars[val];\n\n\t\t\t\t\t\tnum_held_bits -= 5;\n\t\t\t\t\t\theld_bits &= (1 << num_held_bits) - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (num_held_bits) {\n\t\t\t\t\theld_bits <<= (5 - num_held_bits);  // right-pad with zeros to 5 bits (is this correct?)\n\t\t\t\t\tconstraint_string += base32_chars[held_bits & 0x1f];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tbaseCodec += constraint_string;\n\t}\n\treturn baseCodec;\n}\n\nBoxParser.mp4aSampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.esds && this.esds.esd) {\n\t\tvar oti = this.esds.esd.getOTI();\n\t\tvar dsi = this.esds.esd.getAudioConfig();\n\t\treturn baseCodec+\".\"+BoxParser.decimalToHex(oti)+(dsi ? \".\"+dsi: \"\");\n\t} else {\n\t\treturn baseCodec;\n\t}\n}\n\nBoxParser.stxtSampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif(this.mime_format) {\n\t\treturn baseCodec + \".\" + this.mime_format;\n\t} else {\n\t\treturn baseCodec\n\t}\n}\n\nBoxParser.vp08SampleEntry.prototype.getCodec =\nBoxParser.vp09SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tvar level = this.vpcC.level;\n\tif (level == 0) {\n\t\tlevel = \"00\";\n\t}\n\tvar bitDepth = this.vpcC.bitDepth;\n\tif (bitDepth == 8) {\n\t\tbitDepth = \"08\";\n\t}\n\treturn baseCodec + \".0\" + this.vpcC.profile + \".\" + level + \".\" + bitDepth;\n}\n\nBoxParser.av01SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tvar level = this.av1C.seq_level_idx_0;\n\tif (level < 10) {\n\t\tlevel = \"0\" + level;\n\t}\n\tvar bitdepth;\n\tif (this.av1C.seq_profile === 2 && this.av1C.high_bitdepth === 1) {\n\t\tbitdepth = (this.av1C.twelve_bit === 1) ? \"12\" : \"10\";\n\t} else if ( this.av1C.seq_profile <= 2 ) {\n\t\tbitdepth = (this.av1C.high_bitdepth === 1) ? \"10\" : \"08\";\n\t}\n\t// TODO need to parse the SH to find color config\n\treturn baseCodec+\".\"+this.av1C.seq_profile+\".\"+level+(this.av1C.seq_tier_0?\"H\":\"M\")+\".\"+bitdepth;//+\".\"+this.av1C.monochrome+\".\"+this.av1C.chroma_subsampling_x+\"\"+this.av1C.chroma_subsampling_y+\"\"+this.av1C.chroma_sample_position;\n}\n// file:src/box-write.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.Box.prototype.writeHeader = function(stream, msg) {\n\tthis.size += 8;\n\tif (this.size > MAX_SIZE) {\n\t\tthis.size += 8;\n\t}\n\tif (this.type === \"uuid\") {\n\t\tthis.size += 16;\n\t}\n\tLog.debug(\"BoxWriter\", \"Writing box \"+this.type+\" of size: \"+this.size+\" at position \"+stream.getPosition()+(msg || \"\"));\n\tif (this.size > MAX_SIZE) {\n\t\tstream.writeUint32(1);\n\t} else {\n\t\tthis.sizePosition = stream.getPosition();\n\t\tstream.writeUint32(this.size);\n\t}\n\tstream.writeString(this.type, null, 4);\n\tif (this.type === \"uuid\") {\n\t\tstream.writeUint8Array(this.uuid);\n\t}\n\tif (this.size > MAX_SIZE) {\n\t\tstream.writeUint64(this.size);\n\t} \n}\n\nBoxParser.FullBox.prototype.writeHeader = function(stream) {\n\tthis.size += 4;\n\tBoxParser.Box.prototype.writeHeader.call(this, stream, \" v=\"+this.version+\" f=\"+this.flags);\n\tstream.writeUint8(this.version);\n\tstream.writeUint24(this.flags);\n}\n\nBoxParser.Box.prototype.write = function(stream) {\n\tif (this.type === \"mdat\") {\n\t\t/* TODO: fix this */\n\t\tif (this.data) {\n\t\t\tthis.size = this.data.length;\n\t\t\tthis.writeHeader(stream);\n\t\t\tstream.writeUint8Array(this.data);\n\t\t}\n\t} else {\n\t\tthis.size = (this.data ? this.data.length : 0);\n\t\tthis.writeHeader(stream);\n\t\tif (this.data) {\n\t\t\tstream.writeUint8Array(this.data);\n\t\t}\n\t}\n}\n\nBoxParser.ContainerBox.prototype.write = function(stream) {\n\tthis.size = 0;\n\tthis.writeHeader(stream);\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tthis.boxes[i].write(stream);\n\t\t\tthis.size += this.boxes[i].size;\n\t\t}\n\t}\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\nBoxParser.TrackReferenceTypeBox.prototype.write = function(stream) {\n\tthis.size = this.track_ids.length*4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32Array(this.track_ids);\n}\n\n// file:src/writing/avcC.js\nBoxParser.avcCBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.size = 7;\n\tfor (i = 0; i < this.SPS.length; i++) {\n\t\tthis.size += 2+this.SPS[i].length;\n\t}\n\tfor (i = 0; i < this.PPS.length; i++) {\n\t\tthis.size += 2+this.PPS[i].length;\n\t}\n\tif (this.ext) {\n\t\tthis.size += this.ext.length;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint8(this.configurationVersion);\n\tstream.writeUint8(this.AVCProfileIndication);\n\tstream.writeUint8(this.profile_compatibility);\n\tstream.writeUint8(this.AVCLevelIndication);\n\tstream.writeUint8(this.lengthSizeMinusOne + (63<<2));\n\tstream.writeUint8(this.SPS.length + (7<<5));\n\tfor (i = 0; i < this.SPS.length; i++) {\n\t\tstream.writeUint16(this.SPS[i].length);\n\t\tstream.writeUint8Array(this.SPS[i].nalu);\n\t}\n\tstream.writeUint8(this.PPS.length);\n\tfor (i = 0; i < this.PPS.length; i++) {\n\t\tstream.writeUint16(this.PPS[i].length);\n\t\tstream.writeUint8Array(this.PPS[i].nalu);\n\t}\n\tif (this.ext) {\n\t\tstream.writeUint8Array(this.ext);\n\t}\n}\n\n// file:src/writing/co64.js\nBoxParser.co64Box.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.chunk_offsets.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.chunk_offsets.length);\n\tfor(i=0; i<this.chunk_offsets.length; i++) {\n\t\tstream.writeUint64(this.chunk_offsets[i]);\n\t}\n}\n\n// file:src/writing/cslg.js\nBoxParser.cslgBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4*5;\n\tthis.writeHeader(stream);\n\tstream.writeInt32(this.compositionToDTSShift);\n\tstream.writeInt32(this.leastDecodeToDisplayDelta);\n\tstream.writeInt32(this.greatestDecodeToDisplayDelta);\n\tstream.writeInt32(this.compositionStartTime);\n\tstream.writeInt32(this.compositionEndTime);\n}\n\n// file:src/writing/ctts.js\nBoxParser.cttsBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.sample_counts.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_counts.length);\n\tfor(i=0; i<this.sample_counts.length; i++) {\n\t\tstream.writeUint32(this.sample_counts[i]);\n\t\tif (this.version === 1) {\n\t\t\tstream.writeInt32(this.sample_offsets[i]); /* signed */\n\t\t} else {\t\t\t\n\t\t\tstream.writeUint32(this.sample_offsets[i]); /* unsigned */\n\t\t}\n\t}\n}\n\n// file:src/writing/dref.js\nBoxParser.drefBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4; //\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tthis.entries[i].write(stream);\n\t\tthis.size += this.entries[i].size;\n\t}\t\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\n// file:src/writing/elng.js\nBoxParser.elngBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = this.extended_language.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.extended_language);\n}\n\n// file:src/writing/elst.js\nBoxParser.elstBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4+12*this.entries.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tvar entry = this.entries[i];\n\t\tstream.writeUint32(entry.segment_duration);\n\t\tstream.writeInt32(entry.media_time);\n\t\tstream.writeInt16(entry.media_rate_integer);\n\t\tstream.writeInt16(entry.media_rate_fraction);\n\t}\n}\n\n// file:src/writing/emsg.js\nBoxParser.emsgBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.scheme_id_uri);\n\tstream.writeCString(this.value);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.presentation_time_delta);\n\tstream.writeUint32(this.event_duration);\n\tstream.writeUint32(this.id);\n\tstream.writeUint8Array(this.message_data);\n}\n\n// file:src/writing/ftyp.js\nBoxParser.ftypBox.prototype.write = function(stream) {\n\tthis.size = 8+4*this.compatible_brands.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.major_brand, null, 4);\n\tstream.writeUint32(this.minor_version);\n\tfor (var i = 0; i < this.compatible_brands.length; i++) {\n\t\tstream.writeString(this.compatible_brands[i], null, 4);\n\t}\n}\n\n// file:src/writing/hdlr.js\nBoxParser.hdlrBox.prototype.write = function(stream) {\n\tthis.size = 5*4+this.name.length+1;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(0);\n\tstream.writeString(this.handler, null, 4);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeCString(this.name);\n}\n\n// file:src/writing/hvcC.js\nBoxParser.hvcCBox.prototype.write = function(stream) {\n    var i,j;\n    this.size = 23;\n\n    for (i = 0; i < this.nalu_arrays.length; i++) {\n      this.size += 3;\n      for (j = 0; j < this.nalu_arrays[i].length; j++) {\n        this.size += 2 + this.nalu_arrays[i][j].data.length;\n      }\n    }\n\n    this.writeHeader(stream);\n\n    stream.writeUint8(this.configurationVersion);\n    stream.writeUint8((this.general_profile_space << 6) +\n                      (this.general_tier_flag << 5) +\n                      this.general_profile_idc);\n    stream.writeUint32(this.general_profile_compatibility);\n    stream.writeUint8Array(this.general_constraint_indicator);\n    stream.writeUint8(this.general_level_idc);\n    stream.writeUint16(this.min_spatial_segmentation_idc + (15<<24));\n    stream.writeUint8(this.parallelismType + (63<<2));\n    stream.writeUint8(this.chroma_format_idc + (63<<2));\n    stream.writeUint8(this.bit_depth_luma_minus8 + (31<<3));\n    stream.writeUint8(this.bit_depth_chroma_minus8 + (31<<3));\n    stream.writeUint16(this.avgFrameRate);\n    stream.writeUint8((this.constantFrameRate<<6) +\n                   (this.numTemporalLayers<<3) +\n                   (this.temporalIdNested<<2) +\n                   this.lengthSizeMinusOne);\n    stream.writeUint8(this.nalu_arrays.length);\n    for (i = 0; i < this.nalu_arrays.length; i++) {\n      // bit(1) array_completeness + bit(1) reserved = 0 + bit(6) nal_unit_type\n      stream.writeUint8((this.nalu_arrays[i].completeness<<7) +\n                         this.nalu_arrays[i].nalu_type);\n      stream.writeUint16(this.nalu_arrays[i].length);\n      for (j = 0; j < this.nalu_arrays[i].length; j++) {\n        stream.writeUint16(this.nalu_arrays[i][j].data.length);\n        stream.writeUint8Array(this.nalu_arrays[i][j].data);\n      }\n    }\n}\n// file:src/writing/kind.js\nBoxParser.kindBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = (this.schemeURI.length+1)+(this.value.length+1);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.schemeURI);\n\tstream.writeCString(this.value);\n}\n\n// file:src/writing/mdhd.js\nBoxParser.mdhdBox.prototype.write = function(stream) {\n\tthis.size = 4*4+2*2;\n\tthis.flags = 0;\n\tthis.version = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint16(this.language);\n\tstream.writeUint16(0);\n}\n\n// file:src/writing/mehd.js\nBoxParser.mehdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.fragment_duration);\n}\n\n// file:src/writing/mfhd.js\nBoxParser.mfhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sequence_number);\n}\n\n// file:src/writing/mvhd.js\nBoxParser.mvhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 23*4+2*2;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint32(this.rate);\n\tstream.writeUint16(this.volume<<8);\n\tstream.writeUint16(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32Array(this.matrix);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(this.next_track_id);\n}\n\n// file:src/writing/sampleentry.js\nBoxParser.SampleEntry.prototype.writeHeader = function(stream) {\n\tthis.size = 8;\n\tBoxParser.Box.prototype.writeHeader.call(this, stream);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint16(this.data_reference_index);\n}\n\nBoxParser.SampleEntry.prototype.writeFooter = function(stream) {\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tthis.boxes[i].write(stream);\n\t\tthis.size += this.boxes[i].size;\n\t}\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\t\n}\n\nBoxParser.SampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tstream.writeUint8Array(this.data);\n\tthis.size += this.data.length;\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\t\n}\n\nBoxParser.VisualSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += 2*7+6*4+32;\n\tstream.writeUint16(0); \n\tstream.writeUint16(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.width);\n\tstream.writeUint16(this.height);\n\tstream.writeUint32(this.horizresolution);\n\tstream.writeUint32(this.vertresolution);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.frame_count);\n\tstream.writeUint8(Math.min(31, this.compressorname.length));\n\tstream.writeString(this.compressorname, null, 31);\n\tstream.writeUint16(this.depth);\n\tstream.writeInt16(-1);\n\tthis.writeFooter(stream);\n}\n\nBoxParser.AudioSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += 2*4+3*4;\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.channel_count);\n\tstream.writeUint16(this.samplesize);\n\tstream.writeUint16(0);\n\tstream.writeUint16(0);\n\tstream.writeUint32(this.samplerate<<16);\n\tthis.writeFooter(stream);\n}\n\nBoxParser.stppSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += this.namespace.length+1+\n\t\t\t\t this.schema_location.length+1+\n\t\t\t\t this.auxiliary_mime_types.length+1;\n\tstream.writeCString(this.namespace);\n\tstream.writeCString(this.schema_location);\n\tstream.writeCString(this.auxiliary_mime_types);\n\tthis.writeFooter(stream);\n}\n\n// file:src/writing/samplegroups/samplegroup.js\nBoxParser.SampleGroupEntry.prototype.write = function(stream) {\n\tstream.writeUint8Array(this.data);\n}\n\n// file:src/writing/sbgp.js\nBoxParser.sbgpBox.prototype.write = function(stream) {\n\tthis.version = 1;\t\n\tthis.flags = 0;\n\tthis.size = 12+8*this.entries.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.grouping_type, null, 4);\n\tstream.writeUint32(this.grouping_type_parameter);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tvar entry = this.entries[i];\n\t\tstream.writeInt32(entry.sample_count);\n\t\tstream.writeInt32(entry.group_description_index);\n\t}\n}\n\n// file:src/writing/sgpd.js\nBoxParser.sgpdBox.prototype.write = function(stream) {\n\tvar i;\n\tvar entry;\n\t// leave version as read\n\t// this.version;\n\tthis.flags = 0;\n\tthis.size = 12;\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tentry = this.entries[i];\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tthis.size += 4;\n\t\t\t}\n\t\t\tthis.size += entry.data.length;\n\t\t}\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeString(this.grouping_type, null, 4);\n\tif (this.version === 1) {\n\t\tstream.writeUint32(this.default_length);\n\t}\n\tif (this.version >= 2) {\n\t\tstream.writeUint32(this.default_sample_description_index);\n\t}\n\tstream.writeUint32(this.entries.length);\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tentry = this.entries[i];\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tstream.writeUint32(entry.description_length);\n\t\t\t}\n\t\t}\n\t\tentry.write(stream);\n\t}\n}\n\n\n// file:src/writing/sidx.js\nBoxParser.sidxBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4*4+2+2+12*this.references.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.reference_ID);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.earliest_presentation_time);\n\tstream.writeUint32(this.first_offset);\n\tstream.writeUint16(0);\n\tstream.writeUint16(this.references.length);\n\tfor (var i = 0; i < this.references.length; i++) {\n\t\tvar ref = this.references[i];\n\t\tstream.writeUint32(ref.reference_type << 31 | ref.referenced_size);\n\t\tstream.writeUint32(ref.subsegment_duration);\n\t\tstream.writeUint32(ref.starts_with_SAP << 31 | ref.SAP_type << 28 | ref.SAP_delta_time);\n\t}\n}\n\n// file:src/writing/smhd.js\nBoxParser.smhdBox.prototype.write = function(stream) {\n  var i;\n  this.version = 0;\n  this.flags = 1;\n  this.size = 4;\n  this.writeHeader(stream);\n  stream.writeUint16(this.balance);\n  stream.writeUint16(0);\n}\n// file:src/writing/stco.js\nBoxParser.stcoBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+4*this.chunk_offsets.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.chunk_offsets.length);\n\tstream.writeUint32Array(this.chunk_offsets);\n}\n\n// file:src/writing/stsc.js\nBoxParser.stscBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+12*this.first_chunk.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.first_chunk.length);\n\tfor(i=0; i<this.first_chunk.length; i++) {\n\t\tstream.writeUint32(this.first_chunk[i]);\n\t\tstream.writeUint32(this.samples_per_chunk[i]);\n\t\tstream.writeUint32(this.sample_description_index[i]);\n\t}\n}\n\n// file:src/writing/stsd.js\nBoxParser.stsdBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tthis.size += 4;\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tthis.entries[i].write(stream);\n\t\tthis.size += this.entries[i].size;\n\t}\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\n// file:src/writing/stsh.js\nBoxParser.stshBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.shadowed_sample_numbers.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.shadowed_sample_numbers.length);\n\tfor(i=0; i<this.shadowed_sample_numbers.length; i++) {\n\t\tstream.writeUint32(this.shadowed_sample_numbers[i]);\n\t\tstream.writeUint32(this.sync_sample_numbers[i]);\n\t}\n}\n\n// file:src/writing/stss.js\nBoxParser.stssBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+4*this.sample_numbers.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_numbers.length);\n\tstream.writeUint32Array(this.sample_numbers);\n}\n\n// file:src/writing/stsz.js\nBoxParser.stszBox.prototype.write = function(stream) {\n\tvar i;\n\tvar constant = true;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tif (this.sample_sizes.length > 0) {\n\t\ti = 0;\n\t\twhile (i+1 < this.sample_sizes.length) {\n\t\t\tif (this.sample_sizes[i+1] !==  this.sample_sizes[0]) {\n\t\t\t\tconstant = false;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconstant = false;\n\t}\n\tthis.size = 8;\n\tif (!constant) {\n\t\tthis.size += 4*this.sample_sizes.length;\n\t}\n\tthis.writeHeader(stream);\n\tif (!constant) {\n\t\tstream.writeUint32(0);\n\t} else {\n\t\tstream.writeUint32(this.sample_sizes[0]);\n\t}\n\tstream.writeUint32(this.sample_sizes.length);\n\tif (!constant) {\n\t\tstream.writeUint32Array(this.sample_sizes);\n\t}\t\n}\n\n// file:src/writing/stts.js\nBoxParser.sttsBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.sample_counts.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_counts.length);\n\tfor(i=0; i<this.sample_counts.length; i++) {\n\t\tstream.writeUint32(this.sample_counts[i]);\n\t\tstream.writeUint32(this.sample_deltas[i]);\n\t}\n}\n\n// file:src/writing/tfdt.js\nBoxParser.tfdtBox.prototype.write = function(stream) {\n\tvar UINT32_MAX = Math.pow(2, 32) - 1;\n\t// use version 1 if baseMediaDecodeTime does not fit 32 bits\n\tthis.version = this.baseMediaDecodeTime > UINT32_MAX ? 1 : 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tif (this.version === 1) {\n\t\tthis.size += 4;\n\t}\n\tthis.writeHeader(stream);\n\tif (this.version === 1) {\n\t\tstream.writeUint64(this.baseMediaDecodeTime);\n\t} else {\n\t\tstream.writeUint32(this.baseMediaDecodeTime);\n\t}\n}\n\n// file:src/writing/tfhd.js\nBoxParser.tfhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.size = 4;\n\tif (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) {\n\t\tthis.size += 8;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\tthis.size += 4;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.track_id);\n\tif (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) {\n\t\tstream.writeUint64(this.base_data_offset);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\tstream.writeUint32(this.default_sample_description_index);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\tstream.writeUint32(this.default_sample_duration);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\tstream.writeUint32(this.default_sample_size);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\tstream.writeUint32(this.default_sample_flags);\n\t}\n}\n\n// file:src/writing/tkhd.js\nBoxParser.tkhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\t//this.flags = 0;\n\tthis.size = 4*18+2*4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.track_id);\n\tstream.writeUint32(0);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeInt16(this.layer);\n\tstream.writeInt16(this.alternate_group);\n\tstream.writeInt16(this.volume<<8);\n\tstream.writeUint16(0);\n\tstream.writeInt32Array(this.matrix);\n\tstream.writeUint32(this.width);\n\tstream.writeUint32(this.height);\n}\n\n// file:src/writing/trex.js\nBoxParser.trexBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4*5;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.track_id);\n\tstream.writeUint32(this.default_sample_description_index);\n\tstream.writeUint32(this.default_sample_duration);\n\tstream.writeUint32(this.default_sample_size);\n\tstream.writeUint32(this.default_sample_flags);\n}\n\n// file:src/writing/trun.js\nBoxParser.trunBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.size = 4;\n\tif (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\tthis.size += 4*this.sample_duration.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\tthis.size += 4*this.sample_size.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\tthis.size += 4*this.sample_flags.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\tthis.size += 4*this.sample_composition_time_offset.length;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_count);\n\tif (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) {\n\t\tthis.data_offset_position = stream.getPosition();\n\t\tstream.writeInt32(this.data_offset); //signed\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) {\n\t\tstream.writeUint32(this.first_sample_flags);\n\t}\n\tfor (var i = 0; i < this.sample_count; i++) {\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\tstream.writeUint32(this.sample_duration[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\tstream.writeUint32(this.sample_size[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\tstream.writeUint32(this.sample_flags[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\tif (this.version === 0) {\n\t\t\t\tstream.writeUint32(this.sample_composition_time_offset[i]);\n\t\t\t} else {\n\t\t\t\tstream.writeInt32(this.sample_composition_time_offset[i]); //signed\n\t\t\t}\n\t\t}\n\t}\t\t\n}\n\n// file:src/writing/url.js\nBoxParser[\"url Box\"].prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tif (this.location) {\n\t\tthis.flags = 0;\n\t\tthis.size = this.location.length+1;\n\t} else {\n\t\tthis.flags = 0x000001;\n\t\tthis.size = 0;\n\t}\n\tthis.writeHeader(stream);\n\tif (this.location) {\n\t\tstream.writeCString(this.location);\n\t}\n}\n\n// file:src/writing/urn.js\nBoxParser[\"urn Box\"].prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = this.name.length+1+(this.location ? this.location.length+1 : 0);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.name);\n\tif (this.location) {\n\t\tstream.writeCString(this.location);\n\t}\n}\n\n// file:src/writing/vmhd.js\nBoxParser.vmhdBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 1;\n\tthis.size = 8;\n\tthis.writeHeader(stream);\n\tstream.writeUint16(this.graphicsmode);\n\tstream.writeUint16Array(this.opcolor);\n}\n\n// file:src/box-unpack.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.cttsBox.prototype.unpack = function(samples) {\n\tvar i, j, k;\n\tk = 0;\n\tfor (i = 0; i < this.sample_counts.length; i++) {\n\t\tfor (j = 0; j < this.sample_counts[i]; j++) {\n\t\t\tsamples[k].pts = samples[k].dts + this.sample_offsets[i];\n\t\t\tk++;\n\t\t}\n\t}\n}\n\nBoxParser.sttsBox.prototype.unpack = function(samples) {\n\tvar i, j, k;\n\tk = 0;\n\tfor (i = 0; i < this.sample_counts.length; i++) {\n\t\tfor (j = 0; j < this.sample_counts[i]; j++) {\n\t\t\tif (k === 0) {\n\t\t\t\tsamples[k].dts = 0;\n\t\t\t} else {\n\t\t\t\tsamples[k].dts = samples[k-1].dts + this.sample_deltas[i];\n\t\t\t}\n\t\t\tk++;\n\t\t}\n\t}\n}\n\nBoxParser.stcoBox.prototype.unpack = function(samples) {\n\tvar i;\n\tfor (i = 0; i < this.chunk_offsets.length; i++) {\n\t\tsamples[i].offset = this.chunk_offsets[i];\n\t}\n}\n\nBoxParser.stscBox.prototype.unpack = function(samples) {\n\tvar i, j, k, l, m;\n\tl = 0;\n\tm = 0;\n\tfor (i = 0; i < this.first_chunk.length; i++) {\n\t\tfor (j = 0; j < (i+1 < this.first_chunk.length ? this.first_chunk[i+1] : Infinity); j++) {\n\t\t\tm++;\n\t\t\tfor (k = 0; k < this.samples_per_chunk[i]; k++) {\n\t\t\t\tif (samples[l]) {\n\t\t\t\t\tsamples[l].description_index = this.sample_description_index[i];\n\t\t\t\t\tsamples[l].chunk_index = m;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tl++;\n\t\t\t}\t\t\t\n\t\t}\n\t}\n}\n\nBoxParser.stszBox.prototype.unpack = function(samples) {\n\tvar i;\n\tfor (i = 0; i < this.sample_sizes.length; i++) {\n\t\tsamples[i].size = this.sample_sizes[i];\n\t}\n}\n// file:src/box-diff.js\n\nBoxParser.DIFF_BOXES_PROP_NAMES = [ \"boxes\", \"entries\", \"references\", \"subsamples\",\n\t\t\t\t\t \t \"items\", \"item_infos\", \"extents\", \"associations\",\n\t\t\t\t\t \t \"subsegments\", \"ranges\", \"seekLists\", \"seekPoints\",\n\t\t\t\t\t \t \"esd\", \"levels\"];\n\nBoxParser.DIFF_PRIMITIVE_ARRAY_PROP_NAMES = [ \"compatible_brands\", \"matrix\", \"opcolor\", \"sample_counts\", \"sample_deltas\",\n\"first_chunk\", \"samples_per_chunk\", \"sample_sizes\", \"chunk_offsets\", \"sample_offsets\", \"sample_description_index\", \"sample_duration\" ];\n\nBoxParser.boxEqualFields = function(box_a, box_b) {\n\tif (box_a && !box_b) return false;\n\tvar prop;\n\tfor (prop in box_a) {\n\t\tif (BoxParser.DIFF_BOXES_PROP_NAMES.indexOf(prop) > -1) {\n\t\t\tcontinue;\n\t\t// } else if (excluded_fields && excluded_fields.indexOf(prop) > -1) {\n\t\t// \tcontinue;\n\t\t} else if (box_a[prop] instanceof BoxParser.Box || box_b[prop] instanceof BoxParser.Box) {\n\t\t\tcontinue;\n\t\t} else if (typeof box_a[prop] === \"undefined\" || typeof box_b[prop] === \"undefined\") {\n\t\t\tcontinue;\n\t\t} else if (typeof box_a[prop] === \"function\" || typeof box_b[prop] === \"function\") {\n\t\t\tcontinue;\n\t\t} else if (\n\t\t\t(box_a.subBoxNames && box_a.subBoxNames.indexOf(prop.slice(0,4)) > -1) ||\n\t\t\t(box_b.subBoxNames && box_b.subBoxNames.indexOf(prop.slice(0,4)) > -1))  {\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tif (prop === \"data\" || prop === \"start\" || prop === \"size\" || prop === \"creation_time\" || prop === \"modification_time\") {\n\t\t\t\tcontinue;\n\t\t\t} else if (BoxParser.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(prop) > -1) {\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\tif (box_a[prop] !== box_b[prop]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nBoxParser.boxEqual = function(box_a, box_b) {\n\tif (!BoxParser.boxEqualFields(box_a, box_b)) {\n\t\treturn false;\n\t}\n\tfor (var j = 0; j < BoxParser.DIFF_BOXES_PROP_NAMES.length; j++) {\n\t\tvar name = BoxParser.DIFF_BOXES_PROP_NAMES[j];\n\t\tif (box_a[name] && box_b[name]) {\n\t\t\tif (!BoxParser.boxEqual(box_a[name], box_b[name])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n// file:src/text-mp4.js\n/* \n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar VTTin4Parser = function() {\t\n}\n\nVTTin4Parser.prototype.parseSample = function(data) {\n\tvar cues, cue;\n\tvar stream = new MP4BoxStream(data.buffer);\n\tcues = [];\n\twhile (!stream.isEos()) {\n\t\tcue = BoxParser.parseOneBox(stream, false);\n\t\tif (cue.code === BoxParser.OK && cue.box.type === \"vttc\") {\n\t\t\tcues.push(cue.box);\n\t\t}\t\t\n\t}\n\treturn cues;\n}\n\nVTTin4Parser.prototype.getText = function (startTime, endTime, data) {\n\tfunction pad(n, width, z) {\n\t  z = z || '0';\n\t  n = n + '';\n\t  return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n\t}\n\tfunction secToTimestamp(insec) {\n\t\tvar h = Math.floor(insec/3600);\n\t\tvar m = Math.floor((insec - h*3600)/60);\n\t\tvar s = Math.floor(insec - h*3600 - m*60);\n\t\tvar ms = Math.floor((insec - h*3600 - m*60 - s)*1000);\n\t\treturn \"\"+pad(h, 2)+\":\"+pad(m,2)+\":\"+pad(s, 2)+\".\"+pad(ms, 3);\n\t}\n\tvar cues = this.parseSample(data);\n\tvar string = \"\";\n\tfor (var i = 0; i < cues.length; i++) {\n\t\tvar cueIn4 = cues[i];\n\t\tstring += secToTimestamp(startTime)+\" --> \"+secToTimestamp(endTime)+\"\\r\\n\";\n\t\tstring += cueIn4.payl.text;\n\t}\n\treturn string;\n}\n\nvar XMLSubtitlein4Parser = function() {\t\n}\n\nXMLSubtitlein4Parser.prototype.parseSample = function(sample) {\n\tvar res = {};\t\n\tvar i;\n\tres.resources = [];\n\tvar stream = new MP4BoxStream(sample.data.buffer);\n\tif (!sample.subsamples || sample.subsamples.length === 0) {\n\t\tres.documentString = stream.readString(sample.data.length);\n\t} else {\n\t\tres.documentString = stream.readString(sample.subsamples[0].size);\n\t\tif (sample.subsamples.length > 1) {\n\t\t\tfor (i = 1; i < sample.subsamples.length; i++) {\n\t\t\t\tres.resources[i] = stream.readUint8Array(sample.subsamples[i].size);\n\t\t\t}\n\t\t}\n\t}\n\tif (typeof (DOMParser) !== \"undefined\") {\n\t\tres.document = (new DOMParser()).parseFromString(res.documentString, \"application/xml\");\n\t}\n\treturn res;\n}\n\nvar Textin4Parser = function() {\t\n}\n\nTextin4Parser.prototype.parseSample = function(sample) {\n\tvar textString;\n\tvar stream = new MP4BoxStream(sample.data.buffer);\n\ttextString = stream.readString(sample.data.length);\n\treturn textString;\n}\n\nTextin4Parser.prototype.parseConfig = function(data) {\n\tvar textString;\n\tvar stream = new MP4BoxStream(data.buffer);\n\tstream.readUint32(); // version & flags\n\ttextString = stream.readCString();\n\treturn textString;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.VTTin4Parser = VTTin4Parser;\n\texports.XMLSubtitlein4Parser = XMLSubtitlein4Parser;\n\texports.Textin4Parser = Textin4Parser;\n}\n// file:src/isofile.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar ISOFile = function (stream) {\n\t/* MutiBufferStream object used to parse boxes */\n\tthis.stream = stream || new MultiBufferStream();\n\t/* Array of all boxes (in order) found in the file */\n\tthis.boxes = [];\n\t/* Array of all mdats */\n\tthis.mdats = [];\n\t/* Array of all moofs */\n\tthis.moofs = [];\n\t/* Boolean indicating if the file is compatible with progressive parsing (moov first) */\n\tthis.isProgressive = false;\n\t/* Boolean used to fire moov start event only once */\n\tthis.moovStartFound = false;\n\t/* Callback called when the moov parsing starts */\n\tthis.onMoovStart = null;\n\t/* Boolean keeping track of the call to onMoovStart, to avoid double calls */\n\tthis.moovStartSent = false;\n\t/* Callback called when the moov is entirely parsed */\n\tthis.onReady = null;\n\t/* Boolean keeping track of the call to onReady, to avoid double calls */\n\tthis.readySent = false;\n\t/* Callback to call when segments are ready */\n\tthis.onSegment = null;\n\t/* Callback to call when samples are ready */\n\tthis.onSamples = null;\n\t/* Callback to call when there is an error in the parsing or processing of samples */\n\tthis.onError = null;\n\t/* Boolean indicating if the moov box run-length encoded tables of sample information have been processed */\n\tthis.sampleListBuilt = false;\n\t/* Array of Track objects for which fragmentation of samples is requested */\n\tthis.fragmentedTracks = [];\n\t/* Array of Track objects for which extraction of samples is requested */\n\tthis.extractedTracks = [];\n\t/* Boolean indicating that fragmention is ready */\n\tthis.isFragmentationInitialized = false;\n\t/* Boolean indicating that fragmented has started */\n\tthis.sampleProcessingStarted = false;\n\t/* Number of the next 'moof' to generate when fragmenting */\n\tthis.nextMoofNumber = 0;\n\t/* Boolean indicating if the initial list of items has been produced */\n\tthis.itemListBuilt = false;\n\t/* Array of items */\n\tthis.items = [];\n\t/* Array of entity groups */\n\tthis.entity_groups = [];\n\t/* Callback called when the sidx box is entirely parsed */\n\tthis.onSidx = null;\n\t/* Boolean keeping track of the call to onSidx, to avoid double calls */\n\tthis.sidxSent = false;\n}\n\nISOFile.prototype.setSegmentOptions = function(id, user, options) {\n\tvar trak = this.getTrackById(id);\n\tif (trak) {\n\t\tvar fragTrack = {};\n\t\tthis.fragmentedTracks.push(fragTrack);\n\t\tfragTrack.id = id;\n\t\tfragTrack.user = user;\n\t\tfragTrack.trak = trak;\n\t\ttrak.nextSample = 0;\n\t\tfragTrack.segmentStream = null;\n\t\tfragTrack.nb_samples = 1000;\n\t\tfragTrack.rapAlignement = true;\n\t\tif (options) {\n\t\t\tif (options.nbSamples) fragTrack.nb_samples = options.nbSamples;\n\t\t\tif (options.rapAlignement) fragTrack.rapAlignement = options.rapAlignement;\n\t\t}\n\t}\n}\n\nISOFile.prototype.unsetSegmentOptions = function(id) {\n\tvar index = -1;\n\tfor (var i = 0; i < this.fragmentedTracks.length; i++) {\n\t\tvar fragTrack = this.fragmentedTracks[i];\n\t\tif (fragTrack.id == id) {\n\t\t\tindex = i;\n\t\t}\n\t}\n\tif (index > -1) {\n\t\tthis.fragmentedTracks.splice(index, 1);\n\t}\n}\n\nISOFile.prototype.setExtractionOptions = function(id, user, options) {\n\tvar trak = this.getTrackById(id);\n\tif (trak) {\n\t\tvar extractTrack = {};\n\t\tthis.extractedTracks.push(extractTrack);\n\t\textractTrack.id = id;\n\t\textractTrack.user = user;\n\t\textractTrack.trak = trak;\n\t\ttrak.nextSample = 0;\n\t\textractTrack.nb_samples = 1000;\n\t\textractTrack.samples = [];\n\t\tif (options) {\n\t\t\tif (options.nbSamples) extractTrack.nb_samples = options.nbSamples;\n\t\t}\n\t}\n}\n\nISOFile.prototype.unsetExtractionOptions = function(id) {\n\tvar index = -1;\n\tfor (var i = 0; i < this.extractedTracks.length; i++) {\n\t\tvar extractTrack = this.extractedTracks[i];\n\t\tif (extractTrack.id == id) {\n\t\t\tindex = i;\n\t\t}\n\t}\n\tif (index > -1) {\n\t\tthis.extractedTracks.splice(index, 1);\n\t}\n}\n\nISOFile.prototype.parse = function() {\n\tvar found;\n\tvar ret;\n\tvar box;\n\tvar parseBoxHeadersOnly = false;\n\n\tif (this.restoreParsePosition)\t{\n\t\tif (!this.restoreParsePosition()) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\twhile (true) {\n\n\t\tif (this.hasIncompleteMdat && this.hasIncompleteMdat()) {\n\t\t\tif (this.processIncompleteMdat()) {\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.saveParsePosition)\t{\n\t\t\t\tthis.saveParsePosition();\n\t\t\t}\n\t\t\tret = BoxParser.parseOneBox(this.stream, parseBoxHeadersOnly);\n\t\t\tif (ret.code === BoxParser.ERR_NOT_ENOUGH_DATA) {\n\t\t\t\tif (this.processIncompleteBox) {\n\t\t\t\t\tif (this.processIncompleteBox(ret)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar box_type;\n\t\t\t\t/* the box is entirely parsed */\n\t\t\t\tbox = ret.box;\n\t\t\t\tbox_type = (box.type !== \"uuid\" ? box.type : box.uuid);\n\t\t\t\t/* store the box in the 'boxes' array to preserve box order (for file rewrite if needed)  */\n\t\t\t\tthis.boxes.push(box);\n\t\t\t\t/* but also store box in a property for more direct access */\n\t\t\t\tswitch (box_type) {\n\t\t\t\t\tcase \"mdat\":\n\t\t\t\t\t\tthis.mdats.push(box);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"moof\":\n\t\t\t\t\t\tthis.moofs.push(box);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"moov\":\n\t\t\t\t\t\tthis.moovStartFound = true;\n\t\t\t\t\t\tif (this.mdats.length === 0) {\n\t\t\t\t\t\t\tthis.isProgressive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/* no break */\n\t\t\t\t\t\t/* falls through */\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (this[box_type] !== undefined) {\n\t\t\t\t\t\t\tLog.warn(\"ISOFile\", \"Duplicate Box of type: \"+box_type+\", overriding previous occurrence\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis[box_type] = box;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (this.updateUsedBytes) {\n\t\t\t\t\tthis.updateUsedBytes(box, ret);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.prototype.checkBuffer = function (ab) {\n\tif (ab === null || ab === undefined) {\n\t\tthrow(\"Buffer must be defined and non empty\");\n\t}\n\tif (ab.fileStart === undefined) {\n\t\tthrow(\"Buffer must have a fileStart property\");\n\t}\n\tif (ab.byteLength === 0) {\n\t\tLog.warn(\"ISOFile\", \"Ignoring empty buffer (fileStart: \"+ab.fileStart+\")\");\n\t\tthis.stream.logBufferLevel();\n\t\treturn false;\n\t}\n\tLog.info(\"ISOFile\", \"Processing buffer (fileStart: \"+ab.fileStart+\")\");\n\n\t/* mark the bytes in the buffer as not being used yet */\n\tab.usedBytes = 0;\n\tthis.stream.insertBuffer(ab);\n\tthis.stream.logBufferLevel();\n\n\tif (!this.stream.initialized()) {\n\t\tLog.warn(\"ISOFile\", \"Not ready to start parsing\");\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n/* Processes a new ArrayBuffer (with a fileStart property)\n   Returns the next expected file position, or undefined if not ready to parse */\nISOFile.prototype.appendBuffer = function(ab, last) {\n\tvar nextFileStart;\n\tif (!this.checkBuffer(ab)) {\n\t\treturn;\n\t}\n\n\t/* Parse whatever is in the existing buffers */\n\tthis.parse();\n\n\t/* Check if the moovStart callback needs to be called */\n\tif (this.moovStartFound && !this.moovStartSent) {\n\t\tthis.moovStartSent = true;\n\t\tif (this.onMoovStart) this.onMoovStart();\n\t}\n\n\tif (this.moov) {\n\t\t/* A moov box has been entirely parsed */\n\n\t\t/* if this is the first call after the moov is found we initialize the list of samples (may be empty in fragmented files) */\n\t\tif (!this.sampleListBuilt) {\n\t\t\tthis.buildSampleLists();\n\t\t\tthis.sampleListBuilt = true;\n\t\t}\n\n\t\t/* We update the sample information if there are any new moof boxes */\n\t\tthis.updateSampleLists();\n\n\t\t/* If the application needs to be informed that the 'moov' has been found,\n\t\t   we create the information object and callback the application */\n\t\tif (this.onReady && !this.readySent) {\n\t\t\tthis.readySent = true;\n\t\t\tthis.onReady(this.getInfo());\n\t\t}\n\n\t\t/* See if any sample extraction or segment creation needs to be done with the available samples */\n\t\tthis.processSamples(last);\n\n\t\t/* Inform about the best range to fetch next */\n\t\tif (this.nextSeekPosition) {\n\t\t\tnextFileStart = this.nextSeekPosition;\n\t\t\tthis.nextSeekPosition = undefined;\n\t\t} else {\n\t\t\tnextFileStart = this.nextParsePosition;\n\t\t}\n\t\tif (this.stream.getEndFilePositionAfter) {\n\t\t\tnextFileStart = this.stream.getEndFilePositionAfter(nextFileStart);\n\t\t}\n\t} else {\n\t\tif (this.nextParsePosition) {\n\t\t\t/* moov has not been parsed but the first buffer was received,\n\t\t\t   the next fetch should probably be the next box start */\n\t\t\tnextFileStart = this.nextParsePosition;\n\t\t} else {\n\t\t\t/* No valid buffer has been parsed yet, we cannot know what to parse next */\n\t\t\tnextFileStart = 0;\n\t\t}\n\t}\n\tif (this.sidx) {\n\t\tif (this.onSidx && !this.sidxSent) {\n\t\t\tthis.onSidx(this.sidx);\n\t\t\tthis.sidxSent = true;\n\t\t}\n\t}\n\tif (this.meta) {\n\t\tif (this.flattenItemInfo && !this.itemListBuilt) {\n\t\t\tthis.flattenItemInfo();\n\t\t\tthis.itemListBuilt = true;\n\t\t}\n\t\tif (this.processItems) {\n\t\t\tthis.processItems(this.onItem);\n\t\t}\n\t}\n\n\tif (this.stream.cleanBuffers) {\n\t\tLog.info(\"ISOFile\", \"Done processing buffer (fileStart: \"+ab.fileStart+\") - next buffer to fetch should have a fileStart position of \"+nextFileStart);\n\t\tthis.stream.logBufferLevel();\n\t\tthis.stream.cleanBuffers();\n\t\tthis.stream.logBufferLevel(true);\n\t\tLog.info(\"ISOFile\", \"Sample data size in memory: \"+this.getAllocatedSampleDataSize());\n\t}\n\treturn nextFileStart;\n}\n\nISOFile.prototype.getInfo = function() {\n\tvar i, j;\n\tvar movie = {};\n\tvar trak;\n\tvar track;\n\tvar ref;\n\tvar sample_desc;\n\tvar _1904 = (new Date('1904-01-01T00:00:00Z').getTime());\n\n\tif (this.moov) {\n\t\tmovie.hasMoov = true;\n\t\tmovie.duration = this.moov.mvhd.duration;\n\t\tmovie.timescale = this.moov.mvhd.timescale;\n\t\tmovie.isFragmented = (this.moov.mvex != null);\n\t\tif (movie.isFragmented && this.moov.mvex.mehd) {\n\t\t\tmovie.fragment_duration = this.moov.mvex.mehd.fragment_duration;\n\t\t}\n\t\tmovie.isProgressive = this.isProgressive;\n\t\tmovie.hasIOD = (this.moov.iods != null);\n\t\tmovie.brands = [];\n\t\tmovie.brands.push(this.ftyp.major_brand);\n\t\tmovie.brands = movie.brands.concat(this.ftyp.compatible_brands);\n\t\tmovie.created = new Date(_1904+this.moov.mvhd.creation_time*1000);\n\t\tmovie.modified = new Date(_1904+this.moov.mvhd.modification_time*1000);\n\t\tmovie.tracks = [];\n\t\tmovie.audioTracks = [];\n\t\tmovie.videoTracks = [];\n\t\tmovie.subtitleTracks = [];\n\t\tmovie.metadataTracks = [];\n\t\tmovie.hintTracks = [];\n\t\tmovie.otherTracks = [];\n\t\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\t\ttrak = this.moov.traks[i];\n\t\t\tsample_desc = trak.mdia.minf.stbl.stsd.entries[0];\n\t\t\ttrack = {};\n\t\t\tmovie.tracks.push(track);\n\t\t\ttrack.id = trak.tkhd.track_id;\n\t\t\ttrack.name = trak.mdia.hdlr.name;\n\t\t\ttrack.references = [];\n\t\t\tif (trak.tref) {\n\t\t\t\tfor (j = 0; j < trak.tref.boxes.length; j++) {\n\t\t\t\t\tref = {};\n\t\t\t\t\ttrack.references.push(ref);\n\t\t\t\t\tref.type = trak.tref.boxes[j].type;\n\t\t\t\t\tref.track_ids = trak.tref.boxes[j].track_ids;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (trak.edts) {\n\t\t\t\ttrack.edits = trak.edts.elst.entries;\n\t\t\t}\n\t\t\ttrack.created = new Date(_1904+trak.tkhd.creation_time*1000);\n\t\t\ttrack.modified = new Date(_1904+trak.tkhd.modification_time*1000);\n\t\t\ttrack.movie_duration = trak.tkhd.duration;\n\t\t\ttrack.movie_timescale = movie.timescale;\n\t\t\ttrack.layer = trak.tkhd.layer;\n\t\t\ttrack.alternate_group = trak.tkhd.alternate_group;\n\t\t\ttrack.volume = trak.tkhd.volume;\n\t\t\ttrack.matrix = trak.tkhd.matrix;\n\t\t\ttrack.track_width = trak.tkhd.width/(1<<16);\n\t\t\ttrack.track_height = trak.tkhd.height/(1<<16);\n\t\t\ttrack.timescale = trak.mdia.mdhd.timescale;\n\t\t\ttrack.cts_shift = trak.mdia.minf.stbl.cslg;\n\t\t\ttrack.duration = trak.mdia.mdhd.duration;\n\t\t\ttrack.samples_duration = trak.samples_duration;\n\t\t\ttrack.codec = sample_desc.getCodec();\n\t\t\ttrack.kind = (trak.udta && trak.udta.kinds.length ? trak.udta.kinds[0] : { schemeURI: \"\", value: \"\"});\n\t\t\ttrack.language = (trak.mdia.elng ? trak.mdia.elng.extended_language : trak.mdia.mdhd.languageString);\n\t\t\ttrack.nb_samples = trak.samples.length;\n\t\t\ttrack.size = trak.samples_size;\n\t\t\ttrack.bitrate = (track.size*8*track.timescale)/track.samples_duration;\n\t\t\tif (sample_desc.isAudio()) {\n\t\t\t\ttrack.type = \"audio\";\n\t\t\t\tmovie.audioTracks.push(track);\n\t\t\t\ttrack.audio = {};\n\t\t\t\ttrack.audio.sample_rate = sample_desc.getSampleRate();\n\t\t\t\ttrack.audio.channel_count = sample_desc.getChannelCount();\n\t\t\t\ttrack.audio.sample_size = sample_desc.getSampleSize();\n\t\t\t} else if (sample_desc.isVideo()) {\n\t\t\t\ttrack.type = \"video\";\n\t\t\t\tmovie.videoTracks.push(track);\n\t\t\t\ttrack.video = {};\n\t\t\t\ttrack.video.width = sample_desc.getWidth();\n\t\t\t\ttrack.video.height = sample_desc.getHeight();\n\t\t\t} else if (sample_desc.isSubtitle()) {\n\t\t\t\ttrack.type = \"subtitles\";\n\t\t\t\tmovie.subtitleTracks.push(track);\n\t\t\t} else if (sample_desc.isHint()) {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.hintTracks.push(track);\n\t\t\t} else if (sample_desc.isMetadata()) {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.metadataTracks.push(track);\n\t\t\t} else {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.otherTracks.push(track);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tmovie.hasMoov = false;\n\t}\n\tmovie.mime = \"\";\n\tif (movie.hasMoov && movie.tracks) {\n\t\tif (movie.videoTracks && movie.videoTracks.length > 0) {\n\t\t\tmovie.mime += 'video/mp4; codecs=\\\"';\n\t\t} else if (movie.audioTracks && movie.audioTracks.length > 0) {\n\t\t\tmovie.mime += 'audio/mp4; codecs=\\\"';\n\t\t} else {\n\t\t\tmovie.mime += 'application/mp4; codecs=\\\"';\n\t\t}\n\t\tfor (i = 0; i < movie.tracks.length; i++) {\n\t\t\tif (i !== 0) movie.mime += ',';\n\t\t\tmovie.mime+= movie.tracks[i].codec;\n\t\t}\n\t\tmovie.mime += '\\\"; profiles=\\\"';\n\t\tmovie.mime += this.ftyp.compatible_brands.join();\n\t\tmovie.mime += '\\\"';\n\t}\n\treturn movie;\n}\n\nISOFile.prototype.setNextSeekPositionFromSample = function (sample) {\n\tif (!sample) {\n\t\treturn;\n\t}\n\tif (this.nextSeekPosition) {\n\t\tthis.nextSeekPosition = Math.min(sample.offset+sample.alreadyRead,this.nextSeekPosition);\n\t} else {\n\t\tthis.nextSeekPosition = sample.offset+sample.alreadyRead;\n\t}\n}\n\nISOFile.prototype.processSamples = function(last) {\n\tvar i;\n\tvar trak;\n\tif (!this.sampleProcessingStarted) return;\n\n\t/* For each track marked for fragmentation,\n\t   check if the next sample is there (i.e. if the sample information is known (i.e. moof has arrived) and if it has been downloaded)\n\t   and create a fragment with it */\n\tif (this.isFragmentationInitialized && this.onSegment !== null) {\n\t\tfor (i = 0; i < this.fragmentedTracks.length; i++) {\n\t\t\tvar fragTrak = this.fragmentedTracks[i];\n\t\t\ttrak = fragTrak.trak;\n\t\t\twhile (trak.nextSample < trak.samples.length && this.sampleProcessingStarted) {\n\t\t\t\t/* The sample information is there (either because the file is not fragmented and this is not the last sample,\n\t\t\t\tor because the file is fragmented and the moof for that sample has been received */\n\t\t\t\tLog.debug(\"ISOFile\", \"Creating media fragment on track #\"+fragTrak.id +\" for sample \"+trak.nextSample);\n\t\t\t\tvar result = this.createFragment(fragTrak.id, trak.nextSample, fragTrak.segmentStream);\n\t\t\t\tif (result) {\n\t\t\t\t\tfragTrak.segmentStream = result;\n\t\t\t\t\ttrak.nextSample++;\n\t\t\t\t} else {\n\t\t\t\t\t/* The fragment could not be created because the media data is not there (not downloaded), wait for it */\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t/* A fragment is created by sample, but the segment is the accumulation in the buffer of these fragments.\n\t\t\t\t   It is flushed only as requested by the application (nb_samples) to avoid too many callbacks */\n\t\t\t\tif (trak.nextSample % fragTrak.nb_samples === 0 || (last || trak.nextSample >= trak.samples.length)) {\n\t\t\t\t\tLog.info(\"ISOFile\", \"Sending fragmented data on track #\"+fragTrak.id+\" for samples [\"+Math.max(0,trak.nextSample-fragTrak.nb_samples)+\",\"+(trak.nextSample-1)+\"]\");\n\t\t\t\t\tLog.info(\"ISOFile\", \"Sample data size in memory: \"+this.getAllocatedSampleDataSize());\n\t\t\t\t\tif (this.onSegment) {\n\t\t\t\t\t\tthis.onSegment(fragTrak.id, fragTrak.user, fragTrak.segmentStream.buffer, trak.nextSample, (last || trak.nextSample >= trak.samples.length));\n\t\t\t\t\t}\n\t\t\t\t\t/* force the creation of a new buffer */\n\t\t\t\t\tfragTrak.segmentStream = null;\n\t\t\t\t\tif (fragTrak !== this.fragmentedTracks[i]) {\n\t\t\t\t\t\t/* make sure we can stop fragmentation if needed */\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (this.onSamples !== null) {\n\t\t/* For each track marked for data export,\n\t\t   check if the next sample is there (i.e. has been downloaded) and send it */\n\t\tfor (i = 0; i < this.extractedTracks.length; i++) {\n\t\t\tvar extractTrak = this.extractedTracks[i];\n\t\t\ttrak = extractTrak.trak;\n\t\t\twhile (trak.nextSample < trak.samples.length && this.sampleProcessingStarted) {\n\t\t\t\tLog.debug(\"ISOFile\", \"Exporting on track #\"+extractTrak.id +\" sample #\"+trak.nextSample);\n\t\t\t\tvar sample = this.getSample(trak, trak.nextSample);\n\t\t\t\tif (sample) {\n\t\t\t\t\ttrak.nextSample++;\n\t\t\t\t\textractTrak.samples.push(sample);\n\t\t\t\t} else {\n\t\t\t\t\tthis.setNextSeekPositionFromSample(trak.samples[trak.nextSample]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (trak.nextSample % extractTrak.nb_samples === 0 || trak.nextSample >= trak.samples.length) {\n\t\t\t\t\tLog.debug(\"ISOFile\", \"Sending samples on track #\"+extractTrak.id+\" for sample \"+trak.nextSample);\n\t\t\t\t\tif (this.onSamples) {\n\t\t\t\t\t\tthis.onSamples(extractTrak.id, extractTrak.user, extractTrak.samples);\n\t\t\t\t\t}\n\t\t\t\t\textractTrak.samples = [];\n\t\t\t\t\tif (extractTrak !== this.extractedTracks[i]) {\n\t\t\t\t\t\t/* check if the extraction needs to be stopped */\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/* Find and return specific boxes using recursion and early return */\nISOFile.prototype.getBox = function(type) {\n  var result = this.getBoxes(type, true);\n  return (result.length ? result[0] : null);\n}\n\nISOFile.prototype.getBoxes = function(type, returnEarly) {\n  var result = [];\n  ISOFile._sweep.call(this, type, result, returnEarly);\n  return result;\n}\n\nISOFile._sweep = function(type, result, returnEarly) {\n  if (this.type && this.type == type) result.push(this);\n  for (var box in this.boxes) {\n    if (result.length && returnEarly) return;\n    ISOFile._sweep.call(this.boxes[box], type, result, returnEarly);\n  }\n}\n\nISOFile.prototype.getTrackSamplesInfo = function(track_id) {\n\tvar track = this.getTrackById(track_id);\n\tif (track) {\n\t\treturn track.samples;\n\t} else {\n\t\treturn;\n\t}\n}\n\nISOFile.prototype.getTrackSample = function(track_id, number) {\n\tvar track = this.getTrackById(track_id);\n\tvar sample = this.getSample(track, number);\n\treturn sample;\n}\n\n/* Called by the application to release the resources associated to samples already forwarded to the application */\nISOFile.prototype.releaseUsedSamples = function (id, sampleNum) {\n\tvar size = 0;\n\tvar trak = this.getTrackById(id);\n\tif (!trak.lastValidSample) trak.lastValidSample = 0;\n\tfor (var i = trak.lastValidSample; i < sampleNum; i++) {\n\t\tsize+=this.releaseSample(trak, i);\n\t}\n\tLog.info(\"ISOFile\", \"Track #\"+id+\" released samples up to \"+sampleNum+\" (released size: \"+size+\", remaining: \"+this.samplesDataSize+\")\");\n\ttrak.lastValidSample = sampleNum;\n}\n\nISOFile.prototype.start = function() {\n\tthis.sampleProcessingStarted = true;\n\tthis.processSamples(false);\n}\n\nISOFile.prototype.stop = function() {\n\tthis.sampleProcessingStarted = false;\n}\n\n/* Called by the application to flush the remaining samples (e.g. once the download is finished or when no more samples will be added) */\nISOFile.prototype.flush = function() {\n\tLog.info(\"ISOFile\", \"Flushing remaining samples\");\n\tthis.updateSampleLists();\n\tthis.processSamples(true);\n\tthis.stream.cleanBuffers();\n\tthis.stream.logBufferLevel(true);\n}\n\n/* Finds the byte offset for a given time on a given track\n   also returns the time of the previous rap */\nISOFile.prototype.seekTrack = function(time, useRap, trak) {\n\tvar j;\n\tvar sample;\n\tvar seek_offset = Infinity;\n\tvar rap_seek_sample_num = 0;\n\tvar seek_sample_num = 0;\n\tvar timescale;\n\n\tif (trak.samples.length === 0) {\n\t\tLog.info(\"ISOFile\", \"No sample in track, cannot seek! Using time \"+Log.getDurationString(0, 1) +\" and offset: \"+0);\n\t\treturn { offset: 0, time: 0 };\n\t}\n\n\tfor (j = 0; j < trak.samples.length; j++) {\n\t\tsample = trak.samples[j];\n\t\tif (j === 0) {\n\t\t\tseek_sample_num = 0;\n\t\t\ttimescale = sample.timescale;\n\t\t} else if (sample.cts > time * sample.timescale) {\n\t\t\tseek_sample_num = j-1;\n\t\t\tbreak;\n\t\t}\n\t\tif (useRap && sample.is_sync) {\n\t\t\trap_seek_sample_num = j;\n\t\t}\n\t}\n\tif (useRap) {\n\t\tseek_sample_num = rap_seek_sample_num;\n\t}\n\ttime = trak.samples[seek_sample_num].cts;\n\ttrak.nextSample = seek_sample_num;\n\twhile (trak.samples[seek_sample_num].alreadyRead === trak.samples[seek_sample_num].size) {\n\t\t// No remaining samples to look for, all are downloaded.\n\t\tif (!trak.samples[seek_sample_num + 1]) {\n\t\t\tbreak;\n\t\t}\n\t\tseek_sample_num++;\n\t}\n\tseek_offset = trak.samples[seek_sample_num].offset+trak.samples[seek_sample_num].alreadyRead;\n\tLog.info(\"ISOFile\", \"Seeking to \"+(useRap ? \"RAP\": \"\")+\" sample #\"+trak.nextSample+\" on track \"+trak.tkhd.track_id+\", time \"+Log.getDurationString(time, timescale) +\" and offset: \"+seek_offset);\n\treturn { offset: seek_offset, time: time/timescale };\n}\n\nISOFile.prototype.getTrackDuration = function (trak) {\n\tvar sample;\n\n\tif (!trak.samples) {\n\t\treturn Infinity;\n\t}\n\tsample = trak.samples[trak.samples.length - 1];\n\treturn (sample.cts + sample.duration) / sample.timescale;\n}\n\n/* Finds the byte offset in the file corresponding to the given time or to the time of the previous RAP */\nISOFile.prototype.seek = function(time, useRap) {\n\tvar moov = this.moov;\n\tvar trak;\n\tvar trak_seek_info;\n\tvar i;\n\tvar seek_info = { offset: Infinity, time: Infinity };\n\tif (!this.moov) {\n\t\tthrow \"Cannot seek: moov not received!\";\n\t} else {\n\t\tfor (i = 0; i<moov.traks.length; i++) {\n\t\t\ttrak = moov.traks[i];\n\t\t\tif (time > this.getTrackDuration(trak)) { // skip tracks that already ended\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttrak_seek_info = this.seekTrack(time, useRap, trak);\n\t\t\tif (trak_seek_info.offset < seek_info.offset) {\n\t\t\t\tseek_info.offset = trak_seek_info.offset;\n\t\t\t}\n\t\t\tif (trak_seek_info.time < seek_info.time) {\n\t\t\t\tseek_info.time = trak_seek_info.time;\n\t\t\t}\n\t\t}\n\t\tLog.info(\"ISOFile\", \"Seeking at time \"+Log.getDurationString(seek_info.time, 1)+\" needs a buffer with a fileStart position of \"+seek_info.offset);\n\t\tif (seek_info.offset === Infinity) {\n\t\t\t/* No sample info, in all tracks, cannot seek */\n\t\t\tseek_info = { offset: this.nextParsePosition, time: 0 };\n\t\t} else {\n\t\t\t/* check if the seek position is already in some buffer and\n\t\t\t in that case return the end of that buffer (or of the last contiguous buffer) */\n\t\t\t/* TODO: Should wait until append operations are done */\n\t\t\tseek_info.offset = this.stream.getEndFilePositionAfter(seek_info.offset);\n\t\t}\n\t\tLog.info(\"ISOFile\", \"Adjusted seek position (after checking data already in buffer): \"+seek_info.offset);\n\t\treturn seek_info;\n\t}\n}\n\nISOFile.prototype.equal = function(b) {\n\tvar box_index = 0;\n\twhile (box_index < this.boxes.length && box_index < b.boxes.length) {\n\t\tvar a_box = this.boxes[box_index];\n\t\tvar b_box = b.boxes[box_index];\n\t\tif (!BoxParser.boxEqual(a_box, b_box)) {\n\t\t\treturn false;\n\t\t}\n\t\tbox_index++;\n\t}\n\treturn true;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.ISOFile = ISOFile;\n}\n// file:src/isofile-advanced-parsing.js\n/* position in the current buffer of the beginning of the last box parsed */\nISOFile.prototype.lastBoxStartPosition = 0;\n/* indicator if the parsing is stuck in the middle of an mdat box */\nISOFile.prototype.parsingMdat = null;\n/* next file position that the parser needs:\n    - 0 until the first buffer (i.e. fileStart ===0) has been received \n    - otherwise, the next box start until the moov box has been parsed\n    - otherwise, the position of the next sample to fetch\n */\nISOFile.prototype.nextParsePosition = 0;\n/* keep mdat data */\nISOFile.prototype.discardMdatData = false;\n\nISOFile.prototype.processIncompleteBox = function(ret) {\n\tvar box;\n\tvar merged;\n\tvar found;\n\t\n\t/* we did not have enough bytes in the current buffer to parse the entire box */\n\tif (ret.type === \"mdat\") { \n\t\t/* we had enough bytes to get its type and size and it's an 'mdat' */\n\t\t\n\t\t/* special handling for mdat boxes, since we don't actually need to parse it linearly \n\t\t   we create the box */\n\t\tbox = new BoxParser[ret.type+\"Box\"](ret.size);\t\n\t\tthis.parsingMdat = box;\n\t\tthis.boxes.push(box);\n\t\tthis.mdats.push(box);\t\t\t\n\t\tbox.start = ret.start;\n\t\tbox.hdr_size = ret.hdr_size;\n\t\tthis.stream.addUsedBytes(box.hdr_size);\n\n\t\t/* indicate that the parsing should start from the end of the box */\n\t\tthis.lastBoxStartPosition = box.start + box.size;\n \t\t/* let's see if we have the end of the box in the other buffers */\n\t\tfound = this.stream.seek(box.start + box.size, false, this.discardMdatData);\n\t\tif (found) {\n\t\t\t/* found the end of the box */\n\t\t\tthis.parsingMdat = null;\n\t\t\t/* let's see if we can parse more in this buffer */\n\t\t\treturn true;\n\t\t} else {\n\t\t\t/* 'mdat' end not found in the existing buffers */\n\t\t\t/* determine the next position in the file to start parsing from */\n\t\t\tif (!this.moovStartFound) {\n\t\t\t\t/* moov not find yet, \n\t\t\t\t   the file probably has 'mdat' at the beginning, and 'moov' at the end, \n\t\t\t\t   indicate that the downloader should not try to download those bytes now */\n\t\t\t\tthis.nextParsePosition = box.start + box.size;\n\t\t\t} else {\n\t\t\t\t/* we have the start of the moov box, \n\t\t\t\t   the next bytes should try to complete the current 'mdat' */\n\t\t\t\tthis.nextParsePosition = this.stream.findEndContiguousBuf();\n\t\t\t}\n\t\t\t/* not much we can do, wait for more buffers to arrive */\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\t/* box is incomplete, we may not even know its type */\n\t\tif (ret.type === \"moov\") { \n\t\t\t/* the incomplete box is a 'moov' box */\n\t\t\tthis.moovStartFound = true;\n\t\t\tif (this.mdats.length === 0) {\n\t\t\t\tthis.isProgressive = true;\n\t\t\t}\n\t\t}\n\t\t/* either it's not an mdat box (and we need to parse it, we cannot skip it)\n\t\t   (TODO: we could skip 'free' boxes ...)\n\t\t\t   or we did not have enough data to parse the type and size of the box, \n\t\t   we try to concatenate the current buffer with the next buffer to restart parsing */\n\t\tmerged = (this.stream.mergeNextBuffer ? this.stream.mergeNextBuffer() : false);\n\t\tif (merged) {\n\t\t\t/* The next buffer was contiguous, the merging succeeded,\n\t\t\t   we can now continue parsing, \n\t\t\t   the next best position to parse is at the end of this new buffer */\n\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\treturn true;\n\t\t} else {\n\t\t\t/* we cannot concatenate existing buffers because they are not contiguous or because there is no additional buffer */\n\t\t\t/* The next best position to parse is still at the end of this old buffer */\n\t\t\tif (!ret.type) {\n\t\t\t\t/* There were not enough bytes in the buffer to parse the box type and length,\n\t\t\t\t   the next fetch should retrieve those missing bytes, i.e. the next bytes after this buffer */\n\t\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\t} else {\n\t\t\t\t/* we had enough bytes to parse size and type of the incomplete box\n\t\t\t\t   if we haven't found yet the moov box, skip this one and try the next one \n\t\t\t\t   if we have found the moov box, let's continue linear parsing */\n\t\t\t\tif (this.moovStartFound) {\n\t\t\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\t\t} else {\n\t\t\t\t\tthis.nextParsePosition = this.stream.getPosition() + ret.size;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nISOFile.prototype.hasIncompleteMdat = function () {\n\treturn (this.parsingMdat !== null);\n}\n\nISOFile.prototype.processIncompleteMdat = function () {\n\tvar box;\n\tvar found;\n\t\n\t/* we are in the parsing of an incomplete mdat box */\n\tbox = this.parsingMdat;\n\n\tfound = this.stream.seek(box.start + box.size, false, this.discardMdatData);\n\tif (found) {\n\t\tLog.debug(\"ISOFile\", \"Found 'mdat' end in buffered data\");\n\t\t/* the end of the mdat has been found */ \n\t\tthis.parsingMdat = null;\n\t\t/* we can parse more in this buffer */\n\t\treturn true;\n\t} else {\n\t\t/* we don't have the end of this mdat yet, \n\t\t   indicate that the next byte to fetch is the end of the buffers we have so far, \n\t\t   return and wait for more buffer to come */\n\t\tthis.nextParsePosition = this.stream.findEndContiguousBuf();\n\t\treturn false;\n\t}\n}\n\nISOFile.prototype.restoreParsePosition = function() {\n\t/* Reposition at the start position of the previous box not entirely parsed */\n\treturn this.stream.seek(this.lastBoxStartPosition, true, this.discardMdatData);\n}\n\nISOFile.prototype.saveParsePosition = function() {\n\t/* remember the position of the box start in case we need to roll back (if the box is incomplete) */\n\tthis.lastBoxStartPosition = this.stream.getPosition();\t\n}\n\nISOFile.prototype.updateUsedBytes = function(box, ret) {\n\tif (this.stream.addUsedBytes) {\n\t\tif (box.type === \"mdat\") {\n\t\t\t/* for an mdat box, only its header is considered used, other bytes will be used when sample data is requested */\n\t\t\tthis.stream.addUsedBytes(box.hdr_size);\n\t\t\tif (this.discardMdatData) {\n\t\t\t\tthis.stream.addUsedBytes(box.size-box.hdr_size);\n\t\t\t}\n\t\t} else {\n\t\t\t/* for all other boxes, the entire box data is considered used */\n\t\t\tthis.stream.addUsedBytes(box.size);\n\t\t}\t\n\t}\n}\n// file:src/isofile-advanced-creation.js\nISOFile.prototype.add = BoxParser.Box.prototype.add;\nISOFile.prototype.addBox = BoxParser.Box.prototype.addBox;\n\nISOFile.prototype.init = function (_options) {\n\tvar options = _options || {}; \n\tvar ftyp = this.add(\"ftyp\").set(\"major_brand\", (options.brands && options.brands[0]) || \"iso4\")\n\t\t\t\t\t\t\t   .set(\"minor_version\", 0)\n\t\t\t\t\t\t\t   .set(\"compatible_brands\", options.brands || [\"iso4\"]);\n\tvar moov = this.add(\"moov\");\n\tmoov.add(\"mvhd\").set(\"timescale\", options.timescale || 600)\n\t\t\t\t\t.set(\"rate\", options.rate || 1<<16)\n\t\t\t\t\t.set(\"creation_time\", 0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"duration\", options.duration || 0)\n\t\t\t\t\t.set(\"volume\", (options.width) ? 0 : 0x0100)\n\t\t\t\t\t.set(\"matrix\", [ 1<<16, 0, 0, 0, 1<<16, 0, 0, 0, 0x40000000])\n\t\t\t\t\t.set(\"next_track_id\", 1);\n\tmoov.add(\"mvex\");\n\treturn this;\n}\n\nISOFile.prototype.addTrack = function (_options) {\n\tif (!this.moov) {\n\t\tthis.init(_options);\n\t}\n\n\tvar options = _options || {}; \n\toptions.width = options.width || 320;\n\toptions.height = options.height || 320;\n\toptions.id = options.id || this.moov.mvhd.next_track_id;\n\toptions.type = options.type || \"avc1\";\n\n\tvar trak = this.moov.add(\"trak\");\n\tthis.moov.mvhd.next_track_id = options.id+1;\n\ttrak.add(\"tkhd\").set(\"flags\",BoxParser.TKHD_FLAG_ENABLED | \n\t\t\t\t\t\t\t\t BoxParser.TKHD_FLAG_IN_MOVIE | \n\t\t\t\t\t\t\t\t BoxParser.TKHD_FLAG_IN_PREVIEW)\n\t\t\t\t\t.set(\"creation_time\",0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"track_id\", options.id)\n\t\t\t\t\t.set(\"duration\", options.duration || 0)\n\t\t\t\t\t.set(\"layer\", options.layer || 0)\n\t\t\t\t\t.set(\"alternate_group\", 0)\n\t\t\t\t\t.set(\"volume\", 1)\n\t\t\t\t\t.set(\"matrix\", [ 1<<16, 0, 0, 0, 1<<16, 0, 0, 0, 0x40000000 ])\n\t\t\t\t\t.set(\"width\", options.width << 16)\n\t\t\t\t\t.set(\"height\", options.height << 16);\n\n\tvar mdia = trak.add(\"mdia\");\n\tmdia.add(\"mdhd\").set(\"creation_time\", 0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"timescale\", options.timescale || 1)\n\t\t\t\t\t.set(\"duration\", options.media_duration || 0)\n\t\t\t\t\t.set(\"language\", options.language || \"und\");\n\n\tmdia.add(\"hdlr\").set(\"handler\", options.hdlr || \"vide\")\n\t\t\t\t\t.set(\"name\", options.name || \"Track created with MP4Box.js\");\n\n\tmdia.add(\"elng\").set(\"extended_language\", options.language || \"fr-FR\");\n\n\tvar minf = mdia.add(\"minf\");\n\tif (BoxParser[options.type+\"SampleEntry\"] === undefined) return;\n\tvar sample_description_entry = new BoxParser[options.type+\"SampleEntry\"]();\n\tsample_description_entry.data_reference_index = 1;\n\tvar media_type = \"\";\n\tfor (var mediaType in BoxParser.sampleEntryCodes) {\n\t\tvar codes = BoxParser.sampleEntryCodes[mediaType];\n\t\tfor (var i = 0; i < codes.length; i++) {\n\t\t\tif (codes.indexOf(options.type) > -1) {\n\t\t\t\tmedia_type = mediaType;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tswitch(media_type) {\n\t\tcase \"Visual\":\n\t\t\tminf.add(\"vmhd\").set(\"graphicsmode\",0).set(\"opcolor\", [ 0, 0, 0 ]);\n\t\t\tsample_description_entry.set(\"width\", options.width)\n\t\t\t\t\t\t.set(\"height\", options.height)\n\t\t\t\t\t\t.set(\"horizresolution\", 0x48<<16)\n\t\t\t\t\t\t.set(\"vertresolution\", 0x48<<16)\n\t\t\t\t\t\t.set(\"frame_count\", 1)\n\t\t\t\t\t\t.set(\"compressorname\", options.type+\" Compressor\")\n\t\t\t\t\t\t.set(\"depth\", 0x18);\n\t\t\tif (options.avcDecoderConfigRecord) {\n\t\t\t\tvar avcC = new BoxParser.avcCBox();\n\t\t\t\tavcC.parse(new MP4BoxStream(options.avcDecoderConfigRecord));\n\t\t\t\tsample_description_entry.addBox(avcC);\n\t\t\t} else if (options.hevcDecoderConfigRecord) {\n\t\t\t\tvar hvcC = new BoxParser.hvcCBox();\n\t\t\t\thvcC.parse(new MP4BoxStream(options.hevcDecoderConfigRecord));\n\t\t\t\tsample_description_entry.addBox(hvcC);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"Audio\":\n\t\t\tminf.add(\"smhd\").set(\"balance\", options.balance || 0);\n\t\t\tsample_description_entry.set(\"channel_count\", options.channel_count || 2)\n\t\t\t\t\t\t.set(\"samplesize\", options.samplesize || 16)\n\t\t\t\t\t\t.set(\"samplerate\", options.samplerate || 1<<16);\n\t\t\tbreak;\n\t\tcase \"Hint\":\n\t\t\tminf.add(\"hmhd\"); // TODO: add properties\n\t\t\tbreak;\n\t\tcase \"Subtitle\":\n\t\t\tminf.add(\"sthd\");\n\t\t\tswitch (options.type) {\n\t\t\t\tcase \"stpp\":\n\t\t\t\t\tsample_description_entry.set(\"namespace\", options.namespace || \"nonamespace\")\n\t\t\t\t\t\t\t\t.set(\"schema_location\", options.schema_location || \"\")\n\t\t\t\t\t\t\t\t.set(\"auxiliary_mime_types\", options.auxiliary_mime_types || \"\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"Metadata\":\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t\tcase \"System\":\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t}\n\tif (options.description) {\n\t\tsample_description_entry.addBox(options.description);\n\t}\n\tif (options.description_boxes) {\n\t\toptions.description_boxes.forEach(function (b) {\n\t\t\tsample_description_entry.addBox(b);\n\t\t});\n\t}\n\tminf.add(\"dinf\").add(\"dref\").addEntry((new BoxParser[\"url Box\"]()).set(\"flags\", 0x1));\n\tvar stbl = minf.add(\"stbl\");\n\tstbl.add(\"stsd\").addEntry(sample_description_entry);\n\tstbl.add(\"stts\").set(\"sample_counts\", [])\n\t\t\t\t\t.set(\"sample_deltas\", []);\n\tstbl.add(\"stsc\").set(\"first_chunk\", [])\n\t\t\t\t\t.set(\"samples_per_chunk\", [])\n\t\t\t\t\t.set(\"sample_description_index\", []);\n\tstbl.add(\"stco\").set(\"chunk_offsets\", []);\n\tstbl.add(\"stsz\").set(\"sample_sizes\", []);\n\n\tthis.moov.mvex.add(\"trex\").set(\"track_id\", options.id)\n\t\t\t\t\t\t\t  .set(\"default_sample_description_index\", options.default_sample_description_index || 1)\n\t\t\t\t\t\t\t  .set(\"default_sample_duration\", options.default_sample_duration || 0)\n\t\t\t\t\t\t\t  .set(\"default_sample_size\", options.default_sample_size || 0)\n\t\t\t\t\t\t\t  .set(\"default_sample_flags\", options.default_sample_flags || 0);\n\tthis.buildTrakSampleLists(trak);\n\treturn options.id;\n}\n\nBoxParser.Box.prototype.computeSize = function(stream_) {\n\tvar stream = stream_ || new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n}\n\nISOFile.prototype.addSample = function (track_id, data, _options) {\n\tvar options = _options || {};\n\tvar sample = {};\n\tvar trak = this.getTrackById(track_id);\n\tif (trak === null) return;\n    sample.number = trak.samples.length;\n\tsample.track_id = trak.tkhd.track_id;\n\tsample.timescale = trak.mdia.mdhd.timescale;\n\tsample.description_index = (options.sample_description_index ? options.sample_description_index - 1: 0);\n\tsample.description = trak.mdia.minf.stbl.stsd.entries[sample.description_index];\n\tsample.data = data;\n\tsample.size = data.byteLength;\n\tsample.alreadyRead = sample.size;\n\tsample.duration = options.duration || 1;\n\tsample.cts = options.cts || 0;\n\tsample.dts = options.dts || 0;\n\tsample.is_sync = options.is_sync || false;\n\tsample.is_leading = options.is_leading || 0;\n\tsample.depends_on = options.depends_on || 0;\n\tsample.is_depended_on = options.is_depended_on || 0;\n\tsample.has_redundancy = options.has_redundancy || 0;\n\tsample.degradation_priority = options.degradation_priority || 0;\n\tsample.offset = 0;\n\tsample.subsamples = options.subsamples;\n\ttrak.samples.push(sample);\n\ttrak.samples_size += sample.size;\n\ttrak.samples_duration += sample.duration;\n\tif (trak.first_dts === undefined) {\n\t\ttrak.first_dts = options.dts;\n\t}\n\n\tthis.processSamples();\n\t\n\tvar moof = this.createSingleSampleMoof(sample);\n\tthis.addBox(moof);\n\tmoof.computeSize();\n\t/* adjusting the data_offset now that the moof size is known*/\n\tmoof.trafs[0].truns[0].data_offset = moof.size+8; //8 is mdat header\n\tthis.add(\"mdat\").data = new Uint8Array(data);\n\treturn sample;\n}\n\nISOFile.prototype.createSingleSampleMoof = function(sample) {\n\tvar sample_flags = 0;\n\tif (sample.is_sync)\n\t\tsample_flags = (1 << 25);  // sample_depends_on_none (I picture)\n\telse\n\t\tsample_flags = (1 << 16);  // non-sync\n\n\tvar moof = new BoxParser.moofBox();\n\tmoof.add(\"mfhd\").set(\"sequence_number\", this.nextMoofNumber);\n\tthis.nextMoofNumber++;\n\tvar traf = moof.add(\"traf\");\n\tvar trak = this.getTrackById(sample.track_id);\n\ttraf.add(\"tfhd\").set(\"track_id\", sample.track_id)\n\t\t\t\t\t.set(\"flags\", BoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF);\n\ttraf.add(\"tfdt\").set(\"baseMediaDecodeTime\", (sample.dts - (trak.first_dts || 0)));\n\ttraf.add(\"trun\").set(\"flags\", BoxParser.TRUN_FLAGS_DATA_OFFSET | BoxParser.TRUN_FLAGS_DURATION | \n\t\t\t\t \t\t\t\t  BoxParser.TRUN_FLAGS_SIZE | BoxParser.TRUN_FLAGS_FLAGS | \n\t\t\t\t \t\t\t\t  BoxParser.TRUN_FLAGS_CTS_OFFSET)\n\t\t\t\t\t.set(\"data_offset\",0)\n\t\t\t\t\t.set(\"first_sample_flags\",0)\n\t\t\t\t\t.set(\"sample_count\",1)\n\t\t\t\t\t.set(\"sample_duration\",[sample.duration])\n\t\t\t\t\t.set(\"sample_size\",[sample.size])\n\t\t\t\t\t.set(\"sample_flags\",[sample_flags])\n\t\t\t\t\t.set(\"sample_composition_time_offset\", [sample.cts - sample.dts]);\n\treturn moof;\n}\n\n// file:src/isofile-sample-processing.js\n/* Index of the last moof box received */\nISOFile.prototype.lastMoofIndex = 0;\n\n/* size of the buffers allocated for samples */\nISOFile.prototype.samplesDataSize = 0;\n\n/* Resets all sample tables */\nISOFile.prototype.resetTables = function () {\n\tvar i;\n\tvar trak, stco, stsc, stsz, stts, ctts, stss;\n\tthis.initial_duration = this.moov.mvhd.duration;\n\tthis.moov.mvhd.duration = 0;\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\ttrak = this.moov.traks[i];\n\t\ttrak.tkhd.duration = 0;\n\t\ttrak.mdia.mdhd.duration = 0;\n\t\tstco = trak.mdia.minf.stbl.stco || trak.mdia.minf.stbl.co64;\n\t\tstco.chunk_offsets = [];\n\t\tstsc = trak.mdia.minf.stbl.stsc;\n\t\tstsc.first_chunk = [];\n\t\tstsc.samples_per_chunk = [];\n\t\tstsc.sample_description_index = [];\n\t\tstsz = trak.mdia.minf.stbl.stsz || trak.mdia.minf.stbl.stz2;\n\t\tstsz.sample_sizes = [];\n\t\tstts = trak.mdia.minf.stbl.stts;\n\t\tstts.sample_counts = [];\n\t\tstts.sample_deltas = [];\n\t\tctts = trak.mdia.minf.stbl.ctts;\n\t\tif (ctts) {\n\t\t\tctts.sample_counts = [];\n\t\t\tctts.sample_offsets = [];\n\t\t}\n\t\tstss = trak.mdia.minf.stbl.stss;\n\t\tvar k = trak.mdia.minf.stbl.boxes.indexOf(stss);\n\t\tif (k != -1) trak.mdia.minf.stbl.boxes[k] = null;\n\t}\n}\n\nISOFile.initSampleGroups = function(trak, traf, sbgps, trak_sgpds, traf_sgpds) {\n\tvar l;\n\tvar k;\n\tvar sample_groups_info;\n\tvar sample_group_info;\n\tvar sample_group_key;\n\tfunction SampleGroupInfo(_type, _parameter, _sbgp) {\n\t\tthis.grouping_type = _type;\n\t\tthis.grouping_type_parameter = _parameter;\n\t\tthis.sbgp = _sbgp;\n\t\tthis.last_sample_in_run = -1;\n\t\tthis.entry_index = -1;\t\t\n\t}\n\tif (traf) {\n\t\ttraf.sample_groups_info = [];\n\t} \n\tif (!trak.sample_groups_info) {\n\t\ttrak.sample_groups_info = [];\n\t}\n\tfor (k = 0; k < sbgps.length; k++) {\n\t\tsample_group_key = sbgps[k].grouping_type +\"/\"+ sbgps[k].grouping_type_parameter;\n\t\tsample_group_info = new SampleGroupInfo(sbgps[k].grouping_type, sbgps[k].grouping_type_parameter, sbgps[k]);\n\t\tif (traf) {\n\t\t\ttraf.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t}\n\t\tif (!trak.sample_groups_info[sample_group_key]) {\n\t\t\ttrak.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t}\n\t\tfor (l=0; l <trak_sgpds.length; l++) {\n\t\t\tif (trak_sgpds[l].grouping_type === sbgps[k].grouping_type) {\n\t\t\t\tsample_group_info.description = trak_sgpds[l];\n\t\t\t\tsample_group_info.description.used = true;\n\t\t\t}\n\t\t}\n\t\tif (traf_sgpds) {\n\t\t\tfor (l=0; l <traf_sgpds.length; l++) {\n\t\t\t\tif (traf_sgpds[l].grouping_type === sbgps[k].grouping_type) {\n\t\t\t\t\tsample_group_info.fragment_description = traf_sgpds[l];\n\t\t\t\t\tsample_group_info.fragment_description.used = true;\n\t\t\t\t\tsample_group_info.is_fragment = true;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\t}\n\tif (!traf) {\n\t\tfor (k = 0; k < trak_sgpds.length; k++) {\n\t\t\tif (!trak_sgpds[k].used && trak_sgpds[k].version >= 2) {\n\t\t\t\tsample_group_key = trak_sgpds[k].grouping_type +\"/0\";\n\t\t\t\tsample_group_info = new SampleGroupInfo(trak_sgpds[k].grouping_type, 0);\n\t\t\t\tif (!trak.sample_groups_info[sample_group_key]) {\n\t\t\t\t\ttrak.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (traf_sgpds) {\n\t\t\tfor (k = 0; k < traf_sgpds.length; k++) {\n\t\t\t\tif (!traf_sgpds[k].used && traf_sgpds[k].version >= 2) {\n\t\t\t\t\tsample_group_key = traf_sgpds[k].grouping_type +\"/0\";\n\t\t\t\t\tsample_group_info = new SampleGroupInfo(traf_sgpds[k].grouping_type, 0);\n\t\t\t\t\tsample_group_info.is_fragment = true;\n\t\t\t\t\tif (!traf.sample_groups_info[sample_group_key]) {\n\t\t\t\t\t\ttraf.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.setSampleGroupProperties = function(trak, sample, sample_number, sample_groups_info) {\n\tvar k;\n\tvar index;\n\tsample.sample_groups = [];\n\tfor (k in sample_groups_info) {\n\t\tsample.sample_groups[k] = {};\n\t\tsample.sample_groups[k].grouping_type = sample_groups_info[k].grouping_type;\n\t\tsample.sample_groups[k].grouping_type_parameter = sample_groups_info[k].grouping_type_parameter;\n\t\tif (sample_number >= sample_groups_info[k].last_sample_in_run) {\n\t\t\tif (sample_groups_info[k].last_sample_in_run < 0) {\n\t\t\t\tsample_groups_info[k].last_sample_in_run = 0;\n\t\t\t}\n\t\t\tsample_groups_info[k].entry_index++;\t\n\t\t\tif (sample_groups_info[k].entry_index <= sample_groups_info[k].sbgp.entries.length - 1) {\n\t\t\t\tsample_groups_info[k].last_sample_in_run += sample_groups_info[k].sbgp.entries[sample_groups_info[k].entry_index].sample_count;\n\t\t\t}\n\t\t}\n\t\tif (sample_groups_info[k].entry_index <= sample_groups_info[k].sbgp.entries.length - 1) {\n\t\t\tsample.sample_groups[k].group_description_index = sample_groups_info[k].sbgp.entries[sample_groups_info[k].entry_index].group_description_index;\n\t\t} else {\n\t\t\tsample.sample_groups[k].group_description_index = -1; // special value for not defined\n\t\t}\n\t\tif (sample.sample_groups[k].group_description_index !== 0) {\n\t\t\tvar description;\n\t\t\tif (sample_groups_info[k].fragment_description) {\n\t\t\t\tdescription = sample_groups_info[k].fragment_description;\n\t\t\t} else {\n\t\t\t\tdescription = sample_groups_info[k].description;\n\t\t\t}\n\t\t\tif (sample.sample_groups[k].group_description_index > 0) {\n\t\t\t\tif (sample.sample_groups[k].group_description_index > 65535) {\n\t\t\t\t\tindex = (sample.sample_groups[k].group_description_index >> 16)-1;\n\t\t\t\t} else {\n\t\t\t\t\tindex = sample.sample_groups[k].group_description_index-1;\n\t\t\t\t}\n\t\t\t\tif (description && index >= 0) {\n\t\t\t\t\tsample.sample_groups[k].description = description.entries[index];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (description && description.version >= 2) {\n\t\t\t\t\tif (description.default_group_description_index > 0) {\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tsample.sample_groups[k].description = description.entries[description.default_group_description_index-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.process_sdtp = function (sdtp, sample, number) {\n\tif (!sample) {\n\t\treturn;\n\t}\n\tif (sdtp) {\n\t\tsample.is_leading = sdtp.is_leading[number];\n\t\tsample.depends_on = sdtp.sample_depends_on[number];\n\t\tsample.is_depended_on = sdtp.sample_is_depended_on[number];\n\t\tsample.has_redundancy = sdtp.sample_has_redundancy[number];\n\t} else {\n\t\tsample.is_leading = 0;\n\t\tsample.depends_on = 0;\n\t\tsample.is_depended_on = 0\n\t\tsample.has_redundancy = 0;\n\t}\t\n}\n\n/* Build initial sample list from  sample tables */\nISOFile.prototype.buildSampleLists = function() {\t\n\tvar i;\n\tvar trak;\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\ttrak = this.moov.traks[i];\n\t\tthis.buildTrakSampleLists(trak);\n\t}\n}\n\nISOFile.prototype.buildTrakSampleLists = function(trak) {\t\n\tvar j, k;\n\tvar stco, stsc, stsz, stts, ctts, stss, stsd, subs, sbgps, sgpds, stdp;\n\tvar chunk_run_index, chunk_index, last_chunk_in_run, offset_in_chunk, last_sample_in_chunk;\n\tvar last_sample_in_stts_run, stts_run_index, last_sample_in_ctts_run, ctts_run_index, last_stss_index, last_subs_index, subs_entry_index, last_subs_sample_index;\n\n\ttrak.samples = [];\n\ttrak.samples_duration = 0;\n\ttrak.samples_size = 0;\n\tstco = trak.mdia.minf.stbl.stco || trak.mdia.minf.stbl.co64;\n\tstsc = trak.mdia.minf.stbl.stsc;\n\tstsz = trak.mdia.minf.stbl.stsz || trak.mdia.minf.stbl.stz2;\n\tstts = trak.mdia.minf.stbl.stts;\n\tctts = trak.mdia.minf.stbl.ctts;\n\tstss = trak.mdia.minf.stbl.stss;\n\tstsd = trak.mdia.minf.stbl.stsd;\n\tsubs = trak.mdia.minf.stbl.subs;\n\tstdp = trak.mdia.minf.stbl.stdp;\n\tsbgps = trak.mdia.minf.stbl.sbgps;\n\tsgpds = trak.mdia.minf.stbl.sgpds;\n\t\n\tlast_sample_in_stts_run = -1;\n\tstts_run_index = -1;\n\tlast_sample_in_ctts_run = -1;\n\tctts_run_index = -1;\n\tlast_stss_index = 0;\n\tsubs_entry_index = 0;\n\tlast_subs_sample_index = 0;\t\t\n\n\tISOFile.initSampleGroups(trak, null, sbgps, sgpds);\n\n\tif (typeof stsz === \"undefined\") {\n\t\treturn;\n\t}\n\n\t/* we build the samples one by one and compute their properties */\n\tfor (j = 0; j < stsz.sample_sizes.length; j++) {\n\t\tvar sample = {};\n\t\tsample.number = j;\n\t\tsample.track_id = trak.tkhd.track_id;\n\t\tsample.timescale = trak.mdia.mdhd.timescale;\n\t\tsample.alreadyRead = 0;\n\t\ttrak.samples[j] = sample;\n\t\t/* size can be known directly */\n\t\tsample.size = stsz.sample_sizes[j];\n\t\ttrak.samples_size += sample.size;\n\t\t/* computing chunk-based properties (offset, sample description index)*/\n\t\tif (j === 0) {\t\t\t\t\n\t\t\tchunk_index = 1; /* the first sample is in the first chunk (chunk indexes are 1-based) */\n\t\t\tchunk_run_index = 0; /* the first chunk is the first entry in the first_chunk table */\n\t\t\tsample.chunk_index = chunk_index;\n\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\tlast_sample_in_chunk = stsc.samples_per_chunk[chunk_run_index];\n\t\t\toffset_in_chunk = 0;\n\n\t\t\t/* Is there another entry in the first_chunk table ? */\n\t\t\tif (chunk_run_index + 1 < stsc.first_chunk.length) {\n\t\t\t\t/* The last chunk in the run is the chunk before the next first chunk */\n\t\t\t\tlast_chunk_in_run = stsc.first_chunk[chunk_run_index+1]-1; \t\n\t\t\t} else {\n\t\t\t\t/* There is only one entry in the table, it is valid for all future chunks*/\n\t\t\t\tlast_chunk_in_run = Infinity;\n\t\t\t}\n\t\t} else {\n\t\t\tif (j < last_sample_in_chunk) {\n\t\t\t\t/* the sample is still in the current chunk */\n\t\t\t\tsample.chunk_index = chunk_index;\n\t\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\t} else {\n\t\t\t\t/* the sample is in the next chunk */\n\t\t\t\tchunk_index++;\n\t\t\t\tsample.chunk_index = chunk_index;\n\t\t\t\t/* reset the accumulated offset in the chunk */\n\t\t\t\toffset_in_chunk = 0;\n\t\t\t\tif (chunk_index <= last_chunk_in_run) {\n\t\t\t\t\t/* stay in the same entry of the first_chunk table */\n\t\t\t\t\t/* chunk_run_index unmodified */\n\t\t\t\t} else {\n\t\t\t\t\tchunk_run_index++;\n\t\t\t\t\t/* Is there another entry in the first_chunk table ? */\n\t\t\t\t\tif (chunk_run_index + 1 < stsc.first_chunk.length) {\n\t\t\t\t\t\t/* The last chunk in the run is the chunk before the next first chunk */\n\t\t\t\t\t\tlast_chunk_in_run = stsc.first_chunk[chunk_run_index+1]-1; \t\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* There is only one entry in the table, it is valid for all future chunks*/\n\t\t\t\t\t\tlast_chunk_in_run = Infinity;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\t\tlast_sample_in_chunk += stsc.samples_per_chunk[chunk_run_index];\n\t\t\t}\n\t\t}\n\n\t\tsample.description_index = stsc.sample_description_index[sample.chunk_run_index]-1;\n\t\tsample.description = stsd.entries[sample.description_index];\n\t\tsample.offset = stco.chunk_offsets[sample.chunk_index-1] + offset_in_chunk; /* chunk indexes are 1-based */\n\t\toffset_in_chunk += sample.size;\n\n\t\t/* setting dts, cts, duration and rap flags */\n\t\tif (j > last_sample_in_stts_run) {\n\t\t\tstts_run_index++;\n\t\t\tif (last_sample_in_stts_run < 0) {\n\t\t\t\tlast_sample_in_stts_run = 0;\n\t\t\t}\n\t\t\tlast_sample_in_stts_run += stts.sample_counts[stts_run_index];\t\t\t\t\n\t\t}\n\t\tif (j > 0) {\n\t\t\ttrak.samples[j-1].duration = stts.sample_deltas[stts_run_index];\n\t\t\ttrak.samples_duration += trak.samples[j-1].duration;\n\t\t\tsample.dts = trak.samples[j-1].dts + trak.samples[j-1].duration;\n\t\t} else {\n\t\t\tsample.dts = 0;\n\t\t}\n\t\tif (ctts) {\n\t\t\tif (j >= last_sample_in_ctts_run) {\n\t\t\t\tctts_run_index++;\n\t\t\t\tif (last_sample_in_ctts_run < 0) {\n\t\t\t\t\tlast_sample_in_ctts_run = 0;\n\t\t\t\t}\n\t\t\t\tlast_sample_in_ctts_run += ctts.sample_counts[ctts_run_index];\t\t\t\t\n\t\t\t}\n\t\t\tsample.cts = trak.samples[j].dts + ctts.sample_offsets[ctts_run_index];\n\t\t} else {\n\t\t\tsample.cts = sample.dts;\n\t\t}\n\t\tif (stss) {\n\t\t\tif (j == stss.sample_numbers[last_stss_index] - 1) { // sample numbers are 1-based\n\t\t\t\tsample.is_sync = true;\n\t\t\t\tlast_stss_index++;\n\t\t\t} else {\n\t\t\t\tsample.is_sync = false;\t\t\t\t\n\t\t\t\tsample.degradation_priority = 0;\n\t\t\t}\n\t\t\tif (subs) {\n\t\t\t\tif (subs.entries[subs_entry_index].sample_delta + last_subs_sample_index == j+1) {\n\t\t\t\t\tsample.subsamples = subs.entries[subs_entry_index].subsamples;\n\t\t\t\t\tlast_subs_sample_index += subs.entries[subs_entry_index].sample_delta;\n\t\t\t\t\tsubs_entry_index++;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tsample.is_sync = true;\n\t\t}\n\t\tISOFile.process_sdtp(trak.mdia.minf.stbl.sdtp, sample, sample.number);\n\t\tif (stdp) {\n\t\t\tsample.degradation_priority = stdp.priority[j];\n\t\t} else {\n\t\t\tsample.degradation_priority = 0;\n\t\t}\n\t\tif (subs) {\n\t\t\tif (subs.entries[subs_entry_index].sample_delta + last_subs_sample_index == j) {\n\t\t\t\tsample.subsamples = subs.entries[subs_entry_index].subsamples;\n\t\t\t\tlast_subs_sample_index += subs.entries[subs_entry_index].sample_delta;\n\t\t\t}\n\t\t}\n\t\tif (sbgps.length > 0 || sgpds.length > 0) {\n\t\t\tISOFile.setSampleGroupProperties(trak, sample, j, trak.sample_groups_info);\n\t\t}\n\t}\n\tif (j>0) {\n\t\ttrak.samples[j-1].duration = Math.max(trak.mdia.mdhd.duration - trak.samples[j-1].dts, 0);\n\t\ttrak.samples_duration += trak.samples[j-1].duration;\n\t}\n}\n\n/* Update sample list when new 'moof' boxes are received */\nISOFile.prototype.updateSampleLists = function() {\t\n\tvar i, j, k;\n\tvar default_sample_description_index, default_sample_duration, default_sample_size, default_sample_flags;\n\tvar last_run_position;\n\tvar box, moof, traf, trak, trex;\n\tvar sample;\n\tvar sample_flags;\n\t\n\tif (this.moov === undefined) {\n\t\treturn;\n\t}\n\t/* if the input file is fragmented and fetched in multiple downloads, we need to update the list of samples */\n\twhile (this.lastMoofIndex < this.moofs.length) {\n\t\tbox = this.moofs[this.lastMoofIndex];\n\t\tthis.lastMoofIndex++;\n\t\tif (box.type == \"moof\") {\n\t\t\tmoof = box;\n\t\t\tfor (i = 0; i < moof.trafs.length; i++) {\n\t\t\t\ttraf = moof.trafs[i];\n\t\t\t\ttrak = this.getTrackById(traf.tfhd.track_id);\n\t\t\t\ttrex = this.getTrexById(traf.tfhd.track_id);\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\t\t\t\tdefault_sample_description_index = traf.tfhd.default_sample_description_index;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_description_index = (trex ? trex.default_sample_description_index: 1);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\t\t\t\tdefault_sample_duration = traf.tfhd.default_sample_duration;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_duration = (trex ? trex.default_sample_duration : 0);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\t\t\t\tdefault_sample_size = traf.tfhd.default_sample_size;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_size = (trex ? trex.default_sample_size : 0);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\t\t\t\tdefault_sample_flags = traf.tfhd.default_sample_flags;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_flags = (trex ? trex.default_sample_flags : 0);\n\t\t\t\t}\n\t\t\t\ttraf.sample_number = 0;\n\t\t\t\t/* process sample groups */\n\t\t\t\tif (traf.sbgps.length > 0) {\n\t\t\t\t\tISOFile.initSampleGroups(trak, traf, traf.sbgps, trak.mdia.minf.stbl.sgpds, traf.sgpds);\n\t\t\t\t}\n\t\t\t\tfor (j = 0; j < traf.truns.length; j++) {\n\t\t\t\t\tvar trun = traf.truns[j];\n\t\t\t\t\tfor (k = 0; k < trun.sample_count; k++) {\n\t\t\t\t\t\tsample = {};\n\t\t\t\t\t\tsample.moof_number = this.lastMoofIndex;\n\t\t\t\t\t\tsample.number_in_traf = traf.sample_number;\n\t\t\t\t\t\ttraf.sample_number++;\n\t\t\t            sample.number = trak.samples.length;\n\t\t\t\t\t\ttraf.first_sample_index = trak.samples.length;\n\t\t\t\t\t\ttrak.samples.push(sample);\n\t\t\t\t\t\tsample.track_id = trak.tkhd.track_id;\n\t\t\t\t\t\tsample.timescale = trak.mdia.mdhd.timescale;\n\t\t\t\t\t\tsample.description_index = default_sample_description_index-1;\n\t\t\t\t\t\tsample.description = trak.mdia.minf.stbl.stsd.entries[sample.description_index];\n\t\t\t\t\t\tsample.size = default_sample_size;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\t\t\t\t\tsample.size = trun.sample_size[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttrak.samples_size += sample.size;\n\t\t\t\t\t\tsample.duration = default_sample_duration;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\t\t\t\t\tsample.duration = trun.sample_duration[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttrak.samples_duration += sample.duration;\n\t\t\t\t\t\tif (trak.first_traf_merged || k > 0) {\n\t\t\t\t\t\t\tsample.dts = trak.samples[trak.samples.length-2].dts+trak.samples[trak.samples.length-2].duration;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (traf.tfdt) {\n\t\t\t\t\t\t\t\tsample.dts = traf.tfdt.baseMediaDecodeTime;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsample.dts = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttrak.first_traf_merged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample.cts = sample.dts;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\t\t\t\t\tsample.cts = sample.dts + trun.sample_composition_time_offset[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample_flags = default_sample_flags;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\t\t\t\t\tsample_flags = trun.sample_flags[k];\n\t\t\t\t\t\t} else if (k === 0 && (trun.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG)) {\n\t\t\t\t\t\t\tsample_flags = trun.first_sample_flags;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample.is_sync = ((sample_flags >> 16 & 0x1) ? false : true);\n\t\t\t\t\t\tsample.is_leading = (sample_flags >> 26 & 0x3);\n\t\t\t\t\t\tsample.depends_on = (sample_flags >> 24 & 0x3);\n\t\t\t\t\t\tsample.is_depended_on = (sample_flags >> 22 & 0x3);\n\t\t\t\t\t\tsample.has_redundancy = (sample_flags >> 20 & 0x3);\n\t\t\t\t\t\tsample.degradation_priority = (sample_flags & 0xFFFF);\n\t\t\t\t\t\t//ISOFile.process_sdtp(traf.sdtp, sample, sample.number_in_traf);\n\t\t\t\t\t\tvar bdop = (traf.tfhd.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) ? true : false;\n\t\t\t\t\t\tvar dbim = (traf.tfhd.flags & BoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF) ? true : false;\n\t\t\t\t\t\tvar dop = (trun.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) ? true : false;\n\t\t\t\t\t\tvar bdo = 0;\n\t\t\t\t\t\tif (!bdop) {\n\t\t\t\t\t\t\tif (!dbim) {\n\t\t\t\t\t\t\t\tif (j === 0) { // the first track in the movie fragment\n\t\t\t\t\t\t\t\t\tbdo = moof.start; // the position of the first byte of the enclosing Movie Fragment Box\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tbdo = last_run_position; // end of the data defined by the preceding *track* (irrespective of the track id) fragment in the moof\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbdo = moof.start;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbdo = traf.tfhd.base_data_offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j === 0 && k === 0) {\n\t\t\t\t\t\t\tif (dop) {\n\t\t\t\t\t\t\t\tsample.offset = bdo + trun.data_offset; // If the data-offset is present, it is relative to the base-data-offset established in the track fragment header\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsample.offset = bdo; // the data for this run starts the base-data-offset defined by the track fragment header\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsample.offset = last_run_position; // this run starts immediately after the data of the previous run\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlast_run_position = sample.offset + sample.size;\n\t\t\t\t\t\tif (traf.sbgps.length > 0 || traf.sgpds.length > 0 ||\n\t\t\t\t\t\t\ttrak.mdia.minf.stbl.sbgps.length > 0 || trak.mdia.minf.stbl.sgpds.length > 0) {\n\t\t\t\t\t\t\tISOFile.setSampleGroupProperties(trak, sample, sample.number_in_traf, traf.sample_groups_info);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (traf.subs) {\n\t\t\t\t\ttrak.has_fragment_subsamples = true;\n\t\t\t\t\tvar sample_index = traf.first_sample_index;\n\t\t\t\t\tfor (j = 0; j < traf.subs.entries.length; j++) {\n\t\t\t\t\t\tsample_index += traf.subs.entries[j].sample_delta;\n\t\t\t\t\t\tsample = trak.samples[sample_index-1];\n\t\t\t\t\t\tsample.subsamples = traf.subs.entries[j].subsamples;\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\n}\n\n/* Try to get sample data for a given sample:\n   returns null if not found\n   returns the same sample if already requested\n */\nISOFile.prototype.getSample = function(trak, sampleNum) {\t\n\tvar buffer;\n\tvar sample = trak.samples[sampleNum];\n\t\n\tif (!this.moov) {\n\t\treturn null;\n\t}\n\n\tif (!sample.data) {\n\t\t/* Not yet fetched */\n\t\tsample.data = new Uint8Array(sample.size);\n\t\tsample.alreadyRead = 0;\n\t\tthis.samplesDataSize += sample.size;\n\t\tLog.debug(\"ISOFile\", \"Allocating sample #\"+sampleNum+\" on track #\"+trak.tkhd.track_id+\" of size \"+sample.size+\" (total: \"+this.samplesDataSize+\")\");\n\t} else if (sample.alreadyRead == sample.size) {\n\t\t/* Already fetched entirely */\n\t\treturn sample;\n\t}\n\n\t/* The sample has only been partially fetched, we need to check in all buffers */\n\twhile(true) {\n\t\tvar index =\tthis.stream.findPosition(true, sample.offset + sample.alreadyRead, false);\n\t\tif (index > -1) {\n\t\t\tbuffer = this.stream.buffers[index];\n\t\t\tvar lengthAfterStart = buffer.byteLength - (sample.offset + sample.alreadyRead - buffer.fileStart);\n\t\t\tif (sample.size - sample.alreadyRead <= lengthAfterStart) {\n\t\t\t\t/* the (rest of the) sample is entirely contained in this buffer */\n\n\t\t\t\tLog.debug(\"ISOFile\",\"Getting sample #\"+sampleNum+\" data (alreadyRead: \"+sample.alreadyRead+\" offset: \"+\n\t\t\t\t\t(sample.offset+sample.alreadyRead - buffer.fileStart)+\" read size: \"+(sample.size - sample.alreadyRead)+\" full size: \"+sample.size+\")\");\n\n\t\t\t\tDataStream.memcpy(sample.data.buffer, sample.alreadyRead,\n\t\t\t\t                  buffer, sample.offset+sample.alreadyRead - buffer.fileStart, sample.size - sample.alreadyRead);\n\n\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\tbuffer.usedBytes += sample.size - sample.alreadyRead;\n\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\tsample.alreadyRead = sample.size;\n\n\t\t\t\treturn sample;\n\t\t\t} else {\n\t\t\t\t/* the sample does not end in this buffer */\n\n\t\t\t\tif (lengthAfterStart === 0) return null;\n\n\t\t\t\tLog.debug(\"ISOFile\",\"Getting sample #\"+sampleNum+\" partial data (alreadyRead: \"+sample.alreadyRead+\" offset: \"+\n\t\t\t\t\t(sample.offset+sample.alreadyRead - buffer.fileStart)+\" read size: \"+lengthAfterStart+\" full size: \"+sample.size+\")\");\n\n\t\t\t\tDataStream.memcpy(sample.data.buffer, sample.alreadyRead,\n\t\t\t\t                  buffer, sample.offset+sample.alreadyRead - buffer.fileStart, lengthAfterStart);\n\t\t\t\tsample.alreadyRead += lengthAfterStart;\n\n\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\tbuffer.usedBytes += lengthAfterStart;\n\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\t/* keep looking in the next buffer */\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\n/* Release the memory used to store the data of the sample */\nISOFile.prototype.releaseSample = function(trak, sampleNum) {\t\n\tvar sample = trak.samples[sampleNum];\n\tif (sample.data) {\n\t\tthis.samplesDataSize -= sample.size;\n\t\tsample.data = null;\n\t\tsample.alreadyRead = 0;\n\t\treturn sample.size;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\nISOFile.prototype.getAllocatedSampleDataSize = function() {\n\treturn this.samplesDataSize;\n}\n\n/* Builds the MIME Type 'codecs' sub-parameters for the whole file */\nISOFile.prototype.getCodecs = function() {\t\n\tvar i;\n\tvar codecs = \"\";\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\tvar trak = this.moov.traks[i];\n\t\tif (i>0) {\n\t\t\tcodecs+=\",\"; \n\t\t}\n\t\tcodecs += trak.mdia.minf.stbl.stsd.entries[0].getCodec();\t\t\n\t}\n\treturn codecs;\n}\n\n/* Helper function */\nISOFile.prototype.getTrexById = function(id) {\t\n\tvar i;\n\tif (!this.moov || !this.moov.mvex) return null;\n\tfor (i = 0; i < this.moov.mvex.trexs.length; i++) {\n\t\tvar trex = this.moov.mvex.trexs[i];\n\t\tif (trex.track_id == id) return trex;\n\t}\n\treturn null;\n}\n\n/* Helper function */\nISOFile.prototype.getTrackById = function(id) {\n\tif (this.moov === undefined) {\n\t\treturn null;\n\t}\n\tfor (var j = 0; j < this.moov.traks.length; j++) {\n\t\tvar trak = this.moov.traks[j];\n\t\tif (trak.tkhd.track_id == id) return trak;\n\t}\n\treturn null;\n}\n// file:src/isofile-item-processing.js\n/* size of the buffers allocated for samples */\nISOFile.prototype.itemsDataSize = 0;\n\nISOFile.prototype.flattenItemInfo = function() {\t\n\tvar items = this.items;\n\tvar entity_groups = this.entity_groups;\n\tvar i, j;\n\tvar item;\n\tvar meta = this.meta;\n\tif (meta === null || meta === undefined) return;\n\tif (meta.hdlr === undefined) return;\n\tif (meta.iinf === undefined) return;\n\tfor (i = 0; i < meta.iinf.item_infos.length; i++) {\n\t\titem = {};\n\t\titem.id = meta.iinf.item_infos[i].item_ID;\n\t\titems[item.id] = item;\n\t\titem.ref_to = [];\n\t\titem.name = meta.iinf.item_infos[i].item_name;\n\t\tif (meta.iinf.item_infos[i].protection_index > 0) {\n\t\t\titem.protection = meta.ipro.protections[meta.iinf.item_infos[i].protection_index-1];\n\t\t}\n\t\tif (meta.iinf.item_infos[i].item_type) {\n\t\t\titem.type = meta.iinf.item_infos[i].item_type;\n\t\t} else {\n\t\t\titem.type = \"mime\";\n\t\t}\n\t\titem.content_type = meta.iinf.item_infos[i].content_type;\n\t\titem.content_encoding = meta.iinf.item_infos[i].content_encoding;\n\t\titem.item_uri_type = meta.iinf.item_infos[i].item_uri_type;\n\t}\n\tif (meta.grpl) {\n\t\tfor (i = 0; i < meta.grpl.boxes.length; i++) {\n\t\t\tentity_group = {};\n\t\t\tentity_group.id = meta.grpl.boxes[i].group_id;\n\t\t\tentity_group.entity_ids = meta.grpl.boxes[i].entity_ids;\n\t\t\tentity_group.type = meta.grpl.boxes[i].type;\n\t\t\tentity_groups[entity_group.id] = entity_group;\n\t\t}\n\t}\n\tif (meta.iloc) {\n\t\tfor(i = 0; i < meta.iloc.items.length; i++) {\n\t\t\tvar offset;\n\t\t\tvar itemloc = meta.iloc.items[i];\n\t\t\titem = items[itemloc.item_ID];\n\t\t\tif (itemloc.data_reference_index !== 0) {\n\t\t\t\tLog.warn(\"Item storage with reference to other files: not supported\");\n\t\t\t\titem.source = meta.dinf.boxes[itemloc.data_reference_index-1];\n\t\t\t}\n\t\t\tswitch(itemloc.construction_method) {\n\t\t\t\tcase 0: // offset into the file referenced by the data reference index\n\t\t\t\tbreak;\n\t\t\t\tcase 1: // offset into the idat box of this meta box\n\t\t\t\tbreak;\n\t\t\t\tcase 2: // offset into another item\n\t\t\t\tLog.warn(\"Item storage with construction_method : not supported\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\titem.extents = [];\n\t\t\titem.size = 0;\n\t\t\tfor (j = 0; j < itemloc.extents.length; j++) {\n\t\t\t\titem.extents[j] = {};\n\t\t\t\titem.extents[j].offset = itemloc.extents[j].extent_offset + itemloc.base_offset;\n\t\t\t\tif (itemloc.construction_method == 1) {\n\t\t\t\t\titem.extents[j].offset += meta.idat.start + meta.idat.hdr_size;\n\t\t\t\t}\n\t\t\t\titem.extents[j].length = itemloc.extents[j].extent_length;\n\t\t\t\titem.extents[j].alreadyRead = 0;\n\t\t\t\titem.size += item.extents[j].length;\n\t\t\t}\n\t\t}\n\t}\n\tif (meta.pitm) {\n\t\titems[meta.pitm.item_id].primary = true;\n\t}\n\tif (meta.iref) {\n\t\tfor (i=0; i <meta.iref.references.length; i++) {\n\t\t\tvar ref = meta.iref.references[i];\n\t\t\tfor (j=0; j<ref.references.length; j++) {\n\t\t\t\titems[ref.from_item_ID].ref_to.push({type: ref.type, id: ref.references[j]});\n\t\t\t}\n\t\t}\n\t}\n\tif (meta.iprp) {\n\t\tfor (var k = 0; k < meta.iprp.ipmas.length; k++) {\n\t\t\tvar ipma = meta.iprp.ipmas[k];\n\t\t\tfor (i = 0; i < ipma.associations.length; i++) {\n\t\t\t\tvar association = ipma.associations[i];\n\t\t\t\titem = items[association.id];\n\t\t\t\tif (!item) {\n\t\t\t\t\titem = entity_groups[association.id];\n\t\t\t\t}\n\t\t\t\tif (item) {\n\t\t\t\t\tif (item.properties === undefined) {\n\t\t\t\t\t\titem.properties = {};\n\t\t\t\t\t\titem.properties.boxes = [];\n\t\t\t\t\t}\n\t\t\t\t\tfor (j = 0; j < association.props.length; j++) {\n\t\t\t\t\t\tvar propEntry = association.props[j];\n\t\t\t\t\t\tif (propEntry.property_index > 0 && propEntry.property_index-1 < meta.iprp.ipco.boxes.length) {\n\t\t\t\t\t\t\tvar propbox = meta.iprp.ipco.boxes[propEntry.property_index-1];\n\t\t\t\t\t\t\titem.properties[propbox.type] = propbox;\n\t\t\t\t\t\t\titem.properties.boxes.push(propbox);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.prototype.getItem = function(item_id) {\t\n\tvar buffer;\n\tvar item;\n\t\n\tif (!this.meta) {\n\t\treturn null;\n\t}\n\n \titem = this.items[item_id];\n\tif (!item.data && item.size) {\n\t\t/* Not yet fetched */\n\t\titem.data = new Uint8Array(item.size);\n\t\titem.alreadyRead = 0;\n\t\tthis.itemsDataSize += item.size;\n\t\tLog.debug(\"ISOFile\", \"Allocating item #\"+item_id+\" of size \"+item.size+\" (total: \"+this.itemsDataSize+\")\");\n\t} else if (item.alreadyRead === item.size) {\n\t\t/* Already fetched entirely */\n\t\treturn item;\n\t}\n\n\t/* The item has only been partially fetched, we need to check in all buffers to find the remaining extents*/\n\n\tfor (var i = 0; i < item.extents.length; i++) {\n\t\tvar extent = item.extents[i];\n\t\tif (extent.alreadyRead === extent.length) {\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tvar index =\tthis.stream.findPosition(true, extent.offset + extent.alreadyRead, false);\n\t\t\tif (index > -1) {\n\t\t\t\tbuffer = this.stream.buffers[index];\n\t\t\t\tvar lengthAfterStart = buffer.byteLength - (extent.offset + extent.alreadyRead - buffer.fileStart);\n\t\t\t\tif (extent.length - extent.alreadyRead <= lengthAfterStart) {\n\t\t\t\t\t/* the (rest of the) extent is entirely contained in this buffer */\n\n\t\t\t\t\tLog.debug(\"ISOFile\",\"Getting item #\"+item_id+\" extent #\"+i+\" data (alreadyRead: \"+extent.alreadyRead+\n\t\t\t\t\t\t\" offset: \"+(extent.offset+extent.alreadyRead - buffer.fileStart)+\" read size: \"+(extent.length - extent.alreadyRead)+\n\t\t\t\t\t\t\" full extent size: \"+extent.length+\" full item size: \"+item.size+\")\");\n\n\t\t\t\t\tDataStream.memcpy(item.data.buffer, item.alreadyRead, \n\t\t\t\t\t                  buffer, extent.offset+extent.alreadyRead - buffer.fileStart, extent.length - extent.alreadyRead);\n\n\t\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\t\tbuffer.usedBytes += extent.length - extent.alreadyRead;\n\t\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\t\titem.alreadyRead += (extent.length - extent.alreadyRead);\n\t\t\t\t\textent.alreadyRead = extent.length;\n\t\t\t\t} else {\n\t\t\t\t\t/* the sample does not end in this buffer */\n\n\t\t\t\t\tLog.debug(\"ISOFile\",\"Getting item #\"+item_id+\" extent #\"+i+\" partial data (alreadyRead: \"+extent.alreadyRead+\" offset: \"+\n\t\t\t\t\t\t(extent.offset+extent.alreadyRead - buffer.fileStart)+\" read size: \"+lengthAfterStart+\n\t\t\t\t\t\t\" full extent size: \"+extent.length+\" full item size: \"+item.size+\")\");\n\n\t\t\t\t\tDataStream.memcpy(item.data.buffer, item.alreadyRead, \n\t\t\t\t\t                  buffer, extent.offset+extent.alreadyRead - buffer.fileStart, lengthAfterStart);\n\t\t\t\t\textent.alreadyRead += lengthAfterStart;\n\t\t\t\t\titem.alreadyRead += lengthAfterStart;\n\n\t\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\t\tbuffer.usedBytes += lengthAfterStart;\n\t\t\t\t\tthis.stream.logBufferLevel();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\tif (item.alreadyRead === item.size) {\n\t\t/* fetched entirely */\n\t\treturn item;\n\t} else {\n\t\treturn null;\n\t}\n}\n\n/* Release the memory used to store the data of the item */\nISOFile.prototype.releaseItem = function(item_id) {\t\n\tvar item = this.items[item_id];\n\tif (item.data) {\n\t\tthis.itemsDataSize -= item.size;\n\t\titem.data = null;\n\t\titem.alreadyRead = 0;\n\t\tfor (var i = 0; i < item.extents.length; i++) {\n\t\t\tvar extent = item.extents[i];\n\t\t\textent.alreadyRead = 0;\n\t\t}\n\t\treturn item.size;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\n\nISOFile.prototype.processItems = function(callback) {\n\tfor(var i in this.items) {\n\t\tvar item = this.items[i];\n\t\tthis.getItem(item.id);\n\t\tif (callback && !item.sent) {\n\t\t\tcallback(item);\n\t\t\titem.sent = true;\n\t\t\titem.data = null;\n\t\t}\n\t}\n}\n\nISOFile.prototype.hasItem = function(name) {\n\tfor(var i in this.items) {\n\t\tvar item = this.items[i];\n\t\tif (item.name === name) {\n\t\t\treturn item.id;\n\t\t}\n\t}\n\treturn -1;\n}\n\nISOFile.prototype.getMetaHandler = function() {\n\tif (!this.meta) {\n\t\treturn null;\n\t} else {\n\t\treturn this.meta.hdlr.handler;\t\t\n\t}\n}\n\nISOFile.prototype.getPrimaryItem = function() {\n\tif (!this.meta || !this.meta.pitm) {\n\t\treturn null;\n\t} else {\n\t\treturn this.getItem(this.meta.pitm.item_id);\n\t}\n}\n\nISOFile.prototype.itemToFragmentedTrackFile = function(_options) {\n\tvar options = _options || {};\n\tvar item = null;\n\tif (options.itemId) {\n\t\titem = this.getItem(options.itemId);\n\t} else {\n\t\titem = this.getPrimaryItem();\n\t}\n\tif (item == null) return null;\n\n\tvar file = new ISOFile();\n\tfile.discardMdatData = false;\n\t// assuming the track type is the same as the item type\n\tvar trackOptions = { type: item.type, description_boxes: item.properties.boxes};\n\tif (item.properties.ispe) {\n\t\ttrackOptions.width = item.properties.ispe.image_width;\n\t\ttrackOptions.height = item.properties.ispe.image_height;\n\t}\n\tvar trackId = file.addTrack(trackOptions);\n\tif (trackId) {\n\t\tfile.addSample(trackId, item.data);\n\t\treturn file;\n\t} else {\n\t\treturn null;\n\t}\n}\n\n// file:src/isofile-write.js\n/* Rewrite the entire file */\nISOFile.prototype.write = function(outstream) {\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tthis.boxes[i].write(outstream);\n\t}\n}\n\nISOFile.prototype.createFragment = function(track_id, sampleNumber, stream_) {\n\tvar trak = this.getTrackById(track_id);\n\tvar sample = this.getSample(trak, sampleNumber);\n\tif (sample == null) {\n\t\tthis.setNextSeekPositionFromSample(trak.samples[sampleNumber]);\n\t\treturn null;\n\t}\n\t\n\tvar stream = stream_ || new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\n\tvar moof = this.createSingleSampleMoof(sample);\n\tmoof.write(stream);\n\n\t/* adjusting the data_offset now that the moof size is known*/\n\tmoof.trafs[0].truns[0].data_offset = moof.size+8; //8 is mdat header\n\tLog.debug(\"MP4Box\", \"Adjusting data_offset with new value \"+moof.trafs[0].truns[0].data_offset);\n\tstream.adjustUint32(moof.trafs[0].truns[0].data_offset_position, moof.trafs[0].truns[0].data_offset);\n\t\t\n\tvar mdat = new BoxParser.mdatBox();\n\tmdat.data = sample.data;\n\tmdat.write(stream);\n\treturn stream;\n}\n\n/* Modify the file and create the initialization segment */\nISOFile.writeInitializationSegment = function(ftyp, moov, total_duration, sample_duration) {\n\tvar i;\n\tvar index;\n\tvar mehd;\n\tvar trex;\n\tvar box;\n\tLog.debug(\"ISOFile\", \"Generating initialization segment\");\n\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tftyp.write(stream);\n\t\n\t/* we can now create the new mvex box */\n\tvar mvex = moov.add(\"mvex\");\n\tif (total_duration) {\n\t\tmvex.add(\"mehd\").set(\"fragment_duration\", total_duration);\n\t}\n\tfor (i = 0; i < moov.traks.length; i++) {\n\t\tmvex.add(\"trex\").set(\"track_id\", moov.traks[i].tkhd.track_id)\n\t\t\t\t\t\t.set(\"default_sample_description_index\", 1)\n\t\t\t\t\t\t.set(\"default_sample_duration\", sample_duration)\n\t\t\t\t\t\t.set(\"default_sample_size\", 0)\n\t\t\t\t\t\t.set(\"default_sample_flags\", 1<<16)\n\t}\n\tmoov.write(stream);\n\n\treturn stream.buffer;\n\n}\n\nISOFile.prototype.save = function(name) {\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n\tstream.save(name);\t\n}\n\nISOFile.prototype.getBuffer = function() {\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n\treturn stream.buffer;\n}\n\nISOFile.prototype.initializeSegmentation = function() {\n\tvar i;\n\tvar j;\n\tvar box;\n\tvar initSegs;\n\tvar trak;\n\tvar seg;\n\tif (this.onSegment === null) {\n\t\tLog.warn(\"MP4Box\", \"No segmentation callback set!\");\n\t}\n\tif (!this.isFragmentationInitialized) {\n\t\tthis.isFragmentationInitialized = true;\t\t\n\t\tthis.nextMoofNumber = 0;\n\t\tthis.resetTables();\n\t}\t\n\tinitSegs = [];\t\n\tfor (i = 0; i < this.fragmentedTracks.length; i++) {\n\t\tvar moov = new BoxParser.moovBox();\n\t\tmoov.mvhd = this.moov.mvhd;\n\t    moov.boxes.push(moov.mvhd);\n\t\ttrak = this.getTrackById(this.fragmentedTracks[i].id);\n\t\tmoov.boxes.push(trak);\n\t\tmoov.traks.push(trak);\n\t\tseg = {};\n\t\tseg.id = trak.tkhd.track_id;\n\t\tseg.user = this.fragmentedTracks[i].user;\n\t\tseg.buffer = ISOFile.writeInitializationSegment(this.ftyp, moov, (this.moov.mvex && this.moov.mvex.mehd ? this.moov.mvex.mehd.fragment_duration: undefined), (this.moov.traks[i].samples.length>0 ? this.moov.traks[i].samples[0].duration: 0));\n\t\tinitSegs.push(seg);\n\t}\n\treturn initSegs;\n}\n\n// file:src/box-print.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.Box.prototype.printHeader = function(output) {\n\tthis.size += 8;\n\tif (this.size > MAX_SIZE) {\n\t\tthis.size += 8;\n\t}\n\tif (this.type === \"uuid\") {\n\t\tthis.size += 16;\n\t}\n\toutput.log(output.indent+\"size:\"+this.size);\n\toutput.log(output.indent+\"type:\"+this.type);\n}\n\nBoxParser.FullBox.prototype.printHeader = function(output) {\n\tthis.size += 4;\n\tBoxParser.Box.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"version:\"+this.version);\n\toutput.log(output.indent+\"flags:\"+this.flags);\n}\n\nBoxParser.Box.prototype.print = function(output) {\n\tthis.printHeader(output);\n}\n\nBoxParser.ContainerBox.prototype.print = function(output) {\n\tthis.printHeader(output);\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tvar prev_indent = output.indent;\n\t\t\toutput.indent += \" \";\n\t\t\tthis.boxes[i].print(output);\n\t\t\toutput.indent = prev_indent;\n\t\t}\n\t}\n}\n\nISOFile.prototype.print = function(output) {\n\toutput.indent = \"\";\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tthis.boxes[i].print(output);\n\t\t}\n\t}\t\n}\n\nBoxParser.mvhdBox.prototype.print = function(output) {\n\tBoxParser.FullBox.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"creation_time: \"+this.creation_time);\n\toutput.log(output.indent+\"modification_time: \"+this.modification_time);\n\toutput.log(output.indent+\"timescale: \"+this.timescale);\n\toutput.log(output.indent+\"duration: \"+this.duration);\n\toutput.log(output.indent+\"rate: \"+this.rate);\n\toutput.log(output.indent+\"volume: \"+(this.volume>>8));\n\toutput.log(output.indent+\"matrix: \"+this.matrix.join(\", \"));\n\toutput.log(output.indent+\"next_track_id: \"+this.next_track_id);\n}\n\nBoxParser.tkhdBox.prototype.print = function(output) {\n\tBoxParser.FullBox.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"creation_time: \"+this.creation_time);\n\toutput.log(output.indent+\"modification_time: \"+this.modification_time);\n\toutput.log(output.indent+\"track_id: \"+this.track_id);\n\toutput.log(output.indent+\"duration: \"+this.duration);\n\toutput.log(output.indent+\"volume: \"+(this.volume>>8));\n\toutput.log(output.indent+\"matrix: \"+this.matrix.join(\", \"));\n\toutput.log(output.indent+\"layer: \"+this.layer);\n\toutput.log(output.indent+\"alternate_group: \"+this.alternate_group);\n\toutput.log(output.indent+\"width: \"+this.width);\n\toutput.log(output.indent+\"height: \"+this.height);\n}// file:src/mp4box.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar MP4Box = {};\n\nMP4Box.createFile = function (_keepMdatData, _stream) {\n\t/* Boolean indicating if bytes containing media data should be kept in memory */\n\tvar keepMdatData = (_keepMdatData !== undefined ? _keepMdatData : true);\n\tvar file = new ISOFile(_stream);\n\tfile.discardMdatData = (keepMdatData ? false : true);\n\treturn file;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.createFile = MP4Box.createFile;\n}\n"],"names":["start","log_level","Log","Date","setLogLevel","level","this","debug","info","warn","error","module","msg","undefined","console","log","getDurationString","duration","_timescale","neg","pad","number","length","a","split","join","duration_sec","hours","Math","floor","minutes","msec","printRanges","ranges","str","i","end","exports","MP4BoxStream","arrayBuffer","ArrayBuffer","buffer","dataview","DataView","position","prototype","getPosition","getEndPosition","byteLength","getLength","seek","pos","npos","max","min","isNaN","isFinite","isEos","readAnyInt","size","signed","res","getInt8","getUint8","getInt16","getUint16","getInt32","getUint32","readUint8","readUint16","readUint24","readUint32","readUint64","readString","s","String","fromCharCode","readCString","arr","b","push","apply","readInt8","readInt16","readInt32","readInt64","readUint8Array","Uint8Array","readInt16Array","Int16Array","readUint16Array","readUint32Array","Uint32Array","readInt32Array","Int32Array","DataStream","byteOffset","endianness","_byteOffset","dataView","LITTLE_ENDIAN","_realloc","extra","_dynamicSize","req","blen","_buffer","_byteLength","buf","src","set","_trimAlloc","dst","BIG_ENDIAN","Object","defineProperty","get","v","_dataView","isEof","mapUint8Array","e","memcpy","BYTES_PER_ELEMENT","arrayToNative","readInt8Array","Int8Array","Uint16Array","readFloat64Array","Float64Array","readFloat32Array","Float32Array","readFloat32","getFloat32","readFloat64","getFloat64","dstOffset","srcOffset","dstU8","srcU8","array","arrayIsLittleEndian","flipArrayEndianness","nativeToEndian","littleEndian","u8","j","k","tmp","failurePosition","fromCharCodeUint8","uint8arr","encoding","TextDecoder","decode","len","MAX_SIZE","pow","save","filename","blob","Blob","window","URL","createObjectURL","url","document","createElement","body","appendChild","setAttribute","click","revokeObjectURL","shift","offset","writeInt32Array","mapInt32Array","writeInt32","writeInt16Array","mapInt16Array","writeInt16","writeInt8Array","mapInt8Array","writeInt8","writeUint32Array","mapUint32Array","writeUint32","writeUint16Array","mapUint16Array","writeUint16","writeUint8Array","writeUint8","writeFloat64Array","mapFloat64Array","writeFloat64","writeFloat32Array","mapFloat32Array","writeFloat32","setInt32","setInt16","setInt8","setUint32","setUint16","setUint8","setFloat32","setFloat64","writeUCS2String","lengthOverride","charCodeAt","writeString","TextEncoder","encode","substring","writeCString","writeStruct","structDefinition","struct","t","writeType","tp","Array","charset","test","parseInt","ta","writeUint64","h","writeUint24","adjustUint32","value","MultiBufferStream","buffers","bufferIndex","insertBuffer","initialized","firstBuffer","fileStart","logBufferLevel","concat","buffer1","buffer2","reduceBuffer","newLength","smallB","usedBytes","ab","to_add","splice","used","total","range","bufferedString","cleanBuffers","mergeNextBuffer","next_buffer","oldLength","oldUsedBytes","oldFileStart","findPosition","fromStart","filePosition","markAsUsed","abuffer","index","findEndContiguousBuf","inputindex","currentBuf","nextBuf","getEndFilePositionAfter","addUsedBytes","nbBytes","setAllUsedBytes","MPEG4DescriptorParser","descTagToName","getDescriptorName","tag","that","classes","parseOneDescriptor","stream","desc","byteRead","Descriptor","parse","_tag","_size","descs","data","findDescriptor","parseRemainingDescriptors","ES_Descriptor","call","ES_ID","flags","dependsOn_ES_ID","l","OCR_ES_ID","getOTI","dcd","oti","getAudioConfig","dsi","audioObjectType","DecoderConfigDescriptor","streamType","upStream","bufferSize","maxBitrate","avgBitrate","DecoderSpecificInfo","SLConfigDescriptor","BoxParser","ERR_INVALID_DATA","ERR_NOT_ENOUGH_DATA","OK","BASIC_BOXES","type","name","FULL_BOXES","CONTAINER_BOXES","boxCodes","fullBoxCodes","containerBoxCodes","sampleEntryCodes","sampleGroupEntryCodes","trackGroupTypes","UUIDBoxes","UUIDs","initialize","FullBox","Box","ContainerBox","SampleEntry","TrackGroupTypeBox","forEach","box","createBoxCtor","createFullBoxCtor","boxes","createContainerBoxCtor","_type","_name","_uuid","box_name","uuid","version","hdr_size","SampleGroupEntry","grouping_type","parseMethod","parseFullHeader","addSubBoxArrays","subBoxNames","nbSubBoxes","createMediaSampleEntryCtor","mediaType","createSampleEntryCtor","createEncryptedSampleEntryCtor","createSampleGroupCtor","createTrackGroupCtor","createUUIDBox","isFullBox","isContainerBox","printPS","ps","nalu","reduce","byte","toString","padStart","ColorPoint","x","y","Pixel","row","col","bad_pixel_row","bad_pixel_column","TKHD_FLAG_ENABLED","TKHD_FLAG_IN_MOVIE","TKHD_FLAG_IN_PREVIEW","TFHD_FLAG_BASE_DATA_OFFSET","TFHD_FLAG_SAMPLE_DESC","TFHD_FLAG_SAMPLE_DUR","TFHD_FLAG_SAMPLE_SIZE","TFHD_FLAG_SAMPLE_FLAGS","TFHD_FLAG_DUR_EMPTY","TFHD_FLAG_DEFAULT_BASE_IS_MOOF","TRUN_FLAGS_DATA_OFFSET","TRUN_FLAGS_FIRST_FLAG","TRUN_FLAGS_DURATION","TRUN_FLAGS_SIZE","TRUN_FLAGS_FLAGS","TRUN_FLAGS_CTS_OFFSET","add","addBox","prop","addEntry","_prop","parseUUID","parseHex16","hex16","hex","parseOneBox","headerOnly","parentSize","diff","code","box_type","has_unparsed_data","write","parseDataAndRewind","ret","indexOf","parseLanguage","language","chars","languageString","SAMPLE_ENTRY_TYPE_VISUAL","SAMPLE_ENTRY_TYPE_AUDIO","SAMPLE_ENTRY_TYPE_HINT","SAMPLE_ENTRY_TYPE_METADATA","SAMPLE_ENTRY_TYPE_SUBTITLE","SAMPLE_ENTRY_TYPE_SYSTEM","SAMPLE_ENTRY_TYPE_TEXT","parseHeader","data_reference_index","parseFooter","compressorname_length","width","height","horizresolution","vertresolution","frame_count","compressorname","depth","channel_count","samplesize","samplerate","FieldLength","layer_size","op_index","aux_type","aux_subtype_length","aux_subtype","seq_profile","seq_level_idx_0","seq_tier_0","high_bitdepth","twelve_bit","monochrome","chroma_subsampling_x","chroma_subsampling_y","chroma_sample_position","reserved_1","initial_presentation_delay_present","initial_presentation_delay_minus_one","reserved_2","configOBUs_length","configOBUs","toparse","configurationVersion","AVCProfileIndication","profile_compatibility","AVCLevelIndication","lengthSizeMinusOne","nb_SPS_nalus","SPS","nb_PPS_nalus","PPS","ext","bufferSizeDB","all_ref_pics_intra","intra_pred_used","max_ref_per_pic","channel_indexes","channel_types","channel_associations","cleanApertureWidthN","cleanApertureWidthD","cleanApertureHeightN","cleanApertureHeightD","horizOffN","horizOffD","vertOffN","vertOffD","max_content_light_level","max_pic_average_light_level","pos_x","pos_y","pos_z","quat_x","quat_y","quat_z","id","focal_length_x","principal_point_x","principal_point_y","focal_length_y","skew_factor","component_count","component_types","component_type_urls","component_type","entry_count","chunk_offsets","maxCLL","maxFALL","colour_type","colour_primaries","transfer_characteristics","matrix_coefficients","full_range_flag","ICC_profile","notice","compositionToDTSShift","leastDecodeToDisplayDelta","greatestDecodeToDisplayDelta","compositionStartTime","compositionEndTime","sample_counts","sample_offsets","tmp_byte1","tmp_byte2","tmp_byte3","fscod","bsid","bsmod","acmod","lfeon","bit_rate_code","tmp_16","data_rate","num_ind_sub","ind_subs","ind_sub","num_dep_sub","chan_loc","boxesFound","knownBlockTypes","flagAndType","numMetadataBlocks","bytessent","time","Version","OutputChannelCount","PreSkip","InputSampleRate","OutputGain","ChannelMappingFamily","StreamCount","CoupledCount","ChannelMapping","entries","extended_language","entry","segment_duration","media_time","media_rate_integer","media_rate_fraction","timescale","presentation_time","event_duration","scheme_id_uri","presentation_time_delta","message_size","message_data","createEntityToGroupCtor","group_id","num_entities_in_group","entity_ids","entity_id","tile_size_x","tile_size_y","layer_binning","tiles_in_layer_column_minus1","tiles_in_layer_row_minus1","esd_data","esd_parser","esd","fieldCount","fieldOrdering","data_format","major_brand","minor_version","compatible_brands","handler","slice","tmp_byte","general_profile_space","general_tier_flag","general_profile_idc","general_profile_compatibility","general_constraint_indicator","general_level_idc","min_spatial_segmentation_idc","parallelismType","chroma_format_idc","bit_depth_luma_minus8","bit_depth_chroma_minus8","avgFrameRate","constantFrameRate","numTemporalLayers","temporalIdNested","nalu_arrays","nalu_array","completeness","nalu_type","numOfArrays","numNalus","item_infos","offset_size","length_size","base_offset_size","index_size","items","item_count","item","item_ID","construction_method","base_offset","extent_count","extents","extent","extent_index","extent_offset","extent_length","reserved","axis","item_protection_index","item_name","content_type","content_encoding","extension_type","item_type","item_uri_type","associations","item_assoc","association_count","props","p","essential","property_index","references","SingleItemTypeReferenceBox","SingleItemTypeReferenceBoxLarge","angle","image_width","image_height","schemeURI","count","levels","track_ID","padding_flag","assignment_type","grouping_type_parameter","sub_track_id","layer_id","period","bytes","display_primaries","white_point","max_display_mastering_luminance","min_display_mastering_luminance","creation_time","modification_time","fragment_duration","sequence_number","bits_per_pixel","rate","volume","matrix","next_track_id","packetssent","sample_count","padbits","hSpacing","vSpacing","text","payloadID","rtpmap_string","initial_delay","item_id","num_channels","bits_per_channels","step_count","ref_track_id","ntp_timestamp","system_id","kid","datasize","descriptionformat","sdptext","aux_info_type","aux_info_type_parameter","default_sample_info_size","sample_info_size","mime_format","namespace","schema_location","auxiliary_mime_types","displayFlags","horizontal_justification","vertical_justification","bg_color_rgba","box_record","style_record","roll_count","first_output_sample","sample_offset","remaining","description_length","num_output_samples","num_total_samples","layerNumber","accurateStatisticsFlag","avgBitRate","subSequenceIdentifier","durationFlag","avgRateFlag","dependency","numReferences","dependencyInfo","subSeqDirectionFlag","roll_distance","num_leading_samples_known","num_leading_samples","operation_point_count","target_rate_share","available_bitrate","maximum_bitrate","minimum_bitrate","discard_priority","crypt_byte_block","skip_byte_block","isProtected","Per_Sample_IV_Size","KID","constant_IV_size","constant_IV","NAL_unit_type","level_independently_decodable","group_description_index","component_index","correction_applied","num_bad_rows","num_bad_cols","num_bad_pixels","bad_rows","bad_columns","bad_pixels","scheme_type","scheme_version","scheme_uri","is_leading","sample_depends_on","sample_is_depended_on","sample_has_redundancy","default_length","default_group_description_index","reference_ID","earliest_presentation_time","first_offset","ref","tmp_32","reference_type","referenced_size","subsegment_duration","starts_with_SAP","SAP_type","SAP_delta_time","from_item_ID","to_item_ID","primaryRChromaticity_x","primaryRChromaticity_y","primaryGChromaticity_x","primaryGChromaticity_y","primaryBChromaticity_x","primaryBChromaticity_y","whitePointChromaticity_x","whitePointChromaticity_y","luminanceMax","luminanceMin","balance","subsegments","subsegment_count","subsegment","range_count","range_size","priority","switch_group","alternate_group","attribute_list","first_chunk","samples_per_chunk","sample_description_index","entryCount","shadowed_sample_numbers","sync_sample_numbers","sample_numbers","sample_sizes","sample_size","delta","sample_deltas","tmp32","single_view_allowed","stereo_scheme","stereo_indication_type","ftypBox","field_size","subsample_count","sampleInfo","sample_delta","subsamples","subsample","discardable","codec_specific_parameters","default_crypt_byte_block","default_skip_byte_block","default_isProtected","default_Per_Sample_IV_Size","default_KID","default_constant_IV_size","default_constant_IV","baseMediaDecodeTime","readBytes","track_id","base_data_offset","default_sample_description_index","default_sample_duration","default_sample_size","default_sample_flags","length_size_of_traf_num","length_size_of_trun_num","length_size_of_sample_num","number_of_entries","moof_offset","traf_number","trun_number","sample_number","layer","track_group_id","TrackReferenceTypeBox","track_ids","trefBox","data_offset","first_sample_flags","sample_duration","sample_flags","sample_composition_time_offset","config","lang","description","tags","profile","component_bit_depth_minus_one","component_format","component_align_size","sampling_type","interleave_type","block_size","component_little_endian","block_pad_lsb","block_little_endian","block_reversed","pad_unknown","pixel_size","row_align_size","tile_align_size","num_tile_cols_minus_one","num_tile_rows_minus_one","location","LiveServerManifest","replace","default_AlgorithmID","default_IV_size","fragment_count","absolute_time","absolute_duration","graphicsmode","opcolor","bitDepth","chromaSubsampling","videoFullRangeFlag","colourPrimaries","transferCharacteristics","matrixCoefficients","codecIntializationDataSize","codecIntializationData","colorSpace","transferFunction","bitReader","held_bits","num_held_bits","stream_read_1_bytes","strm","stream_read_2_bytes","extract_bits","num_bits","ptl_present_flag","ols_idx","num_sublayers","constant_frame_rate","bit_depth_minus8","num_bytes_constraint_info","ptl_frame_only_constraint_flag","ptl_multilayer_enabled_flag","general_constraint_info","cnstr1","cnstr2","ptl_sublayer_present_mask","val","sublayer_level_idc","ptl_num_sub_profiles","general_sub_profile_idc","max_picture_width","max_picture_height","avg_frame_rate","num_of_arrays","isVideo","isAudio","isSubtitle","isMetadata","isHint","getCodec","getWidth","getHeight","getChannelCount","getSampleRate","getSampleSize","VisualSampleEntry","AudioSampleEntry","SubtitleSampleEntry","MetadataSampleEntry","decimalToHex","d","padding","Number","avc1SampleEntry","avc2SampleEntry","avc3SampleEntry","avc4SampleEntry","baseCodec","avcC","hev1SampleEntry","hvc1SampleEntry","hvcC","reversed","hasByte","constraint_string","vvc1SampleEntry","vvi1SampleEntry","vvcC","last_nonzero","ptl_frame_only_constraint","ptl_multilayer_enabled","base32_chars","mp4aSampleEntry","esds","stxtSampleEntry","vp08SampleEntry","vp09SampleEntry","vpcC","av01SampleEntry","bitdepth","av1C","writeHeader","sizePosition","avcCBox","co64Box","cslgBox","cttsBox","drefBox","elngBox","elstBox","emsgBox","hdlrBox","hvcCBox","kindBox","mdhdBox","mehdBox","mfhdBox","mvhdBox","writeFooter","stppSampleEntry","sbgpBox","sgpdBox","sidxBox","smhdBox","stcoBox","stscBox","stsdBox","stshBox","stssBox","stszBox","constant","sttsBox","tfdtBox","UINT32_MAX","tfhdBox","tkhdBox","trexBox","trunBox","data_offset_position","vmhdBox","unpack","samples","pts","dts","m","Infinity","description_index","chunk_index","DIFF_BOXES_PROP_NAMES","DIFF_PRIMITIVE_ARRAY_PROP_NAMES","boxEqualFields","box_a","box_b","boxEqual","VTTin4Parser","parseSample","cues","cue","getText","startTime","endTime","n","z","secToTimestamp","insec","ms","string","cueIn4","payl","XMLSubtitlein4Parser","sample","documentString","resources","DOMParser","parseFromString","Textin4Parser","parseConfig","ISOFile","mdats","moofs","isProgressive","moovStartFound","onMoovStart","moovStartSent","onReady","readySent","onSegment","onSamples","onError","sampleListBuilt","fragmentedTracks","extractedTracks","isFragmentationInitialized","sampleProcessingStarted","nextMoofNumber","itemListBuilt","entity_groups","onSidx","sidxSent","setSegmentOptions","user","options","trak","getTrackById","fragTrack","nextSample","segmentStream","nb_samples","rapAlignement","nbSamples","unsetSegmentOptions","setExtractionOptions","extractTrack","unsetExtractionOptions","restoreParsePosition","hasIncompleteMdat","processIncompleteMdat","saveParsePosition","processIncompleteBox","updateUsedBytes","checkBuffer","appendBuffer","last","nextFileStart","moov","buildSampleLists","updateSampleLists","getInfo","processSamples","nextSeekPosition","nextParsePosition","sidx","meta","flattenItemInfo","processItems","onItem","getAllocatedSampleDataSize","track","sample_desc","movie","_1904","getTime","hasMoov","mvhd","isFragmented","mvex","mehd","hasIOD","iods","brands","ftyp","created","modified","tracks","audioTracks","videoTracks","subtitleTracks","metadataTracks","hintTracks","otherTracks","traks","mdia","minf","stbl","stsd","tkhd","hdlr","tref","edts","edits","elst","movie_duration","movie_timescale","track_width","track_height","mdhd","cts_shift","cslg","samples_duration","codec","kind","udta","kinds","elng","samples_size","bitrate","audio","sample_rate","video","mime","setNextSeekPositionFromSample","alreadyRead","fragTrak","result","createFragment","extractTrak","getSample","getBox","getBoxes","returnEarly","_sweep","getTrackSamplesInfo","getTrackSample","releaseUsedSamples","sampleNum","lastValidSample","releaseSample","samplesDataSize","stop","flush","seekTrack","useRap","seek_offset","rap_seek_sample_num","seek_sample_num","cts","is_sync","getTrackDuration","trak_seek_info","seek_info","equal","box_index","a_box","b_box","lastBoxStartPosition","parsingMdat","discardMdatData","init","_options","addTrack","media_duration","sample_description_entry","media_type","codes","avcDecoderConfigRecord","hevcDecoderConfigRecord","description_boxes","buildTrakSampleLists","computeSize","stream_","addSample","depends_on","is_depended_on","has_redundancy","degradation_priority","first_dts","moof","createSingleSampleMoof","trafs","truns","moofBox","traf","lastMoofIndex","resetTables","stsc","stts","ctts","stss","initial_duration","stco","co64","stsz","stz2","initSampleGroups","sbgps","trak_sgpds","traf_sgpds","sample_group_info","sample_group_key","SampleGroupInfo","_parameter","_sbgp","sbgp","last_sample_in_run","entry_index","sample_groups_info","fragment_description","is_fragment","setSampleGroupProperties","sample_groups","process_sdtp","sdtp","subs","sgpds","stdp","chunk_run_index","last_chunk_in_run","offset_in_chunk","last_sample_in_chunk","last_sample_in_stts_run","stts_run_index","last_sample_in_ctts_run","ctts_run_index","last_stss_index","subs_entry_index","last_subs_sample_index","last_run_position","trex","tfhd","getTrexById","trun","moof_number","number_in_traf","first_sample_index","first_traf_merged","tfdt","bdo","bdop","dbim","dop","has_fragment_subsamples","sample_index","lengthAfterStart","getCodecs","codecs","trexs","itemsDataSize","iinf","ref_to","protection_index","protection","ipro","protections","grpl","entity_group","iloc","itemloc","source","dinf","idat","pitm","primary","iref","iprp","ipmas","ipma","association","properties","propEntry","ipco","propbox","getItem","releaseItem","callback","sent","hasItem","getMetaHandler","getPrimaryItem","itemToFragmentedTrackFile","itemId","file","trackOptions","ispe","trackId","outstream","sampleNumber","mdat","mdatBox","writeInitializationSegment","total_duration","getBuffer","initializeSegmentation","initSegs","seg","moovBox","printHeader","output","indent","print","prev_indent","MP4Box","_keepMdatData","_stream","keepMdatData","createFile"],"sourceRoot":""}